var webgazer=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,(function(e){return t[e]}).bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=90)}([function(t,e,n){"use strict";n.r(e),n.d(e,"AdadeltaOptimizer",function(){return La}),n.d(e,"AdagradOptimizer",function(){return ja}),n.d(e,"AdamOptimizer",function(){return Ba}),n.d(e,"AdamaxOptimizer",function(){return za}),n.d(e,"MomentumOptimizer",function(){return Ua}),n.d(e,"Optimizer",function(){return Fa}),n.d(e,"RMSPropOptimizer",function(){return Wa}),n.d(e,"SGDOptimizer",function(){return $a}),n.d(e,"Tensor",function(){return M.a}),n.d(e,"TensorBuffer",function(){return M.b}),n.d(e,"Variable",function(){return M.c}),n.d(e,"Rank",function(){return Va.a}),n.d(e,"sumOutType",function(){return Va.b}),n.d(e,"upcastType",function(){return Va.c}),n.d(e,"add",function(){return I}),n.d(e,"addN",function(){return Vr}),n.d(e,"atan2",function(){return Yr}),n.d(e,"avgPool",function(){return Gr}),n.d(e,"avgPool3d",function(){return Xr}),n.d(e,"batchToSpaceND",function(){return An}),n.d(e,"batchNorm",function(){return qr}),n.d(e,"batchNorm2d",function(){return Kr}),n.d(e,"batchNorm3d",function(){return Jr}),n.d(e,"batchNorm4d",function(){return Qr}),n.d(e,"broadcastTo",function(){return ts}),n.d(e,"clone",function(){return Zr}),n.d(e,"complex",function(){return es.a}),n.d(e,"concat",function(){return L}),n.d(e,"concat1d",function(){return ns}),n.d(e,"concat2d",function(){return is}),n.d(e,"concat3d",function(){return rs}),n.d(e,"concat4d",function(){return ss}),n.d(e,"conv1d",function(){return os}),n.d(e,"conv2d",function(){return Re}),n.d(e,"conv2dTranspose",function(){return as}),n.d(e,"conv3d",function(){return us}),n.d(e,"conv3dTranspose",function(){return ls}),n.d(e,"cumsum",function(){return Fe}),n.d(e,"depthToSpace",function(){return cs}),n.d(e,"depthwiseConv2d",function(){return hs}),n.d(e,"diag",function(){return ds}),n.d(e,"div",function(){return H}),n.d(e,"divNoNan",function(){return fs}),n.d(e,"dot",function(){return ps}),n.d(e,"elu",function(){return ms}),n.d(e,"equal",function(){return gs}),n.d(e,"eye",function(){return ys}),n.d(e,"fill",function(){return vs}),n.d(e,"floorDiv",function(){return X}),n.d(e,"greater",function(){return on}),n.d(e,"greaterEqual",function(){return Qe}),n.d(e,"imag",function(){return bs.a}),n.d(e,"leakyRelu",function(){return ws}),n.d(e,"less",function(){return Ze}),n.d(e,"lessEqual",function(){return an}),n.d(e,"localResponseNormalization",function(){return Ts}),n.d(e,"matMul",function(){return xe}),n.d(e,"max",function(){return Ss}),n.d(e,"maxPool",function(){return Es}),n.d(e,"maxPool3d",function(){return Os}),n.d(e,"maxPoolWithArgmax",function(){return Cs}),n.d(e,"maximum",function(){return xs}),n.d(e,"minimum",function(){return _s}),n.d(e,"mod",function(){return As}),n.d(e,"mul",function(){return q}),n.d(e,"multinomial",function(){return ks}),n.d(e,"notEqual",function(){return Rs}),n.d(e,"oneHot",function(){return tr}),n.d(e,"outerProduct",function(){return Is}),n.d(e,"pad",function(){return Dn}),n.d(e,"pad1d",function(){return Ms}),n.d(e,"pad2d",function(){return Ns}),n.d(e,"pad3d",function(){return Ds}),n.d(e,"pad4d",function(){return Ps}),n.d(e,"pool",function(){return Fs}),n.d(e,"pow",function(){return xn}),n.d(e,"prelu",function(){return Ls}),n.d(e,"rand",function(){return js}),n.d(e,"randomGamma",function(){return Ws}),n.d(e,"randomNormal",function(){return Vs}),n.d(e,"randomUniform",function(){return Ys}),n.d(e,"real",function(){return Gs.a}),n.d(e,"relu",function(){return Xs}),n.d(e,"relu6",function(){return Hs}),n.d(e,"selu",function(){return qs}),n.d(e,"separableConv2d",function(){return Ks}),n.d(e,"spaceToBatchND",function(){return Te}),n.d(e,"split",function(){return Oe}),n.d(e,"square",function(){return Tt}),n.d(e,"squaredDifference",function(){return Js}),n.d(e,"sub",function(){return Ve}),n.d(e,"tile",function(){return Ye}),n.d(e,"truncatedNormal",function(){return Qs}),n.d(e,"booleanMaskAsync",function(){return uo}),n.d(e,"reverse",function(){return lo}),n.d(e,"reverse1d",function(){return co}),n.d(e,"reverse2d",function(){return ho}),n.d(e,"reverse3d",function(){return fo}),n.d(e,"reverse4d",function(){return po}),n.d(e,"slice",function(){return Gn}),n.d(e,"slice1d",function(){return Xn}),n.d(e,"slice2d",function(){return Hn}),n.d(e,"slice3d",function(){return qn}),n.d(e,"slice4d",function(){return Kn}),n.d(e,"abs",function(){return St}),n.d(e,"acos",function(){return Et}),n.d(e,"acosh",function(){return Ot}),n.d(e,"asin",function(){return Ct}),n.d(e,"asinh",function(){return _t}),n.d(e,"atan",function(){return At}),n.d(e,"atanh",function(){return kt}),n.d(e,"ceil",function(){return Rt}),n.d(e,"clipByValue",function(){return It}),n.d(e,"cos",function(){return Mt}),n.d(e,"cosh",function(){return Nt}),n.d(e,"erf",function(){return Dt}),n.d(e,"exp",function(){return Pt}),n.d(e,"expm1",function(){return Ft}),n.d(e,"floor",function(){return Lt}),n.d(e,"log",function(){return jt}),n.d(e,"log1p",function(){return Bt}),n.d(e,"logSigmoid",function(){return zt}),n.d(e,"neg",function(){return $t}),n.d(e,"reciprocal",function(){return Ut}),n.d(e,"round",function(){return Wt}),n.d(e,"rsqrt",function(){return Vt}),n.d(e,"sigmoid",function(){return Yt}),n.d(e,"sign",function(){return Gt}),n.d(e,"isNaN",function(){return Xt}),n.d(e,"isInf",function(){return Ht}),n.d(e,"isFinite",function(){return qt}),n.d(e,"sin",function(){return Kt}),n.d(e,"sinh",function(){return Jt}),n.d(e,"softplus",function(){return Qt}),n.d(e,"sqrt",function(){return Zt}),n.d(e,"step",function(){return te}),n.d(e,"tan",function(){return ee}),n.d(e,"tanh",function(){return ne}),n.d(e,"all",function(){return dt}),n.d(e,"any",function(){return ft}),n.d(e,"argMax",function(){return pt}),n.d(e,"argMin",function(){return mt}),n.d(e,"logSumExp",function(){return gt}),n.d(e,"mean",function(){return yt}),n.d(e,"min",function(){return vt}),n.d(e,"moments",function(){return bt}),n.d(e,"sum",function(){return xt}),n.d(e,"prod",function(){return wt}),n.d(e,"equalStrict",function(){return mo}),n.d(e,"greaterEqualStrict",function(){return go}),n.d(e,"greaterStrict",function(){return yo}),n.d(e,"lessEqualStrict",function(){return vo}),n.d(e,"lessStrict",function(){return bo}),n.d(e,"notEqualStrict",function(){return xo}),n.d(e,"addStrict",function(){return wo}),n.d(e,"divStrict",function(){return To}),n.d(e,"maximumStrict",function(){return So}),n.d(e,"minimumStrict",function(){return Eo}),n.d(e,"modStrict",function(){return Oo}),n.d(e,"mulStrict",function(){return Co}),n.d(e,"powStrict",function(){return _o}),n.d(e,"squaredDifferenceStrict",function(){return Ao}),n.d(e,"subStrict",function(){return ko}),n.d(e,"logicalAnd",function(){return pn}),n.d(e,"logicalNot",function(){return mn}),n.d(e,"logicalOr",function(){return gn}),n.d(e,"logicalXor",function(){return yn}),n.d(e,"where",function(){return vn}),n.d(e,"whereAsync",function(){return bn}),n.d(e,"buffer",function(){return j}),n.d(e,"print",function(){return B}),n.d(e,"cast",function(){return z}),n.d(e,"expandDims",function(){return $}),n.d(e,"reshape",function(){return U}),n.d(e,"squeeze",function(){return W}),n.d(e,"stack",function(){return V}),n.d(e,"unstack",function(){return Y}),n.d(e,"setdiff1dAsync",function(){return G}),n.d(e,"linspace",function(){return F.a}),n.d(e,"ones",function(){return F.b}),n.d(e,"range",function(){return F.d}),n.d(e,"scalar",function(){return F.e}),n.d(e,"tensor",function(){return F.f}),n.d(e,"tensor1d",function(){return F.g}),n.d(e,"tensor2d",function(){return F.h}),n.d(e,"tensor3d",function(){return F.i}),n.d(e,"tensor4d",function(){return F.j}),n.d(e,"tensor5d",function(){return F.k}),n.d(e,"tensor6d",function(){return F.l}),n.d(e,"variable",function(){return F.m}),n.d(e,"zeros",function(){return F.n}),n.d(e,"onesLike",function(){return F.c}),n.d(e,"zerosLike",function(){return F.o}),n.d(e,"transpose",function(){return Pe}),n.d(e,"softmax",function(){return Ro}),n.d(e,"logSoftmax",function(){return Io}),n.d(e,"norm",function(){return No}),n.d(e,"gather",function(){return oo}),n.d(e,"unsortedSegmentSum",function(){return ao}),n.d(e,"basicLSTMCell",function(){return Do}),n.d(e,"multiRNNCell",function(){return Po}),n.d(e,"movingAverage",function(){return Fo}),n.d(e,"stridedSlice",function(){return Lo}),n.d(e,"topk",function(){return jo}),n.d(e,"scatterND",function(){return Bo}),n.d(e,"fft",function(){return zo}),n.d(e,"ifft",function(){return $o}),n.d(e,"rfft",function(){return Uo}),n.d(e,"irfft",function(){return Wo}),n.d(e,"sparseToDense",function(){return Vo}),n.d(e,"gatherND",function(){return Yo}),n.d(e,"dropout",function(){return Go}),n.d(e,"hannWindow",function(){return Ho}),n.d(e,"hammingWindow",function(){return qo}),n.d(e,"frame",function(){return Ko}),n.d(e,"stft",function(){return Jo}),n.d(e,"inTopKAsync",function(){return Qo}),n.d(e,"op",function(){return R.a}),n.d(e,"image",function(){return g}),n.d(e,"linalg",function(){return m}),n.d(e,"losses",function(){return p}),n.d(e,"spectral",function(){return d}),n.d(e,"fused",function(){return y}),n.d(e,"signal",function(){return f}),n.d(e,"Reduction",function(){return Zo}),n.d(e,"train",function(){return Ga}),n.d(e,"enableProdMode",function(){return Sr}),n.d(e,"enableDebugMode",function(){return Er}),n.d(e,"disableDeprecationWarnings",function(){return Or}),n.d(e,"deprecationWarn",function(){return Cr}),n.d(e,"disposeVariables",function(){return _r}),n.d(e,"engine",function(){return Ar}),n.d(e,"memory",function(){return kr}),n.d(e,"profile",function(){return Rr}),n.d(e,"tidy",function(){return Ir}),n.d(e,"dispose",function(){return Mr}),n.d(e,"keep",function(){return Nr}),n.d(e,"time",function(){return Dr}),n.d(e,"setBackend",function(){return Pr}),n.d(e,"ready",function(){return Fr}),n.d(e,"getBackend",function(){return Lr}),n.d(e,"removeBackend",function(){return jr}),n.d(e,"findBackend",function(){return Br}),n.d(e,"findBackendFactory",function(){return zr}),n.d(e,"registerBackend",function(){return $r}),n.d(e,"backend",function(){return Ur}),n.d(e,"setPlatform",function(){return Wr}),n.d(e,"getKernel",function(){return Zn.b}),n.d(e,"getGradient",function(){return Zn.a}),n.d(e,"getKernelsForBackend",function(){return Zn.c}),n.d(e,"registerKernel",function(){return Zn.e}),n.d(e,"registerGradient",function(){return Zn.d}),n.d(e,"unregisterKernel",function(){return Zn.g}),n.d(e,"unregisterGradient",function(){return Zn.f}),n.d(e,"customGrad",function(){return et}),n.d(e,"grad",function(){return K}),n.d(e,"grads",function(){return J}),n.d(e,"valueAndGrad",function(){return Q}),n.d(e,"valueAndGrads",function(){return Z}),n.d(e,"variableGrads",function(){return tt}),n.d(e,"Environment",function(){return ei.b}),n.d(e,"env",function(){return ei.c}),n.d(e,"ENV",function(){return ei.a}),n.d(e,"version_core",function(){return Tr}),n.d(e,"nextFrame",function(){return Xa.a}),n.d(e,"browser",function(){return o}),n.d(e,"io",function(){return r}),n.d(e,"math",function(){return s}),n.d(e,"serialization",function(){return l}),n.d(e,"test_util",function(){return c}),n.d(e,"util",function(){return N}),n.d(e,"backend_util",function(){return b}),n.d(e,"tensor_util",function(){return A}),n.d(e,"slice_util",function(){return i}),n.d(e,"gather_util",function(){return a}),n.d(e,"scatter_util",function(){return u}),n.d(e,"device_util",function(){return vu}),n.d(e,"kernel_impls",function(){return x}),n.d(e,"KernelBackend",function(){return Su}),n.d(e,"DataStorage",function(){return Tu}),n.d(e,"Add",function(){return T.a}),n.d(e,"AddN",function(){return T.b}),n.d(e,"Atan2",function(){return T.c}),n.d(e,"AvgPool",function(){return T.d}),n.d(e,"AvgPoolBackprop",function(){return T.g}),n.d(e,"AvgPool3D",function(){return T.e}),n.d(e,"AvgPool3DBackprop",function(){return T.f}),n.d(e,"BatchMatMul",function(){return T.h}),n.d(e,"BatchToSpaceND",function(){return T.i}),n.d(e,"BroadcastTo",function(){return T.j}),n.d(e,"Complex",function(){return T.k}),n.d(e,"Concat",function(){return T.l}),n.d(e,"Conv2D",function(){return T.m}),n.d(e,"Conv2DBackpropFilter",function(){return T.n}),n.d(e,"Conv2DBackpropInput",function(){return T.o}),n.d(e,"Conv3D",function(){return T.p}),n.d(e,"Conv3DBackpropFilterV2",function(){return T.q}),n.d(e,"Conv3DBackpropInputV2",function(){return T.r}),n.d(e,"Cumsum",function(){return T.s}),n.d(e,"DepthToSpace",function(){return T.t}),n.d(e,"DepthwiseConv2dNative",function(){return T.u}),n.d(e,"DepthwiseConv2dNativeBackpropFilter",function(){return T.v}),n.d(e,"DepthwiseConv2dNativeBackpropInput",function(){return T.w}),n.d(e,"Diag",function(){return T.x}),n.d(e,"Div",function(){return T.y}),n.d(e,"Elu",function(){return T.z}),n.d(e,"EluGrad",function(){return T.A}),n.d(e,"Equal",function(){return T.B}),n.d(e,"FloorDiv",function(){return T.D}),n.d(e,"Fill",function(){return T.C}),n.d(e,"FusedBatchNorm",function(){return T.F}),n.d(e,"GatherNd",function(){return T.G}),n.d(e,"Greater",function(){return T.H}),n.d(e,"GreaterEqual",function(){return T.I}),n.d(e,"Identity",function(){return T.J}),n.d(e,"Imag",function(){return T.K}),n.d(e,"Less",function(){return T.N}),n.d(e,"LessEqual",function(){return T.O}),n.d(e,"LRN",function(){return T.L}),n.d(e,"LRNBackprop",function(){return T.M}),n.d(e,"Max",function(){return T.P}),n.d(e,"Maximum",function(){return T.V}),n.d(e,"MaxPool",function(){return T.Q}),n.d(e,"MaxPoolBackprop",function(){return T.T}),n.d(e,"MaxPool3D",function(){return T.R}),n.d(e,"MaxPool3DBackprop",function(){return T.S}),n.d(e,"MaxPoolWithArgmax",function(){return T.U}),n.d(e,"Minimum",function(){return T.W}),n.d(e,"Mod",function(){return T.X}),n.d(e,"Multiply",function(){return T.Y}),n.d(e,"NotEqual",function(){return T.bb}),n.d(e,"NonMaxSuppressionV3",function(){return T.Z}),n.d(e,"NonMaxSuppressionV5",function(){return T.ab}),n.d(e,"OneHot",function(){return T.cb}),n.d(e,"PadV2",function(){return T.db}),n.d(e,"Pool",function(){return T.eb}),n.d(e,"Pow",function(){return T.fb}),n.d(e,"Prelu",function(){return T.gb}),n.d(e,"Real",function(){return T.hb}),n.d(e,"Relu",function(){return T.ib}),n.d(e,"Relu6",function(){return T.jb}),n.d(e,"SelectV2",function(){return T.kb}),n.d(e,"Selu",function(){return T.lb}),n.d(e,"SpaceToBatchND",function(){return T.mb}),n.d(e,"SplitV",function(){return T.nb}),n.d(e,"SquaredDifference",function(){return T.pb}),n.d(e,"Square",function(){return T.ob}),n.d(e,"Sub",function(){return T.qb}),n.d(e,"Tile",function(){return T.rb}),n.d(e,"Transpose",function(){return T.sb}),n.d(e,"FromPixels",function(){return T.E});var i={};n.r(i),n.d(i,"assertParamsValid",function(){return Pn}),n.d(i,"maskToAxes",function(){return Fn}),n.d(i,"computeOutShape",function(){return Ln}),n.d(i,"stridesWithElidedDims",function(){return jn}),n.d(i,"startIndicesWithElidedDims",function(){return Bn}),n.d(i,"stopIndicesWithElidedDims",function(){return zn}),n.d(i,"stridesForAxis",function(){return $n}),n.d(i,"startForAxis",function(){return Un}),n.d(i,"stopForAxis",function(){return Wn}),n.d(i,"isSliceContinous",function(){return Vn}),n.d(i,"computeFlatOffset",function(){return Yn});var r={};n.r(r),n.d(r,"copyModel",function(){return pi}),n.d(r,"listModels",function(){return di}),n.d(r,"moveModel",function(){return mi}),n.d(r,"removeModel",function(){return fi}),n.d(r,"browserFiles",function(){return Bi}),n.d(r,"browserHTTPRequest",function(){return qi}),n.d(r,"concatenateArrayBuffers",function(){return ni.d}),n.d(r,"decodeWeights",function(){return ni.e}),n.d(r,"encodeWeights",function(){return ni.f}),n.d(r,"fromMemory",function(){return Qi}),n.d(r,"getLoadHandlers",function(){return ai}),n.d(r,"getModelArtifactsInfoForJSON",function(){return ni.g}),n.d(r,"getSaveHandlers",function(){return oi}),n.d(r,"http",function(){return Hi}),n.d(r,"isHTTPScheme",function(){return Gi}),n.d(r,"loadWeights",function(){return Wi}),n.d(r,"registerLoadRouter",function(){return si}),n.d(r,"registerSaveRouter",function(){return ri}),n.d(r,"weightsLoaderFactory",function(){return Vi}),n.d(r,"withSaveHandler",function(){return Zi});var s={};n.r(s),n.d(s,"confusionMatrix",function(){return er});var o={};n.r(o),n.d(o,"toPixels",function(){return ir}),n.d(o,"fromPixels",function(){return rr});var a={};n.r(a),n.d(a,"prepareAndValidate",function(){return sr});var u={};n.r(u),n.d(u,"validateUpdateShape",function(){return or}),n.d(u,"validateInput",function(){return ar}),n.d(u,"calculateShapes",function(){return ur});var l={};n.r(l),n.d(l,"Serializable",function(){return lr}),n.d(l,"SerializationMap",function(){return cr}),n.d(l,"registerClass",function(){return hr});var c={};n.r(c),n.d(c,"TEST_EPSILON_FLOAT16",function(){return dr}),n.d(c,"expectArraysClose",function(){return fr}),n.d(c,"testEpsilon",function(){return pr}),n.d(c,"expectPromiseToFail",function(){return gr}),n.d(c,"expectArraysEqual",function(){return yr}),n.d(c,"expectNumbersClose",function(){return vr}),n.d(c,"expectValuesInRange",function(){return xr}),n.d(c,"expectArrayBuffersEqual",function(){return wr});var h={};n.r(h),n.d(h,"segOpComputeOptimalWindowSize",function(){return eo}),n.d(h,"computeOutShape",function(){return no}),n.d(h,"collectGatherOpShapeInfo",function(){return io});var d={};n.r(d),n.d(d,"fft",function(){return zo}),n.d(d,"ifft",function(){return $o}),n.d(d,"rfft",function(){return Uo}),n.d(d,"irfft",function(){return Wo});var f={};n.r(f),n.d(f,"hannWindow",function(){return Ho}),n.d(f,"hammingWindow",function(){return qo}),n.d(f,"frame",function(){return Ko}),n.d(f,"stft",function(){return Jo});var p={};n.r(p),n.d(p,"Reduction",function(){return Zo}),n.d(p,"absoluteDifference",function(){return ta}),n.d(p,"computeWeightedLoss",function(){return ea}),n.d(p,"cosineDistance",function(){return na}),n.d(p,"hingeLoss",function(){return ia}),n.d(p,"huberLoss",function(){return ra}),n.d(p,"logLoss",function(){return sa}),n.d(p,"meanSquaredError",function(){return oa}),n.d(p,"sigmoidCrossEntropy",function(){return aa}),n.d(p,"softmaxCrossEntropy",function(){return ua});var m={};n.r(m),n.d(m,"bandPart",function(){return ca}),n.d(m,"gramSchmidt",function(){return ha}),n.d(m,"qr",function(){return da});var g={};n.r(g),n.d(g,"nonMaxSuppression",function(){return Ta}),n.d(g,"resizeBilinear",function(){return Sa}),n.d(g,"resizeNearestNeighbor",function(){return Ea}),n.d(g,"nonMaxSuppressionAsync",function(){return Oa}),n.d(g,"nonMaxSuppressionWithScore",function(){return Ca}),n.d(g,"nonMaxSuppressionWithScoreAsync",function(){return _a}),n.d(g,"cropAndResize",function(){return Aa});var y={};n.r(y),n.d(y,"matMul",function(){return Na}),n.d(y,"conv2d",function(){return Da}),n.d(y,"depthwiseConv2d",function(){return Pa});var v={};n.r(v),n.d(v,"add",function(){return I}),n.d(v,"addN",function(){return Vr}),n.d(v,"atan2",function(){return Yr}),n.d(v,"avgPool",function(){return Gr}),n.d(v,"avgPool3d",function(){return Xr}),n.d(v,"batchToSpaceND",function(){return An}),n.d(v,"batchNorm",function(){return qr}),n.d(v,"batchNorm2d",function(){return Kr}),n.d(v,"batchNorm3d",function(){return Jr}),n.d(v,"batchNorm4d",function(){return Qr}),n.d(v,"broadcastTo",function(){return ts}),n.d(v,"clone",function(){return Zr}),n.d(v,"complex",function(){return es.a}),n.d(v,"concat",function(){return L}),n.d(v,"concat1d",function(){return ns}),n.d(v,"concat2d",function(){return is}),n.d(v,"concat3d",function(){return rs}),n.d(v,"concat4d",function(){return ss}),n.d(v,"conv1d",function(){return os}),n.d(v,"conv2d",function(){return Re}),n.d(v,"conv2dTranspose",function(){return as}),n.d(v,"conv3d",function(){return us}),n.d(v,"conv3dTranspose",function(){return ls}),n.d(v,"cumsum",function(){return Fe}),n.d(v,"depthToSpace",function(){return cs}),n.d(v,"depthwiseConv2d",function(){return hs}),n.d(v,"diag",function(){return ds}),n.d(v,"div",function(){return H}),n.d(v,"divNoNan",function(){return fs}),n.d(v,"dot",function(){return ps}),n.d(v,"elu",function(){return ms}),n.d(v,"equal",function(){return gs}),n.d(v,"eye",function(){return ys}),n.d(v,"fill",function(){return vs}),n.d(v,"floorDiv",function(){return X}),n.d(v,"greater",function(){return on}),n.d(v,"greaterEqual",function(){return Qe}),n.d(v,"imag",function(){return bs.a}),n.d(v,"leakyRelu",function(){return ws}),n.d(v,"less",function(){return Ze}),n.d(v,"lessEqual",function(){return an}),n.d(v,"localResponseNormalization",function(){return Ts}),n.d(v,"matMul",function(){return xe}),n.d(v,"max",function(){return Ss}),n.d(v,"maxPool",function(){return Es}),n.d(v,"maxPool3d",function(){return Os}),n.d(v,"maxPoolWithArgmax",function(){return Cs}),n.d(v,"maximum",function(){return xs}),n.d(v,"minimum",function(){return _s}),n.d(v,"mod",function(){return As}),n.d(v,"mul",function(){return q}),n.d(v,"multinomial",function(){return ks}),n.d(v,"notEqual",function(){return Rs}),n.d(v,"oneHot",function(){return tr}),n.d(v,"outerProduct",function(){return Is}),n.d(v,"pad",function(){return Dn}),n.d(v,"pad1d",function(){return Ms}),n.d(v,"pad2d",function(){return Ns}),n.d(v,"pad3d",function(){return Ds}),n.d(v,"pad4d",function(){return Ps}),n.d(v,"pool",function(){return Fs}),n.d(v,"pow",function(){return xn}),n.d(v,"prelu",function(){return Ls}),n.d(v,"rand",function(){return js}),n.d(v,"randomGamma",function(){return Ws}),n.d(v,"randomNormal",function(){return Vs}),n.d(v,"randomUniform",function(){return Ys}),n.d(v,"real",function(){return Gs.a}),n.d(v,"relu",function(){return Xs}),n.d(v,"relu6",function(){return Hs}),n.d(v,"selu",function(){return qs}),n.d(v,"separableConv2d",function(){return Ks}),n.d(v,"spaceToBatchND",function(){return Te}),n.d(v,"split",function(){return Oe}),n.d(v,"square",function(){return Tt}),n.d(v,"squaredDifference",function(){return Js}),n.d(v,"sub",function(){return Ve}),n.d(v,"tile",function(){return Ye}),n.d(v,"truncatedNormal",function(){return Qs}),n.d(v,"booleanMaskAsync",function(){return uo}),n.d(v,"reverse",function(){return lo}),n.d(v,"reverse1d",function(){return co}),n.d(v,"reverse2d",function(){return ho}),n.d(v,"reverse3d",function(){return fo}),n.d(v,"reverse4d",function(){return po}),n.d(v,"slice",function(){return Gn}),n.d(v,"slice1d",function(){return Xn}),n.d(v,"slice2d",function(){return Hn}),n.d(v,"slice3d",function(){return qn}),n.d(v,"slice4d",function(){return Kn}),n.d(v,"abs",function(){return St}),n.d(v,"acos",function(){return Et}),n.d(v,"acosh",function(){return Ot}),n.d(v,"asin",function(){return Ct}),n.d(v,"asinh",function(){return _t}),n.d(v,"atan",function(){return At}),n.d(v,"atanh",function(){return kt}),n.d(v,"ceil",function(){return Rt}),n.d(v,"clipByValue",function(){return It}),n.d(v,"cos",function(){return Mt}),n.d(v,"cosh",function(){return Nt}),n.d(v,"erf",function(){return Dt}),n.d(v,"exp",function(){return Pt}),n.d(v,"expm1",function(){return Ft}),n.d(v,"floor",function(){return Lt}),n.d(v,"log",function(){return jt}),n.d(v,"log1p",function(){return Bt}),n.d(v,"logSigmoid",function(){return zt}),n.d(v,"neg",function(){return $t}),n.d(v,"reciprocal",function(){return Ut}),n.d(v,"round",function(){return Wt}),n.d(v,"rsqrt",function(){return Vt}),n.d(v,"sigmoid",function(){return Yt}),n.d(v,"sign",function(){return Gt}),n.d(v,"isNaN",function(){return Xt}),n.d(v,"isInf",function(){return Ht}),n.d(v,"isFinite",function(){return qt}),n.d(v,"sin",function(){return Kt}),n.d(v,"sinh",function(){return Jt}),n.d(v,"softplus",function(){return Qt}),n.d(v,"sqrt",function(){return Zt}),n.d(v,"step",function(){return te}),n.d(v,"tan",function(){return ee}),n.d(v,"tanh",function(){return ne}),n.d(v,"all",function(){return dt}),n.d(v,"any",function(){return ft}),n.d(v,"argMax",function(){return pt}),n.d(v,"argMin",function(){return mt}),n.d(v,"logSumExp",function(){return gt}),n.d(v,"mean",function(){return yt}),n.d(v,"min",function(){return vt}),n.d(v,"moments",function(){return bt}),n.d(v,"sum",function(){return xt}),n.d(v,"prod",function(){return wt}),n.d(v,"equalStrict",function(){return mo}),n.d(v,"greaterEqualStrict",function(){return go}),n.d(v,"greaterStrict",function(){return yo}),n.d(v,"lessEqualStrict",function(){return vo}),n.d(v,"lessStrict",function(){return bo}),n.d(v,"notEqualStrict",function(){return xo}),n.d(v,"addStrict",function(){return wo}),n.d(v,"divStrict",function(){return To}),n.d(v,"maximumStrict",function(){return So}),n.d(v,"minimumStrict",function(){return Eo}),n.d(v,"modStrict",function(){return Oo}),n.d(v,"mulStrict",function(){return Co}),n.d(v,"powStrict",function(){return _o}),n.d(v,"squaredDifferenceStrict",function(){return Ao}),n.d(v,"subStrict",function(){return ko}),n.d(v,"logicalAnd",function(){return pn}),n.d(v,"logicalNot",function(){return mn}),n.d(v,"logicalOr",function(){return gn}),n.d(v,"logicalXor",function(){return yn}),n.d(v,"where",function(){return vn}),n.d(v,"whereAsync",function(){return bn}),n.d(v,"buffer",function(){return j}),n.d(v,"print",function(){return B}),n.d(v,"cast",function(){return z}),n.d(v,"expandDims",function(){return $}),n.d(v,"reshape",function(){return U}),n.d(v,"squeeze",function(){return W}),n.d(v,"stack",function(){return V}),n.d(v,"unstack",function(){return Y}),n.d(v,"setdiff1dAsync",function(){return G}),n.d(v,"linspace",function(){return F.a}),n.d(v,"ones",function(){return F.b}),n.d(v,"range",function(){return F.d}),n.d(v,"scalar",function(){return F.e}),n.d(v,"tensor",function(){return F.f}),n.d(v,"tensor1d",function(){return F.g}),n.d(v,"tensor2d",function(){return F.h}),n.d(v,"tensor3d",function(){return F.i}),n.d(v,"tensor4d",function(){return F.j}),n.d(v,"tensor5d",function(){return F.k}),n.d(v,"tensor6d",function(){return F.l}),n.d(v,"variable",function(){return F.m}),n.d(v,"zeros",function(){return F.n}),n.d(v,"onesLike",function(){return F.c}),n.d(v,"zerosLike",function(){return F.o}),n.d(v,"transpose",function(){return Pe}),n.d(v,"softmax",function(){return Ro}),n.d(v,"logSoftmax",function(){return Io}),n.d(v,"norm",function(){return No}),n.d(v,"gather",function(){return oo}),n.d(v,"unsortedSegmentSum",function(){return ao}),n.d(v,"basicLSTMCell",function(){return Do}),n.d(v,"multiRNNCell",function(){return Po}),n.d(v,"movingAverage",function(){return Fo}),n.d(v,"stridedSlice",function(){return Lo}),n.d(v,"topk",function(){return jo}),n.d(v,"scatterND",function(){return Bo}),n.d(v,"fft",function(){return zo}),n.d(v,"ifft",function(){return $o}),n.d(v,"rfft",function(){return Uo}),n.d(v,"irfft",function(){return Wo}),n.d(v,"sparseToDense",function(){return Vo}),n.d(v,"gatherND",function(){return Yo}),n.d(v,"dropout",function(){return Go}),n.d(v,"hannWindow",function(){return Ho}),n.d(v,"hammingWindow",function(){return qo}),n.d(v,"frame",function(){return Ko}),n.d(v,"stft",function(){return Jo}),n.d(v,"inTopKAsync",function(){return Qo}),n.d(v,"op",function(){return R.a}),n.d(v,"image",function(){return g}),n.d(v,"linalg",function(){return m}),n.d(v,"losses",function(){return p}),n.d(v,"spectral",function(){return d}),n.d(v,"fused",function(){return y}),n.d(v,"signal",function(){return f});var b={};n.r(b),n.d(b,"axesAreInnerMostDims",function(){return it}),n.d(b,"combineLocations",function(){return rt}),n.d(b,"computeOutAndReduceShapes",function(){return st}),n.d(b,"expandShapeToKeepDim",function(){return ot}),n.d(b,"assertAxesAreInnerMostDims",function(){return at}),n.d(b,"getAxesPermutation",function(){return ut}),n.d(b,"getUndoAxesPermutation",function(){return lt}),n.d(b,"getInnerMostAxes",function(){return ct}),n.d(b,"getBroadcastDims",function(){return S}),n.d(b,"getReductionAxes",function(){return E}),n.d(b,"assertAndGetBroadcastShape",function(){return O}),n.d(b,"assertParamsConsistent",function(){return D}),n.d(b,"computeOutShape",function(){return P}),n.d(b,"computePool2DInfo",function(){return re}),n.d(b,"computePool3DInfo",function(){return se}),n.d(b,"computeConv2DInfo",function(){return oe}),n.d(b,"computeConv3DInfo",function(){return ae}),n.d(b,"computeDefaultPad",function(){return ue}),n.d(b,"tupleValuesAreOne",function(){return fe}),n.d(b,"eitherStridesOrDilationsAreOne",function(){return pe}),n.d(b,"convertConv2DDataFormat",function(){return me}),n.d(b,"PARALLELIZE_THRESHOLD",function(){return Zs}),n.d(b,"computeOptimalWindowSize",function(){return to}),n.d(b,"nonMaxSuppressionV3",function(){return ma}),n.d(b,"nonMaxSuppressionV5",function(){return ga}),n.d(b,"upcastType",function(){return Va.c}),n.d(b,"getReshaped",function(){return Ha}),n.d(b,"getPermuted",function(){return qa}),n.d(b,"getReshapedPermuted",function(){return Ka}),n.d(b,"getSliceBeginCoords",function(){return Ja}),n.d(b,"getSliceSize",function(){return Qa}),n.d(b,"prepareAndValidate",function(){return sr}),n.d(b,"validateUpdateShape",function(){return or}),n.d(b,"validateInput",function(){return ar}),n.d(b,"calculateShapes",function(){return ur}),n.d(b,"SELU_SCALEALPHA",function(){return On}),n.d(b,"SELU_SCALE",function(){return Cn}),n.d(b,"shouldFuse",function(){return ka}),n.d(b,"ERF_P",function(){return Za}),n.d(b,"ERF_A1",function(){return tu}),n.d(b,"ERF_A2",function(){return eu}),n.d(b,"ERF_A3",function(){return nu}),n.d(b,"ERF_A4",function(){return iu}),n.d(b,"ERF_A5",function(){return ru}),n.d(b,"warn",function(){return su}),n.d(b,"log",function(){return ou}),n.d(b,"mergeRealAndImagArrays",function(){return au}),n.d(b,"splitRealAndImagArrays",function(){return uu}),n.d(b,"complexWithEvenIndex",function(){return lu}),n.d(b,"complexWithOddIndex",function(){return cu}),n.d(b,"getComplexWithIndex",function(){return hu}),n.d(b,"assignToTypedArray",function(){return du}),n.d(b,"exponents",function(){return fu}),n.d(b,"exponent",function(){return pu}),n.d(b,"segment_util",function(){return h}),n.d(b,"castTensor",function(){return mu}),n.d(b,"reshapeTensor",function(){return gu}),n.d(b,"linspaceImpl",function(){return yu});var x={};n.r(x),n.d(x,"nonMaxSuppressionV3",function(){return ma}),n.d(x,"nonMaxSuppressionV5",function(){return ga}),n.d(x,"split",function(){return bu}),n.d(x,"tile",function(){return xu}),n.d(x,"topkImpl",function(){return wu}),n.d(x,"whereImpl",function(){return fn});var w=n(5),T=(n(61),n(6));function S(t,e){const n=t.length,i=[];for(let r=0;r<n;r++){const s=n-1-r,o=t[s]||1;(e[e.length-1-r]||1)>1&&1===o&&i.unshift(s)}return i}function E(t,e){const n=[];for(let i=0;i<e.length;i++){const r=t[t.length-i-1],s=e.length-i-1,o=e[s];(null==r||1===r&&o>1)&&n.unshift(s)}return n}function O(t,e){const n=[],i=Math.max(t.length,e.length);for(let r=0;r<i;r++){let i=t[t.length-r-1];null==i&&(i=1);let s=e[e.length-r-1];if(null==s&&(s=1),1===i)n.unshift(s);else if(1===s)n.unshift(i);else{if(i!==s)throw Error(`Operands could not be broadcast together with shapes ${t} and ${e}.`);n.unshift(i)}}return n}const C={kernelName:T.a,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{let e=t;const i=E(n.shape,r);return i.length>0&&(e=e.sum(i)),e.reshape(n.shape)},b:()=>{let e=t;const n=E(i.shape,r);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}},_={kernelName:T.b,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,i)=>{n[i]=()=>t.clone()}),n}};var A=n(11),k=n(3),R=n(4);const I=Object(R.a)({add_:function(t,e){let n=Object(k.a)(t,"a","add"),i=Object(k.a)(e,"b","add");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.add(n,i);return e([n,i]),r},{a:n,b:i},null,T.a)}});var M=n(7),N=n(1);function D(t,e){const n=t[0].length;t.forEach((t,e)=>{N.assert(t.length===n,()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`)}),N.assert(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const i=t[0];t.forEach((t,r)=>{for(let s=0;s<n;s++)N.assert(s===e||t[s]===i[s],()=>`Error in concat${n}D: Shape of tensors[${r}] (${t}) does not match the shape of the rest (${i}) along the non-concatenated axis ${r}.`)})}function P(t,e){const n=t[0].slice();for(let i=1;i<t.length;i++)n[e]+=t[i][e];return n}var F=n(8);const L=Object(R.a)({concat_:function(t,e=0){Object(N.assert)(t.length>=1,()=>"Pass at least one tensor to concat");let n=Object(k.b)(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)});const i=Object(N.parseAxisParam)(e,n[0].shape)[0],r=P(n.map(t=>t.shape),i);return 0===Object(N.sizeFromShape)(r)?Object(F.f)([],r):(n=n.filter(t=>t.size>0),1===n.length?n[0]:(D(n.map(t=>t.shape),i),w.a.runKernelFunc((t,e)=>{const r=t.concat(n,i);return e(n),r},n,null,T.l,{axis:e})))}});function j(t,e="float32",n){return e=e||"float32",N.assertNonNegativeIntegerDimensions(t),new M.b(t,e,n)}function B(t,e=!1){console.log(t.toString(e))}const z=Object(R.a)({cast_:function(t,e){const n=Object(k.a)(t,"x","cast");if(!N.isValidDtype(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return w.a.runKernelFunc(t=>t.cast(n,e),{x:n},t=>({x:()=>t.clone()}),"Cast",{dtype:e})}}),$=Object(R.a)({expandDims_:function(t,e=0){const n=Object(k.a)(t,"x","expandDims",null);N.assert(e<=n.rank,()=>"Axis must be <= rank of the tensor");const i=n.shape.slice();return e<0&&(N.assert(-(n.rank+1)<=e,()=>`Axis must be in the interval [${-(n.rank+1)}, ${n.rank}]`),e=n.rank+e+1),i.splice(e,0,1),U(n,i)}}),U=Object(R.a)({reshape_:function(t,e){const n=Object(k.a)(t,"x","reshape",null);return e=N.inferFromImplicitShape(e,n.size),N.assert(n.size===N.sizeFromShape(e),()=>"new shape and old shape must have the same number of elements."),w.a.runKernelFunc(t=>t.reshape(n,e),{x:n},t=>({x:()=>t.reshape(n.shape)}),"Reshape",{shape:e})}}),W=Object(R.a)({squeeze_:function(t,e){const n=Object(k.a)(t,"x","squeeze");return U(n,N.squeezeShape(n.shape,e).newShape)}}),V=Object(R.a)({stack_:function(t,e=0){const n=Object(k.b)(t,"tensors","stack");if(N.assert(n.length>=1,()=>"Pass at least one tensor to tf.stack"),1===n.length)return n[0].expandDims(e);const i=n[0].shape,r=n[0].dtype;N.assert(e<=n[0].rank,()=>"Axis must be <= rank of the tensor"),n.forEach(t=>{N.assertShapesMatch(i,t.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(t=>{N.assert(r===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=n.map(t=>t.expandDims(e));return L(s,e)}}),Y=Object(R.a)({unstack_:function(t,e=0){e=e||0;const n=Object(k.a)(t,"x","unstack");return N.assert(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`),e<0&&(e+=n.shape.length),w.a.runKernelFunc(t=>t.unstack(n,e),{x:n},t=>({x:()=>V(t,e)}),"Unpack",{axis:e})}}),G=async function(t,e){const n=Object(k.a)(t,"x","setdiff1d"),i=Object(k.a)(e,"y","setdiff1d");N.assert(n.dtype===i.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${i.dtype}).`),N.assert(1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),N.assert(1===i.rank,()=>`y should be 1D tensor, but got y (${i.shape}).`);const r=await n.data(),s=await i.data(),o=new Set(s);let a=0;for(let c=0;c<r.length;c++)o.has(r[c])||a++;const u=new M.b([a],n.dtype),l=new M.b([a],"int32");for(let c=0,h=0;c<r.length;c++)o.has(r[c])||(u.values[h]=r[c],l.values[h]=c,h++);return[u.toTensor(),l.toTensor()]},X=Object(R.a)({floorDiv_:function(t,e){let n=Object(k.a)(t,"a","floorDiv"),i=Object(k.a)(e,"b","floorDiv");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.floorDiv(n,i);return e([n,i]),r},{a:n,b:i},null,T.D)}}),H=Object(R.a)({div_:function(t,e){let n=Object(k.a)(t,"a","div"),i=Object(k.a)(e,"b","div");return[n,i]=Object(A.makeTypesMatch)(n,i),"int32"===n.dtype&&"int32"===i.dtype?X(n,i):w.a.runKernelFunc((t,e)=>{const r=t.realDivide(n,i);return e([n,i]),r},{a:n,b:i},null,T.y,{})}}),q=Object(R.a)({mul_:function(t,e){let n=Object(k.a)(t,"a","mul"),i=Object(k.a)(e,"b","mul");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.multiply(n,i);return e([n,i]),r},{a:n,b:i},null,T.Y)}});function K(t){return N.assert(N.isFunction(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const i=Object(k.a)(e,"x","tf.grad",null),r=null!=n?Object(k.a)(n,"dy","tf.grad"):null;return w.a.tidy(()=>{const{value:e,grads:n}=w.a.gradients(()=>t(i),[i],r);return null!=r&&N.assertShapesMatch(e.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),nt(n),n[0]})}}function J(t){return N.assert(N.isFunction(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{N.assert(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const i=Object(k.b)(e,"args","tf.grads",null),r=null!=n?Object(k.a)(n,"dy","tf.grads"):null;return w.a.tidy(()=>{const{value:e,grads:n}=w.a.gradients(()=>t(...i),i,r);return null!=r&&N.assertShapesMatch(e.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),nt(n),n})}}function Q(t){return N.assert(N.isFunction(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{N.assert(e instanceof M.a,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),N.assert(null==n||n instanceof M.a,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:i,value:r}=w.a.gradients(()=>t(e),[e],n);return nt(i),{grad:i[0],value:r}}}function Z(t){return N.assert(N.isFunction(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{N.assert(Array.isArray(e)&&e.every(t=>t instanceof M.a),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),N.assert(null==n||n instanceof M.a,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const i=w.a.gradients(()=>t(...e),e,n);return null!=n&&N.assertShapesMatch(i.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),nt(i.grads),i}}function tt(t,e){N.assert(N.isFunction(t),()=>"The f passed in variableGrads(f) must be a function"),N.assert(null==e||Array.isArray(e)&&e.every(t=>t instanceof M.c),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in w.a.registeredVariables)e.push(w.a.registeredVariables[t])}const i=n?e.filter(t=>!t.trainable):null,r=e.length;e=e.filter(t=>t.trainable),N.assert(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const{value:s,grads:o}=w.a.gradients(t,e,null,!0);N.assert(o.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),N.assert(0===s.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);const a={};return e.forEach((t,e)=>{null!=o[e]&&(a[t.name]=o[e])}),null!=i&&i.forEach(t=>a[t.name]=null),{value:s,grads:a}}function et(t){return w.a.customGrad(t)}function nt(t){if(t.filter(t=>null==t).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function it(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function rt(t,e,n){const i=t.length+e.length,r=[];let s=0,o=0;for(let a=0;a<i;a++)-1===n.indexOf(a)?r.push(t[s++]):r.push(e[o++]);return r}function st(t,e){const n=[],i=t.length;for(let r=0;r<i;r++)-1===e.indexOf(r)&&n.push(t[r]);return[n,e.map(e=>t[e])]}function ot(t,e){return rt(t,e.map(t=>1),e)}function at(t,e,n){N.assert(it(e,n),()=>t+" supports only inner-most axes for now. "+`Got axes ${e} and rank-${n} input.`)}function ut(t,e){if(it(t,e))return null;const n=[];for(let i=0;i<e;++i)-1===t.indexOf(i)&&n.push(i);return t.forEach(t=>n.push(t)),n}function lt(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function ct(t,e){const n=[];for(let i=e-t;i<e;++i)n.push(i);return n}function ht(t,e,n,i,r){return e.rank<n.rank&&(e=e.reshape(ot(e.shape,i))),t.rank<n.rank&&(t=t.reshape(ot(t.shape,i))),{x:()=>{const i=t.mul(n.equal(e).cast(t.dtype));return null==r?i:i.transpose(r)}}}const dt=Object(R.a)({all_:function(t,e=null,n=!1){let i=Object(k.a)(t,"x","all","bool");const r=N.parseAxisParam(e,i.shape);let s=r;const o=ut(s,i.rank);null!=o&&(i=i.transpose(o),s=ct(s.length,i.rank));const a=w.a.runKernelFunc(t=>t.all(i,s),{$x:i});if(n){const t=ot(a.shape,r);return a.reshape(t)}return a}}),ft=Object(R.a)({any_:function(t,e=null,n=!1){let i=Object(k.a)(t,"x","any","bool");const r=N.parseAxisParam(e,i.shape);let s=r;const o=ut(s,i.rank);null!=o&&(i=i.transpose(o),s=ct(s.length,i.rank));const a=w.a.runKernelFunc(t=>t.any(i,s),{$x:i});if(n){const t=ot(a.shape,r);return a.reshape(t)}return a}}),pt=Object(R.a)({argMax_:function(t,e=0){let n=Object(k.a)(t,"x","argMax");null==e&&(e=0);let i=N.parseAxisParam(e,n.shape);const r=ut(i,n.rank);return null!=r&&(n=n.transpose(r),i=ct(i.length,n.rank)),w.a.runKernelFunc((t,e)=>{const r=t.argMax(n,i[0]);return e([n]),r},{x:n},(t,e)=>{const[n]=e;return{x:()=>Object(F.o)(n)}},"ArgMax",{axis:i[0]},[n])}}),mt=Object(R.a)({argMin_:function(t,e=0){let n=Object(k.a)(t,"x","argMin");null==e&&(e=0);let i=N.parseAxisParam(e,n.shape);const r=ut(i,n.rank);return null!=r&&(n=n.transpose(r),i=ct(i.length,n.rank)),w.a.runKernelFunc((t,e)=>{const r=t.argMin(n,i[0]);return e([n]),r},{$x:n},(t,e)=>{const[n]=e;return{$x:()=>Object(F.o)(n)}})}}),gt=Object(R.a)({logSumExp_:function(t,e=null,n=!1){const i=Object(k.a)(t,"x","logSumExp"),r=N.parseAxisParam(e,i.shape),s=i.max(r,!0),o=i.sub(s).exp().sum(r).log(),a=s.reshape(o.shape).add(o);if(n){const t=ot(a.shape,r);return a.reshape(t)}return a}}),yt=Object(R.a)({mean_:function(t,e=null,n=!1){const i=Object(k.a)(t,"x","mean"),r=N.parseAxisParam(e,i.shape),s=st(i.shape,r),o=N.sizeFromShape(s[1]);return et(t=>{const i=Object(F.e)(o);return{value:(i.dtype===t.dtype?t:t.cast(i.dtype)).div(i).sum(e,n),gradFunc:e=>{const n=t.shape.slice();return r.forEach(t=>{n[t]=1}),e.reshape(n).mul(Object(F.b)(t.shape,"float32")).div(o)}}})(i)}}),vt=Object(R.a)({min_:function(t,e=null,n=!1){let i=Object(k.a)(t,"x","min");const r=i,s=N.parseAxisParam(e,i.shape);let o=s;const a=ut(o,i.rank);null!=a&&(i=i.transpose(a),o=ct(o.length,i.rank));let u=w.a.runKernelFunc((t,e)=>{const n=t.min(i,o);return e([r,n]),n},{x:i},(t,e)=>ht(t,e[1],e[0],s,a),"Min",{axes:o},[i],[!0]);if(n){const t=ot(u.shape,s);u=u.reshape(t)}return u}}),bt=Object(R.a)({moments_:function(t,e=null,n=!1){t=Object(k.a)(t,"x","moments");const i=N.parseAxisParam(e,t.shape),r=t.mean(i,n);let s=r.shape;n||(s=ot(r.shape,i));const o=t.toFloat().sub(r.reshape(s)).square();return{mean:r,variance:o.mean(i,n)}}}),xt=Object(R.a)({sum_:function(t,e=null,n=!1){let i=Object(k.a)(t,"x","sum");"bool"===i.dtype&&(i=i.toInt());const r=N.parseAxisParam(e,i.shape);return et(t=>{const e=ut(r,t.rank);let i=r,s=t;null!=e&&(s=t.transpose(e),i=ct(i.length,t.rank));const o=e=>{const n=t.shape.slice();return r.forEach(t=>{n[t]=1}),e.reshape(n).mul(Object(F.b)(t.shape,"float32"))};let a=w.a.runKernelFunc(t=>t.sum(s,i),{x:s},t=>({x:()=>o(t)}),"Sum",{axes:i});if(n){const t=ot(a.shape,r);a=a.reshape(t)}return{value:a,gradFunc:o}})(i)}}),wt=Object(R.a)({prod_:function(t,e=null,n=!1){let i=Object(k.a)(t,"x","prod");"bool"===i.dtype&&(i=i.toInt());const r=N.parseAxisParam(e,i.shape),s=ut(r,i.rank);let o=r,a=i;null!=s&&(a=i.transpose(s),o=ct(o.length,i.rank));let u=w.a.runKernelFunc(t=>t.prod(a,o),{permutedX:a});if(n){const t=ot(u.shape,r);u=u.reshape(t)}return u}}),Tt=Object(R.a)({square_:function(t){const e=Object(k.a)(t,"x","square");return w.a.runKernelFunc((t,n)=>(n([e]),t.square(e)),{x:e},null,"Square",{},[e],[])}}),St=Object(R.a)({abs_:function(t){const e=Object(k.a)(t,"x","abs");return"complex64"===e.dtype?w.a.runKernelFunc(t=>t.complexAbs(e),{$x:e}):w.a.runKernelFunc((t,n)=>{const i=t.abs(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.mul(n.toFloat().step(-1))}},"Abs")}}),Et=Object(R.a)({acos_:function(t){const e=Object(k.a)(t,"x","acos");return w.a.runKernelFunc((t,n)=>{const i=t.acos(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=n.toFloat().square(),i=Object(F.e)(1).sub(e).sqrt();return t.div(i).neg()}}})}}),Ot=Object(R.a)({acosh_:function(t){const e=Object(k.a)(t,"x","acosh");return w.a.runKernelFunc((t,n)=>{const i=t.acosh(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=n.toFloat().square().sub(1).sqrt();return t.div(e)}}})}}),Ct=Object(R.a)({asin_:function(t){const e=Object(k.a)(t,"x","asin");return w.a.runKernelFunc((t,n)=>{const i=t.asin(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(Object(F.e)(1).sub(n.toFloat().square()).sqrt())}})}}),_t=Object(R.a)({asinh_:function(t){const e=Object(k.a)(t,"x","asinh");return w.a.runKernelFunc((t,n)=>{const i=t.asinh(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>{const e=Object(F.e)(1).add(n.toFloat().square()).sqrt();return t.div(e)}}})}}),At=Object(R.a)({atan_:function(t){const e=Object(k.a)(t,"x","atan");return w.a.runKernelFunc((t,n)=>{const i=t.atan(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.toFloat().square().add(1))}})}}),kt=Object(R.a)({atanh_:function(t){const e=Object(k.a)(t,"x","atanh");return w.a.runKernelFunc((t,n)=>{const i=t.atanh(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(Object(F.e)(1).sub(n.toFloat().square()))}})}}),Rt=Object(R.a)({ceil_:function(t){const e=Object(k.a)(t,"x","ceil");return w.a.runKernelFunc(t=>t.ceil(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),It=Object(R.a)({clipByValue_:function(t,e,n){const i=Object(k.a)(t,"x","clipByValue");return N.assert(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),w.a.runKernelFunc((t,r)=>{const s=t.clip(i,e,n);return r([i]),s},{x:i},(t,i)=>{const[r]=i;return{x:()=>t.where(r.greaterEqual(e).logicalAnd(r.lessEqual(n)),Object(F.o)(t))}},"ClipByValue",{min:e,max:n},[i])}}),Mt=Object(R.a)({cos_:function(t){const e=Object(k.a)(t,"x","cos");return w.a.runKernelFunc((t,n)=>{const i=t.cos(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>n.toFloat().sin().neg().mul(t)}},"Cos",{},[e])}}),Nt=Object(R.a)({cosh_:function(t){const e=Object(k.a)(t,"x","cosh");return w.a.runKernelFunc((t,n)=>{const i=t.cosh(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>n.toFloat().sinh().mul(t)}})}}),Dt=Object(R.a)({erf_:function(t){let e=Object(k.a)(t,"x","erf");return N.assert("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=e.toFloat()),w.a.runKernelFunc((t,n)=>{const i=t.erf(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}})}}),Pt=Object(R.a)({exp_:function(t){const e=Object(k.a)(t,"x","exp");return w.a.runKernelFunc((t,n)=>{const i=t.exp(e);return n([i]),i},{x:e},(t,e)=>({x:()=>t.mul(e[0])}),"Exp",{},[],[!0])}}),Ft=Object(R.a)({expm1_:function(t){const e=Object(k.a)(t,"x","expm1");return w.a.runKernelFunc((t,n)=>{const i=t.expm1(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.exp())}})}}),Lt=Object(R.a)({floor_:function(t){const e=Object(k.a)(t,"x","floor");return w.a.runKernelFunc(t=>t.floor(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),jt=Object(R.a)({log_:function(t){const e=Object(k.a)(t,"x","log");return w.a.runKernelFunc((t,n)=>{const i=t.log(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.toFloat())}},"Log",{},[e])}}),Bt=Object(R.a)({log1p_:function(t){const e=Object(k.a)(t,"x","log1p");return w.a.runKernelFunc((t,n)=>{const i=t.log1p(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.add(1))}})}}),zt=Object(R.a)({logSigmoid_:function(t){const e=Object(k.a)(t,"x","logSigmoid");return w.a.runKernelFunc((t,n)=>{const i=t.softplus(e.neg()).neg();return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.neg().sigmoid())}})}}),$t=Object(R.a)({neg_:function(t){const e=Object(k.a)(t,"x","neg");return w.a.runKernelFunc(t=>t.neg(e),{x:e},t=>({x:()=>t.neg()}),"Neg",{},[e])}}),Ut=Object(R.a)({reciprocal_:function(t){const e=Object(k.a)(t,"x","reciprocal");return w.a.runKernelFunc((t,n)=>{const i=t.reciprocal(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.square().neg())}})}}),Wt=Object(R.a)({round_:function(t){const e=Object(k.a)(t,"x","round");return w.a.runKernelFunc(t=>t.round(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),Vt=Object(R.a)({rsqrt_:function(t){const e=Object(k.a)(t,"x","rsqrt");return w.a.runKernelFunc((t,n)=>{const i=t.rsqrt(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.pow(1.5).mul(2)).neg()}},"Rsqrt",{},[e])}}),Yt=Object(R.a)({sigmoid_:function(t){const e=Object(k.a)(t,"x","sigmoid");return w.a.runKernelFunc((t,n)=>{const i=t.sigmoid(e);return n([i]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.mul(n.mul(Object(F.e)(1).sub(n)))}},"Sigmoid")}}),Gt=Object(R.a)({sign_:function(t){const e=Object(k.a)(t,"x","sign");return w.a.runKernelFunc(t=>t.sign(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),Xt=Object(R.a)({isNaN_:function(t){const e=Object(k.a)(t,"x","isNaN");return w.a.runKernelFunc(t=>t.isNaN(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),Ht=Object(R.a)({isInf_:function(t){const e=Object(k.a)(t,"x","isInf");return w.a.runKernelFunc(t=>t.isInf(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),qt=Object(R.a)({isFinite_:function(t){const e=Object(k.a)(t,"x","isFinite");return w.a.runKernelFunc(t=>t.isFinite(e),{$x:e},t=>({$x:()=>Object(F.o)(t)}))}}),Kt=Object(R.a)({sin_:function(t){const e=Object(k.a)(t,"x","sin");return w.a.runKernelFunc((t,n)=>{const i=t.sin(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>n.toFloat().cos().mul(t)}},"Sin",{},[e])}}),Jt=Object(R.a)({sinh_:function(t){const e=Object(k.a)(t,"x","sinh");return w.a.runKernelFunc((t,n)=>{const i=t.sinh(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>n.toFloat().cosh().mul(t)}})}}),Qt=Object(R.a)({softplus_:function(t){const e=Object(k.a)(t,"x","softplus");return w.a.runKernelFunc((t,n)=>{const i=t.softplus(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.mul(n.sigmoid())}})}}),Zt=Object(R.a)({sqrt_:function(t){const e=Object(k.a)(t,"x","sqrt");return w.a.runKernelFunc((t,n)=>{const i=t.sqrt(e);return n([e]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>t.div(n.toFloat().sqrt().mul(2))}},"Sqrt",{})}}),te=Object(R.a)({step_:function(t,e=0){const n=Object(k.a)(t,"x","step");return w.a.runKernelFunc(t=>t.step(n,e),{$x:n},t=>({$x:()=>Object(F.o)(t)}))}}),ee=Object(R.a)({tan_:function(t){const e=Object(k.a)(t,"x","tan");return w.a.runKernelFunc((t,n)=>{const i=t.tan(e);return n([e]),i},{$x:e},(t,e)=>{const[n]=e;return{$x:()=>t.div(n.cos().square())}})}}),ne=Object(R.a)({tanh_:function(t){const e=Object(k.a)(t,"x","tanh");return w.a.runKernelFunc((t,n)=>{const i=t.tanh(e);return n([i]),i},{x:e},(t,e)=>{const[n]=e;return{x:()=>Object(F.e)(1).sub(n.square()).mul(t)}},"Tanh",{},null,[!0])}}),ie={kernelName:T.c,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{const e=I(Tt(n),Tt(i));let s=q(t,H(i,e));const o=E(n.shape,r);return o.length>0&&(s=xt(s,o)),U(s,n.shape)},b:()=>{const e=I(Tt(n),Tt(i));let s=$t(q(t,H(n,e)));const o=E(i.shape,r);return o.length>0&&(s=xt(s,o)),U(s,i.shape)}}}};function re(t,e,n,i,r,s,o="channelsLast"){const[a,u]=le(e);let l;if("channelsLast"===o)l=[a,u,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);l=[a,u,t[1],t[1]]}return oe(t,l,n,i,r,s,!1,o)}function se(t,e,n,i,r,s,o="NDHWC"){const[a,u,l]=ce(e);let c,h;if("NDHWC"===o)h="channelsLast",c=[a,u,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);h="channelsFirst",c=[a,u,l,t[1],t[1]]}return ae(t,c,n,i,r,!1,h,s)}function oe(t,e,n,i,r,s,o=!1,a="channelsLast"){let[u,l,c,h]=[-1,-1,-1,-1];if("channelsLast"===a)[u,l,c,h]=t;else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);[u,h,l,c]=t}const[d,f,,p]=e,[m,g]=le(n),[y,v]=le(i),b=he(d,y),x=he(f,v),{padInfo:w,outHeight:T,outWidth:S}=function(t,e,n,i,r,s,o,a,u){let l,c,h;if("number"==typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const r=function(t,e,n,i,r){null==i&&(i=ue(t,e,n));const s=t[1],o=de((t[0]-e+2*i)/n+1,r);N.assert(N.isInt(o),()=>`The output # of rows (${o}) must be an integer. Change the stride and/or zero pad parameters`);const a=de((s-e+2*i)/n+1,r);return N.assert(N.isInt(a),()=>`The output # of columns (${a}) must be an integer. Change the stride and/or zero pad parameters`),[o,a]}([e,n],s,i,t,a);c=r[0],h=r[1]}else if("same"===t){c=Math.ceil(e/i),h=Math.ceil(n/r);const t=Math.max(0,(c-1)*i+s-e),a=Math.max(0,(h-1)*r+o-n),u=Math.floor(t/2),d=t-u,f=Math.floor(a/2);l={top:u,bottom:d,left:f,right:a-f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-s+1)/i),h=Math.ceil((n-o+1)/r);else{if("object"!=typeof t)throw Error("Unknown padding parameter: "+t);{const d="channelsLast"===u?t[1][0]:t[2][0],f="channelsLast"===u?t[1][1]:t[2][1],p="channelsLast"===u?t[2][0]:t[3][0],m="channelsLast"===u?t[2][1]:t[3][1];l={top:d,bottom:f,left:p,right:m,type:0===d&&0===f&&0===p&&0===m?"VALID":"EXPLICIT"},c=de((e-s+d+f)/i+1,a),h=de((n-o+p+m)/r+1,a)}}return{padInfo:l,outHeight:c,outWidth:h}}(r,l,c,m,g,b,x,s,a),E=o?p*h:p;let O;return"channelsFirst"===a?O=[u,E,T,S]:"channelsLast"===a&&(O=[u,T,S,E]),{batchSize:u,dataFormat:a,inHeight:l,inWidth:c,inChannels:h,outHeight:T,outWidth:S,outChannels:E,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:y,dilationWidth:v,inShape:t,outShape:O,filterShape:e}}function ae(t,e,n,i,r,s=!1,o="channelsLast",a){let[u,l,c,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[u,l,c,h,d]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);[u,d,l,c,h]=t}const[f,p,m,,g]=e,[y,v,b]=ce(n),[x,w,T]=ce(i),S=he(f,x),E=he(p,w),O=he(m,T),{padInfo:C,outDepth:_,outHeight:A,outWidth:k}=function(t,e,n,i,r,s,o,a,u,l,c){let h,d,f,p;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const s=function(t,e,n,i,r,s){null==r&&(r=ue(t,e,i));const o=t[1],a=t[2],u=de((t[0]-e+2*r)/i+1,s);N.assert(N.isInt(u),()=>`The output # of depths (${u}) must be an integer. Change the stride and/or zero pad parameters`);const l=de((o-e+2*r)/i+1,s);N.assert(N.isInt(l),()=>`The output # of rows (${l}) must be an integer. Change the stride and/or zero pad parameters`);const c=de((a-e+2*r)/i+1,s);return N.assert(N.isInt(c),()=>`The output # of columns (${c}) must be an integer. Change the stride and/or zero pad parameters`),[u,l,c,1]}([e,n,i,1],a,0,r,t,c);d=s[0],f=s[1],p=s[2]}else if("same"===t){d=Math.ceil(e/r),f=Math.ceil(n/s),p=Math.ceil(i/o);const t=(d-1)*r+a-e,c=(f-1)*s+u-n,m=(p-1)*o+l-i,g=Math.floor(t/2),y=t-g,v=Math.floor(c/2),b=c-v,x=Math.floor(m/2);h={top:v,bottom:b,left:x,right:m-x,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/r),f=Math.ceil((n-u+1)/s),p=Math.ceil((i-l+1)/o)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(r,l,c,h,y,v,b,S,E,O,a),R=s?g*d:g;let I;return"channelsFirst"===o?I=[u,R,_,A,k]:"channelsLast"===o&&(I=[u,_,A,k,R]),{batchSize:u,dataFormat:o,inDepth:l,inHeight:c,inWidth:h,inChannels:d,outDepth:_,outHeight:A,outWidth:k,outChannels:R,padInfo:C,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:E,effectiveFilterWidth:O,dilationDepth:x,dilationHeight:w,dilationWidth:T,inShape:t,outShape:I,filterShape:e}}function ue(t,e,n,i=1){const r=he(e,i);return Math.floor((t[0]*(n-1)-n+r)/2)}function le(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ce(t){return"number"==typeof t?[t,t,t]:t}function he(t,e){return e<=1?t:t+(t-1)*(e-1)}function de(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function fe(t){const[e,n,i]=le(t);return 1===e&&1===n&&1===i}function pe(t,e){return fe(t)||fe(e)}function me(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}const ge=Object(R.a)({avgPool3dBackprop_:function(t,e,n,i,r=[1,1,1],s,o){const a=Object(k.a)(t,"dy","avgPool3dBackprop"),u=Object(k.a)(e,"input","avgPool3dBackprop");let l=a,c=u,h=!1;4===u.rank&&(h=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),c=U(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),N.assert(5===l.rank,()=>"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+l.rank+"."),N.assert(5===c.rank,()=>"Error in avgPool3dBackprop: input must be rank 5 but got rank "+c.rank+"."),N.assert(pe(i,r),()=>`Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides ${i} and dilations '${r}'`),null!=o&&N.assert(N.isInt(s),()=>`Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`);const d=w.a.runKernelFunc(t=>{const e=se(c.shape,n,i,r,s,o);return t.avgPool3dBackprop(l,c,e)},{dy:l,input:c},null,T.f,{filterSize:n,strides:i,dilations:r,pad:s,dimRoundingMode:o});return h?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),ye={kernelName:T.e,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,dilations:o,pad:a,dimRoundingMode:u}=n,l=null==o?[1,1,1]:o;return{x:()=>ge(t,i,r,s,l,a,u)}}},ve=Object(R.a)({avgPoolBackprop_:function(t,e,n,i,r){const s=Object(k.a)(t,"dy","avgPoolBackprop"),o=Object(k.a)(e,"input","avgPoolBackprop");N.assert(o.rank===s.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${s.rank})`);let a=o,u=s,l=!1;3===o.rank&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),N.assert(4===u.rank,()=>"Error in avgPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."),N.assert(4===a.rank,()=>"Error in avgPoolBackprop: input must be rank 4 but got rank "+a.rank+".");const c=w.a.runKernelFunc(t=>{const e=re(a.shape,n,i,1,r);return t.avgPoolBackprop(u,a,e)},{dy:u,input:a},null,T.g,{filterSize:n,strides:i,pad:r});return l?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),be={kernelName:T.d,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{filterSize:r,strides:s,pad:o}=n;return{x:()=>ve(t,i,r,s,o)}}},xe=Object(R.a)({matMul_:function(t,e,n=!1,i=!1){let r=Object(k.a)(t,"a","matMul"),s=Object(k.a)(e,"b","matMul");[r,s]=Object(A.makeTypesMatch)(r,s),N.assert(r.rank>=2&&s.rank>=2&&r.rank===s.rank,()=>`Error in matMul: inputs must have the same rank of at least 2, got ranks ${r.rank} and ${s.rank}.`);const o=n?r.shape[r.rank-2]:r.shape[r.rank-1],a=i?s.shape[s.rank-1]:s.shape[s.rank-2],u=n?r.shape[r.rank-1]:r.shape[r.rank-2],l=i?s.shape[s.rank-2]:s.shape[s.rank-1],c=r.shape.slice(0,-2),h=s.shape.slice(0,-2),d=N.sizeFromShape(c),f=N.sizeFromShape(h);N.assert(N.arraysEqual(c,h),()=>`Error in matMul: outer dimensions (${c}) and (${h}) of Tensors with shapes ${r.shape} and `+s.shape+" must match."),N.assert(o===a,()=>`Error in matMul: inner shapes (${o}) and (${a}) of Tensors with shapes ${r.shape} and ${s.shape} and transposeA=${n} and transposeB=${i} must match.`);const p=r.shape.slice(0,-2).concat([u,l]),m=U(r,n?[d,o,u]:[d,u,o]),g=U(s,i?[f,l,a]:[f,a,l]),y=w.a.runKernelFunc((t,e)=>(e([m,g]),t.batchMatMul(m,g,n,i)),{a:m,b:g},null,T.h,{transposeA:n,transposeB:i});return U(y,p)}}),we={kernelName:T.h,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[i,r]=e,{transposeA:s,transposeB:o}=n;return s||o?!s&&o?{a:()=>xe(t,r,!1,!1),b:()=>xe(t,i,!0,!1)}:s&&!o?{a:()=>xe(r,t,!1,!0),b:()=>xe(i,t,!1,!1)}:{a:()=>xe(r,t,!0,!0),b:()=>xe(t,i,!0,!0)}:{a:()=>xe(t,r,!1,!0),b:()=>xe(i,t,!0,!1)}}},Te=Object(R.a)({spaceToBatchND_:function(t,e,n){const i=Object(k.a)(t,"x","spaceToBatchND");return N.assert(i.rank>=1+e.length,()=>`input rank ${i.rank} should be > than [blockShape] ${e.length}`),N.assert(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),N.assert(i.shape.reduce((t,i,r)=>r>0&&r<=e.length?t&&(i+n[r-1][0]+n[r-1][1])%e[r-1]==0:t,!0),()=>`input spatial dimensions ${i.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`),w.a.runKernelFunc(t=>t.spaceToBatchND(i,e,n),{x:i},null,T.mb,{blockShape:e,paddings:n})}}),Se={kernelName:T.i,gradFunc:(t,e,n)=>{const{blockShape:i,crops:r}=n;return{x:()=>Te(t,i,r)}}},Ee={kernelName:T.j,gradFunc:(t,e,n)=>{const i=n.inputShape,r=n.shape,s=Array.from(r);for(let a=i.length-1;a>=0;a--)if(i[a]===r[a])s[a]=1;else if(1!==i[a])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${r}].`);const o=[];for(let a=0;a<s.length;a++)s[a]>1&&o.push(a);return{x:()=>xt(t,o,!0)}}},Oe=Object(R.a)({split_:function(t,e,n=0){const i=Object(k.a)(t,"x","split"),r=Object(N.parseAxisParam)(n,i.shape)[0];let s;return"number"==typeof e?(Object(N.assert)(i.shape[r]%e==0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(i.shape[r]/e)):(Object(N.assert)(i.shape[r]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),s=e),w.a.runKernelFunc((t,e)=>t.split(i,s,r),{x:i},null,T.nb,{numOrSizeSplits:e,axis:n})}}),Ce={kernelName:T.l,saveAllInputs:!0,gradFunc:(t,e,n)=>{const i=e.map(t=>t.shape),{axis:r}=n,s=Object(N.parseAxisParam)(r,e[0].shape)[0],o=i.map(t=>t[s]);return Oe(t,o,s).map(t=>()=>t)}},_e=Object(R.a)({conv2DBackpropFilter_:function(t,e,n,i,r,s="NHWC",o){let a=t;3===t.rank&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;3===u.rank&&(u=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),N.assert(4===a.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+a.shape+"."),N.assert(4===u.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."),N.assert(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+".");const l="NHWC"===s?a.shape[3]:a.shape[1],c="NHWC"===s?u.shape[3]:u.shape[1];return N.assert(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),N.assert(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),null!=o&&N.assert(N.isInt(r),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`),w.a.runKernelFunc(t=>{const e=me(s),l=oe(a.shape,n,i,1,r,o,!1,e);return t.conv2dDerFilter(a,u,l)},{x:a,dy:u},null,T.n,{strides:i,pad:r,dataFormat:s,dimRoundingMode:o})}}),Ae=Object(R.a)({conv2DBackpropInput_:function(t,e,n,i,r,s="NHWC",o){N.assert(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,u=e,l=!1;3===e.rank&&(l=!0,u=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),N.assert(4===a.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+a.length+"."),N.assert(4===u.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank),N.assert(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank);const c="NHWC"===s?a[3]:a[1],h="NHWC"===s?u.shape[3]:u.shape[1];N.assert(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),N.assert(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),null!=o&&N.assert(N.isInt(r),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`);const d=w.a.runKernelFunc((t,e)=>{const l=me(s),c=oe(a,n.shape,i,1,r,o,!1,l),h=t.conv2dDerInput(u,n,c);return e([u,n]),h},{dy:u,filter:n},null,T.o,{strides:i,pad:r,dataFormat:s,dimRoundingMode:o});return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),ke={kernelName:T.m,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{dilations:s,strides:o,pad:a,dataFormat:u}=n;return N.assert(fe(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>Ae(i.shape,t,r,o,a,u),filter:()=>_e(i,t,r.shape,o,a,u)}}},Re=Object(R.a)({conv2d_:function(t,e,n,i,r="NHWC",s=[1,1],o){const a=Object(k.a)(t,"x","conv2d"),u=Object(k.a)(e,"filter","conv2d");let l=a,c=!1;3===a.rank&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N.assert(4===l.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),N.assert(4===u.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."),null!=o&&N.assert(N.isInt(i),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`);const h="NHWC"===r?l.shape[3]:l.shape[1];N.assert(h===u.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${u.shape[2]}.`),N.assert(pe(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const d=w.a.runKernelFunc((t,e)=>{const a=me(r),c=oe(l.shape,u.shape,n,s,i,o,!1,a),h=t.conv2d(l,u,c);return e([l,u]),h},{x:l,filter:u},null,T.m,{strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o});return c?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Ie={kernelName:T.o,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[i,r]=e,{strides:s,pad:o,dataFormat:a,dimRoundingMode:u}=n;return{dy:()=>Re(t,r,s,o,a,1,u),filter:()=>_e(t,i,r.shape,s,o,a,u)}}},Me=Object(R.a)({conv3DBackpropFilter_:function(t,e,n,i,r){let s=t;4===t.rank&&(s=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;return 4===o.rank&&(o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),N.assert(5===s.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+s.shape+"."),N.assert(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."),N.assert(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."),N.assert(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),N.assert(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`),w.a.runKernelFunc(t=>{const e=ae(s.shape,n,i,1,r);return t.conv3dDerFilter(s,o,e)},{x:s,y:o},null,T.q,{strides:i,pad:r})}}),Ne=Object(R.a)({conv3DBackpropInput_:function(t,e,n,i,r){N.assert(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,o=e,a=!1;4===e.rank&&(a=!0,o=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const u=s[4],l=o.shape[4];N.assert(5===s.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+s.length+"."),N.assert(5===o.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank),N.assert(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank),N.assert(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),N.assert(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);const c=w.a.runKernelFunc(t=>{const e=ae(s,n.shape,i,1,r);return t.conv3dDerInput(o,n,e)},{dy:o},null,T.r,{pad:r});return a?U(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),De={kernelName:T.p,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s}=n;N.assert(fe(i),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const[o,a]=e;return{x:()=>Ne(o.shape,t,a,r,s),filter:()=>Me(o,t,a.shape,r,s)}}},Pe=Object(R.a)({transpose_:function(t,e){const n=Object(k.a)(t,"x","transpose");return null==e&&(e=n.shape.map((t,e)=>e).reverse()),N.assert(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${e}.`),e.forEach(t=>{N.assert(t>=0&&t<n.rank,()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e)}),n.rank<=1?n.clone():w.a.runKernelFunc(t=>t.transpose(n,e),{x:n},null,"Transpose",{perm:e})}}),Fe=Object(R.a)({cumsum_:function(t,e=0,n=!1,i=!1){const r=Object(k.a)(t,"x","cumsum");return w.a.runKernelFunc((t,s)=>{const o=ut([e],r.rank);let a=r;null!=o&&(a=Pe(r,o));const u=ct(1,r.rank)[0];let l=t.cumsum(a,u,n,i);return s([r]),null!=o&&(l=Pe(l,o)),l},{x:r},null,T.s,{axis:e,exclusive:n,reverse:i})}}),Le={kernelName:T.s,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{axis:r,exclusive:s,reverse:o}=n;return{x:()=>{const e=ut([r],i.rank);let n=Fe(t,r,s,!o);return null!=e&&(n=Pe(n,e)),n}}}},je=Object(R.a)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,i){let r=t;3===t.rank&&(r=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let s=e;return 3===s.rank&&(s=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),w.a.runKernelFunc(t=>t.depthwiseConv2DDerFilter(r,s,i),{x:r,dy:s},null,T.v)}}),Be=Object(R.a)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,i){let r=e,s=!1;3===e.rank&&(s=!0,r=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const o=w.a.runKernelFunc(t=>t.depthwiseConv2DDerInput(r,n,i),{dy:r},null,T.w);return s?U(o,[o.shape[1],o.shape[2],o.shape[3]]):o}}),ze={kernelName:T.u,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:i,strides:r,pad:s,dimRoundingMode:o}=n,a=null==i?[1,1]:i;N.assert(fe(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[u,l]=e;N.assert(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),N.assert(4===l.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),N.assert(u.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),N.assert(pe(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),null!=o&&N.assert(N.isInt(s),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`);const c=oe(u.shape,l.shape,r,a,s,o,!0);return{x:()=>Be(u.shape,t,l,c),filter:()=>je(u,t,l.shape,c)}}},$e={kernelName:T.y,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{const e=H(t,i.toFloat()),s=E(n.shape,r);return s.length>0?xt(e,s).reshape(n.shape):e},b:()=>{let e=q(t,n.toFloat());const s=E(i.shape,r);s.length>0&&(e=U(xt(e,s),i.shape));const o=Tt(i);return $t(H(e,o.toFloat()))}}}},Ue={kernelName:T.z,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,i=e=>e.eluDer(t,n),r={dy:t,y:n};return{x:()=>w.a.runKernelFunc(i,r,null,T.A)}}},We={kernelName:T.D,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{const e=t.div(i.toFloat()),s=E(n.shape,r);return s.length>0?e.sum(s).reshape(n.shape):e},b:()=>{let e=t.mul(n.toFloat());const s=E(i.shape,r);s.length>0&&(e=e.sum(s).reshape(i.shape));const o=i.square();return e.div(o.toFloat()).neg()}}}},Ve=Object(R.a)({sub_:function(t,e){let n=Object(k.a)(t,"a","sub"),i=Object(k.a)(e,"b","sub");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.subtract(n,i);return e([n,i]),r},{a:n,b:i},null,T.qb)}}),Ye=Object(R.a)({tile_:function(t,e){const n=Object(k.a)(t,"x","tile",null);return N.assert(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`),w.a.runKernelFunc((t,i)=>{const r=t.tile(n,e);return i([n]),r},{x:n},null,T.rb,{reps:e},[n])}}),Ge={kernelName:T.F,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:i}=n,[r,s,o,a]=e,u=null==a?Object(F.e)(1):a,l=E(s.shape,r.shape),c=[];if(1===s.rank){for(let t=0;t<r.shape.length-1;++t)c.push(r.shape[t]);c.push(1)}const h=Ve(r,s),d=q(t,u),f=Vt(I(o,Object(F.e)(i))),p=q(q(q(f,f),f),Object(F.e)(-.5));return{x:()=>U(q(q(t,1===s.rank?Ye(f.as4D(1,1,1,s.shape[0]),c):f),u),r.shape),mean:()=>{let t=q(q(f,Object(F.e)(-1)),d);return 1===s.rank&&(t=xt(t,l)),U(t,s.shape)},variance:()=>{let t=q(q(p,h),d);return 1===s.rank&&(t=xt(t,l)),U(t,s.shape)},scale:()=>{const e=q(h,f);let n=q(t,e);return 1===s.rank&&(n=xt(n,l)),U(n,s.shape)},offset:()=>{let e=t;return 1===s.rank&&(e=xt(e,l)),U(e,s.shape)}}}},Xe={kernelName:T.I,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>Object(F.o)(n),b:()=>Object(F.o)(i)}}},He={kernelName:T.J,gradFunc:t=>({x:()=>t.toFloat()})},qe=Object(R.a)({localResponseNormalizationBackprop_:function(t,e,n,i=5,r=1,s=1,o=.5){return w.a.runKernelFunc(a=>a.LRNGrad(n,t,e,i,r,s,o),{x:t,y:e,dy:n},null,T.M,{depthRadius:i,bias:r,alpha:s,beta:o})}}),Ke={kernelName:T.L,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{depthRadius:s,bias:o,alpha:a,beta:u}=n;return{x:()=>qe(i,r,t,s,o,a,u)}}},Je={kernelName:T.P,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const i=n,{reductionIndices:r}=i,[s,o]=e,a=N.parseAxisParam(r,s.shape),u=ut(a,s.rank),l=ht(t,o,s,a,u);return{x:()=>{let t=l.x();return null!=u&&(t=Pe(t)),t}}}},Qe=Object(R.a)({greaterEqual_:function(t,e){let n=Object(k.a)(t,"a","greaterEqual"),i=Object(k.a)(e,"b","greaterEqual");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc((t,e)=>{const r=t.greaterEqual(n,i);return e([n,i]),r},{a:n,b:i},null,T.I)}}),Ze=Object(R.a)({less_:function(t,e){let n=Object(k.a)(t,"a","less"),i=Object(k.a)(e,"b","less");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc(t=>t.less(n,i),{a:n,b:i},null,T.N)}}),tn={kernelName:T.V,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>q(t,z(Qe(n,i),"float32")),b:()=>q(t,z(Ze(n,i),"float32"))}}},en=Object(R.a)({maxPool3dBackprop_:function(t,e,n,i,r,s=[1,1,1],o,a){const u=Object(k.a)(t,"dy","maxPool3dBackprop"),l=Object(k.a)(e,"input","maxPool3dBackprop"),c=Object(k.a)(n,"output","maxPool3dBackprop");let h=u,d=l,f=c,p=!1;4===l.rank&&(p=!0,h=U(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=U(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),N.assert(5===h.rank,()=>"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."),N.assert(5===d.rank,()=>"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."),N.assert(5===f.rank,()=>"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."),N.assert(pe(r,s),()=>`Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`),null!=a&&N.assert(N.isInt(o),()=>`Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode ${a} but got pad ${o}.`);const m=w.a.runKernelFunc(t=>{const e=se(d.shape,i,r,s,o,a);return t.maxPool3dBackprop(h,d,f,e)},{dy:h,input:d,output:f},null,T.S,{filterSize:i,strides:r,dilations:s,pad:o,dimRoundingMode:a});return p?U(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),nn={kernelName:T.R,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,dilations:a,pad:u,dimRoundingMode:l}=n,c=null==a?[1,1,1]:a;return{x:()=>en(t,i,r,s,o,c,u,l)}}},rn=Object(R.a)({maxPoolBackprop_:function(t,e,n,i,r,s,o){const a=Object(k.a)(t,"dy","maxPoolBackprop"),u=Object(k.a)(e,"input","maxPoolBackprop"),l=Object(k.a)(n,"output","maxPoolBackprop");return N.assert(u.rank===a.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${a.rank})`),N.assert(4===a.rank,()=>"Error in maxPoolBackprop: dy must be rank 4 but got rank "+a.rank+"."),N.assert(4===u.rank,()=>"Error in maxPoolBackprop: input must be rank 4 but got rank "+u.rank+"."),null!=o&&N.assert(N.isInt(s),()=>`Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`),w.a.runKernelFunc(t=>{const e=re(u.shape,i,r,1,s,o);return t.maxPoolBackprop(a,u,l,e)},{dy:a,input:u,output:l},null,T.T,{filterSize:i,strides:r,pad:s,dimRoundingMode:o})}}),sn={kernelName:T.Q,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[i,r]=e,{filterSize:s,strides:o,pad:a}=n;return{x:()=>rn(t,i,r,s,o,a)}}},on=Object(R.a)({greater_:function(t,e){let n=Object(k.a)(t,"a","greater"),i=Object(k.a)(e,"b","greater");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc(t=>t.greater(n,i),{a:n,b:i},null,T.H)}}),an=Object(R.a)({lessEqual_:function(t,e){let n=Object(k.a)(t,"a","lessEqual"),i=Object(k.a)(e,"b","lessEqual");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc((t,e)=>{const r=t.lessEqual(n,i);return e([n,i]),r},{a:n,b:i},null,T.O)}}),un={kernelName:T.W,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e;return{a:()=>q(t,z(an(n,i),"float32")),b:()=>q(t,z(on(n,i),"float32"))}}},ln={kernelName:T.X,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{const e=E(n.shape,r);return e.length>0?U(xt(t,e),n.shape):t},b:()=>{const e=q(t,$t(Lt(H(n,i)))),s=E(i.shape,r);return s.length>0?U(xt(e,s),i.shape):e}}}},cn={kernelName:T.Y,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{const e=q(t,z(i,"float32")),s=E(n.shape,r);return s.length>0?U(xt(e,s),n.shape):e},b:()=>{const e=q(t,z(n,"float32")),s=E(i.shape,r);return s.length>0?U(xt(e,s),i.shape):e}}}},hn={kernelName:T.cb,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Object(F.n)(n.shape,"float32")}}},dn={kernelName:T.db,inputsToSave:["x"],gradFunc:(t,e,n)=>{const i=e[0],{paddings:r}=n,s=r.map(t=>t[0]);return{x:()=>t.slice(s,i.shape)}}};function fn(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const i=j(t,"int32"),r=j([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const e=i.indexToLoc(n[s]);r.values.set(e,s*t.length)}return r.toTensor()}const pn=Object(R.a)({logicalAnd_:function(t,e){const n=Object(k.a)(t,"a","logicalAnd","bool"),i=Object(k.a)(e,"b","logicalAnd","bool");return O(n.shape,i.shape),w.a.runKernelFunc(t=>t.logicalAnd(n,i),{a:n,b:i},null,"LogicalAnd")}}),mn=Object(R.a)({logicalNot_:function(t){const e=Object(k.a)(t,"x","logicalNot","bool");return w.a.runKernelFunc(t=>t.logicalNot(e),{$x:e})}}),gn=Object(R.a)({logicalOr_:function(t,e){const n=Object(k.a)(t,"a","logicalOr","bool"),i=Object(k.a)(e,"b","logicalOr","bool");return O(n.shape,i.shape),w.a.runKernelFunc(t=>t.logicalOr(n,i),{$a:n,$b:i})}}),yn=Object(R.a)({logicalXor_:function(t,e){const n=Object(k.a)(t,"a","logicalXor","bool"),i=Object(k.a)(e,"b","logicalXor","bool");return O(n.shape,i.shape),gn(t,e).logicalAnd(pn(t,e).logicalNot())}}),vn=Object(R.a)({where_:function(t,e,n){const i=Object(k.a)(e,"a","where"),r=Object(k.a)(n,"b","where"),s=Object(k.a)(t,"condition","where","bool");return Object(N.assertShapesMatch)(i.shape,r.shape,"Error in where: "),1===s.rank?Object(N.assert)(s.shape[0]===i.shape[0],()=>"The first dimension of `a` must match the size of `condition`."):Object(N.assertShapesMatch)(s.shape,r.shape,"Error in where: "),w.a.runKernelFunc((t,e)=>{const n=t.select(s,i,r);return e([s]),n},{condition:s,t:i,e:r},(t,e)=>{const[n]=e;return{condition:()=>Object(F.o)(n).toFloat(),t:()=>t.mul(n.cast(t.dtype)),e:()=>t.mul(n.logicalNot().cast(t.dtype))}},T.kb)}}),bn=async function(t){const e=Object(k.a)(t,"condition","whereAsync","bool"),n=await e.data(),i=fn(e.shape,n);return t!==e&&e.dispose(),i},xn=Object(R.a)({pow_:function(t,e){let n=Object(k.a)(t,"base","pow"),i=Object(k.a)(e,"exp","pow");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.pow(n,i);return e([n,i,r]),r},{a:n,b:i},null,T.fb)}}),wn={kernelName:T.fb,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,i,r]=e,s=n,o=i,a=O(s.shape,o.shape);return{a:()=>{const e=z(o,"float32");let n=q(t,q(e,xn(s,Ve(e,Object(F.e)(1)))));const i=E(s.shape,a);return i.length>0&&(n=xt(n,i)),U(n,s.shape)},b:()=>{const e=on(s,0),n=vn(e,jt(s),Object(F.o)(s));let i=q(t,q(r,n));const u=E(o.shape,a);return u.length>0&&(i=xt(i,u)),U(i,o.shape)}}}},Tn={kernelName:T.gb,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,i]=e,r=on(n,0);return{x:()=>vn(r,t,q(t,i)),alpha:()=>{let e=vn(r,Object(F.o)(t),q(t,n));const s=E(i.shape,t.shape);return s.length>0&&(e=xt(e,s)),U(e,i.shape)}}}},Sn={kernelName:T.jb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,i=q(an(n,6),te(n));return{x:()=>q(t,z(i,"float32"))}}},En={kernelName:T.ib,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,z(te(n),"float32"))}}},On=1.7580993408473768,Cn=1.0507009873554805,_n={kernelName:T.lb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=on(n,Object(F.e)(0)),i=Object(F.e)(On),r=Object(F.e)(Cn),s=q(t,r),o=q(q(t,i),Pt(z(n,"float32")));return vn(e,s,o)}}}},An=Object(R.a)({batchToSpaceND_:function(t,e,n){const i=Object(k.a)(t,"x","batchToSpaceND"),r=e.reduce((t,e)=>t*e);return N.assert(i.rank>=1+e.length,()=>`input rank is ${i.rank} but should be > than blockShape.length ${e.length}`),N.assert(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),N.assert(i.shape[0]%r==0,()=>`input tensor batch is ${i.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`),w.a.runKernelFunc(t=>t.batchToSpaceND(i,e,n),{x:i},null,T.i,{blockShape:e,crops:n})}}),kn={kernelName:T.mb,gradFunc:(t,e,n)=>{const{blockShape:i,paddings:r}=n;return{x:()=>An(t,i,r)}}},Rn={kernelName:T.nb,gradFunc:(t,e,n)=>{const{axis:i}=n;return{x:()=>L(t,i)}}},In={kernelName:T.ob,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>q(t,q(n.toFloat(),2))}}},Mn={kernelName:T.pb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=Object(F.e)(2);return{a:()=>q(t,q(r,Ve(n,i))),b:()=>q(t,q(r,Ve(i,n)))}}},Nn={kernelName:T.qb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,i]=e,r=O(n.shape,i.shape);return{a:()=>{let e=t;const i=E(n.shape,r);return i.length>0&&(e=xt(e,i)),U(e,n.shape)},b:()=>{let e=t;const n=E(i.shape,r);return n.length>0&&(e=xt(e,n)),U($t(e),i.shape)}}}},Dn=Object(R.a)({pad_:function(t,e,n=0){const i=Object(k.a)(t,"x","pad");if(0===i.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return w.a.runKernelFunc((t,r)=>(r([i]),t.pad(i,e,n)),{x:i},null,T.db,{paddings:e,constantValue:n})}});function Pn(t,e,n){N.assert(t.rank===e.length,()=>`Error in slice${t.rank}D: Length of begin ${e} must match the rank of the array (${t.rank}).`),N.assert(t.rank===n.length,()=>`Error in slice${t.rank}D: Length of size ${n} must match the rank of the array (${t.rank}).`);for(let i=0;i<t.rank;++i)N.assert(e[i]+n[i]<=t.shape[i],()=>`Error in slice${t.rank}D: begin[${i}] + size[${i}] (${e[i]+n[i]}) would overflow input.shape[${i}] (${t.shape[i]})`)}function Fn(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Ln(t,e,n){const i=[];for(let r=0;r<t.length;r++)i[r]=Math.ceil((e[r]-t[r])/n[r]);return i}function jn(t,e,n){const i=[...t];for(let r=0;r<n;r++)0===r?i[e]=1:(i.splice(e,0,1),i.pop());return i}function Bn(t,e,n){const i=[...t];for(let r=0;r<n;r++)0===r?i[e]=0:(i.splice(e,0,0),i.pop());return i}function zn(t,e,n,i){const r=[...t];for(let s=0;s<n;s++)0===s?r[e]=Number.MAX_SAFE_INTEGER:(r.splice(e,0,Number.MAX_SAFE_INTEGER),r.pop());for(let s=0;s<r.length;s++)r[s]=N.clamp(0,r[s],i[s]);return r}function $n(t,e,n){let i=t[e];return(n&1<<e||null==i)&&(i=1),i}function Un(t,e,n,i,r,s){let o=e[r];(t&1<<r||s&1<<r||null==o)&&(o=(n[r]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const a=i[r];return o<0&&(o+=a),o=N.clamp(0,o,a-1),o}function Wn(t,e,n,i,r,s){let o=e[r];const a=n[r]||1;(t&1<<r||s&1<<r||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=i[r];return o<0&&(o+=u),o=a>0?N.clamp(0,o,u):N.clamp(-1,o,u-1),o}function Vn(t,e,n){let i=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){i=r;break}for(let r=i+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function Yn(t,e){let n=t.length>0?t[t.length-1]:1;for(let i=0;i<t.length-1;i++)n+=t[i]*e[i];return n}const Gn=Object(R.a)({slice_:function(t,e,n){const i=Object(k.a)(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");let r,s;r="number"==typeof e?[e,...new Array(i.rank-1).fill(0)]:e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice(),r.forEach(t=>{N.assert(-1!==t,()=>"slice() does not support negative begin indexing.")}),s=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n,...new Array(i.rank-1).fill(-1)]:n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n,s=s.map((t,e)=>t>=0?t:(N.assert(-1===t,()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${e}.`),i.shape[e]-r[e])),Pn(i,r,s);const o=i.shape;return w.a.runKernelFunc(t=>t.slice(i,r,s),{x:i},t=>{const e=[];for(let n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-s[n]]);return{x:()=>Dn(t,e)}},"Slice",{begin:r,size:s})}}),Xn=Object(R.a)({slice1d_:function(t,e,n){const i=Object(k.a)(t,"x","slice1d");return N.assert(1===i.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${i.rank} tensor`),Gn(i,[e],[n])}}),Hn=Object(R.a)({slice2d_:function(t,e,n){const i=Object(k.a)(t,"x","slice2d");return N.assert(2===i.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${i.rank} tensor`),Gn(i,e,n)}}),qn=Object(R.a)({slice3d_:function(t,e,n){const i=Object(k.a)(t,"x","slice3d");return N.assert(3===i.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${i.rank} tensor`),Gn(i,e,n)}}),Kn=Object(R.a)({slice4d_:function(t,e,n){const i=Object(k.a)(t,"x","slice4d");return N.assert(4===i.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${i.rank} tensor`),Gn(i,e,n)}}),Jn={kernelName:T.rb,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[i]=e,{reps:r}=n;return{x:()=>{let e=Object(F.o)(i);if(1===i.rank)for(let n=0;n<r[0];++n)e=I(e,Gn(t,[n*i.shape[0]],[i.shape[0]]));else if(2===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)e=I(e,Gn(t,[n*i.shape[0],s*i.shape[1]],[i.shape[0],i.shape[1]]));else if(3===i.rank)for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)e=I(e,Gn(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2]],[i.shape[0],i.shape[1],i.shape[2]]));else{if(4!==i.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+i.rank+" tensors yet.");for(let n=0;n<r[0];++n)for(let s=0;s<r[1];++s)for(let o=0;o<r[2];++o)for(let a=0;a<r[3];++a)e=I(e,Gn(t,[n*i.shape[0],s*i.shape[1],o*i.shape[2],a*i.shape[3]],[i.shape[0],i.shape[1],i.shape[2],i.shape[3]]))}return e}}}},Qn={kernelName:T.sb,gradFunc:(t,e,n)=>{const i=n,{perm:r}=i,s=lt(r);return{x:()=>Pe(t,s)}}};var Zn=n(17);const ti=[C,_,ie,be,ye,we,Se,Ee,Ce,ke,Ie,De,Le,ze,$e,Ue,We,Ge,Xe,He,Ke,hn,dn,Rn,Je,kn,Je,tn,sn,nn,un,ln,cn,hn,dn,wn,Tn,En,Sn,_n,kn,Rn,In,Mn,Jn,Qn,Nn];for(const Cu of ti)Object(Zn.d)(Cu);var ei=n(10);Object(ei.c)().get("IS_BROWSER")&&Object(ei.c)().setPlatform("browser",new class{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}),n(62);var ni=n(13);class ii{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==ii.instance&&(ii.instance=new ii),ii.instance}static registerSaveRouter(t){ii.getInstance().saveRouters.push(t)}static registerLoadRouter(t){ii.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return ii.getHandlers(t,"save")}static getLoadHandlers(t,e){return ii.getHandlers(t,"load",e)}static getHandlers(t,e,n){const i=[];return("load"===e?ii.getInstance().loadRouters:ii.getInstance().saveRouters).forEach(e=>{const r=e(t,n);null!==r&&i.push(r)}),i}}const ri=t=>ii.registerSaveRouter(t),si=t=>ii.registerLoadRouter(t),oi=t=>ii.getSaveHandlers(t),ai=(t,e)=>ii.getLoadHandlers(t,e),ui="://";class li{constructor(){this.managers={}}static getInstance(){return null==li.instance&&(li.instance=new li),li.instance}static registerManager(t,e){Object(N.assert)(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(ui)&&(t=t.slice(0,t.indexOf(ui))),Object(N.assert)(t.length>0,()=>"scheme must not be an empty string.");const n=li.getInstance();Object(N.assert)(null==n.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function ci(t){if(-1===t.indexOf(ui))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+li.getSchemes().join(","));return{scheme:t.split(ui)[0],path:t.split(ui)[1]}}async function hi(t,e,n=!1){Object(N.assert)(t!==e,()=>`Old path and new path are the same: '${t}'`);const i=ii.getLoadHandlers(t);Object(N.assert)(i.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Object(N.assert)(i.length<2,()=>`Copying failed because more than one (${i.length}) load handlers for source URL ${t}.`);const r=i[0],s=ii.getSaveHandlers(e);Object(N.assert)(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Object(N.assert)(s.length<2,()=>`Copying failed because more than one (${i.length}) save handlers for destination URL ${e}.`);const o=s[0],a=ci(t).scheme,u=ci(t).path,l=a===ci(t).scheme,c=await r.load();n&&l&&await li.getManager(a).removeModel(u);const h=await o.save(c);return n&&!l&&await li.getManager(a).removeModel(u),h.modelArtifactsInfo}async function di(){const t=li.getSchemes(),e={};for(const n of t){const t=await li.getManager(n).listModels();for(const i in t)e[n+ui+i]=t[i]}return e}async function fi(t){const e=ci(t);return li.getManager(e.scheme).removeModel(e.path)}async function pi(t,e){return hi(t,e,!1)}async function mi(t,e){return hi(t,e,!0)}const gi="tensorflowjs",yi="models_store",vi="model_info_store";function bi(){if(!Object(ei.c)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function xi(t){const e=t.result;e.createObjectStore(yi,{keyPath:"modelPath"}),e.createObjectStore(vi,{keyPath:"modelPath"})}class wi{constructor(t){if(this.indexedDB=bi(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const i=this.indexedDB.open(gi,1);i.onupgradeneeded=()=>xi(i),i.onsuccess=()=>{const r=i.result;if(null==e){const e=r.transaction(yi,"readonly"),i=e.objectStore(yi).get(this.modelPath);i.onsuccess=()=>{if(null==i.result)return r.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(i.result.modelArtifacts)},i.onerror=t=>(r.close(),n(i.error)),e.oncomplete=()=>r.close()}else{const i=Object(ni.g)(e),s=r.transaction(vi,"readwrite");let o=s.objectStore(vi);const a=o.put({modelPath:this.modelPath,modelArtifactsInfo:i});let u;a.onsuccess=()=>{u=r.transaction(yi,"readwrite");const a=u.objectStore(yi).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:i});a.onsuccess=()=>t({modelArtifactsInfo:i}),a.onerror=t=>{o=s.objectStore(vi);const e=o.delete(this.modelPath);e.onsuccess=()=>(r.close(),n(a.error)),e.onerror=t=>(r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==u?r.close():u.oncomplete=()=>r.close()}}},i.onerror=t=>n(i.error)})}}wi.URL_SCHEME="indexeddb://";const Ti=t=>{return Object(ei.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wi.URL_SCHEME)?(e=t.slice(wi.URL_SCHEME.length),new wi(e)):null;var e};ii.registerSaveRouter(Ti),ii.registerLoadRouter(Ti);class Si{constructor(){this.indexedDB=bi()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open(gi,1);n.onupgradeneeded=()=>xi(n),n.onsuccess=()=>{const i=n.result,r=i.transaction(vi,"readonly"),s=r.objectStore(vi).getAll();s.onsuccess=()=>{const e={};for(const t of s.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},s.onerror=t=>(i.close(),e(s.error)),r.oncomplete=()=>i.close()},n.onerror=t=>e(n.error)})}async removeModel(t){var e;return t=(e=t).startsWith(wi.URL_SCHEME)?e.slice(wi.URL_SCHEME.length):e,new Promise((e,n)=>{const i=this.indexedDB.open(gi,1);i.onupgradeneeded=()=>xi(i),i.onsuccess=()=>{const r=i.result,s=r.transaction(vi,"readwrite"),o=s.objectStore(vi),a=o.get(t);let u;a.onsuccess=()=>{if(null==a.result)return r.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const i=o.delete(t),s=()=>{u=r.transaction(yi,"readwrite");const i=u.objectStore(yi).delete(t);i.onsuccess=()=>e(a.result.modelArtifactsInfo),i.onerror=t=>n(a.error)};i.onsuccess=s,i.onerror=t=>(s(),r.close(),n(a.error))}},a.onerror=t=>(r.close(),n(a.error)),s.oncomplete=()=>{null==u?r.close():u.oncomplete=()=>r.close()}},i.onerror=t=>n(i.error)})}}if(Object(ei.c)().getBool("IS_BROWSER"))try{li.registerManager(wi.URL_SCHEME,new Si)}catch(Ou){}const Ei="/",Oi="tensorflowjs_models",Ci="info",_i="model_topology",Ai="weight_specs",ki="weight_data",Ri="model_metadata";function Ii(t){return{info:[Oi,t,Ci].join(Ei),topology:[Oi,t,_i].join(Ei),weightSpecs:[Oi,t,Ai].join(Ei),weightData:[Oi,t,ki].join(Ei),modelMetadata:[Oi,t,Ri].join(Ei)}}function Mi(t){const e=t.split(Ei);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(Ei)}class Ni{constructor(t){if(!Object(ei.c)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Ii(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),i=Object(ni.g)(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,Object(ni.a)(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),{modelArtifactsInfo:i}}catch(Ou){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==i)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=i;const r=this.LS.getItem(this.keys.modelMetadata);if(null!=r){const t=JSON.parse(r);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,e.userDefinedMetadata=t.userDefinedMetadata}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=Object(ni.b)(s),e}}Ni.URL_SCHEME="localstorage://";const Di=t=>{return Object(ei.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ni.URL_SCHEME)?(e=t.slice(Ni.URL_SCHEME.length),new Ni(e)):null;var e};ii.registerSaveRouter(Di),ii.registerLoadRouter(Di);class Pi{constructor(){Object(N.assert)(Object(ei.c)().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Object(N.assert)("undefined"==typeof window||void 0!==window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=Oi+Ei,n=Ei+Ci;for(let i=0;i<this.LS.length;++i){const r=this.LS.key(i);r.startsWith(e)&&r.endsWith(n)&&(t[Mi(r)]=JSON.parse(this.LS.getItem(r)))}return t}async removeModel(t){var e;const n=Ii(t=(e=t).startsWith(Ni.URL_SCHEME)?e.slice(Ni.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${t}'`);const i=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),i}}if(Object(ei.c)().getBool("IS_BROWSER"))try{li.registerManager(Ni.URL_SCHEME,new Pi)}catch(Ou){}function Fi(t){return new Promise(t=>setTimeout(t)).then(t)}class Li{constructor(t){if(!Object(ei.c)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Li.URL_SCHEME)&&(t=t.slice(Li.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor;if(i.download=this.modelTopologyFileName,i.href=n,await Fi(()=>i.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await Fi(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Object(ni.g)(t)}}}}Li.URL_SCHEME="downloads://";class ji{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}async load(){const t=this.files[0],e=this.files.slice(1);return new Promise((n,i)=>{const r=new FileReader;r.onload=r=>{const s=JSON.parse(r.target.result),o=s.modelTopology;if(null==o)return void i(new Error("modelTopology field is missing from file "+t.name));0===e.length&&n({modelTopology:o});const a=s.weightsManifest;if(null==a)return void i(new Error("weightManifest field is missing from file "+t.name));let u;try{u=this.checkManifestAndWeightFiles(a,e)}catch(Ou){return void i(Ou)}const l=[],c=[],h=[];a.forEach(t=>{t.paths.forEach(t=>{c.push(t),h.push(null)}),l.push(...t.weights)}),a.forEach(t=>{t.paths.forEach(t=>{const e=new FileReader;e.onload=e=>{const i=e.target.result,r=c.indexOf(t);h[r]=i,-1===h.indexOf(null)&&n({modelTopology:o,weightSpecs:l,weightData:Object(ni.d)(h),format:s.format,generatedBy:s.generatedBy,convertedBy:s.convertedBy,userDefinedMetadata:s.userDefinedMetadata})},e.onerror=e=>i(`Failed to weights data from file of path '${t}'.`),e.readAsArrayBuffer(u[t])})})},r.onerror=e=>i(`Failed to read model topology and weights manifest JSON from file '${t.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(t)})}checkManifestAndWeightFiles(t,e){const n=[],i=e.map(t=>Object(ni.c)(t.name)),r={};for(const s of t)s.paths.forEach(t=>{const s=Object(ni.c)(t);if(-1!==n.indexOf(s))throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(n.push(s),-1===i.indexOf(s))throw new Error(`Weight file with basename '${s}' is not provided.`);r[t]=e[i.indexOf(s)]});if(n.length!==e.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${e.length}).`);return r}}function Bi(t){return new ji(t)}function zi(t,e,n,i){!function(t){Object(N.assert)(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){Object(N.assert)(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+t),Object(N.assert)(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+e),Object(N.assert)(e>=t,()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction `+e)}(n=null==n?0:n,i=null==i?1:i);let r=0;return Promise.all(t.map(s=>(s.then(s=>{const o=n+ ++r/t.length*(i-n);return e(o),s}),s)))}ii.registerSaveRouter(t=>Object(ei.c)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Li.URL_SCHEME)?function(t="model"){return new Li(t)}(t.slice(Li.URL_SCHEME.length)):null);var $i=n(34);async function Ui(t,e){null==e&&(e={});const n=null==e.fetchFunc?Object(ei.c)().platform.fetch:e.fetchFunc,i=t.map(t=>n(t,e.requestInit,{isBinary:!0})),r=(null==e.onProgress?await Promise.all(i):await zi(i,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(r):await zi(r,e.onProgress,.5,1)}async function Wi(t,e="",n,i){return Vi(t=>Ui(t,{requestInit:i}))(t,e,n)}function Vi(t){return async(e,n="",i)=>{const r=e.map(()=>!1),s={},o=null!=i?i.map(()=>!1):[],a=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const u=$i.a["quantization"in t?t.quantization.dtype:t.dtype]*N.sizeFromShape(t.shape),l=()=>{r[e]=!0,null==s[e]&&(s[e]=[]),s[e].push({manifestEntry:t,groupOffset:n,sizeBytes:u})};null!=i?i.forEach((e,n)=>{e===t.name&&(l(),o[n]=!0)}):l(),a.push(t.name),n+=u})}),!o.every(t=>t)){const t=i.filter((t,e)=>!o[e]);throw new Error("Could not find weights in manifest with names: "+t.join(", ")+". \nManifest JSON has weights with names: "+a.join(", ")+".")}const u=r.reduce((t,e,n)=>(e&&t.push(n),t),[]),l=[];u.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;l.push(e)})});const c=await t(l),h={};let d=0;return u.forEach(t=>{const n=e[t].paths.length;let i=0;for(let e=0;e<n;e++)i+=c[d+e].byteLength;const r=new ArrayBuffer(i),o=new Uint8Array(r);let a=0;for(let e=0;e<n;e++){const t=new Uint8Array(c[d+e]);o.set(t,a),a+=t.byteLength}s[t].forEach(t=>{const e=r.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=Object(ni.e)(e,[t.manifestEntry]);for(const i in n)h[i]=n[i]}),d+=n}),h}}class Yi{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(Object(N.assert)("function"==typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=Object(ei.c)().platform.fetch,Object(N.assert)(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Object(N.assert)(2===t.length,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const n=await this.fetch(this.path,e);if(n.ok)return{modelArtifactsInfo:Object(ni.g)(t),responses:[n]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(c){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,i=e.weightsManifest,r=e.generatedBy,s=e.convertedBy,o=e.format,a=e.userDefinedMetadata;if(null==n&&null==i)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let u,l;if(null!=i){const t=await this.loadWeights(i);[u,l]=t}return{modelTopology:n,weightSpecs:u,weightData:l,userDefinedMetadata:a,generatedBy:r,convertedBy:s,format:o}}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,i]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=this.weightPathPrefix||n,s=[];for(const u of t)s.push(...u.weights);const o=[];t.forEach(t=>{t.paths.forEach(t=>{o.push(r+t+i)})});const a=await Ui(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[s,Object(ni.d)(a)]}}function Gi(t){return null!=t.match(Yi.URL_SCHEME_REGEX)}Yi.URL_SCHEME_REGEX=/^https?:\/\//;const Xi=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>Gi(t)):Gi(t),n)return Hi(t,e)}return null};function Hi(t,e){return new Yi(t,e)}function qi(t,e){return Hi(t,e)}ii.registerSaveRouter(Xi),ii.registerLoadRouter(Xi);class Ki{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class Ji{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function Qi(t,e,n,i){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Ki(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ki({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ki({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:i}))}function Zi(t){return new Ji(t)}const tr=Object(R.a)({oneHot_:function(t,e,n=1,i=0){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);let r=Object(k.a)(t,"indices","oneHot","int32");const s=[...r.shape,e];return r=r.flatten(),w.a.runKernelFunc((t,o)=>(o([r]),U(t.oneHot(r,e,n,i),s)),{indices:r},null,T.cb,{depth:e,onValue:n,offValue:i})}}),er=Object(R.a)({confusionMatrix_:function(t,e,n){const i=Object(k.a)(t,"labels","confusionMatrix"),r=Object(k.a)(e,"predictions","confusionMatrix");N.assert(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got "+n),N.assert(1===i.rank,()=>"Expected the rank of labels to be 1, but got "+i.rank),N.assert(1===r.rank,()=>"Expected the rank of predictions to be 1, but got "+r.rank),N.assert(i.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${i.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),N.assert(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+n);const s=tr(i.asType("int32"),n),o=tr(r.asType("int32"),n);return s.transpose().matMul(o).asType("int32")}});let nr;async function ir(t,e){let n=Object(k.a)(t,"img","toPixels");if(!(t instanceof M.a)){const t=n;n=t.toInt(),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[i,r]=n.shape.slice(0,2),s=2===n.rank?1:n.shape[2];if(s>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);const o=await n.data(),a=n.min(),u=n.max(),l=await Promise.all([a.data(),u.data()]),c=l[0][0],h=l[1][0];if(a.dispose(),u.dispose(),"float32"===n.dtype){if(c<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but got range [${c} - ${h}].`)}else{if("int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);if(c<0||h>255)throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but got range [${c} - ${h}].`)}const d="float32"===n.dtype?255:1,f=new Uint8ClampedArray(r*i*4);for(let p=0;p<i*r;++p){let t,e,n,i;1===s?(t=o[p]*d,e=o[p]*d,n=o[p]*d,i=255):3===s?(t=o[3*p]*d,e=o[3*p+1]*d,n=o[3*p+2]*d,i=255):4===s&&(t=o[4*p]*d,e=o[4*p+1]*d,n=o[4*p+2]*d,i=o[4*p+3]*d);const r=4*p;f[r+0]=Math.round(t),f[r+1]=Math.round(e),f[r+2]=Math.round(n),f[r+3]=Math.round(i)}if(null!=e){e.width=r,e.height=i;const t=e.getContext("2d"),n=new ImageData(f,r,i);t.putImageData(n,0,0)}return n!==t&&n.dispose(),f}const rr=Object(R.a)({fromPixels_:function(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,i=!1,r=!1,s=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)i=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)r=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)s=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(r){const e=2;if(r&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Object(Zn.b)(T.E,w.a.backendName))return w.a.runKernel(T.E,{pixels:t},{numChannels:e});const[a,u]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let l,c;if(o?l=t.getContext("2d").getImageData(0,0,a,u).data:i||n?l=t.data:(s||r)&&(null==nr&&(nr=document.createElement("canvas").getContext("2d")),nr.canvas.width=a,nr.canvas.height=u,nr.drawImage(t,0,0,a,u),l=nr.getImageData(0,0,a,u).data),4===e)c=new Int32Array(l);else{const t=a*u;c=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)c[n*e+t]=l[4*n+t]}const h=[u,a,e];return Object(F.i)(c,h,"int32")}});function sr(t,e){if(t.rank<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[e.rank-1]>t.rank)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[e.rank-1]} vs. ${t.rank}`);if(0===t.size)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const n=e.shape,i=n[n.length-1];let r=1;for(let l=0;l<n.length-1;++l)r*=n[l];const s=t.shape,o=n.slice();o.pop();let a=1;for(let l=i;l<t.rank;++l)a*=s[l],o.push(s[l]);const u=[...Object(N.computeStrides)(t.shape).map(t=>t/a),1].slice(0,i);return[o,r,a,u]}function or(t,e,n){const i=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,s="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${i}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(s+` update.rank < ${r}. `);if(t.length<i+(n.rank-r))throw new Error(s+" Output shape length < "+(i+(n.rank-r)));if(n.rank!==r+t.length-i)throw new Error(s+" update.rank != "+(r+t.length-i));for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(s+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+i])throw new Error(s+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function ar(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}or(n,e,t)}function ur(t,e,n){const i=e.shape.length,r=i>1?e.shape[i-1]:1,s=n.length;let o=1;for(let u=r;u<s;++u)o*=n[u];const a=r<1?1:r;return{sliceRank:r,numUpdates:Object(N.sizeFromShape)(e.shape)/a,sliceSize:o,strides:[...Object(N.computeStrides)(n.slice(0,r)),1],outputSize:Object(N.sizeFromShape)(n)}}class lr{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class cr{constructor(){this.classNameMap={}}static getMap(){return null==cr.instance&&(cr.instance=new cr),cr.instance}static register(t){cr.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function hr(t){Object(N.assert)(null!=t.className,()=>"Class being registered does not have the static className property defined."),Object(N.assert)("string"==typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Object(N.assert)(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),cr.register(t)}const dr=.1;function fr(t,e,n){return null==n&&(n=pr()),mr(t,e,(t,e)=>br(t,e,n))}function pr(){return 32===w.a.backend.floatPrecision()?.001:dr}function mr(t,e,n){let i=!0;if((Object(N.isTypedArray)(t)||Object(N.isTypedArray)(e))&&(i=!1),Object(N.isTypedArray)(t)&&Object(N.isTypedArray)(e)&&(i=!0),i){const n=t.constructor.name,i=e.constructor.name;if(n!==i)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: `+i)}if(Array.isArray(t)&&Array.isArray(e)){const n=Object(k.c)(t),i=Object(k.c)(e);if(!Object(N.arraysEqual)(n,i))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${i}]`)}const r=Object(N.isTypedArray)(t)?t:Object(N.flatten)(t),s=Object(N.isTypedArray)(e)?e:Object(N.flatten)(e);if(r.length!==s.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${s.length}.\nActual:   ${r}.\nExpected: ${s}.`);for(let o=0;o<s.length;++o){const t=r[o],e=s[o];if(!n(t,e))throw new Error(`Arrays differ: actual[${o}] = ${t}, expected[${o}] = ${e}.\nActual:   ${r}.\nExpected: ${s}.`)}}function gr(t,e){t().then(()=>e.fail(),()=>e())}function yr(t,e){const n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return Object(N.isString)(t)||Object(N.isString)(t[0])||Object(N.isString)(e)||Object(N.isString)(e[0])?mr(t,n,(t,e)=>t==e):mr(t,e,(t,e)=>br(t,e,0))}function vr(t,e,n){if(null==n&&(n=pr()),!br(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`)}function br(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function xr(t,e,n){for(let i=0;i<t.length;i++)if(t[i]<e||t[i]>n)throw new Error(`Value out of range:${t[i]} low: ${e}, high: ${n}`)}function wr(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}const Tr="2.0.1";function Sr(){Object(ei.c)().set("PROD",!0)}function Er(){Object(ei.c)().set("DEBUG",!0)}function Or(){Object(ei.c)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Cr(t){Object(ei.c)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function _r(){w.a.disposeVariables()}function Ar(){return w.a}function kr(){return w.a.memory()}function Rr(t){return w.a.profile(t)}function Ir(t,e){return w.a.tidy(t,e)}function Mr(t){Object(A.getTensorsInContainer)(t).forEach(t=>t.dispose())}function Nr(t){return w.a.keep(t)}function Dr(t){return w.a.time(t)}function Pr(t){return w.a.setBackend(t)}function Fr(){return w.a.ready()}function Lr(){return w.a.backendName}function jr(t){w.a.removeBackend(t)}function Br(t){return w.a.findBackend(t)}function zr(t){return w.a.findBackendFactory(t)}function $r(t,e,n=1){return w.a.registerBackend(t,e,n)}function Ur(){return w.a.backend}function Wr(t,e){Object(ei.c)().setPlatform(t,e)}Object(M.d)(Cr);const Vr=Object(R.a)({addN_:function(t){N.assert(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),N.assert(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+t.length);const e=t.map((t,e)=>Object(k.a)(t,"tensors"+e,"addN")),n=e[0];return e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!N.arraysEqual(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}),w.a.runKernelFunc((t,n)=>{const i=t.addN(e);return n(e),i},e,null,T.b)}}),Yr=Object(R.a)({atan2_:function(t,e){let n=Object(k.a)(t,"a","atan2"),i=Object(k.a)(e,"b","atan2");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.atan2(n,i);return e([n,i]),r},{a:n,b:i},null,T.c)}}),Gr=Object(R.a)({avgPool_:function(t,e,n,i,r){const s=Object(k.a)(t,"x","avgPool","float32");N.assert(pe(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),N.assert(4===o.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),null!=r&&N.assert(N.isInt(i),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${r} but got pad ${i}.`);let u=w.a.runKernelFunc((t,s)=>{const a=re(o.shape,e,n,1,i,r);return s([o]),1===a.filterWidth&&1===a.filterHeight&&N.arraysEqual(a.inShape,a.outShape)?o.clone():t.avgPool(o,a)},{x:o},null,T.d,{filterSize:e,strides:n,pad:i,dimRoundingMode:r});return u=z(u,s.dtype),a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Xr=Object(R.a)({avgPool3d_:function(t,e,n,i,r,s="NDHWC",o){null==o?o=[1,1,1]:Cr("dilations is deprecated, this field will be gone in v3.0.0.");const a=Object(k.a)(t,"x","avgPool3d","float32");let u=a,l=!1;4===a.rank&&(l=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),N.assert(5===u.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${u.rank}.`),N.assert("NDHWC"===s,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+s),N.assert(pe(n,o),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),null!=r&&N.assert(N.isInt(i),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${r} but got pad ${i}.`);let c=w.a.runKernelFunc((t,a)=>{null==o&&(o=[1,1,1]);const l=se(u.shape,e,n,o,i,r,s);return a([u]),t.avgPool3d(u,l)},{x:u},null,T.e,{filterSize:e,strides:n,pad:i,dimRoundingMode:r,dataFormat:s,dilations:o});return c=z(c,u.dtype),l?c.as4D(c.shape[1],c.shape[2],c.shape[3],c.shape[4]):c}});function Hr(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}const qr=Object(R.a)({batchNorm_:function(t,e,n,i,r,s){null==s&&(s=.001);const o=Object(k.a)(t,"x","batchNorm"),a=Object(k.a)(e,"mean","batchNorm"),u=Object(k.a)(n,"variance","batchNorm");let l,c;null!=r&&(l=Object(k.a)(r,"scale","batchNorm")),null!=i&&(c=Object(k.a)(i,"offset","batchNorm")),N.assert(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),N.assert(null==c||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),N.assert(null==l||a.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h=function(t){let e;return e=0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t,e}(o),d=w.a.runKernelFunc((t,e)=>(e([h,a,u,l]),t.batchNorm(h,Hr(a),Hr(u),Hr(c),Hr(l),s)),{x:h,scale:l,offset:c,mean:a,variance:u},null,T.F,{varianceEpsilon:s});return U(d,o.shape)}}),Kr=Object(R.a)({batchNorm2d_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"x","batchNorm"),a=Object(k.a)(e,"mean","batchNorm"),u=Object(k.a)(n,"variance","batchNorm");let l,c;return null!=r&&(l=Object(k.a)(r,"scale","batchNorm")),null!=i&&(c=Object(k.a)(i,"offset","batchNorm")),N.assert(2===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+o.rank+"."),N.assert(2===a.rank||1===a.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),N.assert(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=l&&N.assert(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),null!=c&&N.assert(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),qr(o,a,u,c,l,s)}}),Jr=Object(R.a)({batchNorm3d_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"x","batchNorm"),a=Object(k.a)(e,"mean","batchNorm"),u=Object(k.a)(n,"variance","batchNorm");let l,c;return null!=r&&(l=Object(k.a)(r,"scale","batchNorm")),null!=i&&(c=Object(k.a)(i,"offset","batchNorm")),N.assert(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+o.rank+"."),N.assert(3===a.rank||1===a.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),N.assert(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=l&&N.assert(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),null!=c&&N.assert(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),qr(o,a,u,c,l,s)}}),Qr=Object(R.a)({batchNorm4d_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"x","batchNorm"),a=Object(k.a)(e,"mean","batchNorm"),u=Object(k.a)(n,"variance","batchNorm");let l,c;return null!=r&&(l=Object(k.a)(r,"scale","batchNorm")),null!=i&&(c=Object(k.a)(i,"offset","batchNorm")),N.assert(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+o.rank+"."),N.assert(4===a.rank||1===a.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),N.assert(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=l&&N.assert(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),null!=c&&N.assert(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),qr(o,a,u,c,l,s)}}),Zr=Object(R.a)({clone_:function(t){const e=Object(k.a)(t,"x","clone",null);return w.a.runKernelFunc(()=>w.a.makeTensorFromDataId(e.dataId,e.shape,e.dtype),{x:e},null,T.J)}}),ts=Object(R.a)({broadcastTo_:function(t,e){let n=Object(k.a)(t,"broadcastTo","x");const i=n.shape;if(e.some(t=>!(t>0)||t%1!=0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=U(n,t)}const r=n.shape,s=Array.from(e);for(let o=e.length-1;o>=0;o--)if(r[o]===e[o])s[o]=1;else if(1!==n.shape[o])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${e}].`);return 0===s.map((t,e)=>t>1?e:-1).filter(t=>t>=0).length?Zr(n):w.a.runKernelFunc(t=>t.tile(n,s),{x:n},null,T.j,{shape:e,inputShape:r})}});var es=n(18);const ns=Object(R.a)({concat1d_:function(t){return L(t,0)}}),is=Object(R.a)({concat2d_:function(t,e){return L(t,e)}}),rs=Object(R.a)({concat3d_:function(t,e){return L(t,e)}}),ss=Object(R.a)({concat4d_:function(t,e){return L(t,e)}}),os=Object(R.a)({conv1d_:function(t,e,n,i,r="NWC",s=1,o){const a=Object(k.a)(t,"x","conv1d"),u=Object(k.a)(e,"filter","conv1d");let l=a,c=!1;2===a.rank&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1]])),N.assert(3===l.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),N.assert(3===u.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."),null!=o&&N.assert(N.isInt(i),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`),N.assert(l.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${u.shape[1]}.`),N.assert(pe(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),N.assert("NWC"===r,()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const h=U(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=U(l,[l.shape[0],1,l.shape[1],l.shape[2]]),f=Re(d,h,[1,n],i,"NHWC",[1,s],o);return U(f,c?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}}),as=Object(R.a)({conv2dTranspose_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"x","conv2dTranspose"),a=Object(k.a)(e,"filter","conv2dTranspose");return Ae(n,o,a,i,r,"NHWC",s)}}),us=Object(R.a)({conv3d_:function(t,e,n,i,r="NDHWC",s=[1,1,1]){const o=Object(k.a)(t,"x","conv3d"),a=Object(k.a)(e,"filter","conv3d");let u=o,l=!1;4===o.rank&&(l=!0,u=U(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),N.assert(5===u.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),N.assert(5===a.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+a.rank+"."),N.assert(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),N.assert(pe(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),N.assert("NDHWC"===r,()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`);const c=w.a.runKernelFunc((t,e)=>{const r=ae(u.shape,a.shape,n,s,i),o=t.conv3d(u,a,r);return e([u,a]),o},{x:u,filter:a},null,T.p,{strides:n,pad:i,dataFormat:r,dilations:s});return l?c.as4D(c.shape[1],c.shape[2],c.shape[3],c.shape[4]):c}}),ls=Object(R.a)({conv3dTranspose_:function(t,e,n,i,r){const s=Object(k.a)(t,"x","conv3dTranspose"),o=Object(k.a)(e,"filter","conv3dTranspose");return Ne(n,s,o,i,r)}}),cs=Object(R.a)({depthToSpace_:function(t,e,n="NHWC"){const i=Object(k.a)(t,"x","depthToSpace"),r="NHWC"===n?i.shape[1]:i.shape[2],s="NHWC"===n?i.shape[2]:i.shape[3],o="NHWC"===n?i.shape[3]:i.shape[1];return N.assert(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${r} and ${e}  for depthToSpace with input shape\n    ${i.shape}`),N.assert(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${e} for depthToSpace with input shape\n        ${i.shape}`),N.assert(o%(e*e)==0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${i.shape}`),w.a.runKernelFunc(t=>t.depthToSpace(i,e,n),{x:i},null,T.t,{blockSize:e,dataFormat:n})}}),hs=Object(R.a)({depthwiseConv2d_:function(t,e,n,i,r="NHWC",s=[1,1],o){const a=Object(k.a)(t,"x","depthwiseConv2d"),u=Object(k.a)(e,"filter","depthwiseConv2d");let l=a,c=!1;3===a.rank&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),N.assert(4===l.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),N.assert(4===u.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."),N.assert(l.shape[3]===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),null!=o&&N.assert(N.isInt(i),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`);const h=w.a.runKernelFunc((t,e)=>{null==s&&(s=[1,1]),N.assert(pe(n,s),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const r=oe(l.shape,u.shape,n,s,i,o,!0),a=t.depthwiseConv2D(l,u,r);return e([l,u]),a},{x:l,filter:u},null,T.u,{strides:n,pad:i,dataFormat:r,dilations:s,dimRoundingMode:o});return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),ds=Object(R.a)({diag_:function(t){const e=Object(k.a)(t,"x","diag").flatten();return w.a.runKernelFunc(n=>{const i=n.diag(e),r=[...t.shape,...t.shape];return U(i,r)},{x:e},null,T.x)}}),fs=Object(R.a)({divNoNan_:function(t,e){let n=Object(k.a)(t,"a","div"),i=Object(k.a)(e,"b","div");[n,i]=Object(A.makeTypesMatch)(n,i);const r=H(n,i),s=Object(F.o)(r),o=i.equal(s);return vn(o,s,r)}}),ps=Object(R.a)({dot_:function(t,e){const n=Object(k.a)(t,"t1","dot"),i=Object(k.a)(e,"t2","dot");N.assert(!(1!==n.rank&&2!==n.rank||1!==i.rank&&2!==i.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${i.rank}.`);const r=1===n.rank?n.size:n.shape[1],s=1===i.rank?i.size:i.shape[0];if(N.assert(r===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${s}.`),1===n.rank&&1===i.rank){const t=U(n,[1,-1]),e=U(i,[-1,1]),r=xe(t,e);return U(r,[])}if(1===n.rank&&2===i.rank){const t=U(n,[1,-1]),e=U(i,[i.shape[0],i.shape[1]]),r=xe(t,e);return U(r,[r.size])}if(2===n.rank&&1===i.rank){const t=U(i,[-1,1]),e=xe(n,t);return U(e,[e.size])}{const t=U(i,[i.shape[0],i.shape[1]]);return xe(n,t)}}}),ms=Object(R.a)({elu_:function(t){const e=Object(k.a)(t,"x","elu");return w.a.runKernelFunc((t,n)=>{const i=t.elu(e);return n([i]),i},{x:e},null,T.z)}}),gs=Object(R.a)({equal_:function(t,e){let n=Object(k.a)(t,"a","equal"),i=Object(k.a)(e,"b","equal");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc(t=>t.equal(n,i),{a:n,b:i},null,T.B)}}),ys=Object(R.a)({eye_:function(t,e,n,i="float32"){null==e&&(e=t);const r=j([t,e],i),s=t<=e?t:e;for(let a=0;a<s;++a)r.set(1,a,a);const o=r.toTensor().as2D(t,e);if(null==n)return o;if(1===n.length)return Ye($(o,0),[n[0],1,1]);if(2===n.length)return Ye($($(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return Ye($($($(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});function vs(t,e,n){return w.a.runKernelFunc(i=>i.fill(t,e,n),{},null,T.C,{shape:t,value:e,dtype:n})}var bs=n(25);const xs=Object(R.a)({maximum_:function(t,e){let n=Object(k.a)(t,"a","maximum"),i=Object(k.a)(e,"b","maximum");return[n,i]=Object(A.makeTypesMatch)(n,i),"bool"===n.dtype&&(n=z(n,"int32"),i=z(i,"int32")),O(n.shape,i.shape),w.a.runKernelFunc((t,e)=>{const r=t.maximum(n,i);return e([n,i]),r},{a:n,b:i},null,T.V)}}),ws=Object(R.a)({leakyRelu_:function(t,e=.2){const n=Object(k.a)(t,"x","leakyRelu");return xs(q(Object(F.e)(e),n),n)}}),Ts=Object(R.a)({localResponseNormalization_:function(t,e=5,n=1,i=1,r=.5){const s=Object(k.a)(t,"x","localResponseNormalization");N.assert(4===s.rank||3===s.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`),N.assert(N.isInt(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const u=w.a.runKernelFunc((t,s)=>{const a=t.localResponseNormalization4D(o,e,n,i,r);return s([o,a]),a},{x:o},null,T.L,{depthRadius:e,bias:n,alpha:i,beta:r});return a?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ss=Object(R.a)({max_:function(t,e=null,n=!1){const i=Object(k.a)(t,"x","max"),r=w.a.runKernelFunc((t,n)=>{let r=N.parseAxisParam(e,i.shape);const s=ut(r,i.rank);let o=i;null!=s&&(o=Pe(i,s),r=ct(r.length,o.rank));const a=t.max(o,r);return n([i,a]),null!=s&&t.disposeData(o.dataId),a},{x:i},null,T.P,{reductionIndices:e,keepDims:n});return n?U(r,ot(r.shape,N.parseAxisParam(e,i.shape))):r}}),Es=Object(R.a)({maxPool_:function(t,e,n,i,r){const s=Object(k.a)(t,"x","maxPool");let o=s,a=!1;3===s.rank&&(a=!0,o=U(s,[1,s.shape[0],s.shape[1],s.shape[2]])),N.assert(4===o.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),N.assert(pe(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),null!=r&&N.assert(N.isInt(i),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${r} but got pad ${i}.`);const u=w.a.runKernelFunc((t,s)=>{const a=re(o.shape,e,n,1,i,r);let u;return u=1===a.filterWidth&&1===a.filterHeight&&N.arraysEqual(a.inShape,a.outShape)?o.clone():t.maxPool(o,a),s([o,u]),u},{x:o},null,T.Q,{filterSize:e,strides:n,pad:i,dimRoundingMode:r});return a?U(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Os=Object(R.a)({maxPool3d_:function(t,e=[1,1,1],n,i,r,s="NDHWC",o){null==o?o=[1,1,1]:Cr("dilations is deprecated, this field will be gone in v3.0.0.");const a=Object(k.a)(t,"x","maxPool3d");let u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),N.assert(5===u.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${u.rank}.`),N.assert("NDHWC"===s,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+s),N.assert(pe(n,o),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),null!=r&&N.assert(N.isInt(i),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${r} but got pad ${i}.`);const c=w.a.runKernelFunc((t,a)=>{null==o&&(o=[1,1,1]);const l=se(u.shape,e,n,o,i,r,s),c=t.maxPool3d(u,l);return a([u,c]),c},{x:u},null,T.R,{filterSize:e,strides:n,pad:i,dimRoundingMode:r,dataFormat:s,dilations:o});return l?U(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),Cs=Object(R.a)({maxPoolWithArgmax_:function(t,e,n,i,r=!1){const s=Object(k.a)(t,"x","maxPoolWithArgmax"),o=w.a.runKernel(T.U,{x:s},{filterSize:e,strides:n,pad:i,includeBatchInIndex:r});return{result:o[0],indexes:o[1]}}}),_s=Object(R.a)({minimum_:function(t,e){let n=Object(k.a)(t,"a","minimum"),i=Object(k.a)(e,"b","minimum");return[n,i]=Object(A.makeTypesMatch)(n,i),"bool"===n.dtype&&(n=z(n,"int32"),i=z(i,"int32")),O(n.shape,i.shape),w.a.runKernelFunc((t,e)=>{const r=t.minimum(n,i);return e([n,i]),r},{a:n,b:i},null,T.W)}}),As=Object(R.a)({mod_:function(t,e){let n=Object(k.a)(t,"a","mod"),i=Object(k.a)(e,"b","mod");return[n,i]=Object(A.makeTypesMatch)(n,i),w.a.runKernelFunc((t,e)=>{const r=t.mod(n,i);return e([n,i]),r},{a:n,b:i},null,T.X)}}),ks=Object(R.a)({multinomial_:function(t,e,n,i=!1){const r=Object(k.a)(t,"logits","multinomial"),s=r.size,o=r.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+s+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();const a=1===o?r.as2D(1,-1):r,u=w.a.runKernelFunc(t=>t.multinomial(a,i,e,n),{logits2D:a});return 1===o?u.as1D():u}}),Rs=Object(R.a)({notEqual_:function(t,e){let n=Object(k.a)(t,"a","notEqual"),i=Object(k.a)(e,"b","notEqual");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc(t=>t.notEqual(n,i),{a:n,b:i},null,T.bb)}}),Is=Object(R.a)({outerProduct_:function(t,e){const n=Object(k.a)(t,"v1","outerProduct"),i=Object(k.a)(e,"v2","outerProduct");N.assert(1===n.rank&&1===i.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${i.rank}.`);const r=U(n,[-1,1]),s=U(i,[1,-1]);return xe(r,s)}}),Ms=Object(R.a)({pad1d_:function(t,e,n=0){return Object(N.assert)(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),Dn(t,[e],n)}}),Ns=Object(R.a)({pad2d_:function(t,e,n=0){return Object(N.assert)(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),Dn(t,e,n)}}),Ds=Object(R.a)({pad3d_:function(t,e,n=0){return Object(N.assert)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),Dn(t,e,n)}}),Ps=Object(R.a)({pad4d_:function(t,e,n=0){return Object(N.assert)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),Dn(t,e,n)}}),Fs=Object(R.a)({pool_:function(t,e,n,i,r,s){null==r&&(r=[1,1]),null==s&&(s=1),0===i&&(i="valid");const o=Object(k.a)(t,"x","maxPool");let a=o,u=!1;3===o.rank&&(u=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]])),N.assert(pe(s,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${r}'`);const l=re(a.shape,e,s,r,i),c=[l.dilationHeight,l.dilationWidth];let h;h="same"===i?function(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)).map(t=>t-1),i=n.map(t=>Math.floor(t/2)),r=n.map((t,e)=>t-i[e]);return n.map((t,e)=>[i[e],r[e]])}([l.filterHeight,l.filterWidth],c):[[0,0],[0,0]];const d=1===c[0]&&1===c[1],[f,p]=function(t,e,n){const i=n.map(t=>t[0]),r=n.map(t=>t[1]),s=t.concat(i,r),o=e.map((t,e)=>(t-s[e]%t)%t),a=r.map((t,e)=>t+o[e]);return[e.map((t,e)=>[i[e],a[e]]),e.map((t,e)=>[0,o[e]])]}([l.inHeight,l.inWidth],c,h),m=d?i:"valid",g=d?a:Te(a,c,f),y=("avg"===n?()=>Gr(g,e,s,m):()=>Es(g,e,s,m))(),v=d?y:An(y,c,p);return u?U(v,[v.shape[1],v.shape[2],v.shape[3]]):v}}),Ls=Object(R.a)({prelu_:function(t,e){const n=Object(k.a)(t,"x","prelu"),i=Object(k.a)(e,"alpha","prelu");return w.a.runKernelFunc((t,e)=>{const r=t.prelu(n,i);return e([n,i]),r},{x:n,alpha:i},null,T.gb)}}),js=Object(R.a)({rand_:function(t,e,n){const i=Object(N.sizeFromShape)(t);let r=null;if(null==n||"float32"===n)r=new Float32Array(i);else if("int32"===n)r=new Int32Array(i);else{if("bool"!==n)throw new Error("Unknown data type "+n);r=new Uint8Array(i)}for(let s=0;s<i;s++)r[s]=e();return w.a.makeTensor(r,t,n)}});var Bs=n(20);class zs{constructor(t,e,n,i,r){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=r||Math.random();this.random=Bs.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let i,r,s;do{i=2*this.random()-1,r=2*this.random()-1,s=i*i+r*r}while(s>=1||0===s);const o=Math.sqrt(-2*Math.log(s)/s);t=this.mean+this.stdDev*i*o,e=this.mean+this.stdDev*r*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class $s{constructor(t,e,n,i){this.alpha=t,this.beta=1/e,this.dtype=n;const r=i||Math.random();this.randu=Bs.alea(r.toString()),this.randn=new zs(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,i,r,s;for(;;){do{i=this.randn.nextValue(),s=1+this.c*i}while(s<=0);if(s*=s*s,t=i*i,e=1-.331*t*t,n=.5*t+this.d*(1-s+Math.log(s)),r=this.randu(),r<e||Math.log(r)<n)break}return s*=1/this.beta*this.d,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Us{constructor(t=0,e=1,n,i){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Bs.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Ws=Object(R.a)({randomGamma_:function(t,e,n=1,i="float32",r){if(null==n&&(n=1),null==i&&(i="float32"),"float32"!==i&&"int32"!==i)throw new Error("Unsupported data type "+i);const s=new $s(e,n,i,r),o=j(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),Vs=Object(R.a)({randomNormal_:function(t,e=0,n=1,i,r){if(null!=i&&"bool"===i)throw new Error("Unsupported data type "+i);const s=new zs(e,n,i,!1,r),o=j(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),Ys=Object(R.a)({randomUniform_:function(t,e=0,n=1,i="float32",r){const s=j(t,i),o=new Us(e,n,null,r);for(let a=0;a<s.values.length;a++)s.values[a]=o.nextValue();return s.toTensor()}});var Gs=n(22);const Xs=Object(R.a)({relu_:function(t){const e=Object(k.a)(t,"x","relu");return w.a.runKernelFunc((t,n)=>(n([e]),"bool"===e.dtype?e.toInt():t.relu(e)),{x:e},null,T.ib)}}),Hs=Object(R.a)({relu6_:function(t){const e=Object(k.a)(t,"x","relu6");return w.a.runKernelFunc((t,n)=>(n([e]),"bool"===e.dtype?z(e,"int32"):t.relu6(e)),{x:e},null,T.jb)}}),qs=Object(R.a)({selu_:function(t){const e=Object(k.a)(t,"x","selu");return w.a.runKernelFunc((t,n)=>{const i=t.selu(e);return n([e]),i},{x:e},null,T.lb)}}),Ks=Object(R.a)({separableConv2d_:function(t,e,n,i,r,s=[1,1],o="NHWC"){const a=Object(k.a)(t,"x","separableConv2d"),u=Object(k.a)(e,"depthwiseFilter","separableConv2d"),l=Object(k.a)(n,"pointwiseFilter","separableConv2d");let c=a,h=!1;if(3===a.rank&&(h=!0,c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");N.assert(4===c.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),N.assert(4===u.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),N.assert(4===l.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),N.assert(1===l.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),N.assert(1===l.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const d=u.shape[2],f=u.shape[3];N.assert(l.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${l.shape[2]}.`);const p=hs(c,u,i,r,o,s),m=Re(p,l,1,"valid",o);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Js=Object(R.a)({squaredDifference_:function(t,e){let n=Object(k.a)(t,"a","squaredDifference"),i=Object(k.a)(e,"b","squaredDifference");return[n,i]=Object(A.makeTypesMatch)(n,i),O(n.shape,i.shape),w.a.runKernelFunc((t,e)=>{const r=t.squaredDifference(n,i);return e([n,i]),r},{a:n,b:i},null,T.pb,{})}}),Qs=Object(R.a)({truncatedNormal_:function(t,e=0,n=1,i,r){if(null!=i&&"bool"===i)throw new Error("Unsupported data type $ { dtype }");const s=new zs(e,n,i,!0,r),o=j(t,i);for(let a=0;a<o.values.length;a++)o.values[a]=s.nextValue();return o.toTensor()}}),Zs=30;function to(t){return t<=Zs?t:Object(N.nearestDivisor)(t,Math.floor(Math.sqrt(t)))}function eo(t,e){let n,i=!1;for(t<=Zs?(n=t,i=!0):n=Object(N.nearestDivisor)(t,Math.floor(Math.sqrt(t)));!i;)n>e||n===t?i=!0:n=Object(N.nearestDivisor)(t,n+1);return n}function no(t,e,n){const i=[],r=t.length;for(let s=0;s<r;s++)i.push(s!==e?t[s]:n);return i}function io(t,e,n){const i=t.shape[n],r=[];let s=1,o=1;for(let a=0;a<n;a++)r.push(t.shape[a]),s*=t.shape[a];for(let a=0;a<e.rank;a++)r.push(e.shape[a]);for(let a=n+1;a<t.rank;a++)r.push(t.shape[a]),o*=t.shape[a];return{batchSize:s,sliceSize:o,dimSize:i,outputShape:r}}function ro(t,e){const n=[];for(let i=t;i<e;++i)n.push(i);return n}function so(t){const e=[];for(let n=0;n<t.length;++n)for(let i=0;i<t[n].length;++i)e.push(t[n][i]);return e}const oo=Object(R.a)({gather_:function(t,e,n=0){const i=Object(k.a)(t,"x","gather"),r=Object(k.a)(e,"indices","gather","int32");n=Object(N.parseAxisParam)(n,i.shape)[0];const s=io(i,r,n);return w.a.runKernelFunc((t,e)=>{const s=t.gather(i,r.flatten(),n);return e([r]),s},{x:i,indices:r},(t,e)=>{const[r]=e;return{x:()=>{const e=i.shape,s=r.size,o=e.slice(0,n),a=o.length,u=e.slice(n,e.length).slice(1),l=u.length,c=ro(0,a),h=ro(a+1,a+1+l),d=so([o,[s],u]),f=t.reshape(d),p=r.reshape([s]),m=so([[a],c,h]),g=f.transpose(m);let y=ao(g,p,i.shape[n]);const v=lt(m);return y=y.transpose(v),y},indices:()=>r}},"Gather",{axis:n}).reshape(s.outputShape)}}),ao=Object(R.a)({unsortedSegmentSum_:function(t,e,n){const i=Object(k.a)(t,"x","unsortedSegmentSum"),r=Object(k.a)(e,"segmentIds","unsortedSegmentSum","int32");return Object(N.assert)(Object(N.isInt)(n),()=>"numSegments must be of dtype int"),w.a.runKernelFunc((t,e)=>{const s=t.unsortedSegmentSum(i,r,n);return e([r]),s},{$x:i},(t,e)=>{const[n]=e;return{$x:()=>function(t,e){const n=xs(e,Object(F.o)(e)),i=oo(t,n);let r=Qe(e,Object(F.e)(0,"int32"));const s=i.rank-r.rank;for(let a=0;a<s;++a)r=$(r,a+1);r=pn(r,Object(F.b)(i.shape,"bool"));const o=Object(F.o)(i);return vn(r,i,o)}(t,n)}})}}),uo=async function(t,e,n){const i=Object(k.a)(t,"tensor","boolMask"),r=Object(k.a)(e,"mask","boolMask","bool"),s=null==n?0:n,o=r.rank,a=i.shape;N.assert(o>0,()=>"mask cannot be scalar"),N.assertShapesMatch(a.slice(s,s+o),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let m=s;m<s+o;m++)u*=a[m];const l=a.slice(0,s).concat([u],a.slice(s+o)),c=i.reshape(l),h=r.reshape([-1]),d=await bn(h),f=d.squeeze([1]),p=oo(c,f,s);return t!==i&&i.dispose(),e!==r&&r.dispose(),f.dispose(),c.dispose(),h.dispose(),d.dispose(),p},lo=Object(R.a)({reverse_:function(t,e){const n=Object(k.a)(t,"x","reverse");if(0===n.rank)return n.clone();const i=N.parseAxisParam(e,n.shape);return w.a.runKernelFunc(t=>t.reverse(n,i),{$x:n},t=>({$x:()=>t.reverse(i)})).reshapeAs(n)}}),co=Object(R.a)({reverse1d_:function(t){const e=Object(k.a)(t,"x","reverse");return N.assert(1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),lo(e,0)}}),ho=Object(R.a)({reverse2d_:function(t,e){const n=Object(k.a)(t,"x","reverse");return N.assert(2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),lo(n,e)}}),fo=Object(R.a)({reverse3d_:function(t,e){const n=Object(k.a)(t,"x","reverse");return N.assert(3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),lo(n,e)}}),po=Object(R.a)({reverse4d_:function(t,e){const n=Object(k.a)(t,"x","reverse");return N.assert(4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),lo(n,e)}}),mo=Object(R.a)({equalStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","equalStrict"),i=Object(k.a)(e,"b","equalStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in equalStrict: "),n.equal(i)}}),go=Object(R.a)({greaterEqualStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","greaterEqualStrict"),i=Object(k.a)(e,"b","greaterEqualStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in greaterEqualStrict: "),n.greaterEqual(i)}}),yo=Object(R.a)({greaterStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","greaterStrict"),i=Object(k.a)(e,"b","greaterStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in greaterStrict: "),n.greater(i)}}),vo=Object(R.a)({lessEqualStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","lessEqualStrict"),i=Object(k.a)(e,"b","lessEqualStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in lessEqualStrict: "),n.lessEqual(i)}}),bo=Object(R.a)({lessStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","lessStrict"),i=Object(k.a)(e,"b","lessStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in lessStrict: "),n.less(i)}}),xo=Object(R.a)({notEqualStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","notEqualStrict"),i=Object(k.a)(e,"b","notEqualStrict");return Object(N.assertShapesMatch)(n.shape,i.shape,"Error in notEqualStrict: "),n.notEqual(i)}}),wo=Object(R.a)({addStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","addStrict"),i=Object(k.a)(e,"b","addStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in addStrict: "),n.add(i)}}),To=Object(R.a)({divStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","div"),i=Object(k.a)(e,"b","div");return N.assertShapesMatch(n.shape,i.shape,"Error in divideStrict: "),n.div(i)}}),So=Object(R.a)({maximumStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","maximumStrict"),i=Object(k.a)(e,"b","maximumStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in maximumStrict: "),n.maximum(i)}}),Eo=Object(R.a)({minimumStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","minimumStrict"),i=Object(k.a)(e,"b","minimumStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in minimumStrict: "),n.minimum(i)}}),Oo=Object(R.a)({modStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","modStrict"),i=Object(k.a)(e,"b","modStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in modStrict: "),n.mod(i)}}),Co=Object(R.a)({mulStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","mul"),i=Object(k.a)(e,"b","mul");return N.assertShapesMatch(n.shape,i.shape,"Error in multiplyStrict: "),n.mul(i)}}),_o=Object(R.a)({powStrict_:function(t,e){return Cr("strict variants of ops have been deprecated and will be removed in future"),N.assertShapesMatch(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Ao=Object(R.a)({squaredDifferenceStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","squaredDifferenceStrict"),i=Object(k.a)(e,"b","squaredDifferenceStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(i)}}),ko=Object(R.a)({subStrict_:function(t,e){Cr("strict variants of ops have been deprecated and will be removed in future");const n=Object(k.a)(t,"a","subStrict"),i=Object(k.a)(e,"b","subStrict");return N.assertShapesMatch(n.shape,i.shape,"Error in subStrict: "),n.sub(i)}}),Ro=Object(R.a)({softmax_:function(t,e=-1){const n=Object(k.a)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);return w.a.runKernelFunc((t,i)=>{const r=t.softmax(n,e);return i([r]),r},{logits:n},(t,n)=>{const[i]=n,r=t.mul(i);return{logits:()=>r.sub(r.sum([e],!0).mul(i))}},"Softmax",{dim:e},[],[!0])}}),Io=Object(R.a)({logSoftmax_:function(t,e=-1){const n=Object(k.a)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return et((t,n)=>{const i=t.max(e,!0),r=t.sub(i),s=r.toFloat().sub(r.exp().sum(e,!0).log());return n([s]),{value:s,gradFunc:(t,n)=>{const[i]=n,r=i.exp();return t.sub(t.sum(e,!0).mul(r))}}})(n)}});function Mo(t,e,n=null){if(0===t.rank)return t.abs();if(1!==t.rank&&null===n)return Mo(t.reshape([-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return t.abs().sum(n);if(e===1/0)return t.abs().max(n);if(e===-1/0)return t.abs().min(n);if("euclidean"===e||2===e)return t.abs().pow(Object(F.e)(2,"int32")).sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(n)&&2===n.length){if(1===e)return t.abs().sum(n[0]).max(n[1]-1);if(e===1/0)return t.abs().sum(n[1]).max(n[0]);if(e===-1/0)return t.abs().sum(n[1]).min(n[0]);if("fro"===e||"euclidean"===e)return t.square().sum(n).sqrt();throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+n)}const No=Object(R.a)({norm_:function(t,e="euclidean",n=null,i=!1){const r=Mo(t=Object(k.a)(t,"x","norm"),e,n);let s=r.shape;if(i){const e=Object(N.parseAxisParam)(n,t.shape);s=ot(r.shape,e)}return r.reshape(s)}}),Do=Object(R.a)({basicLSTMCell_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"forgetBias","basicLSTMCell"),a=Object(k.a)(e,"lstmKernel","basicLSTMCell"),u=Object(k.a)(n,"lstmBias","basicLSTMCell"),l=Object(k.a)(i,"data","basicLSTMCell"),c=Object(k.a)(r,"c","basicLSTMCell"),h=Object(k.a)(s,"h","basicLSTMCell"),d=l.concat(h,1).matMul(a).add(u),f=d.shape[1]/4,p=[d.shape[0],f],m=d.slice([0,0],p),g=d.slice([0,f],p),y=d.slice([0,2*f],p),v=d.slice([0,3*f],p),b=m.sigmoid().mul(g.tanh()).add(c.mul(o.add(y).sigmoid())),x=b.tanh().mul(v.sigmoid());return[b,x]}}),Po=Object(R.a)({multiRNNCell_:function(t,e,n,i){const r=Object(k.a)(e,"data","multiRNNCell"),s=Object(k.b)(n,"c","multiRNNCell"),o=Object(k.b)(i,"h","multiRNNCell");let a=r;const u=[];for(let h=0;h<t.length;h++){const e=t[h](a,s[h],o[h]);u.push(e[0]),u.push(e[1]),a=e[1]}const l=[],c=[];for(let h=0;h<u.length;h+=2)l.push(u[h]),c.push(u[h+1]);return[l,c]}}),Fo=Object(R.a)({movingAverage_:function(t,e,n,i,r=!0){const s=Object(k.a)(t,"v","movingAverage"),o=Object(k.a)(e,"x","movingAverage"),a=Object(k.a)(n,"decay","movingAverage");Object(A.assertTypesMatch)(s,o),N.assert(N.arraysEqual(s.shape,o.shape),()=>"Shape mismatch in v and x");const u=Object(F.e)(1),l=u.sub(a);let c=o.sub(s).mul(l);if(r){N.assert(null!=i,()=>"When using zeroDebias: true, step is required.");const t=Object(k.a)(i,"step","movingAverage");c=c.div(u.sub(xn(a,t)))}return s.add(c)}}),Lo=Object(R.a)({stridedSlice_:function(t,e,n,i,r=0,s=0,o=0,a=0,u=0){null==i&&(i=new Array(e.length));const l=Fn(o);if(l.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==a)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");let c=Object(k.a)(t,"x","stridedSlice");const h=c.rank-e.length,d=Fn(a),f=c.shape.slice();d.forEach(t=>{e[t]=0,n[t]=1,f.splice(t,0,1)}),c=c.reshape(f);for(let y=0;y<c.rank;y++)e[y]=Un(r,e,i,c.shape,y,o),n[y]=Wn(s,n,i,c.shape,y,o),i[y]=$n(i,y,o);if(l.length&&h>0){const t=l[0],r=h+1;e=Bn(e,t,r),n=zn(n,t,r,c.shape),i=jn(i,t,r)}const p=Fn(u);p.forEach(t=>{n[t]=e[t]+1,i[t]=1});const m=Ln(e,n,i),g=m.filter((t,e)=>-1===p.indexOf(e));return i.every(t=>1===t)?Gn(c,e,m).reshape(g):w.a.runKernelFunc(t=>t.stridedSlice(c,e,n,i),{$x:c}).reshape(g)}}),jo=Object(R.a)({topk_:function(t,e=1,n=!0){const i=Object(k.a)(t,"x","topk");if(0===i.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const r=i.shape[i.shape.length-1];if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got `+e);const[s,o]=w.a.runKernelFunc(t=>t.topk(i,e,n),{$x:i});return{values:s,indices:o}}}),Bo=Object(R.a)({scatterND_:function(t,e,n){const i=Object(k.a)(t,"indices","scatterND","int32"),r=Object(k.a)(e,"updates","scatterND");return ar(r,i,n),w.a.runKernelFunc(t=>t.scatterND(i,r,n),{indices:i,updates:r},null,"ScatterNd",{shape:n})}}),zo=Object(R.a)({fft_:function(t){Object(N.assert)("complex64"===t.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return w.a.runKernelFunc(t=>t.fft(n),{input:t}).reshape(t.shape)}}),$o=Object(R.a)({ifft_:function(t){Object(N.assert)("complex64"===t.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return w.a.runKernelFunc(t=>t.ifft(n),{input:t}).reshape(t.shape)}}),Uo=Object(R.a)({rfft_:function(t,e){Object(N.assert)("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got "+t.dtype);let n=t.shape[t.shape.length-1];const i=t.size/n;let r;if(null!=e&&e<n){const i=t.shape.map(t=>0),s=t.shape.map(t=>t);s[t.shape.length-1]=e,r=t.slice(i,s),n=e}else if(null!=e&&e>n){const i=t.shape.map(t=>t);i[t.shape.length-1]=e-n,r=t.concat(Object(F.n)(i),t.shape.length-1),n=e}else r=t;const s=r.zerosLike(),o=Object(es.a)(r,s).as2D(i,n),a=zo(o),u=Math.floor(n/2)+1,l=Object(Gs.a)(a),c=Object(bs.a)(a),h=l.split([u,n-u],l.shape.length-1),d=c.split([u,n-u],c.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=u,Object(es.a)(h[0],d[0]).reshape(f)}}),Wo=Object(R.a)({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){const i=t.as2D(n,e),r=$o(i);return Object(Gs.a)(r)}{const i=[n,2*(e-1)],r=Object(Gs.a)(t).as2D(n,e),s=Object(bs.a)(t).as2D(n,e),o=r.slice([0,1],[n,e-2]).reverse(1),a=s.slice([0,1],[n,e-2]).reverse(1).mul(Object(F.e)(-1)),u=r.concat(o,1),l=s.concat(a,1),c=Object(es.a)(u,l).as2D(i[0],i[1]),h=$o(c);return Object(Gs.a)(h)}}}),Vo=Object(R.a)({sparseToDense_:function(t,e,n,i=0){const r=Object(k.a)(t,"sparseIndices","sparseToDense","int32"),s=Object(k.a)(e,"sparseValues","sparseToDense"),o=Object(k.a)(i,"defaultValue","sparseToDense",s.dtype);return function(t,e,n,i){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,s=t.rank>1?t.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);if(0!==e.rank&&(1!==e.rank||e.size!==r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==i.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(r,s,n,o),w.a.runKernelFunc(t=>t.sparseToDense(r,s,n,o),{$sparseIndices:r,$sparseValues:s,$defaultValue:o})}}),Yo=Object(R.a)({gatherND_:function(t,e){const n=Object(k.a)(e,"indices","gatherND","int32"),i=Object(k.a)(t,"x","gatherND");return w.a.runKernelFunc(t=>t.gatherND(i,n),{params:i,indices:n},null,T.G)}}),Go=Object(R.a)({dropout_:function(t,e,n,i){const r=Object(k.a)(t,"x","dropout");if(N.assert("float32"===r.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),N.assert(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof M.a?r.clone():r;const s=function(t,e){if(null==e)return t.shape.slice();if(N.arraysEqual(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let i=0;i<t.shape.length;i++)n.push(null==e[i]&&null!=t.shape[i]?t.shape[i]:e[i]);return n}return e}(r,n),o=1-e,a=Ys(s,0,1,"float32",i).add(o).floor().div(o);return r.mul(a)}});function Xo(t,e,n){const i=1-t%2,r=new Float32Array(t);for(let s=0;s<t;++s){const o=2*Math.PI*s/(t+i-1);r[s]=e-n*Math.cos(o)}return Object(F.g)(r,"float32")}const Ho=Object(R.a)({hannWindow_:function(t){return Xo(t,.5,.5)}}),qo=Object(R.a)({hammingWindow_:function(t){return Xo(t,.54,.46)}}),Ko=Object(R.a)({frame_:function(t,e,n,i=!1,r=0){let s=0;const o=[];for(;s+e<=t.size;)o.push(Gn(t,s,e)),s+=n;if(i)for(;s<t.size;){const i=s+e-t.size,a=L([Gn(t,s,e-i),vs([i],r)]);o.push(a),s+=n}return 0===o.length?Object(F.h)([],[0,e]):L(o).as2D(o.length,e)}}),Jo=Object(R.a)({stft_:function(t,e,n,i,r=Ho){null==i&&(i=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));const s=Ko(t,e,n),o=q(s,r(e)),a=[];for(let u=0;u<s.shape[0];u++)a.push(Uo(o.slice([u,0],[1,e]),i));return L(a)}}),Qo=async function(t,e,n=1){const i=Object(k.a)(t,"predictions","inTopK"),r=Object(k.a)(e,"targets","inTopK");Object(N.assert)(i.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got "+i.rank),Object(N.assert)(i.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${i.rank} and targets rank ${r.rank}`),Object(N.assertShapesMatch)(i.shape.slice(0,i.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=i.shape[i.shape.length-1];Object(N.assert)(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const o=await i.data(),a=await r.data(),[u,l]=[o.length/s,s],c=Object(N.getTypedArrayFromDType)("bool",u);for(let h=0;h<u;h++){const t=h*l,e=o.subarray(t,t+l),i=[];for(let n=0;n<e.length;n++)i.push({value:e[n],index:n});i.sort((t,e)=>e.value-t.value),c[h]=0;for(let r=0;r<n;r++)if(i[r].index===a[h]){c[h]=1;break}}return t!==i&&i.dispose(),e!==r&&r.dispose(),Object(F.f)(c,r.shape,"bool")};var Zo;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Zo||(Zo={}));const ta=Object(R.a)({absoluteDifference_:function(t,e,n,i=Zo.SUM_BY_NONZERO_WEIGHTS){const r=Object(k.a)(t,"labels","absoluteDifference"),s=Object(k.a)(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=Object(k.a)(n,"weights","absoluteDifference")),Object(N.assertShapesMatch)(r.shape,s.shape,"Error in absoluteDifference: ");const a=r.sub(s).abs();return ea(a,o,i)}}),ea=Object(R.a)({computeWeightedLoss_:function(t,e,n=Zo.SUM_BY_NONZERO_WEIGHTS){const i=Object(k.a)(t,"losses","computeWeightedLoss");let r=null;null!=e&&(r=Object(k.a)(e,"weights","computeWeightedLoss"));const s=null==r?i:i.mul(r);if(n===Zo.NONE)return s;if(n===Zo.SUM)return s.sum();if(n===Zo.MEAN){if(null==r)return s.mean();{const t=i.size/r.size,e=s.sum().div(r.sum());return t>1?e.div(Object(F.e)(t)):e}}if(n===Zo.SUM_BY_NONZERO_WEIGHTS){if(null==r)return s.sum().div(Object(F.e)(i.size));{const t=r.mul(Object(F.b)(i.shape)).notEqual(Object(F.e)(0)).sum().toFloat();return s.sum().div(t)}}throw Error("Unknown reduction: "+n)}}),na=Object(R.a)({cosineDistance_:function(t,e,n,i,r=Zo.SUM_BY_NONZERO_WEIGHTS){const s=Object(k.a)(t,"labels","cosineDistance"),o=Object(k.a)(e,"predictions","cosineDistance");let a=null;null!=i&&(a=Object(k.a)(i,"weights","cosineDistance")),Object(N.assertShapesMatch)(s.shape,o.shape,"Error in cosineDistance: ");const u=Object(F.e)(1).sub(s.mul(o).sum(n,!0));return ea(u,a,r)}}),ia=Object(R.a)({hingeLoss_:function(t,e,n,i=Zo.SUM_BY_NONZERO_WEIGHTS){let r=Object(k.a)(t,"labels","hingeLoss");const s=Object(k.a)(e,"predictions","hingeLoss");let o=null;null!=n&&(o=Object(k.a)(n,"weights","hingeLoss")),Object(N.assertShapesMatch)(r.shape,s.shape,"Error in hingeLoss: ");const a=Object(F.e)(1);r=Object(F.e)(2).mul(r).sub(a);const u=a.sub(r.mul(s)).relu();return ea(u,o,i)}}),ra=Object(R.a)({huberLoss_:function(t,e,n,i=1,r=Zo.SUM_BY_NONZERO_WEIGHTS){const s=Object(k.a)(t,"labels","huberLoss"),o=Object(k.a)(e,"predictions","huberLoss");let a=null;null!=n&&(a=Object(k.a)(n,"weights","huberLoss")),Object(N.assertShapesMatch)(s.shape,o.shape,"Error in huberLoss: ");const u=Object(F.e)(i),l=o.sub(s).abs(),c=_s(l,u),h=l.sub(c),d=Object(F.e)(.5).mul(c.square()).add(u.mul(h));return ea(d,a,r)}}),sa=Object(R.a)({logLoss_:function(t,e,n,i=1e-7,r=Zo.SUM_BY_NONZERO_WEIGHTS){const s=Object(k.a)(t,"labels","logLoss"),o=Object(k.a)(e,"predictions","logLoss");let a=null;null!=n&&(a=Object(k.a)(n,"weights","logLoss")),Object(N.assertShapesMatch)(s.shape,o.shape,"Error in logLoss: ");const u=Object(F.e)(1),l=Object(F.e)(i),c=s.mul(o.add(l).log()).neg().sub(u.sub(s).mul(u.sub(o).add(l).log()));return ea(c,a,r)}}),oa=Object(R.a)({meanSquaredError_:function(t,e,n,i=Zo.SUM_BY_NONZERO_WEIGHTS){const r=Object(k.a)(t,"labels","meanSquaredError"),s=Object(k.a)(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=Object(k.a)(n,"weights","meanSquaredError")),Object(N.assertShapesMatch)(r.shape,s.shape,"Error in meanSquaredError: ");const a=r.squaredDifference(s);return ea(a,o,i)}}),aa=Object(R.a)({sigmoidCrossEntropy_:function(t,e,n,i=0,r=Zo.SUM_BY_NONZERO_WEIGHTS){let s=Object(k.a)(t,"multiClassLabels","sigmoidCrossEntropy");const o=Object(k.a)(e,"logits","sigmoidCrossEntropy");let a=null;if(null!=n&&(a=Object(k.a)(n,"weights","sigmoidCrossEntropy")),Object(N.assertShapesMatch)(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),i>0){const t=Object(F.e)(i),e=Object(F.e)(1),n=Object(F.e)(.5);s=s.mul(e.sub(t)).add(n.mul(t))}const u=function(t,e){const n=Object(k.a)(t,"labels","sigmoidCrossEntropyWithLogits"),i=Object(k.a)(e,"logits","sigmoidCrossEntropyWithLogits");Object(N.assertShapesMatch)(n.shape,i.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=i.relu(),s=i.mul(n),o=i.abs().neg().exp().log1p();return r.sub(s).add(o)}(s,o);return ea(u,a,r)}}),ua=Object(R.a)({softmaxCrossEntropy_:function(t,e,n,i=0,r=Zo.SUM_BY_NONZERO_WEIGHTS){let s=Object(k.a)(t,"onehotLabels","softmaxCrossEntropy");const o=Object(k.a)(e,"logits","softmaxCrossEntropy");let a=null;if(null!=n&&(a=Object(k.a)(n,"weights","softmaxCrossEntropy")),Object(N.assertShapesMatch)(s.shape,o.shape,"Error in softmaxCrossEntropy: "),i>0){const t=Object(F.e)(i),e=Object(F.e)(1),n=Object(F.e)(s.shape[1]);s=s.mul(e.sub(t)).add(t.div(n))}const u=function(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was `+n);return et((t,e,i)=>{const r=e.logSumExp([n],!0),s=e.toFloat().sub(r);return i([t,s]),{value:s.mul(t).neg().sum([n]),gradFunc:(t,e)=>{const[i,r]=e,s=ot(t.shape,[n]);return[t.reshape(s).mul(i.toFloat().sub(r.exp())),t.reshape(s).mul(r.exp().sub(i.toFloat()))]}}})(t,e)}(s,o);return ea(u,a,r)}});function la(t,e=!1){return w.a.tidy(()=>{if(2!==t.shape.length)throw new Error(`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],i=t.shape[1];let r=ys(n),s=t.clone();const o=Object(F.h)([[1]],[1,1]);let a=o.clone();const u=n>=i?i:n;for(let t=0;t<u;++t){const e=s,u=a,l=r;[a,s,r]=w.a.tidy(()=>{const e=s.slice([t,t],[n-t,1]),u=e.norm(),l=s.slice([t,t],[1,1]),c=Object(F.h)([[-1]]).where(l.greater(0),Object(F.h)([[1]])),h=l.sub(c.mul(u)),d=e.div(h);a=1===d.shape[0]?o.clone():o.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);const f=c.matMul(h).div(u).neg(),p=s.slice([t,0],[n-t,i]),m=f.mul(a),g=a.transpose();if(0===t)s=p.sub(m.matMul(g.matMul(p)));else{const e=p.sub(m.matMul(g.matMul(p)));s=s.slice([0,0],[t,i]).concat(e,0)}const y=m.transpose(),v=r.slice([0,t],[n,r.shape[1]-t]);if(0===t)r=v.sub(v.matMul(a).matMul(y));else{const e=v.sub(v.matMul(a).matMul(y));r=r.slice([0,0],[n,t]).concat(e,1)}return[a,s,r]}),Mr([e,u,l])}return!e&&n>i&&(r=r.slice([0,0],[n,i]),s=s.slice([0,0],[i,i])),[r,s]})}const ca=Object(R.a)({bandPart_:function(t,e,n){if(e%1!=0)throw new Error(`bandPart(): numLower must be an integer, got ${e}.`);if(n%1!=0)throw new Error(`bandPart(): numUpper must be an integer, got ${n}.`);const i=Object(k.a)(t,"a","bandPart");if(i.rank<2)throw new Error(`bandPart(): Rank must be at least 2, got ${i.rank}.`);const r=i.shape,[s,o]=i.shape.slice(-2);if(!(e<=s))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${s}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=s),n<0&&(n=o);const a=Object(F.d)(0,s,1,"int32").reshape([-1,1]),u=Object(F.d)(0,o,1,"int32"),l=Ve(a,u),c=pn(l.lessEqual(Object(F.e)(+e,"int32")),l.greaterEqual(Object(F.e)(-n,"int32"))),h=Object(F.n)([s,o],i.dtype);return V(Y(i.reshape([-1,s,o])).map(t=>vn(c,t,h))).reshape(r)}}),ha=Object(R.a)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,Object(N.assert)(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)Object(N.assert)(t[e].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`)}else e=!0,t=Oe(t,t.shape[0],0).map(t=>W(t,[0]));Object(N.assert)(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],i=t;for(let r=0;r<t.length;++r)n.push(w.a.tidy(()=>{let t=i[r];if(r>0)for(let e=0;e<r;++e){const i=xt(n[e].mul(t)).mul(n[e]);t=t.sub(i)}return t.div(No(t,"euclidean"))}));return e?V(n,0):n}}),da=Object(R.a)({qr_:function(t,e=!1){if(t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return la(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),i=Y(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],s=[];return i.forEach(t=>{const[n,i]=la(t,e);r.push(n),s.push(i)}),[V(r,0).reshape(t.shape),V(s,0).reshape(t.shape)]}}});function fa(t,e,n){const i=function(t,e,n){return function(t,e,n){let i=0,r=t.length,s=0,o=!1;for(;i<r;){s=i+(r-i>>>1);const a=n(e,t[s]);a>0?i=s+1:(r=s,o=!a)}return o?i:-i-1}(t,e,n||pa)}(t,e,n);t.splice(i<0?-(i+1):i,0,e)}function pa(t,e){return t>e?1:t<e?-1:0}function ma(t,e,n,i,r){const s=ya(t,e,n,i,r,0);return s.selectedScores.dispose(),s.numValidOutputs.dispose(),s.selectedIndices}function ga(t,e,n,i,r,s){const o=ya(t,e,n,i,r,s,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function ya(t,e,n,i,r,s,o=!1,a=!1){const u=[];for(let f=0;f<e.length;f++)e[f]>r&&u.push({score:e[f],boxIndex:f,suppressBeginIndex:0});u.sort(xa);const l=s>0?-.5/s:0,c=[],h=[];for(;c.length<n&&u.length>0;){const e=u.pop(),{score:n,boxIndex:s,suppressBeginIndex:o}=e;if(n<r)break;let a=!1;for(let u=c.length-1;u>=o;--u){const n=va(t,s,c[u]);if(n>=i){a=!0;break}if(e.score=e.score*ba(i,l,n),e.score<=r)break}e.suppressBeginIndex=c.length,a||(e.score===n?(c.push(s),h.push(e.score)):e.score>r&&fa(u,e,xa))}const d=c.length;return a&&(c.fill(0,d),h.fill(0,d)),{selectedIndices:Object(F.g)(c,"int32"),selectedScores:Object(F.g)(h,"float32"),numValidOutputs:Object(F.e)(d,"int32")}}function va(t,e,n){const i=t.subarray(4*e,4*e+4),r=t.subarray(4*n,4*n+4),s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),u=Math.max(i[1],i[3]),l=Math.min(r[0],r[2]),c=Math.min(r[1],r[3]),h=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),f=(a-s)*(u-o),p=(h-l)*(d-c);if(f<=0||p<=0)return 0;const m=Math.max(s,l),g=Math.max(o,c),y=Math.min(a,h),v=Math.min(u,d),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(f+p-b)}function ba(t,e,n){const i=Math.exp(e*n*n);return n<=t?i:0}function xa(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function wa(t,e,n,i,r,s){null==i&&(i=.5),null==r&&(r=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=t.shape[0];return n=Math.min(n,o),N.assert(0<=i&&i<=1,()=>`iouThreshold must be in [0, 1], but was '${i}'`),N.assert(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),N.assert(4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]),N.assert(1===e.rank,()=>"scores must be a 1D tensor"),N.assert(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was `+e.shape[0]),N.assert(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:i,scoreThreshold:r,softNmsSigma:s}}const Ta=Object(R.a)({nonMaxSuppression_:function(t,e,n,i=.5,r=Number.NEGATIVE_INFINITY){const s=Object(k.a)(t,"boxes","nonMaxSuppression"),o=Object(k.a)(e,"scores","nonMaxSuppression"),a=wa(s,o,n,i,r);return w.a.runKernelFunc(t=>t.nonMaxSuppression(s,o,n,i,r),{boxes:s,scores:o},null,T.Z,{maxOutputSize:n=a.maxOutputSize,iouThreshold:i=a.iouThreshold,scoreThreshold:r=a.scoreThreshold})}}),Sa=Object(R.a)({resizeBilinear_:function(t,e,n=!1){const i=Object(k.a)(t,"images","resizeBilinear");N.assert(3===i.rank||4===i.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),N.assert(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+".");let r=i,s=!1;3===i.rank&&(s=!0,r=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));const[o,a]=e,u=w.a.runKernelFunc((t,e)=>(e([r]),t.resizeBilinear(r,o,a,n)),{x:r},(t,e)=>({x:()=>w.a.runKernelFunc(i=>i.resizeBilinearBackprop(t,e[0],n),{})}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:a});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Ea=Object(R.a)({resizeNearestNeighbor_:function(t,e,n=!1){const i=Object(k.a)(t,"images","resizeNearestNeighbor");N.assert(3===i.rank||4===i.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),N.assert(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."),N.assert("float32"===i.dtype||"int32"===i.dtype,()=>"`images` must have `int32` or `float32` as dtype");let r=i,s=!1;3===i.rank&&(s=!0,r=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));const[o,a]=e,u=w.a.runKernelFunc((t,e)=>(e([r]),t.resizeNearestNeighbor(r,o,a,n)),{batchImages:r},(t,e)=>({batchImages:()=>w.a.runKernelFunc(i=>i.resizeNearestNeighborBackprop(t,e[0],n),{})}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Oa=async function(t,e,n,i=.5,r=Number.NEGATIVE_INFINITY){const s=Object(k.a)(t,"boxes","nonMaxSuppressionAsync"),o=Object(k.a)(e,"scores","nonMaxSuppressionAsync"),a=wa(s,o,n,i,r);n=a.maxOutputSize,i=a.iouThreshold,r=a.scoreThreshold;const u=await Promise.all([s.data(),o.data()]),l=ma(u[0],u[1],n,i,r);return s!==t&&s.dispose(),o!==e&&o.dispose(),l},Ca=Object(R.a)({nonMaxSuppressionWithScore_:function(t,e,n,i=.5,r=Number.NEGATIVE_INFINITY,s=0){const o=Object(k.a)(t,"boxes","nonMaxSuppression"),a=Object(k.a)(e,"scores","nonMaxSuppression"),u=wa(o,a,n,i,r,s),l=w.a.runKernel("NonMaxSuppressionV5",{boxes:o,scores:a},{maxOutputSize:n=u.maxOutputSize,iouThreshold:i=u.iouThreshold,scoreThreshold:r=u.scoreThreshold,softNmsSigma:s=u.softNmsSigma});return{selectedIndices:l[0],selectedScores:l[1]}}}),_a=async function(t,e,n,i=.5,r=Number.NEGATIVE_INFINITY,s=0){const o=Object(k.a)(t,"boxes","nonMaxSuppressionAsync"),a=Object(k.a)(e,"scores","nonMaxSuppressionAsync"),u=wa(o,a,n,i,r,s);n=u.maxOutputSize,i=u.iouThreshold,r=u.scoreThreshold,s=u.softNmsSigma;const l=await Promise.all([o.data(),a.data()]),c=ga(l[0],l[1],n,i,r,s);return o!==t&&o.dispose(),a!==e&&a.dispose(),c},Aa=Object(R.a)({cropAndResize_:function(t,e,n,i,r,s){const o=Object(k.a)(t,"image","cropAndResize"),a=Object(k.a)(e,"boxes","cropAndResize","float32"),u=Object(k.a)(n,"boxInd","cropAndResize","int32");r=r||"bilinear",s=s||0;const l=a.shape[0];return N.assert(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),N.assert(2===a.rank&&4===a.shape[1],()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${a.shape}.`),N.assert(1===u.rank&&u.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${a.shape}.`),N.assert(2===i.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${i.length}.`),N.assert(i[0]>=1&&i[1]>=1,()=>"cropSize must be atleast [1,1], but was "+i),N.assert("bilinear"===r||"nearest"===r,()=>"method must be bilinear or nearest, but was "+r),w.a.runKernelFunc((t,e)=>t.cropAndResize(o,a,u,i,r,s),{images:o,boxes:a,boxInd:u},null,"CropAndResize",{method:r,extrapolationValue:s,cropSize:i})}}),ka=(t,e)=>!(t>0)||"linear"===e,Ra=(t,e,n)=>{if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error(`Gradient for activation ${n} has not been implemented yet.`)},Ia=(t,e)=>{let n=e;const i=E(t.shape,e.shape);return i.length>0&&(n=n.sum(i)),n.reshape(t.shape)},Ma=(t,e,n)=>{if("linear"===e)return t;if("relu"===e)return Xs(t);if("elu"===e)return ms(t);if("relu6"===e)return Hs(t);if("prelu"===e)return Ls(t,n);throw new Error(`Unknown fused activation ${e}.`)},Na=Object(R.a)({fusedMatMul_:function({a:t,b:e,transposeA:n=!1,transposeB:i=!1,bias:r,activation:s="linear",preluActivationWeights:o}){if(!1===ka(w.a.state.gradientDepth,s)){let a=xe(t,e,n,i);return null!=r&&(a=I(a,r)),Ma(a,s,o)}let a=Object(k.a)(t,"a","fused matMul"),u=Object(k.a)(e,"b","fused matMul");[a,u]=Object(A.makeTypesMatch)(a,u);const l=n?a.shape[a.rank-2]:a.shape[a.rank-1],c=i?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?a.shape[a.rank-1]:a.shape[a.rank-2],d=i?u.shape[u.rank-2]:u.shape[u.rank-1],f=a.shape.slice(0,-2),p=u.shape.slice(0,-2),m=N.sizeFromShape(f),g=N.sizeFromShape(p);N.assert(a.rank>=2&&u.rank>=2&&a.rank===u.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${a.rank} and ${u.rank}.`),N.assert(N.arraysEqual(f,p),()=>`Error in fused matMul: outer dimensions (${f}) and (${p}) of Tensors with shapes ${a.shape} and `+u.shape+" must match."),N.assert(l===c,()=>`Error in fused matMul: inner shapes (${l}) and (${c}) of Tensors with shapes ${a.shape} and ${u.shape} and transposeA=${n} and transposeB=${i} must match.`);const y=a.shape.slice(0,-2).concat([h,d]),v=n?a.as3D(m,l,h):a.as3D(m,h,l),b=i?u.as3D(g,d,c):u.as3D(g,c,d);let x,T;null!=r&&(x=Object(k.a)(r,"bias","fused matMul"),[x]=Object(A.makeTypesMatch)(x,a),O(y,x.shape)),null!=o&&(T=Object(k.a)(o,"prelu weights","fused matMul"));const S={a:v,b:b};return null!=r&&(S.bias=x),null!=o&&(S.preluActivationWeights=T),w.a.runKernelFunc((t,e)=>{const r=t.fusedBatchMatMul({a:v,b:b,transposeA:n,transposeB:i,bias:x,activation:s,preluActivationWeights:T});return e([v,b,r]),r},S,(t,e)=>{const[o,a,u]=e,l=Ra(t,u,s);let c={};return null!=r&&(c={bias:()=>Ia(x,l)}),Object.assign(n||i?!n&&i?{a:()=>l.matMul(a,!1,!1),b:()=>l.matMul(o,!0,!1)}:n&&!i?{a:()=>a.matMul(l,!1,!0),b:()=>o.matMul(l,!1,!1)}:{a:()=>a.matMul(l,!0,!0),b:()=>l.matMul(o,!0,!0)}:{a:()=>l.matMul(a,!1,!0),b:()=>o.matMul(l,!0,!1)},c)},"_FusedMatMul",{transposeA:n,transposeB:i,activation:s},[v,b],[!0]).reshape(y)}}),Da=Object(R.a)({fusedConv2d_:function({x:t,filter:e,strides:n,pad:i,dataFormat:r="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l}){if(!1===ka(w.a.state.gradientDepth,u=u||"linear")){let c=Re(t,e,n,i,r,s,o);return null!=a&&(c=I(c,a)),Ma(c,u,l)}const c=Object(k.a)(t,"x","conv2d"),h=Object(k.a)(e,"filter","conv2d");let d=c,f=!1;3===c.rank&&(f=!0,d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),N.assert(4===d.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+d.rank+"."),N.assert(4===h.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+h.rank+"."),null!=o&&N.assert(N.isInt(i),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`),N.assert(d.shape[3]===h.shape[2],()=>`Error in conv2d: depth of input (${d.shape[3]}) must match input depth for filter ${h.shape[2]}.`),N.assert(pe(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),N.assert("NHWC"===r,()=>`Error in conv2d: got dataFormat of ${r} but only NHWC is currently supported.`);const p=oe(d.shape,h.shape,n,s,i,o);let m,g;null!=a&&(m=Object(k.a)(a,"bias","fused conv2d"),[m]=Object(A.makeTypesMatch)(m,c),O(p.outShape,m.shape)),null!=l&&(g=Object(k.a)(l,"prelu weights","fused conv2d"));const y={x:d,filter:h};null!=a&&(y.bias=m),null!=l&&(y.preluActivationWeights=g);const v=w.a.runKernelFunc((t,e)=>{const n=t.fusedConv2d({input:d,filter:h,convInfo:p,bias:m,activation:u,preluActivationWeights:g});return e([h,d,n]),n},y,(t,e)=>{const[r,o,l]=e,c=Ra(t,l,u);N.assert(fe(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);let h={};return null!=a&&(h={bias:()=>Ia(m,c)}),Object.assign({x:()=>Ae(o.shape,c,r,n,i),filter:()=>_e(o,c,r.shape,n,i)},h)},"FusedConv2D",{convInfo:p,activation:u},[h,d],[!0]);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Pa=Object(R.a)({fusedDepthwiseConv2d_:function({x:t,filter:e,strides:n,pad:i,dataFormat:r="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:a,activation:u="linear",preluActivationWeights:l}){if(!1===ka(w.a.state.gradientDepth,u)){let c=hs(t,e,n,i,r,s,o);return null!=a&&(c=I(c,a)),Ma(c,u,l)}const c=Object(k.a)(t,"x","depthwiseConv2d"),h=Object(k.a)(e,"filter","depthwiseConv2d");let d=c,f=!1;3===c.rank&&(f=!0,d=c.as4D(1,c.shape[0],c.shape[1],c.shape[2])),N.assert(4===d.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),N.assert(4===h.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),N.assert(d.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${d.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),null==s&&(s=[1,1]),N.assert(pe(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),null!=o&&N.assert(N.isInt(i),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${o} but got pad ${i}.`);const p=oe(d.shape,h.shape,n,s,i,o,!0);let m,g;null!=a&&(m=Object(k.a)(a,"bias","fused conv2d"),[m]=Object(A.makeTypesMatch)(m,c),O(p.outShape,m.shape)),null!=l&&(g=Object(k.a)(l,"prelu weights","fused depthwiseConv2d"));const y={x:d,filter:h};null!=a&&(y.bias=m),null!=l&&(y.preluActivationWeights=g);const v=w.a.runKernelFunc((t,e)=>{const n=t.fusedDepthwiseConv2D({input:d,filter:h,convInfo:p,bias:m,activation:u,preluActivationWeights:g});return e([h,d,n]),n},y,(t,e)=>{N.assert(fe(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[n,i,r]=e,o=Ra(t,r,u);let l={};return null!=a&&(l={bias:()=>Ia(m,o)}),Object.assign({x:()=>Be(i.shape,o,n,p),filter:()=>je(i,o,n.shape,p)},l)},"FusedDepthwiseConv2D",{convInfo:p,activation:u},[h,d],[!0]);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}});class Fa extends lr{minimize(t,e=!1,n){const{value:i,grads:r}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:r[t.name]}));this.applyGradients(t)}else this.applyGradients(r);return Mr(r),e?i:(i.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return tt(t,e)}dispose(){null!=this.iterations_&&Mr(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Object(F.e)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Fa,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});class La extends Fa{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=w.a.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const i=w.a.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:e+"/accum_grad",variable:Ir(()=>Object(F.o)(i).variable(!1))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:e+"/accum_var",variable:Ir(()=>Object(F.o)(i).variable(!1))});const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const s=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;Ir(()=>{const t=s.mul(this.rho).add(r.square().mul(1-this.rho)),e=o.add(this.epsilon).sqrt().div(s.add(this.epsilon).sqrt()).mul(r),n=o.mul(this.rho).add(e.square().mul(1-this.rho));s.assign(t),o.assign(n);const a=e.mul(-this.learningRate).add(i);i.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Mr(this.accumulatedGrads.map(t=>t.variable)),Mr(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}La.className="Adadelta",hr(La);class ja extends Fa{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const i=w.a.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:e+"/accumulator",variable:Ir(()=>vs(i.shape,this.initialAccumulatorValue).variable(t))}}const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const s=this.accumulatedGrads[n].variable;Ir(()=>{const t=s.add(r.square());s.assign(t);const e=r.div(t.add(w.a.backend.epsilon()).sqrt()).mul(-this.learningRate).add(i);i.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Mr(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}ja.className="Adagrad",hr(ja);class Ba extends Fa{constructor(t,e,n,i=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ir(()=>{this.accBeta1=Object(F.e)(e).variable(),this.accBeta2=Object(F.e)(n).variable()}),null==i&&(this.epsilon=w.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Ir(()=>{const n=Ve(1,this.accBeta1),i=Ve(1,this.accBeta2);e.forEach((e,r)=>{const s=w.a.registeredVariables[e];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:e+"/m",variable:Ir(()=>Object(F.o)(s).variable(!1))}),null==this.accumulatedSecondMoment[r]&&(this.accumulatedSecondMoment[r]={originalName:e+"/v",variable:Ir(()=>Object(F.o)(s).variable(!1))});const o=Array.isArray(t)?t[r].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[r].variable,u=this.accumulatedSecondMoment[r].variable,l=a.mul(this.beta1).add(o.mul(1-this.beta1)),c=u.mul(this.beta2).add(o.square().mul(1-this.beta2)),h=l.div(n),d=c.div(i);a.assign(l),u.assign(c);const f=h.div(d.sqrt().add(this.epsilon)).mul(-this.learningRate).add(s);s.assign(f)}),this.accBeta1.assign(this.accBeta1.mul(this.beta1)),this.accBeta2.assign(this.accBeta2.mul(this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Mr(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Mr(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),Ir(()=>{this.accBeta1.assign(xn(this.beta1,this.iterations_+1)),this.accBeta2.assign(xn(this.beta2,this.iterations_+1))});const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}Ba.className="Adam",hr(Ba);class za extends Fa{constructor(t,e,n,i=null,r=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=i,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ir(()=>{this.iteration=Object(F.e)(0).variable(),this.accBeta1=Object(F.e)(e).variable()}),null==i&&(this.epsilon=w.a.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Ir(()=>{const n=Ve(1,this.accBeta1),i=H(-this.learningRate,this.iteration.mul(this.decay).add(1));e.forEach((e,r)=>{const s=w.a.registeredVariables[e];null==this.accumulatedFirstMoment[r]&&(this.accumulatedFirstMoment[r]={originalName:e+"/m",variable:Object(F.o)(s).variable(!1)}),null==this.accumulatedWeightedInfNorm[r]&&(this.accumulatedWeightedInfNorm[r]={originalName:e+"/v",variable:Object(F.o)(s).variable(!1)});const o=Array.isArray(t)?t[r].tensor:t[e];if(null==o)return;const a=this.accumulatedFirstMoment[r].variable,u=this.accumulatedWeightedInfNorm[r].variable,l=a.mul(this.beta1).add(o.mul(1-this.beta1)),c=u.mul(this.beta2),h=o.abs(),d=c.maximum(h);a.assign(l),u.assign(d);const f=i.div(n).mul(l.div(d.add(this.epsilon))).add(s);s.assign(f)}),this.iteration.assign(this.iteration.add(1)),this.accBeta1.assign(this.accBeta1.mul(this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Mr(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Mr(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}za.className="Adamax",hr(za);class $a extends Fa{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const r=w.a.registeredVariables[e];Ir(()=>{const t=this.c.mul(i).add(r);r.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Nr(Object(F.e)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}$a.className="SGD",hr($a);class Ua extends $a{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Object(F.e)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const i=w.a.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:e+"/momentum",variable:Ir(()=>Object(F.o)(i).variable(t))}}const r=this.accumulations[n].variable,s=Array.isArray(t)?t[n].tensor:t[e];null!=s&&Ir(()=>{let t;const e=this.m.mul(r).add(s);t=this.useNesterov?this.c.mul(s.add(e.mul(this.m))).add(i):this.c.mul(e).add(i),r.assign(e),i.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Mr(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}Ua.className="Momentum",hr(Ua);class Wa extends Fa{constructor(t,e=.9,n=0,i=null,r=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,null==i&&(this.epsilon=w.a.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const i=w.a.registeredVariables[e],r=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:e+"/rms",variable:Ir(()=>Object(F.o)(i).variable(r))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:e+"/momentum",variable:Ir(()=>Object(F.o)(i).variable(r))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:e+"/mg",variable:Ir(()=>Object(F.o)(i).variable(r))});const s=Array.isArray(t)?t[n].tensor:t[e];if(null==s)return;const o=this.accumulatedMeanSquares[n].variable,a=this.accumulatedMoments[n].variable;Ir(()=>{const t=o.mul(this.decay).add(s.square().mul(1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,r=e.mul(this.decay).add(s.mul(1-this.decay)),u=a.mul(this.momentum).add(s.mul(this.learningRate).div(t.sub(r.square().add(this.epsilon)).sqrt()));o.assign(t),e.assign(r),a.assign(u);const l=i.sub(u);i.assign(l)}else{const t=o.mul(this.decay).add(s.square().mul(1-this.decay)),e=a.mul(this.momentum).add(s.mul(this.learningRate).div(t.add(this.epsilon).sqrt()));o.assign(t),a.assign(e);const n=i.sub(e);i.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Mr(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Mr(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Mr(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}Wa.className="RMSProp",hr(Wa);var Va=n(23);class Ya{static sgd(t){return new $a(t)}static momentum(t,e,n=!1){return new Ua(t,e,n)}static rmsprop(t,e=.9,n=0,i=null,r=!1){return new Wa(t,e,n,i,r)}static adam(t=.001,e=.9,n=.999,i=null){return new Ba(t,e,n,i)}static adadelta(t=.001,e=.95,n=null){return new La(t,e,n)}static adamax(t=.002,e=.9,n=.999,i=null,r=0){return new za(t,e,n,i,r)}static adagrad(t,e=.1){return new ja(t,e)}}const Ga={sgd:Ya.sgd,momentum:Ya.momentum,adadelta:Ya.adadelta,adagrad:Ya.adagrad,rmsprop:Ya.rmsprop,adamax:Ya.adamax,adam:Ya.adam};var Xa=n(40);function Ha(t,e,n,i=!0){let r=[];if(i)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const n=e.length;for(let i=0;i<n;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(n+1))}return r}function qa(t,e,n=!0){const i=[];if(n){i.push(e);for(let n=e+1;n<t;++n)n<=2*e?(i.push(n),i.push(n-(e+1))):i.push(n)}else{const n=[],r=[];for(let i=1;i<t;++i)i>=2*e+1||i%2==1?r.push(i):n.push(i);i.push(...n),i.push(0),i.push(...r)}return i}function Ka(t,e,n,i=!0){const r=[];r.push(i?t[0]/n:t[0]*n);for(let s=1;s<t.length;++s)r.push(s<=e.length?i?e[s-1]*t[s]:t[s]/e[s-1]:t[s]);return r}function Ja(t,e){const n=[0];for(let i=0;i<e;++i)n.push(t[i][0]);return n}function Qa(t,e,n){const i=t.slice(0,1);for(let r=0;r<n;++r)i.push(t[r+1]-e[r][0]-e[r][1]);return i}const Za=.3275911,tu=.254829592,eu=-.284496736,nu=1.421413741,iu=-1.453152027,ru=1.061405429;function su(...t){Object(ei.c)().getBool("IS_TEST")||console.warn(...t)}function ou(...t){Object(ei.c)().getBool("IS_TEST")||console.log(...t)}function au(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let i=0;i<n.length;i+=2)n[i]=t[i/2],n[i+1]=e[i/2];return n}function uu(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let i=0;i<t.length;i+=2)e[i/2]=t[i],n[i/2]=t[i+1];return{real:e,imag:n}}function lu(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function cu(t){const e=Math.floor(t.length/4),n=new Float32Array(e),i=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],i[Math.floor(r/4)]=t[r+1];return{real:n,imag:i}}function hu(t,e){return{real:t[2*e],imag:t[2*e+1]}}function du(t,e,n,i){t[2*i]=e,t[2*i+1]=n}function fu(t,e){const n=new Float32Array(t/2),i=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const s=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(s),i[r]=Math.sin(s)}return{real:n,imag:i}}function pu(t,e,n){const i=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(i),imag:Math.sin(i)}}function mu(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();const e=Object(F.n)(t.shape),i=t.toFloat(),r=n.complex(i,e);return e.dispose(),i.dispose(),r}if(!Object(N.hasEncodingLoss)(t.dtype,e))return w.a.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){const i=n.real(t),r=i.cast(e);return i.dispose(),r}if("int32"===e)return n.int(t);if("bool"===e){const e=Object(F.e)(0,t.dtype),i=n.notEqual(t,e);return e.dispose(),i}throw new Error(`Error in Cast: failed to cast ${t.dtype} to ${e}`)}function gu(t,e){return w.a.makeTensorFromDataId(t.dataId,e,t.dtype)}function yu(t,e,n){const i=(e-t)/(n-1),r=Object(N.makeZerosTypedArray)(n,"float32");r[0]=t;for(let s=1;s<r.length;s++)r[s]=r[s-1]+i;return Object(F.g)(r,"float32")}var vu=n(36);function bu(t,e,n){const i=new Array(t.rank).fill(0),r=t.shape.slice();return e.map(e=>{const s=[...r];s[n]=e;const o=t.slice(i,s);return i[n]+=e,o})}function xu(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const i=j(n,t.dtype);for(let r=0;r<i.values.length;++r){const e=i.indexToLoc(r),n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=e[i]%t.shape[i];const s=t.locToIndex(n);i.values[r]=t.values[s]}return i.toTensor()}function wu(t,e,n,i,r){const s=e[e.length-1],[o,a]=[t.length/s,s],u=Object(N.getTypedArrayFromDType)(n,o*i),l=Object(N.getTypedArrayFromDType)("int32",o*i);for(let h=0;h<o;h++){const e=h*a,n=t.subarray(e,e+a),r=[];for(let t=0;t<n.length;t++)r.push({value:n[t],index:t});r.sort((t,e)=>e.value-t.value);const s=h*i,o=u.subarray(s,s+i),c=l.subarray(s,s+i);for(let t=0;t<i;t++)o[t]=r[t].value,c[t]=r[t].index}const c=e.slice();return c[c.length-1]=i,[Object(F.f)(u,c,n),Object(F.f)(l,c,"int32")]}class Tu{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class Su{time(t){return Eu("time")}read(t){return Eu("read")}readSync(t){return Eu("readSync")}numDataIds(){return Eu("numDataIds")}disposeData(t){return Eu("disposeData")}write(t,e,n){return Eu("write")}move(t,e,n,i){return Eu("move")}memory(){return Eu("memory")}floatPrecision(){return Eu("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}batchMatMul(t,e,n,i){return Eu("batchMatMul")}fusedBatchMatMul({}){return Eu("fusedBatchMatMul")}slice(t,e,n){return Eu("slice")}stridedSlice(t,e,n,i){return Eu("stridedSlice")}unstack(t,e){return Eu("unstack")}reverse(t,e){return Eu("reverse")}concat(t,e){return Eu("concat")}neg(t){return Eu("neg")}add(t,e){return Eu("add")}addN(t){return Eu("addN")}subtract(t,e){return Eu("subtract")}multiply(t,e){return Eu("multiply")}realDivide(t,e){return Eu("realDivide")}floorDiv(t,e){return Eu("floorDiv")}sum(t,e){return Eu("sum")}prod(t,e){return Eu("prod")}unsortedSegmentSum(t,e,n){return Eu("unsortedSegmentSum")}argMin(t,e){return Eu("argMin")}argMax(t,e){return Eu("argMax")}equal(t,e){return Eu("equal")}notEqual(t,e){return Eu("notEqual")}less(t,e){return Eu("less")}lessEqual(t,e){return Eu("lessEqual")}greater(t,e){return Eu("greater")}greaterEqual(t,e){return Eu("greaterEqual")}logicalNot(t){return Eu("logicalNot")}logicalAnd(t,e){return Eu("logicalAnd")}logicalOr(t,e){return Eu("logicalOr")}where(t){return Eu("where")}select(t,e,n){return Eu("select")}topk(t,e,n){return Eu("topk")}min(t,e){return Eu("min")}minimum(t,e){return Eu("minimum")}mod(t,e){return Eu("mod")}max(t,e){return Eu("max")}maximum(t,e){return Eu("maximum")}all(t,e){return Eu("all")}any(t,e){return Eu("any")}squaredDifference(t,e){return Eu("squaredDifference")}ceil(t){return Eu("ceil")}floor(t){return Eu("floor")}round(t){return Eu("round")}sign(t){return Eu("sign")}isNaN(t){return Eu("isNaN")}isInf(t){return Eu("isInf")}isFinite(t){return Eu("isFinite")}pow(t,e){return Eu("pow")}exp(t){return Eu("exp")}expm1(t){return Eu("expm1")}softmax(t,e){return Eu("softmax")}log(t){return Eu("log")}log1p(t){return Eu("log1p")}sqrt(t){return Eu("sqrt")}rsqrt(t){return Eu("rsqrt")}square(t){return Eu("square")}reciprocal(t){return Eu("reciprocal")}relu(t){return Eu("relu")}relu6(t){return Eu("relu6")}prelu(t,e){return Eu("prelu")}elu(t){return Eu("elu")}eluDer(t,e){return Eu("eluDer")}selu(t){return Eu("selu")}int(t){return Eu("int")}clip(t,e,n){return Eu("clip")}abs(t){return Eu("abs")}complexAbs(t){return Eu("complexAbs")}sigmoid(t){return Eu("sigmoid")}softplus(t){return Eu("softplus")}sin(t){return Eu("sin")}cos(t){return Eu("cos")}tan(t){return Eu("tan")}asin(t){return Eu("asin")}acos(t){return Eu("acos")}atan(t){return Eu("atan")}atan2(t,e){return Eu("atan2")}sinh(t){return Eu("sinh")}cosh(t){return Eu("cosh")}tanh(t){return Eu("tanh")}asinh(t){return Eu("asinh")}acosh(t){return Eu("acosh")}atanh(t){return Eu("atanh")}erf(t){return Eu("erf")}step(t,e){return Eu("step")}fusedConv2d({}){return Eu("fusedConv2d")}conv2d(t,e,n){return Eu("conv2d")}conv2dDerInput(t,e,n){return Eu("conv2dDerInput")}conv2dDerFilter(t,e,n){return Eu("conv2dDerFilter")}fusedDepthwiseConv2D({}){return Eu("fusedDepthwiseConv2D")}depthwiseConv2D(t,e,n){return Eu("depthwiseConv2D")}depthwiseConv2DDerInput(t,e,n){return Eu("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,e,n){return Eu("depthwiseConv2DDerFilter")}conv3d(t,e,n){return Eu("conv3d")}conv3dDerInput(t,e,n){return Eu("conv3dDerInput")}conv3dDerFilter(t,e,n){return Eu("conv3dDerFilter")}maxPool(t,e){return Eu("maxPool")}maxPoolBackprop(t,e,n,i){return Eu("maxPoolBackprop")}avgPool(t,e){return Eu("avgPool")}avgPoolBackprop(t,e,n){return Eu("avgPoolBackprop")}avgPool3d(t,e){return Eu("avgPool3d")}avgPool3dBackprop(t,e,n){return Eu("avgPool3dBackprop")}maxPool3d(t,e){return Eu("maxPool3d")}maxPool3dBackprop(t,e,n,i){return Eu("maxPool3dBackprop")}reshape(t,e){return Eu("reshape")}cast(t,e){return Eu("cast")}tile(t,e){return Eu("tile")}pad(t,e,n){return Eu("pad")}transpose(t,e){return Eu("transpose")}gather(t,e,n){return Eu("gather")}gatherND(t,e){return Eu("gatherND")}scatterND(t,e,n){return Eu("scatterND")}batchToSpaceND(t,e,n){return Eu("batchToSpaceND")}spaceToBatchND(t,e,n){return Eu("spaceToBatchND")}resizeBilinear(t,e,n,i){return Eu("resizeBilinear")}resizeBilinearBackprop(t,e,n){return Eu("resizeBilinearBackprop")}resizeNearestNeighbor(t,e,n,i){return Eu("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,e,n){return Eu("resizeNearestNeighborBackprop")}batchNorm(t,e,n,i,r,s){return Eu("batchNorm")}localResponseNormalization4D(t,e,n,i,r){return Eu("localResponseNormalization4D")}LRNGrad(t,e,n,i,r,s,o){return Eu("LRNGrad")}multinomial(t,e,n,i){return Eu("multinomial")}oneHot(t,e,n,i){return Eu("oneHot")}cumsum(t,e,n,i){return Eu("cumsum")}nonMaxSuppression(t,e,n,i,r){return Eu("nonMaxSuppression")}fft(t){return Eu("fft")}ifft(t){return Eu("ifft")}complex(t,e){return Eu("complex")}real(t){return Eu("real")}imag(t){return Eu("imag")}cropAndResize(t,e,n,i,r,s){return Eu("cropAndResize")}depthToSpace(t,e,n){return Eu("depthToSpace")}split(t,e,n){return Eu("split")}sparseToDense(t,e,n,i){return Eu("sparseToDense")}diag(t){return Eu("diag")}fill(t,e,n){return Eu("fill")}onesLike(t){return Eu("onesLike")}zerosLike(t){return Eu("zerosLike")}linspace(t,e,n){return Eu("linspace")}dispose(){return Eu("dispose")}}function Eu(t){throw new Error(`'${t}' not yet implemented or not found in the registry. Did you forget to import the kernel?`)}M.a.prototype.add=function(t){return this.throwIfDisposed(),I(this,t)},M.a.prototype.atan2=function(t){return this.throwIfDisposed(),Yr(this,t)},M.a.prototype.avgPool=function(t,e,n,i){return this.throwIfDisposed(),Gr(this,t,e,n,i)},M.a.prototype.batchNorm=function(t,e,n,i,r){return this.throwIfDisposed(),qr(this,t,e,n,i,r)},M.a.prototype.broadcastTo=function(t){return this.throwIfDisposed(),ts(this,t)},M.a.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),An(this,t,e)},M.a.prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof M.a&&(t=[t]),L([this,...t],e)},M.a.prototype.conv1d=function(t,e,n,i,r,s){return this.throwIfDisposed(),os(this,t,e,n,i,r,s)},M.a.prototype.conv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Re(this,t,e,n,i,r,s)},M.a.prototype.conv2dTranspose=function(t,e,n,i,r){return this.throwIfDisposed(),as(this,t,e,n,i,r)},M.a.prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Fe(this,t,e,n)},M.a.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),cs(this,t,e)},M.a.prototype.depthwiseConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),hs(this,t,e,n,i,r,s)},M.a.prototype.depthwiseConv2D=function(t,e,n,i,r,s){return Cr("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),hs(this,t,e,n,i,r,s)},M.a.prototype.div=function(t){return this.throwIfDisposed(),H(this,t)},M.a.prototype.divNoNan=function(t){return this.throwIfDisposed(),fs(this,t)},M.a.prototype.dot=function(t){return this.throwIfDisposed(),ps(this,t)},M.a.prototype.elu=function(){return this.throwIfDisposed(),ms(this)},M.a.prototype.equal=function(t){return this.throwIfDisposed(),gs(this,t)},M.a.prototype.floorDiv=function(t){return this.throwIfDisposed(),X(this,t)},M.a.prototype.greater=function(t){return this.throwIfDisposed(),on(this,t)},M.a.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Qe(this,t)},M.a.prototype.leakyRelu=function(t){return this.throwIfDisposed(),ws(this,t)},M.a.prototype.less=function(t){return this.throwIfDisposed(),Ze(this,t)},M.a.prototype.lessEqual=function(t){return this.throwIfDisposed(),an(this,t)},M.a.prototype.localResponseNormalization=function(t,e,n,i){return this.throwIfDisposed(),Ts(this,t,e,n,i)},M.a.prototype.matMul=function(t,e,n){return this.throwIfDisposed(),xe(this,t,e,n)},M.a.prototype.max=function(t,e){return this.throwIfDisposed(),Ss(this,t,e)},M.a.prototype.maxPool=function(t,e,n,i){return this.throwIfDisposed(),Es(this,t,e,n,i)},M.a.prototype.maximum=function(t){return this.throwIfDisposed(),xs(this,t)},M.a.prototype.minimum=function(t){return this.throwIfDisposed(),_s(this,t)},M.a.prototype.mod=function(t){return this.throwIfDisposed(),As(this,t)},M.a.prototype.mul=function(t){return this.throwIfDisposed(),q(this,t)},M.a.prototype.notEqual=function(t){return this.throwIfDisposed(),Rs(this,t)},M.a.prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),tr(this,t,e,n)},M.a.prototype.pad=function(t,e){return this.throwIfDisposed(),Dn(this,t,e)},M.a.prototype.pool=function(t,e,n,i,r){return this.throwIfDisposed(),Fs(this,t,e,n,i,r)},M.a.prototype.pow=function(t){return this.throwIfDisposed(),xn(this,t)},M.a.prototype.prelu=function(t){return this.throwIfDisposed(),Ls(this,t)},M.a.prototype.relu=function(){return this.throwIfDisposed(),Xs(this)},M.a.prototype.relu6=function(){return this.throwIfDisposed(),Hs(this)},M.a.prototype.selu=function(){return this.throwIfDisposed(),qs(this)},M.a.prototype.separableConv2d=function(t,e,n,i,r,s){return this.throwIfDisposed(),Ks(this,t,e,n,i,r,s)},M.a.prototype.split=function(t,e){return this.throwIfDisposed(),Oe(this,t,e)},M.a.prototype.squaredDifference=function(t){return this.throwIfDisposed(),Js(this,t)},M.a.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Te(this,t,e)},M.a.prototype.sub=function(t){return this.throwIfDisposed(),Ve(this,t)},M.a.prototype.tile=function(t){return this.throwIfDisposed(),Ye(this,t)},M.a.prototype.transpose=function(t){return this.throwIfDisposed(),Pe(this,t)},Object(M.e)(v)},function(t,e,n){"use strict";n.r(e),n.d(e,"shuffle",function(){return r}),n.d(e,"clamp",function(){return s}),n.d(e,"nearestLargerEven",function(){return o}),n.d(e,"sum",function(){return a}),n.d(e,"randUniform",function(){return u}),n.d(e,"distSquared",function(){return l}),n.d(e,"assert",function(){return c}),n.d(e,"assertShapesMatch",function(){return h}),n.d(e,"assertNonNull",function(){return d}),n.d(e,"flatten",function(){return f}),n.d(e,"sizeFromShape",function(){return p}),n.d(e,"isScalarShape",function(){return m}),n.d(e,"arraysEqual",function(){return g}),n.d(e,"isInt",function(){return y}),n.d(e,"tanh",function(){return v}),n.d(e,"sizeToSquarishShape",function(){return b}),n.d(e,"createShuffledIndices",function(){return x}),n.d(e,"rightPad",function(){return w}),n.d(e,"repeatedTry",function(){return T}),n.d(e,"inferFromImplicitShape",function(){return S}),n.d(e,"parseAxisParam",function(){return E}),n.d(e,"squeezeShape",function(){return O}),n.d(e,"getTypedArrayFromDType",function(){return C}),n.d(e,"getArrayFromDType",function(){return _}),n.d(e,"checkConversionForErrors",function(){return A}),n.d(e,"isValidDtype",function(){return k}),n.d(e,"hasEncodingLoss",function(){return R}),n.d(e,"isTypedArray",function(){return I}),n.d(e,"bytesPerElement",function(){return M}),n.d(e,"bytesFromStringArray",function(){return N}),n.d(e,"isString",function(){return D}),n.d(e,"isBoolean",function(){return P}),n.d(e,"isNumber",function(){return F}),n.d(e,"inferDtype",function(){return L}),n.d(e,"isFunction",function(){return j}),n.d(e,"nearestDivisor",function(){return B}),n.d(e,"computeStrides",function(){return z}),n.d(e,"toTypedArray",function(){return $}),n.d(e,"toNestedArray",function(){return W}),n.d(e,"makeOnesTypedArray",function(){return V}),n.d(e,"makeZerosTypedArray",function(){return Y}),n.d(e,"now",function(){return G}),n.d(e,"assertNonNegativeIntegerDimensions",function(){return X}),n.d(e,"fetch",function(){return H}),n.d(e,"encodeString",function(){return q}),n.d(e,"decodeString",function(){return K}),n.d(e,"locToIndex",function(){return J}),n.d(e,"indexToLoc",function(){return Q});var i=n(10);function r(t){let e=t.length,n=0,i=0;for(;e>0;)i=Math.random()*e|0,e--,n=t[e],t[e]=t[i],t[i]=n}function s(t,e,n){return Math.max(t,Math.min(e,n))}function o(t){return t%2==0?t:t+1}function a(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function u(t,e){const n=Math.random();return e*n+(1-n)*t}function l(t,e){let n=0;for(let i=0;i<t.length;i++){const r=Number(t[i])-Number(e[i]);n+=r*r}return n}function c(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function h(t,e,n=""){c(g(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function d(t){c(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function f(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||I(t)&&!n)for(let i=0;i<t.length;++i)f(t[i],e,n);else e.push(t);return e}function p(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function m(t){return 0===t.length}function g(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function y(t){return t%1==0}function v(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function b(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function x(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function w(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function T(t,e=(t=>0),n){return new Promise((i,r)=>{let s=0;const o=()=>{if(t())return void i();s++;const a=e(s);null!=n&&s>=n?r():setTimeout(o,a)};o()})}function S(t,e){let n=1,i=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(-1===t[s]){if(-1!==i)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${i} and dim ${s}`);i=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(-1===i){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[i]=e/n,r}function E(t,e){const n=e.length;return c((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis `+t),c(t.every(t=>y(t)),()=>"All values in axis param must be integers but got axis "+t),t.map(t=>t<0?n+t:t)}function O(t,e){const n=[],i=[],r=null!=e&&Array.isArray(e)&&0===e.length,s=null==e||r?null:E(e,t).sort();let o=0;for(let a=0;a<t.length;++a){if(null!=s){if(s[o]===a&&1!==t[a])throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(null==s[o]||s[o]>a)&&1===t[a]&&(n.push(t[a]),i.push(a)),s[o]<=a&&o++}1!==t[a]&&(n.push(t[a]),i.push(a))}return{newShape:n,keptDims:i}}function C(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function _(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function A(t,e){for(let n=0;n<t.length;n++){const i=t[n];if(isNaN(i)||!isFinite(i))throw Error(`A tensor of type ${e} being uploaded contains ${i}.`)}}function k(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function R(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function I(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function M(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function N(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function D(t){return"string"==typeof t||t instanceof String}function P(t){return"boolean"==typeof t}function F(t){return"number"==typeof t}function L(t){return Array.isArray(t)?L(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":F(t)?"float32":D(t)?"string":P(t)?"bool":"float32"}function j(t){return!!(t&&t.constructor&&t.call&&t.apply)}function B(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function z(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let i=e-3;i>=0;--i)n[i]=n[i+1]*t[i+1];return n}function $(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=f(t)),n&&A(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function U(t,e,n){const i=new Array;if(1===e.length){const r=e[0];for(let e=0;e<r;e++)i[e]=n[t+e]}else{const r=e[0],s=e.slice(1),o=s.reduce((t,e)=>t*e);for(let e=0;e<r;e++)i[e]=U(t+e*o,s,n)}return i}function W(t,e){if(0===t.length)return e[0];const n=t.reduce((t,e)=>t*e);if(0===n)return[];if(n!==e.length)throw new Error(`[${t}] does not match the input size.`);return U(0,t,e)}function V(t,e){const n=Y(t,e);for(let i=0;i<n.length;i++)n[i]=1;return n}function Y(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function G(){return Object(i.c)().platform.now()}function X(t){t.forEach(e=>{c(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function H(t,e){return Object(i.c)().platform.fetch(t,e)}function q(t,e="utf-8"){return e=e||"utf-8",Object(i.c)().platform.encode(t,e)}function K(t,e="utf-8"){return e=e||"utf-8",Object(i.c)().platform.decode(t,e)}function J(t,e,n){if(0===e)return 0;if(1===e)return t[0];let i=t[t.length-1];for(let r=0;r<t.length-1;++r)i+=n[r]*t[r];return i}function Q(t,e,n){if(0===e)return[];if(1===e)return[t];const i=new Array(e);for(let r=0;r<i.length-1;++r)i[r]=Math.floor(t/n[r]),t-=i[r]*n[r];return i[i.length-1]=t,i}},function(t,e,n){"use strict";function i(t,e,n,i){const s=e.inputParams[t];if(s&&void 0!==s.inputIndexStart){const t=s.inputIndexStart,o=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?t+1:s.inputIndexEnd;if("tensor"===s.type)return r(e.inputNames[s.inputIndexStart],n,i);if("tensors"===s.type)return e.inputNames.slice(t,o).map(t=>r(t,n,i));const a=Array.prototype.slice.call(r(e.inputNames.slice(t)[0],n,i).dataSync());return"number"===s.type?a[0]:a}const o=e.attrParams[t];return o&&o.value}function r(t,e,n){const[i,r]=u(t),s=n.currentContextIds.find(t=>!!e[a(i,t)]);return void 0!==s?e[a(i,s)][r]:void 0}function s(t,e,n){return e[a(t,n.currentContextId)]}function o(t,e){const[n,i]=u(t);return[a(n,e&&e.currentContextId),i]}function a(t,e){return e?`${t}-${e}`:t}function u(t){const e=t.split(":");return 1===e.length?[t,0]:[e[0],Number(e[e.length-1])]}function l(t,e){const n=[];for(let i=0;i<t.length;i+=e)n.push(t.slice(i,i+e));return n}n.d(e,"b",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return s}),n.d(e,"a",function(){return o}),n.d(e,"e",function(){return u}),n.d(e,"f",function(){return l})},function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"a",function(){return c}),n.d(e,"b",function(){return h});var i=n(5),r=n(10),s=n(7),o=n(1);function a(t,e){let n=t;if(Object(o.isTypedArray)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const i=[];for(;Array.isArray(n)||Object(o.isTypedArray)(n)&&"string"!==e;)i.push(n.length),n=n[0];return Array.isArray(t)&&Object(r.c)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&u(t,i,[]),i}function u(t,e,n){if(n=n||[],!Array.isArray(t)&&!Object(o.isTypedArray)(t))return void Object(o.assert)(0===e.length,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);Object(o.assert)(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),Object(o.assert)(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const i=e.slice(1);for(let r=0;r<t.length;++r)u(t[r],i,n.concat(r))}function l(t,e,n,i){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error(`Argument '${n}' passed to '${i}' must be ${t} tensor, but got ${e} tensor`)}function c(t,e,n,u="numeric"){if(t instanceof s.a)return l(u,t.dtype,e,n),t;let c=Object(o.inferDtype)(t);if("string"!==c&&["bool","int32","float32"].indexOf(u)>=0&&(c=u),l(u,c,e,n),null==t||!Object(o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${null==t?"null":t.constructor.name}'`);const h=a(t,c);Object(o.isTypedArray)(t)||Array.isArray(t)||(t=[t]);const d="string"!==c?Object(o.toTypedArray)(t,c,Object(r.c)().getBool("DEBUG")):Object(o.flatten)(t,[],!0);return i.a.makeTensor(d,h,c)}function h(t,e,n,i="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((t,i)=>c(t,`${e}[${i}]`,n),i)}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(5);function r(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));const s=(...t)=>{i.a.startScope(n);try{const e=r(...t);return e instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i.a.endScope(e),e}catch(e){throw i.a.endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var i=n(10),r=n(33),s=n(17),o=n(1);class a{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new u)}profileKernel(t,e,n){let i;const r=this.backendTimer.time(()=>{i=n()});return i.forEach(n=>{n.data().then(i=>{!function(t,e,n){if("float32"!==e)return!1;for(let i=0;i<t.length;i++){const e=t[i];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}}(i,n.dtype,t),r.then(r=>{let s="";null!=r.getExtraProfileInfo&&(s=r.getExtraProfileInfo()),this.logger.logKernelProfile(t,n,i,r.kernelMs,e,s)})})}),i}}class u{logKernelProfile(t,e,n,i,r,s){const a="number"==typeof i?o.rightPad(i+"ms",9):i.error,u=o.rightPad(t,25),l=e.rank,c=e.size,h=o.rightPad(e.shape.toString(),14);let d="";for(const o in r){const t=r[o].shape||e.shape,n=t.length;d+=`${o}: ${n}D ${n>0?t:""} `}console.log(`%c${u}\t%c${a}\t%c${l}D ${h}\t%c${c}\t%c${d}\t%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var l=n(7),c=n(11);class h{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class d{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new h}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void(await this.setBackend(n))}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new a(this.backendInstance),!0}setupRegisteredKernels(){Object(s.c)(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Object(s.c)(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(Promise.resolve(n)===n){const e=++this.pendingBackendInitId,i=n.then(n=>!(e<this.pendingBackendInitId||(this.registry[t]=n,this.pendingBackendInit=null,0))).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=n,{success:!0,asyncInit:!1}}catch(n){return console.warn(`Initialization of backend ${t} failed`),console.warn(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:i,asyncInit:r}=this.initializeBackend(n);if(r||i)return{name:n,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),i=n.backend,r=this.readSync(e);i.disposeData(e),n.backend=t,t.move(e,r,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(()=>this.startScope(i),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(i){throw e(),i}}nextTensorId(){return d.nextTensorId++}nextVariableId(){return d.nextVariableId++}clone(t){const e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype);return this.addTapeNode(this.state.activeScope.name,{x:t},[e],t=>({x:()=>t.toFloat()}),[],{}),e}runKernel(t,e,n,i,r){return this.runKernelFunc(null,e,null,t,n,i,r)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const i=this.backend.numDataIds();let r=0;n.forEach(t=>{r+="complex64"===t.dtype?3:1});const s=i-e-r-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${t}'`)}runKernelFunc(t,e,n,i,r,o,a){let u,l=[];const c=this.isTapeOn();null==i&&(i=null!=this.state.activeScope?this.state.activeScope.name:"");const h=this.state.numBytes,d=this.state.numTensors;let f;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);const p=Object(s.b)(i,this.backendName);let m;if(null!=p)f=()=>{const t=this.backend.numDataIds();m=p.kernelFunc({inputs:e,attrs:r,backend:this.backend});const n=Array.isArray(m)?m:[m];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,t,n);const s=n.map(({dataId:t,shape:e,dtype:n})=>this.makeTensorFromDataId(t,e,n));if(c){let t=this.getTensorsForGradient(i,e,s);if(null==t){null==a&&(a=[]);const e=s.filter((t,e)=>a[e]);t=(o||[]).slice().concat(e)}l=this.saveTensorsForBackwardMode(t)}return s};else{const e=t=>{c&&(l=t.map(t=>this.keep(this.clone(t))))};f=()=>{const n=this.backend.numDataIds();m=this.tidy(()=>t(this.backend,e));const r=Array.isArray(m)?m:[m];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,n,r),r}}return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{u=this.ENV.getBool("DEBUG")?this.profiler.profileKernel(i,e,()=>f()):f()}),c&&this.addTapeNode(i,e,u,n,l,r),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map(t=>e[t].shape),outputShapes:u.map(t=>t.shape)}),Array.isArray(m)?u:u[0]}saveTensorsForBackwardMode(t){return t.map(t=>this.keep(this.clone(t)))}getTensorsForGradient(t,e,n){const i=Object(s.a)(t);if(null!=i){const t=i.inputsToSave||[],r=i.outputsToSave||[];let s;i.saveAllInputs?(o.assert(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(e).map(t=>e[t])):s=t.map(t=>e[t]);const a=n.filter((t,e)=>r[e]);return s.concat(a)}return null}makeTensor(t,e,n,i){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");i=i||this.backend;let r=t;"string"===(n=n||"float32")&&o.isString(t[0])&&(r=t.map(t=>o.encodeString(t)));const s=i.write(r,e,n),a=new l.a(e,n,s,this.nextTensorId());if(this.incRef(a,i),"string"===n){const t=this.state.tensorInfo.get(s),e=Object(o.bytesFromStringArray)(r);this.state.numBytes+=e-t.bytes,t.bytes=e}return a}makeTensorFromDataId(t,e,n,i){const r=new l.a(e,n=n||"float32",t,this.nextTensorId());return this.incRef(r,i),r}makeVariable(t,e=!0,n,i){n=n||this.nextVariableId().toString(),null!=i&&i!==t.dtype&&(t=t.asType(i));const r=new l.c(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[r.name])throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}incRef(t,e){const n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*o.bytesPerElement(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n,refCount:0}),this.state.numBytes+=n}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof l.c||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;const e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}disposeVariables(){for(const t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;return this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,i,r,a){const u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:r},l=Object(s.a)(t);null!=l&&(i=l.gradFunc),null!=i&&(u.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],i=o.makeZerosTypedArray(t.size,t.dtype);return this.makeTensor(i,t.shape,t.dtype)}return t}),i(t.length>1?t:t[0],r,a))),this.state.activeTape.push(u)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Object(c.getTensorsInContainer)(t),n=new Set(e.map(t=>t.id));for(let r=0;r<this.state.activeScope.track.length;r++){const t=this.state.activeScope.track[r];t.kept||n.has(t.id)||t.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==i.id||this.track(t)})}gradients(t,e,n,i=!1){if(o.assert(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));o.assert(r instanceof l.a,()=>"The result y returned by f() must be a tensor.");const s=function(t,e,n){const i={},r={};for(let u=0;u<e.length;u++)i[e[u].id]=!0;for(let u=0;u<t.length;u++){const n=t[u],s=n.inputs;for(const t in s){const o=s[t];let a=!1;for(let t=0;t<e.length;t++)if(i[o.id]){n.outputs.forEach(t=>i[t.id]=!0),a=!0,r[n.id]=!0;break}if(a)break}}const s={};s[n.id]=!0;const o={};for(let u=t.length-1;u>=0;u--){const e=t[u],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(s[e.outputs[t].id]){for(const t in n)s[n[t].id]=!0,o[e.id]=!0;break}}const a=[];for(let u=0;u<t.length;u++){const e=t[u];if(r[e.id]&&o[e.id]){const t={};for(const r in e.inputs){const n=e.inputs[r];i[n.id]&&(t[r]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,a.push(n)}}return a}(this.state.activeTape,e,r);if(!i&&0===s.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[r.id]=null==n?function(t){const e=Object(o.makeOnesTypedArray)(Object(o.sizeFromShape)(t),"float32");return f.makeTensor(e,t,"float32")}(r.shape):n,function(t,e,n){for(let i=e.length-1;i>=0;i--){const r=e[i],s=[];if(r.outputs.forEach(e=>{const n=t[e.id];s.push(null!=n?n:null)}),null==r.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const a=r.gradient(s);for(const e in r.inputs){if(!(e in a))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(a)}.`);const i=n(()=>a[e]());if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${i.dtype}'`);const s=r.inputs[e];if(!o.arraysEqual(i.shape,s.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${e}' has shape '${i.shape}', which does not match the shape of the input '${s.shape}'`);if(null==t[s.id])t[s.id]=i;else{const e=t[s.id];t[s.id]=e.add(i),e.dispose()}}}}(t,s,t=>this.tidy(t));const i=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:r,grads:i}})}customGrad(t){return o.assert(o.isFunction(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;o.assert(e.every(t=>t instanceof l.a),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const i={};return e.forEach((t,e)=>{i[e]=t}),this.runKernelFunc((i,r)=>(n=t(...e,r),o.assert(n.value instanceof l.a,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),o.assert(o.isFunction(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i,(t,i)=>{const r=n.gradFunc(t,i),s=Array.isArray(r)?r:[r];o.assert(s.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),o.assert(s.every(t=>t instanceof l.a),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const a={};return s.forEach((t,e)=>{a[e]=()=>t}),a})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=Object(o.now)(),n=await this.backend.time(t);return n.wallMs=Object(o.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new h;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}d.nextTensorId=0,d.nextVariableId=0;const f=function(){const t=Object(r.b)();if(null==t._tfengine){const e=new i.b(t);t._tfengine=new d(e)}return Object(i.d)(t._tfengine.ENV),Object(l.f)(()=>t._tfengine),t._tfengine}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return s}),n.d(e,"d",function(){return o}),n.d(e,"g",function(){return a}),n.d(e,"e",function(){return u}),n.d(e,"f",function(){return l}),n.d(e,"h",function(){return c}),n.d(e,"i",function(){return h}),n.d(e,"j",function(){return d}),n.d(e,"k",function(){return f}),n.d(e,"l",function(){return p}),n.d(e,"m",function(){return m}),n.d(e,"n",function(){return g}),n.d(e,"o",function(){return y}),n.d(e,"p",function(){return v}),n.d(e,"q",function(){return b}),n.d(e,"r",function(){return x}),n.d(e,"s",function(){return w}),n.d(e,"t",function(){return T}),n.d(e,"u",function(){return S}),n.d(e,"v",function(){return E}),n.d(e,"w",function(){return O}),n.d(e,"x",function(){return C}),n.d(e,"y",function(){return _}),n.d(e,"z",function(){return A}),n.d(e,"A",function(){return k}),n.d(e,"B",function(){return R}),n.d(e,"D",function(){return I}),n.d(e,"C",function(){return M}),n.d(e,"F",function(){return N}),n.d(e,"G",function(){return D}),n.d(e,"H",function(){return P}),n.d(e,"I",function(){return F}),n.d(e,"J",function(){return L}),n.d(e,"K",function(){return j}),n.d(e,"N",function(){return B}),n.d(e,"O",function(){return z}),n.d(e,"L",function(){return $}),n.d(e,"M",function(){return U}),n.d(e,"P",function(){return W}),n.d(e,"V",function(){return V}),n.d(e,"Q",function(){return Y}),n.d(e,"T",function(){return G}),n.d(e,"R",function(){return X}),n.d(e,"S",function(){return H}),n.d(e,"U",function(){return q}),n.d(e,"W",function(){return K}),n.d(e,"X",function(){return J}),n.d(e,"Y",function(){return Q}),n.d(e,"bb",function(){return Z}),n.d(e,"Z",function(){return tt}),n.d(e,"ab",function(){return et}),n.d(e,"cb",function(){return nt}),n.d(e,"db",function(){return it}),n.d(e,"eb",function(){return rt}),n.d(e,"fb",function(){return st}),n.d(e,"gb",function(){return ot}),n.d(e,"hb",function(){return at}),n.d(e,"ib",function(){return ut}),n.d(e,"jb",function(){return lt}),n.d(e,"kb",function(){return ct}),n.d(e,"lb",function(){return ht}),n.d(e,"mb",function(){return dt}),n.d(e,"nb",function(){return ft}),n.d(e,"pb",function(){return pt}),n.d(e,"ob",function(){return mt}),n.d(e,"qb",function(){return gt}),n.d(e,"rb",function(){return yt}),n.d(e,"sb",function(){return vt}),n.d(e,"E",function(){return bt});const i="Add",r="AddN",s="Atan2",o="AvgPool",a="AvgPoolBackprop",u="AvgPool3D",l="AvgPool3DBackprop",c="BatchMatMul",h="BatchToSpaceND",d="BroadcastTo",f="Complex",p="Concat",m="Conv2D",g="Conv2DBackpropFilter",y="Conv2DBackpropInput",v="Conv3D",b="Conv3DBackpropFilterV2",x="Conv3DBackpropInputV2",w="Cumsum",T="DepthToSpace",S="DepthwiseConv2dNative",E="DepthwiseConv2dNativeBackpropFilter",O="DepthwiseConv2dNativeBackpropInput",C="Diag",_="Div",A="Elu",k="EluGrad",R="Equal",I="FloorDiv",M="Fill",N="FusedBatchNorm",D="GatherNd",P="Greater",F="GreaterEqual",L="Identity",j="Imag",B="Less",z="LessEqual",$="LRN",U="LRNBackprop",W="Max",V="Maximum",Y="MaxPool",G="MaxPoolBackprop",X="MaxPool3D",H="MaxPool3DBackprop",q="MaxPoolWithArgmax",K="Minimum",J="Mod",Q="Multiply",Z="NotEqual",tt="NonMaxSuppressionV3",et="NonMaxSuppressionV5",nt="OneHot",it="PadV2",rt="Pool",st="Pow",ot="Prelu",at="Real",ut="Relu",lt="Relu6",ct="SelectV2",ht="Selu",dt="SpaceToBatchND",ft="SplitV",pt="SquaredDifference",mt="Square",gt="Sub",yt="Tile",vt="Transpose",bt="FromPixels"},function(t,e,n){"use strict";n.d(e,"b",function(){return l}),n.d(e,"f",function(){return f}),n.d(e,"e",function(){return p}),n.d(e,"d",function(){return m}),n.d(e,"a",function(){return g}),n.d(e,"c",function(){return y});var i=n(1);function r(t,e,n,r){const o=Object(i.computeStrides)(e),l=function(t,e,n,r){const o=Object(i.sizeFromShape)(e),a=r[r.length-1],l=new Array(a).fill(0),c=e.length,h="complex64"===n?u(t):t;if(c>1)for(let i=0;i<o/a;i++){const t=i*a;for(let e=0;e<a;e++)l[e]=Math.max(l[e],s(h[t+e],0,n).length)}return l}(t,e,n,o),c=e.length,h=a(t,e,n,o,l),d=["Tensor"];return r&&(d.push("  dtype: "+n),d.push("  rank: "+c),d.push(`  shape: [${e}]`),d.push("  values:")),d.push(h.map(t=>"    "+t).join("\n")),d.join("\n")}function s(t,e,n){let r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":Object(i.isString)(t)?`'${t}'`:"bool"===n?o(t):parseFloat(t.toFixed(7)).toString(),Object(i.rightPad)(r,e)}function o(t){return 0===t?"false":"true"}function a(t,e,n,i,r,l=!0){const c="complex64"===n?2:1,h=e[0],d=e.length;if(0===d)return"complex64"===n?[s(u(t)[0],0,n)]:"bool"===n?[o(t[0])]:[t[0].toString()];if(1===d){if(h>20){let e=Array.from(t.slice(0,3*c)),i=Array.from(t.slice((h-3)*c,h*c));return"complex64"===n&&(e=u(e),i=u(i)),["["+e.map((t,e)=>s(t,r[e],n)).join(", ")+", ..., "+i.map((t,e)=>s(t,r[h-3+e],n)).join(", ")+"]"]}return["["+("complex64"===n?u(t):Array.from(t)).map((t,e)=>s(t,r[e],n)).join(", ")+"]"]}const f=e.slice(1),p=i.slice(1),m=i[0]*c,g=[];if(h>20){for(let e=0;e<3;e++){const i=e*m;g.push(...a(t.slice(i,i+m),f,n,p,r,!1))}g.push("...");for(let e=h-3;e<h;e++){const i=e*m;g.push(...a(t.slice(i,i+m),f,n,p,r,e===h-1))}}else for(let s=0;s<h;s++){const e=s*m;g.push(...a(t.slice(e,e+m),f,n,p,r,s===h-1))}const y=2===d?",":"";g[0]="["+g[0]+y;for(let s=1;s<g.length-1;s++)g[s]=" "+g[s]+y;let v=",\n";for(let s=2;s<d;s++)v+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(l?"":v),g}function u(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}class l{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=i.sizeFromShape(t),null!=n){const t=n.length;i.assert(t===this.size,()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.getArrayFromDType(e,this.size),this.strides=Object(i.computeStrides)(t)}set(t,...e){0===e.length&&(e=[0]),i.assert(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const i of t){if(i<0||i>=this.shape[e])throw new Error(`Requested out of range element at ${t}.   Buffer shape=`+this.shape);e++}let n=t[t.length-1];for(let i=0;i<t.length-1;++i)n+=this.strides[i]*t[i];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return c().makeTensor(this.values,this.shape,this.dtype)}}let c=null,h=null,d=null;function f(t){c=t}function p(t){h=t}function m(t){d=t}class g{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.sizeFromShape(t),this.strides=Object(i.computeStrides)(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}flatten(){return this.throwIfDisposed(),this.as1D()}asScalar(){return this.throwIfDisposed(),i.assert(1===this.size,()=>"The array must have only 1 element."),this.reshape([])}as1D(){return this.throwIfDisposed(),this.reshape([this.size])}as2D(t,e){return this.throwIfDisposed(),this.reshape([t,e])}as3D(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])}as4D(t,e,n,i){return this.throwIfDisposed(),this.reshape([t,e,n,i])}as5D(t,e,n,i,r){return this.throwIfDisposed(),this.reshape([t,e,n,i,r])}asType(t){return this.throwIfDisposed(),h.cast(this,t)}get rank(){return this.shape.length}async buffer(){const t=await this.data();return h.buffer(this.shape,this.dtype,t)}bufferSync(){return h.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Object(i.toNestedArray)(this.shape,t)}arraySync(){return Object(i.toNestedArray)(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=c().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map(t=>i.decodeString(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=c().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>i.decodeString(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await c().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(c().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}toFloat(){return this.asType("float32")}toInt(){return this.asType("int32")}toBool(){return this.asType("bool")}print(t=!1){return h.print(this,t)}reshape(t){return this.throwIfDisposed(),h.reshape(this,t)}reshapeAs(t){return this.throwIfDisposed(),this.reshape(t.shape)}expandDims(t=0){return h.expandDims(this,t)}squeeze(t){return this.throwIfDisposed(),h.squeeze(this,t)}clone(){return this.throwIfDisposed(),h.clone(this)}toString(t=!1){return r(this.dataSync(),this.shape,this.dtype,t)}gather(t,e=0){return this.throwIfDisposed(),h.gather(this,t,e)}norm(t="euclidean",e=null,n=!1){return this.throwIfDisposed(),h.norm(this,t,e,n)}slice(t,e){return this.throwIfDisposed(),h.slice(this,t,e)}reverse(t){return this.throwIfDisposed(),h.reverse(this,t)}stack(t,e=0){return h.stack([this,t],e)}unstack(t=0){return h.unstack(this,t)}all(t=null,e=!1){return this.throwIfDisposed(),h.all(this,t,e)}any(t=null,e=!1){return this.throwIfDisposed(),h.any(this,t,e)}logSumExp(t=null,e=!1){return this.throwIfDisposed(),h.logSumExp(this,t,e)}sum(t=null,e=!1){return this.throwIfDisposed(),h.sum(this,t,e)}prod(t=null,e=!1){return this.throwIfDisposed(),h.prod(this,t,e)}mean(t=null,e=!1){return this.throwIfDisposed(),h.mean(this,t,e)}min(t=null,e=!1){return this.throwIfDisposed(),h.min(this,t,e)}argMin(t=null){return this.throwIfDisposed(),h.argMin(this,t)}argMax(t=null){return this.throwIfDisposed(),h.argMax(this,t)}cast(t){return this.throwIfDisposed(),h.cast(this,t)}addStrict(t){return this.throwIfDisposed(),h.addStrict(this,t)}subStrict(t){return this.throwIfDisposed(),h.subStrict(this,t)}powStrict(t){return this.throwIfDisposed(),h.powStrict(this,t)}mulStrict(t){return this.throwIfDisposed(),h.mulStrict(this,t)}divStrict(t){return this.throwIfDisposed(),h.divStrict(this,t)}minimumStrict(t){return this.throwIfDisposed(),h.minimumStrict(this,t)}maximumStrict(t){return this.throwIfDisposed(),h.maximumStrict(this,t)}modStrict(t){return this.throwIfDisposed(),h.modStrict(this,t)}squaredDifferenceStrict(t){return this.throwIfDisposed(),h.squaredDifferenceStrict(this,t)}notEqualStrict(t){return this.throwIfDisposed(),h.notEqualStrict(this,t)}lessStrict(t){return this.throwIfDisposed(),h.lessStrict(this,t)}equalStrict(t){return this.throwIfDisposed(),h.equalStrict(this,t)}lessEqualStrict(t){return this.throwIfDisposed(),h.lessEqualStrict(this,t)}greaterStrict(t){return this.throwIfDisposed(),h.greaterStrict(this,t)}greaterEqualStrict(t){return this.throwIfDisposed(),h.greaterEqualStrict(this,t)}logicalAnd(t){return this.throwIfDisposed(),h.logicalAnd(this,t)}logicalOr(t){return this.throwIfDisposed(),h.logicalOr(this,t)}logicalNot(){return this.throwIfDisposed(),h.logicalNot(this)}logicalXor(t){return this.throwIfDisposed(),h.logicalXor(this,t)}where(t,e){return this.throwIfDisposed(),h.where(t,this,e)}neg(){return this.throwIfDisposed(),h.neg(this)}ceil(){return this.throwIfDisposed(),h.ceil(this)}floor(){return this.throwIfDisposed(),h.floor(this)}sign(){return this.throwIfDisposed(),h.sign(this)}isNaN(){return this.throwIfDisposed(),h.isNaN(this)}isInf(){return this.throwIfDisposed(),h.isInf(this)}isFinite(){return this.throwIfDisposed(),h.isFinite(this)}exp(){return this.throwIfDisposed(),h.exp(this)}expm1(){return this.throwIfDisposed(),h.expm1(this)}log(){return this.throwIfDisposed(),h.log(this)}log1p(){return this.throwIfDisposed(),h.log1p(this)}sqrt(){return this.throwIfDisposed(),h.sqrt(this)}rsqrt(){return this.throwIfDisposed(),h.rsqrt(this)}square(){return this.throwIfDisposed(),h.square(this)}reciprocal(){return this.throwIfDisposed(),h.reciprocal(this)}abs(){return this.throwIfDisposed(),h.abs(this)}clipByValue(t,e){return this.throwIfDisposed(),h.clipByValue(this,t,e)}sigmoid(){return this.throwIfDisposed(),h.sigmoid(this)}logSigmoid(){return this.throwIfDisposed(),h.logSigmoid(this)}softplus(){return this.throwIfDisposed(),h.softplus(this)}zerosLike(){return this.throwIfDisposed(),h.zerosLike(this)}onesLike(){return this.throwIfDisposed(),h.onesLike(this)}sin(){return this.throwIfDisposed(),h.sin(this)}cos(){return this.throwIfDisposed(),h.cos(this)}tan(){return this.throwIfDisposed(),h.tan(this)}asin(){return this.throwIfDisposed(),h.asin(this)}acos(){return this.throwIfDisposed(),h.acos(this)}atan(){return this.throwIfDisposed(),h.atan(this)}sinh(){return this.throwIfDisposed(),h.sinh(this)}cosh(){return this.throwIfDisposed(),h.cosh(this)}tanh(){return this.throwIfDisposed(),h.tanh(this)}asinh(){return this.throwIfDisposed(),h.asinh(this)}acosh(){return this.throwIfDisposed(),h.acosh(this)}atanh(){return this.throwIfDisposed(),h.atanh(this)}erf(){return this.throwIfDisposed(),h.erf(this)}round(){return this.throwIfDisposed(),h.round(this)}step(t=0){return this.throwIfDisposed(),h.step(this,t)}softmax(t=-1){return this.throwIfDisposed(),h.softmax(this,t)}logSoftmax(t=-1){return this.throwIfDisposed(),h.logSoftmax(this,t)}resizeBilinear(t,e=!1){return this.throwIfDisposed(),h.image.resizeBilinear(this,t,e)}resizeNearestNeighbor(t,e=!1){return this.throwIfDisposed(),h.image.resizeNearestNeighbor(this,t,e)}variable(t=!0,e,n){return this.throwIfDisposed(),c().makeVariable(this,t,e,n)}unsortedSegmentSum(t,e){return this.throwIfDisposed(),h.unsortedSegmentSum(this,t,e)}topk(t=1,e=!0){return this.throwIfDisposed(),h.topk(this,t,e)}stridedSlice(t,e,n,i=0,r=0,s=0,o=0,a=0){return this.throwIfDisposed(),h.stridedSlice(this,t,e,n,i,r,s,o,a)}fft(){return this.throwIfDisposed(),h.spectral.fft(this)}ifft(){return this.throwIfDisposed(),h.spectral.ifft(this)}rfft(){return this.throwIfDisposed(),h.spectral.rfft(this)}irfft(){return this.throwIfDisposed(),h.spectral.irfft(this)}}Object.defineProperty(g,Symbol.hasInstance,{value:t=>!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype});class y extends g{constructor(t,e,n,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!i.arraysEqual(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);c().disposeTensor(this),this.dataId=t.dataId,c().incRef(this,null)}dispose(){c().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(y,Symbol.hasInstance,{value:t=>t instanceof g&&null!=t.assign&&t.assign instanceof Function})},function(t,e,n){"use strict";n.d(e,"a",function(){return S}),n.d(e,"b",function(){return w}),n.d(e,"d",function(){return E}),n.d(e,"e",function(){return f}),n.d(e,"f",function(){return h}),n.d(e,"g",function(){return p}),n.d(e,"h",function(){return m}),n.d(e,"i",function(){return g}),n.d(e,"j",function(){return y}),n.d(e,"k",function(){return v}),n.d(e,"l",function(){return b}),n.d(e,"m",function(){return x}),n.d(e,"n",function(){return T}),n.d(e,"c",function(){return O}),n.d(e,"o",function(){return C});var i=n(5),r=n(10),s=n(3),o=n(1),a=n(18),u=n(25),l=n(4),c=n(22);function h(t,e,n){return d(t,e,Object(s.c)(t,n),n)}function d(t,e,n,s){if(null==s&&(s=Object(o.inferDtype)(t)),"complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(o.isTypedArray)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(o.assertNonNegativeIntegerDimensions)(e);const t=Object(o.sizeFromShape)(e),i=Object(o.sizeFromShape)(n);Object(o.assert)(t===i,()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${i}`);for(let r=0;r<n.length;++r){const t=n[r],i=r!==n.length-1||t!==Object(o.sizeFromShape)(e.slice(r));Object(o.assert)(n[r]===e[r]||!i,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return Object(o.isTypedArray)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==s?Object(o.toTypedArray)(t,s,Object(r.c)().getBool("DEBUG")):Object(o.flatten)(t,[],!0),i.a.makeTensor(t,e,s)}function f(t,e){if((Object(o.isTypedArray)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(o.isTypedArray)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return d(t,[],[],e)}function p(t,e){Object(o.assertNonNull)(t);const n=Object(s.c)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return d(t,null,n,e)}function m(t,e,n){if(Object(o.assertNonNull)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const i=Object(s.c)(t,n);if(2!==i.length&&1!==i.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return d(t,e,i,n)}function g(t,e,n){if(Object(o.assertNonNull)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const i=Object(s.c)(t,n);if(3!==i.length&&1!==i.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return d(t,e,i,n)}function y(t,e,n){if(Object(o.assertNonNull)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const i=Object(s.c)(t,n);if(4!==i.length&&1!==i.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return d(t,e,i,n)}function v(t,e,n){if(Object(o.assertNonNull)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const i=Object(s.c)(t,n);if(5!==i.length&&1!==i.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return d(t,e,i,n)}function b(t,e,n){if(Object(o.assertNonNull)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const i=Object(s.c)(t,n);if(6!==i.length&&1!==i.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===i.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return d(t,e=e||i,i,n)}function x(t,e=!0,n,r){return i.a.makeVariable(t,e,n,r)}function w(t,e="float32"){if("complex64"===e){const e=w(t,"float32"),n=T(t,"float32");return Object(a.a)(e,n)}const n=Object(o.makeOnesTypedArray)(Object(o.sizeFromShape)(t),e);return i.a.makeTensor(n,t,e)}function T(t,e="float32"){if("complex64"===e){const e=T(t,"float32"),n=T(t,"float32");return Object(a.a)(e,n)}const n=Object(o.makeZerosTypedArray)(Object(o.sizeFromShape)(t),e);return i.a.makeTensor(n,t,e)}function S(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return i.a.runKernelFunc(i=>i.linspace(t,e,n),{})}function E(t,e,n=1,i="float32"){if(0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return T([0],i);const r=Math.abs(Math.ceil((e-t)/n)),s=Object(o.makeZerosTypedArray)(r,i);e<t&&1===n&&(n=-1),s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+n;return p(s,i)}const O=Object(l.a)({onesLike_:function(t){const e=Object(s.a)(t,"x","onesLike");if("complex64"===e.dtype){const t=O(Object(c.a)(e)),n=C(Object(u.a)(e));return Object(a.a)(t,n)}return i.a.runKernelFunc(t=>t.onesLike(e),{x:e},(t,e)=>({x:()=>C(t)}),"OnesLike")}}),C=Object(l.a)({zerosLike_:function(t){const e=Object(s.a)(t,"x","zerosLike");return i.a.runKernelFunc(t=>t.zerosLike(e),{x:e},(t,e)=>({x:()=>C(t)}),"ZerosLike")}})},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(0);function r(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&i.util.assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the CPU backend.")})}},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return s}),n.d(e,"d",function(){return o});class i{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(e instanceof Promise)throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=function(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("="))),e}(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,n)})}}function r(){return s}let s=null;function o(t){s=t}},function(t,e,n){"use strict";n.r(e),n.d(e,"makeTypesMatch",function(){return o}),n.d(e,"assertTypesMatch",function(){return a}),n.d(e,"isTensorInList",function(){return u}),n.d(e,"getTensorsInContainer",function(){return l});var i=n(7),r=n(23),s=n(1);function o(t,e){if(t.dtype===e.dtype)return[t,e];const n=Object(r.c)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function a(t,e){Object(s.assert)(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function u(t,e){return e.some(e=>e.id===t.id)}function l(t){const e=[];return c(t,e,new Set),e}function c(t,e,n){if(null==t)return;if(t instanceof i.a)return void e.push(t);if(r=t,!Array.isArray(r)&&"object"!=typeof r)return;var r;const s=t;for(const i in s){const t=s[i];n.has(t)||(n.add(t),c(t,e,n))}}},function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,i,r;for(void 0===e&&(e=15),i=.5,n=new Date;;){for(r=i*=2;r>3;r-=4)t(),t(),t(),t();for(;r>0;)t(),r--;if(new Date-n>e)break}for(r=i;r>3;r-=4)t(),t(),t(),t();for(;r>0;)t(),r--;return 1e3*(3*i-1)/(new Date-n)},numeric._myIndexOf=function(t){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),i=t/Math.pow(10,n),r=i.toPrecision(numeric.precision);return 10===parseFloat(r)&&(n++,r=(i=1).toPrecision(numeric.precision)),parseFloat(r).toString()+"e"+n.toString()}return"Infinity"}var n=[];return function t(i){var r;if(void 0===i)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof i)return n.push('"'+i+'"'),!1;if("boolean"==typeof i)return n.push(i.toString()),!1;if("number"==typeof i){var s=e(i),o=i.toPrecision(numeric.precision),a=parseFloat(i.toString()).toString(),u=[s,o,a,parseFloat(o).toString(),parseFloat(a).toString()];for(r=1;r<u.length;r++)u[r].length<s.length&&(s=u[r]);return n.push(Array(numeric.precision+8-s.length).join(" ")+s),!1}if(null===i)return n.push("null"),!1;if("function"==typeof i){n.push(i.toString());var l=!1;for(r in i)i.hasOwnProperty(r)&&(n.push(l?",\n":"\n{"),l=!0,n.push(r),n.push(": \n"),t(i[r]));return l&&n.push("}\n"),!0}if(i instanceof Array){if(i.length>numeric.largeArray)return n.push("...Large Array..."),!0;for(l=!1,n.push("["),r=0;r<i.length;r++)r>0&&(n.push(","),l&&n.push("\n ")),l=t(i[r]);return n.push("]"),!0}for(r in n.push("{"),l=!1,i)i.hasOwnProperty(r)&&(l&&n.push(",\n"),l=!0,n.push(r),n.push(": \n"),t(i[r]));return n.push("}"),!0}(t),n.join("")},numeric.parseDate=function(t){return function t(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(!(e instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,i=[];for(n=0;n<e.length;n++)i[n]=t(e[n]);return i}(t)},numeric.parseFloat=function(t){return function t(e){if("string"==typeof e)return parseFloat(e);if(!(e instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,i=[];for(n=0;n<e.length;n++)i[n]=t(e[n]);return i}(t)},numeric.parseCSV=function(t){var e,n,i,r=t.split("\n"),s=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,a=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=0;for(n=0;n<r.length;n++){var l,c=(r[n]+",").match(o);if(c.length>0){for(s[u]=[],e=0;e<c.length;e++)l=(i=c[e]).substr(0,i.length-1),s[u][e]=a.test(l)?parseFloat(l):l;u++}}return s},numeric.toCSV=function(t){var e,n,i,r,s;for(i=numeric.dim(t)[0],s=[],e=0;e<i;e++){for(r=[],n=0;n<i;n++)r[n]=t[e][n].toString();s[e]=r.join(", ")}return s.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i,r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],s=-1;for(i=e;i<n;i++)s=s>>>8^r[255&(s^t[i])];return-1^s}var n,i,r,s,o,a,u,l,c,h,d=t[0].length,f=t[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,d>>24&255,d>>16&255,d>>8&255,255&d,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(p,12,29),p[29]=h>>24&255,p[30]=h>>16&255,p[31]=h>>8&255,p[32]=255&h,n=1,i=0,u=0;u<d;u++){for(p.push(u<d-1?0:1),a=3*f+1+(0===u)>>8&255,p.push(o=3*f+1+(0===u)&255),p.push(a),p.push(255&~o),p.push(255&~a),0===u&&p.push(0),l=0;l<f;l++)for(r=0;r<3;r++)i=(i+(n=(n+(o=(o=t[r][u][l])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return p.push((c=(i<<16)+n)>>24&255),p.push(c>>16&255),p.push(c>>8&255),p.push(255&c),p[33]=(s=p.length-41)>>24&255,p[34]=s>>16&255,p[35]=s>>8&255,p[36]=255&s,h=e(p,37),p.push(h>>24&255),p.push(h>>16&255),p.push(h>>8&255),p.push(255&h),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(t){var e,n,i,r,s,o,a,u=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(e=0;e<u;e+=3)s=((3&(n=t[e]))<<4)+((i=t[e+1])>>4),o=((15&i)<<2)+((r=t[e+2])>>6),a=63&r,e+1>=u?o=a=64:e+2>=u&&(a=64),c+=l.charAt(n>>2)+l.charAt(s)+l.charAt(o)+l.charAt(a);return c}(p)},numeric._dim=function(t){for(var e=[];"object"==typeof t;)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e;return"object"==typeof t?"object"==typeof(e=t[0])?"object"==typeof e[0]?numeric._dim(t):[t.length,e.length]:[t.length]:[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,n){var i,r;if(!(e instanceof Array&&n instanceof Array))return!1;if((r=e.length)!==n.length)return!1;for(i=0;i<r;i++)if(e[i]!==n[i]){if("object"!=typeof e[i])return!1;if(!t(e[i],n[i]))return!1}return!0},numeric.rep=function(t,e,n){void 0===n&&(n=0);var i,r=t[n],s=Array(r);if(n===t.length-1){for(i=r-2;i>=0;i-=2)s[i+1]=e,s[i]=e;return-1===i&&(s[0]=e),s}for(i=r-1;i>=0;i--)s[i]=numeric.rep(t,e,n+1);return s},numeric.dotMMsmall=function(t,e){var n,i,r,s,o,a,u,l,c,h,d;for(s=t.length,o=e.length,a=e[0].length,u=Array(s),n=s-1;n>=0;n--){for(l=Array(a),c=t[n],r=a-1;r>=0;r--){for(h=c[o-1]*e[o-1][r],i=o-2;i>=1;i-=2)h+=c[i]*e[i][r]+c[d=i-1]*e[d][r];0===i&&(h+=c[0]*e[0][r]),l[r]=h}u[n]=l}return u},numeric._getCol=function(t,e,n){var i;for(i=t.length-1;i>0;--i)n[i]=t[i][e],n[--i]=t[i][e];0===i&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n,i,r=numeric._getCol,s=e.length,o=Array(s),a=t.length,u=e[0].length,l=new Array(a),c=numeric.dotVV;for(--s,n=--a;-1!==n;--n)l[n]=Array(u);for(n=--u;-1!==n;--n)for(r(e,n,o),i=a;-1!==i;--i)l[i][n]=c(t[i],o);return l},numeric.dotMV=function(t,e){var n,i=t.length,r=Array(i),s=numeric.dotVV;for(n=i-1;n>=0;n--)r[n]=s(t[n],e);return r},numeric.dotVM=function(t,e){var n,i,r,s,o,a,u;for(r=t.length,s=e[0].length,o=Array(s),i=s-1;i>=0;i--){for(a=t[r-1]*e[r-1][i],n=r-2;n>=1;n-=2)a+=t[n]*e[n][i]+t[u=n-1]*e[u][i];0===n&&(a+=t[0]*e[0][i]),o[i]=a}return o},numeric.dotVV=function(t,e){var n,i,r=t.length,s=t[r-1]*e[r-1];for(n=r-2;n>=1;n-=2)s+=t[n]*e[n]+t[i=n-1]*e[i];return 0===n&&(s+=t[0]*e[0]),s},numeric.dot=function(t,e){var n=numeric.dim;switch(1e3*n(t).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,i,r,s=t.length,o=Array(s);for(e=s-1;e>=0;e--){for(r=Array(s),n=e+2,i=s-1;i>=n;i-=2)r[i]=0,r[i-1]=0;for(i>e&&(r[i]=0),r[e]=t[e],i=e-1;i>=1;i-=2)r[i]=0,r[i-1]=0;0===i&&(r[0]=0),o[e]=r}return o},numeric.getDiag=function(t){var e,n=Math.min(t.length,t[0].length),i=Array(n);for(e=n-1;e>=1;--e)i[e]=t[e][e],i[--e]=t[e][e];return 0===e&&(i[0]=t[0][0]),i},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){void 0===n&&(n="");var i,r,s=[],o=/\[i\]$/,a="",u=!1;for(i=0;i<t.length;i++)o.test(t[i])?a=r=t[i].substring(0,t[i].length-3):r=t[i],"ret"===r&&(u=!0),s.push(r);return s[t.length]="_s",s[t.length+1]="_k",s[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,s)},numeric.pointwise2=function(t,e,n){void 0===n&&(n="");var i,r,s=[],o=/\[i\]$/,a="",u=!1;for(i=0;i<t.length;i++)o.test(t[i])?a=r=t[i].substring(0,t[i].length-3):r=t[i],"ret"===r&&(u=!0),s.push(r);return s[t.length]="var _n = "+a+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,s)},numeric._biforeach=function t(e,n,i,r,s){var o;if(r!==i.length-1)for(o=i[r]-1;o>=0;o--)t("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,i,r+1,s);else s(e,n)},numeric._biforeach2=function t(e,n,i,r,s){if(r===i.length-1)return s(e,n);var o,a=i[r],u=Array(a);for(o=a-1;o>=0;--o)u[o]=t("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,i,r+1,s);return u},numeric._foreach=function t(e,n,i,r){var s;if(i!==n.length-1)for(s=n[i]-1;s>=0;s--)t(e[s],n,i+1,r);else r(e)},numeric._foreach2=function t(e,n,i,r){if(i===n.length-1)return r(e);var s,o=n[i],a=Array(o);for(s=o-1;s>=0;s--)a[s]=t(e[s],n,i+1,r);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)numeric.ops2[e=numeric.mathfuns2[t]]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var n,i,r="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(r="var "+e+" = Math."+e+";\n",n=function(t,n,i){return t+" = "+e+"("+n+","+i+")"},i=function(t,n){return t+" = "+e+"("+t+","+n+")"}):(n=function(t,n,i){return t+" = "+n+" "+e+" "+i},i=numeric.opseq.hasOwnProperty(t+"eq")?function(t,n){return t+" "+e+"= "+n}:function(t,n){return t+" = "+t+" "+e+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),r),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),r),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),r),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+i("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),r),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],i("ret[i]","x"),r),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)delete numeric.ops2[e=numeric.mathfuns2[t]];for(t=0;t<numeric.mathfuns.length;++t)numeric.ops1[e=numeric.mathfuns[t]]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(r="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(r="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",r),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",r),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)delete numeric.ops1[e=numeric.mathfuns[t]];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(numeric[t+"V"]=numeric.mapreduce2((e=numeric.mapreducers[t])[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"==typeof t?"object"==typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"==typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,n,i,r,s,o,a,u=numeric.dim(t),l=Math.abs,c=u[0],h=u[1],d=numeric.clone(t),f=numeric.identity(c);for(o=0;o<h;++o){var p=-1,m=-1;for(s=o;s!==c;++s)(a=l(d[s][o]))>m&&(p=s,m=a);for(n=d[p],d[p]=d[o],d[o]=n,r=f[p],f[p]=f[o],f[o]=r,t=n[o],a=o;a!==h;++a)n[a]/=t;for(a=h-1;-1!==a;--a)r[a]/=t;for(s=c-1;-1!==s;--s)if(s!==o){for(i=f[s],t=(e=d[s])[o],a=o+1;a!==h;++a)e[a]-=n[a]*t;for(a=h-1;a>0;--a)i[a]-=r[a]*t,i[--a]-=r[a]*t;0===a&&(i[0]-=r[0]*t)}}return f},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,i,r,s,o,a,u,l,c=e[0],h=1,d=numeric.clone(t);for(i=0;i<c-1;i++){for(r=i,n=i+1;n<c;n++)Math.abs(d[n][i])>Math.abs(d[r][i])&&(r=n);for(r!==i&&(u=d[r],d[r]=d[i],d[i]=u,h*=-1),s=d[i],n=i+1;n<c;n++){for(a=(o=d[n])[i]/s[i],r=i+1;r<c-1;r+=2)l=r+1,o[r]-=s[r]*a,o[l]-=s[l]*a;r!==c&&(o[r]-=s[r]*a)}if(0===s[i])return 0;h*=s[i]}return h*d[i][i]},numeric.transpose=function(t){var e,n,i,r,s,o=t.length,a=t[0].length,u=Array(a);for(n=0;n<a;n++)u[n]=Array(o);for(e=o-1;e>=1;e-=2){for(r=t[e],i=t[e-1],n=a-1;n>=1;--n)(s=u[n])[e]=r[n],s[e-1]=i[n],(s=u[--n])[e]=r[n],s[e-1]=i[n];0===n&&((s=u[0])[e]=r[0],s[e-1]=i[0])}if(0===e){for(i=t[0],n=a-1;n>=1;--n)u[n][0]=i[n],u[--n][0]=i[n];0===n&&(u[0][0]=i[0])}return u},numeric.negtranspose=function(t){var e,n,i,r,s,o=t.length,a=t[0].length,u=Array(a);for(n=0;n<a;n++)u[n]=Array(o);for(e=o-1;e>=1;e-=2){for(r=t[e],i=t[e-1],n=a-1;n>=1;--n)(s=u[n])[e]=-r[n],s[e-1]=-i[n],(s=u[--n])[e]=-r[n],s[e-1]=-i[n];0===n&&((s=u[0])[e]=-r[0],s[e-1]=-i[0])}if(0===e){for(i=t[0],n=a-1;n>=1;--n)u[n][0]=-i[n],u[--n][0]=-i[n];0===n&&(u[0][0]=-i[0])}return u},numeric._random=function t(e,n){var i,r,s=e[n],o=Array(s);if(n===e.length-1){for(r=Math.random,i=s-1;i>=1;i-=2)o[i]=r(),o[i-1]=r();return 0===i&&(o[0]=r()),o}for(i=s-1;i>=0;i--)o[i]=t(e,n+1);return o},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if(void 0===n&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return 1===n?[t]:[];var i,r=Array(n);for(i=--n;i>=0;i--)r[i]=(i*e+(n-i)*t)/n;return r},numeric.getBlock=function(t,e,n){var i=numeric.dim(t);return function t(r,s){var o,a=e[s],u=n[s]-a,l=Array(u);if(s===i.length-1){for(o=u;o>=0;o--)l[o]=r[o+a];return l}for(o=u;o>=0;o--)l[o]=t(r[o+a],s+1);return l}(t,0)},numeric.setBlock=function(t,e,n,i){var r=numeric.dim(t);return function t(i,s,o){var a,u=e[o],l=n[o]-u;if(o===r.length-1)for(a=l;a>=0;a--)i[a+u]=s[a];for(a=l;a>=0;a--)t(i[a+u],s[a],o+1)}(t,i,0),t},numeric.getRange=function(t,e,n){var i,r,s,o,a=e.length,u=n.length,l=Array(a);for(i=a-1;-1!==i;--i)for(l[i]=Array(u),s=l[i],o=t[e[i]],r=u-1;-1!==r;--r)s[r]=o[n[r]];return l},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n,i,r,s,o,a=e[0],u=e[1];for(n=0,i=0,r=0;r<a;++r)n+=t[r][0].length;for(s=0;s<u;++s)i+=t[0][s][0].length;var l=Array(n);for(r=0;r<n;++r)l[r]=Array(i);var c,h,d,f,p,m=0;for(r=0;r<a;++r){for(c=i,s=u-1;-1!==s;--s)for(c-=(o=t[r][s])[0].length,d=o.length-1;-1!==d;--d)for(h=l[m+d],f=(p=o[d]).length-1;-1!==f;--f)h[c+f]=p[f];m+=t[r][0].length}return l},numeric.tensor=function(t,e){if("number"==typeof t||"number"==typeof e)return numeric.mul(t,e);var n=numeric.dim(t),i=numeric.dim(e);if(1!==n.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var r,s,o,a,u=n[0],l=i[0],c=Array(u);for(s=u-1;s>=0;s--){for(r=Array(l),a=t[s],o=l-1;o>=3;--o)r[o]=a*e[o],r[--o]=a*e[o],r[--o]=a*e[o],r[--o]=a*e[o];for(;o>=0;)r[o]=a*e[o],--o;c[s]=r}return c},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,i,r){var s;if("string"!=typeof r)for(s in r="",numeric)numeric.hasOwnProperty(s)&&(t.indexOf(s)>=0||e.indexOf(s)>=0||n.indexOf(s)>=0||i.indexOf(s)>=0)&&s.length>1&&(r+="var "+s+" = numeric."+s+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+r+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if(void 0===t.y)return new numeric.T(numeric.inv(t.x));var e,n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v,b=t.x.length,x=numeric.identity(b),w=numeric.rep([b,b],0),T=numeric.clone(t.x),S=numeric.clone(t.y);for(l=0;l<b;l++){for(d=(p=T[l][l])*p+(m=S[l][l])*m,h=l,c=l+1;c<b;c++)(f=(p=T[c][l])*p+(m=S[c][l])*m)>d&&(h=c,d=f);for(h!==l&&(v=T[l],T[l]=T[h],T[h]=v,v=S[l],S[l]=S[h],S[h]=v,v=x[l],x[l]=x[h],x[h]=v,v=w[l],w[l]=w[h],w[h]=v),s=x[l],o=w[l],p=(e=T[l])[l],m=(n=S[l])[l],c=l+1;c<b;c++)e[c]=((g=e[c])*p+(y=n[c])*m)/d,n[c]=(y*p-g*m)/d;for(c=0;c<b;c++)s[c]=((g=s[c])*p+(y=o[c])*m)/d,o[c]=(y*p-g*m)/d;for(c=l+1;c<b;c++){for(a=x[c],u=w[c],p=(i=T[c])[l],m=(r=S[c])[l],h=l+1;h<b;h++)i[h]-=(g=e[h])*p-(y=n[h])*m,r[h]-=y*p+g*m;for(h=0;h<b;h++)a[h]-=(g=s[h])*p-(y=o[h])*m,u[h]-=y*p+g*m}}for(l=b-1;l>0;l--)for(s=x[l],o=w[l],c=l-1;c>=0;c--)for(a=x[c],u=w[c],p=T[c][l],m=S[c][l],h=b-1;h>=0;h--)a[h]-=p*(g=s[h])-m*(y=o[h]),u[h]-=p*y+m*g;return new numeric.T(x,w)},numeric.T.prototype.get=function(t){var e,n=this.x,i=this.y,r=0,s=t.length;if(i){for(;r<s;)n=n[e=t[r]],i=i[e],r++;return new numeric.T(n,i)}for(;r<s;)n=n[e=t[r]],r++;return new numeric.T(n)},numeric.T.prototype.set=function(t,e){var n,i=this.x,r=this.y,s=0,o=t.length,a=e.x,u=e.y;if(0===o)return u?this.y=u:r&&(this.y=void 0),this.x=i,this;if(u){for(r||(r=numeric.rep(numeric.dim(i),0),this.y=r);s<o-1;)i=i[n=t[s]],r=r[n],s++;return i[n=t[s]]=a,r[n]=u,this}if(r){for(;s<o-1;)i=i[n=t[s]],r=r[n],s++;return i[n=t[s]]=a,r[n]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}for(;s<o-1;)i=i[n=t[s]],s++;return i[n=t[s]]=a,this},numeric.T.prototype.getRows=function(t,e){var n,i,r=e-t+1,s=Array(r),o=this.x,a=this.y;for(n=t;n<=e;n++)s[n-t]=o[n];if(a){for(i=Array(r),n=t;n<=e;n++)i[n-t]=a[n];return new numeric.T(s,i)}return new numeric.T(s)},numeric.T.prototype.setRows=function(t,e,n){var i,r=this.x,s=this.y,o=n.x,a=n.y;for(i=t;i<=e;i++)r[i]=o[i-t];if(a)for(s||(s=numeric.rep(numeric.dim(r),0),this.y=s),i=t;i<=e;i++)s[i]=a[i-t];else if(s)for(i=t;i<=e;i++)s[i]=numeric.rep([o[i-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,i=this.y,r=e.x,s=e.y;return n[t]=r,s?(i||(i=numeric.rep(numeric.dim(n),0),this.y=i),i[t]=s):i&&(i=numeric.rep([r.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,i=this.y,r=numeric.getBlock;return i?new numeric.T(r(n,t,e),r(i,t,e)):new numeric.T(r(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var i=this.x,r=this.y,s=numeric.setBlock,o=n.x,a=n.y;if(a)return r||(this.y=numeric.rep(numeric.dim(this),0),r=this.y),s(i,t,e,o),s(r,t,e,a),this;s(i,t,e,o),r&&s(r,t,e,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var i=e.x,r=e.y,s=numeric.rep;return r?new n(s(t,i),s(t,r)):new n(s(t,i))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,i=numeric.diag;return n?new numeric.T(i(e),i(n)):new numeric.T(i(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=(t[0]>=0?1:-1)*numeric.norm2(t);e[0]+=n;var i=numeric.norm2(e);if(0===i)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,i,r,s,o,a,u,l,c,h,d=e[0],f=numeric.clone(t),p=numeric.identity(d);for(i=0;i<d-2;i++){for(s=Array(d-i-1),n=i+1;n<d;n++)s[n-i-1]=f[n][i];if(numeric.norm2(s)>0){for(o=numeric.house(s),a=numeric.getBlock(f,[i+1,i],[d-1,d-1]),u=numeric.tensor(o,numeric.dot(o,a)),n=i+1;n<d;n++)for(l=f[n],c=u[n-i-1],r=i;r<d;r++)l[r]-=2*c[r-i];for(a=numeric.getBlock(f,[0,i+1],[d-1,d-1]),u=numeric.tensor(numeric.dot(a,o),o),n=0;n<d;n++)for(l=f[n],c=u[n],r=i+1;r<d;r++)l[r]-=2*c[r-i-1];for(a=Array(d-i-1),n=i+1;n<d;n++)a[n-i-1]=p[n];for(u=numeric.tensor(o,numeric.dot(o,a)),n=i+1;n<d;n++)for(h=p[n],c=u[n-i-1],r=0;r<d;r++)h[r]-=2*c[r]}}return{H:f,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){void 0===e&&(e=1e4),t=numeric.clone(t),numeric.clone(t);var n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v=numeric.dim(t)[0],b=numeric.identity(v);if(v<3)return{Q:b,B:[[0,v-1]]};var x=numeric.epsilon;for(y=0;y<e;y++){for(m=0;m<v-1;m++)if(Math.abs(t[m+1][m])<x*(Math.abs(t[m][m])+Math.abs(t[m+1][m+1]))){var w=numeric.QRFrancis(numeric.getBlock(t,[0,0],[m,m]),e),T=numeric.QRFrancis(numeric.getBlock(t,[m+1,m+1],[v-1,v-1]),e);for(h=Array(m+1),p=0;p<=m;p++)h[p]=b[p];for(d=numeric.dot(w.Q,h),p=0;p<=m;p++)b[p]=d[p];for(h=Array(v-m-1),p=m+1;p<v;p++)h[p-m-1]=b[p];for(d=numeric.dot(T.Q,h),p=m+1;p<v;p++)b[p]=d[p-m-1];return{Q:b,B:w.B.concat(numeric.add(T.B,m+1))}}var S,E,O;for(a=(r=t[v-2][v-2])+(s=t[v-1][v-1]),o=r*s-t[v-2][v-1]*t[v-1][v-2],u=numeric.getBlock(t,[0,0],[2,2]),a*a>=4*o?(S=.5*(a+Math.sqrt(a*a-4*o)),E=.5*(a-Math.sqrt(a*a-4*o)),u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,S+E)),numeric.diag(numeric.rep([3],S*E)))):u=numeric.add(numeric.sub(numeric.dot(u,u),numeric.mul(u,a)),numeric.diag(numeric.rep([3],o))),i=numeric.house(n=[u[0][0],u[1][0],u[2][0]]),d=numeric.tensor(i,numeric.dot(i,h=[t[0],t[1],t[2]])),p=0;p<3;p++)for(c=t[p],f=d[p],g=0;g<v;g++)c[g]-=2*f[g];for(h=numeric.getBlock(t,[0,0],[v-1,2]),d=numeric.tensor(numeric.dot(h,i),i),p=0;p<v;p++)for(c=t[p],f=d[p],g=0;g<3;g++)c[g]-=2*f[g];for(d=numeric.tensor(i,numeric.dot(i,h=[b[0],b[1],b[2]])),p=0;p<3;p++)for(l=b[p],f=d[p],g=0;g<v;g++)l[g]-=2*f[g];for(m=0;m<v-2;m++){for(g=m;g<=m+1;g++)if(Math.abs(t[g+1][g])<x*(Math.abs(t[g][g])+Math.abs(t[g+1][g+1]))){for(w=numeric.QRFrancis(numeric.getBlock(t,[0,0],[g,g]),e),T=numeric.QRFrancis(numeric.getBlock(t,[g+1,g+1],[v-1,v-1]),e),h=Array(g+1),p=0;p<=g;p++)h[p]=b[p];for(d=numeric.dot(w.Q,h),p=0;p<=g;p++)b[p]=d[p];for(h=Array(v-g-1),p=g+1;p<v;p++)h[p-g-1]=b[p];for(d=numeric.dot(T.Q,h),p=g+1;p<v;p++)b[p]=d[p-g-1];return{Q:b,B:w.B.concat(numeric.add(T.B,g+1))}}for(O=Math.min(v-1,m+3),n=Array(O-m),p=m+1;p<=O;p++)n[p-m-1]=t[p][m];for(i=numeric.house(n),h=numeric.getBlock(t,[m+1,m],[O,v-1]),d=numeric.tensor(i,numeric.dot(i,h)),p=m+1;p<=O;p++)for(c=t[p],f=d[p-m-1],g=m;g<v;g++)c[g]-=2*f[g-m];for(h=numeric.getBlock(t,[0,m+1],[v-1,O]),d=numeric.tensor(numeric.dot(h,i),i),p=0;p<v;p++)for(c=t[p],f=d[p],g=m+1;g<=O;g++)c[g]-=2*f[g-m-1];for(h=Array(O-m),p=m+1;p<=O;p++)h[p-m-1]=b[p];for(d=numeric.tensor(i,numeric.dot(i,h)),p=m+1;p<=O;p++)for(l=b[p],f=d[p-m-1],g=0;g<v;g++)l[g]-=2*f[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v,b=numeric.toUpperHessenberg(t),x=numeric.QRFrancis(b.H,e),w=numeric.T,T=x.B,S=numeric.dot(x.Q,numeric.dot(b.H,numeric.transpose(x.Q))),E=new w(numeric.dot(x.Q,b.Q)),O=T.length,C=Math.sqrt;for(i=0;i<O;i++)if((n=T[i][0])===T[i][1]);else{if(o=S[n][n],u=S[s=n+1][n],l=S[s][s],0===(a=S[n][s])&&0===u)continue;(h=(c=-o-l)*c-4*(o*l-a*u))>=0?((g=(o-(d=c<0?-.5*(c-C(h)):-.5*(c+C(h))))*(o-d)+a*a)>(y=u*u+(l-d)*(l-d))?(p=(o-d)/(g=C(g)),m=a/g):(p=u/(y=C(y)),m=(l-d)/y),r=new w([[m,-p],[p,m]]),E.setRows(n,s,r.dot(E.getRows(n,s)))):(d=-.5*c,f=.5*C(-h),(g=(o-d)*(o-d)+a*a)>(y=u*u+(l-d)*(l-d))?(p=(o-d)/(g=C(g+f*f)),m=a/g,d=0,f/=g):(p=u/(y=C(y+f*f)),m=(l-d)/y,d=f/y,f=0),r=new w([[m,-p],[p,m]],[[d,f],[f,-d]]),E.setRows(n,s,r.dot(E.getRows(n,s))))}var _=E.dot(t).dot(E.transjugate()),A=numeric.T.identity(v=t.length);for(s=0;s<v;s++)if(s>0)for(i=s-1;i>=0;i--){var k=_.get([i,i]),R=_.get([s,s]);numeric.neq(k.x,R.x)||numeric.neq(k.y,R.y)?(d=_.getRow(i).getBlock([i],[s-1]),f=A.getRow(s).getBlock([i],[s-1]),A.set([s,i],_.get([i,s]).neg().sub(d.dot(f)).div(k.sub(R)))):A.setRow(s,A.getRow(i))}for(s=0;s<v;s++)d=A.getRow(s),A.setRow(s,d.div(d.norm2()));return A=A.transpose(),A=E.transjugate().dot(A),{lambda:_.getDiag(),E:A}},numeric.ccsSparse=function(t){var e,n,i,r=t.length,s=[];for(n=r-1;-1!==n;--n)for(i in e=t[n]){for(i=parseInt(i);i>=s.length;)s[s.length]=0;0!==e[i]&&s[i]++}var o=s.length,a=Array(o+1);for(a[0]=0,n=0;n<o;++n)a[n+1]=a[n]+s[n];var u=Array(a[o]),l=Array(a[o]);for(n=r-1;-1!==n;--n)for(i in e=t[n])0!==e[i]&&(s[i]--,u[a[i]+s[i]]=n,l[a[i]+s[i]]=e[i]);return[a,u,l]},numeric.ccsFull=function(t){var e,n,i,r=t[0],s=t[1],o=t[2],a=numeric.ccsDim(t),u=a[1],l=numeric.rep([a[0],u],0);for(e=0;e<u;e++)for(i=r[e+1],n=r[e];n<i;++n)l[s[n]][e]=o[n];return l},numeric.ccsTSolve=function(t,e,n,i,r){var s,o,a,u,l,c,h,d=t[0],f=t[1],p=t[2],m=Math.max,g=0;function y(t){var e;if(0===n[t]){for(n[t]=1,e=d[t];e<d[t+1];++e)y(f[e]);r[g]=t,++g}}for(void 0===i&&(n=numeric.rep([d.length-1],0)),void 0===i&&(i=numeric.linspace(0,n.length-1)),void 0===r&&(r=[]),s=i.length-1;-1!==s;--s)y(i[s]);for(r.length=g,s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=i.length-1;-1!==s;--s)n[o=i[s]]=e[o];for(s=r.length-1;-1!==s;--s){for(u=m(d[(o=r[s])+1],a=d[o]),l=a;l!==u;++l)if(f[l]===o){n[o]/=p[l];break}for(h=n[o],l=a;l!==u;++l)(c=f[l])!==o&&(n[c]-=h*p[l])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,i,r,s){var o,a,u,l=0,c=r.length,h=this.k,d=this.k1,f=this.j;if(0===i[t])for(i[t]=1,f[0]=t,h[0]=a=e[t],d[0]=u=e[t+1];;)if(a>=u){if(r[c]=f[l],0===l)return;++c,a=h[--l],u=d[l]}else 0===i[o=s[n[a]]]?(i[o]=1,h[l]=a,f[++l]=o,a=e[o],d[l]=u=e[o+1]):++a},numeric.ccsLPSolve=function(t,e,n,i,r,s,o){var a,u,l,c,h,d,f,p,m,g=t[0],y=t[1],v=t[2],b=e[0],x=e[1],w=e[2];for(u=b[r],l=b[r+1],i.length=0,a=u;a<l;++a)o.dfs(s[x[a]],g,y,n,i,s);for(a=i.length-1;-1!==a;--a)n[i[a]]=0;for(a=u;a!==l;++a)n[c=s[x[a]]]=w[a];for(a=i.length-1;-1!==a;--a){for(d=g[(c=i[a])+1],f=h=g[c];f<d;++f)if(s[y[f]]===c){n[c]/=v[f];break}for(m=n[c],f=h;f<d;++f)(p=s[y[f]])!==c&&(n[p]-=m*v[f])}return n},numeric.ccsLUP1=function(t,e){var n,i,r,s,o,a,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],d=c[0],f=c[1],p=c[2],m=h[0],g=h[1],y=h[2],v=numeric.rep([l],0),b=numeric.rep([l],0),x=numeric.ccsLPSolve,w=(Math,Math.abs),T=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),E=new numeric.ccsDFS(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(x(c,t,v,b,n,S,E),s=-1,o=-1,i=b.length-1;-1!==i;--i)(r=b[i])<=n||(a=w(v[r]))>s&&(o=r,s=a);for(w(v[n])<e*s&&(i=T[n],T[n]=s=T[o],S[s]=n,T[o]=i,S[i]=o,s=v[n],v[n]=v[o],v[o]=s),o=m[n],u=v[n],f[s=d[n]]=T[n],p[s]=1,++s,i=b.length-1;-1!==i;--i)a=v[r=b[i]],b[i]=0,v[r]=0,r<=n?(g[o]=r,y[o]=a,++o):(f[s]=T[r],p[s]=a/u,++s);d[n+1]=s,m[n+1]=o}for(i=f.length-1;-1!==i;--i)f[i]=S[f[i]];return{L:c,U:h,P:T,Pinv:S}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,i,r,s,o){var a,u,l,c=0,h=r.length,d=this.k,f=this.k1,p=this.j;if(0===i[t])for(i[t]=1,p[0]=t,d[0]=u=e[s[t]],f[0]=l=e[s[t]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(r[h]=s[p[c]],0===c)return;++h,u=d[--c],l=f[c]}else 0===i[a=n[u]]?(i[a]=1,d[c]=u,p[++c]=a,u=e[a=s[a]],f[c]=l=e[a+1]):++u}},numeric.ccsLPSolve0=function(t,e,n,i,r,s,o,a){var u,l,c,h,d,f,p,m,g,y=t[0],v=t[1],b=t[2],x=e[0],w=e[1],T=e[2];for(l=x[r],c=x[r+1],i.length=0,u=l;u<c;++u)a.dfs(w[u],y,v,n,i,s,o);for(u=i.length-1;-1!==u;--u)n[o[h=i[u]]]=0;for(u=l;u!==c;++u)n[h=w[u]]=T[u];for(u=i.length-1;-1!==u;--u){for(m=o[h=i[u]],f=y[h+1],p=d=y[h];p<f;++p)if(v[p]===m){n[m]/=b[p];break}for(g=n[m],p=d;p<f;++p)n[v[p]]-=g*b[p];n[m]=g}},numeric.ccsLUP0=function(t,e){var n,i,r,s,o,a,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],d=c[0],f=c[1],p=c[2],m=h[0],g=h[1],y=h[2],v=numeric.rep([l],0),b=numeric.rep([l],0),x=numeric.ccsLPSolve0,w=(Math,Math.abs),T=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),E=new numeric.ccsDFS0(l);for(void 0===e&&(e=1),n=0;n<l;++n){for(x(c,t,v,b,n,S,T,E),s=-1,o=-1,i=b.length-1;-1!==i;--i)(r=b[i])<=n||(a=w(v[T[r]]))>s&&(o=r,s=a);for(w(v[T[n]])<e*s&&(i=T[n],T[n]=s=T[o],S[s]=n,T[o]=i,S[i]=o),o=m[n],u=v[T[n]],f[s=d[n]]=T[n],p[s]=1,++s,i=b.length-1;-1!==i;--i)a=v[T[r=b[i]]],b[i]=0,v[T[r]]=0,r<=n?(g[o]=r,y[o]=a,++o):(f[s]=T[r],p[s]=a/u,++s);d[n+1]=s,m[n+1]=o}for(i=f.length-1;-1!==i;--i)f[i]=S[f[i]];return{L:c,U:h,P:T,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var i=numeric.ccsDim(t),r=i[0],s=i[1];void 0===e?e=numeric.linspace(0,r-1):"number"==typeof e&&(e=[e]),void 0===n?n=numeric.linspace(0,s-1):"number"==typeof n&&(n=[n]);var o,a,u,l,c=e.length,h=n.length,d=numeric.rep([s],0),f=[],p=[],m=[d,f,p],g=t[0],y=t[1],v=t[2],b=numeric.rep([r],0),x=0,w=numeric.rep([r],0);for(a=0;a<h;++a){var T=g[l=n[a]],S=g[l+1];for(o=T;o<S;++o)w[u=y[o]]=1,b[u]=v[o];for(o=0;o<c;++o)w[e[o]]&&(f[x]=o,p[x]=b[e[o]],++x);for(o=T;o<S;++o)w[u=y[o]]=0;d[a+1]=x}return m},numeric.ccsDot=function(t,e){var n,i,r,s,o,a,u,l,c,h,d=t[0],f=t[1],p=t[2],m=e[0],g=e[1],y=e[2],v=numeric.ccsDim(t),b=numeric.ccsDim(e),x=v[0],w=b[1],T=numeric.rep([x],0),S=numeric.rep([x],0),E=Array(x),O=numeric.rep([w],0),C=[],_=[],A=[O,C,_];for(r=0;r!==w;++r){for(o=m[r+1],l=0,i=m[r];i<o;++i)for(h=y[i],a=d[(c=g[i])+1],n=d[c];n<a;++n)0===S[u=f[n]]&&(E[l]=u,S[u]=1,l+=1),T[u]=T[u]+p[n]*h;for(O[r+1]=o=(s=O[r])+l,i=l-1;-1!==i;--i)C[h=s+i]=n=E[i],_[h]=T[n],S[n]=0,T[n]=0;O[r+1]=O[r]+l}return A},numeric.ccsLUPSolve=function(t,e){var n=t.L,i=t.U,r=e[0],s=!1;"object"!=typeof r&&(r=(e=[[0,e.length],numeric.linspace(0,e.length-1),e])[0],s=!0);var o,a,u,l,c,h=e[1],d=e[2],f=n[0].length-1,p=r.length-1,m=numeric.rep([f],0),g=Array(f),y=numeric.rep([f],0),v=Array(f),b=numeric.rep([p+1],0),x=[],w=[],T=numeric.ccsTSolve,S=0;for(o=0;o<p;++o){for(l=0,u=r[o+1],a=r[o];a<u;++a)v[l]=c=t.Pinv[h[a]],y[c]=d[a],++l;for(v.length=l,T(n,y,m,v,g),a=v.length-1;-1!==a;--a)y[v[a]]=0;if(T(i,m,y,g,v),s)return y;for(a=g.length-1;-1!==a;--a)m[g[a]]=0;for(a=v.length-1;-1!==a;--a)x[S]=c=v[a],w[S]=y[c],y[c]=0,++S;b[o+1]=S}return[b,x,w]},numeric.ccsbinop=function(t,e){return void 0===e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,n=t[0],i=t[1],r=t[2],s=numeric.sup(i)+1,o=n.length,a=numeric.rep([s],0),u=Array(o),l=Array(o),c=numeric.rep([s],0);for(e=0;e<o;++e)c[i[e]]++;for(e=0;e<s;++e)a[e+1]=a[e]+c[e];var h,d,f=a.slice(0);for(e=0;e<o;++e)u[h=f[d=i[e]]]=n[e],l[h]=r[e],f[d]=f[d]+1;return[a,u,l]},numeric.ccsGather=function(t){var e,n,i,r,s=t[0],o=t[1],a=t[2],u=s.length-1,l=o.length,c=Array(l),h=Array(l),d=Array(l);for(r=0,e=0;e<u;++e)for(i=s[e+1],n=s[e];n!==i;++n)h[r]=e,c[r]=o[n],d[r]=a[n],++r;return[c,h,d]},numeric.sdim=function t(e,n,i){if(void 0===n&&(n=[]),"object"!=typeof e)return n;var r;for(r in void 0===i&&(i=0),i in n||(n[i]=0),e.length>n[i]&&(n[i]=e.length),e)e.hasOwnProperty(r)&&t(e[r],n,i+1);return n},numeric.sclone=function t(e,n,i){void 0===n&&(n=0),void 0===i&&(i=numeric.sdim(e).length);var r,s=Array(e.length);if(n===i-1){for(r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);return s}for(r in e)e.hasOwnProperty(r)&&(s[r]=t(e[r],n+1,i));return s},numeric.sdiag=function(t){var e,n,i=t.length,r=Array(i);for(e=i-1;e>=1;e-=2)n=e-1,r[e]=[],r[e][e]=t[e],r[n]=[],r[n][n]=t[n];return 0===e&&(r[0]=[],r[0][0]=t[e]),r},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,n,i,r=[];for(e in t)if(t.hasOwnProperty(e))for(n in i=t[e])i.hasOwnProperty(n)&&("object"!=typeof r[n]&&(r[n]=[]),r[n][e]=i[n]);return r},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n,i,r,s,o,a,u,l=t.length,c=numeric.stranspose(e),h=c.length,d=Array(l);for(r=l-1;r>=0;r--){for(u=[],n=t[r],o=h-1;o>=0;o--){for(s in a=0,i=c[o],n)n.hasOwnProperty(s)&&s in i&&(a+=n[s]*i[s]);a&&(u[o]=a)}d[r]=u}return d},numeric.sdotMV=function(t,e){var n,i,r,s,o=t.length,a=Array(o);for(i=o-1;i>=0;i--){for(r in s=0,n=t[i])n.hasOwnProperty(r)&&e[r]&&(s+=n[r]*e[r]);s&&(a[i]=s)}return a},numeric.sdotVM=function(t,e){var n,i,r,s,o=[];for(n in t)if(t.hasOwnProperty(n))for(i in s=t[n],r=e[n])r.hasOwnProperty(i)&&(o[i]||(o[i]=0),o[i]+=s*r[i]);return o},numeric.sdotVV=function(t,e){var n,i=0;for(n in t)t[n]&&e[n]&&(i+=t[n]*e[n]);return i},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,i=numeric.sdim(e).length;switch(1e3*n+i){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+i)}},numeric.sscatter=function(t){var e,n,i,r,s=t.length,o=[];for(n=t[0].length-1;n>=0;--n)if(t[s-1][n]){for(r=o,i=0;i<s-2;i++)r[e=t[i][n]]||(r[e]=[]),r=r[e];r[t[i][n]]=t[i+1][n]}return o},numeric.sgather=function t(e,n,i){var r,s,o;for(s in void 0===n&&(n=[]),void 0===i&&(i=[]),r=i.length,e)if(e.hasOwnProperty(s))if(i[r]=parseInt(s),"number"==typeof(o=e[s])){if(o){if(0===n.length)for(s=r+1;s>=0;--s)n[s]=[];for(s=r;s>=0;--s)n[s].push(i[s]);n[r+1].push(o)}}else t(o,n,i);return i.length>r&&i.pop(),n},numeric.cLU=function(t){var e,n,i,r,s,o,a=t[0],u=t[1],l=t[2],c=a.length,h=0;for(e=0;e<c;e++)a[e]>h&&(h=a[e]);h++;var d,f=Array(h),p=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(i=0;i<c;i++)(n=u[i])<m[e=a[i]]&&(m[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<h;e++)p[e]=numeric.rep([g[e]-m[e]+1],0),f[e]=numeric.rep([e-m[e]],0);for(i=0;i<c;i++)p[e=a[i]][u[i]-m[e]]=l[i];for(e=0;e<h-1;e++)for(r=e-m[e],b=p[e],n=e+1;m[n]<=e&&n<h;n++)if(o=g[e]-e,d=(x=p[n])[s=e-m[n]]/b[r]){for(i=1;i<=o;i++)x[i+s]-=d*b[i+r];f[n][e-m[n]]=d}var y,v,b=[],x=[],w=[],T=[],S=[],E=[];for(c=0,y=0,e=0;e<h;e++){for(r=m[e],s=g[e],v=p[e],n=e;n<=s;n++)v[n-r]&&(b[c]=e,x[c]=n,w[c]=v[n-r],c++);for(v=f[e],n=r;n<e;n++)v[n-r]&&(T[y]=e,S[y]=n,E[y]=v[n-r],y++);T[y]=e,S[y]=e,E[y]=1,y++}return{U:[b,x,w],L:[T,S,E]}},numeric.cLUsolve=function(t,e){var n,i,r=t.L,s=t.U,o=numeric.clone(e),a=r[1],u=r[2],l=s[1],c=s[2],h=s[0].length,d=o.length;for(i=0,n=0;n<d;n++){for(;a[i]<n;)o[n]-=u[i]*o[a[i]],i++;i++}for(i=h-1,n=d-1;n>=0;n--){for(;l[i]>n;)o[n]-=c[i]*o[l[i]],i--;o[n]/=c[i],i--}return o},numeric.cgrid=function(t,e){"number"==typeof t&&(t=[t,t]);var n,i,r,s=numeric.rep(t,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=t[0]/2||n<t[1]/2};break;default:e=function(t,e){return!0}}for(r=0,n=1;n<t[0]-1;n++)for(i=1;i<t[1]-1;i++)e(n,i)&&(s[n][i]=r,r++);return s},numeric.cdelsq=function(t){var e,n,i,r,s,o=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(t),u=a[0],l=a[1],c=[],h=[],d=[];for(e=1;e<u-1;e++)for(n=1;n<l-1;n++)if(!(t[e][n]<0)){for(i=0;i<4;i++)t[r=e+o[i][0]][s=n+o[i][1]]<0||(c.push(t[e][n]),h.push(t[r][s]),d.push(-1));c.push(t[e][n]),h.push(t[e][n]),d.push(4)}return[c,h,d]},numeric.cdotMV=function(t,e){var n,i,r,s=t[0],o=t[1],a=t[2],u=s.length;for(r=0,i=0;i<u;i++)s[i]>r&&(r=s[i]);for(r++,n=numeric.rep([r],0),i=0;i<u;i++)n[s[i]]+=a[i]*e[o[i]];return n},numeric.Spline=function(t,e,n,i,r){this.x=t,this.yl=e,this.yr=n,this.kl=i,this.kr=r},numeric.Spline.prototype._at=function(t,e){var n,i,r,s=this.x,o=this.yl,a=this.yr,u=this.kr,l=numeric.add,c=numeric.sub,h=numeric.mul;n=c(h(this.kl[e],s[e+1]-s[e]),c(a[e+1],o[e])),i=l(h(u[e+1],s[e]-s[e+1]),c(a[e+1],o[e]));var d=(r=(t-s[e])/(s[e+1]-s[e]))*(1-r);return l(l(l(h(1-r,o[e]),h(r,a[e+1])),h(n,d*(1-r))),h(i,d*r))},numeric.Spline.prototype.at=function(t){if("number"==typeof t){var e,n,i,r=this.x,s=r.length,o=Math.floor;for(e=0,n=s-1;n-e>1;)r[i=o((e+n)/2)]<=t?e=i:n=i;return this._at(t,e)}s=t.length;var a,u=Array(s);for(a=s-1;-1!==a;--a)u[a]=this.at(t[a]);return u},numeric.Spline.prototype.diff=function(){var t,e,n,i=this.x,r=this.yl,s=this.yr,o=this.kl,a=this.kr,u=r.length,l=o,c=a,h=Array(u),d=Array(u),f=numeric.add,p=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=i[t+1]-i[t],n=g(s[t+1],r[t]),h[t]=m(f(p(n,6),p(o[t],-4*e),p(a[t+1],-2*e)),e*e),d[t+1]=m(f(p(n,-6),p(o[t],2*e),p(a[t+1],4*e)),e*e);return new numeric.Spline(i,l,c,h,d)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],n=this.x,i=this.yl,r=this.yr,s=this.kl,o=this.kr;"number"==typeof i[0]&&(i=[i],r=[r],s=[s],o=[o]);var a,u,l,c,h,d,f,p,m,g,y,v,b,x,w,T,S,E,O,C,_,A,k,R=i.length,I=n.length-1,M=(e=Array(R),Math.sqrt);for(a=0;a!==R;++a){for(c=i[a],h=r[a],d=s[a],f=o[a],p=[],u=0;u!==I;u++){for(u>0&&h[u]*c[u]<0&&p.push(n[u]),b=(g=f[u+1]/(T=n[u+1]-n[u]))+3*(y=c[u])+2*(m=d[u]/T)-3*(v=h[u+1]),x=3*(g+m+2*(y-v)),(w=t(m-g+3*(y-v))+12*g*y)<=0?S=(E=b/x)>n[u]&&E<n[u+1]?[n[u],E,n[u+1]]:[n[u],n[u+1]]:(E=(b-M(w))/x,O=(b+M(w))/x,S=[n[u]],E>n[u]&&E<n[u+1]&&S.push(E),O>n[u]&&O<n[u+1]&&S.push(O),S.push(n[u+1])),E=this._at(_=S[0],u),l=0;l<S.length-1;l++)if(O=this._at(A=S[l+1],u),0!==E)if(0===O||E*O>0)_=A,E=O;else{for(var N=0;!((k=(E*A-O*_)/(E-O))<=_||k>=A);)if((C=this._at(k,u))*O>0)A=k,O=C,-1===N&&(E*=.5),N=-1;else{if(!(C*E>0))break;_=k,E=C,1===N&&(O*=.5),N=1}p.push(k),E=this._at(_=S[l+1],u)}else p.push(_),_=A,E=O;0===O&&p.push(A)}e[a]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,n,i){var r,s=t.length,o=[],a=[],u=[],l=numeric.sub,c=numeric.mul,h=numeric.add;for(r=s-2;r>=0;r--)a[r]=t[r+1]-t[r],u[r]=l(e[r+1],e[r]);"string"!=typeof n&&"string"!=typeof i||(n=i="periodic");var d=[[],[],[]];switch(typeof n){case"undefined":o[0]=c(3/(a[0]*a[0]),u[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/a[0],1/a[0]);break;case"string":o[0]=h(c(3/(a[s-2]*a[s-2]),u[s-2]),c(3/(a[0]*a[0]),u[0])),d[0].push(0,0,0),d[1].push(s-2,0,1),d[2].push(1/a[s-2],2/a[s-2]+2/a[0],1/a[0]);break;default:o[0]=n,d[0].push(0),d[1].push(0),d[2].push(1)}for(r=1;r<s-1;r++)o[r]=h(c(3/(a[r-1]*a[r-1]),u[r-1]),c(3/(a[r]*a[r]),u[r])),d[0].push(r,r,r),d[1].push(r-1,r,r+1),d[2].push(1/a[r-1],2/a[r-1]+2/a[r],1/a[r]);switch(typeof i){case"undefined":o[s-1]=c(3/(a[s-2]*a[s-2]),u[s-2]),d[0].push(s-1,s-1),d[1].push(s-2,s-1),d[2].push(1/a[s-2],2/a[s-2]);break;case"string":d[1][d[1].length-1]=0;break;default:o[s-1]=i,d[0].push(s-1),d[1].push(s-1),d[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var f=Array(o.length);if("string"==typeof n)for(r=f.length-1;-1!==r;--r)f[r]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),o[r]),f[r][s-1]=f[r][0];else for(r=f.length-1;-1!==r;--r)f[r]=numeric.cLUsolve(numeric.cLU(d),o[r]);return f="number"==typeof e[0]?f[0]:numeric.transpose(f),new numeric.Spline(t,e,e,f,f)},numeric.fftpow2=function t(e,n){var i=e.length;if(1!==i){var r,s,o=Math.cos,a=Math.sin,u=Array(i/2),l=Array(i/2),c=Array(i/2),h=Array(i/2);for(s=i/2,r=i-1;-1!==r;--r)c[--s]=e[r],h[s]=n[r],--r,u[s]=e[r],l[s]=n[r];t(u,l),t(c,h),s=i/2;var d,f,p,m=-6.283185307179586/i;for(r=i-1;-1!==r;--r)-1==--s&&(s=i/2-1),f=o(d=m*r),p=a(d),e[r]=u[s]+f*c[s]-p*h[s],n[r]=l[s]+f*h[s]+p*c[s]}},numeric._ifftpow2=function t(e,n){var i=e.length;if(1!==i){var r,s,o=Math.cos,a=Math.sin,u=Array(i/2),l=Array(i/2),c=Array(i/2),h=Array(i/2);for(s=i/2,r=i-1;-1!==r;--r)c[--s]=e[r],h[s]=n[r],--r,u[s]=e[r],l[s]=n[r];t(u,l),t(c,h),s=i/2;var d,f,p,m=6.283185307179586/i;for(r=i-1;-1!==r;--r)-1==--s&&(s=i/2-1),f=o(d=m*r),p=a(d),e[r]=u[s]+f*c[s]-p*h[s],n[r]=l[s]+f*h[s]+p*c[s]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,i){var r,s,o,a,u;for(numeric.fftpow2(t,e),numeric.fftpow2(n,i),r=t.length-1;-1!==r;--r)t[r]=(s=t[r])*(o=n[r])-(a=e[r])*(u=i[r]),e[r]=s*u+a*o;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,n=this.x,i=this.y,r=n.length,s=Math.log,o=s(2),a=Math.ceil(s(2*r-1)/o),u=Math.pow(2,a),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,d=Math.sin,f=-3.141592653589793/r,p=numeric.rep([u],0),m=numeric.rep([u],0);for(Math.floor(r/2),t=0;t<r;t++)p[t]=n[t];if(void 0!==i)for(t=0;t<r;t++)m[t]=i[t];for(l[0]=1,t=1;t<=u/2;t++)l[t]=h(e=f*t*t),c[t]=d(e),l[u-t]=h(e),c[u-t]=d(e);var g=new numeric.T(p,m),y=new numeric.T(l,c);return g=g.mul(y),numeric.convpow2(g.x,g.y,numeric.clone(y.x),numeric.neg(y.y)),(g=g.mul(y)).x.length=r,g.y.length=r,g},numeric.T.prototype.ifft=function(){var t,e,n=this.x,i=this.y,r=n.length,s=Math.log,o=s(2),a=Math.ceil(s(2*r-1)/o),u=Math.pow(2,a),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,d=Math.sin,f=3.141592653589793/r,p=numeric.rep([u],0),m=numeric.rep([u],0);for(Math.floor(r/2),t=0;t<r;t++)p[t]=n[t];if(void 0!==i)for(t=0;t<r;t++)m[t]=i[t];for(l[0]=1,t=1;t<=u/2;t++)l[t]=h(e=f*t*t),c[t]=d(e),l[u-t]=h(e),c[u-t]=d(e);var g=new numeric.T(p,m),y=new numeric.T(l,c);return g=g.mul(y),numeric.convpow2(g.x,g.y,numeric.clone(y.x),numeric.neg(y.y)),(g=g.mul(y)).x.length=r,g.y.length=r,g.div(r)},numeric.gradient=function(t,e){var n=e.length,i=t(e);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var r,s,o,a,u,l,c,h,d,f=Math.max,p=numeric.clone(e),m=Array(n),g=(f=Math.max,Math.abs),y=Math.min,v=0;for(r=0;r<n;r++)for(var b=f(1e-6*i,1e-8);;){if(++v>20)throw new Error("Numerical gradient fails");if(p[r]=e[r]+b,s=t(p),p[r]=e[r]-b,o=t(p),p[r]=e[r],isNaN(s)||isNaN(o))b/=16;else{if(m[r]=(s-o)/(2*b),a=e[r]-b,u=e[r],l=e[r]+b,c=(s-i)/b,h=(i-o)/b,d=f(g(m[r]),g(i),g(s),g(o),g(a),g(u),g(l),1e-8),!(y(f(g(c-m[r]),g(h-m[r]),g(c-h))/d,b/d)>.001))break;b/=16}}return m},numeric.uncmin=function(t,e,n,i,r,s,o){var a=numeric.gradient;void 0===o&&(o={}),void 0===n&&(n=1e-8),void 0===i&&(i=function(e){return a(t,e)}),void 0===r&&(r=1e3);var u,l,c=(e=numeric.clone(e)).length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,f=numeric.norm2;n=d(n,numeric.epsilon);var p,m,g,y,v,b,x,w,T,S,E=o.Hinv||numeric.identity(c),O=numeric.dot,C=numeric.sub,_=numeric.add,A=numeric.tensor,k=numeric.div,R=numeric.mul,I=numeric.all,M=numeric.isFinite,N=numeric.neg,D=0,P="";for(m=i(e);D<r;){if("function"==typeof s&&s(D,e,h,m,E)){P="Callback returned true";break}if(!I(M(m))){P="Gradient has Infinity or NaN";break}if(!I(M(p=N(O(E,m))))){P="Search direction has Infinity or NaN";break}if((S=f(p))<n){P="Newton step smaller than tol";break}for(T=1,l=O(m,p),v=e;D<r&&!(T*S<n)&&(v=_(e,y=R(p,T)),(u=t(v))-h>=.1*T*l||isNaN(u));)T*=.5,++D;if(T*S<n){P="Line search step size smaller than tol";break}if(D===r){P="maxit reached during line search";break}w=O(b=C(g=i(v),m),y),x=O(E,b),E=C(_(E,R((w+O(b,x))/(w*w),A(y,y))),k(_(A(x,y),A(y,x)),w)),e=v,h=u,m=g,++D}return{solution:e,f:h,gradient:m,invHessian:E,iterations:D,message:P}},numeric.Dopri=function(t,e,n,i,r,s,o){this.x=t,this.y=e,this.f=n,this.ymid=i,this.iterations=r,this.events=o,this.message=s},numeric.Dopri.prototype._at=function(t,e){function n(t){return t*t}var i,r,s,o,a,u,l,c,h,d=this,f=d.x,p=d.y,m=d.f,g=(Math,numeric.add),y=numeric.mul,v=numeric.sub;return a=p[e+1],u=d.ymid[e],l=v(m[e],y(o=p[e],1/((i=f[e])-(s=i+.5*((r=f[e+1])-i)))+2/(i-r))),c=v(m[e+1],y(a,1/(r-s)+2/(r-i))),g(g(g(g(y(o,(h=[n(t-r)*(t-s)/n(i-r)/(i-s),n(t-i)*n(t-r)/n(i-s)/n(r-s),n(t-i)*(t-s)/n(r-i)/(r-s),(t-i)*n(t-r)*(t-s)/n(i-r)/(i-s),(t-r)*n(t-i)*(t-s)/n(i-r)/(r-s)])[0]),y(u,h[1])),y(a,h[2])),y(l,h[3])),y(c,h[4]))},numeric.Dopri.prototype.at=function(t){var e,n,i,r=Math.floor;if("number"!=typeof t){var s=t.length,o=Array(s);for(e=s-1;-1!==e;--e)o[e]=this.at(t[e]);return o}var a=this.x;for(e=0,n=a.length-1;n-e>1;)a[i=r(.5*(e+n))]<=t?e=i:n=i;return this._at(t,e)},numeric.dopri=function(t,e,n,i,r,s,o){void 0===r&&(r=1e-6),void 0===s&&(s=1e3);var a,u,l,c,h,d,f,p,m,g,y,v,b,x=[t],w=[n],T=[i(t,n)],S=[],E=[3/40,9/40],O=[44/45,-56/15,32/9],C=[19372/6561,-25360/2187,64448/6561,-212/729],_=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],A=[35/384,0,500/1113,125/192,-2187/6784,11/84],k=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],R=[.2,.3,.8,8/9,1,1],I=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],M=0,N=(e-t)/10,D=0,P=numeric.add,F=numeric.mul,L=(Math,Math.min),j=Math.abs,B=numeric.norminf,z=Math.pow,$=numeric.any,U=numeric.lt,W=numeric.and,V=new numeric.Dopri(x,w,T,S,-1,"");for("function"==typeof o&&(y=o(t,n));t<e&&D<s;)if(++D,t+N>e&&(N=e-t),a=i(t+R[0]*N,P(n,F(.2*N,T[M]))),u=i(t+R[1]*N,P(P(n,F(E[0]*N,T[M])),F(E[1]*N,a))),l=i(t+R[2]*N,P(P(P(n,F(O[0]*N,T[M])),F(O[1]*N,a)),F(O[2]*N,u))),c=i(t+R[3]*N,P(P(P(P(n,F(C[0]*N,T[M])),F(C[1]*N,a)),F(C[2]*N,u)),F(C[3]*N,l))),h=i(t+R[4]*N,P(P(P(P(P(n,F(_[0]*N,T[M])),F(_[1]*N,a)),F(_[2]*N,u)),F(_[3]*N,l)),F(_[4]*N,c))),d=i(t+N,m=P(P(P(P(P(n,F(T[M],N*A[0])),F(u,N*A[2])),F(l,N*A[3])),F(c,N*A[4])),F(h,N*A[5]))),(g="number"==typeof(f=P(P(P(P(P(F(T[M],N*I[0]),F(u,N*I[2])),F(l,N*I[3])),F(c,N*I[4])),F(h,N*I[5])),F(d,N*I[6])))?j(f):B(f))>r){if(t+(N=.2*N*z(r/g,.25))===t){V.msg="Step size became too small";break}}else{if(S[M]=P(P(P(P(P(P(n,F(T[M],N*k[0])),F(u,N*k[2])),F(l,N*k[3])),F(c,N*k[4])),F(h,N*k[5])),F(d,N*k[6])),x[++M]=t+N,w[M]=m,T[M]=d,"function"==typeof o){var Y,G,X=t,H=t+.5*N;if(v=o(H,S[M-1]),$(b=W(U(y,0),U(0,v)))||(X=H,y=v,v=o(H=t+N,m),b=W(U(y,0),U(0,v))),$(b)){for(var q,K,J=0,Q=1,Z=1;;){if("number"==typeof y)G=(Z*v*X-Q*y*H)/(Z*v-Q*y);else for(G=H,p=y.length-1;-1!==p;--p)y[p]<0&&v[p]>0&&(G=L(G,(Z*v[p]*X-Q*y[p]*H)/(Z*v[p]-Q*y[p])));if(G<=X||G>=H)break;K=o(G,Y=V._at(G,M-1)),$(q=W(U(y,0),U(0,K)))?(H=G,v=K,b=q,Z=1,-1===J?Q*=.5:Q=1,J=-1):(X=G,y=K,Q=1,1===J?Z*=.5:Z=1,J=1)}return m=V._at(.5*(t+G),M-1),V.f[M]=i(G,Y),V.x[M]=G,V.y[M]=Y,V.ymid[M-1]=m,V.events=b,V.iterations=D,V}}t+=N,n=m,y=v,N=L(.8*N*z(r/g,.25),4*N)}return V.iterations=D,V},numeric.LU=function(t,e){e=e||!1;var n,i,r,s,o,a,u,l,c,h=Math.abs,d=t.length,f=d-1,p=new Array(d);for(e||(t=numeric.clone(t)),r=0;r<d;++r){for(u=r,c=h((a=t[r])[r]),i=r+1;i<d;++i)c<(s=h(t[i][r]))&&(c=s,u=i);for(p[r]=u,u!=r&&(t[r]=t[u],t[u]=a,a=t[r]),o=a[r],n=r+1;n<d;++n)t[n][r]/=o;for(n=r+1;n<d;++n){for(l=t[n],i=r+1;i<f;++i)l[i]-=l[r]*a[i],l[++i]-=l[r]*a[i];i===f&&(l[i]-=l[r]*a[i])}}return{LU:t,P:p}},numeric.LUsolve=function(t,e){var n,i,r,s,o,a=t.LU,u=a.length,l=numeric.clone(e),c=t.P;for(n=u-1;-1!==n;--n)l[n]=e[n];for(n=0;n<u;++n)for(r=c[n],c[n]!==n&&(o=l[n],l[n]=l[r],l[r]=o),s=a[n],i=0;i<n;++i)l[n]-=l[i]*s[i];for(n=u-1;n>=0;--n){for(s=a[n],i=n+1;i<u;++i)l[n]-=l[i]*s[i];l[n]/=s[n]}return l},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e,n,i,r,s,o,a,u,l=numeric.dim(t),c=l[0],h=l[1],d=numeric.identity(c),f=Array(c),p=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<c;++e){for(i=0,s=t[e],o=d[e],n=1;n<h;++n)p(s[i])<p(s[n])&&(i=n);for(f[e]=i,m(o,s[i]),m(s,s[i]),n=0;n<c;++n)if(n!==e){for(u=(a=t[n])[i],r=h-1;-1!==r;--r)a[r]-=s[r]*u;for(a=d[n],r=c-1;-1!==r;--r)a[r]-=o[r]*u}}return{I:d,A:t,P:f}},numeric.__solveLP=function(t,e,n,i,r,s,o){var a,u,l,c,h=numeric.sum,d=numeric.mul,f=numeric.sub,p=numeric.dot,m=numeric.div,g=numeric.add,y=t.length,v=n.length,b=!1,x=1,w=(numeric.transpose(e),numeric.transpose),T=Math.sqrt,S=Math.abs,E=Math.min,O=numeric.all,C=numeric.gt,_=Array(y),A=Array(v),k=(numeric.rep([v],1),numeric.solve),R=f(n,p(e,s)),I=p(t,t);for(l=0;l<r;++l){var M,N;for(M=v-1;-1!==M;--M)A[M]=m(e[M],R[M]);var D=w(A);for(M=y-1;-1!==M;--M)_[M]=h(D[M]);x=.25*S(I/p(t,_));var P=100*T(I/p(_,_));for((!isFinite(x)||x>P)&&(x=P),c=g(t,d(x,_)),u=p(D,A),M=y-1;-1!==M;--M)u[M][M]+=1;N=k(u,m(c,x),!0);var F=m(R,p(e,N)),L=1;for(M=v-1;-1!==M;--M)F[M]<0&&(L=E(L,-.999*F[M]));if(a=f(s,d(N,L)),!O(C(R=f(n,p(e,a)),0)))return{solution:s,message:"",iterations:l};if(s=a,x<i)return{solution:a,message:"",iterations:l};if(o){var j=p(t,c),B=p(e,c);for(b=!0,M=v-1;-1!==M;--M)if(j*B[M]<0){b=!1;break}}else b=!(s[y-1]>=0);if(b)return{solution:a,message:"Unbounded",iterations:l}}return{solution:s,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(t,e,n,i,r){var s=t.length,o=n.length,a=numeric.sub,u=numeric.dot,l=numeric.rep([s],0).concat([1]),c=numeric.rep([o,1],-1),h=numeric.blockMatrix([[e,c]]),d=n,f=numeric.rep([s],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(l,h,d,i,r,f,!1),m=numeric.clone(p.solution);if(m.length=s,numeric.inf(a(n,u(e,m)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(t,e,n,i,r-p.iterations,m,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(t,e,n,i,r,s,o){if(void 0===o&&(o=1e3),void 0===s&&(s=numeric.epsilon),void 0===i)return numeric._solveLP(t,e,n,s,o);var a,u=i.length,l=i[0].length,c=e.length,h=numeric.echelonize(i),d=numeric.rep([l],0),f=h.P,p=[];for(a=f.length-1;-1!==a;--a)d[f[a]]=1;for(a=l-1;-1!==a;--a)0===d[a]&&p.push(a);var m=numeric.getRange,g=numeric.linspace(0,u-1),y=numeric.linspace(0,c-1),v=m(i,g,p),b=m(e,y,f),x=m(e,y,p),w=numeric.dot,T=numeric.sub,S=w(b,h.I),E=T(x,w(S,v)),O=T(n,w(S,r)),C=Array(f.length),_=Array(p.length);for(a=f.length-1;-1!==a;--a)C[a]=t[f[a]];for(a=p.length-1;-1!==a;--a)_[a]=t[p[a]];var A=T(_,w(C,w(h.I,v))),k=numeric._solveLP(A,E,O,s,o),R=k.solution;if(R!=R)return k;var I=w(h.I,T(r,w(v,R))),M=Array(t.length);for(a=f.length-1;-1!==a;--a)M[f[a]]=I[a];for(a=p.length-1;-1!==a;--a)M[p[a]]=R[a];return{solution:M,message:k.message,iterations:k.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,n,i,r,s=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=t.length,u=0,l={},c=[],h=0,d={},f=0,p=[],m=[],g=[];function y(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+t[e]+"\nCurrent state: "+o[s]+"\n")}for(e=0;e<a;++e){var v=(i=t[e]).match(/\S*/g),b=[];for(n=0;n<v.length;++n)""!==v[n]&&b.push(v[n]);if(0!==b.length){for(n=0;n<o.length&&i.substr(0,o[n].length)!==o[n];++n);if(n<o.length){if(s=n,1===n&&(r=b[1]),6===n)return{name:r,c:p,A:numeric.transpose(m),b:g,rows:l,vars:d}}else switch(s){case 0:case 1:y("Unexpected line");case 2:switch(b[0]){case"N":0===u?u=b[1]:y("Two or more N rows");break;case"L":l[b[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":l[b[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":l[b[1]]=h,c[h]=0,g[h]=0,++h;break;default:y("Parse error "+numeric.prettyPrint(b))}break;case 3:d.hasOwnProperty(b[0])||(d[b[0]]=f,p[f]=0,m[f]=numeric.rep([h],0),++f);var x=d[b[0]];for(n=1;n<b.length;n+=2)if(b[n]!==u){var w=l[b[n]];m[x][w]=(c[w]<0?-1:1)*parseFloat(b[n+1])}else p[x]=parseFloat(b[n+1]);break;case 4:for(n=1;n<b.length;n+=2)g[l[b[n]]]=(c[l[b[n]]]<0?-1:1)*parseFloat(b[n+1]);break;case 5:break;case 6:y("Internal error")}}}y("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,n,i,r,s,o){function a(t){var e,i=this,r=t.length,s=0,o=i.i=i.j=i.m=0;for(i.S=[],i.c=[],r||(t=[r++]);s<n;)i.S[s]=s++;for(s=0;s<n;s++)o=c(o+(e=i.S[s])+t[s%r]),i.S[s]=i.S[o],i.S[o]=e;i.g=function(t){var e=i.S,r=c(i.i+1),s=e[r],o=c(i.j+s),a=e[o];e[r]=a,e[o]=s;for(var u=e[c(s+a)];--t;)r=c(r+1),o=c(o+(s=e[r])),e[r]=a=e[o],e[o]=s,u=u*n+e[c(s+a)];return i.i=r,i.j=o,u},i.g(n)}function u(t,e,n,i,r){if(n=[],r=typeof t,e&&"object"==r)for(i in t)if(i.indexOf("S")<5)try{n.push(u(t[i],e-1))}catch(s){}return n.length?n:t+("string"!=r?"\0":"")}function l(t,e,n,i){for(t+="",n=0,i=0;i<t.length;i++)e[c(i)]=c((n^=19*e[c(i)])+t.charCodeAt(i));for(i in t="",e)t+=String.fromCharCode(e[i]);return t}function c(t){return 255&t}e.seedrandom=function(i,c){var h,d=[];return i=l(u(c?[i,t]:arguments.length?i:[(new Date).getTime(),t,window],3),d),l((h=new a(d)).S,t),e.random=function(){for(var t=h.g(6),e=o,i=0;t<r;)t=(t+i)*n,e*=n,i=h.g(1);for(;t>=s;)t/=2,e/=2,i>>>=1;return(t+i)/e},i},o=e.pow(n,6),r=e.pow(2,r),s=2*r,l(e.random(),t)}([],numeric.seedrandom,256,0,52),function(t){function e(t){if("object"!=typeof t)return t;var n,i=[],r=t.length;for(n=0;n<r;n++)i[n+1]=e(t[n]);return i}function n(t){if("object"!=typeof t)return t;var e,i=[],r=t.length;for(e=1;e<r;e++)i[e-1]=n(t[e]);return i}t.solveQP=function(t,i,r,s,o,a){t=e(t),i=e(i),r=e(r);var u,l,c,h,d,f=[],p=[],m=[],g=[],y=[];if(o=o||0,a=a?e(a):[void 0,0],s=s?e(s):[],l=t.length-1,c=r[1].length-1,!s)for(u=1;u<=c;u+=1)s[u]=0;for(u=1;u<=c;u+=1)p[u]=0;for(h=Math.min(l,c),u=1;u<=l;u+=1)m[u]=0;for(f[1]=0,u=1;u<=2*l+h*(h+5)/2+2*c+1;u+=1)g[u]=0;for(u=1;u<=2;u+=1)y[u]=0;return function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p,m){var g,y,v,b,x,w,T,S,E,O,C,_,A,k,R,I,M,N,D,P,F,L,j,B,z,$,U;A=Math.min(i,l),v=2*i+A*(A+5)/2+2*l+1,B=1e-60;do{z=1+.1*(B+=B),$=1+.2*B}while(z<=1||$<=1);for(g=1;g<=i;g+=1)p[g]=e[g];for(g=i+1;g<=v;g+=1)p[g]=0;for(g=1;g<=l;g+=1)h[g]=0;if(x=[],0===m[1]){if(function(t,e,n,i){var r,s,o,a,u,l;for(s=1;s<=n;s+=1){if(i[1]=s,l=0,(o=s-1)<1){if((l=t[s][s]-l)<=0)break;t[s][s]=Math.sqrt(l)}else{for(a=1;a<=o;a+=1){for(u=t[a][s],r=1;r<a;r+=1)u-=t[r][s]*t[r][a];t[a][s]=u/=t[a][a],l+=u*u}if((l=t[s][s]-l)<=0)break;t[s][s]=Math.sqrt(l)}i[1]=0}}(t,0,i,x),0!==x[1])return void(m[1]=2);!function(t,e,n,i){var r,s,o,a;for(s=1;s<=n;s+=1){for(a=0,r=1;r<s;r+=1)a+=t[r][s]*i[r];i[s]=(i[s]-a)/t[s][s]}for(o=1;o<=n;o+=1)for(i[s=n+1-o]=i[s]/t[s][s],a=-i[s],r=1;r<s;r+=1)i[r]=i[r]+a*t[r][s]}(t,0,i,e),function(t,e,n){var i,r,s,o,a;for(s=1;s<=n;s+=1){for(t[s][s]=1/t[s][s],a=-t[s][s],i=1;i<s;i+=1)t[i][s]=a*t[i][s];if(n<(o=s+1))break;for(r=o;r<=n;r+=1)for(a=t[s][r],t[s][r]=0,i=1;i<=s;i+=1)t[i][r]=t[i][r]+a*t[i][s]}}(t,0,i)}else{for(y=1;y<=i;y+=1)for(r[y]=0,g=1;g<=y;g+=1)r[y]=r[y]+t[g][y]*e[g];for(y=1;y<=i;y+=1)for(e[y]=0,g=y;g<=i;g+=1)e[y]=e[y]+t[y][g]*r[g]}for(s[1]=0,y=1;y<=i;y+=1)for(r[y]=e[y],s[1]=s[1]+p[y]*r[y],p[y]=0,g=y+1;g<=i;g+=1)t[g][y]=0;for(s[1]=-s[1]/2,m[1]=0,k=(O=(E=(C=(S=(T=i)+i)+A)+A+1)+A*(A+1)/2)+l,g=1;g<=l;g+=1){for(I=0,y=1;y<=i;y+=1)I+=o[y][g]*o[y][g];p[k+g]=Math.sqrt(I)}function W(){for(f[1]=f[1]+1,v=O,g=1;g<=l;g+=1){for(v+=1,I=-a[g],y=1;y<=i;y+=1)I+=o[y][g]*r[y];if(Math.abs(I)<B&&(I=0),g>c)p[v]=I;else if(p[v]=-Math.abs(I),I>0){for(y=1;y<=i;y+=1)o[y][g]=-o[y][g];a[g]=-a[g]}}for(g=1;g<=d;g+=1)p[O+h[g]]=0;for(_=0,R=0,g=1;g<=l;g+=1)p[O+g]<R*p[k+g]&&(_=g,R=p[O+g]/p[k+g]);return 0===_?999:0}function V(){for(g=1;g<=i;g+=1){for(I=0,y=1;y<=i;y+=1)I+=t[y][g]*o[y][_];p[g]=I}for(b=T,g=1;g<=i;g+=1)p[b+g]=0;for(y=d+1;y<=i;y+=1)for(g=1;g<=i;g+=1)p[b+g]=p[b+g]+t[g][y]*p[y];for(L=!0,g=d;g>=1;g-=1){for(I=p[g],b=(v=E+g*(g+3)/2)-g,y=g+1;y<=d;y+=1)I-=p[v]*p[S+y],v+=y;if(p[S+g]=I/=p[b],h[g]<c)break;if(I<0)break;L=!1,w=g}if(!L)for(M=p[C+w]/p[S+w],g=1;g<=d&&!(h[g]<c)&&!(p[S+g]<0);g+=1)(R=p[C+g]/p[S+g])<M&&(M=R,w=g);for(I=0,g=T+1;g<=T+i;g+=1)I+=p[g]*p[g];if(Math.abs(I)<=B){if(L)return m[1]=1,999;for(g=1;g<=d;g+=1)p[C+g]=p[C+g]-M*p[S+g];return p[C+d+1]=p[C+d+1]+M,700}for(I=0,g=1;g<=i;g+=1)I+=p[T+g]*o[g][_];for(N=-p[O+_]/I,j=!0,L||M<N&&(N=M,j=!1),g=1;g<=i;g+=1)r[g]=r[g]+N*p[T+g],Math.abs(r[g])<B&&(r[g]=0);for(s[1]=s[1]+N*I*(N/2+p[C+d+1]),g=1;g<=d;g+=1)p[C+g]=p[C+g]-N*p[S+g];if(p[C+d+1]=p[C+d+1]+N,!j){for(I=-a[_],y=1;y<=i;y+=1)I+=r[y]*o[y][_];if(_>c)p[O+_]=I;else if(p[O+_]=-Math.abs(I),I>0){for(y=1;y<=i;y+=1)o[y][_]=-o[y][_];a[_]=-a[_]}return 700}for(h[d+=1]=_,v=E+(d-1)*d/2+1,g=1;g<=d-1;g+=1)p[v]=p[g],v+=1;if(d===i)p[v]=p[i];else{for(g=i;g>=d+1&&0!==p[g]&&(D=Math.max(Math.abs(p[g-1]),Math.abs(p[g])),P=Math.min(Math.abs(p[g-1]),Math.abs(p[g])),R=p[g-1]>=0?Math.abs(D*Math.sqrt(1+P*P/(D*D))):-Math.abs(D*Math.sqrt(1+P*P/(D*D))),P=p[g]/R,1!=(D=p[g-1]/R));g-=1)if(0===D)for(p[g-1]=P*R,y=1;y<=i;y+=1)R=t[y][g-1],t[y][g-1]=t[y][g],t[y][g]=R;else for(p[g-1]=R,F=P/(1+D),y=1;y<=i;y+=1)t[y][g]=F*(t[y][g-1]+(R=D*t[y][g-1]+P*t[y][g]))-t[y][g],t[y][g-1]=R;p[v]=p[d]}return 0}function Y(){if(0===p[b=(v=E+w*(w+1)/2+1)+w])return 798;if(D=Math.max(Math.abs(p[b-1]),Math.abs(p[b])),P=Math.min(Math.abs(p[b-1]),Math.abs(p[b])),R=p[b-1]>=0?Math.abs(D*Math.sqrt(1+P*P/(D*D))):-Math.abs(D*Math.sqrt(1+P*P/(D*D))),P=p[b]/R,1==(D=p[b-1]/R))return 798;if(0===D){for(g=w+1;g<=d;g+=1)R=p[b-1],p[b-1]=p[b],p[b]=R,b+=g;for(g=1;g<=i;g+=1)R=t[g][w],t[g][w]=t[g][w+1],t[g][w+1]=R}else{for(F=P/(1+D),g=w+1;g<=d;g+=1)p[b]=F*(p[b-1]+(R=D*p[b-1]+P*p[b]))-p[b],p[b-1]=R,b+=g;for(g=1;g<=i;g+=1)t[g][w+1]=F*(t[g][w]+(R=D*t[g][w]+P*t[g][w+1]))-t[g][w+1],t[g][w]=R}return 0}function G(){for(b=v-w,g=1;g<=w;g+=1)p[b]=p[v],v+=1,b+=1;return p[C+w]=p[C+w+1],h[w]=h[w+1],(w+=1)<d?797:0}function X(){return p[C+d]=p[C+d+1],p[C+d+1]=0,h[d]=0,d-=1,f[2]=f[2]+1,0}for(d=0,f[1]=0,f[2]=0,U=0;;){if(999===(U=W()))return;for(;0!==(U=V());){if(999===U)return;if(700===U)if(w===d)X();else{for(;Y(),797===(U=G()););X()}}}}(t,i,0,l,m,f,r,s,0,c,o,p,0,y,g,a),d="",1===a[1]&&(d="constraints are inconsistent, no solution!"),2===a[1]&&(d="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(f),unconstrained_solution:n(i),iterations:n(y),iact:n(p),message:d}}}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,i=1e-64/n,r=0,s=0,o=0,a=0,u=0,l=numeric.clone(t),c=l.length,h=l[0].length;if(c<h)throw"Need more rows than columns";var d=new Array(h),f=new Array(h);for(s=0;s<h;s++)d[s]=f[s]=0;var p=numeric.rep([h,h],0);function m(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var g=0,y=0,v=0,b=0,x=0,w=0,T=0;for(s=0;s<h;s++){for(d[s]=y,T=0,u=s+1,o=s;o<c;o++)T+=l[o][s]*l[o][s];if(T<=i)y=0;else for(g=l[s][s],y=Math.sqrt(T),g>=0&&(y=-y),v=g*y-T,l[s][s]=g-y,o=u;o<h;o++){for(T=0,a=s;a<c;a++)T+=l[a][s]*l[a][o];for(g=T/v,a=s;a<c;a++)l[a][o]+=g*l[a][s]}for(f[s]=y,T=0,o=u;o<h;o++)T+=l[s][o]*l[s][o];if(T<=i)y=0;else{for(g=l[s][s+1],y=Math.sqrt(T),g>=0&&(y=-y),v=g*y-T,l[s][s+1]=g-y,o=u;o<h;o++)d[o]=l[s][o]/v;for(o=u;o<c;o++){for(T=0,a=u;a<h;a++)T+=l[o][a]*l[s][a];for(a=u;a<h;a++)l[o][a]+=T*d[a]}}(x=Math.abs(f[s])+Math.abs(d[s]))>b&&(b=x)}for(s=h-1;-1!=s;s+=-1){if(0!=y){for(v=y*l[s][s+1],o=u;o<h;o++)p[o][s]=l[s][o]/v;for(o=u;o<h;o++){for(T=0,a=u;a<h;a++)T+=l[s][a]*p[a][o];for(a=u;a<h;a++)p[a][o]+=T*p[a][s]}}for(o=u;o<h;o++)p[s][o]=0,p[o][s]=0;p[s][s]=1,y=d[s],u=s}for(s=h-1;-1!=s;s+=-1){for(y=f[s],o=u=s+1;o<h;o++)l[s][o]=0;if(0!=y){for(v=l[s][s]*y,o=u;o<h;o++){for(T=0,a=u;a<c;a++)T+=l[a][s]*l[a][o];for(g=T/v,a=s;a<c;a++)l[a][o]+=g*l[a][s]}for(o=s;o<c;o++)l[o][s]=l[o][s]/y}else for(o=s;o<c;o++)l[o][s]=0;l[s][s]+=1}for(n*=b,a=h-1;-1!=a;a+=-1)for(var S=0;S<50;S++){var E=!1;for(u=a;-1!=u;u+=-1){if(Math.abs(d[u])<=n){E=!0;break}if(Math.abs(f[u-1])<=n)break}if(!E){r=0,T=1;var O=u-1;for(s=u;s<a+1&&(g=T*d[s],d[s]=r*d[s],!(Math.abs(g)<=n));s++)for(v=m(g,y=f[s]),f[s]=v,r=y/v,T=-g/v,o=0;o<c;o++)l[o][O]=(x=l[o][O])*r+(w=l[o][s])*T,l[o][s]=-x*T+w*r}if(w=f[a],u==a){if(w<0)for(f[a]=-w,o=0;o<h;o++)p[o][a]=-p[o][a];break}if(S>=49)throw"Error: no convergence.";for(b=f[u],y=m(g=(((x=f[a-1])-w)*(x+w)+((y=d[a-1])-(v=d[a]))*(y+v))/(2*v*x),1),g=g<0?((b-w)*(b+w)+v*(x/(g-y)-v))/b:((b-w)*(b+w)+v*(x/(g+y)-v))/b,r=1,T=1,s=u+1;s<a+1;s++){for(x=f[s],v=T*(y=d[s]),y*=r,w=m(g,v),d[s-1]=w,g=b*(r=g/w)+y*(T=v/w),y=-b*T+y*r,v=x*T,x*=r,o=0;o<h;o++)p[o][s-1]=(b=p[o][s-1])*r+(w=p[o][s])*T,p[o][s]=-b*T+w*r;for(w=m(g,v),f[s-1]=w,g=(r=g/w)*y+(T=v/w)*x,b=-T*y+r*x,o=0;o<c;o++)l[o][s-1]=(x=l[o][s-1])*r+(w=l[o][s])*T,l[o][s]=-x*T+w*r}d[u]=0,d[a]=g,f[a]=b}for(s=0;s<f.length;s++)f[s]<n&&(f[s]=0);for(s=0;s<h;s++)for(o=s-1;o>=0;o--)if(f[o]<f[s]){for(r=f[o],f[o]=f[s],f[s]=r,a=0;a<l.length;a++)e=l[a][s],l[a][s]=l[a][o],l[a][o]=e;for(a=0;a<p.length;a++)e=p[a][s],p[a][s]=p[a][o],p[a][o]=e;s=o}return{U:l,S:f,V:p}}}).call(this,__webpack_require__(27))},function(t,e,n){"use strict";(function(t){n.d(e,"f",function(){return a}),n.d(e,"e",function(){return u}),n.d(e,"a",function(){return d}),n.d(e,"b",function(){return f}),n.d(e,"d",function(){return p}),n.d(e,"c",function(){return m}),n.d(e,"g",function(){return g});var i=n(18),r=n(8),s=n(1),o=n(34);async function a(t,e){const n=[],i=[],r=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let s=0;s<r.length;++s){const o=r[s],a=Array.isArray(t)?t[s].tensor:t[o];if("float32"!==a.dtype&&"int32"!==a.dtype&&"bool"!==a.dtype&&"string"!==a.dtype&&"complex64"!==a.dtype)throw new Error(`Unsupported dtype in weight '${o}': ${a.dtype}`);const u={name:o,shape:a.shape,dtype:a.dtype};if("string"===a.dtype){const t=new Promise(async t=>{const e=await a.bytes(),n=e.reduce((t,e)=>t+e.length,0)+4*e.length,i=new Uint8Array(n);let r=0;for(let s=0;s<e.length;s++){const t=e[s],n=new Uint8Array(new Uint32Array([t.length]).buffer);i.set(n,r),r+=4,i.set(t,r),r+=t.length}t(i)});i.push(t)}else i.push(a.data());null!=e&&(u.group=e),n.push(u)}return{data:l(await Promise.all(i)),specs:n}}function u(t,e){const n={};let a,u=0;for(const l of e){const e=l.name,c=l.dtype,h=l.shape,d=Object(s.sizeFromShape)(h);let f;if("quantization"in l){const n=l.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${l.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${l.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==c)throw new Error(`Weight ${l.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${c}.`)}const i=o.a[n.dtype],r=t.slice(u,u+d*i),s="uint8"===n.dtype?new Uint8Array(r):new Uint16Array(r);if("float32"===c)if("uint8"===n.dtype||"uint16"===n.dtype){f=new Float32Array(s.length);for(let t=0;t<s.length;t++)f[t]=s[t]*n.scale+n.min}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===a&&(a=y()),f=a(s)}else{if("int32"!==c)throw new Error(`Unsupported dtype in weight '${e}': ${c}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);f=new Int32Array(s.length);for(let t=0;t<s.length;t++)f[t]=Math.round(s[t]*n.scale+n.min)}u+=d*i}else if("string"===c){const e=Object(s.sizeFromShape)(l.shape);f=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(u,u+4))[0];u+=4;const n=new Uint8Array(t.slice(u,u+e));f.push(n),u+=e}}else{const s=o.a[c],a=t.slice(u,u+d*s);if("float32"===c)f=new Float32Array(a);else if("int32"===c)f=new Int32Array(a);else if("bool"===c)f=new Uint8Array(a);else{if("complex64"!==c)throw new Error(`Unsupported dtype in weight '${e}': ${c}`);{f=new Float32Array(a);const t=new Float32Array(f.length/2),s=new Float32Array(f.length/2);for(let e=0;e<t.length;e++)t[e]=f[2*e],s[e]=f[2*e+1];const o=Object(r.f)(t,h,"float32"),u=Object(r.f)(s,h,"float32");n[e]=Object(i.a)(o,u)}}u+=d*s}"complex64"!==c&&(n[e]=Object(r.f)(f,h,c))}return n}function l(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)});const i=new Uint8Array(e);let r=0;return n.forEach(t=>{i.set(new Uint8Array(t.buffer),r),r+=t.byteLength}),i.buffer}const c=void 0!==t&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function h(e){return c?t.byteLength(e):new Blob([e]).size}function d(e){if(c)return t.from(e).toString("base64");const n=new Uint8Array(e);let i="";for(let t=0,r=n.length;t<r;t++)i+=String.fromCharCode(n[t]);return btoa(i)}function f(e){if(c){const n=t.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const n=atob(e),i=new Uint8Array(n.length);for(let t=0;t<n.length;++t)i.set([n.charCodeAt(t)],t);return i.buffer}function p(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let i=0;return t.forEach(t=>{n.set(new Uint8Array(t),i),i+=t.byteLength}),n.buffer}function m(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function g(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:h(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:h(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function y(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return i=>{const r=new ArrayBuffer(4*i.length),s=new Uint32Array(r);for(let o=0;o<i.length;o++){const r=i[o];s[o]=t[n[r>>10]+(1023&r)]+e[r>>10]}return new Float32Array(r)}}}).call(this,n(39).Buffer)},function(t,e,n){"use strict";n.d(e,"f",function(){return c}),n.d(e,"e",function(){return h}),n.d(e,"d",function(){return d}),n.d(e,"g",function(){return f}),n.d(e,"a",function(){return p}),n.d(e,"b",function(){return O}),n.d(e,"c",function(){return i});var i,r=n(0),s=n(20),o=n(19);function a(t){return t instanceof r.Tensor?{value:t.clone(),recurse:!1}:Object(o.e)(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}class u{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class l extends u{constructor(){super(l.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let i=0;i<n;i++)e[i]=this.get(this.wrap(this.begin+i));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function c(t){return new m(t)}function h(t){return new g(t)}function d(t,e){return new _(t,e)}function f(t,e=i.FAIL){return new A(t,e)}l.INITIAL_CAPACITY=32;class p{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new S(this,t)}filter(t){return new w(this,t)}map(t){return new T(this,t)}mapAsync(t){return new E(this,t)}serialMapAsync(t){return new E(this,t).serial()}flatmap(t){return new C(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new x(this,t,e)}columnMajorBatch(t,e=!0,n=o.f){return this.rowMajorBatch(t,e).map(t=>Object(o.d)(t,n))}concatenate(t,e){return new _(c([this,t]),e)}take(t){return t<0||null==t?this:new b(this,t)}skip(t){return t<0||null==t?this:new v(this,t)}prefetch(t){return new k(this,t)}shuffle(t,e){return new R(this,t,e)}serial(){return new y(this)}}class m extends p{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:(e=t,Object(o.b)(e,a)),done:!1};var e}}class g extends p{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}}}class y extends p{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Serial"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class v extends p{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Skip"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;r.dispose(t.value)}return this.upstream.next()}}class b extends p{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return this.upstream.summary()+" -> Take"}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class x extends p{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> RowMajorBatch"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class w extends p{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Filter"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;r.dispose(t.value)}}}class T extends p{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Map"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=r.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),i=r.tensor_util.getTensorsInContainer(n);for(const s of e)r.tensor_util.isTensorInList(s,i)||s.dispose();return{value:n,done:!1}}}class S extends p{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> handleErrors"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class E extends p{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> AsyncMap"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=r.tensor_util.getTensorsInContainer(t.value),n=await this.transform(t.value),i=r.tensor_util.getTensorsInContainer(n);for(const s of e)r.tensor_util.isTensorInList(s,i)||s.dispose();return{value:n,done:!1}}}class O extends p{constructor(){super(),this.outputQueue=new l,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!(await this.pump()))return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class C extends O{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Flatmap"}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=r.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),i=r.tensor_util.getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const s of e)r.tensor_util.isTensorInList(s,i)||s.dispose();return!0}}class _ extends p{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(i||(i={}));class A extends p{constructor(t,e=i.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(t){await t;let e=0,n=0;const r=await Object(o.c)(this.iterators,function(t){return t instanceof p?{value:t.next().then(t=>(e++,t.done&&n++,t.value)),recurse:!1}:{value:null,recurse:!0}});if(e===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case i.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case i.SHORTEST:return{value:null,done:!0}}return this.count++,{value:r,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class k extends p{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new u(e)}summary(){return this.upstream.summary()+" -> Prefetch"}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class R extends k{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=s.alea(n||r.util.now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return S}),n.d(e,"i",function(){return O}),n.d(e,"c",function(){return C}),n.d(e,"f",function(){return _}),n.d(e,"e",function(){return R}),n.d(e,"d",function(){return I}),n.d(e,"k",function(){return N}),n.d(e,"g",function(){return D}),n.d(e,"h",function(){return P}),n.d(e,"j",function(){return F}),n.d(e,"b",function(){return L});var i=n(0),r=n(21),s=n(24),o=n(2),a=n(41),u=n(42),l=n(43),c=n(44),h=n(45),d=n(46),f=n(47),p=n(48),m=n(49),g=n(50),y=n(51),v=n(52),b=n(53),x=n(54),w=n(55),T=n(56);class S{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[a,u,l,c,h,d,f,g,m,p,y,v,b,x,w,T].map(t=>t.json));this.opMappers=t.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t,e={}){const n=[],i=[],r=t.node.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")&&n.push(t[e.name]),"Const"===e.op&&i.push(t[e.name]),t),{});let s=[];const a=[];let u={},l={};null!=e&&(u=this.mapSignatureEntries(e.inputs),l=this.mapSignatureEntries(e.outputs));const c=Object.keys(r);c.forEach(t=>{const e=r[t];e.inputNames.forEach(t=>{const[n]=Object(o.a)(t);e.inputs.push(r[n]),r[n].children.push(e)})}),0===Object.keys(l).length?c.forEach(t=>{const e=r[t];0===e.children.length&&a.push(e)}):Object.keys(l).forEach(t=>{const[e]=Object(o.a)(t),n=r[e];null!=n&&(n.signatureKey=l[t],a.push(n))}),Object.keys(u).length>0?Object.keys(u).forEach(t=>{const[e]=Object(o.a)(t),n=r[e];n&&(n.signatureKey=u[t],s.push(n))}):s=n;let h={};return null!=t.library&&null!=t.library.function&&(h=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{})),{nodes:r,inputs:s,outputs:a,weights:i,placeholders:n,signature:e,functions:h}}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,n)=>(e[t[n].name]=n,e),{})}mapNode(t){const e=Object(s.b)(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.substr(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((e,n)=>{const i=n.type;let r=void 0;switch(n.type){case"string":r=O(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=O(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":r=P(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=P(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":r=_(t.attr,n.tfName,n.defaultValue||0),void 0===r&&n.tfDeprecatedName&&(r=_(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":r=D(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=D(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":r=C(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=C(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":r=L(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=L(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":r=N(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=N(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":r=F(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=F(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":r=R(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=R(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":r=I(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=I(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":r=k(t.attr,n.tfName,n.defaultValue),void 0===r&&n.tfDeprecatedName&&(r=k(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${t.op}`)}return e[n.name]={value:r,type:i},e},{})),n}mapFunction(t){const e=t.nodeDef,n=[];let i={};null!=e&&(i=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t),{}));const r=[],s=[];t.signature.inputArg.forEach(t=>{const[e]=Object(o.a)(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:A(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,r.push(n),i[e]=n}),Object.keys(i).forEach(t=>{const e=i[t];e.inputNames.forEach(t=>{const[n]=Object(o.a)(t);e.inputs.push(i[n]),i[n].children.push(e)})});const a=t.ret;t.signature.outputArg.forEach(t=>{const[e,n]=Object(o.a)(a[t.name]),r=i[e];null!=r&&(r.defaultOutput=n,s.push(r))});const u=this.mapArgsToSignature(t);return{nodes:i,inputs:r,outputs:s,weights:n,placeholders:[],signature:u}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function E(e,n){const r=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const n=Object(i.env)().global;if(void 0!==n.atob)return n.atob(e);if(void 0!==t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return n?r:r.toLowerCase()}function O(t,e,n,i=!1){const r=t[e];return null!=r?E(r.s,i):n}function C(t,e,n){const i=t[e];return i?i.b:n}function _(t,e,n){const i=t[e]||{},r=null!=i.i?i.i:null!=i.f?i.f:n;return"number"==typeof r?r:parseInt(r,10)}function A(t){switch("string"==typeof t&&(t=r.a[t]),t){case r.a.DT_FLOAT:return"float32";case r.a.DT_INT32:case r.a.DT_INT64:case r.a.DT_INT8:case r.a.DT_UINT8:return"int32";case r.a.DT_BOOL:return"bool";case r.a.DT_DOUBLE:return"float32";case r.a.DT_STRING:return"string";default:return null}}function k(t,e,n){const i=t[e];return i&&i.func?i.func.name:n}function R(t,e,n){const i=t[e];return i&&i.type?A(i.type):n}function I(t,e,n){const i=t[e];return i&&i.list&&i.list.type?i.list.type.map(t=>A(t)):n}function M(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"==typeof t.size?t.size:parseInt(t.size,10)):[]}function N(t,e,n){const i=t[e];return i&&i.shape?M(i.shape):n}function D(t,e,n){const i=t[e];return i?((i.list.f&&i.list.f.length?i.list.f:i.list.i)||[]).map(t=>"number"==typeof t?t:parseInt(t,10)):n}function P(t,e,n,i=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(t=>E(t,i)):n}function F(t,e,n){const i=t[e];return i&&i.list&&i.list.shape?i.list.shape.map(t=>M(t)):n}function L(t,e,n){const i=t[e];return i&&i.list&&i.list.b?i.list.b:n}}).call(this,n(39).Buffer)},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return u}),n.d(e,"e",function(){return l}),n.d(e,"d",function(){return c}),n.d(e,"g",function(){return h}),n.d(e,"f",function(){return d});var i=n(33);const r=Object(i.a)("kernelRegistry",()=>new Map),s=Object(i.a)("gradRegistry",()=>new Map);function o(t,e){const n=f(t,e);return r.get(n)}function a(t){return s.get(t)}function u(t){const e=r.entries(),n=[];for(;;){const{done:i,value:r}=e.next();if(i)break;const[s,o]=r,[a]=s.split("_");a===t&&n.push(o)}return n}function l(t){const{kernelName:e,backendName:n}=t,i=f(e,n);r.has(i)&&console.warn(`The kernel '${e}' for backend '${n}' is already registered`),r.set(i,t)}function c(t){const{kernelName:e}=t;s.has(e)&&console.warn(`Overriding the gradient for '${e}'`),s.set(e,t)}function h(t,e){const n=f(t,e);if(!r.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);r.delete(n)}function d(t){if(!s.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);s.delete(t)}function f(t,e){return`${e}_${t}`}},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var i=n(5),r=n(6),s=n(3),o=n(1),a=n(4);const u=Object(a.a)({complex_:function(t,e){const n=Object(s.a)(t,"real","complex"),a=Object(s.a)(e,"imag","complex");return o.assertShapesMatch(n.shape,a.shape,`real and imag shapes, ${n.shape} and ${a.shape}, must match in call to tf.complex().`),i.a.runKernelFunc(t=>t.complex(n,a),{real:n,imag:a},null,r.k)}})},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"f",function(){return u}),n.d(e,"c",function(){return l}),n.d(e,"e",function(){return c}),n.d(e,"a",function(){return h});var i=n(0);function r(t,e){return s(t,e)}function s(t,e,n=new Map,i=new Set){if(null==t)return null;if(i.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&null!==r.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse){if(c(t)){const r=Array.isArray(t)?[]:{};i.add(t);for(const o in t){const a=s(t[o],e,n,i);r[o]=a}return i.delete(t),r}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,r.value),r.value}function o(t,e=u){return a(t,e)}function a(t,e,n=new Set){const i=t[0];if(n.has(i))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&null!==r.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse){if(c(i)){const r=Array.isArray(i)?[]:{};n.add(i);for(const s in i){const i=a(t.map(t=>t[s]),e,n);r[s]=i}return n.delete(i),r}throw new Error("Can't recurse into non-iterable type: "+i)}return r.value}function u(t){return null===t?null:c(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function l(t,e){const n=new Map;s(t,e,n);for(const i of Array.from(n.keys())){const t=n.get(i);if(t instanceof Promise){const e=await t;n.set(i,e)}}return s(t,e,n)}function c(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof i.Tensor))}function h(t){return null==t||null===(e=t)||"object"!=typeof e&&"function"!=typeof e||Array.isArray(t)||"object"==typeof t&&t instanceof i.Tensor||i.util.isTypedArray(t);var e}},function(t,e,n){var i=n(68),r=n(69),s=n(70),o=n(71),a=n(72),u=n(73),l=n(74);l.alea=i,l.xor128=r,l.xorwow=s,l.xorshift7=o,l.xor4096=a,l.tychei=u,t.exports=l},function(t,e,n){"use strict";var i,r;n.d(e,"a",function(){return i}),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(i||(i={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n(5),r=n(6),s=n(3),o=n(4);const a=Object(o.a)({real_:function(t){const e=Object(s.a)(t,"input","real");return i.a.runKernelFunc(t=>t.real(e),{input:e},null,r.hb)}})},function(t,e,n){"use strict";var i,r,s,o,a;n.d(e,"a",function(){return i}),n.d(e,"c",function(){return l}),n.d(e,"b",function(){return c}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(s||(s={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(o||(o={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(a||(a={}));const u={float32:o,int32:r,bool:s,complex64:a};function l(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return u[t][e]}function c(t){return l(t,"int32")}},function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"b",function(){return s}),n.d(e,"a",function(){return o});const i={};function r(t,e){i[t]={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e}}function s(t){return i[t]}function o(t){delete i[t]}},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var i=n(5),r=n(6),s=n(3),o=n(4);const a=Object(o.a)({imag_:function(t){const e=Object(s.a)(t,"input","imag");return i.a.runKernelFunc(t=>t.imag(e),{input:e},null,r.K)}})},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return s});var i=n(0);function r(t,e,n,r,s,o){const a=s.strideHeight,u=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,h=s.effectiveFilterHeight,d=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Object(i.buffer)(s.outShape,n),y=g.values,v=s.outShape[1]*s.outShape[2]*s.outShape[3],b=s.outShape[2]*s.outShape[3],x=s.outShape[3];for(let i=0;i<s.batchSize;++i){const e=i*v,n=i*r[0];for(let i=0;i<s.inChannels;++i)for(let g=0;g<s.outHeight;++g){const v=g*a-f,w=Math.max(0,v),T=Math.min(s.inHeight,h+v),S=e+g*b;for(let e=0;e<s.outWidth;++e){const a=e*u-p,h=Math.max(0,a),f=Math.min(s.inWidth,d+a);let g=m,v=0,b=0;for(let e=w;e<T;e+=l){const s=n+e*r[1];for(let e=h;e<f;e+=c){const n=t[s+e*r[2]+i];"max"===o&&n>g?g=n:"avg"===o&&(v+=n,b++)}if(isNaN(g))break}y[S+e*x+i]="avg"===o?v/b:g}}}return g}function s(t,e,n,r,s=!1,o=!1){const a=Object(i.buffer)(r.outShape,"int32"),u=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,g=Object(i.buffer)(e,n,t);for(let i=0;i<r.batchSize;++i)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*u-p;let y=n;for(;y<0;)y+=c;const v=Math.min(r.inHeight,d+n);for(let u=0;u<r.outWidth;++u){const d=u*l-m;let p=d;for(;p<0;)p+=h;const b=Math.min(r.inWidth,f+d);let x=Number.NEGATIVE_INFINITY,w=-1;for(let e=y;e<v;e+=c){const a=e-n;for(let n=p;n<b;n+=h){const u=n-d,l=g.get(i,e,n,t);l>x&&(x=l,w=s?o?((i*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:a*f+u)}}a.set(w,i,e,u,t)}}return a}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(i){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(0);function r(t,e,n,r,s){const o=e.length,a=i.util.sizeFromShape(e),u=i.util.computeStrides(e),l=i.util.computeStrides(s),c=i.util.getTypedArrayFromDType(n,i.util.sizeFromShape(s));for(let h=0;h<a;++h){const e=i.util.indexToLoc(h,o,u),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[r[t]];c[i.util.locToIndex(n,o,l)]=t[h]}return c}},function(t,e,n){"use strict";n.d(e,"a",function(){return g}),n.d(e,"c",function(){return y}),n.d(e,"b",function(){return i});var i={};n.r(i),n.d(i,"maxImpl",function(){return r.a}),n.d(i,"transposeImpl",function(){return s.a});var r=n(37),s=n(30),o=n(0),a=n(20),u=n(9),l=n(26);const c=o.kernel_impls.nonMaxSuppressionV3,h=o.kernel_impls.split,d=o.kernel_impls.tile,f=o.kernel_impls.topkImpl,p=o.kernel_impls.whereImpl;function m(t,e,n,i){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,i);throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}class g extends o.KernelBackend{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new o.DataStorage(this,Object(o.engine)())}write(t,e,n){this.firstUse&&(this.firstUse=!1,Object(o.env)().get("IS_NODE")&&o.backend_util.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const i={};return this.data.set(i,{values:t,dtype:n}),i}move(t,e,n,i){this.data.set(t,{values:e,dtype:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensors:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return o.backend_util.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map(t=>o.util.decodeString(t))}catch(i){throw new Error("Failed to decode encoded string bytes into utf-8")}return o.buffer(t.shape,t.dtype,n)}makeOutput(t,e,n){const i=this.write(t,e,n);return Object(o.engine)().makeTensorFromDataId(i,e,n,this)}disposeData(t){if(this.data.has(t)){const{complexTensors:e}=this.data.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}}async time(t){const e=o.util.now();return t(),{kernelMs:o.util.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}complex(t,e){const n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Object(o.engine)().keep(t.clone()),imag:Object(o.engine)().keep(e.clone())},n}real(t){return this.data.get(t.dataId).complexTensors.real.clone()}imag(t){return this.data.get(t.dataId).complexTensors.imag.clone()}slice(t,e,n){if(Object(u.a)(t,"slice"),o.slice_util.isSliceContinous(t.shape,e,n)){const i=o.slice_util.computeFlatOffset(e,t.strides),r=o.util.sizeFromShape(n),s=this.readSync(t.dataId);return o.tensor(s.subarray(i,i+r),n,t.dtype)}const i=o.buffer(n,t.dtype),r=this.bufferSync(t);for(let s=0;s<i.size;++s){const t=i.indexToLoc(s).map((t,n)=>t+e[n]);i.values[s]=r.get(...t)}return i.toTensor()}stridedSlice(t,e,n,i){Object(u.a)(t,"stridedSlice");const r=o.slice_util.computeOutShape(e,n,i);if(r.some(t=>0===t))return o.tensor([],r);const s=o.buffer(r,t.dtype),a=this.bufferSync(t);for(let o=0;o<s.size;o++){const t=s.indexToLoc(o),n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]*i[r]+e[r];s.set(a.get(...n),...t)}return s.toTensor()}diag(t){const e=this.readSync(t.dataId),n=o.buffer([t.size,t.size],t.dtype),i=n.values;for(let r=0;r<e.length;r++)i[r*t.size+r]=e[r];return n.toTensor()}unstack(t,e){const n=t.shape[e],i=new Array(t.rank-1);let r=0;for(let u=0;u<t.rank;u++)u!==e&&(i[r++]=t.shape[u]);const s=new Array(t.rank).fill(0),o=t.shape.slice();o[e]=1;const a=new Array(n);for(let u=0;u<a.length;u++)s[e]=u,a[u]=this.slice(t,s,o).reshape(i);return a}reverse(t,e){Object(u.a)(t,"reverse");const n=o.buffer(t.shape,t.dtype),i=this.bufferSync(t);for(let r=0;r<n.size;r++){const s=n.indexToLoc(r),o=s.slice();e.forEach(e=>o[e]=t.shape[e]-1-o[e]),n.set(i.get(...o),...s)}return n.toTensor()}concat(t,e){if("complex64"===t[0].dtype){const n=t.map(t=>o.real(t)),i=t.map(t=>o.imag(t));return o.complex(this.concat(n,e),this.concat(i,e))}const n=t.map(t=>{const n=o.util.sizeFromShape(t.shape.slice(e));return t.as2D(-1,n)}),i=o.backend_util.computeOutShape(n.map(t=>t.shape),1),r=o.buffer(i,t[0].dtype).values;if(1===n[0].shape[0]){let t=0;n.forEach(e=>{r.set(this.readSync(e.dataId),t),t+=e.size})}else{let t=0;n.forEach(e=>{const n=this.readSync(e.dataId);let s=0;for(let o=0;o<e.shape[0];++o){const a=o*i[1]+t;for(let t=0;t<e.shape[1];++t)r[a+t]=n[s++]}t+=e.shape[1]})}const s=o.backend_util.computeOutShape(t.map(t=>t.shape),e);return o.tensor(r,s,t[0].dtype)}neg(t){return Object(u.a)(t,"neg"),this.multiply(o.scalar(-1),t)}add(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,i)=>({real:t+n,imag:e+i})):this.broadcastedBinaryOp(t,e,Object(o.upcastType)(t.dtype,e.dtype),(t,e)=>t+e)}addN(t){Object(u.a)(t,"addN");const e=t.map(t=>this.readSync(t.dataId)),n=o.buffer(t[0].shape,t[0].dtype),i=n.values;for(let r=0;r<t.length;r++){const t=e[r];for(let e=0;e<i.length;e++)i[e]+=t[e]}return n.toTensor()}softmax(t,e){const n=o.util.parseAxisParam([e],t.shape),i=Object(o.max)(t,n),r=o.backend_util.expandShapeToKeepDim(i.shape,n),s=this.subtract(t,i.reshape(r)),a=this.exp(s),u=this.sum(a,n).reshape(r);return o.div(a,u)}subtract(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,i)=>({real:t-n,imag:e-i})):this.broadcastedBinaryOp(t,e,Object(o.upcastType)(t.dtype,e.dtype),(t,e)=>t-e)}pow(t,e){return Object(u.a)([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.pow(t,e))}batchMatMul(t,e,n,i){Object(u.a)([t,e],"matMul");const r=n?t.shape[1]:t.shape[2],s=n?t.shape[2]:t.shape[1],a=i?e.shape[1]:e.shape[2],l=t.shape[0],c=this.readSync(t.dataId),h=this.readSync(e.dataId),[d,f,p]=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],[m,g,y]=i?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],v=s*a,b=o.buffer([l,s,a],t.dtype),x=b.values,w=this.blockSize;for(let o=0;o<l;o++)for(let t=0;t<s;t+=w)for(let e=0;e<a;e+=w)for(let n=0;n<r;n+=w){const i=Math.min(t+w,s),u=Math.min(e+w,a),l=Math.min(n+w,r);for(let r=t;r<i;r++)for(let t=e;t<u;t++){let e=0;for(let i=n;i<l;i++)e+=c[o*d+r*f+i*p]*h[i*m+t*g+o*y];x[o*v+(r*a+t)]+=e}}return b.toTensor()}fusedBatchMatMul({a:t,b:e,transposeA:n,transposeB:i,bias:r,activation:s,preluActivationWeights:o}){let a=this.batchMatMul(t,e,n,i);return r&&(a=this.add(a,r)),s&&(a=m(this,a,s,o)),a}multiply(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(t,e,n,i)=>({real:t*n-e*i,imag:t*i+e*n})):this.broadcastedBinaryOp(t,e,Object(o.upcastType)(t.dtype,e.dtype),(t,e)=>t*e)}floorDiv(t,e){return Object(u.a)([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(t,e)=>Math.floor(t/e))}sum(t,e){Object(u.a)(t,"sum"),o.backend_util.assertAxesAreInnerMostDims("sum",e,t.rank);const[n,i]=o.backend_util.computeOutAndReduceShapes(t.shape,e),r=Object(o.upcastType)(t.dtype,"int32"),s=o.zeros(n,r),a=o.util.sizeFromShape(i),l=this.readSync(s.dataId),c=this.readSync(t.dataId);for(let o=0;o<l.length;++o){const t=o*a;let e=0;for(let n=0;n<a;++n)e+=c[t+n];l[o]=e}return s}prod(t,e){Object(u.a)(t,"sum");const[n,i]=o.backend_util.computeOutAndReduceShapes(t.shape,e),r=Object(o.upcastType)(t.dtype,"int32"),s=o.zeros(n,r),a=o.util.sizeFromShape(i),l=this.readSync(s.dataId),c=this.readSync(t.dataId);for(let o=0;o<l.length;++o){const t=o*a;let e=1;for(let n=0;n<a;++n)e*=c[t+n];l[o]=e}return s}unsortedSegmentSum(t,e,n){Object(u.a)(t,"unsortedSegmentSum");const i=[],r=t.rank-e.rank;for(let s=0;s<r;++s)e=e.expandDims(s+1);for(let s=0;s<n;++s){const n=o.scalar(s,"int32"),r=o.equal(n,e).asType("float32").mul(t).sum(0);i.push(r)}return o.stack(i)}argMin(t,e){Object(u.a)(t,"argMin");const n=[e];o.backend_util.assertAxesAreInnerMostDims("argMin",n,t.rank);const[i,r]=o.backend_util.computeOutAndReduceShapes(t.shape,n),s=o.zeros(i,"int32"),a=o.util.sizeFromShape(r),l=this.readSync(s.dataId),c=this.readSync(t.dataId);for(let o=0;o<l.length;++o){const t=o*a;let e=c[t],n=0;for(let i=0;i<a;++i){const r=c[t+i];r<e&&(e=r,n=i)}l[o]=n}return s}argMax(t,e){Object(u.a)(t,"argMax");const n=[e];o.backend_util.assertAxesAreInnerMostDims("argMax",n,t.rank);const[i,r]=o.backend_util.computeOutAndReduceShapes(t.shape,n),s=o.zeros(i,"int32"),a=o.util.sizeFromShape(r),l=this.readSync(s.dataId),c=this.readSync(t.dataId);for(let o=0;o<l.length;++o){const t=o*a;let e=c[t],n=0;for(let i=0;i<a;++i){const r=c[t+i];r>e&&(e=r,n=i)}l[o]=n}return s}cumsum(t,e,n,i){if(Object(u.a)(t,"cumsum"),e!==t.rank-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${t.rank-1} but got axis=`+e);const r=Object(o.upcastType)(t.dtype,"int32"),s=o.zeros(t.shape,r),a=this.readSync(s.dataId),l=this.readSync(t.dataId),c=t.shape[t.rank-1],h=i?(t,e)=>t+c-e-1:(t,e)=>t+e;for(let o=0;o<l.length;o+=c)for(let t=0;t<c;t++){const e=h(o,t);if(0===t)a[e]=n?0:l[e];else{const i=h(o,t-1);a[e]=n?l[i]+a[i]:l[e]+a[i]}}return s}equal(t,e){return Object(u.a)([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t===e?1:0)}notEqual(t,e){return Object(u.a)([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t!==e?1:0)}less(t,e){return Object(u.a)([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<e?1:0)}lessEqual(t,e){return Object(u.a)([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t<=e?1:0)}greater(t,e){return Object(u.a)([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>e?1:0)}greaterEqual(t,e){return Object(u.a)([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t>=e?1:0)}logicalNot(t){Object(u.a)(t,"logicalNot");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)n[i]=e[i]?0:1;return this.makeOutput(n,t.shape,"bool")}logicalAnd(t,e){return Object(u.a)([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t&&e)}logicalOr(t,e){return Object(u.a)([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(t,e)=>t||e)}select(t,e,n){Object(u.a)([t,e,n],"select");const i=this.readSync(t.dataId),r=this.readSync(e.dataId),s=this.readSync(n.dataId),a=o.zeros(e.shape,Object(o.upcastType)(e.dtype,n.dtype)),l=this.readSync(a.dataId);let c=0;const h=0===t.rank||t.rank>1||1===e.rank?1:o.util.sizeFromShape(e.shape.slice(1));for(let o=0;o<i.length;o++)for(let t=0;t<h;t++)l[c++]=1===i[o]?r[o]:s[o];return a}where(t){Object(u.a)([t],"where");const e=this.readSync(t.dataId);return p(t.shape,e)}topk(t,e,n){Object(u.a)(t,"topk");const i=this.readSync(t.dataId);return f(i,t.shape,t.dtype,e,n)}min(t,e){Object(u.a)(t,"min"),o.backend_util.assertAxesAreInnerMostDims("min",e,t.rank);const[n,i]=o.backend_util.computeOutAndReduceShapes(t.shape,e),r=o.zeros(n,t.dtype),s=o.util.sizeFromShape(i),a=this.readSync(r.dataId),l=this.readSync(t.dataId);for(let o=0;o<a.length;++o){const t=o*s;let e=l[t];for(let n=0;n<s;++n){const i=l[t+n];i<e&&(e=i)}a[o]=e}return r}minimum(t,e){return Object(u.a)([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.min(t,e))}mod(t,e){return Object(u.a)([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})}maximum(t,e){return Object(u.a)([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.max(t,e))}all(t,e){Object(u.a)(t,"all"),o.backend_util.assertAxesAreInnerMostDims("all",e,t.rank);const[n,i]=o.backend_util.computeOutAndReduceShapes(t.shape,e),r=o.zeros(n,t.dtype),s=o.util.sizeFromShape(i),a=this.readSync(r.dataId),l=this.readSync(t.dataId);for(let o=0;o<a.length;++o){const t=o*s;let e=l[t];for(let n=0;n<s;++n){const i=l[t+n];e=e&&i}a[o]=e}return r}any(t,e){Object(u.a)(t,"any"),o.backend_util.assertAxesAreInnerMostDims("any",e,t.rank);const[n,i]=o.backend_util.computeOutAndReduceShapes(t.shape,e),r=o.zeros(n,t.dtype),s=o.util.sizeFromShape(i),a=this.readSync(r.dataId),l=this.readSync(t.dataId);for(let o=0;o<a.length;++o){const t=o*s;let e=l[t];for(let n=0;n<s;++n){const i=l[t+n];e=e||i}a[o]=e}return r}squaredDifference(t,e){return Object(u.a)([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>{const n=t-e;return n*n})}ceil(t){Object(u.a)(t,"ceil");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.ceil(e[i]);return this.makeOutput(n,t.shape,"float32")}floor(t){Object(u.a)(t,"floor");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.floor(e[i]);return this.makeOutput(n,t.shape,"float32")}sign(t){Object(u.a)(t,"x");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=e[i]<0?-1:e[i]>0?1:0;return this.makeOutput(n,t.shape,"float32")}isNaN(t){Object(u.a)(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)Number.isNaN(e[i])&&(n[i]=1);return this.makeOutput(n,t.shape,"bool")}isInf(t){Object(u.a)(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)Math.abs(e[i])===1/0&&(n[i]=1);return this.makeOutput(n,t.shape,"bool")}isFinite(t){Object(u.a)(t,"x");const e=this.readSync(t.dataId),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)Number.isFinite(e[i])&&(n[i]=1);return this.makeOutput(n,t.shape,"bool")}round(t){Object(u.a)(t,"round");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i){const t=Math.floor(e[i]);n[i]=e[i]-t<.5?Math.floor(e[i]):e[i]-t>.5?Math.ceil(e[i]):t%2==0?t:t+1}return this.makeOutput(n,t.shape,"float32")}exp(t){Object(u.a)(t,"exp");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.exp(e[i]);return this.makeOutput(n,t.shape,"float32")}expm1(t){Object(u.a)(t,"expm1");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.expm1(e[i]);return this.makeOutput(n,t.shape,"float32")}log(t){Object(u.a)(t,"log");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.log(e[i]);return this.makeOutput(n,t.shape,"float32")}log1p(t){Object(u.a)(t,"log1p");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.log1p(e[i]);return this.makeOutput(n,t.shape,"float32")}sqrt(t){Object(u.a)(t,"sqrt");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=Math.sqrt(e[i]);return this.makeOutput(n,t.shape,"float32")}rsqrt(t){Object(u.a)(t,"rsqrt");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=1/Math.sqrt(e[i]);return this.makeOutput(n,t.shape,"float32")}reciprocal(t){Object(u.a)(t,"reciprocal");const e=this.readSync(t.dataId),n=new Float32Array(e.length);for(let i=0;i<e.length;++i)n[i]=1/e[i];return this.makeOutput(n,t.shape,"float32")}linear(t){return t}relu(t){Object(u.a)(t,"relu");const e=o.zeros(t.shape,t.dtype),n=this.readSync(e.dataId),i=this.readSync(t.dataId);for(let r=0;r<i.length;++r)n[r]=Math.max(0,i[r]);return e}relu6(t){Object(u.a)(t,"relu");const e=o.zeros(t.shape,t.dtype),n=this.readSync(e.dataId),i=this.readSync(t.dataId);for(let r=0;r<i.length;++r)n[r]=Math.min(Math.max(0,i[r]),6);return e}prelu(t,e){return Object(u.a)([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>t<0?e*t:t)}elu(t){Object(u.a)(t,"elu");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i){const t=n[i];e[i]=t>=0?t:Math.exp(t)-1}return this.makeOutput(e,t.shape,"float32")}eluDer(t,e){Object(u.a)([t,e],"eluDer");const n=new Float32Array(e.size),i=this.readSync(e.dataId),r=this.readSync(t.dataId);for(let s=0;s<i.length;++s){const t=i[s];n[s]=t>=1?r[s]:r[s]*(t+1)}return this.makeOutput(n,e.shape,"float32")}selu(t){Object(u.a)(t,"selu");const e=o.backend_util.SELU_SCALEALPHA,n=o.backend_util.SELU_SCALE,i=new Float32Array(t.size),r=this.readSync(t.dataId);for(let s=0;s<r.length;++s){const t=r[s];i[s]=t>=0?n*t:e*(Math.exp(t)-1)}return this.makeOutput(i,t.shape,"float32")}clip(t,e,n){Object(u.a)(t,"clip");const i=new Float32Array(t.size),r=this.readSync(t.dataId);for(let s=0;s<r.length;++s){const t=r[s];i[s]=t>n?n:t<e?e:t}return this.makeOutput(i,t.shape,"float32")}abs(t){const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.abs(n[i]);return this.makeOutput(e,t.shape,"float32")}complexAbs(t){const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<t.size;++i)e[i]=Math.hypot(n[2*i],n[2*i+1]);return this.makeOutput(e,t.shape,"float32")}int(t){Object(u.a)(t,"int");const e=new Int32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=n[i];return this.makeOutput(e,t.shape,"int32")}sigmoid(t){Object(u.a)(t,"sigmoid");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=1/(1+Math.exp(-n[i]));return this.makeOutput(e,t.shape,"float32")}softplus(t){Object(u.a)(t,"softplus");const e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),i=this.readSync(t.dataId);for(let r=0;r<i.length;++r){const t=i[r]>-e,s=i[r]<e,o=Math.exp(i[r]);let a;a=s?o:t?i[r]:Math.log(1+o),n[r]=a}return this.makeOutput(n,t.shape,"float32")}sin(t){Object(u.a)(t,"sin");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.sin(n[i]);return this.makeOutput(e,t.shape,"float32")}cos(t){Object(u.a)(t,"cos");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.cos(n[i]);return this.makeOutput(e,t.shape,"float32")}tan(t){Object(u.a)(t,"tan");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.tan(n[i]);return this.makeOutput(e,t.shape,"float32")}asin(t){Object(u.a)(t,"asin");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.asin(n[i]);return this.makeOutput(e,t.shape,"float32")}acos(t){Object(u.a)(t,"acos");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.acos(n[i]);return this.makeOutput(e,t.shape,"float32")}atan(t){Object(u.a)(t,"atan");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.atan(n[i]);return this.makeOutput(e,t.shape,"float32")}atan2(t,e){return Object(u.a)([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(t,e)=>Math.atan2(t,e))}sinh(t){Object(u.a)(t,"sinh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.sinh(n[i]);return this.makeOutput(e,t.shape,"float32")}cosh(t){Object(u.a)(t,"cosh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.cosh(n[i]);return this.makeOutput(e,t.shape,"float32")}tanh(t){Object(u.a)(t,"tanh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=o.util.tanh(n[i]);return this.makeOutput(e,t.shape,"float32")}asinh(t){Object(u.a)(t,"asinh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.asinh(n[i]);return this.makeOutput(e,t.shape,"float32")}acosh(t){Object(u.a)(t,"acosh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.acosh(n[i]);return this.makeOutput(e,t.shape,"float32")}atanh(t){Object(u.a)(t,"atanh");const e=new Float32Array(t.size),n=this.readSync(t.dataId);for(let i=0;i<n.length;++i)e[i]=Math.atanh(n[i]);return this.makeOutput(e,t.shape,"float32")}erf(t){Object(u.a)(t,"erf");const e=new Float32Array(t.size),n=this.readSync(t.dataId),i=o.backend_util.ERF_P,r=o.backend_util.ERF_A1,s=o.backend_util.ERF_A2,a=o.backend_util.ERF_A3,l=o.backend_util.ERF_A4,c=o.backend_util.ERF_A5;for(let o=0;o<n.length;++o){const t=Math.sign(n[o]),u=Math.abs(n[o]),h=1/(1+i*u);e[o]=t*(1-((((c*h+l)*h+a)*h+s)*h+r)*h*Math.exp(-u*u))}return this.makeOutput(e,t.shape,"float32")}step(t,e=0){Object(u.a)(t,"step");const n=new Float32Array(t.size),i=this.readSync(t.dataId);for(let r=0;r<i.length;++r){const t=i[r];n[r]=isNaN(t)?NaN:t>0?1:e}return this.makeOutput(n,t.shape,"float32")}fusedConv2d({input:t,filter:e,convInfo:n,bias:i,activation:r,preluActivationWeights:s}){let o=this.conv2d(t,e,n);return i&&(o=this.add(o,i)),r&&(o=m(this,o,r,s)),o}conv2d(t,e,n){Object(u.a)([t,e],"conv2d");const i=n.filterHeight,r=n.filterWidth,s=n.dilationHeight,a=n.dilationWidth,l=n.padInfo.left,c=n.padInfo.top,h="channelsLast"===n.dataFormat,d=o.buffer(n.outShape,t.dtype),f=t.strides[0],p=h?t.strides[1]:t.strides[2],m=h?t.strides[2]:1,g=h?1:t.strides[1],y=d.strides[0],v=h?d.strides[1]:d.strides[2],b=h?d.strides[2]:1,x=h?1:d.strides[1],w=this.readSync(t.dataId),T=this.readSync(e.dataId),S=d.values;for(let o=0;o<n.batchSize;++o){const t=o*f,u=o*y;for(let o=0;o<n.outHeight;++o){const h=u+o*v,d=o*n.strideHeight-c;for(let o=0;o<i;o++){const i=d+o*s;if(i<0||i>=n.inHeight)continue;const u=o*e.strides[0],c=t+i*p;for(let t=0;t<n.outWidth;++t){const i=h+t*b,s=t*n.strideWidth-l;for(let t=0;t<r;t++){const r=s+t*a;if(r<0||r>=n.inWidth)continue;const o=c+r*m;let l=u+t*e.strides[1];for(let t=0;t<n.inChannels;++t){const e=w[o+t*g];for(let t=0;t<n.outChannels;++t)S[i+t*x]+=e*T[l+t];l+=n.outChannels}}}}}}return d.toTensor()}conv3d(t,e,n){const i=n.filterDepth,r=n.filterHeight,s=n.filterWidth,a=n.dilationDepth,u=n.dilationHeight,l=n.dilationWidth,c=n.padInfo.front,h=n.padInfo.left,d=n.padInfo.top,f=o.buffer(n.outShape,t.dtype),p=this.readSync(t.dataId),m=this.readSync(e.dataId),g=f.values;for(let o=0;o<n.batchSize;++o){const y=o*t.strides[0],v=o*f.strides[0];for(let o=0;o<n.outDepth;++o){const b=v+o*f.strides[1],x=o*n.strideDepth-c;for(let o=0;o<i;o++){const i=x+o*a;if(i<0||i>=n.inDepth)continue;const c=o*e.strides[0],v=y+i*t.strides[1];for(let o=0;o<n.outHeight;++o){const i=b+o*f.strides[2],a=o*n.strideHeight-d;for(let o=0;o<r;o++){const r=a+o*u;if(r<0||r>=n.inHeight)continue;const d=c+o*e.strides[1],f=v+r*t.strides[2];for(let t=0;t<n.outWidth;++t){const r=i+t*n.outChannels,o=t*n.strideWidth-h;for(let t=0;t<s;t++){const i=o+t*l;if(i<0||i>=n.inWidth)continue;const s=f+i*n.inChannels;let a=d+t*e.strides[2];for(let t=0;t<n.inChannels;++t){const e=p[s+t];for(let t=0;t<n.outChannels;++t)g[r+t]+=e*m[a+t];a+=n.outChannels}}}}}}}}return f.toTensor()}conv2dDerInput(t,e,n){Object(u.a)([t,e],"conv2dDerInput");const i=o.buffer(n.inShape,"float32"),r=i.values,s=this.readSync(t.dataId),a=this.readSync(e.dataId),[l,c,h]=e.strides,{batchSize:d,filterHeight:f,filterWidth:p,inChannels:m,inHeight:g,inWidth:y,outChannels:v,outHeight:b,outWidth:x,strideHeight:w,strideWidth:T,dataFormat:S}=n,E=f-1-n.padInfo.top,O=p-1-n.padInfo.left,C="channelsLast"===S,_=i.strides[0],A=C?i.strides[1]:i.strides[2],k=C?i.strides[2]:1,R=C?1:i.strides[1],I=t.strides[0],M=C?t.strides[1]:t.strides[2],N=C?t.strides[2]:1,D=C?1:t.strides[1];for(let o=0;o<d;++o)for(let t=0;t<m;++t)for(let e=0;e<g;++e){const n=e-E,i=Math.max(0,Math.ceil(n/w)),u=Math.min(b,(f+n)/w);for(let d=0;d<y;++d){const m=d-O,g=Math.max(0,Math.ceil(m/T)),y=Math.min(x,(p+m)/T);let b=0;for(let e=i;e<u;++e){const i=e*w-n;for(let n=g;n<y;++n){const r=I*o+M*e+N*n,u=l*(f-1-i)+c*(p-1-(n*T-m))+h*t;for(let t=0;t<v;++t)b+=s[r+D*t]*a[u+t]}}r[_*o+A*e+k*d+R*t]=b}}return i.toTensor()}conv3dDerInput(t,e,n){const i=o.buffer(n.inShape,"float32"),r=i.values,[s,a,u,l]=i.strides,c=this.readSync(t.dataId),[h,d,f,p]=t.strides,m=this.readSync(e.dataId),[g,y,v,b]=e.strides,{batchSize:x,filterDepth:w,filterHeight:T,filterWidth:S,inChannels:E,inDepth:O,inHeight:C,inWidth:_,outChannels:A,outDepth:k,outHeight:R,outWidth:I,strideDepth:M,strideHeight:N,strideWidth:D}=n,P=w-1-n.padInfo.front,F=T-1-n.padInfo.top,L=S-1-n.padInfo.left;for(let o=0;o<x;++o)for(let t=0;t<E;++t)for(let e=0;e<O;++e){const n=e-P,i=Math.max(0,Math.ceil(n/M)),x=Math.min(k,(w+n)/M);for(let E=0;E<C;++E){const O=E-F,C=Math.max(0,Math.ceil(O/N)),k=Math.min(R,(T+O)/N);for(let R=0;R<_;++R){const _=R-L,P=Math.max(0,Math.ceil(_/D)),F=Math.min(I,(S+_)/D);let j=0;for(let e=i;e<x;++e){const i=e*M-n;for(let n=C;n<k;++n){const r=n*N-O;for(let s=P;s<F;++s){const a=h*o+d*e+f*n+p*s,u=g*(w-1-i)+y*(T-1-r)+v*(S-1-(s*D-_))+b*t;for(let t=0;t<A;++t)j+=c[a+t]*m[u+t]}}}r[s*o+a*e+u*E+l*R+t]=j}}}return i.toTensor()}conv2dDerFilter(t,e,n){Object(u.a)([t,e],"conv2dDerFilter");const i=n.strideHeight,r=n.strideWidth,s=n.filterHeight,a=n.filterWidth,l="channelsLast"===n.dataFormat,c=o.buffer(n.filterShape,"float32"),h=n.padInfo.left,d=n.padInfo.top,f=this.bufferSync(t),p=this.bufferSync(e);for(let o=0;o<s;++o){const t=Math.max(0,Math.ceil((d-o)/i)),e=Math.min(n.outHeight,(n.inHeight+d-o)/i);for(let s=0;s<a;++s){const a=Math.max(0,Math.ceil((h-s)/r)),u=Math.min(n.outWidth,(n.inWidth+h-s)/r);for(let m=0;m<n.inChannels;++m)for(let g=0;g<n.outChannels;++g){let y=0;for(let c=0;c<n.batchSize;++c)for(let n=t;n<e;++n){const t=o+n*i-d;for(let e=a;e<u;++e){const i=s+e*r-h;y+=l?f.get(c,t,i,m)*p.get(c,n,e,g):f.get(c,m,t,i)*p.get(c,g,n,e)}}c.set(y,o,s,m,g)}}}return c.toTensor()}conv3dDerFilter(t,e,n){const i=n.strideDepth,r=n.strideHeight,s=n.strideWidth,a=n.filterDepth,u=n.filterHeight,l=n.filterWidth,c=o.buffer(n.filterShape,"float32"),h=c.values,[d,f,p,m]=c.strides,g=this.readSync(e.dataId),[y,v,b,x]=e.strides,w=this.readSync(t.dataId),[T,S,E,O]=t.strides,C=n.padInfo.front,_=n.padInfo.left,A=n.padInfo.top;for(let o=0;o<a;++o){const t=Math.max(0,Math.ceil((C-o)/i)),e=Math.min(n.outDepth,(n.inDepth+C-o)/i),a=o*d;for(let c=0;c<u;++c){const u=Math.max(0,Math.ceil((A-c)/r)),d=Math.min(n.outHeight,(n.inHeight+A-c)/r),k=c*f+a;for(let a=0;a<l;++a){const l=Math.max(0,Math.ceil((_-a)/s)),f=Math.min(n.outWidth,(n.inWidth+_-a)/s),R=a*p+k;for(let p=0;p<n.inChannels;++p){const k=p*m+R;for(let m=0;m<n.outChannels;++m){let R=0;for(let h=0;h<n.batchSize;++h){const n=h*T,k=h*y;for(let h=t;h<e;++h){const t=(o+h*i-C)*S+n,e=h*v+k;for(let n=u;n<d;++n){const i=(c+n*r-A)*E+t,o=n*b+e;for(let t=l;t<f;++t)R+=w[(a+t*s-_)*O+i+p]*g[t*x+o+m]}}}h[k+m]=R}}}}}return c.toTensor()}fusedDepthwiseConv2D({input:t,filter:e,convInfo:n,bias:i,activation:r,preluActivationWeights:s}){let o=this.depthwiseConv2D(t,e,n);return i&&(o=this.add(o,i)),r&&(o=m(this,o,r,s)),o}depthwiseConv2D(t,e,n){Object(u.a)([t,e],"depthwiseConv2D");const i=n.filterHeight,r=n.filterWidth,s=n.dilationHeight,a=n.dilationWidth,l=n.padInfo.left,c=n.padInfo.top,h=n.outChannels/n.inChannels,d=o.buffer(n.outShape,t.dtype),f=this.readSync(t.dataId),p=this.readSync(e.dataId),m=d.values;for(let o=0;o<n.batchSize;++o){const u=o*t.strides[0],g=o*d.strides[0];for(let o=0;o<n.outHeight;++o){const y=g+o*d.strides[1],v=o*n.strideHeight-l;for(let o=0;o<i;++o){const i=v+o*s;if(i<0||i>=n.inHeight)continue;const l=o*e.strides[0],g=u+i*t.strides[1];for(let t=0;t<n.outWidth;++t){const i=y+t*d.strides[2],s=t*n.strideWidth-c;for(let t=0;t<r;++t){const r=s+t*a;if(r<0||r>=n.inWidth)continue;const o=g+r*n.inChannels;let u=i,c=l+t*e.strides[1];for(let t=0;t<n.inChannels;++t){const e=f[o+t];for(let t=0;t<h;++t)m[u+t]+=e*p[c+t];u+=h,c+=h}}}}}}return d.toTensor()}depthwiseConv2DDerInput(t,e,n){Object(u.a)([t,e],"depthwiseConv2DDerInput");const i=o.buffer(n.inShape,"float32"),r=i.values,[s,a,l]=i.strides,c=this.readSync(t.dataId),[h,d,f]=t.strides,p=this.readSync(e.dataId),[m,g,y]=e.strides,{batchSize:v,filterHeight:b,filterWidth:x,inChannels:w,inHeight:T,inWidth:S,outChannels:E,outHeight:O,outWidth:C,strideHeight:_,strideWidth:A}=n,k=b-1-n.padInfo.top,R=x-1-n.padInfo.left,I=E/w;for(let o=0;o<v;++o)for(let t=0;t<w;++t)for(let e=0;e<T;++e){const n=e-k,i=Math.max(0,Math.ceil(n/_)),u=Math.min(O,(b+n)/_);for(let v=0;v<S;++v){const w=v-R,T=Math.max(0,Math.ceil(w/A)),S=Math.min(C,(x+w)/A);let E=0;for(let e=i;e<u;++e){const i=e*_-n;for(let n=T;n<S;++n){const r=h*o+d*e+f*n,s=m*(b-1-i)+g*(x-1-(n*A-w))+y*t;for(let e=0;e<I;++e)E+=c[r+(t*I+e)]*p[s+e]}}r[s*o+a*e+l*v+t]=E}}return i.toTensor()}depthwiseConv2DDerFilter(t,e,n){Object(u.a)([t,e],"depthwiseConv2DDerFilter");const i=n.strideHeight,r=n.strideWidth,s=n.filterHeight,a=n.filterWidth,l=o.buffer(n.filterShape,"float32"),c=n.padInfo.left,h=n.padInfo.top,d=n.outChannels/n.inChannels,f=this.bufferSync(t),p=this.bufferSync(e);for(let o=0;o<s;++o){const t=Math.max(0,Math.ceil((h-o)/i)),e=Math.min(n.outHeight,(n.inHeight+h-o)/i);for(let s=0;s<a;++s){const a=Math.max(0,Math.ceil((c-s)/r)),u=Math.min(n.outWidth,(n.inWidth+c-s)/r);for(let m=0;m<n.outChannels;++m){const g=Math.trunc(m/d),y=m%d;let v=0;for(let l=0;l<n.batchSize;++l)for(let n=t;n<e;++n){const t=o+n*i-h;for(let e=a;e<u;++e)v+=f.get(l,t,s+e*r-c,g)*p.get(l,n,e,m)}l.set(v,o,s,g,y)}}}return l.toTensor()}tile(t,e){return Object(u.a)(t,"tile"),d(this.bufferSync(t),e)}pad(t,e,n){Object(u.a)(t,"pad");const i=e.map((e,n)=>e[0]+t.shape[n]+e[1]),r=e.map(t=>t[0]),s=this.bufferSync(t),a=o.buffer(i,t.dtype);0!==n&&a.values.fill(n);for(let o=0;o<t.size;o++){const t=s.indexToLoc(o),e=t.map((t,e)=>t+r[e]);a.set(s.get(...t),...e)}return a.toTensor()}gather(t,e,n){Object(u.a)([t,e],"gather");const i=t.shape.slice(),r=this.readSync(e.dataId);i[n]=r.length;const s=o.buffer(i,t.dtype),a=this.bufferSync(t);for(let o=0;o<s.size;++o){const t=s.indexToLoc(o),e=t.slice();e[n]=r[t[n]];const i=a.locToIndex(e);s.values[o]=a.values[i]}return s.toTensor()}batchToSpaceND(t,e,n){Object(u.a)([t],"batchToSpaceND");const i=e.reduce((t,e)=>t*e),r=o.backend_util.getReshaped(t.shape,e,i),s=o.backend_util.getPermuted(r.length,e.length),a=o.backend_util.getReshapedPermuted(t.shape,e,i),l=o.backend_util.getSliceBeginCoords(n,e.length),c=o.backend_util.getSliceSize(a,n,e.length);return o.transpose(t.reshape(r),s).reshape(a).slice(l,c)}spaceToBatchND(t,e,n){Object(u.a)([t],"spaceToBatchND");const i=e.reduce((t,e)=>t*e),r=[[0,0]];r.push(...n);for(let o=1+e.length;o<t.shape.length;++o)r.push([0,0]);const s=t.pad(r),a=o.backend_util.getReshaped(s.shape,e,i,!1),l=o.backend_util.getPermuted(a.length,e.length,!1),c=o.backend_util.getReshapedPermuted(s.shape,e,i,!1);return o.transpose(s.reshape(a),l).reshape(c)}maxPool(t,e){Object(u.a)(t,"maxPool");const n=this.readSync(t.dataId);return Object(l.b)(n,t.shape,t.dtype,t.strides,e,"max").toTensor()}maxPoolBackprop(t,e,n,i){Object(u.a)([e,n],"maxPoolBackprop");const r=this.readSync(e.dataId),s=Object(o.buffer)(i.outShape,e.dtype,Object(l.a)(r,e.shape,e.dtype,i).values),a=i.strideHeight,c=i.strideWidth,h=i.dilationHeight,d=i.dilationWidth,f=i.effectiveFilterHeight,p=i.effectiveFilterWidth,m=p-1-i.padInfo.left,g=f-1-i.padInfo.top,y=o.buffer(e.shape,"float32"),v=this.bufferSync(t);for(let o=0;o<i.batchSize;++o)for(let t=0;t<i.inChannels;++t)for(let e=0;e<i.inHeight;++e)for(let n=0;n<i.inWidth;++n){const r=e-g,u=n-m;let l=0;for(let e=0;e<f;e+=h){const n=(r+e)/a;if(!(n<0||n>=i.outHeight||Math.floor(n)!==n))for(let r=0;r<p;r+=d){const a=(u+r)/c;if(a<0||a>=i.outWidth||Math.floor(a)!==a)continue;const h=f*p-1-s.get(o,n,a,t)===e*p+r?1:0;0!==h&&(l+=v.get(o,n,a,t)*h)}}y.set(l,o,e,n,t)}return y.toTensor()}avgPoolBackprop(t,e,n){Object(u.a)([t,e],"avgPoolBackprop");const i=n.strideHeight,r=n.strideWidth,s=n.filterHeight,a=n.filterWidth,l=n.dilationHeight,c=n.dilationWidth,h=n.effectiveFilterHeight,d=n.effectiveFilterWidth,f=d-1-n.padInfo.left,p=h-1-n.padInfo.top,m=o.buffer(e.shape,"float32"),g=1/(s*a),y=this.bufferSync(t);for(let o=0;o<n.batchSize;++o)for(let t=0;t<n.inChannels;++t)for(let e=0;e<n.inHeight;++e)for(let s=0;s<n.inWidth;++s){const a=e-p,u=s-f;let v=0;for(let e=0;e<h;e+=l){const s=(a+e)/i;if(!(s<0||s>=n.outHeight||Math.floor(s)!==s))for(let e=0;e<d;e+=c){const i=(u+e)/r;i<0||i>=n.outWidth||Math.floor(i)!==i||(v+=y.get(o,s,i,t))}}m.set(v*g,o,e,s,t)}return m.toTensor()}pool3d(t,e,n){Object(u.a)(t,"pool3d");const i=e.strideDepth,r=e.strideHeight,s=e.strideWidth,a=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,m=e.padInfo.top,g=e.padInfo.left,y="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(t.dataId),b=o.buffer(e.outShape,t.dtype),x=b.values,w=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],T=e.outShape[2]*e.outShape[3]*e.outShape[4],S=e.outShape[3]*e.outShape[4],E=e.outShape[4];for(let o=0;o<e.batchSize;++o){const u=o*w,b=o*t.strides[0];for(let o=0;o<e.inChannels;++o)for(let w=0;w<e.outDepth;++w){const O=w*i-p;let C=O;for(;C<0;)C+=a;const _=Math.min(e.inDepth,h+O),A=u+w*T;for(let i=0;i<e.outHeight;++i){const u=i*r-m;let h=u;for(;h<0;)h+=l;const p=Math.min(e.inHeight,d+u),w=A+i*S;for(let i=0;i<e.outWidth;++i){const r=i*s-g;let u=r;for(;u<0;)u+=c;const d=Math.min(e.inWidth,f+r),m=w+i*E;let T=y,S=0,O=0;for(let e=C;e<_;e+=a){const i=b+e*t.strides[1];for(let e=h;e<p;e+=l){const r=i+e*t.strides[2];for(let e=u;e<d;e+=c){const i=v[r+e*t.strides[3]+o];if("max"===n&&i>T?T=i:"avg"===n&&(S+=i,O++),isNaN(T))break}if(isNaN(T))break}if(isNaN(T))break}x[m+o]="avg"===n?S/O:T}}}}return b.toTensor()}avgPool3d(t,e){return Object(u.a)(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()}avgPool3dBackprop(t,e,n){Object(u.a)([t,e],"avgPool3dBackprop");const i=n.strideDepth,r=n.strideHeight,s=n.strideWidth,a=n.filterDepth,l=n.filterHeight,c=n.filterWidth,h=n.dilationDepth,d=n.dilationHeight,f=n.dilationWidth,p=n.effectiveFilterDepth,m=n.effectiveFilterHeight,g=n.effectiveFilterWidth,y=p-1-n.padInfo.front,v=g-1-n.padInfo.left,b=m-1-n.padInfo.top,x=o.buffer(e.shape,"float32"),w=1/(a*l*c),T=this.bufferSync(t);for(let o=0;o<n.batchSize;++o)for(let t=0;t<n.inChannels;++t)for(let e=0;e<n.inDepth;++e)for(let a=0;a<n.inHeight;++a)for(let u=0;u<n.inWidth;++u){const l=e-y,c=a-b,S=u-v;let E=0;for(let e=0;e<p;e+=h){const a=(l+e)/i;if(!(a<0||a>=n.outDepth||Math.floor(a)!==a))for(let e=0;e<m;e+=d){const i=(c+e)/r;if(!(i<0||i>=n.outHeight||Math.floor(i)!==i))for(let e=0;e<g;e+=f){const r=(S+e)/s;r<0||r>=n.outWidth||Math.floor(r)!==r||(E+=T.get(o,a,i,r,t))}}}x.set(E*w,o,e,a,u,t)}return x.toTensor()}maxPool3d(t,e){return Object(u.a)(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()}maxPool3dPositions(t,e){const n=o.buffer(e.outShape,"int32"),i=e.strideDepth,r=e.strideHeight,s=e.strideWidth,a=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left,g=this.bufferSync(t);for(let o=0;o<e.batchSize;++o)for(let t=0;t<e.inChannels;++t)for(let y=0;y<e.outDepth;++y){const v=y*i-f;let b=v;for(;b<0;)b+=a;const x=Math.min(e.inDepth,c+v);for(let i=0;i<e.outHeight;++i){const c=i*r-p;let f=c;for(;f<0;)f+=u;const w=Math.min(e.inHeight,h+c);for(let r=0;r<e.outWidth;++r){const p=r*s-m;let T=p;for(;T<0;)T+=l;const S=Math.min(e.inWidth,d+p);let E=Number.NEGATIVE_INFINITY,O=-1;for(let e=b;e<x;e+=a){const n=e-v;for(let i=f;i<w;i+=u){const r=i-c;for(let s=T;s<S;s+=l){const a=s-p,u=g.get(o,e,i,s,t);u>=E&&(E=u,O=n*h*d+r*h+a)}}}n.set(O,o,y,i,r,t)}}}return n.toTensor()}maxPool3dBackprop(t,e,n,i){Object(u.a)([e,n],"maxPool3dBackprop");const r=this.maxPool3dPositions(e,i),s=i.strideDepth,a=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,h=i.dilationHeight,d=i.dilationWidth,f=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=f-1-i.padInfo.front,y=m-1-i.padInfo.left,v=p-1-i.padInfo.top,b=o.buffer(e.shape,"float32"),x=this.bufferSync(r),w=this.bufferSync(t);for(let o=0;o<i.batchSize;++o)for(let t=0;t<i.inChannels;++t)for(let e=0;e<i.inDepth;++e)for(let n=0;n<i.inHeight;++n)for(let r=0;r<i.inWidth;++r){const u=e-g,T=n-v,S=r-y;let E=0;for(let e=0;e<f;e+=c){const n=(u+e)/s;if(!(n<0||n>=i.outDepth||Math.floor(n)!==n))for(let r=0;r<p;r+=h){const s=(T+r)/a;if(!(s<0||s>=i.outHeight||Math.floor(s)!==s))for(let a=0;a<m;a+=d){const u=(S+a)/l;if(u<0||u>=i.outWidth||Math.floor(u)!==u)continue;const c=f*p*m-1-x.get(o,n,s,u,t)===e*p*m+r*m+a?1:0;0!==c&&(E+=w.get(o,n,s,u,t)*c)}}}b.set(E,o,e,n,r,t)}return b.toTensor()}cast(t,e){return o.backend_util.castTensor(t,e,this)}reshape(t,e){return o.backend_util.reshapeTensor(t,e)}avgPool(t,e){Object(u.a)(t,"avgPool"),Object(u.a)(t,"maxPool");const n=this.readSync(t.dataId);return Object(l.b)(n,t.shape,t.dtype,t.strides,e,"avg").toTensor().toFloat()}resizeBilinear(t,e,n,i){Object(u.a)(t,"resizeBilinear");const[r,s,a,l]=t.shape,c=this.readSync(t.dataId),h=new Float32Array(o.util.sizeFromShape([r,e,n,l])),d=[i&&e>1?s-1:s,i&&n>1?a-1:a],f=[i&&e>1?e-1:e,i&&n>1?n-1:n];let p=0;const m=d[0]/f[0],g=d[1]/f[1];for(let o=0;o<r;o++)for(let i=0;i<e;i++){const e=m*i,r=Math.floor(e),u=e-r,d=Math.min(s-1,Math.ceil(e)),f=o*t.strides[0]+r*t.strides[1],y=o*t.strides[0]+d*t.strides[1];for(let i=0;i<n;i++){const e=g*i,n=Math.floor(e),r=e-n,s=Math.min(a-1,Math.ceil(e)),o=f+n*t.strides[2],d=y+n*t.strides[2],m=f+s*t.strides[2],v=y+s*t.strides[2];for(let t=0;t<l;t++){const e=c[o+t],n=c[d+t],i=e+(c[m+t]-e)*r;h[p++]=i+(n+(c[v+t]-n)*r-i)*u}}}return o.tensor(h,[r,e,n,l])}resizeBilinearBackprop(t,e,n){Object(u.a)([t,e],"resizeBilinearBackprop");const[i,r,s,a]=e.shape,[,l,c]=t.shape,h=new Float32Array(i*r*s*a),d=[n&&l>1?r-1:r,n&&c>1?s-1:s],f=[n&&l>1?l-1:l,n&&c>1?c-1:c],p=d[0]/f[0],m=d[1]/f[1],g=this.readSync(t.dataId);let y=0;for(let o=0;o<i;o++){const t=o*e.strides[0];for(let n=0;n<l;n++){const i=n*p,o=Math.floor(i),u=Math.min(Math.ceil(i),r-1),l=t+o*e.strides[1],d=t+u*e.strides[1],f=i-o,v=1-f;for(let t=0;t<c;t++){const n=t*m,i=Math.floor(n),r=Math.min(Math.ceil(n),s-1),o=n-i,u=1-o,c=l+i*e.strides[2],p=l+r*e.strides[2],b=d+i*e.strides[2],x=d+r*e.strides[2],w=v*u,T=v*o,S=f*u,E=f*o;for(let t=0;t<a;t++){const e=g[y++];h[c+t]+=e*w,h[p+t]+=e*T,h[b+t]+=e*S,h[x+t]+=e*E}}}}return o.tensor4d(h,[i,s,r,a],e.dtype)}resizeNearestNeighbor(t,e,n,i){Object(u.a)(t,"resizeNearestNeighbor");const[r,s,a,l]=t.shape,c=this.readSync(t.dataId),h=new Float32Array(r*e*n*l),d=[i&&e>1?s-1:s,i&&n>1?a-1:a],f=[i&&e>1?e-1:e,i&&n>1?n-1:n],p=d[0]/f[0],m=d[1]/f[1];let g=0;for(let o=0;o<r;o++){const r=o*t.strides[0];for(let o=0;o<e;o++){const e=p*o,u=r+Math.min(s-1,i?Math.round(e):Math.floor(e))*t.strides[1];for(let r=0;r<n;r++){const e=m*r,n=u+Math.min(a-1,i?Math.round(e):Math.floor(e))*t.strides[2];for(let t=0;t<l;t++)h[g++]=c[n+t]}}}return o.tensor(h,[r,e,n,l],t.dtype)}resizeNearestNeighborBackprop(t,e,n){Object(u.a)([t,e],"resizeNearestNeighborBackprop");const[i,r,s,a]=e.shape,[,l,c]=t.shape,h=new Float32Array(i*r*s*a),d=this.readSync(t.dataId),f=[n&&l>1?r-1:r,n&&c>1?s-1:s],p=[n&&l>1?l-1:l,n&&c>1?c-1:c],m=f[0]/p[0],g=f[1]/p[1],y=1/m,v=1/g,b=2*Math.ceil(y)+2,x=2*Math.ceil(v)+2;for(let o=0;o<i;o++){const i=o*e.strides[0];for(let o=0;o<r;o++){const u=i+o*e.strides[1],f=Math.floor(o*y),p=Math.floor(f-b/2);for(let y=0;y<s;y++){const f=u+y*e.strides[2],w=Math.floor(y*v),T=Math.floor(w-x/2);for(let e=0;e<a;e++){let a=0;for(let u=0;u<b;u++){const h=u+p;if(h<0||h>=l)continue;const f=i+h*t.strides[1],v=h*m;if(o===Math.min(r-1,n?Math.round(v):Math.floor(v)))for(let i=0;i<x;i++){const r=i+T;if(r<0||r>=c)continue;const o=f+r*t.strides[2],u=r*g;y===Math.min(s-1,n?Math.round(u):Math.floor(u))&&(a+=d[o+e])}}h[f+e]=a}}}}return o.tensor4d(h,e.shape,e.dtype)}batchNorm(t,e,n,i,r,s){Object(u.a)([t,e,n,r,i],"batchNorm");const a=this.readSync(t.dataId),l=this.readSync(e.dataId),c=this.readSync(n.dataId),h=r?this.readSync(r.dataId):new Float32Array([1]),d=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(a.length),p=d.length,m=h.length,g=c.length,y=l.length;let v=0,b=0,x=0,w=0;for(let o=0;o<a.length;++o)f[o]=d[v++]+(a[o]-l[b++])*h[x++]/Math.sqrt(c[w++]+s),v>=p&&(v=0),b>=y&&(b=0),x>=m&&(x=0),w>=g&&(w=0);return o.tensor4d(f,t.shape)}localResponseNormalization4D(t,e,n,i,r){Object(u.a)(t,"localResponseNormalization4D");const s=t.shape[3],a=s-1,l=this.readSync(t.dataId),c=t.size,h=new Float32Array(c);function d(t){const n=t%s;let i=t-n+Math.max(0,n-e);const r=t-n+Math.min(n+e,a);let o=0;for(;i<=r;i++){const t=l[i];o+=t*t}return o}for(let o=0;o<c;o++){const t=d(o),e=l[o]*Math.pow(n+i*t,-r);h[o]=e}return o.tensor4d(h,t.shape)}LRNGrad(t,e,n,i,r,s,a){Object(u.a)(t,"LRNGrad");const l=t.shape[3],c=this.readSync(t.dataId),h=this.readSync(e.dataId),d=this.readSync(n.dataId),f=new Float32Array(t.size),p=t.size;for(let o=0;o<p;o++){const t=o%l,e=o-t+Math.max(0,t-i),n=o-t+Math.min(l,t+i+1);let u=0;for(let i=e;i<n;i++)u+=Math.pow(h[i],2);u=s*u+r;for(let i=e;i<n;i++){let t=-2*s*a*h[i]*d[o]/u;o===i&&(t+=Math.pow(u,-a)),t*=c[o],f[i]+=t}}return o.tensor4d(f,t.shape)}multinomial(t,e,n,i){Object(u.a)(t,"multinomial");const r=e?t:o.softmax(t),s=r.shape[0],l=r.shape[1],c=o.zeros([s,n],"int32"),h=this.readSync(c.dataId),d=this.readSync(r.dataId);for(let o=0;o<s;++o){const t=o*l,e=new Float32Array(l-1);e[0]=d[t];for(let n=1;n<e.length;++n)e[n]=e[n-1]+d[t+n];const r=a.alea(i.toString()),s=o*n;for(let i=0;i<n;++i){const t=r();h[s+i]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){h[s+i]=n;break}}}return c}oneHot(t,e,n,i){Object(u.a)(t,"oneHot");const r=new Float32Array(t.size*e);r.fill(i);const s=this.readSync(t.dataId);for(let o=0;o<t.size;++o)s[o]>=0&&s[o]<e&&(r[o*e+s[o]]=n);return o.tensor2d(r,[t.size,e],"int32")}nonMaxSuppression(t,e,n,i,r){Object(u.a)(t,"nonMaxSuppression");const s=this.readSync(t.dataId),o=this.readSync(e.dataId);return c(s,o,n,i,r)}fft(t){return this.fftBatch(t,!1)}ifft(t){return this.fftBatch(t,!0)}fftBatch(t,e){const n=t.shape[0],i=t.shape[1],r=o.buffer(t.shape,"float32"),s=o.buffer(t.shape,"float32"),a=o.real(t).as2D(n,i),u=o.imag(t).as2D(n,i);for(let l=0;l<n;l++){const t=a.slice([l,0],[1,i]),n=u.slice([l,0],[1,i]),c=o.complex(t,n),h=this.readSync(this.fftImpl(c,e).dataId);for(let e=0;e<i;e++){const t=o.backend_util.getComplexWithIndex(h,e);r.values[l*i+e]=t.real,s.values[l*i+e]=t.imag}}return o.complex(r.toTensor(),s.toTensor()).as2D(n,i)}fftImpl(t,e){const n=t.as1D(),i=n.size;if(this.isExponentOf2(i)){let r=this.fftRadix2(n,i,e).as2D(t.shape[0],t.shape[1]);return e&&(r=o.complex(o.real(r).div(o.scalar(i)),o.imag(r).div(o.scalar(i)))),r}{const n=this.readSync(t.dataId),r=this.fourierTransformByMatmul(n,i,e),s=o.backend_util.splitRealAndImagArrays(r);return o.complex(s.real,s.imag).as2D(t.shape[0],t.shape[1])}}isExponentOf2(t){return 0==(t&t-1)}fftRadix2(t,e,n){if(1===e)return t;const i=this.readSync(t.dataId),r=e/2,s=o.backend_util.complexWithEvenIndex(i);let a=o.complex(s.real,s.imag).as1D();const u=o.backend_util.complexWithOddIndex(i);let l=o.complex(u.real,u.imag).as1D();a=this.fftRadix2(a,r,n),l=this.fftRadix2(l,r,n);const c=o.backend_util.exponents(e,n),h=o.complex(c.real,c.imag).mul(l),d=a.add(h),f=a.sub(h),p=o.real(d).concat(o.real(f)),m=o.imag(d).concat(o.imag(f));return o.complex(p,m).as1D()}fourierTransformByMatmul(t,e,n){const i=new Float32Array(2*e);for(let r=0;r<e;r++){let s=0,a=0;for(let i=0;i<e;i++){const u=o.backend_util.exponent(r*i,e,n),l=o.backend_util.getComplexWithIndex(t,i);s+=l.real*u.real-l.imag*u.imag,a+=l.real*u.imag+l.imag*u.real}n&&(s/=e,a/=e),o.backend_util.assignToTypedArray(i,s,a,r)}return i}depthToSpace(t,e,n){o.util.assert("NHWC"===n,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n),o.util.assert(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+e);const i=t.shape[0],r=t.shape[1],s=t.shape[2],a=t.shape[3],u=r*e,l=s*e,c=a/(e*e),h=this.readSync(t.dataId),d=new Float32Array(i*u*l*c);let f=0;for(let o=0;o<i;++o)for(let t=0;t<u;++t){const n=Math.floor(t/e),i=t%e;for(let t=0;t<l;++t){const u=Math.floor(t/e),l=(i*e+t%e)*c;for(let t=0;t<c;++t)d[f++]=h[t+l+a*(u+s*(n+r*o))]}}return o.tensor4d(d,[i,u,l,c])}broadcastedBinaryOp(t,e,n,i){const r=o.backend_util.assertAndGetBroadcastShape(t.shape,e.shape),s=o.buffer(r,n),a=this.readSync(t.dataId),u=this.readSync(e.dataId),l=o.backend_util.getBroadcastDims(t.shape,r),c=o.backend_util.getBroadcastDims(e.shape,r),h=s.values;if(l.length+c.length===0)for(let o=0;o<h.length;++o)h[o]=i(a[o%a.length],u[o%u.length]);else{const n=this.bufferSync(t),r=this.bufferSync(e);for(let o=0;o<h.length;++o){const d=s.indexToLoc(o),f=d.slice(-t.rank);l.forEach(t=>f[t]=0);const p=n.locToIndex(f),m=d.slice(-e.rank);c.forEach(t=>m[t]=0);const g=r.locToIndex(m);h[o]=i(a[p],u[g])}}return s.toTensor()}broadcastedBinaryComplexOp(t,e,n){const i=o.backend_util.assertAndGetBroadcastShape(t.shape,e.shape),r=o.buffer(i,"float32"),s=o.buffer(i,"float32"),a=this.readSync(t.dataId),u=this.readSync(e.dataId),l=o.backend_util.getBroadcastDims(t.shape,i),c=o.backend_util.getBroadcastDims(e.shape,i),h=r.values,d=s.values;if(l.length+c.length===0)for(let o=0;o<h.length;o++){const t=o%a.length,e=o%u.length,i=n(a[2*t],a[2*t+1],u[2*e],u[2*e+1]);h[o]=i.real,d[o]=i.imag}else{const i=this.bufferSync(this.data.get(t.dataId).complexTensors.real),s=this.bufferSync(this.data.get(e.dataId).complexTensors.real);for(let o=0;o<h.length;o++){const f=r.indexToLoc(o),p=f.slice(-t.rank);l.forEach(t=>p[t]=0);const m=i.locToIndex(p),g=f.slice(-e.rank);c.forEach(t=>g[t]=0);const y=s.locToIndex(g),v=n(a[2*m],a[2*m+1],u[2*y],u[2*y+1]);h[o]=v.real,d[o]=v.imag}}return this.complex(r.toTensor(),s.toTensor())}split(t,e,n){return h(t,e,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}cropAndResize(t,e,n,i,r,s){const[a,u,l,c]=t.shape,h=e.shape[0],[d,f]=i,p=o.buffer([h,d,f,c],"float32"),m=this.readSync(e.dataId),g=this.readSync(n.dataId),y=this.readSync(t.dataId),v=t.strides,b=p.strides;for(let o=0;o<h;o++){const t=4*o,e=m[t],n=m[t+1],i=m[t+2],h=m[t+3],x=g[o];if(x>=a)continue;const w=d>1?(i-e)*(u-1)/(d-1):0,T=f>1?(h-n)*(l-1)/(f-1):0;for(let a=0;a<d;a++){const t=d>1?e*(u-1)+a*w:.5*(e+i)*(u-1);if(t<0||t>u-1)for(let e=0;e<f;e++)for(let t=0;t<c;t++)p.values[t+e*b[2]+a*b[1]+o*b[0]]=s;else if("bilinear"===r){const e=Math.floor(t),i=Math.ceil(t),r=t-e;for(let t=0;t<f;t++){const u=f>1?n*(l-1)+t*T:.5*(n+h)*(l-1);if(u<0||u>l-1){for(let e=0;e<c;e++)p.values[e+t*b[2]+a*b[1]+o*b[0]]=s;continue}const d=Math.floor(u),m=Math.ceil(u),g=u-d;for(let n=0;n<c;n++){let s=n+d*v[2]+e*v[1]+x*v[0];const u=y[s];s=n+m*v[2]+e*v[1]+x*v[0];const l=y[s];s=n+d*v[2]+i*v[1]+x*v[0];const c=y[s];s=n+m*v[2]+i*v[1]+x*v[0];const h=y[s],f=u+(l-u)*g;s=n+t*b[2]+a*b[1]+o*b[0],p.values[s]=f+(c+(h-c)*g-f)*r}}}else for(let e=0;e<f;++e){const i=f>1?n*(l-1)+e*T:.5*(n+h)*(l-1);if(i<0||i>l-1){for(let t=0;t<c;t++)p.values[t+e*b[2]+a*b[1]+o*b[0]]=s;continue}const r=Math.round(i),u=Math.round(t);for(let t=0;t<c;t++)p.values[t+e*b[2]+a*b[1]+o*b[0]]=y[t+r*v[2]+u*v[1]+x*v[0]]}}}return p.toTensor()}sparseToDense(t,e,n,i){const{sliceRank:r,numUpdates:s,sliceSize:a,strides:u,outputSize:l}=o.backend_util.calculateShapes(e,t,n);return this.scatter(t,e,n,l,a,s,r,u,i,!1)}gatherND(t,e){const n=e.shape,i=n[n.length-1],[r,s,a,u]=o.backend_util.prepareAndValidate(t,e);if(0===s)return o.tensor([],r,t.dtype);const l=new o.TensorBuffer([s,a],t.dtype),c=this.readSync(e.dataId),h=this.readSync(t.dataId);for(let o=0;o<s;o++){const e=[];let n=0;for(let t=0;t<i;t++){const r=c[o*i+t];n+=r*u[t],e.push(r)}if(n<0||n>=t.size/a)throw new Error(`Invalid indices: ${e} does not index into ${t.shape}`);for(let t=0;t<a;t++)l.values[o*a+t]=h[n*a+t]}return l.toTensor().reshape(r)}scatterND(t,e,n){const{sliceRank:i,numUpdates:r,sliceSize:s,strides:a,outputSize:u}=o.backend_util.calculateShapes(e,t,n),l=o.scalar(0);return this.scatter(t,e,n,u,s,r,i,a,l,!0)}fill(t,e,n){n=n||o.util.inferDtype(e);const i=o.util.getArrayFromDType(n,o.util.sizeFromShape(t));return i.fill(e),Object(o.engine)().makeTensor(i,t,n,this)}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)}zerosLike(t){const e=o.util.getArrayFromDType(t.dtype,o.util.sizeFromShape(t.shape));return this.makeOutput(e,t.shape,t.dtype)}linspace(t,e,n){return o.backend_util.linspaceImpl(t,e,n)}scatter(t,e,n,i,r,s,a,u,l,c){const h=[i/r,r],d=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===i)return o.tensor([],n,e.dtype);const p=new o.TensorBuffer(h,e.dtype);p.values.fill(this.readSync(l.dataId)[0]);for(let o=0;o<s;o++){const t=[];let s=0;for(let e=0;e<a;e++){const n=d[o*a+e];t.push(n),s+=n*u[e]}if(s<0||s>=i/r)throw new Error(`Invalid indices: ${t} does not index into ${n}`);for(let n=0;n<r;n++)c?p.values[s*r+n]+=f[o*r+n]:p.values[s*r+n]=0===e.rank?f[0]:f[o*r+n]}return p.toTensor().reshape(n)}}const y="2.0.1"},function(t,e,n){(function(e){t.exports=function t(e,n,i){function r(o,a){if(!n[o]){if(!e[o]){if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){return r(e[o][1][t]||t)},l,l.exports,t,e,n,i)}return n[o].exports}for(var s=!1,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,n,i){(function(t){"use strict";var e,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var s=0,o=new r(c),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),e=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)e="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var u=new t.MessageChannel;u.port1.onmessage=c,e=function(){u.port2.postMessage(0)}}var l=[];function c(){var t,e;i=!0;for(var n=l.length;n;){for(e=l,l=[],t=-1;++t<n;)e[t]();n=l.length}i=!1}n.exports=function(t){1!==l.push(t)||i||e()}}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var i=t(1);function r(){}var s={},o=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==r&&f(this,t)}function c(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){i(function(){var i;try{i=e(n)}catch(r){return s.reject(t,r)}i===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,i)})}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function f(t,e){var n=!1;function i(e){n||(n=!0,s.reject(t,e))}function r(e){n||(n=!0,s.resolve(t,e))}var o=p(function(){e(r,i)});"error"===o.status&&i(o.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(i){n.status="error",n.value=i}return n}e.exports=l,l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===o)return this;var n=new this.constructor(r);return this.state!==u?h(n,this.state===a?t:e,this.outcome):this.queue.push(new c(n,t,e)),n},c.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},c.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},c.prototype.callRejected=function(t){s.reject(this.promise,t)},c.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},s.resolve=function(t,e){var n=p(d,e);if("error"===n.status)return s.reject(t,n.value);var i=n.value;if(i)f(t,i);else{t.state=a,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},s.reject=function(t,e){t.state=o,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},l.resolve=function(t){return t instanceof this?t:s.resolve(new this(r),t)},l.reject=function(t){var e=new this(r);return s.reject(e,t)},l.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,u=-1,l=new this(r);++u<n;)c(t[u],u);return l;function c(t,r){e.resolve(t).then(function(t){o[r]=t,++a!==n||i||(i=!0,s.resolve(l,o))},function(t){i||(i=!0,s.reject(l,t))})}},l.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,n=!1;if(!e)return this.resolve([]);for(var i=-1,o=new this(r);++i<e;)this.resolve(t[i]).then(function(t){n||(n=!0,s.resolve(o,t))},function(t){n||(n=!0,s.reject(o,t))});return o}},{1:1}],3:[function(t,n,i){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function s(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var o=Promise;function a(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function l(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function c(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var h="local-forage-detect-blob-support",d=void 0,f={},p=Object.prototype.toString,m="readonly",g="readwrite";function y(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t.charCodeAt(r);return n}function v(t){var e=f[t.name],n={};n.promise=new o(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady=e.dbReady?e.dbReady.then(function(){return n.promise}):n.promise}function b(t){var e=f[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function x(t,e){var n=f[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function w(t,e){return new o(function(n,i){if(f[t.name]=f[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);v(t),t.db.close()}var s=[t.name];e&&s.push(t.version);var o=r.open.apply(r,s);e&&(o.onupgradeneeded=function(e){var n=o.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(h)}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),o.onerror=function(t){t.preventDefault(),i(o.error)},o.onsuccess=function(){n(o.result),b(t)}})}function T(t){return w(t,!1)}function S(t){return w(t,!0)}function E(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),i=t.version>t.db.version;if(t.version<t.db.version&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||n){if(n){var r=t.db.version+1;r>t.version&&(t.version=r)}return!0}return!1}function O(t){return s([y(atob(t.data))],{type:t.type})}function C(t){return t&&t.__local_forage_encoded_blob}function _(t){var e=this,n=e._initReady().then(function(){var t=f[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return u(n,t,t),n}function A(t,e,n,i){void 0===i&&(i=1);try{var r=t.db.transaction(t.storeName,e);n(null,r)}catch(s){if(i>0&&(!t.db||"InvalidStateError"===s.name||"NotFoundError"===s.name))return o.resolve().then(function(){if(!t.db||"NotFoundError"===s.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),S(t)}).then(function(){return function(t){v(t);for(var e=f[t.name],n=e.forages,i=0;i<n.length;i++){var r=n[i];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,T(t).then(function(e){return t.db=e,E(t)?S(t):e}).then(function(i){t.db=e.db=i;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=i}).catch(function(e){throw x(t,e),e})}(t).then(function(){A(t,e,n,i-1)})}).catch(n);n(s)}}var k={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]=t[i];var r=f[n.name];r||(f[n.name]=r={forages:[],db:null,dbReady:null,deferredOperations:[]}),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=_);var s=[];function a(){return o.resolve()}for(var u=0;u<r.forages.length;u++){var l=r.forages[u];l!==e&&s.push(l._initReady().catch(a))}var c=r.forages.slice(0);return o.all(s).then(function(){return n.db=r.db,T(n)}).then(function(t){return n.db=t,E(n,e._defaultConfig.version)?S(n):t}).then(function(t){n.db=r.db=t,e._dbInfo=n;for(var i=0;i<c.length;i++){var s=c[i];s!==e&&(s._dbInfo.db=n.db,s._dbInfo.version=n.version)}})},_support:function(){try{if(!r)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(n){return!1}}(),iterate:function(t,e){var n=this,i=new o(function(e,i){n.ready().then(function(){A(n._dbInfo,m,function(r,s){if(r)return i(r);try{var o=s.objectStore(n._dbInfo.storeName).openCursor(),a=1;o.onsuccess=function(){var n=o.result;if(n){var i=n.value;C(i)&&(i=O(i));var r=t(i,n.key,a++);void 0!==r?e(r):n.continue()}else e()},o.onerror=function(){i(o.error)}}catch(u){i(u)}})}).catch(i)});return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=new o(function(e,i){n.ready().then(function(){A(n._dbInfo,m,function(r,s){if(r)return i(r);try{var o=s.objectStore(n._dbInfo.storeName).get(t);o.onsuccess=function(){var t=o.result;void 0===t&&(t=null),C(t)&&(t=O(t)),e(t)},o.onerror=function(){i(o.error)}}catch(a){i(a)}})}).catch(i)});return a(i,e),i},setItem:function(t,e,n){var i=this;t=l(t);var r=new o(function(n,r){var a;i.ready().then(function(){return a=i._dbInfo,"[object Blob]"===p.call(e)?function(t){return"boolean"==typeof d?o.resolve(d):function(t){return new o(function(e){var n=t.transaction(h,g),i=s([""]);n.objectStore(h).put(i,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}(t).then(function(t){return d=t})}(a.db).then(function(t){return t?e:(n=e,new o(function(t,e){var i=new FileReader;i.onerror=e,i.onloadend=function(e){var i=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:i,type:n.type})},i.readAsBinaryString(n)}));var n}):e}).then(function(e){A(i._dbInfo,g,function(s,o){if(s)return r(s);try{var a=o.objectStore(i._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);o.oncomplete=function(){void 0===e&&(e=null),n(e)},o.onabort=o.onerror=function(){r(u.error?u.error:u.transaction.error)}}catch(l){r(l)}})}).catch(r)});return a(r,n),r},removeItem:function(t,e){var n=this;t=l(t);var i=new o(function(e,i){n.ready().then(function(){A(n._dbInfo,g,function(r,s){if(r)return i(r);try{var o=s.objectStore(n._dbInfo.storeName).delete(t);s.oncomplete=function(){e()},s.onerror=function(){i(o.error)},s.onabort=function(){i(o.error?o.error:o.transaction.error)}}catch(a){i(a)}})}).catch(i)});return a(i,e),i},clear:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){A(e._dbInfo,g,function(i,r){if(i)return n(i);try{var s=r.objectStore(e._dbInfo.storeName).clear();r.oncomplete=function(){t()},r.onabort=r.onerror=function(){n(s.error?s.error:s.transaction.error)}}catch(o){n(o)}})}).catch(n)});return a(n,t),n},length:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){A(e._dbInfo,m,function(i,r){if(i)return n(i);try{var s=r.objectStore(e._dbInfo.storeName).count();s.onsuccess=function(){t(s.result)},s.onerror=function(){n(s.error)}}catch(o){n(o)}})}).catch(n)});return a(n,t),n},key:function(t,e){var n=this,i=new o(function(e,i){t<0?e(null):n.ready().then(function(){A(n._dbInfo,m,function(r,s){if(r)return i(r);try{var o=s.objectStore(n._dbInfo.storeName),a=!1,u=o.openCursor();u.onsuccess=function(){var n=u.result;n?0===t||a?e(n.key):(a=!0,n.advance(t)):e(null)},u.onerror=function(){i(u.error)}}catch(l){i(l)}})}).catch(i)});return a(i,e),i},keys:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){A(e._dbInfo,m,function(i,r){if(i)return n(i);try{var s=r.objectStore(e._dbInfo.storeName).openCursor(),o=[];s.onsuccess=function(){var e=s.result;e?(o.push(e.key),e.continue()):t(o)},s.onerror=function(){n(s.error)}}catch(a){n(a)}})}).catch(n)});return a(n,t),n},dropInstance:function(t,e){e=c.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,s=this;if(t.name){var u=t.name===n.name&&s._dbInfo.db?o.resolve(s._dbInfo.db):T(t).then(function(e){var n=f[t.name],i=n.forages;n.db=e;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=e;return e});i=u.then(t.storeName?function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;v(t);var i=f[t.name],s=i.forages;e.close();for(var a=0;a<s.length;a++){var u=s[a];u._dbInfo.db=null,u._dbInfo.version=n}return new o(function(e,i){var s=r.open(t.name,n);s.onerror=function(t){s.result.close(),i(t)},s.onupgradeneeded=function(){s.result.deleteObjectStore(t.storeName)},s.onsuccess=function(){var t=s.result;t.close(),e(t)}}).then(function(t){i.db=t;for(var e=0;e<s.length;e++){var n=s[e];n._dbInfo.db=t,b(n._dbInfo)}}).catch(function(e){throw(x(t,e)||o.resolve()).catch(function(){}),e})}}:function(e){v(t);var n=f[t.name],i=n.forages;e.close();for(var s=0;s<i.length;s++)i[s]._dbInfo.db=null;return new o(function(e,n){var i=r.deleteDatabase(t.name);i.onerror=i.onblocked=function(t){var e=i.result;e&&e.close(),n(t)},i.onsuccess=function(){var t=i.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<i.length;e++)b(i[e]._dbInfo)}).catch(function(e){throw(x(t,e)||o.resolve()).catch(function(){}),e})})}else i=o.reject("Invalid arguments");return a(i,e),i}},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",I=/^~~local_forage_type~([^~]+)~/,M="__lfsc__:",N=M.length,D="arbf",P="blob",F="si08",L="ui08",j="uic8",B="si16",z="si32",$="ur16",U="ui32",W="fl32",V="fl64",Y=N+D.length,G=Object.prototype.toString;function X(t){var e,n,i,r,s,o=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var l=new ArrayBuffer(o),c=new Uint8Array(l);for(e=0;e<a;e+=4)n=R.indexOf(t[e]),i=R.indexOf(t[e+1]),r=R.indexOf(t[e+2]),s=R.indexOf(t[e+3]),c[u++]=n<<2|i>>4,c[u++]=(15&i)<<4|r>>2,c[u++]=(3&r)<<6|63&s;return l}function H(t){var e,n=new Uint8Array(t),i="";for(e=0;e<n.length;e+=3)i+=R[n[e]>>2],i+=R[(3&n[e])<<4|n[e+1]>>4],i+=R[(15&n[e+1])<<2|n[e+2]>>6],i+=R[63&n[e+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var q={serialize:function(t,e){var n="";if(t&&(n=G.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===G.call(t.buffer))){var i,r=M;t instanceof ArrayBuffer?(i=t,r+=D):(i=t.buffer,"[object Int8Array]"===n?r+=F:"[object Uint8Array]"===n?r+=L:"[object Uint8ClampedArray]"===n?r+=j:"[object Int16Array]"===n?r+=B:"[object Uint16Array]"===n?r+=$:"[object Int32Array]"===n?r+=z:"[object Uint32Array]"===n?r+=U:"[object Float32Array]"===n?r+=W:"[object Float64Array]"===n?r+=V:e(new Error("Failed to get type for BinaryArray"))),e(r+H(i))}else if("[object Blob]"===n){var s=new FileReader;s.onload=function(){var n="~~local_forage_type~"+t.type+"~"+H(this.result);e("__lfsc__:blob"+n)},s.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(o){console.error("Couldn't convert value into a JSON string: ",t),e(null,o)}},deserialize:function(t){if(t.substring(0,N)!==M)return JSON.parse(t);var e,n=t.substring(Y),i=t.substring(N,Y);if(i===P&&I.test(n)){var r=n.match(I);e=r[1],n=n.substring(r[0].length)}var o=X(n);switch(i){case D:return o;case P:return s([o],{type:e});case F:return new Int8Array(o);case L:return new Uint8Array(o);case j:return new Uint8ClampedArray(o);case B:return new Int16Array(o);case $:return new Uint16Array(o);case z:return new Int32Array(o);case U:return new Uint32Array(o);case W:return new Float32Array(o);case V:return new Float64Array(o);default:throw new Error("Unkown type: "+i)}},stringToBuffer:X,bufferToString:H};function K(t,e,n,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function J(t,e,n,i,r,s){t.executeSql(n,i,r,function(t,o){o.code===o.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,a){a.rows.length?s(t,o):K(t,e,function(){t.executeSql(n,i,r,s)},s)},s):s(t,o)},s)}function Q(t,e,n,i){var r=this;t=l(t);var s=new o(function(s,o){r.ready().then(function(){void 0===e&&(e=null);var a=e,u=r._dbInfo;u.serializer.serialize(e,function(e,l){l?o(l):u.db.transaction(function(n){J(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){s(a)},function(t,e){o(e)})},function(e){if(e.code===e.QUOTA_ERR){if(i>0)return void s(Q.apply(r,[t,a,n,i-1]));o(e)}})})}).catch(o)});return a(s,n),s}function Z(t){return new o(function(e,n){t.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,i){for(var r=[],s=0;s<i.rows.length;s++)r.push(i.rows.item(s).name);e({db:t,storeNames:r})},function(t,e){n(e)})},function(t){n(t)})})}var tt={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]="string"!=typeof t[i]?t[i].toString():t[i];var r=new o(function(t,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(r){return i(r)}n.db.transaction(function(r){K(r,n,function(){e._dbInfo=n,t()},function(t,e){i(e)})},i)});return n.serializer=q,r},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,i=new o(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){J(n,r,"SELECT * FROM "+r.storeName,[],function(n,i){for(var s=i.rows,o=s.length,a=0;a<o;a++){var u=s.item(a),l=u.value;if(l&&(l=r.serializer.deserialize(l)),void 0!==(l=t(l,u.key,a+1)))return void e(l)}e()},function(t,e){i(e)})})}).catch(i)});return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=new o(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){J(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=r.serializer.deserialize(i)),e(i)},function(t,e){i(e)})})}).catch(i)});return a(i,e),i},setItem:function(t,e,n){return Q.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=l(t);var i=new o(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){J(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){i(e)})})}).catch(i)});return a(i,e),i},clear:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){J(e,i,"DELETE FROM "+i.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},length:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){J(e,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(e,n){var i=n.rows.item(0).c;t(i)},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},key:function(t,e){var n=this,i=new o(function(e,i){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(n){J(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var i=n.rows.length?n.rows.item(0).key:null;e(i)},function(t,e){i(e)})})}).catch(i)});return a(i,e),i},keys:function(t){var e=this,n=new o(function(t,n){e.ready().then(function(){var i=e._dbInfo;i.db.transaction(function(e){J(e,i,"SELECT key FROM "+i.storeName,[],function(e,n){for(var i=[],r=0;r<n.rows.length;r++)i.push(n.rows.item(r).key);t(i)},function(t,e){n(e)})})}).catch(n)});return a(n,t),n},dropInstance:function(t,e){e=c.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,r=this;return a(i=t.name?new o(function(e){var i;i=t.name===n.name?r._dbInfo.db:openDatabase(t.name,"","",0),e(t.storeName?{db:i,storeNames:[t.storeName]}:Z(i))}).then(function(t){return new o(function(e,n){t.db.transaction(function(i){function r(t){return new o(function(e,n){i.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var s=[],a=0,u=t.storeNames.length;a<u;a++)s.push(r(t.storeNames[a]));o.all(s).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):o.reject("Invalid arguments"),e),i}};function et(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}var nt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=et(t,this._defaultConfig),!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(e){return!0}}()||localStorage.length>0?(this._dbInfo=e,e.serializer=q,o.resolve()):o.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=n.ready().then(function(){for(var e=n._dbInfo,i=e.keyPrefix,r=i.length,s=localStorage.length,o=1,a=0;a<s;a++){var u=localStorage.key(a);if(0===u.indexOf(i)){var l=localStorage.getItem(u);if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=t(l,u.substring(r),o++)))return l}}});return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=n.ready().then(function(){var e=n._dbInfo,i=localStorage.getItem(e.keyPrefix+t);return i&&(i=e.serializer.deserialize(i)),i});return a(i,e),i},setItem:function(t,e,n){var i=this;t=l(t);var r=i.ready().then(function(){void 0===e&&(e=null);var n=e;return new o(function(r,s){var o=i._dbInfo;o.serializer.serialize(e,function(e,i){if(i)s(i);else try{localStorage.setItem(o.keyPrefix+t,e),r(n)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||s(a),s(a)}})})});return a(r,n),r},removeItem:function(t,e){var n=this;t=l(t);var i=n.ready().then(function(){localStorage.removeItem(n._dbInfo.keyPrefix+t)});return a(i,e),i},clear:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(t)&&localStorage.removeItem(i)}});return a(n,t),n},length:function(t){var e=this.keys().then(function(t){return t.length});return a(e,t),e},key:function(t,e){var n=this,i=n.ready().then(function(){var e,i=n._dbInfo;try{e=localStorage.key(t)}catch(r){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e});return a(i,e),i},keys:function(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,i=[],r=0;r<n;r++){var s=localStorage.key(r);0===s.indexOf(t.keyPrefix)&&i.push(s.substring(t.keyPrefix.length))}return i});return a(n,t),n},dropInstance:function(t,e){if(e=c.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var i,r=this;return a(i=t.name?new o(function(e){e(t.storeName?et(t,r._defaultConfig):t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):o.reject("Invalid arguments"),e),i}},it=function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)},rt=function(t,e){for(var n=t.length,i=0;i<n;){if(it(t[i],e))return!0;i++}return!1},st=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},ot={},at={},ut={INDEXEDDB:k,WEBSQL:tt,LOCALSTORAGE:nt},lt=[ut.INDEXEDDB._driver,ut.WEBSQL._driver,ut.LOCALSTORAGE._driver],ct=["dropInstance"],ht=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),dt={description:"",driver:lt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ft(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function pt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(arguments[0][n]=st(e[n])?e[n].slice():e[n])}return arguments[0]}var mt=new(function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut)if(ut.hasOwnProperty(n)){var i=ut[n],r=i._driver;this[n]=r,ot[r]||this.defineDriver(i)}this._defaultConfig=pt({},dt),this._config=pt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":i(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var i=new o(function(e,n){try{var i=t._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(r);for(var s=ht.concat("_initStorage"),u=0,l=s.length;u<l;u++){var c=s[u];if((!rt(ct,c)||t[c])&&"function"!=typeof t[c])return void n(r)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=o.reject(e);return a(n,arguments[arguments.length-1]),n}},n=0,i=ct.length;n<i;n++){var r=ct[n];t[r]||(t[r]=e(r))}}();var h=function(n){ot[i]&&console.info("Redefining LocalForage driver: "+i),ot[i]=t,at[i]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(h,n):h(!!t._support):h(!0)}catch(d){n(d)}});return u(i,e,n),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var i=ot[t]?o.resolve(ot[t]):o.reject(new Error("Driver not found."));return u(i,e,n),i},t.prototype.getSerializer=function(t){var e=o.resolve(q);return u(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return u(n,t,t),n},t.prototype.setDriver=function(t,e,n){var i=this;st(t)||(t=[t]);var r=this._getSupportedDrivers(t);function s(){i._config.driver=i.driver()}function a(t){return i._extend(t),s(),i._ready=i._initStorage(i._config),i._ready}var l=null!==this._driverSet?this._driverSet.catch(function(){return o.resolve()}):o.resolve();return this._driverSet=l.then(function(){var t=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,s(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var r=t[e];return e++,i._dbInfo=null,i._ready=null,i.getDriver(r).then(a).catch(n)}s();var u=new Error("No available storage method found.");return i._driverSet=o.reject(u),i._driverSet}()}}(r)})}).catch(function(){s();var t=new Error("No available storage method found.");return i._driverSet=o.reject(t),i._driverSet}),u(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!at[t]},t.prototype._extend=function(t){pt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];this.supports(r)&&e.push(r)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ht.length;t<e;t++)ft(this,ht[t])},t.prototype.createInstance=function(e){return new t(e)},t}());e.exports=mt},{3:3}]},{},[4])(4)}).call(this,n(27))},function(t,e,n){"use strict";(function(t,i){let r;function s(){if(null==r){let e;if("undefined"!=typeof window)e=window;else if(void 0!==t)e=t;else if(void 0!==i)e=i;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function o(t,e){const n=function(){const t=s();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const i=e();return n.set(t,i),n.get(t)}}n.d(e,"b",function(){return s}),n.d(e,"a",function(){return o})}).call(this,n(27),n(35))},function(t,e,n){"use strict";n.d(e,"a",function(){return i});const i={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(t,e){var n,i,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var u,l=[],c=!1,h=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var t=a(d);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";function i(){if("undefined"!=typeof navigator&&null!=navigator){const t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function r(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}n.r(e),n.d(e,"isMobile",function(){return i}),n.d(e,"isBrowser",function(){return r})},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(0);function r(t,e,n,r){const s=i.util.getTypedArrayFromDType(r,i.util.sizeFromShape(n));for(let i=0;i<s.length;++i){const n=i*e;let r=t[n];for(let i=0;i<e;++i){const e=t[n+i];e>r&&(r=e)}s[i]=r}return s}},function(t,e,n){"use strict";n.r(e),n.d(e,"GraphModel",function(){return v}),n.d(e,"loadGraphModel",function(){return b}),n.d(e,"deregisterOp",function(){return a.a}),n.d(e,"registerOp",function(){return a.c}),n.d(e,"version_converter",function(){return x});var i=n(0),r=n(15),s=n(2);class o{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(t=>this.getInput(t)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((t,e)=>(t[e]=this.getAttr(e),t),{}))}getInput(t){return Object(s.c)(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return Object(s.c)(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(r.f)(this.node.rawAttrs,t,e);if(null!=n.s)return Object(r.i)(this.node.rawAttrs,t,e);if(null!=n.b)return Object(r.c)(this.node.rawAttrs,t,e);if(null!=n.shape)return Object(r.k)(this.node.rawAttrs,t,e);if(null!=n.type)return Object(r.e)(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(r.g)(this.node.rawAttrs,t,e);if(null!=n.list.s)return Object(r.h)(this.node.rawAttrs,t,e);if(null!=n.list.shape)return Object(r.j)(this.node.rawAttrs,t,e);if(null!=n.list.b)return Object(r.b)(this.node.rawAttrs,t,e);if(null!=n.list.type)return Object(r.d)(this.node.rawAttrs,t,e)}return e}}var a=n(24);function u(t,e,n=""){i.util.assert(function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0}(t,e),()=>n+` Shapes ${t} and ${e} must match`)}class l{constructor(t,e,n,i,r,s,o){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=i,this.identicalElementShapes=r,this.dynamicSize=s,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.id=l.nextId++}get closed(){return this.closed_}clearAndClose(){this.tensors.forEach(t=>t.tensor.dispose()),this.tensors=[],this.closed_=!0}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),u(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),n&&n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(n&&n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);n.tensor=e,n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Object(i.tensor)([],[0].concat(this.elementShape));const n=this.readMany(t);return u(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Object(i.stack)(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Object(i.tensor)([],[0].concat(this.elementShape));const e=[];for(let i=0;i<this.size();i++)e.push(i);const n=this.readMany(e);return u(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Object(i.concat)(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(t,Object(i.unstack)(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const s=0===n?0:e.size/n,o=[];Object(i.tidy)(()=>{e=e.reshape([1,n,s]);for(let n=0;n<t.length;++n){const a=[0,0===n?0:r[n-1],0],u=[1,t[n],s];o[n]=Object(i.slice)(e,a,u).reshape(this.elementShape)}return o});const a=[];for(let i=0;i<t.length;i++)a[i]=i;this.writeMany(a,o)}}function c(t,e,n){const r=((t,e,n)=>{switch(t.category){case"arithmetic":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[i.add(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"AddN":return[i.addN(Object(s.b)("tensors",t,e,n))];case"FloorMod":case"Mod":return[i.mod(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Mul":return[i.mul(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"RealDiv":case"Div":return[i.div(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"DivNoNan":return[i.divNoNan(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"FloorDiv":return[i.floorDiv(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Sub":return[i.sub(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Minimum":return[i.minimum(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Maximum":return[i.maximum(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Pow":return[i.pow(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"SquaredDifference":return[i.squaredDifference(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"basic_math":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Abs":case"ComplexAbs":return[i.abs(Object(s.b)("x",t,e,n))];case"Acos":return[i.acos(Object(s.b)("x",t,e,n))];case"Acosh":return[i.acosh(Object(s.b)("x",t,e,n))];case"Asin":return[i.asin(Object(s.b)("x",t,e,n))];case"Asinh":return[i.asinh(Object(s.b)("x",t,e,n))];case"Atan":return[i.atan(Object(s.b)("x",t,e,n))];case"Atan2":return[i.atan2(Object(s.b)("x",t,e,n),Object(s.b)("y",t,e,n))];case"Atanh":return[i.atanh(Object(s.b)("x",t,e,n))];case"Ceil":return[i.ceil(Object(s.b)("x",t,e,n))];case"Complex":return[i.complex(Object(s.b)("real",t,e,n),Object(s.b)("imag",t,e,n))];case"Cos":return[i.cos(Object(s.b)("x",t,e,n))];case"Cosh":return[i.cosh(Object(s.b)("x",t,e,n))];case"Elu":return[i.elu(Object(s.b)("x",t,e,n))];case"Erf":return[i.erf(Object(s.b)("x",t,e,n))];case"Exp":return[i.exp(Object(s.b)("x",t,e,n))];case"Expm1":return[i.expm1(Object(s.b)("x",t,e,n))];case"Floor":return[i.floor(Object(s.b)("x",t,e,n))];case"Log":return[i.log(Object(s.b)("x",t,e,n))];case"Log1p":return[i.log1p(Object(s.b)("x",t,e,n))];case"Imag":return[i.imag(Object(s.b)("x",t,e,n))];case"Neg":return[i.neg(Object(s.b)("x",t,e,n))];case"Reciprocal":return[i.reciprocal(Object(s.b)("x",t,e,n))];case"Real":return[i.real(Object(s.b)("x",t,e,n))];case"Relu":return[i.relu(Object(s.b)("x",t,e,n))];case"Round":return[i.round(Object(s.b)("x",t,e,n))];case"Selu":return[i.selu(Object(s.b)("x",t,e,n))];case"Sigmoid":return[i.sigmoid(Object(s.b)("x",t,e,n))];case"Sin":return[i.sin(Object(s.b)("x",t,e,n))];case"Sign":return[i.sign(Object(s.b)("x",t,e,n))];case"Sinh":return[i.sinh(Object(s.b)("x",t,e,n))];case"Softplus":return[i.softplus(Object(s.b)("x",t,e,n))];case"Sqrt":return[i.sqrt(Object(s.b)("x",t,e,n))];case"Square":return[i.square(Object(s.b)("x",t,e,n))];case"Tanh":return[i.tanh(Object(s.b)("x",t,e,n))];case"Tan":return[i.tan(Object(s.b)("x",t,e,n))];case"Relu6":case"ClipByValue":return[i.clipByValue(Object(s.b)("x",t,e,n),Object(s.b)("clipValueMin",t,e,n),Object(s.b)("clipValueMax",t,e,n))];case"Rsqrt":return[i.rsqrt(Object(s.c)(t.inputNames[0],e,n))];case"Prod":return[i.prod(Object(s.b)("x",t,e,n),Object(s.b)("axes",t,e,n))];case"LeakyRelu":return[i.leakyRelu(Object(s.b)("x",t,e,n),Object(s.b)("alpha",t,e,n))];case"Prelu":return[i.prelu(Object(s.b)("x",t,e,n),Object(s.b)("alpha",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"control":return(async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const i=Object(s.b)("thenBranch",t,e,n),r=Object(s.b)("elseBranch",t,e,n),o=Object(s.b)("cond",t,e,n),a=Object(s.b)("args",t,e,n);return(await o.data())[0]?n.functionMap[i].executeFunctionAsync(a):n.functionMap[r].executeFunctionAsync(a)}case"While":case"StatelessWhile":{const i=Object(s.b)("body",t,e,n),r=Object(s.b)("cond",t,e,n),o=Object(s.b)("args",t,e,n),a=(await n.functionMap[r].executeFunctionAsync(o))[0];let u=await a.data(),l=o;for(;u[0];){l=await n.functionMap[i].executeFunctionAsync(l);const t=(await n.functionMap[r].executeFunctionAsync(l))[0];u=await t.data()}return l}case"LoopCond":return[Object(s.b)("pred",t,e,n).clone()];case"Switch":{const i=Object(s.b)("pred",t,e,n),r=Object(s.b)("data",t,e,n);return(await i.data())[0]?[void 0,r.clone()]:[r.clone(),void 0]}case"Merge":const r=t.inputNames.find(t=>void 0!==Object(s.c)(t,e,n));return r?[Object(s.c)(r,e,n).clone()]:void 0;case"Enter":const o=Object(s.b)("frameName",t,e,n),a=Object(s.b)("tensor",t,e,n);return n.enterFrame(o),[a.clone()];case"Exit":const u=Object(s.b)("tensor",t,e,n);return n.exitFrame(),[u.clone()];case"NextIteration":const c=Object(s.b)("tensor",t,e,n);return n.nextIteration(),[c.clone()];case"TensorArrayV3":const h=Object(s.b)("size",t,e,n),d=Object(s.b)("dtype",t,e,n),f=Object(s.b)("elementShape",t,e,n),p=Object(s.b)("dynamicSize",t,e,n),m=Object(s.b)("clearAfterRead",t,e,n),g=Object(s.b)("identicalElementShapes",t,e,n),y=Object(s.b)("name",t,e,n),v=new l(y,d,h,f,g,p,m);return n.addTensorArray(v),[Object(i.scalar)(v.id),Object(i.scalar)(1)];case"TensorArrayWriteV3":const b=Object(s.b)("tensorArrayId",t,e,n),x=Object(s.b)("index",t,e,n),w=Object(s.b)("tensor",t,e,n);return n.getTensorArray(b).write(x,w),[Object(i.scalar)(1)];case"TensorArrayReadV3":const T=Object(s.b)("tensorArrayId",t,e,n),S=Object(s.b)("index",t,e,n);return[n.getTensorArray(T).read(S)];case"TensorArrayGatherV3":const E=Object(s.b)("tensorArrayId",t,e,n),O=Object(s.b)("indices",t,e,n),C=Object(s.b)("dtype",t,e,n);return[n.getTensorArray(E).gather(O,C)];case"TensorArrayScatterV3":const _=Object(s.b)("tensorArrayId",t,e,n),A=Object(s.b)("indices",t,e,n),k=Object(s.b)("tensor",t,e,n);return n.getTensorArray(_).scatter(A,k),[Object(i.scalar)(1)];case"TensorArrayConcatV3":const R=Object(s.b)("tensorArrayId",t,e,n),I=n.getTensorArray(R),M=Object(s.b)("dtype",t,e,n);return[I.concat(M)];case"TensorArraySplitV3":const N=Object(s.b)("tensorArrayId",t,e,n),D=Object(s.b)("tensor",t,e,n),P=Object(s.b)("lengths",t,e,n);return n.getTensorArray(N).split(P,D),[Object(i.scalar)(1)];case"TensorArraySizeV3":const F=Object(s.b)("tensorArrayId",t,e,n),L=n.getTensorArray(F);return[Object(i.scalar)(L.size(),"int32")];case"TensorArrayCloseV3":const j=Object(s.b)("tensorArrayId",t,e,n);return n.getTensorArray(j).clearAndClose(),[Object(i.scalar)(0)];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n);case"convolution":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Conv1D":{const r=Object(s.b)("stride",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("dataFormat",t,e,n).toUpperCase(),u=Object(s.b)("dilation",t,e,n);return[i.conv1d(Object(s.b)("x",t,e,n),Object(s.b)("filter",t,e,n),r,o,a,u)]}case"Conv2D":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("dataFormat",t,e,n).toUpperCase(),u=Object(s.b)("dilations",t,e,n);return[i.conv2d(Object(s.b)("x",t,e,n),Object(s.b)("filter",t,e,n),[r[1],r[2]],o,a,[u[1],u[2]])]}case"_FusedConv2D":case"FusedDepthwiseConv2dNative":{const[r,o]=Object(s.b)("fusedOps",t,e,n),a="biasadd"===r,u="prelu"===o,l="fusedbatchnorm"===r,c=Object(s.b)("numArgs",t,e,n);if(a){if(u&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const h=Object(s.b)("strides",t,e,n),d=Object(s.b)("pad",t,e,n),f=Object(s.b)("dataFormat",t,e,n).toUpperCase(),p=Object(s.b)("dilations",t,e,n),[m,g]=Object(s.b)("args",t,e,n);return[("_FusedConv2D"===t.op?i.fused.conv2d:i.fused.depthwiseConv2d)({x:Object(s.b)("x",t,e,n),filter:Object(s.b)("filter",t,e,n),strides:[h[1],h[2]],pad:d,dataFormat:f,dilations:[p[1],p[2]],bias:m,activation:o,preluActivationWeights:g})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=Object(s.b)("outputShape",t,e,n),o=Object(s.b)("strides",t,e,n),a=Object(s.b)("pad",t,e,n);return[i.conv2dTranspose(Object(s.b)("x",t,e,n),Object(s.b)("filter",t,e,n),r,[o[1],o[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("dilations",t,e,n),u=Object(s.b)("dataFormat",t,e,n).toUpperCase();return[i.depthwiseConv2d(Object(s.b)("input",t,e,n),Object(s.b)("filter",t,e,n),[r[1],r[2]],o,u,[a[1],a[2]])]}case"Conv3D":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("dataFormat",t,e,n).toUpperCase(),u=Object(s.b)("dilations",t,e,n);return[i.conv3d(Object(s.b)("x",t,e,n),Object(s.b)("filter",t,e,n),[r[1],r[2],r[3]],o,a,[u[1],u[2],u[3]])]}case"AvgPool":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("kernelSize",t,e,n);return[i.avgPool(Object(s.b)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],o)]}case"MaxPool":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("kernelSize",t,e,n);return[i.maxPool(Object(s.b)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("kernelSize",t,e,n),u=Object(s.b)("includeBatchInIndex",t,e,n),{result:l,indexes:c}=i.maxPoolWithArgmax(Object(s.b)("x",t,e,n),[a[1],a[2]],[r[1],r[2]],o,u);return[l,c]}case"AvgPool3D":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("kernelSize",t,e,n);return[i.avgPool3d(Object(s.b)("x",t,e,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{const r=Object(s.b)("strides",t,e,n),o=Object(s.b)("pad",t,e,n),a=Object(s.b)("kernelSize",t,e,n);return[i.maxPool3d(Object(s.b)("x",t,e,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"creation":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Fill":{const r=Object(s.b)("shape",t,e,n),o=Object(s.b)("dtype",t,e,n),a=Object(s.b)("value",t,e,n);return[i.fill(r,a,o)]}case"LinSpace":{const r=Object(s.b)("start",t,e,n),o=Object(s.b)("stop",t,e,n),a=Object(s.b)("num",t,e,n);return[i.linspace(r,o,a)]}case"Multinomial":{const r=Object(s.b)("logits",t,e,n),o=Object(s.b)("numSamples",t,e,n),a=Object(s.b)("seed",t,e,n);return[i.multinomial(r,o,a)]}case"OneHot":{const r=Object(s.b)("indices",t,e,n),o=Object(s.b)("depth",t,e,n),a=Object(s.b)("onValue",t,e,n),u=Object(s.b)("offValue",t,e,n);return[i.oneHot(r,o,a,u)]}case"Ones":return[i.ones(Object(s.b)("shape",t,e,n),Object(s.b)("dtype",t,e,n))];case"OnesLike":return[i.onesLike(Object(s.b)("x",t,e,n))];case"RandomUniform":return[i.randomUniform(Object(s.b)("shape",t,e,n),Object(s.b)("minval",t,e,n),Object(s.b)("maxval",t,e,n),Object(s.b)("dtype",t,e,n))];case"Range":{const r=Object(s.b)("start",t,e,n),o=Object(s.b)("stop",t,e,n),a=Object(s.b)("step",t,e,n);return[i.range(r,o,a,Object(s.b)("dtype",t,e,n))]}case"TruncatedNormal":{const r=Object(s.b)("shape",t,e,n),o=Object(s.b)("mean",t,e,n),a=Object(s.b)("stdDev",t,e,n),u=Object(s.b)("seed",t,e,n);return[i.truncatedNormal(r,o,a,Object(s.b)("dtype",t,e,n),u)]}case"Zeros":return[i.zeros(Object(s.b)("shape",t,e,n),Object(s.b)("dtype",t,e,n))];case"ZerosLike":return[i.zerosLike(Object(s.b)("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"dynamic":return(async(t,e,n)=>{switch(t.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const r=Object(s.b)("boxes",t,e,n),o=Object(s.b)("scores",t,e,n),a=Object(s.b)("maxOutputSize",t,e,n),u=Object(s.b)("iouThreshold",t,e,n),l=Object(s.b)("scoreThreshold",t,e,n);if("NonMaxSuppressionV5"===t.op){const c=Object(s.b)("softNmsSigma",t,e,n),h=await i.image.nonMaxSuppressionWithScoreAsync(r,o,a,u,l,c);return[h.selectedIndices,h.selectedScores]}return[await i.image.nonMaxSuppressionAsync(r,o,a,u,l)]}case"Where":{const r=Object(s.b)("condition",t,e,n).asType("bool"),o=[await i.whereAsync(r)];return r.dispose(),o}case"ListDiff":return i.setdiff1dAsync(Object(s.b)("x",t,e,n),Object(s.b)("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n);case"evaluation":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"TopKV2":{const r=Object(s.b)("x",t,e,n),o=Object(s.b)("k",t,e,n),a=Object(s.b)("sorted",t,e,n),u=i.topk(r,o,a);return[u.values,u.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"image":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"ResizeBilinear":{const r=Object(s.b)("images",t,e,n),o=Object(s.b)("size",t,e,n),a=Object(s.b)("alignCorners",t,e,n);return[i.image.resizeBilinear(r,[o[0],o[1]],a)]}case"ResizeNearestNeighbor":{const r=Object(s.b)("images",t,e,n),o=Object(s.b)("size",t,e,n),a=Object(s.b)("alignCorners",t,e,n);return[i.image.resizeNearestNeighbor(r,[o[0],o[1]],a)]}case"CropAndResize":{const r=Object(s.b)("image",t,e,n),o=Object(s.b)("boxes",t,e,n),a=Object(s.b)("boxInd",t,e,n),u=Object(s.b)("cropSize",t,e,n),l=Object(s.b)("method",t,e,n),c=Object(s.b)("extrapolationValue",t,e,n);return[i.image.cropAndResize(r,o,a,u,l,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"graph":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=Object(s.b)("default",t,e,n);return[Object(s.c)(t.name,e,n)||r];case"Placeholder":return[Object(s.c)(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[Object(s.b)("x",t,e,n).clone()];case"IdentityN":return Object(s.b)("x",t,e,n).map(t=>t.clone());case"Snapshot":return[Object(s.b)("x",t,e,n).clone()];case"Shape":return[i.tensor1d(Object(s.b)("x",t,e,n).shape,"int32")];case"ShapeN":return Object(s.b)("x",t,e,n).map(t=>i.tensor1d(t.shape));case"Size":return[i.scalar(Object(s.b)("x",t,e,n).size,"int32")];case"Rank":return[i.scalar(Object(s.b)("x",t,e,n).rank,"int32")];case"NoOp":return[i.scalar(1)];case"Print":const o=Object(s.b)("x",t,e,n),a=Object(s.b)("data",t,e,n),u=Object(s.b)("message",t,e,n),l=Object(s.b)("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let t=0;t<a.length;t++)console.log(Array.prototype.slice.call(a[t].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"logical":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Equal":return[i.equal(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"NotEqual":return[i.notEqual(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Greater":return[i.greater(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"GreaterEqual":return[i.greaterEqual(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Less":return[i.less(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"LessEqual":return[i.lessEqual(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"LogicalAnd":return[i.logicalAnd(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"LogicalNot":return[i.logicalNot(Object(s.b)("a",t,e,n))];case"LogicalOr":return[i.logicalOr(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];case"Select":case"SelectV2":return[i.where(Object(s.b)("condition",t,e,n),Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"matrices":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[i.matMul(Object(s.b)("a",t,e,n),Object(s.b)("b",t,e,n),Object(s.b)("transposeA",t,e,n),Object(s.b)("transposeB",t,e,n))];case"Transpose":return[i.transpose(Object(s.b)("x",t,e,n),Object(s.b)("perm",t,e,n))];case"_FusedMatMul":const[r,o]=Object(s.b)("fusedOps",t,e,n),a="biasadd"===r,u="prelu"===o,l=Object(s.b)("numArgs",t,e,n);if(a){if(u&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,h]=Object(s.b)("args",t,e,n);return[i.fused.matMul({a:Object(s.b)("a",t,e,n),b:Object(s.b)("b",t,e,n),transposeA:Object(s.b)("transposeA",t,e,n),transposeB:Object(s.b)("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:h})];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"normalization":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[i.batchNorm(Object(s.b)("x",t,e,n),Object(s.b)("mean",t,e,n),Object(s.b)("variance",t,e,n),Object(s.b)("offset",t,e,n),Object(s.b)("scale",t,e,n),Object(s.b)("epsilon",t,e,n))];case"LRN":return[i.localResponseNormalization(Object(s.b)("x",t,e,n),Object(s.b)("radius",t,e,n),Object(s.b)("bias",t,e,n),Object(s.b)("alpha",t,e,n),Object(s.b)("beta",t,e,n))];case"Softmax":return[i.softmax(Object(s.b)("x",t,e,n))];case"LogSoftmax":return[i.logSoftmax(Object(s.b)("x",t,e,n))];case"SparseToDense":return[i.sparseToDense(Object(s.b)("sparseIndices",t,e,n),Object(s.b)("outputShape",t,e,n),Object(s.b)("sparseValues",t,e,n),Object(s.b)("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"reduction":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Max":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.max(Object(s.b)("x",t,e,n),r,o)]}case"Mean":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.mean(Object(s.b)("x",t,e,n),r,o)]}case"Min":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.min(Object(s.b)("x",t,e,n),r,o)]}case"Sum":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.sum(Object(s.b)("x",t,e,n),r,o)]}case"All":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.all(Object(s.b)("x",t,e,n),r,o)]}case"Any":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.any(Object(s.b)("x",t,e,n),r,o)]}case"ArgMax":{const r=Object(s.b)("axis",t,e,n);return[i.argMax(Object(s.b)("x",t,e,n),r)]}case"ArgMin":{const r=Object(s.b)("axis",t,e,n);return[i.argMin(Object(s.b)("x",t,e,n),r)]}case"Prod":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("keepDims",t,e,n);return[i.prod(Object(s.b)("x",t,e,n),r,o)]}case"Cumsum":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("exclusive",t,e,n),a=Object(s.b)("reverse",t,e,n);return[i.cumsum(Object(s.b)("x",t,e,n),r,o,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"slice_join":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=Object(s.b)("n",t,e,n),o=Object(s.b)("axis",t,e,n);let a=Object(s.b)("tensors",t,e,n);return a=a.slice(0,r),[i.concat(a,o)]}case"GatherV2":case"Gather":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("x",t,e,n),a=Object(s.b)("indices",t,e,n);return[i.gather(o,a.asType("int32"),r)]}case"ReverseV2":case"Reverse":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("x",t,e,n);return[i.reverse(o,r)]}case"Slice":{const r=Object(s.b)("begin",t,e,n),o=Object(s.b)("size",t,e,n);return[i.slice(Object(s.b)("x",t,e,n),r,o)]}case"StridedSlice":{const r=Object(s.b)("begin",t,e,n),o=Object(s.b)("end",t,e,n),a=Object(s.b)("strides",t,e,n),u=Object(s.b)("beginMask",t,e,n),l=Object(s.b)("endMask",t,e,n),c=Object(s.b)("ellipsisMask",t,e,n),h=Object(s.b)("newAxisMask",t,e,n),d=Object(s.b)("shrinkAxisMask",t,e,n),f=Object(s.b)("x",t,e,n);if(1===r.length&&f.shape.length>1)for(let t=1;t<f.shape.length;t++)r.push(0),o.push(f.shape[t]),a.push(a[0]);return[i.stridedSlice(f,r,o,a,u,l,c,h,d)]}case"Pack":return i.tidy(()=>{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("tensors",t,e,n),a=o[0].shape,u=o[0].squeeze().shape,l=o.map(t=>{const e=i.util.arraysEqual(t.shape,a);if(!e&&!i.util.arraysEqual(t.squeeze().shape,u))throw new Error("the input tensors shape does not match");return e?t:t.reshape(a)});return[i.stack(l,r)]});case"Unpack":return i.tidy(()=>{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("tensor",t,e,n);return i.unstack(o,r)});case"Tile":{const r=Object(s.b)("reps",t,e,n);return[i.tile(Object(s.b)("x",t,e,n),r)]}case"Split":case"SplitV":{const r=Object(s.b)("axis",t,e,n),o=Object(s.b)("numOrSizeSplits",t,e,n);return i.split(Object(s.b)("x",t,e,n),o,r)}case"ScatterNd":{const r=Object(s.b)("indices",t,e,n),o=Object(s.b)("values",t,e,n),a=Object(s.b)("shape",t,e,n);return[i.scatterND(r,o,a)]}case"GatherNd":{const r=Object(s.b)("x",t,e,n),o=Object(s.b)("indices",t,e,n);return[i.gatherND(r,o)]}case"SparseToDense":{const r=Object(s.b)("sparseIndices",t,e,n),o=Object(s.b)("outputShape",t,e,n),a=Object(s.b)("sparseValues",t,e,n),u=Object(s.b)("defaultValue",t,e,n);return[i.sparseToDense(r,a,o,a.dtype===u.dtype?u:u.asType(a.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"spectral":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"FFT":return[i.fft(Object(s.b)("x",t,e,n))];case"IFFT":return[i.ifft(Object(s.b)("x",t,e,n))];case"RFFT":return[i.rfft(Object(s.b)("x",t,e,n))];case"IRFFT":return[i.irfft(Object(s.b)("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"transformation":return i.tidy(()=>((t,e,n)=>{switch(t.op){case"Cast":return[i.cast(Object(s.b)("x",t,e,n),Object(s.b)("dtype",t,e,n))];case"ExpandDims":{const r=Object(s.b)("axis",t,e,n);return[i.expandDims(Object(s.b)("x",t,e,n),r)]}case"Squeeze":{const r=Object(s.b)("axis",t,e,n);return[i.squeeze(Object(s.b)("x",t,e,n),r)]}case"Reshape":return[i.reshape(Object(s.b)("x",t,e,n),Object(s.b)("shape",t,e,n))];case"PadV2":case"Pad":return[i.pad(Object(s.b)("x",t,e,n),Object(s.f)(Object(s.b)("padding",t,e,n),2),Object(s.b)("constantValue",t,e,n))];case"SpaceToBatchND":{const r=Object(s.b)("blockShape",t,e,n),o=Object(s.f)(Object(s.b)("paddings",t,e,n),2);return[i.spaceToBatchND(Object(s.b)("x",t,e,n),r,o)]}case"BatchToSpaceND":{const r=Object(s.b)("blockShape",t,e,n),o=Object(s.f)(Object(s.b)("crops",t,e,n),2);return[i.batchToSpaceND(Object(s.b)("x",t,e,n),r,o)]}case"DepthToSpace":{const r=Object(s.b)("blockSize",t,e,n),o=Object(s.b)("dataFormat",t,e,n).toUpperCase();return[i.depthToSpace(Object(s.b)("x",t,e,n),r,o)]}case"BroadcastTo":return[i.broadcastTo(Object(s.b)("x",t,e,n),Object(s.b)("shape",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}})(t,e,n));case"custom":const r=Object(a.b)(t.op);if(r&&r.customExecutor)return r.customExecutor(new o(t,e,n));throw TypeError(`Custom op ${t.op} is not registered.`);default:throw TypeError(`Unknown op '${t.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return r instanceof Promise?r.then(t=>[].concat(t)):[].concat(r)}l.nextId=0;class h{constructor(t,e,n={}){this.weightMap=t,this.tensorArrayMap=e,this.functionMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(t=>0===t.id&&0===t.iterationId?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}}function d(t,e,n){const i=new Set,r=[];let o=null,a=null;const u=new Set,l=Object.keys(t).map(t=>Object(s.e)(t)[0]),c=[...e];for(;c.length>0;){const t=c.pop();(m(t)||g(t))&&null==o&&(o=t,a=o.children.map(t=>t.name).filter(t=>i.has(t))),i.add(t.name),null==n[t.name]&&-1===l.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach(t=>{u.has(t.name)||(u.add(t.name),c.push(t))}):r.push(t.name))}return{inputs:t,outputs:e,usedNodes:i,missingInputs:r,dynamicNode:o,syncInputs:a}}const f=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile"],p=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function m(t){return f.indexOf(t.op)>=0}function g(t){return p.indexOf(t.op)>=0}class y{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(e=>{this._functionExecutorMap[e]=new y(t.functions[e],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(e=>t[e].map(t=>t.id));this._weightIds=[].concat(...e),this._weightMap=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){const n=t.map(t=>t.name).sort(),i=e.map(t=>t.name).sort();return n.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)}compile(t,e){const n=d(t,e,this.weightMap),{missingInputs:i,dynamicNode:r,syncInputs:o}=n;if(null!=r)throw new Error(`This execution contains the node '${r.name}', which has the dynamic op '${r.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const n=e.map(t=>t.name),r=Object.keys(t);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${r}]. Missing the following inputs: [${i}]`)}return function(t,e,n){const{usedNodes:i,inputs:r}=n,o=[];Object.keys(r).map(t=>Object(s.e)(t)[0]).map(e=>t.nodes[e]).forEach(t=>{i.has(t.name)&&o.push(t)}),t.weights.forEach(t=>{i.has(t.name)&&o.push(t)});const a=new Set,u=[];for(;o.length>0;){const t=o.pop();a.add(t.name),e[t.name]||u.push(t),t.children.forEach(t=>{!a.has(t.name)&&i.has(t.name)&&t.inputs.every(t=>a.has(t.name))&&o.push(t)})}return u}(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=n.map(t=>this.graph.nodes[Object(s.e)(t)[0]]),o=e.map(t=>this.graph.nodes[Object(s.e)(t)[0]]),a=this.getCompilationKey(r,o);let u=this.compiledMap.get(a);null==u&&(u=this.compile(t,o),this.compiledMap.set(a,u));const l={};return Object(i.tidy)(()=>{const n=new h(this.weightMap,l,this.functionExecutorMap),i=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=Object(s.e)(e),o=[];o[r]=t[e],i[n]=o});const r=this.getFrozenTensorIds(i),o={};for(let t=0;t<u.length;t++){const s=u[t];if(!i[s.name]){const t=c(s,i,n);if(t instanceof Promise)throw new Error(`The execution of the op '${s.op}' returned a promise. Please use model.executeAsync() instead.`);i[s.name]=t,this.checkTensorForDisposal(s.name,s,i,n,r,e,o)}}return e.map(t=>Object(s.c)(t,i,n))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(e=>t[e]).map(t=>t.map(t=>t.id)));return new Set(e)}checkTensorForDisposal(t,e,n,i,r,o,a){"control"!==e.category&&-1===o.indexOf(t)&&(n[t].forEach(t=>{null!=t&&(a[t.id]=(a[t.id]||0)+e.children.length)}),e.inputs.forEach(t=>{if("control"!==t.category){const e=Object(s.d)(t.name,n,i);null!=e&&e.forEach(t=>{if(t&&!r.has(t.id)){const e=a[t.id];1===e?(t.dispose(),delete a[t.id]):null!=e&&a[t.id]--}})}}))}async executeAsync(t,e,n=!1){t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const i=new h(this.weightMap,{},this.functionExecutorMap),r=await this.executeWithControlFlow(t,i,e,n),o=e.map(t=>Object(s.c)(t,r,i)),a=new Set(o.map(t=>t.id)),u=new Set(Object.keys(t).map(e=>t[e].id));return Object.keys(r).forEach(t=>{r[t].forEach(t=>{!t||t.isDisposed||a.has(t.id)||u.has(t.id)||-1!==this.weightIds.indexOf(t.id)||t.dispose()})}),o}async executeFunctionAsync(t){const e=t.reduce((t,e,n)=>(t[this.inputs[n].name]=e,t),{});return this.executeAsync(e,this.outputNodes,!0)}async executeWithControlFlow(t,e,n,i){const r=Object.keys(t),o=r.map(t=>this.graph.nodes[Object(s.e)(t)[0]]),a=n.map(t=>this.graph.nodes[Object(s.e)(t)[0]]),{usedNodes:u,missingInputs:l,dynamicNode:c,syncInputs:h}=d(t,a,this.weightMap),f=[...o,...this.graph.weights].map(t=>({node:t,contexts:e.currentContext})),p=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,i]=Object(s.e)(e),r=[];r[i]=t[e],p[n]=r});const g={},y=this.getFrozenTensorIds(p),v={};for(;f.length>0;){const t=this.processStack(o,f,e,p,v,y,n,g,u);await Promise.all(t)}null!=c||i||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=a.filter(t=>!m(t)&&!Object(s.c)(t.name,p,e)).map(t=>t.name);if(b.length>0){let t="";throw null!=c&&(t=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${r}]. Consider providing the following inputs: [${l}]. ${t}`)}return p}processStack(t,e,n,i,r,o,a,u,l){const h=[];for(;e.length>0;){const d=e.pop();n.currentContext=d.contexts;let f="";if("Enter"===d.node.op&&Object(s.b)("isConstant",d.node,i,n)&&([f]=Object(s.a)(d.node.name,n)),-1===t.indexOf(d.node)){const t=c(d.node,i,n);f||([f]=Object(s.a)(d.node.name,n));const p=n.currentContext;t instanceof Promise?h.push(t.then(t=>(i[f]=t,n.currentContext=p,this.checkTensorForDisposal(f,d.node,i,n,o,a,u),this.processChildNodes(d.node,e,n,i,r,l),t))):(i[f]=t,this.checkTensorForDisposal(f,d.node,i,n,o,a,u),this.processChildNodes(d.node,e,n,i,r,l))}else this.processChildNodes(d.node,e,n,i,r,l)}return h}processChildNodes(t,e,n,i,r,o){t.children.forEach(t=>{const[a]=Object(s.a)(t.name,n);!r[a]&&o.has(t.name)&&("Merge"===t.op?t.inputNames.some(t=>!!Object(s.c)(t,i,n))&&(r[a]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(t=>!!Object(s.c)(t,i,n))&&(r[a]=!0,e.push({contexts:n.currentContext,node:t})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(t=>t.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const n=t[e],[r]=Object(s.e)(e),o=this.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){const t=o.attrParams.shape.value,e=t.length===n.shape.length&&n.shape.every((e,n)=>-1===t[n]||t[n]===e);i.util.assert(e,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${t}], but was [${n.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&i.util.assert(n.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${n.dtype}`)})}mapInputs(t){const e={};for(const n in t)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?e[this._signature.inputs[n].name]=t[n]:e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter(t=>{const[e]=Object(s.e)(t);return null==this.graph.nodes[e]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(t=>null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]?this._signature.outputs[t].name:t,{})}checkOutputs(t){t.forEach(t=>{const[e]=Object(s.e)(t);if(!this.graph.nodes[e])throw new Error(`The output '${t}' is not found in the graph`)})}}class v{constructor(t,e={}){this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=i.io.browserHTTPRequest(t,this.loadOptions);else{const e=i.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(i.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=await this.handler.load();return this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n={};null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=`${e.versions.producer}.${e.versions.minConsumer}`;const s=i.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);return this.executor=new y(r.a.Instance.transformGraph(e,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(s),!0}async save(t,e){if("string"==typeof t){const e=i.io.getSaveHandlers(t);if(0===e.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Error(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof i.Tensor||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((e,n,i)=>(e[n]=t[i],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,n)=>(e[n]=[t[n]],e),{})}dispose(){this.executor.dispose()}}async function b(t,e={}){if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file");const n=new v(t,e);return await n.load(),n}const x="2.0.1"},function(t,e,n){"use strict";(function(t){var i=n(65),r=n(66),s=n(67);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return l(this,t,e,n)}function l(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=d(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(e,n),r=(t=a(t,i)).write(e,n);return r!==i&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(c(e),t=a(t,e<0?0:0|f(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(t).length;default:if(i)return z(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return k(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function g(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function y(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=u.from(e,i)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,i,r);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,i,r){var s,o=1,a=t.length,u=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,n/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=n;s<a;s++)if(l(t,s)===l(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var h=!0,d=0;d<u;d++)if(l(t,s+d)!==l(e,d)){h=!1;break}if(h)return s}return-1}function b(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function x(t,e,n,i){return U(z(e,t.length-n),t,n,i)}function w(t,e,n,i){return U(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function T(t,e,n,i){return w(t,e,n,i)}function S(t,e,n,i){return U($(e),t,n,i)}function E(t,e,n,i){return U(function(t,e){for(var n,i,r=[],s=0;s<t.length&&!((e-=2)<0);++s)i=(n=t.charCodeAt(s))>>8,r.push(n%256),r.push(i);return r}(e,t.length-n),t,n,i)}function O(t,e,n){return i.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,u,l=t[r],c=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h<=n)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(s=t[r+1]))&&(u=(31&l)<<6|63&s)>127&&(c=u);break;case 3:o=t[r+2],128==(192&(s=t[r+1]))&&128==(192&o)&&(u=(15&l)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:o=t[r+2],a=t[r+3],128==(192&(s=t[r+1]))&&128==(192&o)&&128==(192&a)&&(u=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,h=1):c>65535&&(i.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=h}return function(t){var e=t.length;if(e<=_)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=_));return n}(i)}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return l(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,i){return c(e),e<=0?a(t,e):void 0!==n?"string"==typeof i?a(t,e).fill(n,i):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=u.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):m.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,i,r){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),l=this.slice(i,r),c=t.slice(e,n),h=0;h<a;++h)if(l[h]!==c[h]){s=l[h],o=c[h];break}return s<o?-1:o<s?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":return w(this,t,e,n);case"latin1":case"binary":return T(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function A(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function k(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function R(t,e,n){var i,r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var s="",o=e;o<n;++o)s+=(i=t[o])<16?"0"+i.toString(16):i.toString(16);return s}function I(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function M(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,i,r,s){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function D(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function P(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function F(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,i,s){return s||F(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function j(t,e,n,i,s){return s||F(t,0,n,8),r.write(t,e,n,i,52,8),n+8}u.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var r=e-t;n=new u(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},u.prototype.readUInt8=function(t,e){return e||M(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||M(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||M(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||M(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},u.prototype.readInt8=function(t,e){return e||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||M(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||M(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||M(t,4,this.length),r.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||M(t,4,this.length),r.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||M(t,8,this.length),r.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||M(t,8,this.length),r.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||N(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||N(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):P(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):D(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):D(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):P(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!u.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},u.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!u.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=u.isBuffer(t)?t:z(new u(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function z(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function $(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function U(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(27))},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return r});const i="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:void 0!==t?t:t=>t();function r(){return new Promise(t=>i(()=>t()))}}).call(this,n(76).setImmediate)},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(t,e,n){"use strict";n.r(e),n.d(e,"json",function(){return i});const i=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return o});var i=n(0),r=n(14),s=n(58);class o extends r.a{decodeUTF8(){return new a(this)}}class a extends s.a{constructor(t){super(),this.upstream=t,this.impl=new u(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class u extends r.b{constructor(t){if(super(),this.upstream=t,Object(i.env)().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=n(78);this.decoder=new t("utf8")}}summary(){return this.upstream.summary()+" -> Utf8"}async pump(){const e=await this.upstream.next();let n,r;return!e.done&&(n=e.value,r=Object(i.env)().get("IS_BROWSER")?this.decoder.decode(n,{stream:!0}):this.decoder.write(t.from(n.buffer)),this.outputQueue.push(r),!0)}}}).call(this,n(39).Buffer)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(14);class r extends i.a{split(t){return new s(this,t)}}class s extends r{constructor(t,e){super(),this.upstream=t,this.impl=new o(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class o extends i.b{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const n of e.slice(0,-1))this.outputQueue.push(n);return this.carryover=e[e.length-1],!0}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(81),r=n(38),s=n(0),o=n(82),a=n(83),u=n(85);async function l(t,e,n){return i.load({maxFaces:t,iouThreshold:e,scoreThreshold:n})}async function c(){return r.loadGraphModel("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})}function h(t,e){if(t.mesh instanceof s.Tensor){const[n,i,r,o]=s.tidy(()=>{const n=s.tensor1d([e-1,0,0]),i=s.tensor1d([1,-1,1]);return s.tidy(()=>[s.concat([s.sub(e-1,t.boundingBox.topLeft.slice(0,1)),t.boundingBox.topLeft.slice(1,1)]),s.concat([s.sub(e-1,t.boundingBox.bottomRight.slice(0,1)),t.boundingBox.bottomRight.slice(1,1)]),s.sub(n,t.mesh).mul(i),s.sub(n,t.scaledMesh).mul(i)])});return Object.assign({},t,{boundingBox:{topLeft:n,bottomRight:i},mesh:r,scaledMesh:o})}return Object.assign({},t,{boundingBox:{topLeft:[e-1-t.boundingBox.topLeft[0],t.boundingBox.topLeft[1]],bottomRight:[e-1-t.boundingBox.bottomRight[0],t.boundingBox.bottomRight[1]]},mesh:t.mesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n}),scaledMesh:t.scaledMesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n})})}e.load=async function({maxContinuousChecks:t=5,detectionConfidence:e=.9,maxFaces:n=10,iouThreshold:i=.3,scoreThreshold:r=.75}={}){const[s,o]=await Promise.all([l(n,i,r),c()]);return new d(s,o,t,e,n)};class d{constructor(t,e,n,i,r){this.pipeline=new a.Pipeline(t,e,192,192,n,r),this.detectionConfidence=i}static getAnnotations(){return o.MESH_ANNOTATIONS}static getUVCoords(){return u.UV_COORDS}async estimateFaces(t,e=!1,n=!1){const[,i]=function(t){return t instanceof s.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),r=s.tidy(()=>(t instanceof s.Tensor||(t=s.browser.fromPixels(t)),t.toFloat().expandDims(0))),a=s.env().get("WEBGL_PACK_DEPTHWISECONV");s.env().set("WEBGL_PACK_DEPTHWISECONV",!0);const u=await this.pipeline.predict(r);return s.env().set("WEBGL_PACK_DEPTHWISECONV",a),r.dispose(),null!=u&&u.length>0?Promise.all(u.map(async(t,r)=>{const{coords:s,scaledCoords:a,box:u,flag:l}=t;let c=[l];e||(c=c.concat([s,a,u.startPoint,u.endPoint]));const d=await Promise.all(c.map(async t=>t.array())),f=d[0];if(l.dispose(),f<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(r),e){const t={faceInViewConfidence:f,mesh:s,scaledMesh:a,boundingBox:{topLeft:u.startPoint.squeeze(),bottomRight:u.endPoint.squeeze()}};return n?h(t,i):t}const[p,m,g,y]=d.slice(1);a.dispose(),s.dispose();let v={faceInViewConfidence:f,boundingBox:{topLeft:g,bottomRight:y},mesh:p,scaledMesh:m};n&&(v=h(v,i));const b={};for(const e in o.MESH_ANNOTATIONS)b[e]=o.MESH_ANNOTATIONS[e].map(t=>v.scaledMesh[t]);return v.annotations=b,v})):[]}}e.FaceMesh=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(87),s=n(38),o=n(88),a=n(89),u=n(86),l={"tfjs-core":i.version_core,"tfjs-backend-cpu":a.version_cpu,"tfjs-backend-webgl":u.version_webgl,"tfjs-data":o.version_data,"tfjs-layers":r.version_layers,"tfjs-converter":s.version_converter,tfjs:"2.0.1"};Object.keys(i).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}})}),Object.keys(r).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})}),Object.keys(s).forEach(function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}})}),e.data=o,e.version=l},function(t,e,n){"use strict";(function(t){var e=n(36),i=n(10);const r=Object(i.c)();r.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),r.registerFlag("IS_BROWSER",()=>e.isBrowser()),r.registerFlag("IS_NODE",()=>void 0!==t&&void 0!==t.versions&&void 0!==t.versions.node),r.registerFlag("IS_CHROME",()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),r.registerFlag("PROD",()=>!1),r.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>r.getBool("DEBUG")),r.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),r.registerFlag("IS_TEST",()=>!1)}).call(this,n(35))},function(t,e,n){"use strict";(function(t){var e=n(10);let i;Object(e.c)().get("IS_NODE")&&Object(e.c)().setPlatform("node",new class{constructor(){this.util=n(64),this.textEncoder=new this.util.TextEncoder}fetch(t,r){return null!=Object(e.c)().global.fetch?Object(e.c)().global.fetch(t,r):(null==i&&(i=n(63)),i(t,r))}now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}})}).call(this,n(35))},function(t,e){},function(t,e){},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[1];return 3*(e[0]+n)/4-n},e.toByteArray=function(t){var e,n,i=l(t),o=i[0],a=i[1],u=new s(function(t,e,n){return 3*(e+n)/4-n}(0,o,a)),c=0,h=a>0?o-4:o;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;return 2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[c++]=255&e),1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e),u},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,s=[],o=16383,a=0,u=n-r;a<u;a+=o)s.push(c(t,a,a+o>u?u:a+o));return 1===r?s.push(i[(e=t[n-1])>>2]+i[e<<4&63]+"=="):2===r&&s.push(i[(e=(t[n-2]<<8)+t[n-1])>>10]+i[e>>4&63]+i[e<<2&63]+"="),s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=o.length;a<u;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var r,s=[],o=e;o<n;o+=3)s.push(i[(r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]))>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,u=(1<<a)-1,l=u>>1,c=-7,h=n?r-1:0,d=n?-1:1,f=t[e+h];for(h+=d,s=f&(1<<-c)-1,f>>=-c,c+=a;c>0;s=256*s+t[e+h],h+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=256*o+t[e+h],h+=d,c-=8);if(0===s)s=1-l;else{if(s===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=l}return(f?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,u,l=8*s-r-1,c=(1<<l)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=c?(a=0,o=c):o+h>=1?(a=(e*u-1)*Math.pow(2,r),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,l+=r;l>0;t[n+f]=255&o,f+=p,o/=256,l-=8);t[n+f-p]|=128*m}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e,n=this,i=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=i(" "),n.s1=i(" "),n.s2=i(" "),n.s0-=i(t),n.s0<0&&(n.s0+=1),n.s1-=i(t),n.s1<0&&(n.s1+=1),n.s2-=i(t),n.s2<0&&(n.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new o(t),i=e&&e.state,r=n.next;return r.int32=function(){return 4294967296*n.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.alea=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.xor128=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.xorwow=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],i[r]=n^=(t^=t<<13)^t<<9,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n&&(i[7]=-1),t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.x&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.xorshift7=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,s=e.i;return e.w=i=i+1640531527|0,n=r[s+34&127],t=r[s=s+1&127],n^=n<<13,t^=t<<17,n=r[s]=(n^=n>>>15)^(t^=t>>>12),e.i=s,n+(i^i>>>16)|0},function(t,e){var n,i,r,s,o,a=[],u=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,u=Math.max(u,e.length)),r=0,s=-32;s<u;++s)e&&(i^=e.charCodeAt((s+32)%e.length)),0===s&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,s>=0&&(r=0==(n=a[127&s]^=i+(o=o+1640531527|0))?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,s=512;s>0;--s)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,a[r]=(i^=i>>>15)^(n^=n>>>12);t.w=o,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&(i.X&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.xor4096=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){(function(t){var i;!function(t,r,s){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new o(t),i=e&&e.state,r=function(){return(n.next()>>>0)/4294967296};return r.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=n.next,r.quick=r,i&&("object"==typeof i&&a(i,n),r.state=function(){return a(n,{})}),r}r&&r.exports?r.exports=u:n(16)&&n(29)?void 0===(i=(function(){return u}).call(e,n,e,r))||(r.exports=i):this.tychei=u}(0,t,n(16))}).call(this,n(28)(t))},function(t,e,n){var i;!function(r,s){var o,a=this,u=256,l=s.pow(u,6),c=s.pow(2,52),h=2*c,d=255;function f(t,e,n){var i=[],d=y(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(u):(t=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(t)),v(t)}catch(i){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,v(r)]}}():t,3),i),f=new p(i),b=function(){for(var t=f.g(6),e=l,n=0;t<c;)t=(t+n)*u,e*=u,n=f.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(v(f.S),r),(e.pass||n||function(t,e,n,i){return i&&(i.S&&m(i,f),t.state=function(){return m(f,{})}),n?(s.random=t,e):t})(b,d,"global"in e?e.global:this==s,e.state)}function p(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,o=i.S=[];for(n||(t=[n++]);r<u;)o[r]=r++;for(r=0;r<u;r++)o[r]=o[s=d&s+t[r%n]+(e=o[r])],o[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,o=i.S;t--;)e=o[r=d&r+1],n=n*u+o[d&(o[r]=o[s=d&s+e])+(o[s]=e)];return i.i=r,i.j=s,n})(u)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(g(t[n],e-1))}catch(s){}return i.length?i:"string"==r?t:t+"\0"}function y(t,e){for(var n,i=t+"",r=0;r<i.length;)e[d&r]=d&(n^=19*e[d&r])+i.charCodeAt(r++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(s.seedrandom=f,y(s.random(),r),t.exports){t.exports=f;try{o=n(75)}catch(b){}}else void 0===(i=(function(){return f}).call(e,n,e,t))||(t.exports=i)}([],Math)},function(t,e){},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new s(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(77),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(27))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,s,o,a,u=1,l={},c=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){p(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&p(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),i=function(e){t.postMessage(o+e,"*")}):t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){p(t.data)},i=function(t){s.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,i=function(t){var e=h.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(p,0,t)},d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return l[u]=r,i(u),u++},d.clearImmediate=f}function f(t){delete l[t]}function p(t){if(c)setTimeout(p,0,t);else{var e=l[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(27),n(35))},function(t,e){},function(t,e){},function(t,e,n){var i,r;void 0===(r="function"==typeof(i=function(t){"use strict";var e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i={order:2,precision:2,period:null};function r(t,e){var n=[],i=[];t.forEach(function(t,r){null!==t[1]&&(i.push(t),n.push(e[r]))});var r=i.reduce(function(t,e){return t+e[1]},0)/i.length,s=i.reduce(function(t,e){var n=e[1]-r;return t+n*n},0);return 1-i.reduce(function(t,e,i){var r=e[1]-n[i][1];return t+r*r},0)/s}function s(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var o={linear:function(t,e){for(var n=[0,0,0,0,0],i=0,o=0;o<t.length;o++)null!==t[o][1]&&(i++,n[0]+=t[o][0],n[1]+=t[o][1],n[2]+=t[o][0]*t[o][0],n[3]+=t[o][0]*t[o][1],n[4]+=t[o][1]*t[o][1]);var a=i*n[2]-n[0]*n[0],u=0===a?0:s((i*n[3]-n[0]*n[1])/a,e.precision),l=s(n[1]/i-u*n[0]/i,e.precision),c=function(t){return[s(t,e.precision),s(u*t+l,e.precision)]},h=t.map(function(t){return c(t[0])});return{points:h,predict:c,equation:[u,l],r2:s(r(t,h),e.precision),string:0===l?"y = "+u+"x":"y = "+u+"x + "+l}},exponential:function(t,e){for(var n=[0,0,0,0,0,0],i=0;i<t.length;i++)null!==t[i][1]&&(n[0]+=t[i][0],n[1]+=t[i][1],n[2]+=t[i][0]*t[i][0]*t[i][1],n[3]+=t[i][1]*Math.log(t[i][1]),n[4]+=t[i][0]*t[i][1]*Math.log(t[i][1]),n[5]+=t[i][0]*t[i][1]);var o=n[1]*n[2]-n[5]*n[5],a=Math.exp((n[2]*n[3]-n[5]*n[4])/o),u=(n[1]*n[4]-n[5]*n[3])/o,l=s(a,e.precision),c=s(u,e.precision),h=function(t){return[s(t,e.precision),s(l*Math.exp(c*t),e.precision)]},d=t.map(function(t){return h(t[0])});return{points:d,predict:h,equation:[l,c],string:"y = "+l+"e^("+c+"x)",r2:s(r(t,d),e.precision)}},logarithmic:function(t,e){for(var n=[0,0,0,0],i=t.length,o=0;o<i;o++)null!==t[o][1]&&(n[0]+=Math.log(t[o][0]),n[1]+=t[o][1]*Math.log(t[o][0]),n[2]+=t[o][1],n[3]+=Math.pow(Math.log(t[o][0]),2));var a=s((i*n[1]-n[2]*n[0])/(i*n[3]-n[0]*n[0]),e.precision),u=s((n[2]-a*n[0])/i,e.precision),l=function(t){return[s(t,e.precision),s(s(u+a*Math.log(t),e.precision),e.precision)]},c=t.map(function(t){return l(t[0])});return{points:c,predict:l,equation:[u,a],string:"y = "+u+" + "+a+" ln(x)",r2:s(r(t,c),e.precision)}},power:function(t,e){for(var n=[0,0,0,0,0],i=t.length,o=0;o<i;o++)null!==t[o][1]&&(n[0]+=Math.log(t[o][0]),n[1]+=Math.log(t[o][1])*Math.log(t[o][0]),n[2]+=Math.log(t[o][1]),n[3]+=Math.pow(Math.log(t[o][0]),2));var a=(i*n[1]-n[0]*n[2])/(i*n[3]-Math.pow(n[0],2)),u=s(Math.exp((n[2]-a*n[0])/i),e.precision),l=s(a,e.precision),c=function(t){return[s(t,e.precision),s(s(u*Math.pow(t,l),e.precision),e.precision)]},h=t.map(function(t){return c(t[0])});return{points:h,predict:c,equation:[u,l],string:"y = "+u+"x^"+l,r2:s(r(t,h),e.precision)}},polynomial:function(t,e){for(var i=[],o=[],a=0,u=0,l=t.length,c=e.order+1,h=0;h<c;h++){for(var d=0;d<l;d++)null!==t[d][1]&&(a+=Math.pow(t[d][0],h)*t[d][1]);i.push(a),a=0;for(var f=[],p=0;p<c;p++){for(var m=0;m<l;m++)null!==t[m][1]&&(u+=Math.pow(t[m][0],h+p));f.push(u),u=0}o.push(f)}o.push(i);for(var g=function(t,e){for(var n=t,i=t.length-1,r=[e],s=0;s<i;s++){for(var o=s,a=s+1;a<i;a++)Math.abs(n[s][a])>Math.abs(n[s][o])&&(o=a);for(var u=s;u<i+1;u++){var l=n[u][s];n[u][s]=n[u][o],n[u][o]=l}for(var c=s+1;c<i;c++)for(var h=i;h>=s;h--)n[h][c]-=n[h][s]*n[s][c]/n[s][s]}for(var d=i-1;d>=0;d--){for(var f=0,p=d+1;p<i;p++)f+=n[p][d]*r[p];r[d]=(n[i][d]-f)/n[d][d]}return r}(o,c).map(function(t){return s(t,e.precision)}),y=function(t){return[s(t,e.precision),s(g.reduce(function(e,n,i){return e+n*Math.pow(t,i)},0),e.precision)]},v=t.map(function(t){return y(t[0])}),b="y = ",x=g.length-1;x>=0;x--)b+=x>1?g[x]+"x^"+x+" + ":1===x?g[x]+"x + ":g[x];return{string:b,points:v,predict:y,equation:[].concat(n(g)).reverse(),r2:s(r(t,v),e.precision)}}};t.exports=Object.keys(o).reduce(function(t,n){return e({_round:s},t,(u=function(t,r){return o[n](t,e({},i,r))},(a=n)in(r={})?Object.defineProperty(r,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[a]=u,r));var r,a,u},{})})?i.apply(e,[t]):i)||(t.exports=r)},function(t,e,n){"use strict";n.r(e),n.d(e,"load",function(){return c}),n.d(e,"BlazeFaceModel",function(){return l});var i=n(0),r=n(38);const s=t=>({startEndTensor:t,startPoint:Object(i.slice)(t,[0,0],[-1,2]),endPoint:Object(i.slice)(t,[0,2],[-1,2])}),o={strides:[8,16],anchors:[2,6]};function a(t,e){let n,r,s;if(t.topLeft instanceof i.Tensor&&t.bottomRight instanceof i.Tensor){const[o,a]=Object(i.tidy)(()=>[Object(i.concat)([Object(i.sub)(e-1,t.topLeft.slice(0,1)),t.topLeft.slice(1,1)]),Object(i.concat)([Object(i.sub)(e-1,t.bottomRight.slice(0,1)),t.bottomRight.slice(1,1)])]);n=o,r=a,null!=t.landmarks&&(s=Object(i.tidy)(()=>{const n=Object(i.sub)(Object(i.tensor1d)([e-1,0]),t.landmarks),r=Object(i.tensor1d)([1,-1]);return Object(i.mul)(n,r)}))}else{const[i,o]=t.topLeft,[a,u]=t.bottomRight;n=[e-1-i,o],r=[e-1-a,u],null!=t.landmarks&&(s=t.landmarks.map(t=>[e-1-t[0],t[1]]))}const o={topLeft:n,bottomRight:r};return null!=s&&(o.landmarks=s),null!=t.probability&&(o.probability=t.probability instanceof i.Tensor?t.probability.clone():t.probability),o}function u(t,e){return Object(i.tidy)(()=>{let n;return n=t.hasOwnProperty("box")?t.box:t,((t,e)=>{const n=Object(i.mul)(t.startPoint,e),r=Object(i.mul)(t.endPoint,e),o=Object(i.concat2d)([n,r],1);return s(o)})(n,e).startEndTensor.squeeze()})}class l{constructor(t,e,n,r,s,a){this.blazeFaceModel=t,this.width=e,this.height=n,this.maxFaces=r,this.anchorsData=function(t,e,n){const i=[];for(let r=0;r<n.strides.length;r++){const s=n.strides[r],o=Math.floor((e+s-1)/s),a=Math.floor((t+s-1)/s),u=n.anchors[r];for(let t=0;t<o;t++){const e=s*(t+.5);for(let t=0;t<a;t++){const n=s*(t+.5);for(let t=0;t<u;t++)i.push([n,e])}}}return i}(e,n,o),this.anchors=Object(i.tensor2d)(this.anchorsData),this.inputSizeData=[e,n],this.inputSize=Object(i.tensor1d)([e,n]),this.iouThreshold=s,this.scoreThreshold=a}async getBoundingBoxes(t,e,n=!0){const[r,o,a]=Object(i.tidy)(()=>{const e=t.resizeBilinear([this.width,this.height]),n=Object(i.mul)(Object(i.sub)(e.div(255),.5),2),r=this.blazeFaceModel.predict(n).squeeze(),s=function(t,e,n){const r=Object(i.slice)(t,[0,1],[-1,2]),s=Object(i.add)(r,e),o=Object(i.slice)(t,[0,3],[-1,2]),a=Object(i.div)(o,n),u=Object(i.div)(s,n),l=Object(i.div)(a,2),c=Object(i.sub)(u,l),h=Object(i.add)(u,l),d=Object(i.mul)(c,n),f=Object(i.mul)(h,n);return Object(i.concat2d)([d,f],1)}(r,this.anchors,this.inputSize),o=Object(i.slice)(r,[0,0],[-1,1]);return[r,s,Object(i.sigmoid)(o).squeeze()]}),u=console.warn;console.warn=()=>{};const l=i.image.nonMaxSuppression(o,a,this.maxFaces,this.iouThreshold,this.scoreThreshold);console.warn=u;const c=await l.array();l.dispose();let h=c.map(t=>Object(i.slice)(o,[t,0],[1,-1]));e||(h=await Promise.all(h.map(async t=>{const e=await t.array();return t.dispose(),e})));const d=t.shape[1],f=t.shape[2];let p;p=e?Object(i.div)([f,d],this.inputSize):[f/this.inputSizeData[0],d/this.inputSizeData[1]];const m=[];for(let g=0;g<h.length;g++){const t=h[g],o=Object(i.tidy)(()=>{const o=s(t instanceof i.Tensor?t:Object(i.tensor2d)(t));if(!n)return o;const u=c[g];let l;return l=e?this.anchors.slice([u,0],[1,2]):this.anchorsData[u],{box:o,landmarks:Object(i.slice)(r,[u,5],[1,-1]).squeeze().reshape([6,-1]),probability:Object(i.slice)(a,[u],[1]),anchor:l}});m.push(o)}return o.dispose(),a.dispose(),r.dispose(),{boxes:m,scaleFactor:p}}async estimateFaces(t,e=!1,n=!1,r=!0){const[,s]=function(t){return t instanceof i.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),o=Object(i.tidy)(()=>(t instanceof i.Tensor||(t=i.browser.fromPixels(t)),t.toFloat().expandDims(0))),{boxes:l,scaleFactor:c}=await this.getBoundingBoxes(o,e,r);return o.dispose(),e?l.map(t=>{const e=u(t,c);let i={topLeft:e.slice([0],[2]),bottomRight:e.slice([2],[2])};if(r){const{landmarks:e,probability:n,anchor:r}=t,s=e.add(r).mul(c);i.landmarks=s,i.probability=n}return n&&(i=a(i,s)),i}):Promise.all(l.map(async t=>{const e=u(t,c);let i;if(r){const[n,r,s]=await Promise.all([t.landmarks,e,t.probability].map(async t=>t.array())),o=t.anchor,[a,u]=c,l=n.map(t=>[(t[0]+o[0])*a,(t[1]+o[1])*u]);i={topLeft:r.slice(0,2),bottomRight:r.slice(2),landmarks:l,probability:s},(t=>{t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()})(t.box),t.landmarks.dispose(),t.probability.dispose()}else{const t=await e.array();i={topLeft:t.slice(0,2),bottomRight:t.slice(2)}}return e.dispose(),n&&(i=a(i,s)),i}))}}async function c({maxFaces:t=10,inputWidth:e=128,inputHeight:n=128,iouThreshold:i=.3,scoreThreshold:s=.75}={}){const o=await Object(r.loadGraphModel)("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0});return new l(o,e,n,t,i,s)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MESH_ANNOTATIONS={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(0),r=n(84);e.Pipeline=class{constructor(t,e,n,i,r,s){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=t,this.meshDetector=e,this.meshWidth=n,this.meshHeight=i,this.maxContinuousChecks=r,this.maxFaces=s}async predict(t){if(this.shouldUpdateRegionsOfInterest()){const e=!0,n=!1,{boxes:i,scaleFactor:s}=await this.boundingBoxDetector.getBoundingBoxes(t,e,n);if(0===i.length)return s.dispose(),this.clearAllRegionsOfInterest(),null;const o=i.map(t=>r.enlargeBox(r.scaleBoxCoordinates(t,s)));i.forEach(r.disposeBox),this.updateRegionsOfInterest(o),this.runsWithoutFaceDetector=0}else this.runsWithoutFaceDetector++;return i.tidy(()=>this.regionsOfInterest.map((e,n)=>{const s=r.cutBoxFromImageAndResize(e,t,[this.meshHeight,this.meshWidth]).div(255),[,o,a]=this.meshDetector.predict(s),u=i.reshape(a,[-1,3]),l=i.div(r.getBoxSize(e),[this.meshWidth,this.meshHeight]),c=i.mul(u,l.concat(i.tensor2d([1],[1,1]),1)).add(e.startPoint.concat(i.tensor2d([0],[1,1]),1)),h=this.calculateLandmarksBoundingBox(c);return r.disposeBox(this.regionsOfInterest[n]),this.regionsOfInterest[n]=h,{coords:u,scaledCoords:c,box:h,flag:o.squeeze()}}))}updateRegionsOfInterest(t){for(let e=0;e<t.length;e++){const n=t[e],i=this.regionsOfInterest[e];let s=0;if(i&&i.startPoint){const[t,e,r,o]=n.startEndTensor.arraySync()[0],[a,u,l,c]=i.startEndTensor.arraySync()[0],h=Math.max(t,a),d=Math.max(e,u),f=(Math.min(r,l)-h)*(Math.min(o,c)-d);s=f/((r-t)*(o-e)+(l-a)*(c-e)-f)}s>.25?r.disposeBox(n):(this.regionsOfInterest[e]=n,r.disposeBox(i))}for(let e=t.length;e<this.regionsOfInterest.length;e++)r.disposeBox(this.regionsOfInterest[e]);this.regionsOfInterest=this.regionsOfInterest.slice(0,t.length)}clearRegionOfInterest(t){null!=this.regionsOfInterest[t]&&(r.disposeBox(this.regionsOfInterest[t]),this.regionsOfInterest=[...this.regionsOfInterest.slice(0,t),...this.regionsOfInterest.slice(t+1)])}clearAllRegionsOfInterest(){for(let t=0;t<this.regionsOfInterest.length;t++)r.disposeBox(this.regionsOfInterest[t]);this.regionsOfInterest=[]}shouldUpdateRegionsOfInterest(){const t=this.regionsOfInterest.length,e=0===t;return 1===this.maxFaces||e?e:t!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks}calculateLandmarksBoundingBox(t){const e=t.slice([0,0],[468,1]),n=t.slice([0,1],[468,1]),s=i.stack([e.min(),n.min(),e.max(),n.max()]),o=r.createBox(s.expandDims(0));return r.enlargeBox(o)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(0);function r(t,e,n){return{startEndTensor:t,startPoint:null!=e?e:i.slice(t,[0,0],[-1,2]),endPoint:null!=n?n:i.slice(t,[0,2],[-1,2])}}function s(t){return i.tidy(()=>{const e=i.sub(t.endPoint,t.startPoint);return i.abs(e)})}function o(t){return i.tidy(()=>{const e=i.div(i.sub(t.endPoint,t.startPoint),2);return i.add(t.startPoint,e)})}e.disposeBox=function(t){null!=t&&null!=t.startPoint&&(t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose())},e.createBox=r,e.scaleBoxCoordinates=function(t,e){const n=i.mul(t.startPoint,e),s=i.mul(t.endPoint,e);return r(i.concat2d([n,s],1))},e.getBoxSize=s,e.getBoxCenter=o,e.cutBoxFromImageAndResize=function(t,e,n){const r=e.shape[1],s=e.shape[2],o=t.startEndTensor;return i.tidy(()=>{const t=i.concat2d([o.slice([0,1],[-1,1]),o.slice([0,0],[-1,1]),o.slice([0,3],[-1,1]),o.slice([0,2],[-1,1])],0),a=i.div(t.transpose(),[r,s,r,s]);return i.image.cropAndResize(e,a,[0],n)})},e.enlargeBox=function(t,e=1.5){return i.tidy(()=>{const n=o(t),a=s(t),u=i.mul(i.div(a,2),e),l=i.sub(n,u),c=i.add(n,u);return r(i.concat2d([l,c],1),l,c)})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UV_COORDS=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]]},function(t,e,n){"use strict";n.r(e),n.d(e,"version_webgl",function(){return Kn}),n.d(e,"MathBackendWebGL",function(){return qn}),n.d(e,"setWebGLContext",function(){return u}),n.d(e,"GPGPUContext",function(){return $e}),n.d(e,"gpgpu_util",function(){return r}),n.d(e,"webgl_util",function(){return i}),n.d(e,"forceHalfFloat",function(){return gi}),n.d(e,"webgl",function(){return yi});var i={};n.r(i),n.d(i,"callAndCheck",function(){return y}),n.d(i,"canBeRepresented",function(){return v}),n.d(i,"getWebGLErrorMessage",function(){return b}),n.d(i,"getExtensionOrThrow",function(){return x}),n.d(i,"createVertexShader",function(){return w}),n.d(i,"createFragmentShader",function(){return T}),n.d(i,"createProgram",function(){return E}),n.d(i,"linkProgram",function(){return O}),n.d(i,"validateProgram",function(){return C}),n.d(i,"createStaticVertexBuffer",function(){return _}),n.d(i,"createStaticIndexBuffer",function(){return A}),n.d(i,"getNumChannels",function(){return k}),n.d(i,"createTexture",function(){return R}),n.d(i,"validateTextureSize",function(){return I}),n.d(i,"createFramebuffer",function(){return M}),n.d(i,"bindVertexBufferToProgramAttribute",function(){return N}),n.d(i,"bindTextureUnit",function(){return D}),n.d(i,"unbindTextureUnit",function(){return P}),n.d(i,"getProgramUniformLocationOrThrow",function(){return F}),n.d(i,"getProgramUniformLocation",function(){return L}),n.d(i,"bindTextureToProgramUniformSampler",function(){return j}),n.d(i,"bindCanvasToFramebuffer",function(){return B}),n.d(i,"bindColorTextureToFramebuffer",function(){return z}),n.d(i,"unbindColorTextureFromFramebuffer",function(){return $}),n.d(i,"validateFramebuffer",function(){return U}),n.d(i,"getFramebufferErrorMessage",function(){return W}),n.d(i,"getBatchDim",function(){return G}),n.d(i,"getRowsCols",function(){return X}),n.d(i,"getShapeAs3D",function(){return H}),n.d(i,"getTextureShapeFromLogicalShape",function(){return q}),n.d(i,"isReshapeFree",function(){return J}),n.d(i,"getWebGLMaxTextureSize",function(){return tt}),n.d(i,"resetMaxTextureSize",function(){return et}),n.d(i,"resetMaxTexturesInShader",function(){return nt}),n.d(i,"getMaxTexturesInShader",function(){return it}),n.d(i,"getWebGLDisjointQueryTimerVersion",function(){return rt}),n.d(i,"hasExtension",function(){return st}),n.d(i,"isWebGLVersionEnabled",function(){return ot}),n.d(i,"isCapableOfRenderingToFloatTexture",function(){return at}),n.d(i,"isDownloadFloatTextureEnabled",function(){return ut}),n.d(i,"isWebGLFenceEnabled",function(){return ct});var r={};n.r(r),n.d(r,"createVertexShader",function(){return Ee}),n.d(r,"createVertexBuffer",function(){return Oe}),n.d(r,"createIndexBuffer",function(){return Ce}),n.d(r,"createFloat32MatrixTexture",function(){return Ae}),n.d(r,"createFloat16MatrixTexture",function(){return ke}),n.d(r,"createUnsignedBytesMatrixTexture",function(){return Re}),n.d(r,"createPackedMatrixTexture",function(){return Ie}),n.d(r,"createFloat16PackedMatrixTexture",function(){return Me}),n.d(r,"bindVertexProgramAttributeStreams",function(){return Ne}),n.d(r,"uploadDenseMatrixToTexture",function(){return De}),n.d(r,"uploadPixelDataToTexture",function(){return Pe}),n.d(r,"createBufferFromOutputTexture",function(){return Fe}),n.d(r,"downloadFloat32MatrixFromBuffer",function(){return Le}),n.d(r,"downloadByteEncodedFloatMatrixFromOutputTexture",function(){return je}),n.d(r,"downloadPackedMatrixFromBuffer",function(){return Be}),n.d(r,"downloadMatrixFromPackedOutputTexture",function(){return ze});var s=n(0);const o={},a={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function u(t,e){o[t]=e}function l(t){t in o||(o[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete o[t]},!1),1===t?e.getContext("webgl",a)||e.getContext("experimental-webgl",a):e.getContext("webgl2",a)}(t));const e=o[t];return e.isContextLost()?(delete o[t],l(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),o[t])}var c,h,d;function f(t,e){return[e,t]}function p(t){const e=s.util.sizeFromShape(t),n=Math.ceil(e/4);return s.util.sizeToSquarishShape(n)}function m(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function g(t,e){const n=t;let i,r,o,a,u,l,c,h,d,f;return 2===Object(s.env)().getNumber("WEBGL_VERSION")?(i=n.R32F,r=n.R16F,o=n.RGBA16F,a=n.RGBA32F,u=n.RED,c=4,h=1,d=n.HALF_FLOAT,f=n.FLOAT):(i=t.RGBA,r=t.RGBA,o=t.RGBA,a=n.RGBA,u=t.RGBA,c=4,h=4,d=null!=e?e.HALF_FLOAT_OES:null,f=t.FLOAT),l=t.RGBA,{internalFormatFloat:i,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:a,textureFormatFloat:u,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:h,textureTypeHalfFloat:d,textureTypeFloat:f}}function y(t,e,n){const i=n();return e&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+b(t,e))}(t),i}function v(t){return!!(Object(s.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function b(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function x(t,e,n){return V(t,e,()=>t.getExtension(n),'Extension "'+n+'" not supported on this browser.')}function w(t,e,n){const i=V(t,e,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(y(t,e,()=>t.shaderSource(i,n)),y(t,e,()=>t.compileShader(i)),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(i)),new Error("Failed to compile vertex shader.");return i}function T(t,e,n){const i=V(t,e,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(y(t,e,()=>t.shaderSource(i,n)),y(t,e,()=>t.compileShader(i)),!1===t.getShaderParameter(i,t.COMPILE_STATUS))throw function(t,e){const n=S.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);const i=+n[1],r=t.split("\n"),o=r.length.toString().length+2,a=r.map((t,e)=>s.util.rightPad((e+1).toString(),o)+t);let u=0;for(let s=0;s<a.length;s++)u=Math.max(a[s].length,u);const l=a.slice(0,i-1),c=a.slice(i-1,i),h=a.slice(i);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+s.util.rightPad(c[0],u),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(i)),new Error("Failed to compile fragment shader.");return i}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(c||(c={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(h||(h={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(d||(d={}));const S=/ERROR: [0-9]+:([0-9]+):/g;function E(t,e){return V(t,e,()=>t.createProgram(),"Unable to create WebGLProgram.")}function O(t,e,n){if(y(t,e,()=>t.linkProgram(n)),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function C(t,e,n){if(y(t,e,()=>t.validateProgram(n)),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function _(t,e,n){const i=V(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return y(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,i)),y(t,e,()=>t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)),i}function A(t,e,n){const i=V(t,e,()=>t.createBuffer(),"Unable to create WebGLBuffer");return y(t,e,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i)),y(t,e,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)),i}function k(){return 2===Object(s.env)().getNumber("WEBGL_VERSION")?1:4}function R(t,e){return V(t,e,()=>t.createTexture(),"Unable to create WebGLTexture.")}function I(t,e){const n=Object(s.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0)throw new Error(`Requested texture size [${t}x${e}] is invalid.`);if(t>n||e>n)throw new Error(`Requested texture size [${t}x${e}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}function M(t,e){return V(t,e,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function N(t,e,n,i,r,s,o,a){const u=t.getAttribLocation(n,i);return-1!==u&&(y(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),y(t,e,()=>t.vertexAttribPointer(u,s,t.FLOAT,!1,o,a)),y(t,e,()=>t.enableVertexAttribArray(u)),!0)}function D(t,e,n,i){Y(t,i),y(t,e,()=>t.activeTexture(t.TEXTURE0+i)),y(t,e,()=>t.bindTexture(t.TEXTURE_2D,n))}function P(t,e,n){Y(t,n),y(t,e,()=>t.activeTexture(t.TEXTURE0+n)),y(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}function F(t,e,n,i){return V(t,e,()=>t.getUniformLocation(n,i),'uniform "'+i+'" not present in program.')}function L(t,e,n){return t.getUniformLocation(e,n)}function j(t,e,n,i,r,s){y(t,e,()=>D(t,e,i,s)),y(t,e,()=>t.uniform1i(r,s))}function B(t,e){y(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),y(t,e,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),y(t,e,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function z(t,e,n,i){y(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,i)),y(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0))}function $(t,e,n){y(t,e,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),y(t,e,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function U(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+W(t,e))}function W(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function V(t,e,n,i){const r=y(t,e,()=>n());if(null==r)throw new Error(i);return r}function Y(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,i=e+t.TEXTURE0;if(i<t.TEXTURE0||i>n)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${n}].`)}function G(t,e=2){return s.util.sizeFromShape(t.slice(0,t.length-e))}function X(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function H(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[G(t),...X(t)]),e}function q(t,e=!1){let n=Object(s.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(n*=2,1===(t=t.map((e,n)=>n>=t.length-2?s.util.nearestLargerEven(t[n]):t[n])).length&&(t=[2,t[0]])),2!==t.length){const e=s.util.squeezeShape(t);t=e.newShape}let i=s.util.sizeFromShape(t);if(t.length<=1&&i<=n)return[1,i];if(2===t.length&&t[0]<=n&&t[1]<=n)return t;if(3===t.length&&t[0]*t[1]<=n&&t[2]<=n)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=n&&t[1]*t[2]<=n)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n)return[t[0],t[1]*t[2]*t[3]];if(e){const e=G(t);let n=2,r=2;return t.length&&([n,r]=X(t)),i=e*(n/2)*(r/2),s.util.sizeToSquarishShape(i).map(t=>2*t)}return s.util.sizeToSquarishShape(i)}function K(t){return t%2==0}function J(t,e){if(t=t.slice(-2),e=e.slice(-2),s.util.arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],i=e.slice(-1)[0];if(n===i)return!0;if(K(n)&&K(i)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&K(t[0])&&K(e[0])}let Q,Z;function tt(t){if(null==Q){const e=l(t);Q=e.getParameter(e.MAX_TEXTURE_SIZE)}return Q}function et(){Q=null}function nt(){Z=null}function it(t){if(null==Z){const e=l(t);Z=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Z)}function rt(t){if(0===t)return 0;let e;const n=l(t);return e=st(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:st(n,"EXT_disjoint_timer_query")?1:0,e}function st(t,e){return null!=t.getExtension(e)}function ot(t){try{if(null!=l(t))return!0}catch(e){return!1}return!1}function at(t){if(0===t)return!1;const e=l(t);if(1===t){if(!st(e,"OES_texture_float"))return!1}else if(!st(e,"EXT_color_buffer_float"))return!1;return lt(e)}function ut(t){if(0===t)return!1;const e=l(t);if(1!==t){if(st(e,"EXT_color_buffer_float"))return lt(e);const t="EXT_color_buffer_half_float";if(st(e,t)){const n=e.getExtension(t);return function(t,e){const n=g(t,e),i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(i),t.deleteFramebuffer(r),s}(e,n)}return!1}return!!st(e,"OES_texture_float")&&!!st(e,"WEBGL_color_buffer_float")&&lt(e)}function lt(t){const e=g(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const r=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),r}function ct(t){return 2===t&&null!=l(t).fenceSync}const ht=Object(s.env)();ht.registerFlag("HAS_WEBGL",()=>ht.getNumber("WEBGL_VERSION")>0),ht.registerFlag("WEBGL_VERSION",()=>ot(2)?2:ot(1)?1:0),ht.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===ht.get("WEBGL_VERSION")),ht.registerFlag("WEBGL_CPU_FORWARD",()=>!0),ht.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),ht.registerFlag("WEBGL_PACK",()=>ht.getBool("HAS_WEBGL")),ht.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_CLIP",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>!1),ht.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_PACK_REDUCE",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_LAZILY_UNPACK",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_CONV_IM2COL",()=>ht.getBool("WEBGL_PACK")),ht.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>tt(ht.getNumber("WEBGL_VERSION"))),ht.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>it(ht.getNumber("WEBGL_VERSION"))),ht.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=ht.getNumber("WEBGL_VERSION");return 0===t?0:rt(t)}),ht.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ht.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!s.device_util.isMobile()),ht.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>at(ht.getNumber("WEBGL_VERSION"))),ht.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!ht.getBool("WEBGL_FORCE_F16_TEXTURES")&&ht.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),ht.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>ut(ht.getNumber("WEBGL_VERSION"))),ht.registerFlag("WEBGL_FENCE_API_ENABLED",()=>ct(ht.getNumber("WEBGL_VERSION"))),ht.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ht.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);class dt{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`float v${t} = get${t}AtOutCoords();`)});const i=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${i};\n        setOutput(result);\n      }\n    `}}class ft{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)});const i=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${i};\n        setOutput(result);\n      }\n    `}}class pt{constructor(t,e,n){this.variableNames=["A"];const i=t.windowSize,r=t.batchSize,s=Math.ceil(t.inSize/i);n||this.variableNames.push("bestIndicesA"),this.outputShape=[r,s],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${i};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${i}; i++) {\n          int inIdx = ${n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));"};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${"max"===e?">":"<"} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}function mt(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function gt(t,e){return 1===e?[t]:mt(t,e)}function yt(){let t,e,n,i,r,o,a,u,l,c;return 2===Object(s.env)().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",i="in",r="texture",o="outputColor",a="out vec4 outputColor;",u="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",i="varying",r="texture2D",o="gl_FragColor",a="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:i,texture2D:r,output:o,defineOutput:a,defineSpecialNaN:u,defineSpecialInf:l,defineRound:c}}function vt(t,e,n="index"){const i=s.util.computeStrides(e);return i.map((e,r)=>`int ${t[r]} = ${n} / ${e}; ${r===i.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${e}`:`index -= ${t[r]} * ${e}`};`).join("")}function bt(t){const e=s.util.computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}const xt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:wt}=s.backend_util;function Tt(t,e,n,i){const r=[];t.forEach(t=>{const e=s.util.sizeFromShape(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?r.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(r.push(`uniform sampler2D ${t.name};`),r.push(`uniform int offset${t.name};`))});const o=r.join("\n"),a=t.map(t=>function(t,e,n=!1){let i="";return i+=n?Et(t):St(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(i+=n?function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),r="get"+i+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length,u=wt(t.shapeInfo.logicalShape,e.logicalShape),l=It(a),c=a-o;let h;const d=["x","y","z","w","u","v"];h=0===o?"":a<2&&u.length>=1?"coords = 0;":u.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let f="";f=a<2&&o>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+d[e+c]).join(", ");let p="return outputValue;";const m=1===s.util.sizeFromShape(t.shapeInfo.logicalShape),g=1===s.util.sizeFromShape(e.logicalShape);if(1!==o||m||g){if(m&&!g)p=1===a?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){const t=o-2,e=o-1;u.indexOf(t)>-1&&u.indexOf(e)>-1?p="return vec4(outputValue.x);":u.indexOf(t)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(e)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${r}() {\n      ${l} coords = getOutputCoords();\n      ${h}\n      vec4 outputValue = get${i}(${f});\n      ${p}\n    }\n  `}(t,e):function(t,e){const n=t.name,i=n.charAt(0).toUpperCase()+n.slice(1),r="get"+i+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===a&&null==t.shapeInfo.flatOffset&&s.util.arraysEqual(t.shapeInfo.texShape,e.texShape))return`\n      float ${r}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const u=It(a),l=wt(t.shapeInfo.logicalShape,e.logicalShape),c=a-o;let h;const d=["x","y","z","w","u","v"];h=0===o?"":a<2&&l.length>=1?"coords = 0;":l.map(t=>`coords.${d[t+c]} = 0;`).join("\n");let f="";return f=a<2&&o>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+d[e+c]).join(", "),`\n    float ${r}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      return get${i}(${f});\n    }\n  `}(t,e)),i}(t,e,i)).join("\n"),u=e.texShape,l=yt(),c=function(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}(l);let h,d,f=function(t){return`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${Ot}\n    ${Ct}\n    ${_t}\n  `}(l);return e.isPacked?(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);\n    }\n  `}(0,e);case 2:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(s.util.arraysEqual(t,e))return`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));\n      }\n    `;const i=Math.ceil(t[1]/2);return`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),r=i*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      int b = index / ${r};\n      index -= b * ${r};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(t,e);default:return function(t,e){const n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),r=i*Math.ceil(t[t.length-2]/2);let s=r,o="",a="b, r, c";for(let u=2;u<t.length-1;u++)s*=t[t.length-u-1],o=`\n      int b${u} = index / ${s};\n      index -= b${u} * ${s};\n    `+o,a=`b${u}, `+a;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      ${o}\n\n      int b = index / ${r};\n      index -= b * ${r};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${t.length}(${a});\n    }\n  `}(t,e)}}(e.logicalShape,u),d=function(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}(l)):(h=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=e)[0]?`\n      int getOutputCoords() {\n        return int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?`\n      int getOutputCoords() {\n        return int(resultUV.y * ${n[0]}.0);\n      }\n    `:`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return resTexRC.x * ${n[1]} + resTexRC.y;\n    }\n  `;case 2:return function(t,e){return s.util.arraysEqual(t,e)?`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `:1===t[1]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===t[0]?`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}(t,e);case 3:return function(t,e){const n=vt(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}(t,e);case 4:return function(t,e){const n=vt(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${n}\n      return ivec4(r, c, d, d2);\n    }\n  `}(t,e);case 5:return function(t,e){const n=vt(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(t,e);case 6:return function(t,e){const n=vt(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n}(e.logicalShape,u),d=function(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}(l)),i&&(f+=At),[f,c,d,o,h,a,n].join("\n")}function St(t){const e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`float ${n}() {return ${e};}`;const[i,r]=t.shapeInfo.texShape;if(1===i&&1===r)return`\n      float ${n}() {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const[s,o]=t.shapeInfo.texShape;return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${s}, ${o}, ${kt(e)});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${n}(int index) {\n        ${Rt(t)}\n      }\n    `;const i=t.shapeInfo.texShape,r=i[0],s=i[1];if(1===s&&1===r)return`\n      float ${n}(int index) {\n        return sampleTexture(${e}, halfCR);\n      }\n    `;const o=kt(e);return 1===s?`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${r}.0);\n        return sampleTexture(${e}, uv);\n      }\n    `:1===r?`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);\n        return sampleTexture(${e}, uv);\n      }\n    `:`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${r}, ${s}, index + ${o});\n      return sampleTexture(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape;if(null!=r&&s.util.arraysEqual(e,r))return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${r[1]}.0, ${r[0]}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `;const{newShape:o,keptDims:a}=s.util.squeezeShape(e);if(o.length<e.length){const e=["row","col"];return`\n      ${St(Mt(t,o))}\n      float ${i}(int row, int col) {\n        return ${i}(${Nt(e,a)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));\n        ${Rt(t)}\n      }\n    `;const u=r[0],l=r[1],c=kt(n);return 1===l?`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `:1===u?`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${c}), vec3(${e[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${e[1]} + col + ${c};\n    vec2 uv = uvFromFlat(${u}, ${l}, index);\n    return sampleTexture(${n}, uv);\n  }\n`}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[1]*e[2],o=e[2],{newShape:a,keptDims:u}=s.util.squeezeShape(e);if(a.length<e.length){const e=["row","col","depth"];return`\n        ${St(Mt(t,a))}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${Nt(e,u)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${r}, ${o}, 1)));\n        ${Rt(t)}\n      }\n    `;const l=t.shapeInfo.texShape,c=l[0],h=l[1],d=t.shapeInfo.flatOffset;return h===r&&null==d?`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${o}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${c}.0);\n          return sampleTexture(${n}, uv);\n        }\n      `:h===o&&null==d?`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${c}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r} + col * ${o} + depth + ${kt(n)};\n        vec2 uv = uvFromFlat(${c}, ${h}, index);\n        return sampleTexture(${n}, uv);\n      }\n  `}(t);case 4:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[3],o=e[2]*r,a=e[1]*o,{newShape:u,keptDims:l}=s.util.squeezeShape(e);if(u.length<e.length){const e=["row","col","depth","depth2"];return`\n      ${St(Mt(t,u))}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${Nt(e,l)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${o}, ${r}, 1)));\n        ${Rt(t)}\n      }\n    `;const c=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];return f===a&&null==c?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${o}, ${r}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:f===r&&null==c?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${e[1]*e[2]}, ${e[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${d}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${o} +\n          depth * ${r} + depth2;\n      vec2 uv = uvFromFlat(${d}, ${f}, index + ${kt(n)});\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],o=e[3]*r,a=e[2]*o,u=e[1]*a,{newShape:l,keptDims:c}=s.util.squeezeShape(e);if(l.length<e.length){const e=["row","col","depth","depth2","depth3"];return`\n      ${St(Mt(t,l))}\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        return ${i}(${Nt(e,c)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${u}, ${a}, ${o}, ${r})) +\n          depth3;\n        ${Rt(t)}\n      }\n    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];return p===u&&null==h?`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${a}, ${o}, ${r}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:p===r&&null==h?`\n      float ${i}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${u} + col * ${a} + depth * ${o} +\n          depth2 * ${r} + depth3 + ${kt(n)};\n      vec2 uv = uvFromFlat(${f}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=s.util.squeezeShape(e);if(r.length<e.length){const e=["row","col","depth","depth2","depth3","depth4"];return`\n      ${St(Mt(t,r))}\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${i}(${Nt(e,o)});\n      }\n    `}const a=e[5],u=e[4]*a,l=e[3]*u,c=e[2]*l,h=e[1]*c;if(t.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${h}, ${c}, ${l}, ${u})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${a}, 1)));\n        ${Rt(t)}\n      }\n    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],m=f[1];return m===h&&null==d?`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${c}, ${l}, ${u}, ${a})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${m}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:m===a&&null==d?`\n      float ${i}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${m}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${h} + col * ${c} + depth * ${l} +\n          depth2 * ${u} + depth3 * ${a} + depth4 + ${kt(n)};\n      vec2 uv = uvFromFlat(${p}, ${m}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function Et(t){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name;return`\n    vec4 ${"get"+e.charAt(0).toUpperCase()+e.slice(1)}() {\n      return ${yt().texture2D}(${e}, halfCR);\n    }\n  `}(t);case 1:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),i=t.shapeInfo.texShape,r=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=yt();return`\n    vec4 ${n}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${r[0]}, ${r[1]}, index);\n      return ${s.texture2D}(${e}, uv);\n    }\n  `}(t);case 2:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,o=r[0],a=r[1],u=yt();if(null!=r&&s.util.arraysEqual(e,r))return`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${o}.0);\n\n        return ${u.texture2D}(${n}, uv);\n      }\n    `;const l=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(e[1]/2)}, ${l[0]}, ${l[1]}, row, col);\n      return ${u.texture2D}(${n}, uv);\n    }\n  `}(t);case 3:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,i="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,s=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(1===e[0]){const n=[1,2],r=["b","row","col"];return`\n        ${Et(Mt(t,e.slice(1)))}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${Nt(r,n)});\n        }\n      `}const o=s[0],a=s[1],u=Math.ceil(e[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${o}, ${a}, ${u*Math.ceil(e[1]/2)}, ${u}, b, row, col);\n      return ${yt().texture2D}(${n}, uv);\n    }\n  `}(t);default:return function(t){const e=t.shapeInfo.logicalShape,n=e.length,i=t.name,r="get"+i.charAt(0).toUpperCase()+i.slice(1),s=t.shapeInfo.texShape,o=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],a=o[0],u=o[1],l=Math.ceil(e[n-1]/2);let c=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",d=`b * ${c} + (row / 2) * ${l} + (col / 2)`;for(let f=2;f<n-1;f++)h=`int b${f}, `+h,c*=e[n-f-1],d=`b${f} * ${c} + `+d;return`\n    vec4 ${r}(${h}) {\n      int index = ${d};\n      int texR = index / ${u};\n      int texC = index - texR * ${u};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${a});\n      return ${yt().texture2D}(${i}, uv);\n    }\n  `}(t)}}const Ot="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ct="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_t="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",At="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function kt(t){return"offset"+t}function Rt(t){const e=t.name,n=s.util.sizeFromShape(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function It(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function Mt(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Nt(t,e){return e.map(e=>t[e]).join(", ")}class Dt{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,s.util.assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const r=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),r>1&&this.outputShape.push(r),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,a=o.length,u=It(a),l=gt("coords",a);let c,h;if(1===r){h=a+1;const t=It(h);c=`\n        ${t} sourceLocR = ${t}(${l.join()}, 0);\n        ++${l[a-1]};\n        ${t} sourceLocG = ${t}(${l.join()}, 0);\n        ++${l[a-2]};\n        ${t} sourceLocA = ${t}(${l.join()}, 0);\n        --${l[a-1]};\n        ${t} sourceLocB = ${t}(${l.join()}, 0);\n        --${l[a-2]};`}else h=a,c=`\n        ${u} sourceLocR = coords;\n        ++${l[a-1]};\n        ${u} sourceLocG = coords;\n        ++${l[a-2]};\n        ${u} sourceLocA = coords;\n        --${l[a-1]};\n        ${u} sourceLocB = coords;\n        --${l[a-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),f="."+d[h-1],p=d.map(t=>"int "+t),m=gt("sourceLocR",h-1).concat("inIdx.r"),g=gt("sourceLocG",h-1).concat("inIdx.g"),y=gt("sourceLocB",h-1).concat("inIdx.b"),v=gt("sourceLocA",h-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",x=i?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,w=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${g.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,T=i?"":`\n      float getBestIndicesAChannel(${p.join()}) {\n        return getChannel(getBestIndicesA(${d.join()}),\n                                          vec2(${d.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${p.join()}) {\n        return getChannel(getA(${d.join()}),\n                               vec2(${d.slice(-2).join()}));\n      }\n      ${T}\n      void main() {\n        ${u} coords = getOutputCoords();\n        bool hasNextCol = ${l[a-1]} < ${o[a-1]-1};\n        bool hasNextRow = ${l[a-2]} < ${o[a-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},\n          sourceLocB${f}, sourceLocA${f}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${w};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${w};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}class Pt{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n            wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n};\n            wC+= ${t.dilationWidth}) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Ft{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,i=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n      const float avgMultiplier = float(${1/(t.filterDepth*t.filterHeight*t.filterWidth)});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n            wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${i};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Lt{constructor(t,e,n,i,r,o){this.outputShape=[],this.variableNames=["x","mean","variance"],s.backend_util.assertAndGetBroadcastShape(t,e),s.backend_util.assertAndGetBroadcastShape(t,n);let a="0.0";null!=i&&(s.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";null!=r&&(s.backend_util.assertAndGetBroadcastShape(t,r),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${u};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class jt{constructor(t,e,n,i,r,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],s.backend_util.assertAndGetBroadcastShape(t,e),s.backend_util.assertAndGetBroadcastShape(t,n);let a="vec4(0.0)";null!=i&&(s.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";null!=r&&(s.backend_util.assertAndGetBroadcastShape(t,r),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${u};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}class Bt{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=s.backend_util.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const zt="return a + b;",$t="return a - b;",Ut="return a * b;",Wt="return (a < 0.) ? b * a : a;";class Vt{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=s.backend_util.assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const Yt="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";class Gt{constructor(t,e,n,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s.backend_util.assertAndGetBroadcastShape(e,n);const r=this.outputShape.length;let o="";if(i)if(0===r||1===s.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${It(r)} coords = getOutputCoords();\n        `,1===r)o+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=gt("coords",r);o+=`\n            bool nextRowOutOfBounds =\n              (${t[r-2]} + 1) >= ${this.outputShape[r-2]};\n            bool nextColOutOfBounds =\n              (${t[r-1]} + 1) >= ${this.outputShape[r-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}class Xt{constructor(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class Ht{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}getCustomSetupFunc(t,e){return(n,i)=>{null==this.minLoc&&(this.minLoc=n.getUniformLocationNoThrow(i,"minVal"),this.maxLoc=n.getUniformLocationNoThrow(i,"maxVal")),n.gl.uniform1f(this.minLoc,t),n.gl.uniform1f(this.maxLoc,e)}}}class qt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}class Kt{constructor(t){this.outputShape=[],this.outputShape=s.backend_util.computeOutShape(t,1),this.variableNames=t.map((t,e)=>"T"+e);const e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++)n.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${e[i-1]}));`);n.push(`else setOutput(getT${e.length}(yR, yC-${e[e.length-1]}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class Jt{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=s.backend_util.computeOutShape(t,e);const n=this.outputShape,i=n.length,r=It(i),o=gt("coords",i),a=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((t,e)=>"T"+e);const u=new Array(t.length-1);u[0]=t[0][e];for(let s=1;s<u.length;s++)u[s]=u[s-1]+t[s][e];const l=a[e],c=a.slice(-2),h=a.join();let d=`if (${l} < ${u[0]}) {\n        return getChannel(\n            getT0(${h}), vec2(${c.join()}));\n        }`;for(let s=1;s<u.length;s++){const t=u[s-1];d+=`\n        if (${l} < ${u[s]}  && ${l} >= ${u[s-1]}) {\n          return getChannel(\n            getT${s}(${Qt(a,l,t)}),\n            vec2(${Qt(c,l,t)}));\n        }`}const f=u[u.length-1];d+=`\n        return getChannel(\n          getT${u.length}(${Qt(a,l,f)}),\n          vec2(${Qt(c,l,f)}));`,this.userCode=`\n      float getValue(${a.map(t=>"int "+t)}) {\n        ${d}\n      }\n\n      void main() {\n        ${r} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[i-1]} = ${o[i-1]} + 1;\n        if (${o[i-1]} < ${n[i-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[i-2]} = ${o[i-2]} + 1;\n        if (${o[i-2]} < ${n[i-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[i-1]} = ${o[i-1]} - 1;\n        if (${o[i-2]} < ${n[i-2]} &&\n            ${o[i-1]} < ${n[i-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function Qt(t,e,n){const i=t.indexOf(e);return t.map((t,e)=>e===i?`${t} - ${n}`:t).join()}class Zt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${"channelsLast"===t.dataFormat}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class te{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i="channelsLast"===t.dataFormat;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${i?3:1}];\n\n        ivec2 dyCorner = ivec2(coords[${i?1:2}], coords[${i?2:3}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${i}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class ee{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${t.strideDepth} - ${t.padInfo.front};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class ne{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,i=t.filterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${t.strideDepth}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${i}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${i} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class ie{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${t.outChannels/t.inChannels} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${t.strideHeight} - ${t.padInfo.top};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${t.strideWidth} - ${t.padInfo.left};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class re{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,i=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${i}; dm++) {\n              int d2 = d1 * ${i} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class se{constructor(t,e=!1,n=null,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const r=t.padInfo.top,s=t.padInfo.left,o=t.strideHeight,a=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,d=4*Math.floor(t.inChannels/4),f=t.inChannels%4,p="channelsLast"===t.dataFormat,m=p?1:2,g=p?2:3,y=p?3:1;let v="",b="";n&&(v=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,b="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${o}, ${a});\n      const ivec2 pads = ivec2(${r}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${m}], coords[${g}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${c}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${l};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${d}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${p}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${p}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${d}) *\n                    getW(wR, wC, ${d}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${d}, xR, xC) *\n                    getW(wR, wC, ${d}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2)\n              );\n\n              if (${p}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${d}, d2),\n                getW(wR, wC, ${d} + 1, d2),\n                getW(wR, wC, ${d} + 2, d2)\n              );\n\n              if (${p}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${d}),\n                  getX(batch, xR, xC, ${d} + 1),\n                  getX(batch, xR, xC, ${d} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${d}, xR, xC),\n                  getX(batch, ${d} + 1, xR, xC),\n                  getX(batch, ${d} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${x}\n        ${b}\n        setOutput(result);\n      }\n    `}}class oe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,i=t.padInfo.left,r=t.strideDepth,s=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${r}, ${s}, ${o});\n      const ivec3 pads = ivec3(${e}, ${n}, ${i});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${a};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${h}; wR++) {\n            int xR = xRCorner + wR * ${u};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d}; wC++) {\n              int xC = xCCorner + wC * ${l};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${f}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===p}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${f}) *\n                  getW(wF, wR, wC, ${f}, d2);\n              } else if (${2===p}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${f}),\n                  getX(batch, xF, xR, xC, ${f} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${f}, d2),\n                  getW(wF, wR, wC, ${f} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===p}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${f}),\n                  getX(batch, xF, xR, xC, ${f} + 1),\n                  getX(batch, xF, xR, xC, ${f} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${f}, d2),\n                  getW(wF, wR, wC, ${f} + 1, d2),\n                  getW(wF, wR, wC, ${f} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class ae{constructor(t,e=!1,n=null,i=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const r=t.inHeight,s=t.inWidth,o=t.padInfo.top,a=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,p=t.outChannels/t.inChannels;let m="",g="";n&&(m=i?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,g="result = activation(result);");const y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${m}\n\n      const ivec2 strides = ivec2(${u}, ${l});\n      const ivec2 pads = ivec2(${o}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${p};\n        int q = d2 - d1 * ${p};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${c};\n\n          if (xR < 0 || xR >= ${r}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${f}; wC++) {\n            int xC = xCCorner + wC * ${h};\n\n            if (xC < 0 || xC >= ${s}) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${y}\n        ${g}\n        setOutput(result);\n      }\n    `}}class ue{constructor(t,e=!1,n=null,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;const r=t.inHeight,o=t.inWidth,a=t.padInfo.top,u=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,m=p;let g="int xR; int xC; int xCOffset;";for(let s=0;s<f;s++)for(let t=0;t<p;t++)g+=`\n          vec4 xTexelR${s}C${2*t} = vec4(0.);\n          vec4 wR${s}C${t} = vec4(0.);\n          vec4 xR${s}C${t} = vec4(0.);`;for(let x=0;x<f;x++)for(let t=0;t<m;t++){const e=2*t;if(g+=`\n          xR = xRCorner + ${x*h};\n          xC = xCCorner + ${e*d};\n        `,1===c){if(e<p&&(g+=u%2==1?`\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ${r} && xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${x}C${e} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    xTexelR${x}C${e}.zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR${x}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ${r} && xCOffset >= 0 && xCOffset < ${o}) {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ${o}) {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR${x}C${e} = vec4(previous.zw, xTexelR${x}C${e}.xy);\n                } else {\n                  xR${x}C${e} = vec4(0, 0, xTexelR${x}C${e}.xy);\n                }\n              `:`\n                if(xR >= 0 && xR < ${r} && xC >= 0 && xC < ${o}) {\n                  xTexelR${x}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${x}C${e} = vec4(0.);\n                }\n\n                xR${x}C${e} = xTexelR${x}C${e};\n              `,e+1<p)){const t=u%2==0?s.util.nearestLargerEven(d):d;d%2==0&&u%2==1||d%2!=0&&u%2!=1?(g+=`\n                  xCOffset = xC + ${u%2} + ${t};\n\n                  if(xR >= 0 && xR < ${r} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${x}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n                `,d>1&&(g+=`\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ${r} &&\n                      xCOffset >= 0 && xCOffset < ${o}) {\n                      xTexelR${x}C${e} = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR${x}C${e} = vec4(0.);\n                    }\n                  `),g+=`\n                  xR${x}C${e+1} = vec4(\n                    xTexelR${x}C${e}.zw, xTexelR${x}C${e+2}.xy);\n                `):g+=`\n                  xCOffset = xC + ${t};\n\n                  if(xR >= 0 && xR < ${r} &&\n                    xCOffset >= 0 && xCOffset < ${o}) {\n                    xTexelR${x}C${e+2} = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR${x}C${e+1} = xTexelR${x}C${e+2};\n                `}}else e<p&&(g+=`\n              if(xR >= 0 && xR < ${r}) {\n            `,u%2==1?(g+=`\n                xCOffset = xC + 1 - ${c};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${x}C${e} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${x}C${e} = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ${o}) {\n                  xTexelR${x}C${e+2} = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR${x}C${e+2} = vec4(0.);\n                }\n\n                xR${x}C${e} = vec4(\n                  xTexelR${x}C${e}.zw, xTexelR${x}C${e+2}.zw);\n              `,e+1<p&&(g+=`\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ${c};\n                  if(xCOffset >= 0 && xCOffset < ${o}) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR${x}C${e+1} = vec4(xTexelR${x}C${e+2}.xy, final.xy);\n                `)):(g+=`\n                if(xC >= 0 && xC < ${o}) {\n                  xTexelR${x}C${e} = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR${x}C${e} = vec4(0.);\n                }\n\n                xCOffset = xC + ${c};\n                if(xCOffset >= 0 && xCOffset < ${o}) {\n                  xTexelR${x}C${e+2} = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR${x}C${e+2} = vec4(0.);\n                }\n\n                xR${x}C${e} = vec4(\n                  xTexelR${x}C${e}.xy, xTexelR${x}C${e+2}.xy);\n              `,e+1<p&&(g+=`\n                  xR${x}C${e+1} = vec4(\n                    xTexelR${x}C${e}.zw, xTexelR${x}C${e+2}.zw);\n                `)),g+="}");e<p&&(g+=`\n            vec4 wTexelR${x}C${e} = getW(${x}, ${e}, d1, q);\n            wR${x}C${e} = vec4(wTexelR${x}C${e}.xz, wTexelR${x}C${e}.xz);\n          `,e+1<p&&(g+=`\n              vec4 wTexelR${x}C${e+1} = getW(${x}, ${e+1}, d1, q);\n              wR${x}C${e+1} =\n                vec4(wTexelR${x}C${e+1}.xz, wTexelR${x}C${e+1}.xz);`))}for(let s=0;s<f;s++)for(let t=0;t<p;t++)g+=`dotProd += xR${s}C${t} * wR${s}C${t};`;let y="",v="";n&&(y=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,v="result = activation(result);");const b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${y}\n\n      const ivec2 strides = ivec2(${l}, ${c});\n      const ivec2 pads = ivec2(${a}, ${u});\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ${g}\n\n        vec4 result = dotProd;\n        ${b}\n        ${v}\n        setOutput(result);\n      }\n    `}}class le{constructor(t,e,n,i,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,a,u]=t,[l]=e,[c,h]=n;this.outputShape=[l,c,h,u];const d="bilinear"===i?1:0,[f,p]=[o-1+".0",a-1+".0"],[m,g,y]=c>1?[""+(o-1)/(c-1),"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0","0.5 * (y1+y2) * "+f],[v,b,x]=h>1?[""+(a-1)/(h-1),"(x2-x1) * width_ratio",`x1*${p} + float(x)*(width_scale)`]:["0.0","0.0","0.5 * (x1+x2) * "+p];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${v});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${s}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${b};\n\n        float in_y = ${y};\n        if( in_y < 0.0 || in_y > ${f} ) {\n          setOutput(float(${r}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${p} ) {\n          setOutput(float(${r}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${d} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}class ce{constructor(t,e,n){this.variableNames=["x"],this.outputShape=t;const i=t.length,r=t[t.length-1],s=n?"<":">";this.userCode=`\n      int getIndex(int i) {\n        ${n?`return ${r} -i - 1;`:"return i;"}\n      }\n\n      void main() {\n        ${It(i)} coords = getOutputCoords();\n        int end = ${he(i,"coords")};\n        float val = 0.0;\n        for (int i = ${r} - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx ${s} end) {\n            continue;\n          }\n          if (idx == end && ${e}) {\n            continue;\n          }\n          ${he(i,"coords")} = idx;\n          val += getX(${function(t,e){if(1===t)return"coords";if(2===t)return"coords.x, coords.y";if(3===t)return"coords.x, coords.y, coords.z";if(4===t)return"coords.x, coords.y, coords.z, coords.w";throw Error(`Cumulative sum for rank ${t} is not yet supported`)}(i)});\n        }\n        setOutput(val);\n      }\n    `}}function he(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error(`Cumulative sum for rank ${t} is not yet supported`)}class de{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=c.DENSE;const e=p(t),n=yt();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${vt(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${n.output} = result;\n      }\n    `}}class fe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=c.DENSE;const e=p(t),n=yt();this.outputShape=t,this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${vt(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(${e[0]}, ${e[1]}));\n        int index = 4 * (resTexRC.x * ${e[1]} + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${n.output} = result;\n      }\n    `}}class pe{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}class me{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}class ge{constructor(t){this.variableNames=["A"],this.outTexUsage=h.DOWNLOAD;const e=yt();this.outputShape=t,this.userCode=`\n      ${xt}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}class ye{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=h.DOWNLOAD;const e=yt();this.outputShape=t,this.userCode=`\n      ${xt}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}class ve{constructor(t,e,n=!1){this.variableNames=["A"];const i=yt(),[r,s]=e;this.outputShape=t;let o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode=`\n      ${bt(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / ${s};\n        int c = imod(flatIndex, ${s});\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${r}.0);\n        vec4 values = ${i.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${i.output} = vec4(${o}, 0., 0., 0.);\n      }\n    `}}class be{constructor(t,e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const i=yt(),[r,s]=e;this.outputShape=t;let o="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let u=0;u<=1;u++)for(let e=0;e<=1;e++){const n=2*u+e;o+=`\n          localCoords = coords;\n          if(localCoords[2] + ${e} < ${t[2]}) {\n            localCoords[2] += ${e};\n            if(localCoords[1] + ${u} < ${t[1]}) {\n              localCoords[1] += ${u};\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ${s};\n              c = imod(flatIndex, ${s});\n              uv = (vec2(c, r) + halfCR) / vec2(${s}.0, ${r}.0);\n              values = ${i.texture2D}(A, uv);\n\n              if(offset == 0) {\n                result[${n}] = values[0];\n              } else if(offset == 1) {\n                result[${n}] = values[1];\n              } else if(offset == 2) {\n                result[${n}] = values[2];\n              } else {\n                result[${n}] = values[3];\n              }\n            }\n          }\n        `}this.userCode=`\n      ${bt(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ${o}\n\n        ${i.output} = ${a};\n      }\n    `}}class xe{constructor(t,e,n){this.variableNames=["real","imag"];const i=e[1];this.outputShape=e;const r=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode=`\n      const float exponentMultiplier = ${r};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${t}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${i});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${i}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${n?i+".0":"1.0"};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}class we{constructor(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}getCustomSetupFunc(t){return(e,n)=>{null==this.valueLoc&&(this.valueLoc=e.getUniformLocationNoThrow(n,"value")),e.gl.uniform1f(this.valueLoc,t)}}}class Te{constructor(t,e,n){this.variableNames=["A","indices"];const i=t.slice();i[n]=e,this.outputShape=i,this.rank=i.length;const r=It(this.rank),s=function(t,e){const n=t.length;if(n>4)throw Error(`Gather for rank ${n} is not yet supported`);if(1===n)return"int(getIndices(resRC))";const i=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)r.push(s===e?`int(getIndices(${i[s]}))`:""+i[s]);return r.join()}(t,n);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${s}));\n      }\n    `}}class Se{constructor(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;const i=It(e.length),r=It(n.length);this.userCode=`\n        ${i} strides = ${i}(${this.strides});\n         void main() {\n          ${r} coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ${this.sliceDim}; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ${this.sliceDim>1?"strides[j]":"strides"};\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      `}}function Ee(t,e){const n=yt();return w(t,e,`${n.version}\n    precision highp float;\n    ${n.attribute} vec3 clipSpacePos;\n    ${n.attribute} vec2 uv;\n    ${n.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}function Oe(t,e){return _(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Ce(t,e){return A(t,e,new Uint16Array([0,1,2,2,1,3]))}function _e(t,e,n,i,r,s,o){I(n,i);const a=R(t,e),u=t.TEXTURE_2D;return y(t,e,()=>t.bindTexture(u,a)),y(t,e,()=>t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),y(t,e,()=>t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),y(t,e,()=>t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)),y(t,e,()=>t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)),y(t,e,()=>t.texImage2D(u,0,r,n,i,0,s,o,null)),y(t,e,()=>t.bindTexture(t.TEXTURE_2D,null)),a}function Ae(t,e,n,i,r){const[s,o]=f(n,i);return _e(t,e,s,o,r.internalFormatFloat,r.textureFormatFloat,t.FLOAT)}function ke(t,e,n,i,r){const[s,o]=f(n,i);return _e(t,e,s,o,r.internalFormatHalfFloat,r.textureFormatFloat,r.textureTypeHalfFloat)}function Re(t,e,n,i,r){const[s,o]=f(n,i);return _e(t,e,s,o,t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function Ie(t,e,n,i,r){const[s,o]=m(n,i);return _e(t,e,s,o,r.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function Me(t,e,n,i,r){const[s,o]=m(n,i);return _e(t,e,s,o,r.internalFormatPackedHalfFloat,t.RGBA,r.textureTypeHalfFloat)}function Ne(t,e,n,i){return y(t,e,()=>t.bindBuffer(t.ARRAY_BUFFER,i)),N(t,e,n,"clipSpacePos",i,3,20,0)&&N(t,e,n,"uv",i,2,20,12)}function De(t,e,n,i,r,s,o){let a,u,l;y(t,e,()=>t.bindTexture(t.TEXTURE_2D,n)),s instanceof Uint8Array?(a=new Uint8Array(i*r*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(i*r*4),u=t.FLOAT,l=o.internalFormatPackedFloat),a.set(s),y(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,l,i,r,0,t.RGBA,u,a)),y(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}function Pe(t,e,n,i){y(t,e,()=>t.bindTexture(t.TEXTURE_2D,n)),i.data instanceof Uint8Array?y(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,i.width,i.height,0,t.RGBA,t.UNSIGNED_BYTE,i.data)):y(t,e,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)),y(t,e,()=>t.bindTexture(t.TEXTURE_2D,null))}function Fe(t,e,n,i,r){const s=t.createBuffer();y(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const o=16*n*i;return y(t,e,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),y(t,e,()=>t.readPixels(0,0,i,n,t.RGBA,t.FLOAT,0)),y(t,e,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function Le(t,e,n){const i=t,r=new Float32Array(n);return i.bindBuffer(i.PIXEL_PACK_BUFFER,e),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,r),i.bindBuffer(i.PIXEL_PACK_BUFFER,null),r}function je(t,e,n,i,r){const[s,o]=f(n,i),a=new Uint8Array(n*i*4);return y(t,e,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Be(t,e,n,i,r,s,o,a){const u=t,l=new Float32Array(function(t,e){const[n,i]=m(t,e);return n*i*4}(s,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function ze(t,e,n,i){const r=new Float32Array(n*i*4);return y(t,e,()=>t.readPixels(0,0,i,n,t.RGBA,t.FLOAT,r)),r}class $e{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Object(s.env)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,u(e,t)):this.gl=l(e);let n="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(1===Object(s.env)().getNumber("WEBGL_VERSION")){const t="OES_texture_half_float";if(this.textureFloatExtension=x(this.gl,this.debug,"OES_texture_float"),st(this.gl,t))this.textureHalfFloatExtension=x(this.gl,this.debug,t);else if(Object(s.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),st(this.gl,i))this.colorBufferHalfFloatExtension=x(this.gl,this.debug,i);else if(Object(s.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",st(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!st(this.gl,i))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(i)}this.vertexBuffer=Oe(this.gl,this.debug),this.indexBuffer=Ce(this.gl,this.debug),this.framebuffer=M(this.gl,this.debug),this.textureConfig=g(this.gl,this.textureHalfFloatExtension)}get debug(){return Object(s.env)().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;y(t,this.debug,()=>t.finish()),y(t,this.debug,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),y(t,this.debug,()=>t.deleteFramebuffer(this.framebuffer)),y(t,this.debug,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),y(t,this.debug,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),y(t,this.debug,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),Ae(this.gl,this.debug,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),ke(this.gl,this.debug,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),Re(this.gl,this.debug,t,e)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),Pe(this.gl,this.debug,t,e)}uploadDenseMatrixToTexture(t,e,n,i){this.throwIfDisposed(),De(this.gl,this.debug,t,e,n,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),Me(this.gl,this.debug,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),Ie(this.gl,this.debug,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&($(this.gl,this.debug,this.framebuffer),this.outputTexture=null),y(this.gl,this.debug,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>je(this.gl,this.debug,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,i,r,s){return Be(this.gl,t,0,0,0,r,s)}downloadFloat32MatrixFromBuffer(t,e){return Le(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const i=Fe(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Object(s.env)().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,r=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=i.clientWaitSync(r,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=r}else Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>ze(this.gl,this.debug,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl,n=T(e,this.debug,t),i=Ee(e,this.debug),r=E(e,this.debug);return y(e,this.debug,()=>e.attachShader(r,i)),y(e,this.debug,()=>e.attachShader(r,n)),O(e,this.debug,r),this.debug&&C(e,this.debug,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=Ne(e,this.debug,this.program,this.vertexBuffer)),r}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&y(this.gl,this.debug,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&C(this.gl,this.debug,this.program),y(this.gl,this.debug,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?F(this.gl,this.debug,t,e):L(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),y(this.gl,this.debug,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),j(this.gl,this.debug,0,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[i,r]=m(e,n);this.setOutputMatrixTextureDriver(t,i,r)}setOutputMatrixWriteRegion(t,e,n,i){this.setOutputMatrixWriteRegionDriver(n,t,i,e)}setOutputPackedMatrixWriteRegion(t,e,n,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&C(this.gl,this.debug,this.program),U(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),y(t,this.debug,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),y(this.gl,this.debug,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=x(this.gl,this.debug,2===Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await s.util.repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),i=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),i&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||s.util.repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length))}bindTextureToFrameBuffer(t){this.throwIfDisposed(),z(this.gl,this.debug,t,this.framebuffer),this.debug&&U(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(z(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&U(this.gl)):$(this.gl,this.debug,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const i=this.gl;z(i,this.debug,t,this.framebuffer),this.debug&&U(i),this.outputTexture=t,y(i,this.debug,()=>i.viewport(0,0,e,n)),y(i,this.debug,()=>i.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,i){this.throwIfDisposed(),y(this.gl,this.debug,()=>this.gl.scissor(t,e,n,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function Ue(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((t,n)=>{const i=t.logicalShape,r=e[n],o=r.shape;if(!s.util.arraysEqual(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(t.isUniform&&r.isUniform)return;const a=t.texShape,u=r.isUniform?null:r.texData.texShape;if(!s.util.arraysEqual(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}class We{constructor(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;const{filterWidth:i,inChannels:r,strideWidth:s,strideHeight:o,padInfo:a,outWidth:u,dilationWidth:l,dilationHeight:c,dataFormat:h}=n,{left:d,top:f}=a,p=r*i,m=yt(),g="channelsLast"===h,y=g?0:1,v=g?1:2;let b="";for(let x=0;x<=1;x++)for(let n=0;n<=1;n++)b+=`\n          blockIndex = rc.y + ${n};\n          pos = rc.x + ${x};\n\n          if(blockIndex < ${t[1]} && pos < ${t[0]}) {\n            offsetY = int(blockIndex / (${u})) * ${o} - ${f};\n            d0 = offsetY + ${c} * (pos / ${p});\n\n            if(d0 < ${e[y]} && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ${u}.) * ${s}. - ${d}.);\n              d1 = offsetX + ${l} * (int(mod(float(pos), ${p}.) / ${r}.));\n\n              if(d1 < ${e[v]} && d1 >= 0) {\n\n                ch = int(mod(float(pos), ${r}.));\n\n                if (${g}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*x+n}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*x+n}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${b}\n\n        ${m.output} = result;\n      }\n    `}}class Ve{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[];const s=e,o=t[3]-1;let a;this.outputShape=t;const u=`float(${n}) + float(${i}) * sum`;a=.5===r?`inversesqrt(${u})`:1===r?`1.0/(${u})`:`exp(log(${u}) * float(-${r}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${s}; j <= ${s}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${o}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${a};\n        setOutput(val);\n      }\n    `}}class Ye{constructor(t,e,n,i,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=i,this.beta=r,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${i}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${i})\n                * float(${r})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${r});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}class Ge{constructor(t,e,n,i,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=e,o=t[3]-1;let a;this.outputShape=t;const u=`float(${n}) + float(${i}) * sum`;a=.5===r?`inversesqrt(${u})`:1===r?`1.0/(${u})`:`exp(log(${u}) * float(-${r}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${s};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${s}; j <= ${s}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${a};\n        setOutput(result);\n      }\n    `}}class Xe{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode=`\n      const ivec2 pads = ivec2(${e-1-t.padInfo.top}, ${n-1-t.padInfo.left});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e};\n          wR += ${t.dilationHeight}) {\n          float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${e*n-1} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${n} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class He{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,i=t.effectiveFilterWidth;this.userCode=`\n      const ivec3 pads = ivec3(${e-1-t.padInfo.front}, ${n-1-t.padInfo.top}, ${i-1-t.padInfo.left});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${e};\n           wD += ${t.dilationDepth}) {\n          float dyD = float(dyDCorner + wD) / ${t.strideDepth}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${n};\n              wR += ${t.dilationHeight}) {\n            float dyR = float(dyRCorner + wR) / ${t.strideHeight}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${i};\n                wC += ${t.dilationWidth}) {\n              float dyC = float(dyCCorner + wC) / ${t.strideWidth}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${e*n*i-1} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${n} * ${i} +\n                  wR * ${i} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class qe{constructor(t,e,n=!1,i=!1,r=!1,s=null,o=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;const a=Math.ceil((n?t[1]:t[2])/2),u=n?"i * 2, rc.y":"rc.y, i * 2",l=i?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let d="",f="";s&&(d=o?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${s}\n        }`:`vec4 activation(vec4 x) {\n          ${s}\n        }`,f="result = activation(result);");const p=r?"result += getBiasAtOutCoords();":"";r&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode=`\n      ${d}\n\n      const float sharedDimension = ${a}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${a}; i++) {\n          vec4 a = getMatrixA(rc.x, ${u});\n          vec4 b = getMatrixB(rc.x, ${l});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${c[0]} * ${h[0]});\n          result += (${c[1]} * ${h[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${p}\n\n        ${f}\n\n        setOutput(result);\n      }\n    `}}class Ke{constructor(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode=`\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}getCustomSetupFunc(t){return(e,n)=>{null==this.seedLoc&&(this.seedLoc=e.getUniformLocation(n,"seed")),e.gl.uniform1f(this.seedLoc,t)}}}class Je{constructor(t,e,n,i){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${i}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}class Qe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;const e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const n=gt("rc",e),i=It(e),r=function(t,e,n){if(1===t)return"rc > "+e[0];let i="";for(let r=t-2;r<t;r++)i+=`${n[r]} >= ${e[r]}`,r<t-1&&(i+="||");return i}(e,t,n),s=function(t,e,n,i){if(1===t)return"";const r=i.slice(-2);return`\n    int r = ${r[0]};\n    int c = ${r[1]};\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ${e};\n    bool rEdge = rp1 >= ${n};\n  `}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){const n=t.length,i=function(t,e){const n=[];for(let i=0;i<=1;i++)for(let r=0;r<=1;r++){let s=`${0===i?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let n=2;n<t;n++)s=e[e.length-1-n]+","+s;n.push(s)}return n}(n,e);return 1===n?`getA(rc),\n            rc + 1 >= ${t[0]} ? 0. : getA(rc + 1),\n            0, 0`:`getA(${i[0]}),\n          cEdge ? 0. : getA(${i[1]}),\n          rEdge ? 0. : getA(${i[2]}),\n          rEdge || cEdge ? 0. : getA(${i[3]})`}(t,n);this.userCode=`\n        void main() {\n          ${i} rc = getOutputCoords();\n\n          if(${r}) {\n            setOutput(vec4(0));\n          } else {\n            ${s}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}}class Ze{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const i=t.length,r=It(i),s=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);this.userCode=1!==i?`\n      ${r} start = ${r}(${s});\n      ${r} end = ${r}(${o});\n\n      void main() {\n        ${r} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(${n}));\n        } else {\n          ${r} coords = outC - start;\n          setOutput(getX(${a}));\n        }\n      }\n    `:`\n        int start = ${s};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(${n}));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class tn{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const i=t.length,r=It(i),s=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),a=gt("rc",i),u=gt("source",i),l=`${a[i-1]} < ${this.outputShape[i-1]}`,c=1===i?"source":`vec2(${u.slice(-2).join()})`,h=[r+" rc = outputLoc;",`${a[i-1]} += 1;\n       if(${l}) {\n      `,1===i?"":`}\n       rc = outputLoc;\n       ${a[i-2]} += 1;\n       if(${a[i-2]} < ${this.outputShape[i-2]}) {`,1===i?"":`  ${a[i-1]} += 1;\n         if(${l}) {`],d=1===i?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let p=0,m=1===i?2:4;p<m;p++)f+=`\n        ${h[p]}\n        if (${d}) {\n          result[${p}] = float(${n});\n        } else {\n          ${r} source = rc - start;\n          result[${p}] = getChannel(getX(${u.join()}), ${c});\n        }\n      `;f+=1===i?"} ":"}}",this.userCode=`\n      const ${r} start = ${r}(${s});\n      const ${r} end = ${r}(${o});\n\n      void main() {\n        ${r} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${f}\n        setOutput(result);\n      }\n    `}}class en{constructor(t,e,n,i=!1,r=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideHeight,a=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;const p="avg"===e;let m="0.0";if(p||(m="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec2 strides = ivec2(${o}, ${a});\n        const ivec2 pads = ivec2(${d}, ${f});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${u}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h};\n                wC += ${l}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${i?r?`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`:`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`:`wR * ${h} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let g=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(g="avgValue / count");const y=4*Math.floor(s/4),v=s%4,b=`\n      if (${p}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${a});\n      const ivec2 pads = ivec2(${d}, ${f});\n      const float initializationValue = ${m};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${m});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${u}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${y}; wC += 4) {\n            int xC = xCCorner + wC * ${l};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              getValue(batch, xR, xC + 2 * ${l}, d),\n              getValue(batch, xR, xC + 3 * ${l}, d)\n            );\n\n            ${b}\n          }\n\n          int xC = xCCorner + ${y};\n          if (${1===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${b}\n          } else if (${2===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${b}\n          } else if (${3===v}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${l}, d),\n              getValue(batch, xR, xC + 2 * ${l}, d),\n              initializationValue\n            );\n\n            ${b}\n          }\n        }\n        setOutput(${g});\n      }\n    `}}class nn{constructor(t,e,n,i=!1,r=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const s=t.filterWidth,o=t.strideDepth,a=t.strideHeight,u=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let b="0.0";if(v||(b="-1.0 / 1e-20"),n)return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${o}, ${a}, ${u});\n        const ivec3 pads = ivec3(${m}, ${g}, ${y});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${d};\n              wD += ${l}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${f};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${p};\n                  wC += ${h}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${i?r?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${f} * ${p} +\n                      wR * ${p} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `);let x=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(x="avgValue / count");const w=4*Math.floor(s/4),T=s%4,S=`\n      if (${v}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${o}, ${a}, ${u});\n      const ivec3 pads = ivec3(${m}, ${g}, ${y});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${d};\n            wD += ${l}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${f};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${h};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${h}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===T}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${h}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${h}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n          setOutput(${x});\n        }\n      }\n    `}}class rn{constructor(t,e){this.variableNames=["x"];const n=t.windowSize,i=t.batchSize,r=t.inSize,s=Math.ceil(r/n);this.outputShape=[i,s];let o="0.0",a="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",a="min"):"max"===e&&(o="-1.0 / 1e-20",a="max");let u=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");const l=4*Math.floor(n/4),c=n%4;let h=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${a}(values, minMaxValue);\n      }\n    `,d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let f="";r%n>0&&(f=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${o};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${f}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${o});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${l}; i += 4) {\n          int inIdx = inOffset + i;\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${h}\n        }\n\n        int inIdx = inOffset + ${l};\n        if (${1===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${2===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${h}\n        } else if (${3===c}) {\n          ${d} values = ${d}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${h}\n        }\n        setOutput(${u});\n      }\n    `}}class sn{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2==1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${r}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${r>0?"}":""}\n      `}var i;this.userCode=`\n      ${i=e,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${vt(["r","c","d"],i)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${bt(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${t[1]};\n        int cols = ${t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class on{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,r]=e.shape,[,s,o]=t.shape,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],u=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/u[0],c=a[1]/u[1],h=1/l,d=1/c,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${l});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${f});\n        const int winWidth = int(${p});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}class an{constructor(t,e,n,i){this.variableNames=["A"],this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const u=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n];this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/l[0]},\n          ${u[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class un{constructor(t,e,n,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const u=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n];this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/l[0]},\n          ${u[1]/l[1]},\n          ${u[1]/l[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${o}.0,\n                                     ${o}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${a-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}class ln{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;const[,i,r]=e.shape,[,s,o]=t.shape,a=[n&&s>1?i-1:i,n&&o>1?r-1:r],u=[n&&s>1?s-1:s,n&&o>1?o-1:o],l=a[0]/u[0],c=a[1]/u[1],h=1/l,d=1/c,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${l});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${h});\n        const float invWidthScale = float(${d});\n\n        const int winHeight = int(${f});\n        const int winWidth = int(${p});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${a[0]}) *\n                (float(dyR) / float(${u[0]}));\n\n            float sourceFracCol =\n                float(${a[1]}) *\n                  (float(dyC) / float(${u[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${i}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}class cn{constructor(t,e,n,i){this.variableNames=["A"],this.outputShape=[];const[r,s,o,a]=t;this.outputShape=[r,e,n,a];const u=[i&&e>1?s-1:s,i&&n>1?o-1:o],l=[i&&e>1?e-1:e,i&&n>1?n-1:n];this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/l[0]},\n          ${u[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${o}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${i?"0.5":"0.0"})));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class hn{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const i=t.map((n,i)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`)(i)).join(","),r=It(n);this.userCode=`\n      void main() {\n        ${r} coords = getOutputCoords();\n        setOutput(getX(${i}));\n      }\n    `}}class dn{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const i=gt("rc",n),r=`${i[n-1]} + 1 < ${this.outputShape[n-1]}`,s=`${i[n-2]} + 1 < ${this.outputShape[n-2]}`,o=It(n);function a(n){const i=t.map((i,r)=>function(n,i){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${i[n]} - 1`:""+i[n]}(r,n));return`getChannel(getX(${i.join(",")}), vec2(${i.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${r}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${o} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(t){return a(t)}(i.slice())};\n          if(${r}){\n            result.g = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",a(t)}(i.slice())};\n          }\n          if(${s}) {\n            result.b = ${function(t){return t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice())};\n            if(${r}) {\n              result.a = ${function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",a(t)}(i.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}class fn{constructor(t,e,n,i,r,s,o=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const a=It(r.length),u=It(s.length);let l="";1===n?l="i":2===n&&(l="i, j");let c="";1===i?c="i":2===i&&(c="i, coords[1]"),this.userCode=`\n        ${a} strides = ${a}(${r});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(getIndices(${l}));\n              flattenedIndex += index * ${e>1?"strides[j]":"strides"};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates(${c});\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}class pn{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,i=t.batchSize,r=t.inSize,s=t.numSegments,o=s*Math.ceil(r/n);this.outputShape=[i,o];const a=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let c="";r%n>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return initializationValue;\n        }\n      `);let h="";r%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${r}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${h}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${s})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${s})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${l}\n        } else if (${2===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${l}\n        } else if (${3===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}class mn{constructor(t,e,n){let i,r;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)r="resRC",i="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],o=[];for(let i=0;i<e.length;i++)o.push(""+n[i]),i<t&&s.push(""+n[i]);i=s.join(),r=o.join()}const s=It(n);this.userCode=`\n      void main() {\n        ${s} resRC = getOutputCoords();\n        float cVal = getC(${i});\n        if (cVal >= 1.0) {\n          setOutput(getA(${r}));\n        } else {\n          setOutput(getB(${r}));\n        }\n      }\n    `}}class gn{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=It(this.rank),n=`uniform int start[${this.rank}];`,i=function(t){if(1===t)return"sourceLoc";if(t<=6)return yn.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}(this.rank);let r;r=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${t.map((t,e)=>`sourceLoc.${yn[e]} = start[${e}] + coords.${yn[e]};`).join("\n")}\n      `,this.userCode=`\n      ${n}\n      void main() {\n        ${r}\n        setOutput(getSource(${i}));\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}const yn=["x","y","z","w","u","v"];class vn{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;const e=It(this.rank),n=gt("coords",this.rank),i=gt("sourceLoc",this.rank),r=1===this.rank?"sourceLoc":`vec2(${i.slice(-2).join()})`,s=`getChannel(getSource(${i.join()}), ${r})`,o=`\n      result.x = ${s};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${i[this.rank-1]};\n        result.y = ${s};\n        --${i[this.rank-1]};\n      }\n    `,a=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${i[this.rank-2]};\n        result.z = ${s};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${i[this.rank-1]};\n          result.w = ${s};\n        }\n      }\n    `,u=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${i[e]} = ${n[e]} + start[${e}];`).join("\n");this.userCode=`\n      uniform int start[${this.rank}];\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${u}\n        vec4 result = vec4(0.);\n        ${o}\n        ${a}\n        setOutput(result);\n      }\n    `}getCustomSetupFunc(t){if(t.length!==this.rank)throw Error(`The rank (${this.rank}) of the program must match the length of start (${t.length})`);return(e,n)=>{null==this.startLoc&&(this.startLoc=e.getUniformLocationNoThrow(n,"start"),null==this.startLoc)||e.gl.uniform1iv(this.startLoc,t)}}}class bn{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const i=n.length,r=It(n.length),s=It(n.length);let o="";if(1===i)o="coords * strides + begin";else{let t=0;o=n.map((e,i)=>(t++,1===n.length?`coords * strides[${i}] + begin[${i}]`:`coords[${t-1}] * strides[${i}] + begin[${i}]`)).join(",")}this.userCode=`\n      ${r} begin = ${r}(${t});\n      ${r} strides = ${r}(${e});\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${o}));\n      }\n    `}}class xn{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const i=wn(e,n),r=Tn(t,i,n);if(r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]),this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();const t=this.freeTextures[r].shift();return this.usedTextures[r].push(t),t}let s;return this.numUsedTextures++,this.log(),i===d.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===d.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===d.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===d.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===d.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[r].push(s),s}releaseTexture(t,e,n,i){if(null==this.freeTextures)return;const r=Tn(e,wn(n,i),i);r in this.freeTextures||(this.freeTextures[r]=[]),this.freeTextures[r].push(t),this.numFreeTextures++,this.numUsedTextures--;const s=this.usedTextures[r],o=s.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(o,1),this.log()}log(){this.logEnabled&&console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${this.numFreeTextures+this.numUsedTextures})`)}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}}}function wn(t,e){if(t===h.UPLOAD)return d.PACKED_2X2_FLOAT32;if(t===h.RENDER||null==t)return function(t){return Object(s.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?d.PACKED_2X2_FLOAT32:d.UNPACKED_FLOAT32:t?d.PACKED_2X2_FLOAT16:d.UNPACKED_FLOAT16}(e);if(t===h.DOWNLOAD||t===h.PIXELS)return d.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function Tn(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}class Sn{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[s]*e[s];this.outputShape=n,this.rank=n.length;const i=It(this.rank),r=function(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],i=[];for(let r=0;r<t.length;r++)i.push(`imod(${n[r]}, ${t[r]})`);return i.join()}(t);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        setOutput(getA(${r}));\n      }\n    `}}class En{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const On="return abs(x);",Cn="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",_n="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",An="return (x >= 0.0) ? x : (exp(x) - 1.0);",kn=`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${s.backend_util.SELU_SCALEALPHA};\n  float scale = ${s.backend_util.SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`,Rn="return -x;",In="return ceil(x);",Mn="return floor(x);",Nn="return exp(x);",Dn="return exp(x) - 1.0;",Pn=`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${s.backend_util.ERF_P};\n  float a1 = ${s.backend_util.ERF_A1};\n  float a2 = ${s.backend_util.ERF_A2};\n  float a3 = ${s.backend_util.ERF_A3};\n  float a4 = ${s.backend_util.ERF_A4};\n  float a5 = ${s.backend_util.ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`,Fn="return x;",Ln="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",jn="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Bn="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n";class zn{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class $n{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;const e=t.length,n=gt("rc",e),i=It(e),r=function(t,e){if(1===t)return"rc";let n="";for(let i=0;i<t;i++)n+=e[i],i<t-1&&(n+=",");return n}(e,n),s=n.slice(-2),o=e<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`\n      void main() {\n        ${i} rc = getOutputCoords();\n        vec4 packedInput = getA(${r});\n\n        setOutput(getChannel(packedInput, ${o}));\n      }\n    `}}const{segment_util:Un}=s.backend_util,Wn=s.kernel_impls.split,Vn=s.kernel_impls.tile,Yn=s.kernel_impls.topkImpl,Gn=s.kernel_impls.whereImpl,Xn={};function Hn(t,e=!1){if("linear"===t)return"return x;";if("relu"===t)return e?Ln:Cn;if("elu"===t)return e?Bn:An;if("relu6"===t)return e?jn:_n;if("prelu"===t)return e?Yt:Wt;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}class qn extends s.KernelBackend{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Object(s.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){const t=l(Object(s.env)().getNumber("WEBGL_VERSION"));this.binaryCache=((e=Object(s.env)().getNumber("WEBGL_VERSION"))in Xn||(Xn[e]={}),Xn[e]),this.gpgpu=new $e(t),this.canvas=t.canvas,this.gpgpuCreatedLocally=!0}else this.gpgpu=t,this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var e;this.textureManager=new xn(this.gpgpu),this.numMBBeforeWarning=null==Object(s.env)().global.screen?1024:Object(s.env)().global.screen.height*Object(s.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new s.DataStorage(this,Object(s.engine)())}numDataIds(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}write(t,e,n){if(Object(s.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={};return this.texData.set(i,{shape:e,dtype:n,values:t,usage:h.UPLOAD}),i}move(t,e,n,i){if(Object(s.env)().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===i)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:i,values:e,usage:h.UPLOAD})}readSync(t){const e=this.texData.get(t),{values:n,dtype:i,complexTensors:r,slice:o,shape:a,isPacked:u}=e;if(null!=o){let e;e=u?new zn(a,Fn):new En(a,Fn);const n=this.runWebGLProgram(e,[{dataId:t,shape:a,dtype:i}],i),r=this.readSync(n.dataId);return this.disposeData(n.dataId),r}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===i)return n;const l=null!=this.activeTimers;let c,h;if(l&&(c=s.util.now()),"complex64"===i){const t=r.real.dataSync(),e=r.imag.dataSync();h=s.backend_util.mergeRealAndImagArrays(t,e)}else h=this.getValuesFromTexture(t);return l&&(this.downloadWaitMs+=s.util.now()-c),this.convertAndCacheOnCPU(t,h)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:i,slice:r,dtype:o,complexTensors:a,isPacked:u}=e;if(null!=r){let e;e=u?new zn(i,Fn):new En(i,Fn);const n=this.runWebGLProgram(e,[{dataId:t,shape:i,dtype:o}],o),r=this.read(n.dataId);return this.disposeData(n.dataId),r}if(null!=n)return this.convertAndCacheOnCPU(t);if(!Object(s.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Object(s.env)().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,c,h=null;if("complex64"!==o&&Object(s.env)().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(t);const e=this.texData.get(l.dataId);h=this.gpgpu.createBufferFromTexture(e.texture,...p(i))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([a.real.data(),a.imag.data()]);c=s.backend_util.mergeRealAndImagArrays(t[0],t[1])}else if(null==h)c=this.getValuesFromTexture(t);else{const t=s.util.sizeFromShape(i);c=this.gpgpu.downloadFloat32MatrixFromBuffer(h,t)}null!=l&&this.disposeData(l.dataId);const d=this.convertAndCacheOnCPU(t,c),f=this.pendingRead.get(t);return this.pendingRead.delete(t),f.forEach(t=>t(d)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),d}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!v(n)){if(Object(s.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:i}=this.texData.get(t),r=s.util.sizeFromShape(e);if(Object(s.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),i=this.texData.get(n.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(i.texture,...p(e)).subarray(0,r);return this.disposeData(n.dataId),s}const o=Object(s.env)().getBool("WEBGL_PACK")&&!0===i,a=o?H(e):e,u=o?new ye(a):new ge(a),l=this.runWebGLProgram(u,[{shape:a,dtype:n,dataId:t}],"float32"),c=this.texData.get(l.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture,c.texShape[0],c.texShape[1]).subarray(0,r);return this.disposeData(l.dataId),h}async time(t){const e=this.activeTimers,n=[];let i=!1;null==this.programTimersStack?(this.programTimersStack=n,i=!0):this.activeTimers.push(n),this.activeTimers=n,t();const r=s.util.flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),o=s.util.flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,i&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};if(Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(r);a.kernelMs=s.util.sum(t),a.getExtraProfileInfo=()=>t.map((t,e)=>({name:o[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}}startTimer(){return Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:s.util.now(),endMs:null}}endTimer(t){return Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=s.util.now(),t)}async getQueryTime(t){return Object(s.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(t):t.endMs-t.startMs}disposeData(t){if(this.pendingDisposal.has(t))return;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(!this.texData.has(t))return;this.releaseGPUData(t);const{complexTensors:e}=this.texData.get(t);null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}releaseGPUData(t){const{texture:e,dtype:n,texShape:i,usage:r,isPacked:s,slice:o}=this.texData.get(t),a=o&&o.origDataId||t,u=this.dataRefCount.get(a);u>1?this.dataRefCount.set(a,u-1):(this.dataRefCount.delete(a),null!=e&&(this.numBytesInGPU-=this.computeBytes(i,n),this.textureManager.releaseTexture(e,i,r,s)));const l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture}getDataInfo(t){return this.texData.get(t)}getCPUBackend(){return Object(s.env)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(s.engine)().findBackend("cpu")),this.cpuBackend):null}shouldExecuteOnCPU(t,e=128){return null!=this.getCPUBackend()&&t.every(t=>null==this.texData.get(t.dataId).texture&&s.util.sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}complex(t,e){const n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Object(s.engine)().keep(t.clone()),imag:Object(s.engine)().keep(e.clone())},n}real(t){return this.texData.get(t.dataId).complexTensors.real.clone()}imag(t){return this.texData.get(t.dataId).complexTensors.imag.clone()}slice(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===s.util.sizeFromShape(n))return Object(s.tensor)([],n,t.dtype);const{isPacked:i}=this.texData.get(t.dataId),r=s.slice_util.isSliceContinous(t.shape,e,n);if(i||!r){const i=Object(s.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vn(n):new gn(n),r=i.getCustomSetupFunc(e);return this.compileAndRun(i,[t],null,r)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)}shallowSlice(t,e,n){const i=this.texData.get(t.dataId),r=this.makeOutput(n,t.dtype),o=this.texData.get(r.dataId);Object.assign(o,i),o.shape=n,o.dtype=t.dtype;let a=s.slice_util.computeFlatOffset(e,t.strides);i.slice&&(a+=i.slice.flatOffset),o.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||t.dataId};const u=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,u+1),r}stridedSlice(t,e,n,i){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,i);const r=s.slice_util.computeOutShape(e,n,i);if(r.some(t=>0===t))return Object(s.tensor)([],r);const o=new bn(e,i,r);return this.compileAndRun(o,[t])}reverse(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new dn(t.shape,e):new hn(t.shape,e);return this.compileAndRun(n,[t])}concat(t,e){if("complex64"===t[0].dtype){const n=t.map(t=>Object(s.real)(t)),i=t.map(t=>Object(s.imag)(t));return Object(s.complex)(this.concat(n,e),this.concat(i,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>Object(s.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const n=Math.floor(t.length/2),i=this.concat(t.slice(0,n),e),r=this.concat(t.slice(n),e);return this.concat([i,r],e)}if(Object(s.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){const n=new Jt(t.map(t=>t.shape),e);return this.compileAndRun(n,t)}const n=s.backend_util.computeOutShape(t.map(t=>t.shape),e),i=t.map(t=>t.as2D(-1,s.util.sizeFromShape(t.shape.slice(e)))),r=new Kt(i.map(t=>t.shape));return this.compileAndRun(r,i).reshape(n)}neg(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Rn,t.dtype);const e=new En(t.shape,Rn);return this.compileAndRun(e,[t])}batchMatMul(t,e,n,i){const r=n?t.shape[2]:t.shape[1],o=i?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],[u,,]=t.shape;if((1===r||1===o)&&a>1e3){n&&(t=Object(s.transpose)(t,[0,2,1])),i&&(e=Object(s.transpose)(e,[0,2,1]));const r=1===o?t:t.as3D(u,a,1),l=1===o?2:1,c=1===o?e.as3D(u,1,a):e;return this.multiply(r,c).sum(l,!0)}const l=Object(s.upcastType)(t.dtype,e.dtype),c=new qe(t.shape,[u,r,o],n,i);return this.compileAndRun(c,[t,e],l)}fusedBatchMatMul({a:t,b:e,transposeA:n,transposeB:i,bias:r,activation:o,preluActivationWeights:a}){const u=n?t.shape[2]:t.shape[1],l=i?e.shape[1]:e.shape[2],[c,,]=t.shape,h=Object(s.upcastType)(t.dtype,e.dtype),d=null!=r,f=null!=a,p=o?Hn(o,!0):null,m=new qe(t.shape,[c,u,l],n,i,d,p,f),g=[t,e];return r&&g.push(r),a&&g.push(a),this.compileAndRun(m,g,h)}multiply(t,e){if("complex64"===t.dtype){const n=this.texData.get(t.dataId),i=this.texData.get(e.dataId),r=new Bt("return areal * breal - aimag * bimag;",t.shape,e.shape),s=new Bt("return areal * bimag + aimag * breal;",t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,i.complexTensors.real),this.makeComplexComponentTensorInfo(e,i.complexTensors.imag)],a=this.compileAndRun(r,o),u=this.compileAndRun(s,o),l=this.complex(a,u);return a.dispose(),u.dispose(),l}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Ut,t.dtype);const n=new Vt(Ut,t.shape,e.shape);return this.compileAndRun(n,[t,e],t.dtype)}batchNorm(t,e,n,i,r,o){const a=[t,e,n];let u=null;null!=i&&(u=i.shape,a.push(i));let l=null;if(null!=r&&(l=r.shape,a.push(r)),Object(s.env)().getBool("WEBGL_PACK_NORMALIZATION")){const i=new jt(t.shape,e.shape,n.shape,u,l,o);return this.compileAndRun(i,a)}const c=new Lt(t.shape,e.shape,n.shape,u,l,o);return this.compileAndRun(c,a)}localResponseNormalization4D(t,e,n,i,r){const o=Object(s.env)().getBool("WEBGL_PACK_NORMALIZATION")?new Ge(t.shape,e,n,i,r):new Ve(t.shape,e,n,i,r);return this.compileAndRun(o,[t])}LRNGrad(t,e,n,i,r,s,o){const a=new Ye(e.shape,i,r,s,o);return this.compileAndRun(a,[e,n,t])}tile(t,e){if("string"===t.dtype){const n=this.readSync(t.dataId).map(t=>s.util.decodeString(t)),i=Object(s.buffer)(t.shape,t.dtype,n);return Vn(i,e)}const n=new Sn(t.shape,e);return this.compileAndRun(n,[t])}pad(t,e,n){const i=Object(s.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tn(t.shape,e,n):new Ze(t.shape,e,n);return this.compileAndRun(i,[t])}gather(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);const i=new Te(t.shape,e.size,n);return this.compileAndRun(i,[t,e])}batchToSpaceND(t,e,n){s.util.assert(t.rank<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),r=s.backend_util.getReshaped(t.shape,e,i),o=s.backend_util.getPermuted(r.length,e.length),a=s.backend_util.getReshapedPermuted(t.shape,e,i),u=s.backend_util.getSliceBeginCoords(n,e.length),l=s.backend_util.getSliceSize(a,n,e.length);return Object(s.transpose)(t.reshape(r),o).reshape(a).slice(u,l)}spaceToBatchND(t,e,n){s.util.assert(t.rank<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const i=e.reduce((t,e)=>t*e),r=[[0,0]];r.push(...n);for(let s=1+e.length;s<t.shape.length;++s)r.push([0,0]);const o=t.pad(r),a=s.backend_util.getReshaped(o.shape,e,i,!1),u=s.backend_util.getPermuted(a.length,e.length,!1),l=s.backend_util.getReshapedPermuted(o.shape,e,i,!1);return Object(s.transpose)(o.reshape(a),u).reshape(l)}reduce(t,e,n){const i=t.shape[0],r=t.shape[1],o=s.backend_util.computeOptimalWindowSize(r),a=new rn({windowSize:o,inSize:r,batchSize:i},e),u=this.compileAndRun(a,[t],n);return 1===u.shape[1]?u:this.reduce(u,e,n)}argReduce(t,e,n=null){let i=t.shape[0],r=t.shape[1];null!=n&&(i=n.shape[0],r=n.shape[1]);const o=s.backend_util.computeOptimalWindowSize(r),a=new pt({windowSize:o,inSize:r,batchSize:i},e,null==n),u=[t];null!=n&&u.push(n);const l=this.compileAndRun(a,u,"int32");return 1===l.shape[1]?l:this.argReduce(t,e,l)}argReducePacked(t,e,n=null){const i=null!=n?n.shape:t.shape,r=s.backend_util.computeOptimalWindowSize(i[i.length-1]),o=new Dt(i,r,e,null==n),a=this.compileAndRun(o,null==n?[t]:[t,n],"int32");return a.rank===t.rank?this.argReducePacked(t,e,a):a}sum(t,e){s.backend_util.assertAxesAreInnerMostDims("sum",e,t.rank);const[n,i]=s.backend_util.computeOutAndReduceShapes(t.shape,e),r=s.util.sizeFromShape(i),o=t.as2D(-1,r),a=s.sumOutType(t.dtype);return this.reduce(o,"sum",a).reshape(n)}prod(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);const[n,i]=s.backend_util.computeOutAndReduceShapes(t.shape,e),r=s.util.sizeFromShape(i),o=t.as2D(-1,r),a=s.sumOutType(t.dtype);return this.reduce(o,"prod",a).reshape(n)}unsortedSegmentSum(t,e,n){let i=0;const r=s.backend_util.getAxesPermutation([i],t.rank);let o=t;null!=r&&(o=Object(s.transpose)(t,r),i=s.backend_util.getInnerMostAxes(1,t.rank)[0]);const a=Un.computeOutShape(o.shape,i,n),u=s.util.sizeFromShape([o.shape[i]]),l=o.as2D(-1,u),c=s.sumOutType(t.dtype);let h=this.segOpCompute(l,"unsortedSegmentSum",e,c,n).reshape(a);return null!=r&&(h=Object(s.transpose)(h,s.backend_util.getUndoAxesPermutation(r))),h}segOpCompute(t,e,n,i,r){const o=t.shape[0],a=t.shape[1],u=Un.segOpComputeOptimalWindowSize(a,r),l=new pn({windowSize:u,inSize:a,batchSize:o,numSegments:r},e),c=this.compileAndRun(l,[t,n],i);return c.shape[1]===r?c:(n=Object(s.range)(0,r).tile([a/u]),this.segOpCompute(c,e,n,i,r))}argMinMaxReduce(t,e,n){const i=[e];if(s.backend_util.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),i,t.rank),!Object(s.env)().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){const[e,r]=s.backend_util.computeOutAndReduceShapes(t.shape,i),o=s.util.sizeFromShape(r),a=t.as2D(-1,o);return this.argReduce(a,n).reshape(e)}return this.argReducePacked(t,n)}argMin(t,e){return this.argMinMaxReduce(t,e,"min")}argMax(t,e){return this.argMinMaxReduce(t,e,"max")}cumsum(t,e,n,i){if(e!==t.rank-1)throw new Error(`WebGL cumsum shader expects an inner-most axis=${t.rank-1} but got axis=`+e);const r=new ce(t.shape,n,i);return this.compileAndRun(r,[t])}equal(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");const n=new Vt("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}notEqual(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");const n=new Vt("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}less(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");const n=new Vt("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}lessEqual(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");const n=new Vt("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}greater(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");const n=new Vt("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}greaterEqual(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");const n=new Vt("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalNot(t){const e=new En(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])}logicalAnd(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");const n=new Vt("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}logicalOr(t,e){if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");const n=new Vt("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")}select(t,e,n){const i=new mn(t.rank,e.shape,e.rank);return this.compileAndRun(i,[t,e,n],Object(s.upcastType)(e.dtype,n.dtype))}where(t){s.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return Gn(t.shape,e)}topk(t,e,n){const i=t.dataSync();return Yn(i,t.shape,t.dtype,e,n)}min(t,e){s.backend_util.assertAxesAreInnerMostDims("min",e,t.rank);const[n,i]=s.backend_util.computeOutAndReduceShapes(t.shape,e),r=s.util.sizeFromShape(i),o=t.as2D(-1,r);return this.reduce(o,"min",o.dtype).reshape(n)}minimum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Vt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}mod(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Vt("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}maximum(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Vt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}all(t,e){s.backend_util.assertAxesAreInnerMostDims("all",e,t.rank);const[n,i]=s.backend_util.computeOutAndReduceShapes(t.shape,e),r=s.util.sizeFromShape(i),o=t.as2D(-1,r);return this.reduce(o,"all",o.dtype).reshape(n)}any(t,e){s.backend_util.assertAxesAreInnerMostDims("any",e,t.rank);const[n,i]=s.backend_util.computeOutAndReduceShapes(t.shape,e),r=s.util.sizeFromShape(i),o=t.as2D(-1,r);return this.reduce(o,"any",o.dtype).reshape(n)}floorDiv(t,e){const n="int32";if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",n);const i=new Vt("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(i,[t,e],n)}add(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,zt);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);const n=Object(s.upcastType)(t.dtype,e.dtype);if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,zt,n);const i=new Vt(zt,t.shape,e.shape);return this.compileAndRun(i,[t,e],n)}packedUnaryOp(t,e,n){const i=new zn(t.shape,e);return this.compileAndRun(i,[t],n)}packedBinaryOp(t,e,n,i,r=!1){const s=new Gt(n,t.shape,e.shape,r);return this.compileAndRun(s,[t,e],i)}complexSeparableBinaryOp(t,e,n){const i=this.texData.get(t.dataId),r=this.texData.get(e.dataId),[o,a]=[[i.complexTensors.real,r.complexTensors.real],[i.complexTensors.imag,r.complexTensors.imag]].map(i=>{const[r,o]=i,a=this.makeComplexComponentTensorInfo(t,r),u=this.makeComplexComponentTensorInfo(e,o),l=new Vt(n,t.shape,e.shape);return this.compileAndRun(l,[a,u],Object(s.upcastType)(r.dtype,o.dtype))}),u=this.complex(o,a);return o.dispose(),a.dispose(),u}makeComplexComponentTensorInfo(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}addN(t){if(1===t.length)return t[0];if(t.length>Object(s.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),i=this.addN(t.slice(e));return this.addN([n,i])}const e=t.map(t=>t.dtype).reduce((t,e)=>Object(s.upcastType)(t,e)),n=t.map(t=>t.shape),i=Object(s.env)().getBool("WEBGL_PACK")?new ft(t[0].shape,n):new dt(t[0].shape,n);return this.compileAndRun(i,t,e)}subtract(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,$t);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);const n=Object(s.upcastType)(t.dtype,e.dtype);if(Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,$t,t.dtype);const i=new Vt($t,t.shape,e.shape);return this.compileAndRun(i,[t,e],n)}pow(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Vt("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=Object(s.upcastType)(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],i)}ceil(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,In,t.dtype);const e=new En(t.shape,In);return this.compileAndRun(e,[t])}floor(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Mn,t.dtype);const e=new En(t.shape,Mn);return this.compileAndRun(e,[t])}sign(t){const e=new En(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])}isNaN(t){const e=new En(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")}isInf(t){const e=new En(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")}isFinite(t){const e=new En(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")}round(t){const e=new En(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])}exp(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Nn,t.dtype);const e=new En(t.shape,Nn);return this.compileAndRun(e,[t])}expm1(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Dn,t.dtype);const e=new En(t.shape,Dn);return this.compileAndRun(e,[t])}softmax(t,e){const n=s.util.parseAxisParam([e],t.shape),i=Object(s.max)(t,n),r=s.backend_util.expandShapeToKeepDim(i.shape,n),o=this.subtract(t,i.reshape(r)),a=this.exp(o),u=this.sum(a,n).reshape(r);return Object(s.div)(a,u)}log(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);const e=new En(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])}log1p(t){const e=new En(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])}sqrt(t){const e=new En(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])}rsqrt(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);const e=new En(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])}reciprocal(t){const e=new En(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])}relu(t){let e;return e=Object(s.env)().getBool("WEBGL_PACK")?new zn(t.shape,Ln):new En(t.shape,Cn),this.compileAndRun(e,[t])}relu6(t){let e;return e=Object(s.env)().getBool("WEBGL_PACK")?new zn(t.shape,jn):new En(t.shape,_n),this.compileAndRun(e,[t])}prelu(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt(Yt,t.shape,e.shape):new Vt(Wt,t.shape,e.shape);return this.compileAndRun(n,[t,e])}elu(t){if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Bn,t.dtype);const e=new En(t.shape,An);return this.compileAndRun(e,[t])}eluDer(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new Vt("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])}selu(t){const e=new En(t.shape,kn);return this.compileAndRun(e,[t])}int(t){const e=new En(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")}clip(t,e,n){let i;i=Object(s.env)().getBool("WEBGL_PACK_CLIP")?new Ht(t.shape):new Xt(t.shape);const r=i.getCustomSetupFunc(e,n);return this.compileAndRun(i,[t],null,r)}abs(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(Object(s.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,On,t.dtype);const e=new En(t.shape,On);return this.compileAndRun(e,[t])}complexAbs(t){const e=this.texData.get(t.dataId),n=new qt(t.shape),i=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,i)}sigmoid(t){const e=new En(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])}softplus(t){const e=new En(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])}sin(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])}cos(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])}tan(t){const e=new En(t.shape,"return tan(x);");return this.compileAndRun(e,[t])}asin(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])}acos(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])}atan(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])}atan2(t,e){const n=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new Vt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])}sinh(t){const e=new En(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}cosh(t){const e=new En(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])}tanh(t){const e=new En(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])}asinh(t){const e=new En(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])}acosh(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])}atanh(t){const e=new En(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])}erf(t){const e=new En(t.shape,Pn);return this.compileAndRun(e,[t])}step(t,e){const n=new En(t.shape,function(t=0){return`if (isnan(x)) return x;\n    return x > 0.0 ? 1.0 : float(${t});\n  `}(e));return this.compileAndRun(n,[t])}conv2dByMatMul(t,e,n,i,r,o){const a=t.shape,u=this.texData.get(t.dataId),l="channelsLast"===n.dataFormat,c=a[2]%2!=0&&!!u.isPacked;if((1==a[0]*a[1]*a[2]||1===n.outChannels)&&n.inChannels>1e3||!Object(s.env)().getBool("WEBGL_LAZILY_UNPACK")||!Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){const s=this.reshape(t,[1,l?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],n.inChannels]),u=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:s,b:u,transposeA:!1,transposeB:!1,bias:i,activation:r,preluActivationWeights:o}),n.outShape)}const h={dataId:t.dataId,shape:[1,l?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),n.inChannels],dtype:t.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,s.util.assert(J(u.shape,h.shape),()=>`packed reshape ${u.shape} to ${h.shape} isn't free`);const f=this.reshape(e,[1,n.inChannels,n.outChannels]),p=this.fusedBatchMatMul({a:h,b:f,transposeA:!1,transposeB:!1,bias:i,activation:r,preluActivationWeights:o}),m=this.texData.get(p.dataId);return s.util.assert(m.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=d,m.shape=n.outShape,Object(s.engine)().makeTensorFromDataId(p.dataId,n.outShape,p.dtype)}conv2dWithIm2Row(t,e,n,i,r,s){const{filterWidth:o,filterHeight:a,inChannels:u,outWidth:l,outHeight:c,dataFormat:h}=n,d="channelsLast"===h,f=o*a*u,p=c*l,m=[f,p],g=t.squeeze([0]),y=e.reshape([1,f,-1]),v=new We(m,g.shape,n),b=this.compileAndRun(v,[g]).reshape([1,m[0],m[1]]),x=null!=i,w=null!=s,T=r?Hn(r,!0):null,S=new qe(b.shape,[1,p,n.outChannels],!0,!1,x,T,w),E=[b,y];return i&&E.push(i),w&&E.push(s),this.compileAndRun(S,E).reshape(d?[1,c,l,n.outChannels]:[1,n.outChannels,c,l])}fusedConv2d({input:t,filter:e,convInfo:n,bias:i,activation:r,preluActivationWeights:o}){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n,i,r,o);if(Object(s.env)().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n,i,r,o);const a=null!=i,u=null!=o,l=r?Hn(r,!1):null,c=new se(n,a,l,u),h=[t,e];return i&&h.push(i),o&&h.push(o),this.compileAndRun(c,h)}conv2d(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(Object(s.env)().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);const i=new se(n);return this.compileAndRun(i,[t,e])}conv2dDerInput(t,e,n){const i=new te(n);return this.compileAndRun(i,[t,e])}conv2dDerFilter(t,e,n){const i=new Zt(n);return this.compileAndRun(i,[t,e])}fusedDepthwiseConv2D({input:t,filter:e,convInfo:n,bias:i,activation:r,preluActivationWeights:o}){const a=Object(s.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1,u=r?Hn(r,a):null,l=[t,e],c=null!=i,h=null!=o;let d;return c&&l.push(i),h&&l.push(o),a?(d=new ue(n,c,u,h),this.compileAndRun(d,l)):(d=new ae(n,c,u,h),this.compileAndRun(d,l))}depthwiseConv2D(t,e,n){let i;return Object(s.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(i=new ue(n),this.compileAndRun(i,[t,e])):(i=new ae(n),this.compileAndRun(i,[t,e]))}depthwiseConv2DDerInput(t,e,n){const i=new re(n);return this.compileAndRun(i,[t,e])}depthwiseConv2DDerFilter(t,e,n){const i=new ie(n);return this.compileAndRun(i,[t,e])}conv3d(t,e,n){const i=new oe(n);return this.compileAndRun(i,[t,e])}conv3dDerInput(t,e,n){const i=new ne(n);return this.compileAndRun(i,[t,e])}conv3dDerFilter(t,e,n){const i=new ee(n);return this.compileAndRun(i,[t,e])}maxPool(t,e){const n=new en(e,"max",!1);return this.compileAndRun(n,[t])}avgPool(t,e){const n=new en(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}maxPoolBackprop(t,e,n,i){const r=new en(i,"max",!0),s=this.compileAndRun(r,[e]),o=new Xe(i),a=this.compileAndRun(o,[t,s],e.dtype);return s.dispose(),a}avgPoolBackprop(t,e,n){const i=new Pt(n);return this.compileAndRun(i,[t],e.dtype)}cast(t,e){return s.backend_util.castTensor(t,e,this)}unstack(t,e){const n=t.shape[e],i=new Array(t.rank-1);let r=0;for(let u=0;u<t.rank;u++)u!==e&&(i[r++]=t.shape[u]);const s=new Array(t.rank).fill(0),o=t.shape.slice();o[e]=1;const a=new Array(n);for(let u=0;u<a.length;u++)s[e]=u,a[u]=this.slice(t,s,o).reshape(i);return a}avgPool3d(t,e){const n=new nn(e,"avg",!1);return this.compileAndRun(n,[t],"float32")}avgPool3dBackprop(t,e,n){const i=new Ft(n);return this.compileAndRun(i,[t],e.dtype)}maxPool3d(t,e){const n=new nn(e,"max",!1);return this.compileAndRun(n,[t],"float32")}maxPool3dBackprop(t,e,n,i){const r=new nn(i,"max",!0),s=this.compileAndRun(r,[e]),o=new He(i),a=this.compileAndRun(o,[t,s],e.dtype);return s.dispose(),a}reshape(t,e){const n=this.texData.get(t.dataId);if(n.isPacked&&!J(t.shape,e)&&(null===n.texture||!J(n.shape,e))){const n=this.packedReshape(t,e);return Object(s.engine)().makeTensorFromDataId(n.dataId,n.shape,n.dtype)}return s.backend_util.reshapeTensor(t,e)}resizeBilinear(t,e,n,i){const r=Object(s.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new un(t.shape,e,n,i):new an(t.shape,e,n,i);return this.compileAndRun(r,[t],"float32")}resizeBilinearBackprop(t,e,n){const i=new on(t,e,n);return this.compileAndRun(i,[t])}resizeNearestNeighbor(t,e,n,i){const r=new cn(t.shape,e,n,i);return this.compileAndRun(r,[t])}resizeNearestNeighborBackprop(t,e,n){const i=new ln(t,e,n);return this.compileAndRun(i,[t])}multinomial(t,e,n,i){const r=e?t:Object(s.softmax)(t),o=new Ke(r.shape[0],r.shape[1],n),a=o.getCustomSetupFunc(i);return this.compileAndRun(o,[r],"int32",a)}oneHot(t,e,n,i){const r=new Je(t.size,e,n,i);return this.compileAndRun(r,[t])}diag(t){const e=new me(t.size);return this.compileAndRun(e,[t])}cropAndResize(t,e,n,i,r,s){const o=new le(t.shape,e.shape,i,r,s);return this.compileAndRun(o,[t,e,n],"float32")}depthToSpace(t,e,n){s.util.assert(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+e);const i=t.shape[0],r=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,a=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),u=new pe("NHWC"===n?[i,r,o,a]:[i,a,r,o],e,n);return this.compileAndRun(u,[t])}split(t,e,n){return Wn(t,e,n)}scatterND(t,e,n){const{sliceRank:i,numUpdates:r,sliceSize:o,strides:a,outputSize:u}=s.backend_util.calculateShapes(e,t,n),l=[u/o,o],c=t.reshape([r,i]),h=e.reshape([r,o]);if(0===u)return s.backend_util.reshapeTensor(Object(s.tensor)([]),n);const d=Object(s.scalar)(0),f=new fn(r,i,c.rank,h.rank,a,l);return this.compileAndRun(f,[h,c,d]).reshape(n)}sparseToDense(t,e,n,i){const{sliceRank:r,numUpdates:o,strides:a,outputSize:u}=s.backend_util.calculateShapes(e,t,n),l=new fn(o,r,t.rank,e.rank,a,[u,1],!1);return this.compileAndRun(l,[e,t,i]).reshape(n)}fft(t){return this.fftImpl(t,!1)}ifft(t){return this.fftImpl(t,!0)}fftImpl(t,e){const n=this.texData.get(t.dataId),i=new xe("return real * expR - imag * expI;",t.shape,e),r=new xe("return real * expI + imag * expR;",t.shape,e),s=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(i,s),a=this.compileAndRun(r,s),u=this.complex(o,a).as2D(t.shape[0],t.shape[1]);return o.dispose(),a.dispose(),u}gatherND(t,e){const n=e.shape,i=n[n.length-1],[r,o,a,u]=s.backend_util.prepareAndValidate(t,e),l=e.reshape([o,i]),c=t.reshape([t.size/a,a]),h=new Se(i,u,[o,a]);return this.compileAndRun(h,[c,l]).reshape(r)}fill(t,e,n){if("string"===(n=n||s.util.inferDtype(e))){const i=s.util.getArrayFromDType(n,s.util.sizeFromShape(t));return i.fill(e),Object(s.engine)().makeTensor(i,t,n,this)}{const i=new we(t,e),r=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],n,r)}}onesLike(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)}zerosLike(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)}linspace(t,e,n){return s.backend_util.linspaceImpl(t,e,n)}makeTensorInfo(t,e){const n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}}makeOutput(t,e){const{dataId:n}=this.makeTensorInfo(t,e);return Object(s.engine)().makeTensorFromDataId(n,t,e,this)}unpackTensor(t){const e=new $n(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new Qe(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[G(t.shape),...X(t.shape)],i={dtype:t.dtype,shape:n,dataId:t.dataId},r=[G(e),...X(e)],s=new sn(r,n),o=this.runWebGLProgram(s,[i],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}}decode(t){const e=this.texData.get(t),{isPacked:n,shape:i,dtype:r}=e,s=H(i);let o;return o=n?new fe(s):new de(s),{dtype:r,shape:i,dataId:this.runWebGLProgram(o,[{shape:s,dtype:r,dataId:t}],r,null,!0).dataId}}runWebGLProgram(t,e,n,i,r=!1){const o=this.makeTensorInfo(t.outputShape,n),a=this.texData.get(o.dataId);if(t.packedOutput&&(a.isPacked=!0),t.outPackingScheme===c.DENSE){const e=p(t.outputShape);a.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(a.usage=t.outTexUsage),0===s.util.sizeFromShape(o.shape))return a.values=s.util.getTypedArrayFromDType(o.dtype,0),o;const u=[],l=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&s.util.sizeFromShape(e.shape)<=Object(s.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),u.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!J(n.shape,e.shape)){const t=e,i=e.shape;e.shape=n.shape,e=this.packedReshape(e,i),u.push(e),n=this.texData.get(e.dataId),t.shape=i}return this.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);const h={shape:o.shape,texData:a,isUniform:!1},d=function(t,e,n){let i="";e.concat(n).forEach(t=>{i+=`${t.shape}_${t.isUniform?"uniform":t.texData.texShape}_${null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0}`});let r=t.constructor.name;return r+="_"+i+"_"+t.userCode,r}(t,l,h),f=this.getAndSaveBinary(d,()=>function(t,e,n,i){const r=e.userCode,o=n.map((t,n)=>{const i={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(i.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:i}}),a=o.map(t=>t.shapeInfo),u={logicalShape:i.shape,texShape:i.texData.texShape,isUniform:!1,isPacked:i.texData.isPacked,flatOffset:null},l=Tt(o,u,r,e.packedInputs),c=t.createProgram(l);let h=null;const d=t.getUniformLocation(c,"NAN",!1);1===Object(s.env)().getNumber("WEBGL_VERSION")&&(h=t.getUniformLocation(c,"INFINITY",!1));const f={};for(let s=0;s<e.variableNames.length;s++){const n=e.variableNames[s],i=!1;f[n]=t.getUniformLocation(c,n,i),f["offset"+n]=t.getUniformLocation(c,"offset"+n,i)}return{program:e,source:l,webGLProgram:c,uniformLocations:f,inShapeInfos:a,outShapeInfo:u,infLoc:h,nanLoc:d}}(this.gpgpu,t,l,h)),m=null!=this.activeTimers;let g;if(m&&(g=this.startTimer()),function(t,e,n,i,r){Ue(e.inShapeInfos,n),Ue([e.outShapeInfo],[i]);const o=i.texData.texture,a=i.texData.texShape;i.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===Object(s.env)().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,i)=>{const r=e.program.variableNames[i],o=e.uniformLocations[r],a=e.uniformLocations["offset"+r];if(null!=o)if(n.isUniform)if(s.util.sizeFromShape(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(o,e)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,i)}),null!=r&&r(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,f,l,h,i),u.forEach(t=>this.disposeData(t.dataId)),m&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)})),!Object(s.env)().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&!1===r){const t=this.unpackTensor(o);return this.disposeData(o.dataId),t}return o}compileAndRun(t,e,n,i,r=!1){const o=this.runWebGLProgram(t,e,n=n||e[0].dtype,i,r);return Object(s.engine)().makeTensorFromDataId(o.dataId,o.shape,o.dtype)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Object(s.env)().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(s.tidy)(()=>{if(!Object(s.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Object(s.env)().getBool("DEBUG");Object(s.env)().set("DEBUG",!1);const e=this.abs(Object(s.scalar)(1e-8)).dataSync()[0];if(Object(s.env)().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:i,values:r,texture:o,usage:a,isPacked:u}=e;if(null!=o)return;const l=null!=this.activeTimers;let c;l&&(c=s.util.now());let d=e.texShape;if(null==d&&(d=q(n,u),e.texShape=d),null!=r){const t=H(n);let o,a=d[1],f=d[0];const p=r instanceof Uint8Array;u?([a,f]=m(d[0],d[1]),o=new be(t,[f,a],p)):o=new ve(t,[f,a],p);const g=this.makeTensorInfo([f,a],i);this.texData.get(g.dataId).usage=p?h.PIXELS:h.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),a,f,r);const y=this.runWebGLProgram(o,[g],i,null,!0),v=this.texData.get(y.dataId);e.texture=v.texture,e.texShape=v.texShape,e.isPacked=v.isPacked,e.usage=v.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),e.values=null,l&&(this.uploadWaitMs+=s.util.now()-c)}else{const t=this.acquireTexture(d,a,i,u);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:i}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype "+e)}(e,i)),n.values}acquireTexture(t,e,n,i){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,i)}computeBytes(t,e){return t[0]*t[1]*s.util.bytesPerElement(e)}}const Kn="2.0.1",Jn={kernelName:s.Div,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:n,b:i}=t;return function(t,e,n){let i=new Vt("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(i=new Gt("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",t.shape,e.shape,!0)),n.runWebGLProgram(i,[t,e],"float32")}(n,i,e)}};class Qn{constructor(t){this.variableNames=["A"];const e=yt(),[n,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class Zn{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=yt(),[n,i]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${i}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}const ti={kernelName:s.FromPixels,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:i}=t;let{pixels:r}=e;const{numChannels:o}=i,a="undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement,u="undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement,[l,c]=a?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[c,l],f=[c,l,o];(u||a)&&(null==ei&&(ei=document.createElement("canvas").getContext("2d")),ei.canvas.width=l,ei.canvas.height=c,ei.drawImage(r,0,0,l,c),r=ei.canvas);const p=n.makeTensorInfo(d,"int32");n.texData.get(p.dataId).usage=h.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);const m=Object(s.env)().getBool("WEBGL_PACK")?new Zn(f):new Qn(f),g=n.runWebGLProgram(m,[p],"int32");return n.disposeData(p.dataId),g}};let ei;var ni=n(31);const{maxImpl:ii,transposeImpl:ri}=ni.b;function si(t,e,n,i){const[r,o]=t.shape,a=s.backend_util.computeOptimalWindowSize(o),u=new rn({windowSize:a,inSize:o,batchSize:r},n),l=i.runWebGLProgram(u,[t],e);return 1===l.shape[1]?l:si(l,e,n,i)}function oi(t,e,n){const i=n.texData.get(t.dataId);return!i.isPacked||J(t.shape,e)||null!==i.texture&&J(i.shape,e)?{dataId:t.dataId,shape:e,dtype:t.dtype}:function(t,e,n){const i=[G(t.shape),...X(t.shape)],r={dtype:t.dtype,shape:i,dataId:t.dataId},s=[G(e),...X(e)],o=new sn(s,i),a=n.runWebGLProgram(o,[r],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}}(t,e,n)}function ai(t,e,n,i){const r=s.util.sizeFromShape(e),o=oi(t,[s.util.sizeFromShape(t.shape)/r,r],i),a=si(o,t.dtype,"max",i);return o.dataId!==t.dataId&&i.disposeData(o.dataId),oi(a,n,i)}class ui{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t[e[s]];this.outputShape=n,this.rank=n.length;const i=It(this.rank),r=function(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],i=new Array(e);for(let r=0;r<t.length;r++)i[t[r]]=n[r];return i.join()}(e);this.userCode=`\n    void main() {\n      ${i} resRC = getOutputCoords();\n      setOutput(getA(${r}));\n    }\n    `}}class li{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let l=0;l<n.length;l++)n[l]=t[e[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=It(this.rank),r=mt("rc",this.rank),s=new Array(this.rank);for(let l=0;l<e.length;l++)s[e[l]]=r[l];const o=`vec2(${s.slice(-2).join()})`,a=`++${r[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${s.join()}), ${o})`;this.userCode=`\n    void main() {\n      ${i} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${u};\n      if(${a}) {\n        result[1] = ${u};\n      }\n      --${r[this.rank-1]};\n      if(++${r[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${u};\n        if(${a}) {\n          result[3] = ${u};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function ci(t,e,n){const i=Object(s.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new li(t.shape,e):new ui(t.shape,e);return n.runWebGLProgram(i,[t],t.dtype)}const hi={kernelName:s.Max,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{reductionIndices:r}=e,o=n,a=i.shape.length;let u=s.util.parseAxisParam(r,i.shape);const l=s.backend_util.getAxesPermutation(u,a),c=null!=l,h=o.shouldExecuteOnCPU([i]);let d=i;if(c){if(h){const t=o.texData.get(d.dataId).values,e=new Array(a);for(let r=0;r<e.length;r++)e[r]=i.shape[l[r]];const n=ri(t,i.shape,i.dtype,l,e);d=o.makeTensorInfo(e,i.dtype),o.texData.get(d.dataId).values=n}else d=ci(i,l,o);u=s.backend_util.getInnerMostAxes(u.length,a)}s.backend_util.assertAxesAreInnerMostDims("max",u,a);const[f,p]=s.backend_util.computeOutAndReduceShapes(d.shape,u);let m;if(h){const t=o.texData.get(d.dataId),e=ii(t.values,s.util.sizeFromShape(p),f,i.dtype);m=o.makeTensorInfo(f,i.dtype),o.texData.get(m.dataId).values=e}else m=ai(d,p,f,o);return c&&o.disposeData(d.dataId),m}},di={kernelName:s.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{filterSize:r,strides:o,pad:a,includeBatchInIndex:u}=e,l=n;s.util.assert(4===i.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${i.shape.length}.`);const c=[1,1];s.util.assert(s.backend_util.eitherStridesOrDilationsAreOne(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=s.backend_util.computePool2DInfo(i.shape,r,o,c,a),[d,f]=function(t,e,n,i){let r=new en(n,"max",!1);const s=i.runWebGLProgram(r,[t],"float32");return r=new en(n,"max",!0,!0,e),[s,i.runWebGLProgram(r,[t],"float32")]}(i,u,h,l);return[d,f]}},fi={kernelName:s.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{s.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:i,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u}=n,l=e,c=l.readSync(i.dataId),h=l.readSync(r.dataId);return s.kernel_impls.nonMaxSuppressionV3(c,h,o,a,u)}},pi=s.kernel_impls.nonMaxSuppressionV5,mi=[hi,ti,Jn,fi,{kernelName:s.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{s.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{boxes:i,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=n,c=e,h=c.readSync(i.dataId),d=c.readSync(r.dataId),f=o,p=a,m=u,g=l,{selectedIndices:y,selectedScores:v}=pi(h,d,f,p,m,g);return[y,v]}},{kernelName:s.Square,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,i=e,r=new En(n.shape,"return x * x;");return i.runWebGLProgram(r,[n],n.dtype)}},{kernelName:s.SquaredDifference,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{a:n,b:i}=t,r="return (a - b) * (a - b);",o=e,a=Object(s.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gt(r,n.shape,i.shape):new Vt(r,n.shape,i.shape);return o.compileAndRun(a,[n,i])}},{kernelName:s.Transpose,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{perm:r}=e,s=n,o=new Array(i.shape.length);for(let u=0;u<o.length;u++)o[u]=i.shape[r[u]];let a;if(s.shouldExecuteOnCPU([i])){const t=s.texData.get(i.dataId),e=ri(t.values,i.shape,i.dtype,r,o);a=s.makeTensorInfo(o,i.dtype),s.texData.get(a.dataId).values=e}else a=ci(i,r,s);return a}},di];for(const vi of mi)Object(s.registerKernel)(vi);function gi(){Object(s.env)().set("WEBGL_FORCE_F16_TEXTURES",!0)}s.device_util.isBrowser()&&Object(s.registerBackend)("webgl",()=>new qn,2);const yi={forceHalfFloat:gi}},function(t,e,n){"use strict";n.r(e),n.d(e,"CallbackList",function(){return ze}),n.d(e,"CustomCallback",function(){return We}),n.d(e,"History",function(){return Ue}),n.d(e,"Callback",function(){return Mo}),n.d(e,"callbacks",function(){return Fo}),n.d(e,"EarlyStopping",function(){return Po}),n.d(e,"InputSpec",function(){return _e}),n.d(e,"SymbolicTensor",function(){return Ae}),n.d(e,"LayersModel",function(){return qn}),n.d(e,"input",function(){return ei}),n.d(e,"loadLayersModel",function(){return ti}),n.d(e,"model",function(){return Qn}),n.d(e,"registerCallbackConstructor",function(){return ni}),n.d(e,"sequential",function(){return Zn}),n.d(e,"RNN",function(){return zr}),n.d(e,"Sequential",function(){return Jn}),n.d(e,"LayerVariable",function(){return Ee}),n.d(e,"version_layers",function(){return En}),n.d(e,"constraints",function(){return i}),n.d(e,"initializers",function(){return r}),n.d(e,"layers",function(){return s}),n.d(e,"metrics",function(){return o}),n.d(e,"models",function(){return a}),n.d(e,"regularizers",function(){return u});var i={};n.r(i),n.d(i,"maxNorm",function(){return G}),n.d(i,"unitNorm",function(){return X}),n.d(i,"nonNeg",function(){return H}),n.d(i,"minMaxNorm",function(){return q});var r={};n.r(r),n.d(r,"zeros",function(){return te}),n.d(r,"ones",function(){return ee}),n.d(r,"constant",function(){return ne}),n.d(r,"randomUniform",function(){return ie}),n.d(r,"randomNormal",function(){return re}),n.d(r,"truncatedNormal",function(){return se}),n.d(r,"identity",function(){return oe}),n.d(r,"varianceScaling",function(){return ae}),n.d(r,"glorotUniform",function(){return ue}),n.d(r,"glorotNormal",function(){return le}),n.d(r,"heNormal",function(){return ce}),n.d(r,"heUniform",function(){return he}),n.d(r,"leCunNormal",function(){return de}),n.d(r,"leCunUniform",function(){return fe}),n.d(r,"orthogonal",function(){return pe});var s={};n.r(s),n.d(s,"inputLayer",function(){return Zr}),n.d(s,"elu",function(){return ts}),n.d(s,"reLU",function(){return es}),n.d(s,"leakyReLU",function(){return ns}),n.d(s,"prelu",function(){return is}),n.d(s,"softmax",function(){return rs}),n.d(s,"thresholdedReLU",function(){return ss}),n.d(s,"conv1d",function(){return os}),n.d(s,"conv2d",function(){return as}),n.d(s,"conv2dTranspose",function(){return us}),n.d(s,"conv3d",function(){return ls}),n.d(s,"separableConv2d",function(){return cs}),n.d(s,"cropping2D",function(){return hs}),n.d(s,"upSampling2d",function(){return ds}),n.d(s,"depthwiseConv2d",function(){return fs}),n.d(s,"activation",function(){return ps}),n.d(s,"dense",function(){return ms}),n.d(s,"dropout",function(){return gs}),n.d(s,"spatialDropout1d",function(){return ys}),n.d(s,"flatten",function(){return vs}),n.d(s,"repeatVector",function(){return bs}),n.d(s,"reshape",function(){return xs}),n.d(s,"permute",function(){return ws}),n.d(s,"embedding",function(){return Ts}),n.d(s,"add",function(){return Ss}),n.d(s,"average",function(){return Es}),n.d(s,"concatenate",function(){return Os}),n.d(s,"maximum",function(){return Cs}),n.d(s,"minimum",function(){return _s}),n.d(s,"multiply",function(){return As}),n.d(s,"dot",function(){return ks}),n.d(s,"batchNormalization",function(){return Rs}),n.d(s,"layerNormalization",function(){return Is}),n.d(s,"zeroPadding2d",function(){return Ms}),n.d(s,"averagePooling1d",function(){return Ns}),n.d(s,"avgPool1d",function(){return Ds}),n.d(s,"avgPooling1d",function(){return Ps}),n.d(s,"averagePooling2d",function(){return Fs}),n.d(s,"avgPool2d",function(){return Ls}),n.d(s,"avgPooling2d",function(){return js}),n.d(s,"averagePooling3d",function(){return Bs}),n.d(s,"avgPool3d",function(){return zs}),n.d(s,"avgPooling3d",function(){return $s}),n.d(s,"globalAveragePooling1d",function(){return Us}),n.d(s,"globalAveragePooling2d",function(){return Ws}),n.d(s,"globalMaxPooling1d",function(){return Vs}),n.d(s,"globalMaxPooling2d",function(){return Ys}),n.d(s,"maxPooling1d",function(){return Gs}),n.d(s,"maxPooling2d",function(){return Xs}),n.d(s,"maxPooling3d",function(){return Hs}),n.d(s,"gru",function(){return qs}),n.d(s,"gruCell",function(){return Ks}),n.d(s,"lstm",function(){return Js}),n.d(s,"lstmCell",function(){return Qs}),n.d(s,"simpleRNN",function(){return Zs}),n.d(s,"simpleRNNCell",function(){return to}),n.d(s,"rnn",function(){return eo}),n.d(s,"stackedRNNCells",function(){return no}),n.d(s,"bidirectional",function(){return io}),n.d(s,"timeDistributed",function(){return ro}),n.d(s,"globalMaxPool1d",function(){return so}),n.d(s,"globalMaxPool2d",function(){return oo}),n.d(s,"maxPool1d",function(){return ao}),n.d(s,"maxPool2d",function(){return uo}),n.d(s,"Layer",function(){return Me}),n.d(s,"RNN",function(){return zr}),n.d(s,"RNNCell",function(){return $r}),n.d(s,"input",function(){return ei}),n.d(s,"gaussianNoise",function(){return lo}),n.d(s,"gaussianDropout",function(){return co}),n.d(s,"alphaDropout",function(){return ho}),n.d(s,"masking",function(){return fo});var o={};n.r(o),n.d(o,"binaryAccuracy",function(){return po}),n.d(o,"binaryCrossentropy",function(){return mo}),n.d(o,"sparseCategoricalAccuracy",function(){return go}),n.d(o,"categoricalAccuracy",function(){return yo}),n.d(o,"categoricalCrossentropy",function(){return vo}),n.d(o,"precision",function(){return bo}),n.d(o,"recall",function(){return xo}),n.d(o,"cosineProximity",function(){return wo}),n.d(o,"meanAbsoluteError",function(){return To}),n.d(o,"meanAbsolutePercentageError",function(){return So}),n.d(o,"MAPE",function(){return Eo}),n.d(o,"mape",function(){return Oo}),n.d(o,"meanSquaredError",function(){return Co}),n.d(o,"MSE",function(){return _o}),n.d(o,"mse",function(){return Ao});var a={};n.r(a),n.d(a,"modelFromJSON",function(){return Kn});var u={};n.r(u),n.d(u,"l1l2",function(){return ko}),n.d(u,"l1",function(){return Ro}),n.d(u,"l2",function(){return Io});var l=n(0);let c;function h(){return null==c&&(c=Object(l.backend)().epsilon()),c}class d extends Error{constructor(t){super(t),Object.setPrototypeOf(this,d.prototype)}}class f extends Error{constructor(t){super(t),Object.setPrototypeOf(this,f.prototype)}}class p extends Error{constructor(t){super(t),Object.setPrototypeOf(this,p.prototype)}}class m extends Error{constructor(t){super(t),Object.setPrototypeOf(this,m.prototype)}}class g extends Error{constructor(t){super(t),Object.setPrototypeOf(this,g.prototype)}}function y(t,e){if(Array.isArray(t)){let n=[];for(let i=0;i<e;i++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function v(t,e){if(!t)throw new g(e)}function b(t,e){let n=0;for(const i of t)i===e&&n++;return n}function x(t){return 1===t.length?t[0]:t}function w(t){return Array.isArray(t)?t:[t]}function T(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function S(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}Error;let E={};function O(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function C(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach(t=>C(t));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"==typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!=typeof e.value?C(e):t[n]=e.value)}}}function _(t,e={},n={},i="object",r=!1){if("string"==typeof t){const r=t;let s;if(r in n)s=n[r];else if(r in E)s=E[r];else if(s=e[r],null==s)throw new p(`Unknown ${i}: ${t}. This may be due to one of the following reasons:\n1. The ${i} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${i} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return s}{const s=t;if(null==s.className||null==s.config)throw new p(i+": Improper config format: "+JSON.stringify(s)+".\n'className' and 'config' must set.");const o=s.className;let a,u;if(o in n?[a,u]=n[o]:o in E?[a,u]=E.className:o in e&&([a,u]=e[o]),null==a)throw new p(`Unknown ${i}: ${o}. This may be due to one of the following reasons:\n1. The ${i} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${i} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=u){const t={};for(const n of Object.keys(E))t[n]=E[n];for(const r of Object.keys(n))t[r]=n[r];s.config.customObjects=t;const e=Object.assign({},E);for(const r of Object.keys(n))E[r]=n[r];C(s.config);const i=u(a,s.config,n,r);return E=Object.assign({},e),i}{const t=Object.assign({},E);for(const i of Object.keys(n))E[i]=n[i];const e=new a(s.config);return E=Object.assign({},t),e}}}function A(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function k(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function R(t){if(null==t)throw new p("Invalid value in obj: "+JSON.stringify(t));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function I(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new p(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function M(t,e,n=0,i=1/0){return v(n>=0),v(i>=n),Array.isArray(t)&&t.length>=n&&t.length<=i&&t.every(t=>typeof t===e)}function N(t,e){Array.isArray(t)?(l.util.assert(t.length>0,()=>e+" is unexpectedly an empty array."),t.forEach((t,n)=>N(t,`element ${n+1} of ${e}`))):l.util.assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+D(t)+".")}function D(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>D(t)).join(",")+"]":"string"==typeof t?`"${t}"`:""+t}function P(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function F(t,e){return Object(l.tidy)(()=>l.sqrt(l.sum(l.mul(t,t),e,!0)))}class L extends l.serialization.Serializable{getConfig(){return{}}}class j extends L{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(l.tidy)(()=>{const e=F(t,this.axis),n=l.clipByValue(e,0,this.maxValue);return l.mul(t,l.div(n,l.add(h(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}j.className="MaxNorm",l.serialization.registerClass(j);class B extends L{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(l.tidy)(()=>l.div(t,l.add(h(),F(t,this.axis))))}getConfig(){return{axis:this.axis}}}B.className="UnitNorm",l.serialization.registerClass(B);class z extends L{apply(t){return l.relu(t)}}z.className="NonNeg",l.serialization.registerClass(z);class $ extends L{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(l.tidy)(()=>{const e=F(t,this.axis),n=l.add(l.mul(this.rate,l.clipByValue(e,this.minValue,this.maxValue)),l.mul(1-this.rate,e));return l.mul(t,l.div(n,l.add(h(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}$.className="MinMaxNorm",l.serialization.registerClass($);const U={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function W(t){return O(t)}function V(t,e={}){return _(t,l.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function Y(t){return null==t?null:"string"==typeof t?V({className:t in U?U[t]:t,config:{}}):t instanceof L?t:V(t)}function G(t){return new j(t)}function X(t){return new B(t)}function H(){return new z}function q(t){return new $(t)}const K=["channelsFirst","channelsLast"],J=["valid","same","causal"],Q=["max","avg"],Z=["sum","mul","concat","ave"],tt=new Map;function et(t){I(K,"DataFormat",t)}function nt(t){I(J,"PaddingMode",t)}function it(t){I(Q,"PoolMode",t)}const rt=[];function st(t,e){rt.push(t);try{const t=e();return rt.pop(),t}catch(n){throw rt.pop(),n}}function ot(t){if(!lt(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===rt.length?"":rt.join("/")+"/")+t}function at(t){if(!lt(t))throw new Error("Not a valid tensor name: '"+t+"'");tt.has(t)||tt.set(t,0);const e=tt.get(t);if(tt.set(t,tt.get(t)+1),e>0){const n=`${t}_${e}`;return tt.set(n,1),n}return t}const ut=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function lt(t){return!!t.match(ut)}function ct(t){return t===parseInt(t.toString(),10)}function ht(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let i=1;for(let r=e;r<n;++r)i*=t[r];return i}function dt(t){return t=Array.isArray(t)?new Float32Array(t):t,Object(l.tensor1d)(t)}function ft(t){return l.min(dt(t)).dataSync()[0]}function pt(t){return l.max(dt(t)).dataSync()[0]}function mt(t,e){if(e<t)throw new p(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let i=t;i<e;++i)n.push(i);return n}function gt(t,e){return t.asType(e)}function yt(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function vt(t,e,n){return Object(l.tidy)(()=>{switch(t.rank){case 1:return l.slice1d(t,e,n);case 2:return l.slice2d(t,[e,0],[n,t.shape[1]]);case 3:return l.slice3d(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return l.slice4d(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return l.slice(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return l.slice(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new p("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function bt(t,e,n){return Object(l.tidy)(()=>{switch(t.rank){case 1:return l.slice1d(t,e,n);case 2:return l.slice2d(t,[0,e],[t.shape[0],n]);case 3:return l.slice3d(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return l.slice4d(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new p("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function xt(t,e,n,i){return Object(l.tidy)(()=>{switch(t.rank){case 1:return l.slice1d(t,e,n);case 2:switch(i){case 1:return vt(t,e,n);case 2:return bt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+i)}case 3:switch(i){case 1:return vt(t,e,n);case 2:return l.slice3d(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return bt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+i)}case 4:switch(i){case 1:return vt(t,e,n);case 2:return l.slice4d(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return l.slice4d(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return bt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+i)}default:throw new p("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function wt(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),l.concat(t,e)}function Tt(t,e){switch(t.rank){case 1:return l.concat1d([t,e]);case 2:return l.concat2d([t,e],0);case 3:return l.concat3d([t,e],0);case 4:return l.concat4d([t,e],0);default:throw new p("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function St(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new p(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return l.tile(t,e)}function Et(t,e=0,n=1,i,r){return l.randomNormal(t,e,n,i,r)}function Ot(t,e,n,i){if(t.rank<2||e.rank<2)throw new m(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3&&t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new m(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = `+e.shape);if(2===t.rank&&2===e.rank)return l.fused.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:i?At(t.rank,i,"channelsLast"):null,activation:n});{const r=t.shape.slice(),s=r.pop();t=t.reshape([-1,s]);const o=e.shape.slice(),a=o.pop(),u=o.pop(),c=[...o,a],h=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=e.transpose(h).reshape([u,-1]);const d=[...r,...c];return l.fused.matMul({a:t,b:e,transposeA:!1,transposeB:!1,bias:i?At(t.rank,i,"channelsLast"):null,activation:n}).reshape(d)}}function Ct(t,e,n){return Object(l.tidy)(()=>(e=Array.isArray(e)?Object(l.tensor1d)(e,"int32"):e.toInt(),l.gather(t,e,n)))}function _t(t){return l.mul(t,t)}function At(t,e,n){const i=e.shape;if(1!==e.rank&&e.rank!==t)throw new p("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return e.reshape(1===i.length?[1,i[0],1,1,1]:[1,i[3],i[0],i[1],i[2]]);if("channelsLast"===n)return e.reshape(1===i.length?[1,1,1,1,i[0]]:[1].concat(i))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===i.length?[1,i[0],1,1]:[1,i[2],i[0],i[1]]);if("channelsLast"===n)return e.reshape(1===i.length?[1,1,1,i[0]]:[1].concat(i))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===i.length?[1,i[0],1]:[1,i[1],i[0]]);if("channelsLast"===n)return e.reshape(1===i.length?[1,1,i[0]]:[1].concat(i))}else if(t<3)return e;throw new p("Unsupported input rank by biasAdd: "+e.rank)}function kt(t,e,n){return Object(l.tidy)(()=>(null==n&&(n="channelsLast"),et(n),t.add(At(t.rank,e,n))))}function Rt(t,e,n,i){return Object(l.tidy)(()=>l.dropout(t,e,n,i))}function It(t,e,n=!1){return n?t():e()}const Mt=["fanIn","fanOut","fanAvg"],Nt=["normal","uniform","truncatedNormal"];class Dt extends l.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Pt extends Dt{apply(t,e){return Object(l.zeros)(t,e)}}Pt.className="Zeros",l.serialization.registerClass(Pt);class Ft extends Dt{apply(t,e){return Object(l.ones)(t,e)}}Ft.className="Ones",l.serialization.registerClass(Ft);class Lt extends Dt{constructor(t){if(super(),"object"!=typeof t)throw new p("Expected argument of type ConstantConfig but got "+t);if(void 0===t.value)throw new p("config must have value set but got "+t);this.value=t.value}apply(t,e){return Object(l.tidy)(()=>Object(l.mul)(Object(l.scalar)(this.value),Object(l.ones)(t,e)))}getConfig(){return{value:this.value}}}Lt.className="Constant",l.serialization.registerClass(Lt);class jt extends Dt{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Object(l.randomUniform)(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}jt.className="RandomUniform",l.serialization.registerClass(jt);class Bt extends Dt{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m(`randomNormal does not support dType ${e}.`);return Et(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Bt.className="RandomNormal",l.serialization.registerClass(Bt);class zt extends Dt{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m(`truncatedNormal does not support dType ${e}.`);return Object(l.truncatedNormal)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zt.className="TruncatedNormal",l.serialization.registerClass(zt);class $t extends Dt{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return Object(l.tidy)(()=>{if(2!==t.length||t[0]!==t[1])throw new p("Identity matrix initializer can only be used for 2D square matrices.");return Object(l.mul)(this.gain,Object(l.eye)(t[0]))})}getConfig(){return{gain:this.gain}}}$t.className="Identity",l.serialization.registerClass($t);class Ut extends Dt{constructor(t){if(super(),t.scale<0)throw new p("scale must be a positive float. Got: "+t.scale);this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,I(Mt,"FanMode",this.mode),this.distribution=null==t.distribution?"normal":t.distribution,I(Nt,"Distribution",this.distribution),this.seed=t.seed}apply(t,e){const n=function(t,e="channelsLast"){let n,i;if(et(e),2===t.length)n=t[0],i=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=ht(t,2);n=t[1]*e,i=t[0]*e}else if("channelsLast"===e){const e=ht(t,0,t.length-2);n=t[t.length-2]*e,i=t[t.length-1]*e}}else{const e=ht(t);n=Math.sqrt(e),i=Math.sqrt(e)}return[n,i]}(t),i=n[0],r=n[1];let s=this.scale;if(s/="fanIn"===this.mode?Math.max(1,i):"fanOut"===this.mode?Math.max(1,r):Math.max(1,(i+r)/2),"normal"===this.distribution){const n=Math.sqrt(s);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m(`${this.getClassName()} does not support dType ${e}.`);return Object(l.truncatedNormal)(t,0,n,e,this.seed)}{const n=Math.sqrt(3*s);return Object(l.randomUniform)(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Ut.className="VarianceScaling",l.serialization.registerClass(Ut);class Wt extends Ut{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Wt.className="GlorotUniform",l.serialization.registerClass(Wt);class Vt extends Ut{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Vt.className="GlorotNormal",l.serialization.registerClass(Vt);class Yt extends Ut{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Yt.className="HeNormal",l.serialization.registerClass(Yt);class Gt extends Ut{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Gt.className="HeUniform",l.serialization.registerClass(Gt);class Xt extends Ut{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Xt.className="LeCunNormal",l.serialization.registerClass(Xt);class Ht extends Ut{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Ut.className}}Ht.className="LeCunNormal",l.serialization.registerClass(Ht);class qt extends Dt{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new m("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return Object(l.tidy)(()=>{if(2!==t.length)throw new m("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const e=Et(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=l.linalg.gramSchmidt(e);return t[0]>t[1]&&(n=n.transpose()),Object(l.mul)(this.gain,n)})}getConfig(){return{gain:this.gain,seed:this.seed}}}qt.className="Orthogonal",l.serialization.registerClass(qt);const Kt={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Jt(t,e={}){return _(t,l.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function Qt(t){return O(t)}function Zt(t){if("string"==typeof t){const e=t in Kt?Kt[t]:t;if("GlorotNormal"===e)return new Vt;if("GlorotUniform"===e)return new Wt;if("HeNormal"===e)return new Yt;if("HeUniform"===e)return new Gt;if("LeCunNormal"===e)return new Xt;if("LeCunUniform"===e)return new Ht;{const t={};return t.className=e,t.config={},Jt(t)}}return t instanceof Dt?t:Jt(t)}function te(){return new Pt}function ee(){return new Ft}function ne(t){return new Lt(t)}function ie(t){return new jt(t)}function re(t){return new Bt(t)}function se(t){return new zt(t)}function oe(t){return new $t(t)}function ae(t){return new Ut(t)}function ue(t){return new Wt(t)}function le(t){return new Vt(t)}function ce(t){return new Yt(t)}function he(t){return new Gt(t)}function de(t){return new Xt(t)}function fe(t){return new Ht(t)}function pe(t){return new qt(t)}let me=0;function ge(){return me++}const ye={};function ve(t=""){return t in ye||(ye[t]=0),ye[t]+=1,t+ye[t].toString()}function be(t){return Array.isArray(t)&&Array.isArray(t[0])}function xe(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function we(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new p("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function Te(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new p("Expected exactly 1 Shape; got "+t.length)}return t}function Se(t){let e=0;for(const n of t)e+=0===n.shape.length?1:n.shape.reduce((t,e)=>t*e);return e}class Ee{constructor(t,e="float32",n="Variable",i=!0,r=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=ge(),this.originalName=ot(n=null==n?"Variable":n),this.name=at(this.originalName),this.trainable_=i,this.constraint=r,this.val=l.variable(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function Oe(t){return t.map(t=>t.read())}function Ce(t){t.forEach(t=>{t[0].write(t[1])})}class _e{constructor(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Ae{constructor(t,e,n,i,r,s,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=i,this.callArgs=r,this.outputTensorIndex=o,this.id=ge(),null!=s&&(this.originalName=ot(s),this.name=at(this.originalName)),this.rank=e.length}}let ke=0;class Re{constructor(t,e){this.callArgs=e,this.id=ke++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)t.push(null!=e?e.name:null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Ie=0;class Me extends l.serialization.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Ie++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=T(t)+"_"+ve(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}this.initialWeights=null!=t.weights?t.weights:null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new f(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new p(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return x(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return x(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new d("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new d("Layer "+this.name+" is not connected, no input to return.");return x(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new d("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new d("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return x(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=w(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=w(this.inputSpec);if(t.length!==e.length)throw new p(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: `+t);for(let n=0;n<t.length;n++){const i=t[n],r=e[n];if(null==r)continue;const s=i.rank;if(null!=r.ndim&&s!==r.ndim)throw new p(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${r.ndim}, found ndim=${s}`);if(null!=r.maxNDim&&s>r.maxNDim)throw new p(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${r.maxNDim}, found ndim=${s}`);if(null!=r.minNDim&&s<r.minNDim)throw new p(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${r.minNDim}, found ndim=${s}.`);if(null!=r.dtype&&i.dtype!==r.dtype)throw new p(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${r.dtype}, found dtype=${i.dtype}.`);if(r.axes){const t=i.shape;for(const e in r.axes){const i=Number(e),s=r.axes[e],o=i>=0?t[i]:t[t.length+i];if(null!=s&&-1===[s,null].indexOf(o))throw new p(`Input ${n} is incompatible with layer ${this.name}: expected axis ${i} of input shape to have value ${s} but got shape ${t}.`)}}if(null!=r.shape)for(let t=0;t<r.shape.length;++t){const e=r.shape[t],s=i.shape[t];if(null!=e&&null!=s&&e!==s)throw new p(`Input ${n} is incompatible with layer ${this.name}: expected shape=${r.shape}, found shape=${i.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=w(t);let i=!0;for(const s of n)if(!(s instanceof Ae)){i=!1;break}let r=!0;for(const s of n)if(s instanceof Ae){r=!1;break}if(i===r)throw new p("Arguments to apply() must be all SymbolicTensors or all Tensors");return st(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of w(t))e.push(n.shape);this.build(x(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&r&&(this._refCount=1)}if(this.assertInputCompatibility(t),r){let i=this.call(t,e);const r=w(i),s=[];for(let t of r)-1!==n.indexOf(t)&&(t=t.clone()),s.push(t);if(i=x(s),null!=this.activityRegularizer)throw new m("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}{const n=function(t){t=w(t);const e=[];for(const n of t)e.push(n.shape);return x(e)}(t),i=this.computeOutputShape(n);let r;const s="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),r=null!=i&&i.length>0&&Array.isArray(i[0])?i.map((n,i)=>new Ae(s,n,this,w(t),e,this.name,i)):new Ae(s,i,this,w(t),e,this.name),this.addInboundNode(t,r,null,null,n,i,e),this._refCount++,null!=this.activityRegularizer)throw new m("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the "+`batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer `+this.name);else{let e=!1;this.batchInputShape.forEach((n,i)=>{null!=n&&null!=t[i]&&t[i]!==n&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: `+JSON.stringify(this.batchInputShape))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new d(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new d(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new f(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Se(this.weights)}build(t){this.built=!0}getWeights(t=!1){return Oe(t?this.trainableWeights:this.weights)}setWeights(t){Object(l.tidy)(()=>{const e=this.weights;if(e.length!==t.length)throw new p(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],i=Oe(e);for(let r=0;r<i.length;++r){const s=i[r],o=e[r],a=t[r];if(!l.util.arraysEqual(s.shape,a.shape))throw new p(`Layer weight shape ${s.shape} not compatible with provided weight shape `+a.shape);n.push([o,a])}Ce(n)})}addWeight(t,e,n,i,r,s,o){if(-1!==this._addedWeightNames.indexOf(t))throw new p(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(i=Zt("zeros"));const a=i.apply(e,n),u=new Ee(a,n,t,s,o);return a.dispose(),null!=r&&this.addLoss(()=>r.apply(u.read())),null==s&&(s=!0),s?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=w(t),null!=this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}addInboundNode(t,e,n,i,r,s,o=null){const a=w(t);e=w(e),n=w(n),i=w(i),r=xe(r),s=xe(s);const u=[],l=[],c=[];for(const h of a)u.push(h.sourceLayer),l.push(h.nodeIndex),c.push(h.tensorIndex);new Re({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:a,outputTensors:e,inputMasks:n,outputMasks:i,inputShapes:r,outputShapes:s},o);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Ne(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const i=Ne(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of i)-1===e.indexOf(t)&&e.push(t)}return e}}}class De extends Me{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:ve("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new p("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new p("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new p("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const i=new Ae(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new Re({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new p("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function Pe(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new p("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;return null==n&&(n="float32"),new De({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}async function Fe(t){if(null==t)return;const e=[],n=[],i=[];for(const r in t){const s=t[r];if("number"!=typeof s){const t=s;e.push(t.data()),n.push(r),i.push(t)}}if(e.length>0){const r=await Promise.all(e);for(let e=0;e<r.length;++e)t[n[e]]=r[e][0];Object(l.dispose)(i)}}function Le(t){if(null!=t)for(const e in t){const n=t[e];"number"!=typeof n&&n.dispose()}}var je;De.className="InputLayer",l.serialization.registerClass(De),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(je||(je={}));class Be{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class ze{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class $e extends Be{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const i in e){const t=e[i];if("number"==typeof t)this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+t*n;else{let e;i in this.totals?e=this.totals[i]:this.totals[i]=0;const r=Object(l.tidy)(()=>Object(l.add)(this.totals[i],Object(l.mul)(t,n)));this.totals[i]=r,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"==typeof this.totals[n]?e[n]=this.totals[n]/this.seen:Object(l.tidy)(()=>{const t=Object(l.mul)(Object(l.div)(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),Object(l.keep)(e[n])}))}}class Ue extends Be{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const r in this.history){const i=this.history[r];for(let s=0;s<i.length;++s)"number"!=typeof i[s]&&(t.push(i[s].data()),e.push(r),n.push(s))}const i=await Promise.all(t);for(let r=0;r<i.length;++r)this.history[e[r]][n[r]].dispose(),this.history[e[r]][n[r]]=i[r][0]}}class We extends Be{constructor(t,e){if(super(),this.currentEpoch=0,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");l.util.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e){let n,i=l.util.now();return(...r)=>{const s=l.util.now();return s-i<e||(i=s,n=t(...r)),n}}(this.maybeWait.bind(this),this.yieldEvery)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const i=[];null!=this.yield&&(await Fe(n),i.push(this.yield(t,e,n))),i.push(Object(l.nextFrame)()),await Promise.all(i)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Fe(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Fe(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(Object(l.nextFrame)()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Fe(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Fe(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(Object(l.nextFrame)()):l.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Fe(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Fe(t),await this.trainEnd(t))}}function Ve(t,e){return null==t&&(t={}),t instanceof Be?[t]:Array.isArray(t)&&t[0]instanceof Be?t:w(t).map(t=>new We(t,e))}class Ye{constructor(){}static registerCallbackConstructor(t,e){l.util.assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got "+t),Ye.checkForDuplicate(e),null==Ye.constructors[t]&&(Ye.constructors[t]=[]),Ye.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Ye.constructors)Ye.constructors[+e].forEach(e=>{if(e===t)throw new p("Duplicate callback constructor.")})}static clear(){Ye.constructors={}}static createCallbacks(t){const e=[];for(const n in Ye.constructors){const i=+n;t>=i&&e.push(...Ye.constructors[i])}return e.map(t=>new t)}}function Ge(t,e,n,i,r,s,o,a,u){const l=new Ue,c=[new $e,...Ye.createCallbacks(e)];null!=t&&c.push(...t),c.push(l);const h=new ze(c);return h.setParams({epochs:n,initialEpoch:i,samples:r,steps:s,batchSize:o,verbose:e,doValidation:a,metrics:u}),{callbackList:h,history:l}}function Xe(t,e={},n=!1){return _(t,l.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}function He(t,e){return Object(l.tidy)(()=>{"float32"!==t.dtype&&(t=t.asType("float32"));const n=l.sum(_t(t),e,!0),i=l.fill(n.shape,h()),r=l.sqrt(l.maximum(n,i));return l.div(t,r)})}function qe(t,e){return Object(l.tidy)(()=>l.mean(_t(l.sub(e,t)),-1))}function Ke(t,e){return Object(l.tidy)(()=>l.mean(l.abs(l.sub(e,t)),-1))}function Je(t,e){return Object(l.tidy)(()=>{const n=l.sub(t,e),i=l.clipByValue(l.abs(t),h(),Number.MAX_VALUE),r=l.abs(l.div(n,i));return l.mul(100,l.mean(r,-1))})}function Qe(t,e,n=!1){return Object(l.tidy)(()=>{if(n)e=l.softmax(e);else{const t=l.sum(e,e.shape.length-1,!0);e=l.div(e,t)}return e=l.clipByValue(e,h(),1-h()),l.neg(l.sum(l.mul(t.toFloat(),l.log(e)),e.shape.length-1))})}function Ze(t,e,n=!1){return Object(l.tidy)(()=>{const i=l.floor(function(t){const e=[ht(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=l.clipByValue(e,h(),1-h())).shape;return Qe(l.oneHot(i,r[r.length-1]).reshape(r),e,n)})}function tn(t,e){return Object(l.tidy)(()=>{let n;return n=l.clipByValue(e,h(),1-h()),n=l.log(l.div(n,l.sub(1,n))),l.mean(function(t,e){if(!l.util.arraysEqual(t.shape,e.shape))throw new p(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Object(l.tidy)(()=>{const n=e.relu(),i=e.abs().neg();return n.sub(e.mul(t)).add(i.exp().log1p())})}(t,n),-1)})}function en(t,e){return Object(l.tidy)(()=>{const n=He(t,-1),i=He(e,-1),r=l.mul(n,i);return l.neg(l.sum(r,-1))})}Ye.constructors={};const nn={meanSquaredError:qe,meanAbsoluteError:Ke,meanAbsolutePercentageError:Je,meanSquaredLogarithmicError:function(t,e){return Object(l.tidy)(()=>{const n=l.clipByValue(e,h(),Number.MAX_VALUE),i=l.log(l.add(1,n)),r=l.clipByValue(t,h(),Number.MAX_VALUE),s=l.log(l.add(1,r));return l.mean(_t(l.sub(i,s)),-1)})},squaredHinge:function(t,e){return Object(l.tidy)(()=>{const n=l.maximum(0,l.sub(1,l.mul(t,e)));return l.mean(_t(n),-1)})},hinge:function(t,e){return Object(l.tidy)(()=>{const n=l.maximum(0,l.sub(1,l.mul(t,e)));return l.mean(n,-1)})},categoricalHinge:function(t,e){return Object(l.tidy)(()=>{const n=l.sum(l.mul(t,e),-1),i=l.max(l.mul(l.sub(1,t),e),-1);return l.maximum(0,l.add(1,l.sub(i,n)))})},logcosh:function(t,e){return Object(l.tidy)(()=>{const n=Math.log(2),i=l.sub(e,t),r=l.sub(l.add(i,l.softplus(l.mul(-2,i))),n);return l.mean(r,-1)})},categoricalCrossentropy:Qe,sparseCategoricalCrossentropy:Ze,binaryCrossentropy:tn,kullbackLeiblerDivergence:function(t,e){return Object(l.tidy)(()=>{const n=l.clipByValue(t,h(),1),i=l.clipByValue(e,h(),1);return l.sum(l.mul(t,l.log(l.div(n,i))),-1)})},poisson:function(t,e){return Object(l.tidy)(()=>{const n=l.log(l.add(h(),e));return l.mean(l.sub(e,l.mul(t,n)),-1)})},cosineProximity:en};function rn(t){if("string"==typeof t){if(t in nn)return nn[t];let e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new p(e)}return t}function sn(t,e){return Object(l.tidy)(()=>{const n=l.mul(.5,l.onesLike(e)),i=gt(l.greater(e,n),t.dtype);return l.mean(l.equal(t,i),-1)})}function on(t,e){return Object(l.tidy)(()=>gt(l.equal(l.argMax(t,-1),l.argMax(e,-1)),"float32"))}function an(t,e){return Object(l.tidy)(()=>l.logicalAnd(t.equal(1),e.equal(1)).sum().cast("float32"))}function un(t,e){return Object(l.tidy)(()=>{const n=an(t,e),i=function(t,e){return Object(l.tidy)(()=>l.logicalAnd(t.equal(0),e.equal(1)).sum().cast("float32"))}(t,e),r=n.add(i);return l.where(l.greater(r,0),n.div(r),0).cast("float32")})}function ln(t,e){return tn(t,e)}function cn(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),l.equal(t,e).asType("float32")}const hn=Qe,dn=Ze,fn={binaryAccuracy:sn,categoricalAccuracy:on,precision:un,categoricalCrossentropy:hn,sparseCategoricalCrossentropy:dn,mse:qe,MSE:qe,mae:Ke,MAE:Ke,mape:Je,MAPE:Je,cosine:en};function pn(t){if("string"==typeof t&&t in fn)return fn[t];if("string"!=typeof t&&null!=t)return t;throw new p("Unknown metric "+t)}function mn(t){if(v(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;{let e;for(const n of Object.keys(nn))if(nn[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(fn))if(fn[n]===t){e=n;break}return void 0!==e?e:t.name}}function gn(t,e,n=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!yn(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function yn(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!=typeof n)return!1;if(!yn(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!yn(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function vn(t,e,n=console.log){let i="";for(let r=0;r<t.length;++r)r>0&&(i=i.slice(0,i.length-1)+" "),i+=t[r],i=i.slice(0,e[r]),i+=" ".repeat(e[r]-i.length);n(i)}function bn(t,e,n){let i;try{i=JSON.stringify(t.outputShape)}catch(r){i="multiple"}vn([`${t.name} (${t.getClassName()})`,i,t.countParams().toString()],e,n)}function xn(t,e,n,i){let r;try{r=JSON.stringify(t.outputShape)}catch(l){r="multiple"}const s=[];for(const c of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(let t=0;t<c.inboundLayers.length;++t)s.push(`${c.inboundLayers[t].name}[${c.nodeIndices[t]}][${c.tensorIndices[t]}]`);const o=t.name,a=t.getClassName(),u=0===s.length?"":s[0];vn([`${o} (${a})`,r,t.countParams().toString(),u],e,i);for(let c=1;c<s.length;++c)vn(["","","",s[c]],e,i)}function wn(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function Tn(t,e){if(null===t)return null;if("string"==typeof t)return S(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],i=t.length;for(let r=0;r<i;++r){const i=t[r];wn(e,r,i)?n.push(i):n.push(Tn(i,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n];if("name"===n&&"string"==typeof i)e[n]=i;else{const t=S(n);e[t]=Tn(i,t)}}return e}}function Sn(t,e){if(null==t)return null;if("string"==typeof t)return T(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],i=t.length;for(let r=0;r<i;++r){const i=t[r];wn(e,r,i)?n.push(i):n.push(Sn(i,e))}return n}{const e={};for(const n of Object.keys(t)){const i=t[n];e[T(n)]="name"!==n&&"className"!==n||"string"!=typeof i?Sn(i,n):i}return e}}const En="2.0.1";class On{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof On)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new p(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Object(l.cast)(e,t.dtype)}catch(n){throw new p(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Ae){if(null==this.id2Value[t.id])throw new p("Nonexistent key: "+t.name);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new p("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]}}getMask(t){if(t instanceof Ae){if(null==this.id2Value[t.id])throw new p("Nonexistent key: "+t.name);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new p("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Object(l.dispose)(this.id2Mask)}}const Cn={},_n={};function An(t,e,n,i){const r=null!=n&&n.training,s=Array.isArray(t),o=s?t:[t],a=o.map(t=>t.name),u=[],c=e.names();for(const l of a)-1!==c.indexOf(l)?u.push(e.getValue(l)):u.push(null);null!=i&&(i.maxNumTensors=-1/0,i.minNumTensors=1/0);const h=a.join(",")+"|"+e.names().join(",");let d,f;if(null==Cn[h]){const t=function(t,e){l.util.assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],i={};if(1===t.length){const r=Rn(t[0],e);n=r.sorted,i=r.recipientMap}else{const r=new Set;for(const s of t){const{sorted:t,recipientMap:o}=Rn(s,e);for(const e of t)r.has(e.name)||(n.push(e),r.add(e.name));for(const e in o)null==i[e]&&(i[e]=new Set),o[e].forEach(t=>i[e].add(t))}}return{sorted:n,recipientCounts:kn(i)}}(o,e);d=t.sorted,f=t.recipientCounts,Cn[h]=d,_n[h]=f}d=Cn[h],f={},r||Object.assign(f,_n[h]);const p=new On(e);for(let m=0;m<d.length;++m){if(null!=i){const t=Object(l.memory)().numTensors;t>i.maxNumTensors&&(i.maxNumTensors=t),t<i.minNumTensors&&(i.minNumTensors=t)}const t=d[m],s=t.sourceLayer;if(s instanceof De)continue;const o=[],c=[],h=[];let g=!1;for(const n of t.inputs){const t=p.getValue(n),i=p.getMask(n);o.push(t),c.push(i),null!=i&&(g=!0),r||(f[n.name]--,0!==f[n.name]||e.hasKey(n)||-1!==a.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||h.push(t))}g&&((n=n||{}).mask=c[0]);const y=w(s.apply(o,n));let v=null;s.supportsMasking&&(v=s.computeMask(o,c));const b=In(t),x=Array.isArray(b)?b:[b];for(let e=0;e<x.length;++e){p.hasKey(x[e])||p.add(x[e],y[e],Array.isArray(v)?v[0]:v);const t=a.indexOf(x[e].name);-1!==t&&(u[t]=y[e])}r||Object(l.dispose)(h)}return p.disposeMasks(),s?u:u[0]}function kn(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Rn(t,e){const n=new Set,i=[],r={};for(const a of e.names())n.add(a);const s=[],o=[];for(s.push(t);s.length>0;){const t=s[s.length-1];if(n.has(t.name)){s.pop();continue}const e=o[o.length-1]===s.length-1;if(0===t.inputs.length||e)s.pop(),i.push(t),n.add(t.name),e&&o.pop();else{o.push(s.length-1);for(const e of t.inputs)null==r[e.name]&&(r[e.name]=new Set),r[e.name].add(t.name),n.has(e.name)||s.push(e)}}return{sorted:i,recipientMap:r}}function In(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const i of t.sourceLayer.inboundNodes[e].outputTensors)if(i.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}class Mn extends Me{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=ve(t)}if(this.supportsMasking=!1,this.trainable_=!0,this.inputs=Array.isArray(t.inputs)?t.inputs.slice():[t.inputs],this.outputs=Array.isArray(t.outputs)?t.outputs.slice():[t.outputs],k(this.inputs).length!==this.inputs.length)throw new p("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+this.inputs.map(t=>t.name));k(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+this.outputs.map(t=>t.name)),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const f of this.outputs){const t=f.nodeIndex,e=f.tensorIndex;this.outputLayers.push(f.sourceLayer),this.outputLayersNodeIndices.push(t),this.outputLayersTensorIndices.push(e)}for(const f of this.inputs){const t=f.sourceLayer,e=f.nodeIndex,n=f.tensorIndex;v(0===e,"input layer has >1 nodes"),v(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let f=0;f<this.inputLayers.length;f++){const e=this.inputLayers[f];if(!(e instanceof De))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${f} (0-based) originates from layer type ${e.getClassName()}.`);this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const f of this.outputLayers)this.outputNames.push(f.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},i={},r={},s={},o=[],a=(t,e,n,i,r,u)=>{null!=i&&null!=r&&null!=u||(i=t.sourceLayer,r=t.nodeIndex,u=t.tensorIndex);const l=i.inboundNodes[r];if(-1!==n.indexOf(l))throw new f(`The tensor ${t.name} at layer "${i.name}" is part of a cycle.`);if(-1!==e.indexOf(l))return;this.containerNodes.add(Mn.nodeKey(i,r)),i.id in s||(s[i.id]=Object.keys(s).length),-1===n.indexOf(l)&&n.push(l);const c=l.inboundLayers.length;for(let s=0;s<c;s++)a(l.inputTensors[s],e,n,l.inboundLayers[s],l.nodeIndices[s],l.tensorIndices[s]);for(e.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);o.push(l)},u=[],l=[];for(const f of this.outputs)a(f,u,l);const c=o.slice().reverse();for(const f of c){n[f.id]=f,f.id in e||(e[f.id]=0);let t=e[f.id];t=Math.max(t,null==i[f.outboundLayer.id]?0:i[f.outboundLayer.id]),i[f.outboundLayer.id]=t,r[f.outboundLayer.id]=f.outboundLayer,e[f.id]=t;for(let i=0;i<f.inboundLayers.length;i++){const r=f.inboundLayers[i].inboundNodes[f.nodeIndices[i]];e[r.id]=Math.max(t+1,null==e[r.id]?0:e[r.id]),n[r.id]=r}}const h={};for(const f in e){const t=e[f];t in h||(h[t]=[]),h[t].push(n[f])}const d={};for(const f in i){const t=i[f];t in d||(d[t]=[]),d[t].push(r[f])}let m=Object.keys(d).map(t=>parseInt(t,10)).sort(A);this.layers=[];for(const f of m){const t=d[f];t.sort((t,e)=>{const n=s[t.id],i=s[e.id];return n<i?-1:n>i?1:0});for(const e of t)e instanceof Mn&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,m=Object.keys(h).map(t=>parseInt(t,10)).sort(A);const g=this.inputs.slice(),y=[];for(const p of m)for(const t of h[p]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===g.indexOf(n))throw new f("Graph disconnected: cannot obtain value for tensor "+n+` at layer "${e.name}". The following previous layers were accessed without issue: `+y);for(const e of t.outputTensors)g.push(e);y.push(e.name)}}this.nodesByDepth=h;const b=this.layers.map(t=>t.name);for(const p of b){const t=b.filter(t=>t===p).length;if(1!==t)throw new f(`The name "${p}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(b))}this.outboundNodes=[],this.inboundNodes=[],new Re({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new p("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let i=0;for(const s of this.layers)for(const t of s.weights){if(null!=n[t.originalName])throw new p("Duplicate weight name: "+t.originalName);n[t.originalName]=t,i++}const r=[];for(const s in t){let i=s;if(null==n[s]){const t=s.split("/");i=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[i])r.push([n[i],t[s]]);else if(e)throw new p("Provided weight data has no target variable: "+s);delete n[i]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new p(`${t.length} of ${i} weights are not set: `+t)}Ce(r)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers "+En,e.backend="TensorFlow.js",e}toJSON(t,e=!0){const n=Sn(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return Object(l.tidy)(()=>{t=w(t);const n=new On;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return An(this.outputs,n,e)})}computeMask(t,e){return Object(l.tidy)(()=>{let n;return t=w(t),n=null==e?y(null,t.length):w(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=xe(t);if(e.length!==this.inputLayers.length)throw new p(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let o=0;o<e.length;o++)n[this.inputLayers[o].name+"_0_0"]=e[o];const i=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(A);if(i.length>1)for(const o of i){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(t.id))continue;const i=[];for(let o=0;o<e.inboundLayers.length;o++)i.push(n[`${e.inboundLayers[o].name}_${e.nodeIndices[o]}_${e.tensorIndices[o]}`]);const r=xe(t.computeOutputShape(x(i))),s=t.inboundNodes.indexOf(e);for(let e=0;e<r.length;e++)n[`${t.name}_${s}_${e}`]=r[e]}}const r=[],s=[];for(let o=0;o<this.outputLayers.length;o++)s.push(`${this.outputLayers[o].name}_${this.outputLayersNodeIndices[o]}_${this.outputLayersTensorIndices[o]}`);for(let o=0;o<s.length;o++){const t=s[o];v(t in n),r.push(n[t])}return x(r)}runInternalGraph(t,e){null==e&&(e=y(null,t.length));const n={};for(let a=0;a<this.inputs.length;++a)n[this.inputs[a].id]=[t[a],e[a]];const i=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(A);for(const a of i){const t=this.nodesByDepth[a];for(const e of t){const t=e.outboundLayer,i=e.inputTensors,r=e.outputTensors,s=new Array;for(const e of i)e.id in n&&s.push(n[e.id]);if(s.length===i.length){let i,o,a,u,l={};if(null!=e.callArgs&&(l=e.callArgs),1===s.length){const[e,n]=s[0];null==l.mask&&(l.mask=n),a=w(t.call(e,l)),u=w(t.computeMask(e,n)),i=[e],o=[n]}else i=s.map(t=>t[0]),o=s.map(t=>t[1]),null==l.mask&&(l.mask=o),a=w(t.call(i,l)),u=w(t.computeMask(i,o));if(t.activityRegularizer)throw new m("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<r.length;++t)n[r[t].id]=[a[t],u[t]]}}}const r=[],s=[],o=[];for(const a of this.outputs){v(a.id in n,`Could not compute output ${a.name} : ${a.id}`);const[t,e]=n[a.id];o.push(t.shape),r.push(t),s.push(e)}return[r,s,o]}buildNodeConversionMap(t){const e={};let n;for(const i of this.layers){n=i instanceof Mn?1:0;for(let t=0;t<i.inboundNodes.length;t++){const r=Mn.nodeKey(i,t);this.containerNodes.has(r)&&(e[r]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new p(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new p("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new p("No such layer: "+t)}calculateLosses(){return Object(l.tidy)(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const i=Mn.nodeKey(e,n);this.containerNodes.has(i)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const o of this.layers){const t=o.getClassName(),i=o.getConfig(),r=[];for(let n=0;n<o.inboundNodes.length;n++){const t=o.inboundNodes[n],i=Mn.nodeKey(o,n);let a={};if(this.containerNodes.has(i)){if(t.callArgs)try{JSON.stringify(t.callArgs),a=t.callArgs}catch(s){console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: `+t.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),a={}}if(t.inboundLayers.length>0){const n=[];for(let i=0;i<t.inboundLayers.length;i++){const r=t.inboundLayers[i],s=t.tensorIndices[i];let o=e[Mn.nodeKey(r,t.nodeIndices[i])];null==o&&(o=0),n.push([r.name,o,s,a])}r.push(n)}}}const a={};a.name=o.name,a.className=t,a.config=i,a.inboundNodes=r,n.push(a)}t.layers=n;const i=[];for(let o=0;o<this.inputLayers.length;o++){const t=this.inputLayers[o],n=Mn.nodeKey(t,this.inputLayersNodeIndices[o]);if(!this.containerNodes.has(n))continue;let r=e[n];null==r&&(r=0),i.push([t.name,r,this.inputLayersTensorIndices[o]])}t.inputLayers=i;const r=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],n=Mn.nodeKey(t,this.outputLayersNodeIndices[o]);if(!this.containerNodes.has(n))continue;let i=e[n];null==i&&(i=0),r.push([t.name,i,this.outputLayersTensorIndices[o]])}return t.outputLayers=r,t}static fromConfig(t,e,n={},i=!1){const r={},s={};function o(t,e){t.name in s?s[t.name].push(e):s[t.name]=[e]}function a(t,e){const n=[];let i;for(const s of e){const a=s[0],u=s[1],l=s[2];if(i=null==s[3]?{}:s[3],!(a in r))return void o(t,e);const c=r[a];if(c.inboundNodes.length<=u)return void o(t,e);n.push(c.inboundNodes[u].outputTensors[l])}n.length>0&&t.apply(x(n),i)}function u(t){const n=t.name,s=Xe(t,null!=e.customObjects?e.customObjects:{});s.setFastWeightInitDuringBuild(i),r[n]=s,t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new p("Corrupted configuration, expected array for nodeData: "+t);o(s,t)})}const l=e.name,c=e.layers;for(const p of c)u(p);for(;!R(s);)for(const t of c){const e=r[t.name];if(e.name in s){const t=s[e.name];delete s[e.name];for(const n of t)a(e,n)}}const h=[],d=[],f=e.inputLayers;for(const p of f){const t=p[0],e=p[1],n=p[2];v(t in r),h.push(r[t].inboundNodes[e].outputTensors[n])}const m=e.outputLayers;for(const p of m){const t=p[0],e=p[1],n=p[2];v(t in r),d.push(r[t].inboundNodes[e].outputTensors[n])}return new t({inputs:h,outputs:d,name:l})}get stateful(){if(this._stateful)throw new p("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Object(l.tidy)(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function Nn(t,e){return function(t,e,n){const i=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===i)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==i)throw new Error(`Provided classWeight is an array of ${t.length} element(s), but the model has ${i} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{n.push(e in t?t[e]:null)}),n}throw new Error(`The model has multiple (${i}) outputs, so classWeight must be either an array with ${i} elements or an object with ${e} keys. Provided classWeight not understood: ${JSON.stringify(t)}`)}(t,e)}async function Dn(t,e,n,i){if(null!=e||null!=i)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=Object(l.tidy)(()=>{if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),i=Array.from(await e.data());Object(l.dispose)(e);const r=[];return i.forEach(t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);r.push(n[t])}),Object(l.tensor1d)(r,"float32")}return null}function Pn(t,e){return Object(l.mul)(t,e)}function Fn(t,e){let n,i;n=e.xs,i=e.ys,l.util.assert(null!=n&&null!=i,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e);const r=Ln("input",t.inputNames,n),s=Ln("output",t.outputNames,i),o=r[0].shape[0];l.util.assert(r.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: `+JSON.stringify(t.inputNames)+")"),l.util.assert(s.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: `+JSON.stringify(t.outputNames)+")");for(let a=0;a<r.length;a++)l.util.assert(r[a].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[a]} has ${r[a].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let a=0;a<s.length;a++)l.util.assert(s[a].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[a]} has ${s[a].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:r,ys:s}}function Ln(t,e,n){if(n instanceof l.Tensor)return[n];if(Array.isArray(n))return l.util.assert(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const i=[];for(const r of e){if(null==n[r])throw new p(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);i.push(n[r])}return i}}function jn(t){return"function"==typeof t.iterator}function Bn(t){l.util.assert(t>0&&Number.isInteger(t),()=>"batchSize is required to be a positive integer, but got "+t)}function zn(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>vt(t,e,n-e)):vt(t,e,n-e)}function $n(t,e){return l.tidy(()=>null==t?null:Array.isArray(t)?t.map(t=>$n(t,e)):Ct(t,"int32"===e.dtype?e:e.toInt()))}function Un(t,e){const n=[];let i=0,r=null;for(;i<t;)r=i+e,r>=t&&(r=t),n.push([i,r]),i=r;return n}function Wn(t){const e=[];t instanceof l.Tensor&&(t=[t]);for(let n=0;n<t.length;++n){const i=t[n];if(1===i.rank)e.push(yt(i,1));else{if(0===i.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(i)}}return e}function Vn(t,e){if(null==t)return;const n=[];if(e instanceof l.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const r in e)n.push(e[r].id);const i=[];if(t instanceof l.Tensor)-1===n.indexOf(t.id)&&i.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&i.push(t)});else if(null!=t)for(const r in t){const e=t[r];-1===n.indexOf(e.id)&&i.push(e)}i.forEach(t=>{t.isDisposed||t.dispose()})}function Yn(t){return Array.isArray(t)}function Gn(t){return!function(t){return t instanceof l.Tensor}(t)&&!Yn(t)}function Xn(t,e,n,i=!0,r=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(Yn(t)&&t.length>0)e=!0;else if(Gn(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new p(`Error when checking model ${r} expected no data, but got `+t)}return[]}if(null==t)return e.map(t=>null);let s;if(Gn(t)){t=t,s=[];for(const n of e){if(null==t[n])throw new p(`No data provided for "${n}". Need data for each key in: `+e);s.push(t[n])}}else if(Yn(t)){if((t=t).length!==e.length)throw new p(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): `+t);s=t}else{if(t=t,e.length>1)throw new p(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape `+t.shape);s=[t]}if(s=Wn(s),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=s[o];if(t.shape.length!==n[o].length)throw new p(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape `+t.shape);for(let s=0;s<n[o].length;++s){if(0===s&&!i)continue;const a=t.shape[s],u=n[o][s];if(null!=u&&u>=0&&a!==u)throw new p(`Error when checking ${r}: expected ${e[o]} to have shape [${n[o]}], but got array with shape [${t.shape}].`)}}return s}function Hn(t,e,n,i=!0,r=""){let s;if(Array.isArray(t)){if(t.length!==e.length)throw new p(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);s=t}else{if(e.length>1)throw new p(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape `+JSON.stringify(t.shape)+".");s=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=s[o];if(t.shape.length!==n[o].length)throw new p(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape `+JSON.stringify(t.shape));for(let s=0;s<n[o].length;++s){if(0===s&&!i)continue;const a=t.shape[s],u=n[o][s];if(null!=u&&u!==a)throw new p(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(t.shape)}.`)}}}class qn extends Mn{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new p("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,i=console.log){const r=function(t){let e=!0;const n=[],i=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||1===r.length&&r[0].inboundLayers.length>1){e=!1;break}i.push(...r)}if(e)for(const r of t.layers){let t=!1;for(const n of r.inboundNodes)if(-1!==i.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),s=["Layer (type)","Output shape","Param #"];let o;if(r?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!r){s.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}i("_".repeat(e)),vn(s,n,i),i("=".repeat(e));const a=t.layers;for(let c=0;c<a.length;++c)r?bn(a[c],n,i):xn(a[c],n,o,i),i((c===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const u=function(t){let e;return e=Se(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights),e}(t),l=Se(t.nonTrainableWeights);i("Total params: "+(u+l)),i("Trainable params: "+u),i("Non-trainable params: "+l),i("_".repeat(e))}(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>l.train.adagrad(.01),Adadelta:()=>l.train.adadelta(1,.95,h()),Adam:()=>l.train.adam(.001,.9,.999,h()),Adamax:()=>l.train.adamax(.002,.9,.999,h(),0),RMSProp:()=>l.train.rmsprop(.001,.9,0,h()),SGD:()=>l.train.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new p("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof l.Optimizer))throw new p("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new p(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);e=t.loss.map(t=>rn(t))}else{const n=rn(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new p(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: `+this.outputNames);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(rn(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let s=0;s<this.outputs.length;++s){const t=this.internalOutputShapes[s];this.feedOutputNames.push(this.outputNames[s]),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[s])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],st("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const i=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const i of e){let e=n.hasOwnProperty(i)?n[i]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),r=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};st("metric",()=>{for(let t=0;t<this.outputs.length;++t)-1===n.indexOf(t)&&(e=>{let n,i,s;for(const o of e){if("string"==typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let r;1===e[e.length-1]||this.lossFunctions[t]===tn?-1!==["accuracy","acc"].indexOf(o)?i=sn:-1!==["crossentropy","ce"].indexOf(o)&&(i=ln):this.lossFunctions[t]===Ze?-1!==["accuracy","acc"].indexOf(o)?i=cn:-1!==["crossentropy","ce"].indexOf(o)&&(i=dn):-1!==["accuracy","acc"].indexOf(o)?i=on:-1!==["crossentropy","ce"].indexOf(o)&&(i=hn),-1!==["accuracy","acc"].indexOf(o)?r="acc":-1!==["crossentropy","ce"].indexOf(o)&&(r="ce"),s=i,n=""+r}else{const t=pn(o);s=t,n=""+mn(o)}let e;st(n,()=>{e=s}),r(t,n,e)}})(i[t])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const i=null==n.batchSize?32:n.batchSize;Bn(i);const r=this.standardizeUserDataXY(t,e,!0,i);try{const s=r[0].concat(r[1]);return this.makeTestFunction(),x(this.testLoop(this.testFunction,s,i,n.verbose,n.steps))}finally{Vn(r[0],t),Vn(r[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const i=null!=(n=n||{}).batches,r=t.testFunction;let s=[];if(n.verbose>0)throw new m("Verbose mode is not implemented yet.");l.util.assert(!i||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches));const o="function"==typeof e.next?e:await e.iterator();let a=0,u=0;for(;!i||u<n.batches;){const e=await o.next();if(s=l.tidy(()=>{if(e.value){const{xs:n,ys:i}=Fn(t,e.value),o=n.concat(i),c=l.tidy(()=>r(o));if(l.dispose(o),0===u)for(let t=0;t<c.length;++t)s.push(Object(l.scalar)(0));const h=o[0].shape[0];for(let t=0;t<c.length;++t){const e=c[t],n=s[t];s[t]=l.tidy(()=>l.add(s[t],l.mul(h,e))),u>0&&l.dispose(n)}l.dispose(c),a+=h,++u}return s}),e.done){i&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){const t=s[c];s[c]=l.div(s[c],a),l.dispose(t)}return x(s)}(this,t,e)}checkNumSamples(t,e,n,i="steps"){let r;if(null!=n){if(r=null,null!=e)throw new p(`If ${i} is set, batchSize must be null or undefined.Got batchSize = `+e)}else{if(null==t)throw new p("Either the input data should have a defined shape, or "+i+" shoud be specified.");r=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return r}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new p("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),i=this.retrieveSymbolicTensors(n?e:[e]),r=new On;if(t instanceof l.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new p(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)r.add(this.inputs[e],t[e])}else for(const o of this.inputs){const e=t[o.name];if(null==e)throw new p("No value is provided for the model's input "+o.name);r.add(o,e)}const s=An(i,r);return n?s:s[0]}retrieveSymbolicTensors(t){const e=y(null,t.length);let n=t.length;for(const i of this.layers){const r=Array.isArray(i.output)?i.output:[i.output],s=r.map(t=>t.name);for(let i=0;i<t.length;++i){const o=s.indexOf(t[i]);if(-1!==o&&(e[i]=r[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,i)=>{null==e&&n.push(t[i])}),new p("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(n))}return e}predictLoop(t,e=32,n=!1){return l.tidy(()=>{const i=this.checkNumSamples(t);if(n)throw new m("Verbose predictLoop() is not implemented yet.");const r=Un(i,e),s=this.outputs.map(t=>[]);for(let e=0;e<r.length;++e)l.tidy(()=>{const n=zn(t,r[e][0],r[e][1]),i=[];if(Array.isArray(n))for(let t=0;t<n.length;++t)i.push({key:this.inputs[t],value:n[t]});else i.push({key:this.inputs[0],value:n});const s=new On(i);return An(this.outputs,s)}).forEach((t,e)=>s[e].push(t));return x(s.map(t=>l.concat(t,0)))})}predict(t,e={}){const n=Wn(t);Hn(n,this.inputNames,this.feedInputShapes,!1);try{const i=null==e.batchSize?32:e.batchSize;return Bn(i),this.predictLoop(n,i)}finally{Vn(n,t)}}predictOnBatch(t){Hn(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,i){if(null==this.optimizer_)throw new f("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let s=0;s<this.feedOutputShapes.length;++s){const t=this.feedOutputShapes[s];r.push(this.feedLossFns[s]===Ze?t.slice(0,t.length-1).concat([1]):t)}if(function(t,e,n){const i=k(t.map(t=>t.shape[0]));i.sort();const r=k(e.map(t=>t.shape[0]));if(r.sort(),i.length>1)throw new p("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(t=>t.shape)));if(r.length>1)throw new p("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(t=>t.shape)));if(i.length>0&&r.length>0&&!l.util.arraysEqual(i,r))throw new p(`Input Tensors should have the same number of samples as target Tensors. Found ${i[0]} input sample(s) and ${r[0]} target sample(s).`)}(t=Xn(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=Xn(e,this.feedOutputNames,r,!1,"target")),function(t,e,n){const i=[qe,tn,Qe];for(let r=0;r<t.length;++r){const s=t[r],o=e[r],a=n[r];if(null!=o){if(o===Qe&&1===s.shape[s.shape.length-1])throw new p(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==i.indexOf(o)){const t=s.shape.slice(1),e=a.slice(1);for(let n=0;n<t.length;++n){const i=t[n],r=e[n];if(null!=r&&i!==r)throw new p(`A target Tensor with shape ${s.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=i&&i>0&&t[0].shape[0]%i!=0)throw new p(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,i,r=!0,s){const[o,a]=this.standardizeUserDataXY(t,e,r,s);if(null!=n)throw new Error("sample weight is not supported yet.");let u=null;if(null!=i){const t=Nn(i,this.outputNames);u=[];for(let e=0;e<t.length;++e)u.push(await Dn(a[e],null,t[e]))}return[o,a,u]}testLoop(t,e,n,i=0,r){return l.tidy(()=>{const s=this.checkNumSamples(e,n,r,"steps"),o=[];if(i>0)throw new m("Verbose mode is not implemented yet.");if(null!=r)throw new m("steps mode in testLoop() is not implemented yet");{const i=Un(s,n),r=Object(l.tensor1d)(mt(0,s));for(let n=0;n<i.length;++n){const s=i[n][0],a=i[n][1],u=vt(r,s,a-s),c=$n(e,u),h=t(c);if(0===n)for(let t=0;t<h.length;++t)o.push(Object(l.scalar)(0));for(let t=0;t<h.length;++t)o[t]=l.add(o[t],l.mul(a-s,h[t]))}for(let t=0;t<o.length;++t)o[t]=l.div(o[t],s)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const i=t[n];let r=i;b(t,i)>1&&(r+="_"+b(t.slice(0,n),i)),e.push(r)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),s=[],o=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const o=new On(t),a=An(this.outputs,o,{training:!0});let u;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(i[n],a[n]);null!=r[n]&&(t=Pn(t,r[n]));const s=l.mean(t);e.push(s),u=0===n?t:l.add(u,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][1];t=l.mean((0,this.metricsTensors[n][0])(i[e],a[e]))}l.keep(t),s.push(t)}return u=l.mean(u),this.calculateLosses().forEach(t=>{u=l.add(u,t)}),u},!0,o)].concat(s)}}makeTestFunction(){this.testFunction=t=>l.tidy(()=>{const e=[];let n;const i=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=[];for(let t=0;t<this.inputs.length;++t)s.push({key:this.inputs[t],value:i[t]});const o=new On(s),a=An(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const i=l.mean((0,this.lossFunctions[t])(r[t],a[t]));n=0===t?i:l.add(n,i),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][1],i=l.mean((0,this.metricsTensors[t][0])(r[n],a[n]));e.push(i)}return e})}async fit(t,e,n={}){return async function(t,e,n,i={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let r,s,o,a,u,c,h;t.isTraining=!0;try{const d=null==i.batchSize?32:i.batchSize;Bn(d);const f=!1,g=await t.standardizeUserData(e,n,i.sampleWeight,i.classWeight,f,d);r=g[0],s=g[1],h=g[2];let y,v=!1;if(null!=i.validationData&&i.validationData.length>0){if(v=!0,2!==i.validationData.length)throw 3===i.validationData.length?new m("validationData including sample weights is not supported yet."):new p("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+i.validationData+" is invalid.");o=i.validationData[0],a=i.validationData[1];const e=!0,n=await t.standardizeUserData(o,a,null,null,e,d);u=n[0],c=n[1],y=u.concat(c)}else if(null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1){v=!0;const t=Math.floor(r[0].shape[0]*(1-i.validationSplit)),e=r[0].shape[0];u=zn(r,t,e),r=zn(r,0,t),c=zn(s,t,e),s=zn(s,0,t),y=u.concat(c)}else null!=i.validationSteps&&(v=!0);const b=r.concat(s).concat(h);t.checkTrainableWeightsConsistency();const x=t.makeTrainFunction(),w=t.getDedupedMetricsNames();let T,S;v?(t.makeTestFunction(),T=t.testFunction,S=w.slice().concat(w.map(t=>"val_"+t))):(T=null,y=[],S=w.slice());const E=Ve(i.callbacks,i.yieldEvery);return await async function(t,e,n,i,r,s,o,a,u,c,h,d,f,p,g){null==r&&(r=32),null==s&&(s=1),null==h&&(h=!0),null==f&&(f=0);let y=!1;null!=u&&null!=c&&(y=!0);const v=t.checkNumSamples(n,r,null,"steps_per_epoch");let b;null!=v&&(b=mt(0,v)),null==o&&(o=1);const{callbackList:x,history:w}=Ge(a,o,s,f,v,null,r,y,d);x.setModel(t),t.history=w,await x.onTrainBegin(),t.stopTraining_=!1;for(let T=f;T<s;++T){await x.onEpochBegin(T);const s={};{if("batch"===h)throw new m("batch shuffling is not implemneted yet");h&&l.util.shuffle(b);const o=Object(l.tensor1d)(b),a=Un(v,r);for(let h=0;h<a.length;++h){const d={};if(await x.onBatchBegin(h,d),l.tidy(()=>{const f=a[h][0],p=a[h][1],m=vt(o,f,p-f);d.batch=h,d.size=p-f;const g=$n(n,m),v=e(g);for(let t=0;t<i.length;++t){const e=v[t];d[i[t]]=e,l.keep(e)}if(h===a.length-1&&y){const e=t.testLoop(u,c,r);for(let t=0;t<i.length;++t){const n=i[t],r=e[t];l.keep(r),s["val_"+n]=r}}}),await x.onBatchEnd(h,d),Le(d),t.stopTraining_)break}o.dispose()}if(await x.onEpochEnd(T,s),t.stopTraining_)break}return await x.onTrainEnd(),await t.history.syncData(),t.history}(t,x,b,w,d,i.epochs,i.verbose,E,T,y,i.shuffle,S,i.initialEpoch)}finally{t.isTraining=!1,Vn(r,e),Vn(s,n),Vn(u,o),Vn(c,a),null!=h&&l.dispose(h)}}(this,t,e,n)}async fitDataset(t,e){return async function(t,e,n){const i=null!=n.batchesPerEpoch;if(l.util.assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),l.util.assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),l.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs),l.util.assert(!i||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch),l.util.assert(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=null!=n.validationData;let s,o;if(r)if(jn(n.validationData))l.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches);else{const t=function(t){if(3===t.length)throw new m("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);s=t.xs,o=t.ys}const a=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let c;c=r?u.slice().concat(u.map(t=>"val_"+t)):u.slice();const h=Ve(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:f,history:p}=Ge(h,d,n.epochs,null,null,function(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,r,c);f.setModel(t),t.history=p,await f.onTrainBegin(),t.stopTraining_=!1;let g=null==n.initialEpoch?0:n.initialEpoch,y=await e.iterator();for(;g<n.epochs;){const c={};await f.onEpochBegin(g);let h=0,d=0;for(i||(y=await e.iterator());!i||h<n.batchesPerEpoch;){const e=await y.next();if(i&&e.done){console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+h+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:i,ys:r}=Fn(t,e.value),s={};s.batch=d,s.size=i[0].shape[0],await f.onBatchBegin(d,s);const o=[];if(null!=n.classWeight){const e=Nn(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await Dn(r[t],null,e[t]))}const c=i.concat(r).concat(o),p=a(c);l.dispose(c);for(let t=0;t<u.length;++t){const e=p[t];s[u[t]]=e,l.keep(e)}await f.onBatchEnd(d,s),Le(s),d++,h++}if(i?h>=n.batchesPerEpoch:e.done){if(r){let e;e=jn(n.validationData)?w(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):w(t.evaluate(s,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)c["val_"+t.metricsNames[n]]=e[n]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(g,c),g++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),i=n[0],r=n[1],s=this.makeTrainFunction()(i.concat(r)),o=[];for(const a of s){const t=await a.data();o.push(t[0])}return l.dispose(s),x(o)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,i=n?this.trainableWeights:this.weights,r=this.getWeights(n);for(let s=0;s<i.length;++s)n&&!i[s].trainable||e.push({name:i[s].originalName,tensor:r[s]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=l.memory().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-l.memory().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=T(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>T(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const i of e){if("string"!=typeof n[i])throw new Error("Serialization of non-string loss is not supported.");t[i]=T(n[i])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[T(mn(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>T(mn(t)));{const t={};for(const e in this.metrics)t[e]=T(mn(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Xe(Tn(t.optimizer_config));let n,i;if("string"==typeof t.loss)n=S(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(t=>S(t));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=S(t.loss[e])}if(Array.isArray(t.metrics))i=t.metrics.map(t=>S(t));else if(null!=t.metrics){i={};for(const e in t.metrics)i[e]=S(t.metrics[e])}this.compile({loss:n,metrics:i,optimizer:e})}async save(t,e){if("string"==typeof t){const e=l.io.getSaveHandlers(t);if(0===e.length)throw new p(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new p(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new p("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await l.io.encodeWeights(this.getNamedWeights(e)),i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v"+En,convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){i.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:r}=await l.io.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...r),n.data=l.io.concatenateArrayBuffers([n.data,e])}return null!=this.userDefinedMetadata&&(gn(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=n.data,i.weightSpecs=n.specs,t.save(i)}setUserDefinedMetadata(t){gn(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}async function Kn(t,e){"modelTopology"in t||(t={modelTopology:t});let n=(t=t).modelTopology;null!=n.model_config&&(n=n.model_config);const i=Xe(Tn(n),e);if(null!=t.weightsManifest){const e=await l.io.loadWeights(t.weightsManifest,t.pathPrefix,i.weights.map(t=>t.originalName)),n={};for(const t of i.weights)n[t.originalName]=e[t.originalName];i.loadWeights(n),Object(l.dispose)(e)}return i}qn.className="Model",l.serialization.registerClass(qn);class Jn extends qn{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:ve("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new p("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")}add(t){const e=t instanceof Jn||t instanceof qn;let n;if(e){if(n=t,1!==n.outputs.length)throw new p("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new p("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new p("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=Pe({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new p(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new p("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Ne(this.outputs[0])}this.inboundNodes=[],new Re({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:y(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(Te(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new qn({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new f("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new f("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new f("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new f("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},i=!1){let r,s={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new p("Legacy serialization format not supported yet.");r=e}else l.util.assert(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=e.layers,delete e.layers,s=e;const o=new t(s);if(!(o instanceof Jn))throw new m("Sequential.fromConfig called on non-Sequential input: "+o);for(const a of r){const t=Xe(a,void 0,i);i&&t.setFastWeightInitDuringBuild(!0),o.add(t)}return o}set stopTraining(t){if(null==this.model)throw new p("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new p("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}function Qn(t){return new qn(t)}function Zn(t){return new Jn(t)}function ti(t,e){return null==e&&(e={}),async function(t,e){if(null==e&&(e={}),"string"==typeof t){const n=l.io.getLoadHandlers(t,e);if(0===n.length)n.push(l.io.browserHTTPRequest(t,e));else if(n.length>1)throw new p(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return async function(t,e,n){if(null==n&&(n={}),null==t.load)throw new p("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const i=await t.load();let r=i.modelTopology;null!=r.model_config&&(r=r.model_config);const s=null==n.strict||n.strict,o=null!=i.weightData&&null!=i.weightSpecs&&s,a=Xe(Tn(r),void 0,o),u=i.trainingConfig;if(null!=u&&a.loadTrainingConfig(u),null!=i.userDefinedMetadata&&a.setUserDefinedMetadata(i.userDefinedMetadata),null!=i.weightData){if(null==i.weightSpecs)throw new p("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=l.io.decodeWeights(t,e),i={},r=[];return e.forEach(t=>{"optimizer"===t.group?r.push({name:t.name,tensor:n[t.name]}):i[t.name]=n[t.name]}),{modelWeights:i,optimizerWeights:r}}(i.weightData,i.weightSpecs);a.loadWeights(t,s),null!=a.optimizer&&e.length>0&&await a.optimizer.setWeights(e),Object(l.dispose)(t),Object(l.dispose)(e.map(t=>t.tensor))}return a}(t,0,e)}(t,e)}function ei(t){return Pe(t)}function ni(t,e){Ye.registerCallbackConstructor(t,e)}Jn.className="Sequential",l.serialization.registerClass(Jn);class ii extends l.serialization.Serializable{getConfig(){return{}}}class ri extends ii{apply(t,e=1){return function(t,e=1){if(1!==e)throw new m(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return l.elu(t)}(t,e)}}ri.className="elu",l.serialization.registerClass(ri);class si extends ii{apply(t){return l.selu(t)}}si.className="selu",l.serialization.registerClass(si);class oi extends ii{apply(t){return l.relu(t)}}oi.className="relu",l.serialization.registerClass(oi);class ai extends ii{apply(t){return Object(l.tidy)(()=>l.minimum(6,l.relu(t)))}}ai.className="relu6",l.serialization.registerClass(ai);class ui extends ii{apply(t){return t}}ui.className="linear",l.serialization.registerClass(ui);class li extends ii{apply(t){return l.sigmoid(t)}}li.className="sigmoid",l.serialization.registerClass(li);class ci extends ii{apply(t){return function(t){return Object(l.tidy)(()=>{const e=l.add(.5,l.mul(.2,t));return l.clipByValue(e,0,1)})}(t)}}ci.className="hardSigmoid",l.serialization.registerClass(ci);class hi extends ii{apply(t){return l.softplus(t)}}hi.className="softplus",l.serialization.registerClass(hi);class di extends ii{apply(t){return function(t){return Object(l.tidy)(()=>l.div(t,l.abs(t).add(1)))}(t)}}di.className="softsign",l.serialization.registerClass(di);class fi extends ii{apply(t){return l.tanh(t)}}fi.className="tanh",l.serialization.registerClass(fi);class pi extends ii{apply(t,e=-1){return l.softmax(t,e)}}pi.className="softmax",l.serialization.registerClass(pi);class mi extends ii{apply(t,e=-1){return l.logSoftmax(t,e)}}function gi(t){return t.getClassName()}function yi(t,e={}){return _(t,l.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function vi(t){if(null==t)return yi({className:"linear",config:{}});if("string"==typeof t){const e={};return e.className=t,e.config={},yi(e)}return t instanceof ii?t:yi(t)}function bi(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}mi.className="logSoftmax",l.serialization.registerClass(mi);class xi extends l.serialization.Serializable{}class wi extends xi{constructor(t){super(),bi(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return Object(l.tidy)(()=>{let e=Object(l.zeros)([1]);return this.hasL1&&(e=Object(l.add)(e,Object(l.sum)(l.mul(this.l1,Object(l.abs)(t))))),this.hasL2&&(e=Object(l.add)(e,Object(l.sum)(l.mul(this.l2,_t(t))))),e.asScalar()})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}wi.className="L1L2",l.serialization.registerClass(wi);const Ti={l1l2:"L1L2"};function Si(t){return O(t)}function Ei(t,e={}){return _(t,l.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function Oi(t){return null==t?null:"string"==typeof t?Ei({className:t in Ti?Ti[t]:t,config:{}}):t instanceof xi?t:Ei(t)}class Ci extends Me{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=we(t);let n=Object(l.relu)(t);return null!=this.maxValue&&(n=Object(l.clipByValue)(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Ci.className="ReLU",l.serialization.registerClass(Ci);class _i extends Me{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=we(t);return Object(l.leakyRelu)(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}_i.className="LeakyReLU",l.serialization.registerClass(_i);class Ai extends Me{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Zt(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Oi(t.alphaRegularizer),this.alphaConstraint=Y(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new p("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=Te(t)).slice(1);if(null!=this.sharedAxes)for(const i of this.sharedAxes)e[i-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let i=1;i<t.length;++i)n[i]=t[i];this.inputSpec=[new _e({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=we(t),Object(l.prelu)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Qt(this.alphaInitializer),alphaRegularizer:Si(this.alphaRegularizer),alphaConstraint:W(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}Ai.className="PReLU",l.serialization.registerClass(Ai);class ki extends Me{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new m(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=we(t);return Object(l.elu)(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}ki.className="ELU",l.serialization.registerClass(ki);class Ri extends Me{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=we(t);return n.mul(gt(n.greater(this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}Ri.className="ThresholdedReLU",l.serialization.registerClass(Ri);class Ii extends Me{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new pi).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=we(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Mi(t,e,n){if("number"==typeof t)return y(t,e);if(t.length!==e)throw new p(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let i=0;i<e;++i){const r=t[i];if(!ct(r))throw new p(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number `+r)}return t}function Ni(t,e,n,i,r=1){if(null==t)return t;let s;return s="same"===n?t:t-(e+(e-1)*(r-1))+1,Math.floor((s+i-1)/i)}function Di(t,e,n,i){if(null==t)return null;if("valid"===i)t=t*e+pt([n-e,0]);else{if("same"!==i)throw new p(`Unsupport padding mode: ${i}.`);t*=e}return t}function Pi(t,e){return Object(l.tidy)(()=>(et(e),"channelsFirst"===e?l.transpose(t,[0,2,3,1]):t))}function Fi(t,e){return Object(l.tidy)(()=>(et(e),"channelsFirst"===e?l.transpose(t,[0,2,3,4,1]):t))}function Li(t,e,n,i=[1,1],r="valid",s,o,a=null){return Object(l.tidy)(()=>{if(null==s&&(s="channelsLast"),et(s),3!==t.rank&&4!==t.rank)throw new p(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new p(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let u=Pi(t,s);if("causal"===r)throw new m("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=l.fused.conv2d({x:u,filter:e,strides:i,pad:"same"===r?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:a}),"channelsFirst"===s&&(u=l.transpose(u,[0,3,1,2])),u})}Ii.className="Softmax",l.serialization.registerClass(Ii);class ji extends Me{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",ji.verifyArgs(e),this.rank=t,N(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new m(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Mi(e.kernelSize,t,"kernelSize"),this.strides=Mi(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,nt(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,et(this.dataFormat),this.activation=vi(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=Zt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Y(e.biasConstraint),this.biasRegularizer=Oi(e.biasRegularizer),this.activityRegularizer=Oi(e.activityRegularizer),this.dilationRate=Mi(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new p("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(this.dilationRate));if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new p("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(this.dilationRate))}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new p("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(this.dilationRate))}static verifyArgs(t){if(v("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!M(t.kernelSize,"number",1,3))throw new p(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:gi(this.activation),useBias:this.useBias,biasInitializer:Qt(this.biasInitializer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),biasConstraint:W(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Bi extends ji{constructor(t,e){super(t,e),this.kernel=null,Bi.verifyArgs(e),this.filters=e.filters,N(this.filters,"filters"),this.kernelInitializer=Zt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Y(e.kernelConstraint),this.kernelRegularizer=Oi(e.kernelRegularizer)}build(t){t=Te(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new p("The channel dimension of the input should be defined. Found "+t[e]);const n=t[e],i=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return Object(l.tidy)(()=>{let e;t=we(t);const n=null==this.bias?null:this.bias.read(),i=P(this.activation.getClassName());if(null!=i&&2===this.rank)e=Li(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,i);else{if(1===this.rank)e=function(t,e,n,i=1,r="valid",s,o=1){return Object(l.tidy)(()=>{if(null==s&&(s="channelsLast"),et(s),3!==t.shape.length)throw new p("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new p("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new p("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===s&&(t=l.transpose(t,[0,2,1])),"causal"===r)throw new m("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=l.conv1d(t,e,i,"same"===r?"same":"valid","NWC",o);return null!=n&&(a=kt(a,n)),a})}(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=Li(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new m("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,i=[1,1,1],r="valid",s,o){return Object(l.tidy)(()=>{if(null==s&&(s="channelsLast"),et(s),4!==t.rank&&5!==t.rank)throw new p("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new p("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");let a=Fi(t,s);if("causal"===r)throw new m("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=l.conv3d(a,e,i,"same"===r?"same":"valid","NDHWC",o),null!=n&&(a=kt(a,n)),"channelsFirst"===s&&(a=l.transpose(a,[0,4,1,2,3])),a})}(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=Te(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let r=0;r<n.length;++r){const t=Ni(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(t)}let i=[t[0]];return"channelsLast"===this.dataFormat?(i=i.concat(e),i.push(this.filters)):(i.push(this.filters),i=i.concat(e)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Qt(this.kernelInitializer),kernelRegularizer:Si(this.kernelRegularizer),kernelConstraint:W(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new p("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))}}class zi extends Bi{constructor(t){super(2,t),zi.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!M(t.kernelSize,"number",1,2))throw new p(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}zi.className="Conv2D",l.serialization.registerClass(zi);class $i extends Bi{constructor(t){super(3,t),$i.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new p(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}$i.className="Conv3D",l.serialization.registerClass($i);class Ui extends zi{constructor(t){if(super(t),this.inputSpec=[new _e({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new p("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+this.padding)}build(t){if(4!==(t=Te(t)).length)throw new p("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new p("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],i=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new _e({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return l.tidy(()=>{let e=we(t);if(4!==e.shape.length)throw new p("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);const n=e.shape;let i,r;"channelsFirst"===this.dataFormat?(i=2,r=3):(i=1,r=2);const s=n[r],o=this.kernelSize[1],a=this.strides[1],u=[n[0],Di(n[i],this.strides[0],this.kernelSize[0],this.padding),Di(s,a,o,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=l.transpose(e,[0,2,3,1]));let c=l.conv2dTranspose(e,this.kernel.read(),u,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(c=l.transpose(c,[0,3,1,2])),null!=this.bias&&(c=kt(c,this.bias.read(),this.dataFormat)),null!=this.activation&&(c=this.activation.apply(c)),c})}computeOutputShape(t){const e=(t=Te(t)).slice();let n,i,r;"channelsFirst"===this.dataFormat?(n=1,i=2,r=3):(n=3,i=1,r=2);const s=this.kernelSize[0],o=this.kernelSize[1],a=this.strides[0],u=this.strides[1];return e[n]=this.filters,e[i]=Di(e[i],a,s,this.padding),e[r]=Di(e[r],u,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Ui.className="Conv2DTranspose",l.serialization.registerClass(Ui);class Wi extends Bi{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new p("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new p("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new p(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received `+JSON.stringify(e.padding));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=Zt(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Oi(e.depthwiseRegularizer),this.depthwiseConstraint=Y(e.depthwiseConstraint),this.pointwiseInitializer=Zt(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Oi(e.pointwiseRegularizer),this.pointwiseConstraint=Y(e.pointwiseConstraint)}build(t){if((t=Te(t)).length<this.rank+2)throw new p(`Inputs to SeparableConv${this.rank}D should have rank `+(this.rank+2)+", but received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new p("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[e]));const n=t[e],i=this.kernelSize.concat([n,this.depthMultiplier]),r=[];for(let o=0;o<this.rank;++o)r.push(1);r.push(n*this.depthMultiplier,this.filters);const s=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,s,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,s,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,s,this.biasConstraint):null,this.inputSpec=[new _e({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return Object(l.tidy)(()=>{let e;if(t=we(t),1===this.rank)throw new m("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=l.transpose(t,[0,2,3,1])),e=l.separableConv2d(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=kt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=l.transpose(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Qt(this.depthwiseInitializer),t.pointwiseInitializer=Qt(this.pointwiseInitializer),t.depthwiseRegularizer=Si(this.depthwiseRegularizer),t.pointwiseRegularizer=Si(this.pointwiseRegularizer),t.depthwiseConstraint=W(this.depthwiseConstraint),t.pointwiseConstraint=W(this.pointwiseConstraint),t}}Wi.className="SeparableConv";class Vi extends Wi{constructor(t){super(2,t)}}Vi.className="SeparableConv2D",l.serialization.registerClass(Vi);class Yi extends Bi{constructor(t){super(1,t),Yi.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!M(t.kernelSize,"number",1,1))throw new p(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}Yi.className="Conv1D",l.serialization.registerClass(Yi);class Gi extends Me{constructor(t){super(t),this.cropping="number"==typeof t.cropping?[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return Object(l.tidy)(()=>{if(t=we(t),"channelsLast"===this.dataFormat){const e=xt(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return xt(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=xt(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return xt(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}Gi.className="Cropping2D",l.serialization.registerClass(Gi);class Xi extends Me{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],null==t[2]?null:this.size[0]*t[2],null==t[3]?null:this.size[1]*t[3]]:[t[0],null==t[1]?null:this.size[0]*t[1],null==t[2]?null:this.size[1]*t[2],t[3]]}call(t,e){return l.tidy(()=>{let e=we(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=l.transpose(e,[0,2,3,1]);const t=e.resizeNearestNeighbor([this.size[0]*n[2],this.size[1]*n[3]]);return l.transpose(t,[0,3,1,2])}return e.resizeNearestNeighbor([this.size[0]*n[1],this.size[1]*n[2]])})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}Xi.className="UpSampling2D",l.serialization.registerClass(Xi);class Hi extends ji{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=Zt(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Y(t.depthwiseConstraint),this.depthwiseRegularizer=Oi(t.depthwiseRegularizer)}build(t){if((t=Te(t)).length<4)throw new p(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new p(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return Object(l.tidy)(()=>{let e=function(t,e,n=[1,1],i="valid",r,s){return Object(l.tidy)(()=>{null==r&&(r="channelsLast"),et(r);let o=Pi(t,r);if(4!==t.rank)throw new p("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new p("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return o=l.depthwiseConv2d(o,e,n,"same"===i?"same":"valid","NHWC",s),"channelsFirst"===r&&(o=l.transpose(o,[0,3,1,2])),o})}(t=we(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=kt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=Te(t);const e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=Ni("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),r=Ni(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,i,r]:[t[0],i,r,n]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Qt(this.depthwiseInitializer),t.depthwiseRegularizer=Si(this.depthwiseRegularizer),t.depthwiseConstraint=W(this.depthwiseRegularizer),t}}Hi.className="DepthwiseConv2D",l.serialization.registerClass(Hi);class qi extends Me{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let i=0;i<this.noiseShape.length;++i)n.push(null==this.noiseShape[i]?e[i]:this.noiseShape[i]);return n}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,i=this.getNoiseShape(n);return It(()=>Rt(n,this.rate,i,this.seed),()=>n,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}qi.className="Dropout",l.serialization.registerClass(qi);class Ki extends qi{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}Ki.className="SpatialDropout1D",l.serialization.registerClass(Ki);class Ji extends Me{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,N(this.units,"units"),this.activation=vi(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=Zt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Zt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Y(t.kernelConstraint),this.biasConstraint=Y(t.biasConstraint),this.kernelRegularizer=Oi(t.kernelRegularizer),this.biasRegularizer=Oi(t.biasRegularizer),this.activityRegularizer=Oi(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=Te(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=Te(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t),i=P(this.activation.getClassName());let r;return null!=i?r=Ot(n,this.kernel.read(),i,this.bias?this.bias.read():null):(r=Ot(n,this.kernel.read()),null!=this.bias&&(r=kt(r,this.bias.read())),null!=this.activation&&(r=this.activation.apply(r))),r})}getConfig(){const t={units:this.units,activation:gi(this.activation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),biasInitializer:Qt(this.biasInitializer),kernelRegularizer:Si(this.kernelRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),biasConstraint:W(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Ji.className="Dense",l.serialization.registerClass(Ji);class Qi extends Me{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Te(t);for(const e of t.slice(1))if(null==e)throw new p(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],ht(t,1)]}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);let n=we(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=n.transpose(t)}return function(t){if(t.rank<=1)throw new p(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],ht(t.shape,1)];return t.reshape(e)}(n)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}Qi.className="Flatten",l.serialization.registerClass(Qi);class Zi extends Me{constructor(t){super(t),this.supportsMasking=!0,this.activation=vi(t.activation)}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t);return this.activation.apply(n)})}getConfig(){const t={activation:gi(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}Zi.className="Activation",l.serialization.registerClass(Zi);class tr extends Me{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return Object(l.tidy)(()=>function(t,e){return Object(l.tidy)(()=>{if(2!==t.shape.length)throw new p(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);return St(yt(t,1),[1,e,1])})}(t=we(t),this.n))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}tr.className="RepeatVector",l.serialization.registerClass(tr);class er extends Me{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",i=e.slice();let r=1,s=null;for(let a=0;a<i.length;++a){const t=i[a];if(this.isUnknown(t)){if(null!==s)throw new p("Can only specifiy one unknown dimension.");s=a}else r*=t}const o=ht(t);if(null!==s){if(0===r||o%r!=0)throw new p(n);i[s]=o/r}else if(o!==r)throw new p(n);return i}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t),i=n.shape,r=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return n.reshape(r)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}er.className="Reshape",l.serialization.registerClass(er);class nr extends Me{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");const e=mt(1,t.dims.length+1);if(!l.util.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new _e({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=Te(t)).slice();return this.dims.forEach((n,i)=>{e[i+1]=t[n]}),e}call(t,e){return Object(l.transpose)(we(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}nr.className="Permute",l.serialization.registerClass(nr);class ir extends Me{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=we(t);return Object(l.any)(Object(l.notEqual)(n,this.maskValue),-1)}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t),i=Object(l.any)(Object(l.notEqual)(n,this.maskValue),-1,!0);return n.mul(i.asType(n.dtype))})}}ir.className="Masking",l.serialization.registerClass(ir);class rr extends Me{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=null==t.inputLength?[e,null]:[e].concat(w(t.inputLength))}this.inputDim=t.inputDim,N(this.inputDim,"inputDim"),this.outputDim=t.outputDim,N(this.outputDim,"outputDim"),this.embeddingsInitializer=Zt(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Oi(t.embeddingsRegularizer),this.activityRegularizer=Oi(t.activityRegularizer),this.embeddingsConstraint=Y(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return Object(l.tidy)(()=>this.maskZero?(t=we(t),Object(l.notEqual)(t,Object(l.zerosLike)(t))):null)}computeOutputShape(t){if(t=Te(t),null==this.inputLength)return[...t,this.outputDim];const e=w(this.inputLength);if(e.length!==t.length-1)throw new p(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);{let n=0;for(let i=0;i<e.length;++i){const r=e[i],s=t[i+1];if(null!=r&&null!=s&&r!==s)throw new p(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);null==r&&(e[n]=s),n++}}return[t[0],...e,this.outputDim]}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);let n=we(t);return"int32"!==n.dtype&&(n=gt(n,"int32")),Ct(this.embeddings.read(),n.as1D()).reshape(Te(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Qt(this.embeddingsInitializer),embeddingsRegularizer:Si(this.embeddingsRegularizer),activityRegularizer:Si(this.activityRegularizer),embeddingsConstraint:W(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}rr.className="Embedding",l.serialization.registerClass(rr);class sr extends Me{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new m}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let i=0;i<e.length;++i){const r=t[t.length-e.length+i],s=e[i];if(null==r||null==s||r<0||s<0)n.push(null);else if(1===r)n.push(s);else if(1===s)n.push(r);else{if(r!==s)throw new p("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(r)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Te(t)]),(t=t).length<2)throw new p(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const r of t)null!=r&&null!==r[0]&&e.push(r[0]);if(e=k(e),e.length>1)throw new p(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const e=null==t[r]?null:t[r].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const i=t.map(t=>t.length);this.reshapeRequired=-1!==t.indexOf(null)||1!==k(i).length}call(t,e){return Object(l.tidy)(()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const i=pt(n);for(let n of t){const t=n.rank;for(let e=0;e<i-t;++e)n=yt(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const s of t){const t=s.rank;if(null==t){const t=s.shape,i=t[0],r=t.slice(1).concat([i]);let o=s.reshape([i].concat(ht(t.slice(1))));o=l.transpose(o,[1,0]),o=o.reshape(r),e.push(o),n=!0}else if(t>1){const i=mt(1,t).concat([0]);e.push(l.transpose(s,i)),n=!0}else e.push(s)}let i=this.mergeFunction(e);const r=i.rank;if(n)if(null==r){const t=i.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));i=l.transpose(i.reshape([-1,e]),[1,0]).reshape(n)}else if(r>1){const t=[r-1].concat(mt(0,r-1));i=l.transpose(i,t)}return i}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let i=1;i<t.length;++i){const n=null==t[i]?null:t[i].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const i of t)null!=i&&null!==i[0]&&n.push(i[0]);return n=k(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return l.tidy(()=>{if(null==e)return null;if(!Array.isArray(e))throw new p("`mask` should be an Array");if(!Array.isArray(t))throw new p("`inputs` should be an Array");if(e.length!==t.length)throw new p(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;let n=(e=e.map(t=>null==t?t:l.expandDims(t,0)))[0];for(let t=1;t<e.length-1;++t)n=l.logicalAnd(n,e[t]);return n})}}class or extends sr{constructor(t){super(t)}mergeFunction(t){return Object(l.tidy)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=l.add(e,t[n]);return e})}}or.className="Add",l.serialization.registerClass(or);class ar extends sr{constructor(t){super(t)}mergeFunction(t){return Object(l.tidy)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=l.mul(e,t[n]);return e})}}ar.className="Multiply",l.serialization.registerClass(ar);class ur extends sr{constructor(t){super(t)}mergeFunction(t){return Object(l.tidy)(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=l.add(e,t[n]);return l.mul(1/t.length,e)})}}ur.className="Average",l.serialization.registerClass(ur);class lr extends sr{constructor(t){super(t)}mergeFunction(t){return Object(l.tidy)(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=l.maximum(e,t[n]);return e})}}lr.className="Maximum",l.serialization.registerClass(lr);class cr extends sr{constructor(t){super(t)}mergeFunction(t){return Object(l.tidy)(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=l.minimum(e,t[n]);return e})}}cr.className="Minimum",l.serialization.registerClass(cr);class hr extends sr{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new p("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const i of t)if(null!=i){e=!1;break}if(e)return;const n=[];for(let i=0;i<t.length;++i){const e=t[i].slice();e.splice(this.axis,1);let r=!1;for(const t of n)if(l.util.arraysEqual(t,e)){r=!0;break}r||n.push(e)}if(n.length>1)throw new p("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Object(l.tidy)(()=>wt(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new p("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),i=this.axis<0?n.length+this.axis:this.axis;for(const r of e.slice(1)){if(null==n[i]||null==r[i]){n[i]=null;break}n[i]+=r[i]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new p("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new p("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new p(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return l.tidy(()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const i=[];for(let s=0;s<t.length;++s)i.push(null==e[s]?l.onesLike(t[s]).asType("bool"):e[s].rank<t[s].rank?l.expandDims(e[s],-1):e[s]);const r=l.concat(i,this.axis);return l.all(r,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function dr(t,e){for(;t<0;)t+=e;return t}hr.className="Concatenate",l.serialization.registerClass(hr);class fr extends sr{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){l.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new m("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);if(e[i[0]]!==n[i[1]])throw new p(`Dimension incompatibility: ${e[i[0]]} !== ${n[i[1]]}`)}mergeFunction(t){if(2!==t.length)throw new p(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],i=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>dr(e,t[n].shape.length)):[dr(this.axes,n.shape.length),dr(this.axes,i.shape.length)],this.normalize&&(n=He(n,e[0]),i=He(i,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new m("batchDot is not implemented for tensors of 4D or higher rank yet");if(l.util.assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got "+t.shape.length),l.util.assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got "+e.shape.length),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new m("batchDot is not implemented for complex64-type Tensors yet.");const i=t.shape.length,r=e.shape.length;null==n&&(n=[i-1,r-2]);const s=n;return l.tidy(()=>{let n,o;if(i>r){n=i-r;const t=[];for(let e=0;e<n;++e)t.push(1);e=e.reshape(e.shape.concat(t))}else if(r>i){n=r-i;const e=[];for(let t=0;t<n;++t)e.push(1);t=t.reshape(t.shape.concat(e))}else n=0;if(o=2===t.shape.length&&2===e.shape.length?s[0]===s[1]?t.mul(e).sum(s[0]):t.transpose([1,0]).mul(e).sum(s[1]):t.matMul(e,s[0]!==t.shape.length-1,s[1]===e.shape.length-1),n>0){let t;t=i>r?i+r-3:i-1;const e=[];for(let i=t;i<t+n;++i)e.push(i);o=o.squeeze(e)}return 1===o.shape.length&&(o=o.expandDims(1)),o})}(n,i,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[dr(this.axes,t.length),dr(this.axes,e.length)],n}computeOutputShape(t){l.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new m("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(e,n);e.splice(i[0],1),n.splice(i[1],1),n.splice(0,1);const r=e.concat(n);return 1===r.length&&r.push(1),r}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}fr.className="Dot",l.serialization.registerClass(fr);class pr extends Me{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t);return It(()=>Et(n.shape,0,this.stddev).add(n),()=>n,e.training||!1)})}}pr.className="GaussianNoise",l.serialization.registerClass(pr);class mr extends Me{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e);const n=we(t);return this.rate>0&&this.rate<1?It(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return n.mul(Et(n.shape,1,t))},()=>n,e.training||!1):n})}}mr.className="GaussianDropout",l.serialization.registerClass(mr);class gr extends Me{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||we(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(l.tidy)(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t);return It(()=>{const e=we(t),i=-1.7580993408473766;let r=Object(l.greaterEqual)(Object(l.randomUniform)(n),this.rate);r=gt(r,"float32");const s=((1-this.rate)*(1+this.rate*i**2))**-.5,o=-s*i*this.rate;return e.mul(r).add(r.add(-1).mul(i)).mul(s).add(o)},()=>we(t),e.training||!1)}return t})}}function yr(t,e,n,i,r,s=.001){let o;if(2===t.rank)o=l.batchNorm2d(t,e,n,i,r,s);else if(3===t.rank)o=l.batchNorm3d(t,e,n,i,r,s);else{if(4!==t.rank)throw new m(`batchNormalization is not implemented for array of rank ${t.rank} yet`);o=l.batchNorm4d(t,e,n,i,r,s)}return o}gr.className="AlphaDropout",l.serialization.registerClass(gr);class vr extends Me{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Zt(t.betaInitializer||"zeros"),this.gammaInitializer=Zt(t.gammaInitializer||"ones"),this.movingMeanInitializer=Zt(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Zt(t.movingVarianceInitializer||"ones"),this.betaConstraint=Y(t.betaConstraint),this.gammaConstraint=Y(t.gammaConstraint),this.betaRegularizer=Oi(t.betaRegularizer),this.gammaRegularizer=Oi(t.gammaRegularizer)}build(t){t=Te(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new p(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape `+JSON.stringify(t)+".");this.inputSpec=[new _e({ndim:t.length,axes:{[e]:n}})];const i=[n];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return Object(l.tidy)(()=>{const n=null!=e.training&&e.training,i=we(t),r=i.shape,s=r.length,o=mt(0,s),a=this.axis>=0?this.axis:this.axis+s;o.splice(a,1);const u=y(1,s);u[a]=r[a];const c=o.slice();c.sort();const h=!l.util.arraysEqual(c,mt(0,s).slice(0,s-1));if(!n)return(()=>{if(h){const t=this.movingMean.read().reshape(u),e=this.movingVariance.read().reshape(u),n=this.center?this.beta.read().reshape(u):null,r=this.scale?this.gamma.read().reshape(u):null;return yr(i,t,e,n,r,this.epsilon)}return yr(i,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,f,p]=function(t,e,n,i,r=.001){return l.util.arraysEqual(i.slice().sort(),mt(0,t.rank-1))?function(t,e,n,i,r=.001){return Object(l.tidy)(()=>{const s=l.moments(t,i),o=s.mean,a=s.variance;return[yr(t,o,a,n,e,r),o,a]})}(t,e,n,i,r):function(t,e,n,i,r=.001){return Object(l.tidy)(()=>{const s=l.moments(t,i),o=s.mean,a=s.variance,u=[];for(const e of mt(0,t.rank))-1!==i.indexOf(e)?u.push(1):u.push(t.shape[e]);const c=o.reshape(u),h=a.reshape(u),d=null==e?null:e.reshape(u),f=null==n?null:n.reshape(u);return[yr(t,c,h,f,d,r),o,a]})}(t,e,n,i,r)}(i,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(t,e,n)=>{l.tidy(()=>{const i=1-n,r=t.read(),s=r.sub(e).mul(i);t.write(r.sub(s))})};return(()=>{m(this.movingMean,f,this.momentum),m(this.movingVariance,p,this.momentum)})(),d})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Qt(this.betaInitializer),gammaInitializer:Qt(this.gammaInitializer),movingMeanInitializer:Qt(this.movingMeanInitializer),movingVarianceInitializer:Qt(this.movingVarianceInitializer),betaRegularizer:Si(this.betaRegularizer),gammaRegularizer:Si(this.gammaRegularizer),betaConstraint:W(this.betaConstraint),gammaConstraint:W(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}vr.className="BatchNormalization",l.serialization.registerClass(vr);class br extends Me{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received "+this.axis)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(this.axis));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(this.axis))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=Zt(t.betaInitializer||"zeros"),this.gammaInitializer=Zt(t.gammaInitializer||"ones"),this.betaRegularizer=Oi(t.betaRegularizer),this.gammaRegularizer=Oi(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=Te(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let i=0;i<this.axis.length;++i)this.axis[i]<0&&(this.axis[i]+=e);for(const i of this.axis)if(i<0||i>=e)throw new Error("Invalid axis: "+i);if(this.axis.length!==k(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);const n=this.axis.map(e=>t[e]);this.gamma=this.scale?this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}call(t,e){const n=we(t),i=n.shape,r=i.length;return Object(l.tidy)(()=>{let{mean:t,variance:e}=Object(l.moments)(n,this.axis,!0);const s=y(1,r);for(const n of this.axis)s[n]=i[n];const o=t=>null!=t&&t.shape.length!==r&&this.axis!==[r-1]?t.reshape(s):t;let a=o(this.gamma.read()),u=o(this.beta.read());const c=[],h=[];for(let n=0;n<r;++n)-1!==this.axis.indexOf(n)?(c.push(i[n]),h.push(1)):(c.push(1),h.push(i[n]));return t=t.tile(c),e=e.tile(c),a=a.tile(h),u=u.tile(h),yr(n,t,e,u,a,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Qt(this.betaInitializer),gammaInitializer:Qt(this.gammaInitializer),betaRegularizer:Si(this.betaRegularizer),gammaRegularizer:Si(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}br.className="LayerNormalization",l.serialization.registerClass(br);class xr extends Me{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new p(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new p(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new p(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new _e({ndim:4})]}computeOutputShape(t){let e,n;return t=Te(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return Object(l.tidy)(()=>function(t,e,n){return Object(l.tidy)(()=>{if(4!==t.rank)throw new p("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new p("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new p(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let i;return i="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],l.pad(t,i)})}(we(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function wr(t,e,n,i,r,s){return Object(l.tidy)(()=>{let o;et(r),it(s),nt(i),null==n&&(n=[1,1]),null==i&&(i="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),t=Pi(t,r);const a="same"===i?"same":"valid";return o="max"===s?l.maxPool(t,e,n,a):l.avgPool(t,e,n,a),"channelsFirst"===r&&(o=l.transpose(o,[0,3,1,2])),o})}function Tr(t,e,n,i,r,s){return Object(l.tidy)(()=>{let o;et(r),it(s),nt(i),null==n&&(n=[1,1,1]),null==i&&(i="valid"),null==r&&(r="channelsLast"),null==s&&(s="max"),t=Fi(t,r);const a="same"===i?"same":"valid";return o="max"===s?l.maxPool3d(t,e,n,a):l.avgPool3d(t,e,n,a),"channelsFirst"===r&&(o=l.transpose(o,[0,4,1,2,3])),o})}xr.className="ZeroPadding2D",l.serialization.registerClass(xr);class Sr extends Me{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new p("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));this.poolSize=t.poolSize}if(N(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new p("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));this.strides=t.strides}N(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,nt(this.padding),this.inputSpec=[new _e({ndim:3})]}computeOutputShape(t){const e=Ni((t=Te(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Object(l.tidy)(()=>{this.invokeCallHook(t,e),t=yt(we(t),2);const n=this.poolingFunction(we(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return l.squeeze(n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class Er extends Sr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),wr(t,e,n,i,r,"max")}}Er.className="MaxPooling1D",l.serialization.registerClass(Er);class Or extends Sr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),wr(t,e,n,i,r,"avg")}}Or.className="AveragePooling1D",l.serialization.registerClass(Or);class Cr extends Me{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new p("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides];N(this.poolSize,"poolSize"),N(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,et(this.dataFormat),nt(this.padding),this.inputSpec=[new _e({ndim:4})]}computeOutputShape(t){t=Te(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Ni(e,this.poolSize[0],this.padding,this.strides[0]),n=Ni(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return Object(l.tidy)(()=>(this.invokeCallHook(t,e),this.poolingFunction(we(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class _r extends Cr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),wr(t,e,n,i,r,"max")}}_r.className="MaxPooling2D",l.serialization.registerClass(_r);class Ar extends Cr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),wr(t,e,n,i,r,"avg")}}Ar.className="AveragePooling2D",l.serialization.registerClass(Ar);class kr extends Me{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new p("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];N(this.poolSize,"poolSize"),N(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,et(this.dataFormat),nt(this.padding),this.inputSpec=[new _e({ndim:5})]}computeOutputShape(t){t=Te(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],i="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Ni(e,this.poolSize[0],this.padding,this.strides[0]),n=Ni(n,this.poolSize[1],this.padding,this.strides[1]),i=Ni(i,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,i]:[t[0],e,n,i,t[4]]}call(t,e){return Object(l.tidy)(()=>(this.invokeCallHook(t,e),this.poolingFunction(we(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Rr extends kr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),Tr(t,e,n,i,r,"max")}}Rr.className="MaxPooling3D",l.serialization.registerClass(Rr);class Ir extends kr{constructor(t){super(t)}poolingFunction(t,e,n,i,r){return et(r),nt(i),Tr(t,e,n,i,r,"avg")}}Ir.className="AveragePooling3D",l.serialization.registerClass(Ir);class Mr extends Me{constructor(t){super(t),this.inputSpec=[new _e({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new m}}class Nr extends Mr{constructor(t){super(t||{})}call(t,e){return Object(l.tidy)(()=>{const e=we(t);return l.mean(e,1)})}}Nr.className="GlobalAveragePooling1D",l.serialization.registerClass(Nr);class Dr extends Mr{constructor(t){super(t||{})}call(t,e){return Object(l.tidy)(()=>{const e=we(t);return l.max(e,1)})}}Dr.className="GlobalMaxPooling1D",l.serialization.registerClass(Dr);class Pr extends Me{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,et(this.dataFormat),this.inputSpec=[new _e({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new m}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Fr extends Pr{call(t,e){return Object(l.tidy)(()=>{const e=we(t);return l.mean(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}Fr.className="GlobalAveragePooling2D",l.serialization.registerClass(Fr);class Lr extends Pr{call(t,e){return Object(l.tidy)(()=>{const e=we(t);return l.max(e,"channelsLast"===this.dataFormat?[1,2]:[2,3])})}}function jr(t,e,n,i){if(Array.isArray(t)){if(null!=e||null!=n)throw new p("When inputs is an array, neither initialState or constants should be provided");null!=i&&(n=t.slice(t.length-i,t.length),t=t.slice(0,t.length-i)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=r(e),constants:n=r(n)}}function Br(t,e,n,i=!1,r,s,o=!1,a=!1){return l.tidy(()=>{const u=e.shape.length;if(u<3)throw new p(`Input should be at least 3D, but is ${u}D.`);const c=[1,0].concat(mt(2,u));if(e=l.transpose(e,c),null!=s)throw new m("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=r&&((r=r.asType("bool").asType("float32")).rank===u-1&&(r=l.expandDims(r,-1)),r=l.transpose(r,c)),i&&(e=l.reverse(e,0),null!=r&&(r=l.reverse(r,0)));const h=[];let d,f=n;const g=e.shape[0],y=l.unstack(e);let v,b;null!=r&&(v=l.unstack(r));for(let e=0;e<g;++e){const n=y[e],i=l.tidy(()=>t(n,f));if(null==r)d=i[0],f=i[1];else{const t=l.tidy(()=>{const t=v[e],n=l.onesLike(t).sub(t);return{output:i[0].mul(t).add(f[0].mul(n)),newStates:f.map((e,r)=>i[1][r].mul(t).add(e.mul(n)))}});d=t.output,f=t.newStates}a&&h.push(d)}return a&&(b=l.stack(h,1)),[d,b,f]})}Lr.className="GlobalMaxPooling2D",l.serialization.registerClass(Lr);class zr extends Me{constructor(t){let e;if(super(t),null==t.cell)throw new p("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new Hr({cells:t.cell}):t.cell,null==e.stateSize)throw new p("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new _e({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?mt(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null):this.states_}setStates(t){this.states_=t}computeOutputShape(t){be(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let i;if(i=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const i of e)n.push([t[0],i]);return[i].concat(n)}return i}computeMask(t,e){return l.tidy(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new m("Constants support is not implemented in RNN yet.");be(t)&&(t=t[0]),t=t,this.inputSpec[0]=new _e({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});const e=[t[0]].concat(t.slice(2));let n;if(this.cell.build(e),n=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!l.util.arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),n))throw new p(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is `+this.cell.stateSize)}else this.stateSpec=n.map(t=>new _e({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){Object(l.tidy)(()=>{if(!this.stateful)throw new d("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new p("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)this.states_=Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>l.zeros([n,t])):[l.zeros([n,this.cell.stateSize])];else if(null==t)l.dispose(this.states_),null!=this.keptStates&&(l.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>l.zeros([n,t])):this.states_[0]=l.zeros([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new p(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);!0===e?this.keptStates.push(this.states_.slice()):l.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const i=t[e],r=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,s=[n,r];if(!l.util.arraysEqual(i.shape,s))throw new p(`State ${e} is incompatible with layer ${this.name}: expected shape=${s}, received shape=${i.shape}`);this.states_[e]=i}}this.states_=this.states_.map(t=>l.keep(t.clone()))})}apply(t,e){let n=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const r=jr(t,n,i,this.numConstants);t=r.inputs,n=r.initialState,i=r.constants;let s=[],o=[];if(null!=n){e.initialState=n,s=s.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new _e({shape:t.shape}));o=o.concat(this.stateSpec)}if(null!=i&&(e.constants=i,s=s.concat(i),this.numConstants=i.length),s[0]instanceof Ae){const n=[t].concat(s),i=this.inputSpec.concat(o),r=this.inputSpec;this.inputSpec=i;const a=super.apply(n,e);return this.inputSpec=r,a}return super.apply(t,e)}call(t,e){return Object(l.tidy)(()=>{const n=null==e?null:e.mask,i=null==e?null:e.training;let r=null==e?null:e.initialState;t=we(t),null==r&&(r=this.stateful?this.states_:this.getInitialState(t));const s=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==s)throw new p(`RNN Layer has ${s} state(s) but was passed `+r.length+" initial state(s).");this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},a=Br((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]},t,r,this.goBackwards,n,null,this.unroll,this.returnSequences),u=a[0],l=a[1],c=a[2];this.stateful&&this.resetStates(c,i);const h=this.returnSequences?l:u;return this.returnState?[h].concat(c):h})}getInitialState(t){return Object(l.tidy)(()=>{let e=l.zeros(t.shape);return e=l.sum(e,[1,2]),e=yt(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?St(e,[1,t]):e):this.cell.stateSize>1?[St(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);const e=this.cell.getConfig();t.cell={className:this.cell.getClassName(),config:e};const n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,e,n={}){const i=Xe(e.cell,n);return new t(Object.assign(e,{cell:i}))}}zr.className="RNN",l.serialization.registerClass(zr);class $r extends Me{}class Ur extends $r{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,N(this.units,"units"),this.activation=vi(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Zt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Oi(t.kernelRegularizer),this.recurrentRegularizer=Oi(t.recurrentRegularizer),this.biasRegularizer=Oi(t.biasRegularizer),this.kernelConstraint=Y(t.kernelConstraint),this.recurrentConstraint=Y(t.recurrentConstraint),this.biasConstraint=Y(t.biasConstraint),this.dropout=ft([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ft([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Te(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return Object(l.tidy)(()=>{if(2!==(t=t).length)throw new p(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const i=null!=e.training&&e.training;let r;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qr(()=>l.onesLike(t),this.dropout,i)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qr(()=>l.onesLike(n),this.recurrentDropout,i));const s=this.dropoutMask,o=this.recurrentDropoutMask;r=Ot(null!=s?l.mul(t,s):t,this.kernel.read()),null!=this.bias&&(r=kt(r,this.bias.read())),null!=o&&(n=l.mul(n,o));let a=l.add(r,Ot(n,this.recurrentKernel.read()));return null!=this.activation&&(a=this.activation.apply(a)),[a,a]})}getConfig(){const t={units:this.units,activation:gi(this.activation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return Object.assign(t,e),t}}Ur.className="SimpleRNNCell",l.serialization.registerClass(Ur);class Wr extends zr{constructor(t){t.cell=new Ur(t),super(t)}call(t,e){return Object(l.tidy)(()=>(null!=this.cell.dropoutMask&&(l.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(l.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}getConfig(){const t={units:this.units,activation:gi(this.activation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return new t(e)}}Wr.className="SimpleRNN",l.serialization.registerClass(Wr);class Vr extends $r{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new p("GRUCell does not support reset_after parameter set to true.");this.units=t.units,N(this.units,"units"),this.activation=vi(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=vi(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Zt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Oi(t.kernelRegularizer),this.recurrentRegularizer=Oi(t.recurrentRegularizer),this.biasRegularizer=Oi(t.biasRegularizer),this.kernelConstraint=Y(t.kernelConstraint),this.recurrentConstraint=Y(t.recurrentConstraint),this.biasConstraint=Y(t.biasConstraint),this.dropout=ft([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ft([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Te(t),this.kernel=this.addWeight("kernel",[t[t.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}call(t,e){return Object(l.tidy)(()=>{if(2!==(t=t).length)throw new p("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");const n=null!=e.training&&e.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qr(()=>l.onesLike(t),this.dropout,n,3)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qr(()=>l.onesLike(i),this.recurrentDropout,n,3));const r=this.recurrentDropoutMask;let s,o,a;0<this.dropout&&this.dropout<1&&(t=l.mul(t,this.dropoutMask[0]));let u=Ot(t,this.kernel.read());this.useBias&&(u=kt(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=l.mul(i,r[0]));const c=this.recurrentKernel.read(),[h,d]=l.split(c,[2*this.units,this.units],c.rank-1),f=Ot(i,h),[m,g,y]=l.split(u,3,u.rank-1),[v,b]=l.split(f,2,f.rank-1);s=this.recurrentActivation.apply(l.add(m,v)),o=this.recurrentActivation.apply(l.add(g,b));const x=Ot(l.mul(o,i),d);a=this.activation.apply(l.add(y,x));const w=l.add(l.mul(s,i),l.mul(l.add(1,l.neg(s)),a));return[w,w]})}getConfig(){const t={units:this.units,activation:gi(this.activation),recurrentActivation:gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},e=super.getConfig();return Object.assign(t,e),t}}Vr.className="GRUCell",l.serialization.registerClass(Vr);class Yr extends zr{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Vr(t),super(t)}call(t,e){return Object(l.tidy)(()=>(null!=this.cell.dropoutMask&&(l.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(l.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:gi(this.activation),recurrentActivation:gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}Yr.className="GRU",l.serialization.registerClass(Yr);class Gr extends $r{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,N(this.units,"units"),this.activation=vi(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=vi(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=Zt(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Zt(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Zt(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Oi(t.kernelRegularizer),this.recurrentRegularizer=Oi(t.recurrentRegularizer),this.biasRegularizer=Oi(t.biasRegularizer),this.kernelConstraint=Y(t.kernelConstraint),this.recurrentConstraint=Y(t.recurrentConstraint),this.biasConstraint=Y(t.biasConstraint),this.dropout=ft([1,pt([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=ft([1,pt([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;let n;if(t=Te(t),this.kernel=this.addWeight("kernel",[t[t.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,i=this.units;n=new((e=class extends Dt{apply(e,n){const r=t.apply([i]),s=(new Ft).apply([i]),o=t.apply([2*i]);return Tt(Tt(r,s),o)}}).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return Object(l.tidy)(()=>{const n=null!=e.training&&e.training;if(3!==(t=t).length)throw new p("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");let i=t[1];const r=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=qr(()=>l.onesLike(t),this.dropout,n,4)),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=qr(()=>l.onesLike(i),this.recurrentDropout,n,4));const s=this.recurrentDropoutMask;let o,a,u,c;0<this.dropout&&this.dropout<1&&(t=l.mul(t,this.dropoutMask[0]));let h=Ot(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=l.mul(i,s[0])),h=l.add(h,Ot(i,this.recurrentKernel.read())),this.useBias&&(h=kt(h,this.bias.read()));const[d,f,m,g]=l.split(h,4,h.rank-1);o=this.recurrentActivation.apply(d),a=this.recurrentActivation.apply(f),u=l.add(l.mul(a,r),l.mul(o,this.activation.apply(m))),c=this.recurrentActivation.apply(g);const y=l.mul(c,this.activation.apply(u));return[y,y,u]})}getConfig(){const t={units:this.units,activation:gi(this.activation),recurrentActivation:gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return Object.assign(t,e),t}}Gr.className="LSTMCell",l.serialization.registerClass(Gr);class Xr extends zr{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Gr(t),super(t)}call(t,e){return Object(l.tidy)(()=>(null!=this.cell.dropoutMask&&(l.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(l.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),super.call(t,{mask:null==e?null:e.mask,training:null==e?null:e.training,initialState:null==e?null:e.initialState})))}get units(){return this.cell.units}get activation(){return this.cell.activation}get recurrentActivation(){return this.cell.recurrentActivation}get useBias(){return this.cell.useBias}get kernelInitializer(){return this.cell.kernelInitializer}get recurrentInitializer(){return this.cell.recurrentInitializer}get biasInitializer(){return this.cell.biasInitializer}get unitForgetBias(){return this.cell.unitForgetBias}get kernelRegularizer(){return this.cell.kernelRegularizer}get recurrentRegularizer(){return this.cell.recurrentRegularizer}get biasRegularizer(){return this.cell.biasRegularizer}get kernelConstraint(){return this.cell.kernelConstraint}get recurrentConstraint(){return this.cell.recurrentConstraint}get biasConstraint(){return this.cell.biasConstraint}get dropout(){return this.cell.dropout}get recurrentDropout(){return this.cell.recurrentDropout}get implementation(){return this.cell.implementation}getConfig(){const t={units:this.units,activation:gi(this.activation),recurrentActivation:gi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Qt(this.kernelInitializer),recurrentInitializer:Qt(this.recurrentInitializer),biasInitializer:Qt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Si(this.kernelRegularizer),recurrentRegularizer:Si(this.recurrentRegularizer),biasRegularizer:Si(this.biasRegularizer),activityRegularizer:Si(this.activityRegularizer),kernelConstraint:W(this.kernelConstraint),recurrentConstraint:W(this.recurrentConstraint),biasConstraint:W(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},e=super.getConfig();return delete e.cell,Object.assign(t,e),t}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}Xr.className="LSTM",l.serialization.registerClass(Xr);class Hr extends $r{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return Object(l.tidy)(()=>{let n=(t=t).slice(1);const i=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?i.push(n.splice(0,t.stateSize.length)):i.push(n.splice(0,1));i.reverse();const r=[];let s;for(let o=0;o<this.cells.length;++o){const a=this.cells[o];n=i[o],s=0===o?[t[0]].concat(n):[s[0]].concat(n),s=a.call(s,e),r.push(s.slice(1))}n=[];for(const t of r.slice().reverse())n.push(...t);return[s[0]].concat(n)})}build(t){let e;be(t)&&(t=t[0]),t=t,this.cells.forEach((n,i)=>{st("RNNCell_"+i,()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=[];for(const i of this.cells)t.push({className:i.getClassName(),config:i.getConfig()});const e={cells:t},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(t,e,n={}){const i=[];for(const r of e.cells)i.push(Xe(r,n));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return Oe(t)}setWeights(t){const e=[];for(const n of this.cells){const i=t.splice(n.weights.length);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}Ce(e)}}function qr(t,e,n=null,i=1){function r(){return Rt(t(),e)}if(i>1){const e=[];for(let s=0;s<i;s++)e.push(It(r,t,n));return e.map(t=>l.keep(t.clone()))}return l.keep(It(r,t,n).clone())}Hr.className="StackedRNNCells",l.serialization.registerClass(Hr);class Kr extends Me{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const i=Xe(e.layer,n);delete e.layer;const r={layer:i};return Object.assign(r,e),new t(r)}}class Jr extends Kr{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=Te(t)).length<3)throw new p("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=Te(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))}call(t,e){return Object(l.tidy)(()=>Br((t,n)=>[we(this.layer.call(t,e)),[]],t=we(t),[],!1,null,null,!1,!0)[1])}}Jr.className="TimeDistributed",l.serialization.registerClass(Jr);class Qr extends Kr{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=Xe(n),e.goBackwards=!0!==e.goBackwards;const i={};if(i.className=t.layer.getClassName(),i.config=e,this.backwardLayer=Xe(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,I(Z,"BidirectionalMergeMode",this.mergeMode),t.weights)throw new m("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))}computeOutputShape(t){let e,n,i,r=this.forwardLayer.computeOutputShape(t);return Array.isArray(r)&&Array.isArray(r[0])||(r=[r]),r=r,this.returnState?(i=r.slice(1),e=r[0]):e=r[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(i).concat(i.slice()):[e].concat(i).concat(i.slice()):x(n)}apply(t,e){let n=null==e?null:e.initialState,i=null==e?null:e.constants;null==e&&(e={});const r=jr(t,n,i,this.numConstants);if(t=r.inputs,n=r.initialState,i=r.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==i)return super.apply(t,e);const s=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new p("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,s.push(...n);const i=n.map(t=>new _e({shape:t.shape}));this.forwardLayer.stateSpec=i.slice(0,t/2),this.backwardLayer.stateSpec=i.slice(t/2),o.push(...i)}if(null!=i)throw new m("Support for constants in Bidirectional layers is not implemented yet.");const a=s[0]instanceof Ae;for(const u of s)if(u instanceof Ae!==a)throw new p("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(a){const n=[t].concat(s),i=this.inputSpec.concat(o),r=this.inputSpec;this.inputSpec=i;const a=super.apply(n,e);return this.inputSpec=r,a}return super.apply(t,e)}call(t,e){return Object(l.tidy)(()=>{const n=e.initialState;let i,r,s,o;if(null==n)i=this.forwardLayer.call(t,e),r=this.backwardLayer.call(t,e);else{const s=n.slice(0,n.length/2),o=n.slice(n.length/2);i=this.forwardLayer.call(t,Object.assign(e,{initialState:s})),r=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(i)&&(s=i.slice(1).concat(r.slice(1))),i=i[0],r=r[0]),this.returnSequences&&(r=l.reverse(r,1)),"concat"===this.mergeMode?o=wt([i,r]):"sum"===this.mergeMode?o=l.add(i,r):"ave"===this.mergeMode?o=l.mul(.5,l.add(i,r)):"mul"===this.mergeMode?o=l.mul(i,r):null==this.mergeMode&&(o=[i,r]),this.returnState?null==this.mergeMode?o.concat(s):[o].concat(s):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){st(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),st(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Xe(e.layer);if(delete e.layer,null!=e.numConstants)throw new m("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=e;return i.layer=n,new t(i)}}function Zr(t){return new De(t)}function ts(t){return new ki(t)}function es(t){return new Ci(t)}function ns(t){return new _i(t)}function is(t){return new Ai(t)}function rs(t){return new Ii(t)}function ss(t){return new Ri(t)}function os(t){return new Yi(t)}function as(t){return new zi(t)}function us(t){return new Ui(t)}function ls(t){return new $i(t)}function cs(t){return new Vi(t)}function hs(t){return new Gi(t)}function ds(t){return new Xi(t)}function fs(t){return new Hi(t)}function ps(t){return new Zi(t)}function ms(t){return new Ji(t)}function gs(t){return new qi(t)}function ys(t){return new Ki(t)}function vs(t){return new Qi(t)}function bs(t){return new tr(t)}function xs(t){return new er(t)}function ws(t){return new nr(t)}function Ts(t){return new rr(t)}function Ss(t){return new or(t)}function Es(t){return new ur(t)}function Os(t){return new hr(t)}function Cs(t){return new lr(t)}function _s(t){return new cr(t)}function As(t){return new ar(t)}function ks(t){return new fr(t)}function Rs(t){return new vr(t)}function Is(t){return new br(t)}function Ms(t){return new xr(t)}function Ns(t){return new Or(t)}function Ds(t){return Ns(t)}function Ps(t){return Ns(t)}function Fs(t){return new Ar(t)}function Ls(t){return Fs(t)}function js(t){return Fs(t)}function Bs(t){return new Ir(t)}function zs(t){return Bs(t)}function $s(t){return Bs(t)}function Us(t){return new Nr(t)}function Ws(t){return new Fr(t)}function Vs(t){return new Dr(t)}function Ys(t){return new Lr(t)}function Gs(t){return new Er(t)}function Xs(t){return new _r(t)}function Hs(t){return new Rr(t)}function qs(t){return new Yr(t)}function Ks(t){return new Vr(t)}function Js(t){return new Xr(t)}function Qs(t){return new Gr(t)}function Zs(t){return new Wr(t)}function to(t){return new Ur(t)}function eo(t){return new zr(t)}function no(t){return new Hr(t)}function io(t){return new Qr(t)}function ro(t){return new Jr(t)}Qr.className="Bidirectional",l.serialization.registerClass(Qr);const so=Vs,oo=Ys,ao=Gs,uo=Xs;function lo(t){return new pr(t)}function co(t){return new mr(t)}function ho(t){return new gr(t)}function fo(t){return new ir(t)}function po(t,e){return sn(t,e)}function mo(t,e){return ln(t,e)}function go(t,e){return cn(t,e)}function yo(t,e){return on(t,e)}function vo(t,e){return hn(t,e)}function bo(t,e){return un(t,e)}function xo(t,e){return function(t,e){return Object(l.tidy)(()=>{const n=an(t,e),i=function(t,e){return Object(l.tidy)(()=>l.logicalAnd(t.equal(1),e.equal(0)).sum().cast("float32"))}(t,e),r=n.add(i);return l.where(l.greater(r,0),n.div(r),0).cast("float32")})}(t,e)}function wo(t,e){return en(t,e)}function To(t,e){return Ke(t,e)}function So(t,e){return Je(t,e)}function Eo(t,e){return Je(t,e)}function Oo(t,e){return Je(t,e)}function Co(t,e){return qe(t,e)}function _o(t,e){return qe(t,e)}function Ao(t,e){return qe(t,e)}function ko(t){return new wi(t)}function Ro(t){return bi(e=t),new wi({l1:null!=e?e.l1:null,l2:0});var e}function Io(t){return bi(e=t),new wi({l2:null!=e?e.l2:null,l1:0});var e}class Mo extends Be{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof qn))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function No(t,e){return t<e}function Do(t,e){return t>e}class Po extends Mo{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new m("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.monitorFunc="min"===this.mode?No:"max"===this.mode||-1!==this.monitor.indexOf("acc")?Do:No,this.monitorFunc===No&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,this.best=null!=this.baseline?this.baseline:this.monitorFunc===No?1/0:-1/0}async onEpochEnd(t,e){await Fe(e);const n=this.getMonitorValue(e);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: `+Object.keys(t)),e}}const Fo={earlyStopping:function(t){return new Po(t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"array",function(){return l}),n.d(e,"Dataset",function(){return a}),n.d(e,"zip",function(){return c}),n.d(e,"CSVDataset",function(){return b}),n.d(e,"TextLineDataset",function(){return d}),n.d(e,"csv",function(){return A}),n.d(e,"func",function(){return k}),n.d(e,"generator",function(){return R}),n.d(e,"microphone",function(){return M}),n.d(e,"webcam",function(){return I}),n.d(e,"FileDataSource",function(){return C}),n.d(e,"URLDataSource",function(){return _}),n.d(e,"version_data",function(){return N});var i=n(0),r=n(20),s=n(14),o=n(19);class a{constructor(){this.size=null}batch(t,e=!0){const n=this;let r;return i.util.assert(t>0,()=>"batchSize needs to be positive, but it is\n      "+t),r=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),u(async()=>(await n.iterator()).columnMajorBatch(t,e,h),r)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,u(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,u(async()=>(await e.iterator()).filter(e=>i.tidy(()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return u(async()=>(await e.iterator()).map(e=>i.tidy(()=>t(e))),this.size)}mapAsync(t){const e=this;return u(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return u(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,u(async()=>{const n=Object(s.e)(async()=>({value:await e.iterator(),done:!1}));return Object(s.d)(n.take(t))},n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,u(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const s=this,o=r.alea(e||i.util.now().toString());return u(async()=>{let e=o.int32();return n&&(e+=o.int32()),(await s.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,u(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function u(t,e=null){return new class extends a{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function l(t){return u(async()=>Object(s.f)(t),t.length)}function c(t){if(!Object(o.e)(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=null==e?t[n].size:Math.min(e,t[n].size);return u(async()=>{const e=await Object(o.c)(t,t=>{if(t instanceof a)return{value:t.iterator(),recurse:!1};if(Object(o.e)(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Object(s.g)(e,s.c.SHORTEST)},e)}function h(t){if(null===t)return null;const e=t[0];return Object(o.a)(e)?{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof i.Tensor?i.stack(t):i.tensor(t)}(t),recurse:!1}:{value:null,recurse:!0}}a.MAX_BUFFER_SIZE=1e4;class d extends a{constructor(t){super(),this.input=t}async iterator(){return(await this.input.iterator()).decodeUTF8().split("\n").map(t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t))}}const f='"',p=Symbol("out"),m=Symbol("field"),g=Symbol("quote"),y=Symbol("quoteafterquote"),v=Symbol("quoteinquote");class b extends a{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new d(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(i.util.assert(null==e.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&i.util.assert(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const e=this.fullColumnNames.reduce((t,e)=>(t[e]=t[e]+1||1,t),{}),n=Object.keys(e).filter(t=>e[t]>1);if(i.util.assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs)for(const i of Object.keys(this.columnConfigs))if(-1===this.fullColumnNames.indexOf(i))throw new Error('The key "'+i+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await this.base.iterator(),e=await t.next();if(e.done)throw new Error("No data was found for CSV parsing.");return this.parseRow(e.value,!1)}return null}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(t=>this.makeDataElement(t))}makeDataElement(t){const e=this.parseRow(t),n={},i={};for(let r=0;r<this.fullColumnNames.length;r++){const s=this.fullColumnNames[r],o=this.columnConfigs?this.columnConfigs[s]:null;if(!this.configuredColumnsOnly||o){const a=e[r];let u=null;if(""===a)if(o&&void 0!==o.default)u=o.default;else{if(o&&(o.required||o.isLabel))throw new Error(`Required column ${s} is empty in this line: ${t}`);u=void 0}else{const t=Number(a);if(isNaN(t))u=o&&"bool"===o.dtype?this.getBoolean(a):a;else if(o&&o.dtype)switch(o.dtype){case"float32":u=t;break;case"int32":u=Math.floor(t);break;case"bool":u=this.getBoolean(a);break;default:u=t}else u=t}o&&o.isLabel?i[s]=u:n[s]=u}}return 0===Object.keys(i).length?n:{xs:n,ys:i}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t,e=!0){const n=[];let i=0;const r=t.length;let s=p;for(let o=0;o<r;o++)switch(s){case p:switch(t.charAt(o)){case f:i=o+1,s=g;break;case this.delimiter:if(i=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),s=p;break;default:s=m,i=o}break;case m:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(i,o)),s=p,i=o+1}break;case g:switch(t.charAt(o)){case f:s=y}break;case y:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(i,o-1)),s=p,i=o+1;break;case f:s=g;break;default:s=v}break;case v:switch(t.charAt(o)){case f:s=g}}if(n.push(s===y?t.substring(i,r-1):t.substring(i)),e&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}}class x extends s.a{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+this.fftSize);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(Object(i.env)().get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");const e=new x(t);return await e.start(),e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: "+n.message)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: `+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;const e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,e;const n=await this.getAudioData();if(this.includeSpectrogram){const e=this.flattenQueue(n.freqDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const t=this.flattenQueue(n.timeDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],e=[];let n=0;return new Promise(i=>{const r=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(r),i({freqDataQueue:t,timeDataQueue:e}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((t,i)=>n.set(t,i*e)),n}getTensorFromAudioDataArray(t,e){const n=new Float32Array(i.util.sizeFromShape(e));return n.set(t,n.length-t.length),Object(i.tensor)(n,e)}}class w extends s.a{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Object(i.tensor1d)([0],"int32"),this.webcamConfig.centerCrop){const t=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,e=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-t)/2,r=(1-e)/2,s=n+t,o=e+r;this.cropBox=Object(i.tensor2d)([r,n,o,s],[1,4])}else this.cropBox=Object(i.tensor2d)([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,e={}){if(Object(i.env)().get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const n=new w(t,e);return await n.start(),n}async start(){this.webcamConfig.facingMode&&i.util.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message="Error thrown while initializing video stream: "+t.message,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=i.browser.fromPixels(this.webcamVideoElement)}catch(e){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(e))}if(!this.resize)return{value:t,done:!1};try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(e){throw new Error("Error thrown cropping the video: "+e.message)}finally{t.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return Object(i.tidy)(()=>{const e=t.toFloat().expandDims(0);let n;return n=i.image.cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear"),n.reshape(n.shape.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}class T{}var S=n(57);class E extends S.a{constructor(t,e={}){super(),this.file=t,this.options=e,i.util.assert(t instanceof Uint8Array||!!Object(i.env)().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return"FileChunks "+this.file}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise((t,e)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,n)));else{const i=new FileReader;i.onload=n=>{let r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=t=>e(new Error("Aborted")),i.onerror=t=>e(new Error(t.type));const r=this.file.slice(this.offset,n);i.readAsArrayBuffer(r)}this.offset=n});return{value:await t,done:!1}}}function O(t){return"string"==typeof t&&"file://"===t.substr(0,7)}class C extends T{constructor(t,e={}){super(),this.input=t,this.options=e}async iterator(){if(O(this.input)&&Object(i.env)().get("IS_NODE")){const t=n(79);this.input=t.readFileSync(this.input.substr(7))}return new E(this.input,this.options)}}class _ extends T{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}async iterator(){return O(this.url)?new C(this.url,this.fileOptions).iterator():async function(t,e={}){let n,r;var s;"string"==typeof t?n=t:(n=t.url,r={method:(s=t).method,headers:s.headers,body:s.body,mode:s.mode,credentials:s.credentials,cache:s.cache,redirect:s.redirect,referrer:s.referrer,integrity:s.integrity});const o=await i.util.fetch(n,r);if(o.ok){const t=new Uint8Array(await o.arrayBuffer());return new E(t,e)}throw new Error(o.statusText)}(this.url,this.fileOptions)}}function A(t,e={}){return new b(new _(t),e)}function k(t){const e=Object(s.e)(t);return u(async()=>e)}function R(t){return u(async()=>{const e=await t();return Object(s.e)(()=>e.next())})}async function I(t,e){return w.create(t,e)}async function M(t){return x.create(t)}const N="2.0.1"},function(t,e,n){"use strict";n.r(e),n.d(e,"MathBackendCPU",function(){return r.a}),n.d(e,"version_cpu",function(){return r.c}),n.d(e,"shared",function(){return r.b});var i=n(0),r=n(31),s=n(9);function o(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:({inputs:n,backend:i})=>{const{a:r,b:o}=n,a=i;Object(s.a)([r,o],t);const u=a.data.get(r.dataId).values,l=a.data.get(o.dataId).values,[c,h]=e(r.shape,o.shape,u,l,r.dtype);return{dataId:a.write(c,h,r.dtype),shape:h,dtype:r.dtype}}}}function a(t){return(e,n,r,s,o)=>{const a=i.backend_util.assertAndGetBroadcastShape(e,n),u=a.length,l=i.util.computeStrides(a),c=i.util.sizeFromShape(a),h=i.util.getTypedArrayFromDType(o,c),d=e.length,f=n.length,p=i.util.computeStrides(e),m=i.util.computeStrides(n),g=i.backend_util.getBroadcastDims(e,a),y=i.backend_util.getBroadcastDims(n,a);if(g.length+y.length===0)for(let i=0;i<h.length;++i)h[i]=t(r[i%r.length],s[i%s.length]);else for(let v=0;v<h.length;++v){const e=i.util.indexToLoc(v,u,l),n=e.slice(-d);g.forEach(t=>n[t]=0);const o=i.util.locToIndex(n,d,p),a=e.slice(-f);y.forEach(t=>a[t]=0);const c=i.util.locToIndex(a,f,m);h[v]=t(r[o],s[c])}return[h,a]}}const u=a((t,e)=>t/e),l=o(i.Div,u);var c=n(37),h=n(30);const d={kernelName:i.Max,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{reductionIndices:o}=e,a=n;let u=r.shape;const l=u.length;let d=i.util.parseAxisParam(o,u);const f=i.backend_util.getAxesPermutation(d,l);let p=a.data.get(r.dataId).values;if(null!=f){const t=new Array(l);for(let e=0;e<t.length;e++)t[e]=u[f[e]];p=Object(h.a)(p,u,r.dtype,f,t),d=i.backend_util.getInnerMostAxes(d.length,l),u=t}Object(s.a)(r,"max"),i.backend_util.assertAxesAreInnerMostDims("max",d,l);const[m,g]=i.backend_util.computeOutAndReduceShapes(u,d),y=i.util.sizeFromShape(g),v=Object(c.a)(p,y,m,r.dtype);return{dataId:a.write(v,m,r.dtype),shape:m,dtype:r.dtype}}};var f=n(26);const p={kernelName:i.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:o,strides:a,pad:u,includeBatchInIndex:l}=e,c=n;Object(s.a)(r,"MaxPoolWithArgmax");const h=c.data.get(r.dataId).values,d=i.backend_util.computePool2DInfo(r.shape,o,a,[1,1],u),[p,m]=function(t,e,n,r,s){const o=i.util.computeStrides(e),a=Object(f.b)(t,e,n,o,s,"max"),u=Object(f.a)(t,e,n,s,!0,r);return[a.values,u.values]}(h,r.shape,r.dtype,l,d),g=c.write(p,d.outShape,r.dtype),y=c.write(m,d.outShape,r.dtype);return[{dataId:g,shape:d.outShape,dtype:r.dtype},{dataId:y,shape:d.outShape,dtype:"int32"}]}},m=i.kernel_impls.nonMaxSuppressionV5,g={kernelName:i.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{boxes:i,scores:r}=t,{maxOutputSize:o,iouThreshold:a,scoreThreshold:u,softNmsSigma:l}=n,c=e;Object(s.a)(i,"NonMaxSuppressionWithScore");const h=c.data.get(i.dataId).values,d=c.data.get(r.dataId).values,f=o,p=a,g=u,y=l,{selectedIndices:v,selectedScores:b}=m(h,d,f,p,g,y);return[v,b]}},y={kernelName:i.Square,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,i=e;Object(s.a)(n,"square");const r=i.data.get(n.dataId).values,o=new Float32Array(r.length);for(let s=0;s<r.length;++s){const t=r[s];o[s]=t*t}return{dataId:i.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},v=a((t,e)=>{const n=t-e;return n*n}),b=[g,y,o(i.SquaredDifference,v),l,{kernelName:i.Transpose,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{perm:r}=e,o=n;Object(s.a)(i,"transpose");const a=new Array(i.shape.length);for(let s=0;s<a.length;s++)a[s]=i.shape[r[s]];const u=o.data.get(i.dataId).values,l=Object(h.a)(u,i.shape,i.dtype,r,a);return{dataId:o.write(l,a,i.dtype),shape:a,dtype:i.dtype}}},p,d];for(const x of b)Object(i.registerKernel)(x);Object(i.registerBackend)("cpu",()=>new r.a,1)},function(t,e,n){"use strict";n.r(e),n(60),n(80);var i={moveTickSize:50,videoElementId:"webgazerVideoFeed",videoElementCanvasId:"webgazerVideoCanvas",faceOverlayId:"webgazerFaceOverlay",faceFeedbackBoxId:"webgazerFaceFeedbackBox",gazeDotId:"webgazerGazeDot",videoViewerWidth:320,videoViewerHeight:240,faceFeedbackBoxRatio:.66,showVideo:!0,mirrorVideo:!0,showFaceOverlay:!0,showFaceFeedbackBox:!0,showGazeDot:!0,camConstraints:{video:{width:{min:320,ideal:640,max:1920},height:{min:240,ideal:480,max:1080},facingMode:"user"}},dataTimestep:50,showVideoPreview:!0,applyKalmanFilter:!0,storingPoints:!1};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelRequestAnimFrame=window.cancelCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.clearTimeout;var r=n(32),s=n(59);const o=function(){this.model=s.load({maxFaces:1}),this.predictionReady=!1};o.prototype.positionsArray=null,o.prototype.getEyePatches=async function(t,e,n){if(0===t.width)return null;const i=await this.model,r=await i.estimateFaces(t);if(0==r.length)return!1;this.positionsArray=r[0].scaledMesh;const s=this.positionsArray;var o=Math.round(Math.min(s[247][0],s[130][0],s[25][0])),a=Math.round(Math.min(s[247][1],s[27][1],s[190][1])),u=Math.round(Math.max(s[190][0],s[243][0],s[233][0])-o),l=Math.round(Math.max(s[25][1],s[23][1],s[112][1])-a),c=Math.round(Math.min(s[414][0],s[463][0],s[453][0])),h=Math.round(Math.min(s[414][1],s[257][1],s[467][1])),d=Math.round(Math.max(s[467][0],s[359][0],s[255][0])-c),f=Math.round(Math.max(s[341][1],s[253][1],s[255][1])-h);if(0===u||0===d)return console.log("an eye patch had zero width"),null;if(0===l||0===f)return console.log("an eye patch had zero height"),null;var p={},m=t.getContext("2d").getImageData(o,a,u,l);p.left={patch:m,imagex:o,imagey:a,width:u,height:l};var g=t.getContext("2d").getImageData(c,h,d,f);return p.right={patch:g,imagex:c,imagey:h,width:d,height:f},this.predictionReady=!0,p},o.prototype.getPositions=function(){return this.positionsArray},o.prototype.reset=function(){console.log("Unimplemented; Tracking.js has no obvious reset function")},o.prototype.drawFaceOverlay=function(t,e){if(e){t.fillStyle="#32EEDB",t.strokeStyle="#32EEDB",t.lineWidth=.5;for(let n=0;n<e.length;n++){const i=e[n][0],r=e[n][1];t.beginPath(),t.arc(i,r,1,0,2*Math.PI),t.closePath(),t.fill()}}},o.prototype.name="TFFaceMesh";var a=o,u=n(12);const l={transpose:function(t){for(var e=t.length,n=t[0].length,i=new Array(n),r=0;r<e;r++)for(var s=0;s<n;s++)0===r&&(i[s]=new Array(e)),i[s][r]=t[r][s];return i},getMatrix:function(t,e,n,i){for(var r=new Array(e.length),s=i-n+1,o=0;o<e.length;o++){r[o]=new Array(s);for(var a=n;a<=i;a++)r[o][a-n]=t[e[o]][a]}return r},getSubMatrix:function(t,e,n,i,r){for(var s=r-i+1,o=new Array(n-e+1),a=e;a<=n;a++){var u=a-e;o[u]=new Array(s);for(var l=i;l<=r;l++)o[u][l-i]=t[a][l]}return o},mult:function(t,e){e.length!=t[0].length&&console.log("Matrix inner dimensions must agree:");for(var n=new Array(t.length),i=new Array(t[0].length),r=0;r<e[0].length;r++){for(var s=0;s<t[0].length;s++)i[s]=e[s][r];for(var o=0;o<t.length;o++){0===r&&(n[o]=new Array(e[0].length));var a=t[o],u=0;for(s=0;s<t[0].length;s++)u+=a[s]*i[s];n[o][r]=u}}return n},LUDecomposition:function(t,e){for(var n=new Array(t.length),i=0;i<t.length;i++){n[i]=new Array(t[0].length);for(var r=0;r<t[0].length;r++)n[i][r]=t[i][r]}var s=t.length,o=t[0].length,a=new Array(s);for(i=0;i<s;i++)a[i]=i;var u=1,l=new Array,c=new Array(s);for(r=0;r<o;r++){for(i=0;i<s;i++)c[i]=n[i][r];for(i=0;i<s;i++){l=n[i];for(var h=Math.min(i,r),d=0,f=0;f<h;f++)d+=l[f]*c[f];l[r]=c[i]-=d}var p=r;for(i=r+1;i<s;i++)Math.abs(c[i])>Math.abs(c[p])&&(p=i);if(p!=r){for(f=0;f<o;f++){var m=n[p][f];n[p][f]=n[r][f],n[r][f]=m}f=a[p],a[p]=a[r],a[r]=f,u=-u}if(r<s&0!=n[r][r])for(i=r+1;i<s;i++)n[i][r]/=n[r][r]}for(e.length!=s&&console.log("Matrix row dimensions must agree."),r=0;r<o;r++)0===n[r][r]&&console.log("Matrix is singular.");var g=e[0].length,y=self.webgazer.mat.getMatrix(e,a,0,g-1);for(f=0;f<o;f++)for(i=f+1;i<o;i++)for(r=0;r<g;r++)y[i][r]-=y[f][r]*n[i][f];for(f=o-1;f>=0;f--){for(r=0;r<g;r++)y[f][r]/=n[f][f];for(i=0;i<f;i++)for(r=0;r<g;r++)y[i][r]-=y[f][r]*n[i][f]}return y},QRDecomposition:function(t,e){for(var n=new Array(t.length),i=0;i<t.length;i++){n[i]=new Array(t[0].length);for(var r=0;r<t[0].length;r++)n[i][r]=t[i][r]}for(var s,o=t.length,a=t[0].length,u=new Array(a),c=0;c<a;c++){for(s=0,i=c;i<o;i++)s=Math.hypot(s,n[i][c]);if(0!=s){for(n[c][c]<0&&(s=-s),i=c;i<o;i++)n[i][c]/=s;for(n[c][c]+=1,r=c+1;r<a;r++){var h=0;for(i=c;i<o;i++)h+=n[i][c]*n[i][r];for(h=-h/n[c][c],i=c;i<o;i++)n[i][r]+=h*n[i][c]}}u[c]=-s}for(e.length!=o&&console.log("Matrix row dimensions must agree."),r=0;r<a;r++)0===u[r]&&console.log("Matrix is rank deficient");var d=e[0].length,f=new Array(e.length);for(i=0;i<e.length;i++)f[i]=new Array(e[0].length);for(i=0;i<e.length;i++)for(r=0;r<e[0].length;r++)f[i][r]=e[i][r];for(c=0;c<a;c++)for(r=0;r<d;r++){for(h=0,i=c;i<o;i++)h+=n[i][c]*f[i][r];for(h=-h/n[c][c],i=c;i<o;i++)f[i][r]+=h*n[i][c]}for(c=a-1;c>=0;c--){for(r=0;r<d;r++)f[c][r]/=u[c];for(i=0;i<c;i++)for(r=0;r<d;r++)f[i][r]-=f[c][r]*n[i][c]}return l.getSubMatrix(f,0,a-1,0,d-1)}};var c=l;const h={Eye:function(t,e,n,i,r){this.patch=t,this.imagex=e,this.imagey=n,this.width=i,this.height=r},getEyeFeats:function(t){var e=this.resizeEye(t.left,6,6),n=this.resizeEye(t.right,6,6),i=this.grayscale(e.data,e.width,e.height),r=this.grayscale(n.data,n.width,n.height),s=[];this.equalizeHistogram(i,5,s);var o=[];this.equalizeHistogram(r,5,o);var a=Array.prototype.slice.call(s),u=Array.prototype.slice.call(o);return a.concat(u)},DataWindow:function(t,e){this.data=[],this.windowSize=t,this.index=0,this.length=0,e&&(this.data=e.slice(e.length-t,e.length),this.length=this.data.length)}};h.DataWindow.prototype.push=function(t){return this.data.length<this.windowSize?(this.data.push(t),this.length=this.data.length,this):(this.data[this.index]=t,this.index=(this.index+1)%this.windowSize,this)},h.DataWindow.prototype.get=function(t){return this.data[this.getTrueIndex(t)]},h.DataWindow.prototype.getTrueIndex=function(t){return this.data.length<this.windowSize?t:(t+this.index)%this.windowSize},h.DataWindow.prototype.addAll=function(t){for(var e=0;e<t.length;e++)this.push(t[e])},h.grayscale=function(t,e,n){for(var i=new Uint8ClampedArray(t.length>>2),r=0,s=0,o=0;o<n;o++)for(var a=0;a<e;a++)i[r++]=.299*t[s]+.587*t[s+1]+.114*t[s+2],s+=4;return i},h.equalizeHistogram=function(t,e,n){var i=t.length;n||(n=t),e||(e=5);for(var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0;s<i;s+=e)++r[t[s]];var o=255*e/i,a=0;for(s=0;s<256;++s){var u=r[s];a=u+=a,r[s]=u*o}for(s=0;s<i;++s)n[s]=r[t[s]];return n},h.threshold=function(t,e){for(let n=0;n<t.length;n++)t[n]=t[n]>e?255:0;return t},h.correlation=function(t,e){const n=Math.min(t.length,e.length);let i=0;for(let r=0;r<n;r++)t[r]===e[r]&&i++;return i/Math.max(t.length,e.length)},h.resizeEye=function(t,e,n){var i=document.createElement("canvas");i.width=t.width,i.height=t.height,i.getContext("2d").putImageData(t.patch,0,0);var r=document.createElement("canvas");return r.width=e,r.height=n,r.getContext("2d").drawImage(i,0,0,i.width,i.height,0,0,e,n),r.getContext("2d").getImageData(0,0,e,n)},h.bound=function(t){t.x<0&&(t.x=0),t.y<0&&(t.y=0);var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return t.x>e&&(t.x=e),t.y>n&&(t.y=n),t},h.DebugBox=function(t){var e;this.para=document.createElement("p"),this.div=document.createElement("div"),this.div.appendChild(this.para),document.body.appendChild(this.div),this.buttons={},this.canvas={},this.stats={},e=this,setInterval(function(){!function(t,e){var n="";for(var i in e)n+=i+": "+e[i]+"\n";t.innerText=n}(e.para,e.stats)},t||300)},h.DebugBox.prototype.set=function(t,e){this.stats[t]=e},h.DebugBox.prototype.inc=function(t,e,n){this.stats[t]||(this.stats[t]=n||0),this.stats[t]+=e||1},h.DebugBox.prototype.addButton=function(t,e){this.buttons[t]||(this.buttons[t]=document.createElement("button"),this.div.appendChild(this.buttons[t]));var n=this.buttons[t];this.buttons[t]=n,n.addEventListener("click",e),n.innerText=t},h.DebugBox.prototype.show=function(t,e){this.canvas[t]||(this.canvas[t]=document.createElement("canvas"),this.div.appendChild(this.canvas[t]));var n=this.canvas[t];n.getContext("2d").clearRect(0,0,n.width,n.height),e(n)},h.KalmanFilter=function(t,e,n,i,r,s){this.F=t,this.Q=n,this.H=e,this.R=i,this.P=r,this.X=s},h.KalmanFilter.prototype.update=function(t){for(var e=numeric.add,n=numeric.sub,i=numeric.inv,r=numeric.identity,s=c.mult,o=c.transpose,a=s(this.F,this.X),u=e(s(s(this.F,this.P),o(this.F)),this.Q),l=n(t,s(this.H,a)),h=e(s(s(this.H,u),o(this.H)),this.R),d=s(u,s(o(this.H),i(h))),f=0;f<l.length;f++)l[f]=[l[f]];return this.X=e(a,s(d,l)),this.P=s(n(r(d.length),s(d,this.H)),u),o(s(this.H,this.X))[0]};var d=h;const f={};var p=Math.pow(10,-5),m=700;function g(t,e,n){var i=e[0].length,r=new Array(i),s=c.transpose(e),o=new Array,a=!0;do{for(var l=c.mult(s,e),h=0;h<i;h++)l[h][h]=l[h][h]+n;var d=c.mult(s,t);for(h=0;h<i;h++)r[h]=d[h][0];try{for(r.length*(0!==r.length?r.length/r.length:0)!==r.length&&console.log("Array length must be a multiple of m"),o=l.length===l[0].length?u.LUsolve(u.LU(l,!0),d):c.QRDecomposition(l,d),h=0;h<i;h++)r[h]=o[h];a=!0}catch(f){n*=10,console.log(f),a=!1}}while(!a);return r}f.RidgeReg=function(){this.init()},f.RidgeReg.prototype.init=function(){this.screenXClicksArray=new d.DataWindow(m),this.screenYClicksArray=new d.DataWindow(m),this.eyeFeaturesClicks=new d.DataWindow(m),this.trailTime=1e3,this.trailDataWindow=this.trailTime/i.moveTickSize,this.screenXTrailArray=new d.DataWindow(10),this.screenYTrailArray=new d.DataWindow(10),this.eyeFeaturesTrail=new d.DataWindow(10),this.trailTimes=new d.DataWindow(10),this.dataClicks=new d.DataWindow(m),this.dataTrail=new d.DataWindow(10);var t=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]];t=u.mul(t,.1);var e=u.mul(u.identity(2),47),n=u.mul(u.identity(4),1e-4);this.kalman=new d.KalmanFilter([[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],[[1,0,0,0],[0,1,0,0]],t,e,n,[[500],[500],[0],[0]])},f.RidgeReg.prototype.addData=function(t,e,n){t&&("click"===n?(this.screenXClicksArray.push([e[0]]),this.screenYClicksArray.push([e[1]]),this.eyeFeaturesClicks.push(d.getEyeFeats(t)),this.dataClicks.push({eyes:t,screenPos:e,type:n})):"move"===n&&(this.screenXTrailArray.push([e[0]]),this.screenYTrailArray.push([e[1]]),this.eyeFeaturesTrail.push(d.getEyeFeats(t)),this.trailTimes.push(performance.now()),this.dataTrail.push({eyes:t,screenPos:e,type:n})))},f.RidgeReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],s=[],o=0;o<this.trailDataWindow;o++)this.trailTimes.get(o)>e&&(n.push(this.screenXTrailArray.get(o)),r.push(this.screenYTrailArray.get(o)),s.push(this.eyeFeaturesTrail.get(o)));var a=this.screenXClicksArray.data.concat(n),u=this.screenYClicksArray.data.concat(r),l=this.eyeFeaturesClicks.data.concat(s),c=g(a,l,p),h=g(u,l,p),f=d.getEyeFeats(t),m=0;for(o=0;o<f.length;o++)m+=f[o]*c[o];var y=0;for(o=0;o<f.length;o++)y+=f[o]*h[o];if(m=Math.floor(m),y=Math.floor(y),i.applyKalmanFilter){var v=[m,y];return{x:(v=this.kalman.update(v))[0],y:v[1]}}return{x:m,y:y}},f.RidgeReg.prototype.setData=function(t){for(var e=0;e<t.length;e++){var n=new Uint8ClampedArray(t[e].eyes.left.patch.data),i=new Uint8ClampedArray(t[e].eyes.right.patch.data);t[e].eyes.left.patch=new ImageData(n,t[e].eyes.left.width,t[e].eyes.left.height),t[e].eyes.right.patch=new ImageData(i,t[e].eyes.right.width,t[e].eyes.right.height),this.addData(t[e].eyes,t[e].screenPos,t[e].type)}},f.RidgeReg.prototype.getData=function(){return this.dataClicks.data},f.RidgeReg.prototype.name="ridge";var y=f;const v={};var b=Math.pow(10,-5),x=700;function w(t,e,n){var i=e[0].length,r=new Array(i),s=c.transpose(e),o=new Array,a=!0;do{for(var l=c.mult(s,e),h=0;h<i;h++)l[h][h]=l[h][h]+n;var d=c.mult(s,t);for(h=0;h<i;h++)r[h]=d[h][0];try{for(r.length*(0!==r.length?r.length/r.length:0)!==r.length&&console.log("Array length must be a multiple of m"),o=l.length===l[0].length?u.LUsolve(u.LU(l,!0),d):webgazer.mat.QRDecomposition(l,d),h=0;h<i;h++)r[h]=o[h];a=!0}catch(f){n*=10,console.log(f),a=!1}}while(!a);return r}v.RidgeWeightedReg=function(){this.init()},v.RidgeWeightedReg.prototype.init=function(){this.screenXClicksArray=new d.DataWindow(x),this.screenYClicksArray=new d.DataWindow(x),this.eyeFeaturesClicks=new d.DataWindow(x),this.trailTime=1e3,this.trailDataWindow=this.trailTime/i.moveTickSize,this.screenXTrailArray=new d.DataWindow(10),this.screenYTrailArray=new d.DataWindow(10),this.eyeFeaturesTrail=new d.DataWindow(10),this.trailTimes=new d.DataWindow(10),this.dataClicks=new d.DataWindow(x),this.dataTrail=new d.DataWindow(10);var t=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]];t=u.mul(t,.1);var e=u.mul(u.identity(2),47),n=u.mul(u.identity(4),1e-4);this.kalman=new d.KalmanFilter([[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],[[1,0,0,0],[0,1,0,0]],t,e,n,[[500],[500],[0],[0]])},v.RidgeWeightedReg.prototype.addData=function(t,e,n){t&&("click"===n?(this.screenXClicksArray.push([e[0]]),this.screenYClicksArray.push([e[1]]),this.eyeFeaturesClicks.push(d.getEyeFeats(t)),this.dataClicks.push({eyes:t,screenPos:e,type:n})):"move"===n&&(this.screenXTrailArray.push([e[0]]),this.screenYTrailArray.push([e[1]]),this.eyeFeaturesTrail.push(d.getEyeFeats(t)),this.trailTimes.push(performance.now()),this.dataTrail.push({eyes:t,screenPos:e,type:n})))},v.RidgeWeightedReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],s=[],o=0;o<this.trailDataWindow;o++)this.trailTimes.get(o)>e&&(n.push(this.screenXTrailArray.get(o)),r.push(this.screenYTrailArray.get(o)),s.push(this.eyeFeaturesTrail.get(o)));var a=this.eyeFeaturesClicks.data.length,u=Array(a),l=Array(a),c=Array(a);for(o=0;o<a;o++){for(var h=Math.sqrt(1/(a-o)),f=this.eyeFeaturesClicks.getTrueIndex(o),p=0;p<this.eyeFeaturesClicks.data[f].length;p++){var m=this.eyeFeaturesClicks.data[f][p]*h;void 0!==u[f]?u[f].push(m):u[f]=[m]}l[f]=this.screenXClicksArray.get(o).slice(0,this.screenXClicksArray.get(o).length),c[f]=this.screenYClicksArray.get(o).slice(0,this.screenYClicksArray.get(o).length),l[o][0]=l[o][0]*h,c[o][0]=c[o][0]*h}var g=l.concat(n),y=c.concat(r),v=u.concat(s),x=w(g,v,b),T=w(y,v,b),S=d.getEyeFeats(t),E=0;for(o=0;o<S.length;o++)E+=S[o]*x[o];var O=0;for(o=0;o<S.length;o++)O+=S[o]*T[o];if(E=Math.floor(E),O=Math.floor(O),i.applyKalmanFilter){var C=[E,O];return{x:(C=this.kalman.update(C))[0],y:C[1]}}return{x:E,y:O}},v.RidgeWeightedReg.prototype.setData=function(t){for(var e=0;e<t.length;e++){var n=new Uint8ClampedArray(t[e].eyes.left.patch.data),i=new Uint8ClampedArray(t[e].eyes.right.patch.data);t[e].eyes.left.patch=new ImageData(n,t[e].eyes.left.width,t[e].eyes.left.height),t[e].eyes.right.patch=new ImageData(i,t[e].eyes.right.width,t[e].eyes.right.height),this.addData(t[e].eyes,t[e].screenPos,t[e].type)}},v.RidgeWeightedReg.prototype.getData=function(){return this.dataClicks.data},v.RidgeWeightedReg.prototype.name="ridge";var T=v;const S={};Math.pow(10,-5);var E=700,O={X:[0],Y:[0]};S.RidgeRegThreaded=function(){this.init()},S.RidgeRegThreaded.prototype.init=function(){this.screenXClicksArray=new d.DataWindow(E),this.screenYClicksArray=new d.DataWindow(E),this.eyeFeaturesClicks=new d.DataWindow(E),this.screenXTrailArray=new d.DataWindow(10),this.screenYTrailArray=new d.DataWindow(10),this.eyeFeaturesTrail=new d.DataWindow(10),this.dataClicks=new d.DataWindow(E),this.dataTrail=new d.DataWindow(E),this.worker||(this.worker=new Worker("ridgeWorker.mjs"),this.worker.onerror=function(t){console.log(t.message)},this.worker.onmessage=function(t){O.X=t.data.X,O.Y=t.data.Y},console.log("initialized worker"));var t=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]];t=u.mul(t,.1);var e=u.mul(u.identity(2),47),n=u.mul(u.identity(4),1e-4);this.kalman=new d.KalmanFilter([[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],[[1,0,0,0],[0,1,0,0]],t,e,n,[[500],[500],[0],[0]])},S.RidgeRegThreaded.prototype.addData=function(t,e,n){t&&this.worker.postMessage({eyes:d.getEyeFeats(t),screenPos:e,type:n})},S.RidgeRegThreaded.prototype.predict=function(t){if(!t)return null;for(var e=O.X,n=O.Y,r=d.getEyeFeats(t),s=0,o=0,a=0;a<r.length;a++)s+=r[a]*e[a],o+=r[a]*n[a];if(s=Math.floor(s),o=Math.floor(o),i.applyKalmanFilter){var u=[s,o];return{x:(u=this.kalman.update(u))[0],y:u[1]}}return{x:s,y:o}},S.RidgeRegThreaded.prototype.setData=function(t){for(var e=0;e<t.length;e++){var n=new Uint8ClampedArray(t[e].eyes.left.patch.data),i=new Uint8ClampedArray(t[e].eyes.right.patch.data);t[e].eyes.left.patch=new ImageData(n,t[e].eyes.left.width,t[e].eyes.left.height),t[e].eyes.right.patch=new ImageData(i,t[e].eyes.right.width,t[e].eyes.right.height),this.addData(t[e].eyes,t[e].screenPos,t[e].type)}},S.RidgeRegThreaded.prototype.getData=function(){return this.dataClicks.data},S.RidgeRegThreaded.prototype.name="ridge";var C=S;const _={tracker:{}};_.tracker.TFFaceMesh=a,_.reg=y,_.reg.RidgeWeightedReg=T.RidgeWeightedReg,_.reg.RidgeRegThreaded=C.RidgeRegThreaded,_.util=d,_.params=i;var A=null,k=null,R=null,I=null,M=null,N=null,D="",P=new Array(50),F=new Array(50),L=performance.now(),j=null,B=null,z=!1,$=function(t,e){},U=$,W=["click","move"],V=performance.now(),Y=new _.tracker.TFFaceMesh,G=[new _.reg.RidgeReg],X={TFFacemesh:function(){return new _.tracker.TFFaceMesh}},H={ridge:function(){return new _.reg.RidgeReg},weightedRidge:function(){return new _.reg.RidgeWeightedReg},threadedRidge:function(){return new _.reg.RidgeRegThreaded}},q="webgazerGlobalData",K="webgazerGlobalSettings",J={},Q=[],Z={data:[],settings:{}};async function tt(t){var e=[];if(j=await function(t,e,n){if(t)try{return Y.getEyePatches(t,e,n)}catch(i){return console.log("can't get pupil features ",i),null}}(R,R.width,R.height),0===G.length)return console.log("regression not set, call setRegression()"),null;for(var n in G)e.push(G[n].predict(j));return void 0!==t?null===e[t]?null:{x:e[t].x,y:e[t].y,eyeFeatures:j}:0===e.length||null===e[0]?null:{x:e[0].x,y:e[0].y,eyeFeatures:j,all:e}}_.computeValidationBoxSize=function(){var t=k.videoWidth,e=k.videoHeight,n=parseInt(k.style.width),i=parseInt(k.style.height),r=Math.min(t,e),s=Math.max(t,e),o=r*_.params.faceFeedbackBoxRatio*(t==s?n/t:i/e);return[(i-o)/2,(n-o)/2,o,o]};var et=new _.util.DataWindow(4),nt=0;async function it(){if(!z){l=R.height,(a=R).width!=(u=R.width)&&(a.width=u),a.height!=l&&(a.height=l),a.getContext("2d").drawImage(k,0,0,a.width,a.height),B=tt();var t=performance.now()-L;if(_.params.showFaceOverlay){var e=_.getTracker();I.getContext("2d").clearRect(0,0,k.videoWidth,k.videoHeight),e.drawFaceOverlay(I.getContext("2d"),e.getPositions())}if(_.params.showFaceFeedbackBox&&function(){if(null!=M&&j){var t=k.videoWidth,e=k.videoHeight,n=Math.min(t,e)*_.params.faceFeedbackBoxRatio,i=(e-n)/2,r=(t-n)/2,s=r+n,o=i+n,a=j.left.imagex,u=j.left.imagey,l=j.right.imagex,c=j.right.imagey,h=!1,d=!1;a>r&&a<s&&l>r&&l<s&&(h=!0),u>i&&u<o&&c>i&&c<o&&(d=!0),M.style.border=h&&d?"solid green":"solid red"}else M.style.border="solid black"}(),B=await B,U(B,t),B){et.push(B);var n=0,i=0,r=et.length;for(var s in et.data)n+=et.get(s).x,i+=et.get(s).y;var o=_.util.bound({x:n/r,y:i/r});_.params.storingPoints&&(function(t,e,n){var i=document.getElementById("plotting_canvas").getContext("2d");i.fillStyle="blue",i.beginPath(),i.arc(e,n,5,0,2*Math.PI,!0),i.fill()}(0,o.x,o.y),_.storePoints(o.x,o.y,nt),50==++nt&&(nt=0)),_.params.showGazeDot&&(N.style.display="block"),N.style.transform="translate3d("+o.x+"px,"+o.y+"px,0)"}else N.style.display="none";requestAnimationFrame(it)}var a,u,l}var rt=function(t,e,n){if(!z){if(0===G.length)return console.log("regression not set, call setRegression()"),null;for(var i in G)j&&G[i].addData(j,[t,e],n)}},st=async function(t){rt(t.clientX,t.clientY,W[0]),window.saveDataAcrossSessions&&await async function(){var t=G[0].getData()||Q;r.setItem(K,J),r.setItem(q,t)}()},ot=function(t){if(!z){var e=performance.now();e<V+_.params.moveTickSize||(V=e,rt(t.clientX,t.clientY,W[1]))}},at=function(){document.addEventListener("click",st,!0),document.addEventListener("mousemove",ot,!0)};async function ut(t){A=t,(k=document.createElement("video")).id=_.params.videoElementId,k.srcObject=t,k.autoplay=!0,k.style.display=_.params.showVideo?"block":"none",k.style.position="fixed",k.style.top="0px",k.style.left="0px",k.style.width=_.params.videoViewerWidth+"px",k.style.height=_.params.videoViewerHeight+"px",(R=document.createElement("canvas")).id=_.params.videoElementCanvasId,R.style.display="none",(I=document.createElement("canvas")).id=_.params.faceOverlayId,I.style.display=_.params.showFaceOverlay?"block":"none",I.style.position="fixed",I.style.top="0px",I.style.left="0px",_.params.mirrorVideo&&(k.style.setProperty("-moz-transform","scale(-1, 1)"),k.style.setProperty("-webkit-transform","scale(-1, 1)"),k.style.setProperty("-o-transform","scale(-1, 1)"),k.style.setProperty("transform","scale(-1, 1)"),k.style.setProperty("filter","FlipH"),I.style.setProperty("-moz-transform","scale(-1, 1)"),I.style.setProperty("-webkit-transform","scale(-1, 1)"),I.style.setProperty("-o-transform","scale(-1, 1)"),I.style.setProperty("transform","scale(-1, 1)"),I.style.setProperty("filter","FlipH")),(M=document.createElement("canvas")).id=_.params.faceFeedbackBoxId,M.style.display=_.params.showFaceFeedbackBox?"block":"none",M.style.position="fixed",M.style.border="solid",(N=document.createElement("div")).id=_.params.gazeDotId,N.style.display=_.params.showGazeDot?"block":"none",N.style.position="fixed",N.style.zIndex=99999,N.style.left="-5px",N.style.top="-5px",N.style.background="red",N.style.borderRadius="100%",N.style.opacity="0.7",N.style.width="10px",N.style.height="10px",document.body.appendChild(k),k.addEventListener("timeupdate",function t(e){lt(k.videoWidth,k.videoHeight),_.setVideoViewerSize(_.params.videoViewerWidth,_.params.videoViewerHeight),document.body.appendChild(R),document.body.appendChild(I),document.body.appendChild(M),document.body.appendChild(N),e.target.removeEventListener(e.type,t)}),at(),z=!1,L=performance.now(),await it()}function lt(t,e){R&&(R.width=t,R.height=e),I&&(I.width=t,I.height=e)}_.begin=function(t){return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&window.chrome&&alert("WebGazer works only over https. If you are doing local development, you need to run a local server."),window.saveDataAcrossSessions&&async function(){J=(J=await r.getItem(K))||Z;var t=await r.getItem(q);for(var e in Q=t=t||Z,G)G[e].setData(t);console.log("loaded stored data into regression model")}(),t=t||function(){console.log("No stream")},D?(ut(D),_):(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise(function(n,i){e.call(navigator,t,n,i)}):Promise.reject(new Error("Unfortunately, your browser does not support access to the webcam through the getUserMedia API. Try to use the latest version of Google Chrome, Mozilla Firefox, Opera, or Microsoft Edge instead."))}),new Promise(async(e,n)=>{let i;try{i=await navigator.mediaDevices.getUserMedia(_.params.camConstraints),ut(i),e(_)}catch(r){t(),k=null,i=null,n(r)}}))},_.isReady=function(){return null!==R&&R.width>0},_.pause=function(){return z=!0,_},_.resume=async function(){return z?(z=!1,await it(),_):_},_.end=function(){return z=!0,document.body.removeChild(k),document.body.removeChild(R),_},_.stopVideo=function(){return A.getTracks()[0].stop(),document.body.removeChild(I),document.body.removeChild(M),_},_.detectCompatibility=function(){return void 0!==(navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)},_.showVideoPreview=function(t){return _.params.showVideoPreview=t,_.showVideo(t&&_.params.showVideo),_.showFaceOverlay(t&&_.params.showFaceOverlay),_.showFaceFeedbackBox(t&&_.params.showFaceFeedbackBox),_},_.showVideo=function(t){return _.params.showVideo=t,k&&(k.style.display=t?"block":"none"),_},_.showFaceOverlay=function(t){return _.params.showFaceOverlay=t,I&&(I.style.display=t?"block":"none"),_},_.showFaceFeedbackBox=function(t){return _.params.showFaceFeedbackBox=t,M&&(M.style.display=t?"block":"none"),_},_.showPredictionPoints=function(t){return _.params.showGazeDot=t,N&&(N.style.display=t?"block":"none"),_},_.applyKalmanFilter=function(t){return _.params.applyKalmanFilter=t,_},_.setCameraConstraints=async function(t){var e,n;if(_.params.camConstraints=t,A){_.pause(),e=A.getVideoTracks()[0];try{await e.applyConstraints(_.params.camConstraints),lt((n=e.getSettings()).width,n.height)}catch(i){return void console.log(i)}_.setVideoViewerSize(_.params.videoViewerWidth,_.params.videoViewerHeight),_.getTracker().reset(),await _.resume()}},_.setStaticVideo=function(t){return D=t,_},_.setVideoViewerSize=function(t,e){_.params.videoViewerWidth=t,_.params.videoViewerHeight=e,k.style.width=t+"px",k.style.height=e+"px",I.style.width=t+"px",I.style.height=e+"px";var n=_.computeValidationBoxSize();M.style.top=n[0]+"px",M.style.left=n[1]+"px",M.style.width=n[2]+"px",M.style.height=n[3]+"px"},_.addMouseEventListeners=function(){return at(),_},_.removeMouseEventListeners=function(){return document.removeEventListener("click",st,!0),document.removeEventListener("mousemove",ot,!0),_},_.recordScreenPosition=function(t,e){return rt(t,e,W[0]),_},_.recordScreenPosition=function(t,e,n){return rt(t,e,n),_},_.storePoints=function(t,e,n){P[n]=t,F[n]=e},_.setTracker=function(t){if(void 0===X[t]){for(var e in console.log("Invalid tracker selection"),console.log("Options are: "),X)console.log(e);return _}return Y=X[t](),_},_.setRegression=function(t){if(void 0===H[t]){for(var e in console.log("Invalid regression selection"),console.log("Options are: "),H)console.log(e);return _}return Q=G[0].getData(),(G=[H[t]()])[0].setData(Q),_},_.addTrackerModule=function(t,e){X[t]=function(){return new e}},_.addRegressionModule=function(t,e){H[t]=function(){return new e}},_.addRegression=function(t){var e=H[t]();return Q=G[0].getData(),e.setData(Q),G.push(e),_},_.setGazeListener=function(t){return U=t,_},_.clearGazeListener=function(){return U=$,_},_.setVideoElementCanvas=function(t){R=t},_.clearData=async function(){!function(){for(var t in r.clear(),G)G[t].init()}()},_.getTracker=function(){return Y},_.getRegression=function(){return G},_.getCurrentPrediction=function(){return tt()},_.params.getEventTypes=function(){return W.slice()},_.getVideoElementCanvas=function(){return R},_.getVideoPreviewToCameraResolutionRatio=function(){return[_.params.videoViewerWidth/k.videoWidth,_.params.videoViewerHeight/k.videoHeight]},_.getStoredPoints=function(){return[P,F]},e.default=_}]).default,game;!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var n=[],i=Object.getPrototypeOf,r=n.slice,s=n.flat?function(t){return n.flat.call(t)}:function(t){return n.concat.apply([],t)},o=n.push,a=n.indexOf,u={},l=u.toString,c=u.hasOwnProperty,h=c.toString,d=h.call(Object),f={},p=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},m=function(t){return null!=t&&t===t.window},g=t.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function v(t,e,n){var i,r,s=(n=n||g).createElement("script");if(s.text=t,e)for(i in y)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&s.setAttribute(i,r);n.head.appendChild(s).parentNode.removeChild(s)}function b(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?u[l.call(t)]||"object":typeof t}var x="3.5.1",w=function(t,e){return new w.fn.init(t,e)};function T(t){var e=!!t&&"length"in t&&t.length,n=b(t);return!p(t)&&!m(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}w.fn=w.prototype={jquery:x,constructor:w,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=w.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return w.each(this,t)},map:function(t){return this.pushStack(w.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(w.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var t,e,n,i,r,s,o=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof o&&(l=o,o=arguments[a]||{},a++),"object"==typeof o||p(o)||(o={}),a===u&&(o=this,a--);a<u;a++)if(null!=(t=arguments[a]))for(e in t)i=t[e],"__proto__"!==e&&o!==i&&(l&&i&&(w.isPlainObject(i)||(r=Array.isArray(i)))?(n=o[e],s=r&&!Array.isArray(n)?[]:r||w.isPlainObject(n)?n:{},r=!1,o[e]=w.extend(l,s,i)):void 0!==i&&(o[e]=i));return o},w.extend({expando:"jQuery"+(x+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==l.call(t)||(e=i(t))&&("function"!=typeof(n=c.call(e,"constructor")&&e.constructor)||h.call(n)!==d))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){v(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(T(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?w.merge(n,"string"==typeof t?[t]:t):o.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:a.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,s=t.length,o=!n;r<s;r++)!e(t[r],r)!==o&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,a=[];if(T(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&a.push(r);return s(a)},guid:1,support:f}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){u["[object "+e+"]"]=e.toLowerCase()});var S=function(t){var e,n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v,b,x="sizzle"+1*new Date,w=t.document,T=0,S=0,E=ut(),O=ut(),C=ut(),_=ut(),A=function(t,e){return t===e&&(h=!0),0},k={}.hasOwnProperty,R=[],I=R.pop,M=R.push,N=R.push,D=R.slice,P=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",j="(?:\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\["+L+"*("+j+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+j+"))|)"+L+"*\\]",z=":("+j+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",$=new RegExp(L+"+","g"),U=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),W=new RegExp("^"+L+"*,"+L+"*"),V=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),Y=new RegExp(L+"|>"),G=new RegExp(z),X=new RegExp("^"+j+"$"),H={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},q=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},st=function(){d()},ot=xt(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{N.apply(R=D.call(w.childNodes),w.childNodes)}catch(e){N={apply:R.length?function(t,e){M.apply(t,D.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function at(t,e,i,r){var s,a,l,c,h,p,y,v=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&(d(e),e=e||f,m)){if(11!==w&&(h=Z.exec(t)))if(s=h[1]){if(9===w){if(!(l=e.getElementById(s)))return i;if(l.id===s)return i.push(l),i}else if(v&&(l=v.getElementById(s))&&b(e,l)&&l.id===s)return i.push(l),i}else{if(h[2])return N.apply(i,e.getElementsByTagName(t)),i;if((s=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return N.apply(i,e.getElementsByClassName(s)),i}if(n.qsa&&!_[t+" "]&&(!g||!g.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===w&&(Y.test(t)||V.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&n.scope||((c=e.getAttribute("id"))?c=c.replace(it,rt):e.setAttribute("id",c=x)),a=(p=o(t)).length;a--;)p[a]=(c?"#"+c:":scope")+" "+bt(p[a]);y=p.join(",")}try{return N.apply(i,v.querySelectorAll(y)),i}catch(e){_(t,!0)}finally{c===x&&e.removeAttribute("id")}}}return u(t.replace(U,"$1"),e,i,r)}function ut(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function lt(t){return t[x]=!0,t}function ct(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ft(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ot(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return lt(function(e){return e=+e,lt(function(n,i){for(var r,s=t([],n.length,e),o=s.length;o--;)n[r=s[o]]&&(n[r]=!(i[r]=n[r]))})})}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},s=at.isXML=function(t){var e=(t.ownerDocument||t).documentElement;return!q.test(t.namespaceURI||e&&e.nodeName||"HTML")},d=at.setDocument=function(t){var e,r,o=t?t.ownerDocument||t:w;return o!=f&&9===o.nodeType&&o.documentElement&&(p=(f=o).documentElement,m=!s(f),w!=f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",st,!1):r.attachEvent&&r.attachEvent("onunload",st)),n.scope=ct(function(t){return p.appendChild(t).appendChild(f.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length}),n.attributes=ct(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=ct(function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(f.getElementsByClassName),n.getById=ct(function(t){return p.appendChild(t).id=x,!f.getElementsByName||!f.getElementsByName(x).length}),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n,i,r,s=e.getElementById(t);if(s){if((n=s.getAttributeNode("id"))&&n.value===t)return[s];for(r=e.getElementsByName(t),i=0;s=r[i++];)if((n=s.getAttributeNode("id"))&&n.value===t)return[s]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,s=e.getElementsByTagName(t);if("*"===t){for(;n=s[r++];)1===n.nodeType&&i.push(n);return i}return s},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},y=[],g=[],(n.qsa=Q.test(f.querySelectorAll))&&(ct(function(t){var e;p.appendChild(t).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+L+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+L+"*(?:value|"+F+")"),t.querySelectorAll("[id~="+x+"-]").length||g.push("~="),(e=f.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+L+"*name"+L+"*="+L+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")}),ct(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+L+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(n.matchesSelector=Q.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ct(function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",z)}),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),e=Q.test(p.compareDocumentPosition),b=e||Q.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==f||t.ownerDocument==w&&b(w,t)?-1:e==f||e.ownerDocument==w&&b(w,e)?1:c?P(c,t)-P(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,s=e.parentNode,o=[t],a=[e];if(!r||!s)return t==f?-1:e==f?1:r?-1:s?1:c?P(c,t)-P(c,e):0;if(r===s)return dt(t,e);for(n=t;n=n.parentNode;)o.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;o[i]===a[i];)i++;return i?dt(o[i],a[i]):o[i]==w?-1:a[i]==w?1:0}),f},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&m&&!_[e+" "]&&(!y||!y.test(e))&&(!g||!g.test(e)))try{var i=v.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){_(e,!0)}return 0<at(e,f,null,[t]).length},at.contains=function(t,e){return(t.ownerDocument||t)!=f&&d(t),b(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!=f&&d(t);var r=i.attrHandle[e.toLowerCase()],s=r&&k.call(i.attrHandle,e.toLowerCase())?r(t,e,!m):void 0;return void 0!==s?s:n.attributes||!m?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},at.escape=function(t){return(t+"").replace(it,rt)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,i=[],r=0,s=0;if(h=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[s++];)e===t[s]&&(r=i.push(s));for(;r--;)t.splice(i[r],1)}return c=null,t},r=at.getText=function(t){var e,n="",i=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=at.selectors={cacheLength:50,createPseudo:lt,match:H,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return H.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&G.test(n)&&(e=o(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|"+L+")"+t+"("+L+"|$)"))&&E(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=at.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&-1<r.indexOf(n):"$="===e?n&&r.slice(-n.length)===n:"~="===e?-1<(" "+r.replace($," ")+" ").indexOf(n):"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var s="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,d,f,p,m=s!==o?"nextSibling":"previousSibling",g=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!u&&!a,b=!1;if(g){if(s){for(;m;){for(d=e;d=d[m];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[o?g.firstChild:g.lastChild],o&&v){for(b=(f=(l=(c=(h=(d=g)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===T&&l[1])&&l[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(b=f=0)||p.pop();)if(1===d.nodeType&&++b&&d===e){c[t]=[T,f,b];break}}else if(v&&(b=f=(l=(c=(h=(d=e)[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===T&&l[1]),!1===b)for(;(d=++f&&d&&d[m]||(b=f=0)||p.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++b||(v&&((c=(h=d[x]||(d[x]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[T,b]),d!==e)););return(b-=r)===i||b%i==0&&0<=b/i}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[x]?r(e):1<r.length?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?lt(function(t,n){for(var i,s=r(t,e),o=s.length;o--;)t[i=P(t,s[o])]=!(n[i]=s[o])}):function(t){return r(t,0,n)}):r}},pseudos:{not:lt(function(t){var e=[],n=[],i=a(t.replace(U,"$1"));return i[x]?lt(function(t,e,n,r){for(var s,o=i(t,null,r,[]),a=t.length;a--;)(s=o[a])&&(t[a]=!(e[a]=s))}):function(t,r,s){return e[0]=t,i(e,null,s,n),e[0]=null,!n.pop()}}),has:lt(function(t){return function(e){return 0<at(t,e).length}}),contains:lt(function(t){return t=t.replace(et,nt),function(e){return-1<(e.textContent||r(e)).indexOf(t)}}),lang:lt(function(t){return X.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return J.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt(function(){return[0]}),last:gt(function(t,e){return[e-1]}),eq:gt(function(t,e,n){return[n<0?n+e:n]}),even:gt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:gt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:gt(function(t,e,n){for(var i=n<0?n+e:e<n?e:n;0<=--i;)t.push(i);return t}),gt:gt(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=pt(e);function vt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function xt(t,e,n){var i=e.dir,r=e.next,s=r||i,o=n&&"parentNode"===s,a=S++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,r);return!1}:function(e,n,u){var l,c,h,d=[T,a];if(u){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,u))return!0}else for(;e=e[i];)if(1===e.nodeType||o)if(c=(h=e[x]||(e[x]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=c[s])&&l[0]===T&&l[1]===a)return d[2]=l[2];if((c[s]=d)[2]=t(e,n,u))return!0}return!1}}function wt(t){return 1<t.length?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function Tt(t,e,n,i,r){for(var s,o=[],a=0,u=t.length,l=null!=e;a<u;a++)(s=t[a])&&(n&&!n(s,i,r)||(o.push(s),l&&e.push(a)));return o}function St(t,e,n,i,r,s){return i&&!i[x]&&(i=St(i)),r&&!r[x]&&(r=St(r,s)),lt(function(s,o,a,u){var l,c,h,d=[],f=[],p=o.length,m=s||function(t,e,n){for(var i=0,r=e.length;i<r;i++)at(t,e[i],n);return n}(e||"*",a.nodeType?[a]:a,[]),g=!t||!s&&e?m:Tt(m,d,t,a,u),y=n?r||(s?t:p||i)?[]:o:g;if(n&&n(g,y,a,u),i)for(l=Tt(y,f),i(l,[],a,u),c=l.length;c--;)(h=l[c])&&(y[f[c]]=!(g[f[c]]=h));if(s){if(r||t){if(r){for(l=[],c=y.length;c--;)(h=y[c])&&l.push(g[c]=h);r(null,y=[],l,u)}for(c=y.length;c--;)(h=y[c])&&-1<(l=r?P(s,h):d[c])&&(s[l]=!(o[l]=h))}}else y=Tt(y===o?y.splice(p,y.length):y),r?r(null,o,y,u):N.apply(o,y)})}function Et(t){for(var e,n,r,s=t.length,o=i.relative[t[0].type],a=o||i.relative[" "],u=o?1:0,c=xt(function(t){return t===e},a,!0),h=xt(function(t){return-1<P(e,t)},a,!0),d=[function(t,n,i){var r=!o&&(i||n!==l)||((e=n).nodeType?c(t,n,i):h(t,n,i));return e=null,r}];u<s;u++)if(n=i.relative[t[u].type])d=[xt(wt(d),n)];else{if((n=i.filter[t[u].type].apply(null,t[u].matches))[x]){for(r=++u;r<s&&!i.relative[t[r].type];r++);return St(1<u&&wt(d),1<u&&bt(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(U,"$1"),n,u<r&&Et(t.slice(u,r)),r<s&&Et(t=t.slice(r)),r<s&&bt(t))}d.push(n)}return wt(d)}return vt.prototype=i.filters=i.pseudos,i.setFilters=new vt,o=at.tokenize=function(t,e){var n,r,s,o,a,u,l,c=O[t+" "];if(c)return e?0:c.slice(0);for(a=t,u=[],l=i.preFilter;a;){for(o in n&&!(r=W.exec(a))||(r&&(a=a.slice(r[0].length)||a),u.push(s=[])),n=!1,(r=V.exec(a))&&(n=r.shift(),s.push({value:n,type:r[0].replace(U," ")}),a=a.slice(n.length)),i.filter)!(r=H[o].exec(a))||l[o]&&!(r=l[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return e?a.length:a?at.error(t):O(t,u).slice(0)},a=at.compile=function(t,e){var n,r,s,a,u,c,h=[],p=[],g=C[t+" "];if(!g){for(e||(e=o(t)),n=e.length;n--;)(g=Et(e[n]))[x]?h.push(g):p.push(g);(g=C(t,(r=p,a=0<(s=h).length,u=0<r.length,c=function(t,e,n,o,c){var h,p,g,y=0,v="0",b=t&&[],x=[],w=l,S=t||u&&i.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,O=S.length;for(c&&(l=e==f||e||c);v!==O&&null!=(h=S[v]);v++){if(u&&h){for(p=0,e||h.ownerDocument==f||(d(h),n=!m);g=r[p++];)if(g(h,e||f,n)){o.push(h);break}c&&(T=E)}a&&((h=!g&&h)&&y--,t&&b.push(h))}if(y+=v,a&&v!==y){for(p=0;g=s[p++];)g(b,x,e,n);if(t){if(0<y)for(;v--;)b[v]||x[v]||(x[v]=I.call(o));x=Tt(x)}N.apply(o,x),c&&!t&&0<x.length&&1<y+s.length&&at.uniqueSort(o)}return c&&(T=E,l=w),b},a?lt(c):c))).selector=t}return g},u=at.select=function(t,e,n,r){var s,u,l,c,h,d="function"==typeof t&&t,f=!r&&o(t=d.selector||t);if(n=n||[],1===f.length){if(2<(u=f[0]=f[0].slice(0)).length&&"ID"===(l=u[0]).type&&9===e.nodeType&&m&&i.relative[u[1].type]){if(!(e=(i.find.ID(l.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(s=H.needsContext.test(t)?0:u.length;s--&&!i.relative[c=(l=u[s]).type];)if((h=i.find[c])&&(r=h(l.matches[0].replace(et,nt),tt.test(u[0].type)&&yt(e.parentNode)||e))){if(u.splice(s,1),!(t=r.length&&bt(u)))return N.apply(n,r),n;break}}return(d||a(t,f))(r,e,!m,n,!e||tt.test(t)&&yt(e.parentNode)||e),n},n.sortStable=x.split("").sort(A).join("")===x,n.detectDuplicates=!!h,d(),n.sortDetached=ct(function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))}),ct(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ht("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&ct(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ht("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ct(function(t){return null==t.getAttribute("disabled")})||ht(F,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),at}(t);w.find=S,w.expr=S.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=S.uniqueSort,w.text=S.getText,w.isXMLDoc=S.isXML,w.contains=S.contains,w.escapeSelector=S.escape;var E=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&w(t).is(n))break;i.push(t)}return i},O=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},C=w.expr.match.needsContext;function _(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function k(t,e,n){return p(e)?w.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?w.grep(t,function(t){return t===e!==n}):"string"!=typeof e?w.grep(t,function(t){return-1<a.call(e,t)!==n}):w.filter(e,t,n)}w.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?w.find.matchesSelector(i,t)?[i]:[]:w.find.matches(t,w.grep(e,function(t){return 1===t.nodeType}))},w.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(w(t).filter(function(){for(e=0;e<i;e++)if(w.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)w.find(t,r[e],n);return 1<i?w.uniqueSort(n):n},filter:function(t){return this.pushStack(k(this,t||[],!1))},not:function(t){return this.pushStack(k(this,t||[],!0))},is:function(t){return!!k(this,"string"==typeof t&&C.test(t)?w(t):t||[],!1).length}});var R,I=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||R,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:I.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(w.merge(this,w.parseHTML(i[1],(e=e instanceof w?e[0]:e)&&e.nodeType?e.ownerDocument||e:g,!0)),A.test(i[1])&&w.isPlainObject(e))for(i in e)p(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=g.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):p(t)?void 0!==n.ready?n.ready(t):t(w):w.makeArray(t,this)}).prototype=w.fn,R=w(g);var M=/^(?:parents|prev(?:Until|All))/,N={children:!0,contents:!0,next:!0,prev:!0};function D(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}w.fn.extend({has:function(t){var e=w(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(w.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,s=[],o="string"!=typeof t&&w(t);if(!C.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(o?-1<o.index(n):1===n.nodeType&&w.find.matchesSelector(n,t))){s.push(n);break}return this.pushStack(1<s.length?w.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?a.call(w(t),this[0]):a.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),w.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return E(t,"parentNode")},parentsUntil:function(t,e,n){return E(t,"parentNode",n)},next:function(t){return D(t,"nextSibling")},prev:function(t){return D(t,"previousSibling")},nextAll:function(t){return E(t,"nextSibling")},prevAll:function(t){return E(t,"previousSibling")},nextUntil:function(t,e,n){return E(t,"nextSibling",n)},prevUntil:function(t,e,n){return E(t,"previousSibling",n)},siblings:function(t){return O((t.parentNode||{}).firstChild,t)},children:function(t){return O(t.firstChild)},contents:function(t){return null!=t.contentDocument&&i(t.contentDocument)?t.contentDocument:(_(t,"template")&&(t=t.content||t),w.merge([],t.childNodes))}},function(t,e){w.fn[t]=function(n,i){var r=w.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=w.filter(i,r)),1<this.length&&(N[t]||w.uniqueSort(r),M.test(t)&&r.reverse()),this.pushStack(r)}});var P=/[^\x20\t\r\n\f]+/g;function F(t){return t}function L(t){throw t}function j(t,e,n,i){var r;try{t&&p(r=t.promise)?r.call(t).done(e).fail(n):t&&p(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}w.Callbacks=function(t){var e;t="string"==typeof t?(e={},w.each(t.match(P)||[],function(t,n){e[n]=!0}),e):w.extend({},t);var n,i,r,s,o=[],a=[],u=-1,l=function(){for(s=s||t.once,r=n=!0;a.length;u=-1)for(i=a.shift();++u<o.length;)!1===o[u].apply(i[0],i[1])&&t.stopOnFalse&&(u=o.length,i=!1);t.memory||(i=!1),n=!1,s&&(o=i?[]:"")},c={add:function(){return o&&(i&&!n&&(u=o.length-1,a.push(i)),function e(n){w.each(n,function(n,i){p(i)?t.unique&&c.has(i)||o.push(i):i&&i.length&&"string"!==b(i)&&e(i)})}(arguments),i&&!n&&l()),this},remove:function(){return w.each(arguments,function(t,e){for(var n;-1<(n=w.inArray(e,o,n));)o.splice(n,1),n<=u&&u--}),this},has:function(t){return t?-1<w.inArray(t,o):0<o.length},empty:function(){return o&&(o=[]),this},disable:function(){return s=a=[],o=i="",this},disabled:function(){return!o},lock:function(){return s=a=[],i||n||(o=i=""),this},locked:function(){return!!s},fireWith:function(t,e){return s||(e=[t,(e=e||[]).slice?e.slice():e],a.push(e),n||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},w.extend({Deferred:function(e){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return w.Deferred(function(e){w.each(n,function(n,i){var r=p(t[i[4]])&&t[i[4]];s[i[1]](function(){var t=r&&r.apply(this,arguments);t&&p(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(e,i,r){var s=0;function o(e,n,i,r){return function(){var a=this,u=arguments,l=function(){var t,l;if(!(e<s)){if((t=i.apply(a,u))===n.promise())throw new TypeError("Thenable self-resolution");p(l=t&&("object"==typeof t||"function"==typeof t)&&t.then)?r?l.call(t,o(s,n,F,r),o(s,n,L,r)):(s++,l.call(t,o(s,n,F,r),o(s,n,L,r),o(s,n,F,n.notifyWith))):(i!==F&&(a=void 0,u=[t]),(r||n.resolveWith)(a,u))}},c=r?l:function(){try{l()}catch(l){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(l,c.stackTrace),s<=e+1&&(i!==L&&(a=void 0,u=[l]),n.rejectWith(a,u))}};e?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),t.setTimeout(c))}}return w.Deferred(function(t){n[0][3].add(o(0,t,p(r)?r:F,t.notifyWith)),n[1][3].add(o(0,t,p(e)?e:F)),n[2][3].add(o(0,t,p(i)?i:L))}).promise()},promise:function(t){return null!=t?w.extend(t,r):r}},s={};return w.each(n,function(t,e){var o=e[2],a=e[5];r[e[1]]=o.add,a&&o.add(function(){i=a},n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),o.add(e[3].fire),s[e[0]]=function(){return s[e[0]+"With"](this===s?void 0:this,arguments),this},s[e[0]+"With"]=o.fireWith}),r.promise(s),e&&e.call(s,s),s},when:function(t){var e=arguments.length,n=e,i=Array(n),s=r.call(arguments),o=w.Deferred(),a=function(t){return function(n){i[t]=this,s[t]=1<arguments.length?r.call(arguments):n,--e||o.resolveWith(i,s)}};if(e<=1&&(j(t,o.done(a(n)).resolve,o.reject,!e),"pending"===o.state()||p(s[n]&&s[n].then)))return o.then();for(;n--;)j(s[n],a(n),o.reject);return o.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&B.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},w.readyException=function(e){t.setTimeout(function(){throw e})};var z=w.Deferred();function $(){g.removeEventListener("DOMContentLoaded",$),t.removeEventListener("load",$),w.ready()}w.fn.ready=function(t){return z.then(t).catch(function(t){w.readyException(t)}),this},w.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--w.readyWait:w.isReady)||(w.isReady=!0)!==t&&0<--w.readyWait||z.resolveWith(g,[w])}}),w.ready.then=z.then,"complete"===g.readyState||"loading"!==g.readyState&&!g.documentElement.doScroll?t.setTimeout(w.ready):(g.addEventListener("DOMContentLoaded",$),t.addEventListener("load",$));var U=function(t,e,n,i,r,s,o){var a=0,u=t.length,l=null==n;if("object"===b(n))for(a in r=!0,n)U(t,e,a,n[a],!0,s,o);else if(void 0!==i&&(r=!0,p(i)||(o=!0),l&&(o?(e.call(t,i),e=null):(l=e,e=function(t,e,n){return l.call(w(t),n)})),e))for(;a<u;a++)e(t[a],n,o?i:i.call(t[a],a,e(t[a],n)));return r?t:l?e.call(t):u?e(t[0],n):s},W=/^-ms-/,V=/-([a-z])/g;function Y(t,e){return e.toUpperCase()}function G(t){return t.replace(W,"ms-").replace(V,Y)}var X=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function H(){this.expando=w.expando+H.uid++}H.uid=1,H.prototype={cache:function(t){var e=t[this.expando];return e||(e={},X(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[G(e)]=n;else for(i in e)r[G(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][G(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(G):(e=G(e))in i?[e]:e.match(P)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||w.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!w.isEmptyObject(e)}};var q=new H,K=new H,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function Z(t,e,n){var i,r;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(Q,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===(r=n)||"false"!==r&&("null"===r?null:r===+r+""?+r:J.test(r)?JSON.parse(r):r)}catch(t){}K.set(t,e,n)}else n=void 0;return n}w.extend({hasData:function(t){return K.hasData(t)||q.hasData(t)},data:function(t,e,n){return K.access(t,e,n)},removeData:function(t,e){K.remove(t,e)},_data:function(t,e,n){return q.access(t,e,n)},_removeData:function(t,e){q.remove(t,e)}}),w.fn.extend({data:function(t,e){var n,i,r,s=this[0],o=s&&s.attributes;if(void 0===t){if(this.length&&(r=K.get(s),1===s.nodeType&&!q.get(s,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(i=o[n].name).indexOf("data-")&&(i=G(i.slice(5)),Z(s,i,r[i]));q.set(s,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){K.set(this,t)}):U(this,function(e){var n;if(s&&void 0===e)return void 0!==(n=K.get(s,t))||void 0!==(n=Z(s,t))?n:void 0;this.each(function(){K.set(this,t,e)})},null,e,1<arguments.length,null,!0)},removeData:function(t){return this.each(function(){K.remove(this,t)})}}),w.extend({queue:function(t,e,n){var i;if(t)return i=q.get(t,e=(e||"fx")+"queue"),n&&(!i||Array.isArray(n)?i=q.access(t,e,w.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){var n=w.queue(t,e=e||"fx"),i=n.length,r=n.shift(),s=w._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete s.stop,r.call(t,function(){w.dequeue(t,e)},s)),!i&&s&&s.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return q.get(t,n)||q.access(t,n,{empty:w.Callbacks("once memory").add(function(){q.remove(t,[e+"queue",n])})})}}),w.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?w.queue(this[0],t):void 0===e?this:this.each(function(){var n=w.queue(this,t,e);w._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&w.dequeue(this,t)})},dequeue:function(t){return this.each(function(){w.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=w.Deferred(),s=this,o=this.length,a=function(){--i||r.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(n=q.get(s[o],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],it=g.documentElement,rt=function(t){return w.contains(t.ownerDocument,t)},st={composed:!0};it.getRootNode&&(rt=function(t){return w.contains(t.ownerDocument,t)||t.getRootNode(st)===t.ownerDocument});var ot=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===w.css(t,"display")};function at(t,e,n,i){var r,s,o=20,a=i?function(){return i.cur()}:function(){return w.css(t,e,"")},u=a(),l=n&&n[3]||(w.cssNumber[e]?"":"px"),c=t.nodeType&&(w.cssNumber[e]||"px"!==l&&+u)&&et.exec(w.css(t,e));if(c&&c[3]!==l){for(l=l||c[3],c=+(u/=2)||1;o--;)w.style(t,e,c+l),(1-s)*(1-(s=a()/u||.5))<=0&&(o=0),c/=s;w.style(t,e,(c*=2)+l),n=n||[]}return n&&(c=+c||+u||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=c,i.end=r)),r}var ut={};function lt(t,e){for(var n,i,r,s,o,a,u,l=[],c=0,h=t.length;c<h;c++)(i=t[c]).style&&(n=i.style.display,e?("none"===n&&(l[c]=q.get(i,"display")||null,l[c]||(i.style.display="")),""===i.style.display&&ot(i)&&(l[c]=(u=o=s=void 0,o=(r=i).ownerDocument,(u=ut[a=r.nodeName])||(s=o.body.appendChild(o.createElement(a)),u=w.css(s,"display"),s.parentNode.removeChild(s),"none"===u&&(u="block"),ut[a]=u)))):"none"!==n&&(l[c]="none",q.set(i,"display",n)));for(c=0;c<h;c++)null!=l[c]&&(t[c].style.display=l[c]);return t}w.fn.extend({show:function(){return lt(this,!0)},hide:function(){return lt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){ot(this)?w(this).show():w(this).hide()})}});var ct,ht,dt=/^(?:checkbox|radio)$/i,ft=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pt=/^$|^module$|\/(?:java|ecma)script/i;ct=g.createDocumentFragment().appendChild(g.createElement("div")),(ht=g.createElement("input")).setAttribute("type","radio"),ht.setAttribute("checked","checked"),ht.setAttribute("name","t"),ct.appendChild(ht),f.checkClone=ct.cloneNode(!0).cloneNode(!0).lastChild.checked,ct.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!ct.cloneNode(!0).lastChild.defaultValue,ct.innerHTML="<option></option>",f.option=!!ct.lastChild;var mt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&_(t,e)?w.merge([t],n):n}function yt(t,e){for(var n=0,i=t.length;n<i;n++)q.set(t[n],"globalEval",!e||q.get(e[n],"globalEval"))}mt.tbody=mt.tfoot=mt.colgroup=mt.caption=mt.thead,mt.th=mt.td,f.option||(mt.optgroup=mt.option=[1,"<select multiple='multiple'>","</select>"]);var vt=/<|&#?\w+;/;function bt(t,e,n,i,r){for(var s,o,a,u,l,c,h=e.createDocumentFragment(),d=[],f=0,p=t.length;f<p;f++)if((s=t[f])||0===s)if("object"===b(s))w.merge(d,s.nodeType?[s]:s);else if(vt.test(s)){for(o=o||h.appendChild(e.createElement("div")),a=(ft.exec(s)||["",""])[1].toLowerCase(),o.innerHTML=(u=mt[a]||mt._default)[1]+w.htmlPrefilter(s)+u[2],c=u[0];c--;)o=o.lastChild;w.merge(d,o.childNodes),(o=h.firstChild).textContent=""}else d.push(e.createTextNode(s));for(h.textContent="",f=0;s=d[f++];)if(i&&-1<w.inArray(s,i))r&&r.push(s);else if(l=rt(s),o=gt(h.appendChild(s),"script"),l&&yt(o),n)for(c=0;s=o[c++];)pt.test(s.type||"")&&n.push(s);return h}var xt=/^key/,wt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Tt=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function Et(){return!1}function Ot(t,e){return t===function(){try{return g.activeElement}catch(t){}}()==("focus"===e)}function Ct(t,e,n,i,r,s){var o,a;if("object"==typeof e){for(a in"string"!=typeof n&&(i=i||n,n=void 0),e)Ct(t,a,n,i,e[a],s);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Et;else if(!r)return t;return 1===s&&(o=r,(r=function(t){return w().off(t),o.apply(this,arguments)}).guid=o.guid||(o.guid=w.guid++)),t.each(function(){w.event.add(this,e,r,i,n)})}function _t(t,e,n){n?(q.set(t,e,!1),w.event.add(t,e,{namespace:!1,handler:function(t){var i,s,o=q.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(w.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=r.call(arguments),q.set(this,e,o),i=n(this,e),this[e](),o!==(s=q.get(this,e))||i?q.set(this,e,!1):s={},o!==s)return t.stopImmediatePropagation(),t.preventDefault(),s.value}else o.length&&(q.set(this,e,{value:w.event.trigger(w.extend(o[0],w.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===q.get(t,e)&&w.event.add(t,e,St)}w.event={global:{},add:function(t,e,n,i,r){var s,o,a,u,l,c,h,d,f,p,m,g=q.get(t);if(X(t))for(n.handler&&(n=(s=n).handler,r=s.selector),r&&w.find.matchesSelector(it,r),n.guid||(n.guid=w.guid++),(u=g.events)||(u=g.events=Object.create(null)),(o=g.handle)||(o=g.handle=function(e){return void 0!==w&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;l--;)f=m=(a=Tt.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),f&&(h=w.event.special[f]||{},h=w.event.special[f=(r?h.delegateType:h.bindType)||f]||{},c=w.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&w.expr.match.needsContext.test(r),namespace:p.join(".")},s),(d=u[f])||((d=u[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,o)||t.addEventListener&&t.addEventListener(f,o)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),w.event.global[f]=!0)},remove:function(t,e,n,i,r){var s,o,a,u,l,c,h,d,f,p,m,g=q.hasData(t)&&q.get(t);if(g&&(u=g.events)){for(l=(e=(e||"").match(P)||[""]).length;l--;)if(f=m=(a=Tt.exec(e[l])||[])[1],p=(a[2]||"").split(".").sort(),f){for(h=w.event.special[f]||{},d=u[f=(i?h.delegateType:h.bindType)||f]||[],a=a[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=d.length;s--;)c=d[s],!r&&m!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(s,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));o&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,g.handle)||w.removeEvent(t,f,g.handle),delete u[f])}else for(f in u)w.event.remove(t,f+e[l],n,i,!0);w.isEmptyObject(u)&&q.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,s,o,a=new Array(arguments.length),u=w.event.fix(t),l=(q.get(this,"events")||Object.create(null))[u.type]||[],c=w.event.special[u.type]||{};for(a[0]=u,e=1;e<arguments.length;e++)a[e]=arguments[e];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){for(o=w.event.handlers.call(this,u,l),e=0;(r=o[e++])&&!u.isPropagationStopped();)for(u.currentTarget=r.elem,n=0;(s=r.handlers[n++])&&!u.isImmediatePropagationStopped();)u.rnamespace&&!1!==s.namespace&&!u.rnamespace.test(s.namespace)||(u.handleObj=s,u.data=s.data,void 0!==(i=((w.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,a))&&!1===(u.result=i)&&(u.preventDefault(),u.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(t,e){var n,i,r,s,o,a=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&1<=t.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(s=[],o={},n=0;n<u;n++)void 0===o[r=(i=e[n]).selector+" "]&&(o[r]=i.needsContext?-1<w(r,this).index(l):w.find(r,this,null,[l]).length),o[r]&&s.push(i);s.length&&a.push({elem:l,handlers:s})}return l=this,u<e.length&&a.push({elem:l,handlers:e.slice(u)}),a},addProp:function(t,e){Object.defineProperty(w.Event.prototype,t,{enumerable:!0,configurable:!0,get:p(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[w.expando]?t:new w.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return dt.test(e.type)&&e.click&&_(e,"input")&&_t(e,"click",St),!1},trigger:function(t){var e=this||t;return dt.test(e.type)&&e.click&&_(e,"input")&&_t(e,"click"),!0},_default:function(t){var e=t.target;return dt.test(e.type)&&e.click&&_(e,"input")&&q.get(e,"click")||_(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},w.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},w.Event=function(t,e){if(!(this instanceof w.Event))return new w.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:Et,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&w.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:Et,isPropagationStopped:Et,isImmediatePropagationStopped:Et,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&xt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&wt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},function(t,e){w.event.special[t]={setup:function(){return _t(this,t,Ot),!1},trigger:function(){return _t(this,t),!0},delegateType:e}}),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){w.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||w.contains(this,i))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),w.fn.extend({on:function(t,e,n,i){return Ct(this,t,e,n,i)},one:function(t,e,n,i){return Ct(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,w(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Et),this.each(function(){w.event.remove(this,t,n,e)})}});var At=/<script|<style|<link/i,kt=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function It(t,e){return _(t,"table")&&_(11!==e.nodeType?e:e.firstChild,"tr")&&w(t).children("tbody")[0]||t}function Mt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Nt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Dt(t,e){var n,i,r,s,o,a;if(1===e.nodeType){if(q.hasData(t)&&(a=q.get(t).events))for(r in q.remove(e,"handle events"),a)for(n=0,i=a[r].length;n<i;n++)w.event.add(e,r,a[r][n]);K.hasData(t)&&(s=K.access(t),o=w.extend({},s),K.set(e,o))}}function Pt(t,e,n,i){e=s(e);var r,o,a,u,l,c,h=0,d=t.length,m=d-1,g=e[0],y=p(g);if(y||1<d&&"string"==typeof g&&!f.checkClone&&kt.test(g))return t.each(function(r){var s=t.eq(r);y&&(e[0]=g.call(this,r,s.html())),Pt(s,e,n,i)});if(d&&(o=(r=bt(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(u=(a=w.map(gt(r,"script"),Mt)).length;h<d;h++)l=r,h!==m&&(l=w.clone(l,!0,!0),u&&w.merge(a,gt(l,"script"))),n.call(t[h],l,h);if(u)for(c=a[a.length-1].ownerDocument,w.map(a,Nt),h=0;h<u;h++)pt.test((l=a[h]).type||"")&&!q.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&!l.noModule&&w._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):v(l.textContent.replace(Rt,""),l,c))}return t}function Ft(t,e,n){for(var i,r=e?w.filter(e,t):t,s=0;null!=(i=r[s]);s++)n||1!==i.nodeType||w.cleanData(gt(i)),i.parentNode&&(n&&rt(i)&&yt(gt(i,"script")),i.parentNode.removeChild(i));return t}w.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,s,o,a,u,l,c=t.cloneNode(!0),h=rt(t);if(!(f.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||w.isXMLDoc(t)))for(o=gt(c),i=0,r=(s=gt(t)).length;i<r;i++)a=s[i],"input"===(l=(u=o[i]).nodeName.toLowerCase())&&dt.test(a.type)?u.checked=a.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=a.defaultValue);if(e)if(n)for(s=s||gt(t),o=o||gt(c),i=0,r=s.length;i<r;i++)Dt(s[i],o[i]);else Dt(t,c);return 0<(o=gt(c,"script")).length&&yt(o,!h&&gt(t,"script")),c},cleanData:function(t){for(var e,n,i,r=w.event.special,s=0;void 0!==(n=t[s]);s++)if(X(n)){if(e=n[q.expando]){if(e.events)for(i in e.events)r[i]?w.event.remove(n,i):w.removeEvent(n,i,e.handle);n[q.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),w.fn.extend({detach:function(t){return Ft(this,t,!0)},remove:function(t){return Ft(this,t)},text:function(t){return U(this,function(t){return void 0===t?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Pt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||It(this,t).appendChild(t)})},prepend:function(){return Pt(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=It(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Pt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Pt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(w.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return w.clone(this,t,e)})},html:function(t){return U(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!At.test(t)&&!mt[(ft.exec(t)||["",""])[1].toLowerCase()]){t=w.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(w.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return Pt(this,arguments,function(e){var n=this.parentNode;w.inArray(this,t)<0&&(w.cleanData(gt(this)),n&&n.replaceChild(e,this))},t)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){w.fn[t]=function(t){for(var n,i=[],r=w(t),s=r.length-1,a=0;a<=s;a++)n=a===s?this:this.clone(!0),w(r[a])[e](n),o.apply(i,n.get());return this.pushStack(i)}});var Lt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),jt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Bt=function(t,e,n){var i,r,s={};for(r in e)s[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=s[r];return i},zt=new RegExp(nt.join("|"),"i");function $t(t,e,n){var i,r,s,o,a=t.style;return(n=n||jt(t))&&(""!==(o=n.getPropertyValue(e)||n[e])||rt(t)||(o=w.style(t,e)),!f.pixelBoxStyles()&&Lt.test(o)&&zt.test(e)&&(i=a.width,r=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=n.width,a.width=i,a.minWidth=r,a.maxWidth=s)),void 0!==o?o+"":o}function Ut(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",it.appendChild(l).appendChild(c);var e=t.getComputedStyle(c);i="1%"!==e.top,u=12===n(e.marginLeft),c.style.right="60%",o=36===n(e.right),r=36===n(e.width),c.style.position="absolute",s=12===n(c.offsetWidth/3),it.removeChild(l),c=null}}function n(t){return Math.round(parseFloat(t))}var i,r,s,o,a,u,l=g.createElement("div"),c=g.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(f,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),s},reliableTrDimensions:function(){var e,n,i,r;return null==a&&(e=g.createElement("table"),n=g.createElement("tr"),i=g.createElement("div"),e.style.cssText="position:absolute;left:-11111px",n.style.height="1px",i.style.height="9px",it.appendChild(e).appendChild(n).appendChild(i),r=t.getComputedStyle(n),a=3<parseInt(r.height),it.removeChild(e)),a}}))}();var Wt=["Webkit","Moz","ms"],Vt=g.createElement("div").style,Yt={};function Gt(t){return w.cssProps[t]||Yt[t]||(t in Vt?t:Yt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Wt.length;n--;)if((t=Wt[n]+e)in Vt)return t}(t)||t)}var Xt=/^(none|table(?!-c[ea]).+)/,Ht=/^--/,qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:"0",fontWeight:"400"};function Jt(t,e,n){var i=et.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function Qt(t,e,n,i,r,s){var o="width"===e?1:0,a=0,u=0;if(n===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(u+=w.css(t,n+nt[o],!0,r)),i?("content"===n&&(u-=w.css(t,"padding"+nt[o],!0,r)),"margin"!==n&&(u-=w.css(t,"border"+nt[o]+"Width",!0,r))):(u+=w.css(t,"padding"+nt[o],!0,r),"padding"!==n?u+=w.css(t,"border"+nt[o]+"Width",!0,r):a+=w.css(t,"border"+nt[o]+"Width",!0,r));return!i&&0<=s&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-s-u-a-.5))||0),u}function Zt(t,e,n){var i=jt(t),r=(!f.boxSizingReliable()||n)&&"border-box"===w.css(t,"boxSizing",!1,i),s=r,o=$t(t,e,i),a="offset"+e[0].toUpperCase()+e.slice(1);if(Lt.test(o)){if(!n)return o;o="auto"}return(!f.boxSizingReliable()&&r||!f.reliableTrDimensions()&&_(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===w.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===w.css(t,"boxSizing",!1,i),(s=a in t)&&(o=t[a])),(o=parseFloat(o)||0)+Qt(t,e,n||(r?"border":"content"),s,i,o)+"px"}function te(t,e,n,i,r){return new te.prototype.init(t,e,n,i,r)}w.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=$t(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,s,o,a=G(e),u=Ht.test(e),l=t.style;if(u||(e=Gt(a)),o=w.cssHooks[e]||w.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(r=o.get(t,!1,i))?r:l[e];"string"==(s=typeof n)&&(r=et.exec(n))&&r[1]&&(n=at(t,e,r),s="number"),null!=n&&n==n&&("number"!==s||u||(n+=r&&r[3]||(w.cssNumber[a]?"":"px")),f.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),o&&"set"in o&&void 0===(n=o.set(t,n,i))||(u?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,i){var r,s,o,a=G(e);return Ht.test(e)||(e=Gt(a)),(o=w.cssHooks[e]||w.cssHooks[a])&&"get"in o&&(r=o.get(t,!0,n)),void 0===r&&(r=$t(t,e,i)),"normal"===r&&e in Kt&&(r=Kt[e]),""===n||n?(s=parseFloat(r),!0===n||isFinite(s)?s||0:r):r}}),w.each(["height","width"],function(t,e){w.cssHooks[e]={get:function(t,n,i){if(n)return!Xt.test(w.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Zt(t,e,i):Bt(t,qt,function(){return Zt(t,e,i)})},set:function(t,n,i){var r,s=jt(t),o=!f.scrollboxSize()&&"absolute"===s.position,a=(o||i)&&"border-box"===w.css(t,"boxSizing",!1,s),u=i?Qt(t,e,i,a,s):0;return a&&o&&(u-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-Qt(t,e,"border",!1,s)-.5)),u&&(r=et.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=w.css(t,e)),Jt(0,n,u)}}}),w.cssHooks.marginLeft=Ut(f.reliableMarginLeft,function(t,e){if(e)return(parseFloat($t(t,"marginLeft"))||t.getBoundingClientRect().left-Bt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(t,e){w.cssHooks[t+e]={expand:function(n){for(var i=0,r={},s="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+nt[i]+e]=s[i]||s[i-2]||s[0];return r}},"margin"!==t&&(w.cssHooks[t+e].set=Jt)}),w.fn.extend({css:function(t,e){return U(this,function(t,e,n){var i,r,s={},o=0;if(Array.isArray(e)){for(i=jt(t),r=e.length;o<r;o++)s[e[o]]=w.css(t,e[o],!1,i);return s}return void 0!==n?w.style(t,e,n):w.css(t,e)},t,e,1<arguments.length)}}),((w.Tween=te).prototype={constructor:te,init:function(t,e,n,i,r,s){this.elem=t,this.prop=n,this.easing=r||w.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=s||(w.cssNumber[n]?"":"px")},cur:function(){var t=te.propHooks[this.prop];return t&&t.get?t.get(this):te.propHooks._default.get(this)},run:function(t){var e,n=te.propHooks[this.prop];return this.pos=e=this.options.duration?w.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):te.propHooks._default.set(this),this}}).init.prototype=te.prototype,(te.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=w.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){w.fx.step[t.prop]?w.fx.step[t.prop](t):1!==t.elem.nodeType||!w.cssHooks[t.prop]&&null==t.elem.style[Gt(t.prop)]?t.elem[t.prop]=t.now:w.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=te.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},w.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},w.fx=te.prototype.init,w.fx.step={};var ee,ne,ie,re,se=/^(?:toggle|show|hide)$/,oe=/queueHooks$/;function ae(){ne&&(!1===g.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(ae):t.setTimeout(ae,w.fx.interval),w.fx.tick())}function ue(){return t.setTimeout(function(){ee=void 0}),ee=Date.now()}function le(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=nt[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function ce(t,e,n){for(var i,r=(he.tweeners[e]||[]).concat(he.tweeners["*"]),s=0,o=r.length;s<o;s++)if(i=r[s].call(n,e,t))return i}function he(t,e,n){var i,r,s=0,o=he.prefilters.length,a=w.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=ee||ue(),n=Math.max(0,l.startTime+l.duration-e),i=1-(n/l.duration||0),s=0,o=l.tweens.length;s<o;s++)l.tweens[s].run(i);return a.notifyWith(t,[l,i,n]),i<1&&o?n:(o||a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:w.extend({},e),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:e,originalOptions:n,startTime:ee||ue(),duration:n.duration,tweens:[],createTween:function(e,n){var i=w.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(a.notifyWith(t,[l,1,0]),a.resolveWith(t,[l,e])):a.rejectWith(t,[l,e]),this}}),c=l.props;for(function(t,e){var n,i,r,s,o;for(n in t)if(r=e[i=G(n)],s=t[n],Array.isArray(s)&&(r=s[1],s=t[n]=s[0]),n!==i&&(t[i]=s,delete t[n]),(o=w.cssHooks[i])&&"expand"in o)for(n in s=o.expand(s),delete t[i],s)n in t||(t[n]=s[n],e[n]=r);else e[i]=r}(c,l.opts.specialEasing);s<o;s++)if(i=he.prefilters[s].call(l,t,c,l.opts))return p(i.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return w.map(c,ce,l),p(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(he,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return at(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){p(t)?(e=t,t=["*"]):t=t.match(P);for(var n,i=0,r=t.length;i<r;i++)(he.tweeners[n=t[i]]=he.tweeners[n]||[]).unshift(e)},prefilters:[function(t,e,n){var i,r,s,o,a,u,l,c,h="width"in e||"height"in e,d=this,f={},p=t.style,m=t.nodeType&&ot(t),g=q.get(t,"fxshow");for(i in n.queue||(null==(o=w._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,d.always(function(){d.always(function(){o.unqueued--,w.queue(t,"fx").length||o.empty.fire()})})),e)if(se.test(r=e[i])){if(delete e[i],s=s||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;m=!0}f[i]=g&&g[i]||w.style(t,i)}if((u=!w.isEmptyObject(e))||!w.isEmptyObject(f))for(i in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=g&&g.display)&&(l=q.get(t,"display")),"none"===(c=w.css(t,"display"))&&(l?c=l:(lt([t],!0),l=t.style.display||l,c=w.css(t,"display"),lt([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(t,"float")&&(u||(d.done(function(){p.display=l}),null==l&&(l="none"===(c=p.display)?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=!1,f)u||(g?"hidden"in g&&(m=g.hidden):g=q.access(t,"fxshow",{display:l}),s&&(g.hidden=!m),m&&lt([t],!0),d.done(function(){for(i in m||lt([t]),q.remove(t,"fxshow"),f)w.style(t,i,f[i])})),u=ce(m?g[i]:0,i,d),i in g||(g[i]=u.start,m&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?he.prefilters.unshift(t):he.prefilters.push(t)}}),w.speed=function(t,e,n){var i=t&&"object"==typeof t?w.extend({},t):{complete:n||!n&&e||p(t)&&t,duration:t,easing:n&&e||e&&!p(e)&&e};return w.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration=i.duration in w.fx.speeds?w.fx.speeds[i.duration]:w.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){p(i.old)&&i.old.call(this),i.queue&&w.dequeue(this,i.queue)},i},w.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ot).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=w.isEmptyObject(t),s=w.speed(e,n,i),o=function(){var e=he(this,w.extend({},t),s);(r||q.get(this,"finish"))&&e.stop(!0)};return o.finish=o,r||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",s=w.timers,o=q.get(this);if(r)o[r]&&o[r].stop&&i(o[r]);else for(r in o)o[r]&&o[r].stop&&oe.test(r)&&i(o[r]);for(r=s.length;r--;)s[r].elem!==this||null!=t&&s[r].queue!==t||(s[r].anim.stop(n),e=!1,s.splice(r,1));!e&&n||w.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=q.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],s=w.timers,o=i?i.length:0;for(n.finish=!0,w.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;e<o;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(t,e){var n=w.fn[e];w.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(le(e,!0),t,i,r)}}),w.each({slideDown:le("show"),slideUp:le("hide"),slideToggle:le("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){w.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),w.timers=[],w.fx.tick=function(){var t,e=0,n=w.timers;for(ee=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||w.fx.stop(),ee=void 0},w.fx.timer=function(t){w.timers.push(t),w.fx.start()},w.fx.interval=13,w.fx.start=function(){ne||(ne=!0,ae())},w.fx.stop=function(){ne=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(e,n){return e=w.fx&&w.fx.speeds[e]||e,this.queue(n=n||"fx",function(n,i){var r=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(r)}})},ie=g.createElement("input"),re=g.createElement("select").appendChild(g.createElement("option")),ie.type="checkbox",f.checkOn=""!==ie.value,f.optSelected=re.selected,(ie=g.createElement("input")).value="t",ie.type="radio",f.radioValue="t"===ie.value;var de,fe=w.expr.attrHandle;w.fn.extend({attr:function(t,e){return U(this,w.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){w.removeAttr(this,t)})}}),w.extend({attr:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?w.prop(t,e,n):(1===s&&w.isXMLDoc(t)||(r=w.attrHooks[e.toLowerCase()]||(w.expr.match.bool.test(e)?de:void 0)),void 0!==n?null===n?void w.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=w.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!f.radioValue&&"radio"===e&&_(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(P);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),de={set:function(t,e,n){return!1===e?w.removeAttr(t,n):t.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(t,e){var n=fe[e]||w.find.attr;fe[e]=function(t,e,i){var r,s,o=e.toLowerCase();return i||(s=fe[o],fe[o]=r,r=null!=n(t,e,i)?o:null,fe[o]=s),r}});var pe=/^(?:input|select|textarea|button)$/i,me=/^(?:a|area)$/i;function ge(t){return(t.match(P)||[]).join(" ")}function ye(t){return t.getAttribute&&t.getAttribute("class")||""}function ve(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(P)||[]}w.fn.extend({prop:function(t,e){return U(this,w.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[w.propFix[t]||t]})}}),w.extend({prop:function(t,e,n){var i,r,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&w.isXMLDoc(t)||(r=w.propHooks[e=w.propFix[e]||e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=w.find.attr(t,"tabindex");return e?parseInt(e,10):pe.test(t.nodeName)||me.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),f.optSelected||(w.propHooks.selected={get:function(t){return null},set:function(t){}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.fn.extend({addClass:function(t){var e,n,i,r,s,o,a,u=0;if(p(t))return this.each(function(e){w(this).addClass(t.call(this,e,ye(this)))});if((e=ve(t)).length)for(;n=this[u++];)if(r=ye(n),i=1===n.nodeType&&" "+ge(r)+" "){for(o=0;s=e[o++];)i.indexOf(" "+s+" ")<0&&(i+=s+" ");r!==(a=ge(i))&&n.setAttribute("class",a)}return this},removeClass:function(t){var e,n,i,r,s,o,a,u=0;if(p(t))return this.each(function(e){w(this).removeClass(t.call(this,e,ye(this)))});if(!arguments.length)return this.attr("class","");if((e=ve(t)).length)for(;n=this[u++];)if(r=ye(n),i=1===n.nodeType&&" "+ge(r)+" "){for(o=0;s=e[o++];)for(;-1<i.indexOf(" "+s+" ");)i=i.replace(" "+s+" "," ");r!==(a=ge(i))&&n.setAttribute("class",a)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):p(t)?this.each(function(n){w(this).toggleClass(t.call(this,n,ye(this),e),e)}):this.each(function(){var e,r,s,o;if(i)for(r=0,s=w(this),o=ve(t);e=o[r++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else void 0!==t&&"boolean"!==n||((e=ye(this))&&q.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":q.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&-1<(" "+ge(ye(n))+" ").indexOf(e))return!0;return!1}});var be=/\r/g;w.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=p(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,w(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=w.map(r,function(t){return null==t?"":t+""})),(e=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=w.valHooks[r.type]||w.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(be,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(t){var e=w.find.attr(t,"value");return null!=e?e:ge(w.text(t))}},select:{get:function(t){var e,n,i,r=t.options,s=t.selectedIndex,o="select-one"===t.type,a=o?null:[],u=o?s+1:r.length;for(i=s<0?u:o?s:0;i<u;i++)if(((n=r[i]).selected||i===s)&&!n.disabled&&(!n.parentNode.disabled||!_(n.parentNode,"optgroup"))){if(e=w(n).val(),o)return e;a.push(e)}return a},set:function(t,e){for(var n,i,r=t.options,s=w.makeArray(e),o=r.length;o--;)((i=r[o]).selected=-1<w.inArray(w.valHooks.option.get(i),s))&&(n=!0);return n||(t.selectedIndex=-1),s}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<w.inArray(w(t).val(),e)}},f.checkOn||(w.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),f.focusin="onfocusin"in t;var xe=/^(?:focusinfocus|focusoutblur)$/,we=function(t){t.stopPropagation()};w.extend(w.event,{trigger:function(e,n,i,r){var s,o,a,u,l,h,d,f,y=[i||g],v=c.call(e,"type")?e.type:e,b=c.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=i=i||g,3!==i.nodeType&&8!==i.nodeType&&!xe.test(v+w.event.triggered)&&(-1<v.indexOf(".")&&(v=(b=v.split(".")).shift(),b.sort()),l=v.indexOf(":")<0&&"on"+v,(e=e[w.expando]?e:new w.Event(v,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=b.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:w.makeArray(n,[e]),d=w.event.special[v]||{},r||!d.trigger||!1!==d.trigger.apply(i,n))){if(!r&&!d.noBubble&&!m(i)){for(xe.test((u=d.delegateType||v)+v)||(o=o.parentNode);o;o=o.parentNode)y.push(o),a=o;a===(i.ownerDocument||g)&&y.push(a.defaultView||a.parentWindow||t)}for(s=0;(o=y[s++])&&!e.isPropagationStopped();)f=o,e.type=1<s?u:d.bindType||v,(h=(q.get(o,"events")||Object.create(null))[e.type]&&q.get(o,"handle"))&&h.apply(o,n),(h=l&&o[l])&&h.apply&&X(o)&&(e.result=h.apply(o,n),!1===e.result&&e.preventDefault());return e.type=v,r||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(y.pop(),n)||!X(i)||l&&p(i[v])&&!m(i)&&((a=i[l])&&(i[l]=null),w.event.triggered=v,e.isPropagationStopped()&&f.addEventListener(v,we),i[v](),e.isPropagationStopped()&&f.removeEventListener(v,we),w.event.triggered=void 0,a&&(i[l]=a)),e.result}},simulate:function(t,e,n){var i=w.extend(new w.Event,n,{type:t,isSimulated:!0});w.event.trigger(i,null,e)}}),w.fn.extend({trigger:function(t,e){return this.each(function(){w.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return w.event.trigger(t,e,n,!0)}}),f.focusin||w.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){w.event.simulate(e,t.target,w.event.fix(t))};w.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=q.access(i,e);r||i.addEventListener(t,n,!0),q.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=q.access(i,e)-1;r?q.access(i,e,r):(i.removeEventListener(t,n,!0),q.remove(i,e))}}});var Te=t.location,Se={guid:Date.now()},Ee=/\?/;w.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),n};var Oe=/\[\]$/,Ce=/\r?\n/g,_e=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;function ke(t,e,n,i){var r;if(Array.isArray(e))w.each(e,function(e,r){n||Oe.test(t)?i(t,r):ke(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==b(e))i(t,e);else for(r in e)ke(t+"["+r+"]",e[r],n,i)}w.param=function(t,e){var n,i=[],r=function(t,e){var n=p(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!w.isPlainObject(t))w.each(t,function(){r(this.name,this.value)});else for(n in t)ke(n,t[n],e,r);return i.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=w.prop(this,"elements");return t?w.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!w(this).is(":disabled")&&Ae.test(this.nodeName)&&!_e.test(t)&&(this.checked||!dt.test(t))}).map(function(t,e){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(t){return{name:e.name,value:t.replace(Ce,"\r\n")}}):{name:e.name,value:n.replace(Ce,"\r\n")}}).get()}});var Re=/%20/g,Ie=/#.*$/,Me=/([?&])_=[^&]*/,Ne=/^(.*?):[ \t]*([^\r\n]*)$/gm,De=/^(?:GET|HEAD)$/,Pe=/^\/\//,Fe={},Le={},je="*/".concat("*"),Be=g.createElement("a");function ze(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,s=e.toLowerCase().match(P)||[];if(p(n))for(;i=s[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function $e(t,e,n,i){var r={},s=t===Le;function o(a){var u;return r[a]=!0,w.each(t[a]||[],function(t,a){var l=a(e,n,i);return"string"!=typeof l||s||r[l]?s?!(u=l):void 0:(e.dataTypes.unshift(l),o(l),!1)}),u}return o(e.dataTypes[0])||!r["*"]&&o("*")}function Ue(t,e){var n,i,r=w.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&w.extend(!0,t,i),t}Be.href=Te.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Te.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ue(Ue(t,w.ajaxSettings),e):Ue(w.ajaxSettings,t)},ajaxPrefilter:ze(Fe),ajaxTransport:ze(Le),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0);var i,r,s,o,a,u,l,c,h,d,f=w.ajaxSetup({},n=n||{}),p=f.context||f,m=f.context&&(p.nodeType||p.jquery)?w(p):w.event,y=w.Deferred(),v=w.Callbacks("once memory"),b=f.statusCode||{},x={},T={},S="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(l){if(!o)for(o={};e=Ne.exec(s);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return l?s:null},setRequestHeader:function(t,e){return null==l&&(t=T[t.toLowerCase()]=T[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==l&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)E.always(t[E.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||S;return i&&i.abort(e),O(0,e),this}};if(y.promise(E),f.url=((e||f.url||Te.href)+"").replace(Pe,Te.protocol+"//"),f.type=n.method||n.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(P)||[""],null==f.crossDomain){u=g.createElement("a");try{u.href=f.url,u.href=u.href,f.crossDomain=Be.protocol+"//"+Be.host!=u.protocol+"//"+u.host}catch(e){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=w.param(f.data,f.traditional)),$e(Fe,f,n,E),l)return E;for(h in(c=w.event&&f.global)&&0==w.active++&&w.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!De.test(f.type),r=f.url.replace(Ie,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(Re,"+")):(d=f.url.slice(r.length),f.data&&(f.processData||"string"==typeof f.data)&&(r+=(Ee.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(Me,"$1"),d=(Ee.test(r)?"&":"?")+"_="+Se.guid+++d),f.url=r+d),f.ifModified&&(w.lastModified[r]&&E.setRequestHeader("If-Modified-Since",w.lastModified[r]),w.etag[r]&&E.setRequestHeader("If-None-Match",w.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||n.contentType)&&E.setRequestHeader("Content-Type",f.contentType),E.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+je+"; q=0.01":""):f.accepts["*"]),f.headers)E.setRequestHeader(h,f.headers[h]);if(f.beforeSend&&(!1===f.beforeSend.call(p,E,f)||l))return E.abort();if(S="abort",v.add(f.complete),E.done(f.success),E.fail(f.error),i=$e(Le,f,n,E)){if(E.readyState=1,c&&m.trigger("ajaxSend",[E,f]),l)return E;f.async&&0<f.timeout&&(a=t.setTimeout(function(){E.abort("timeout")},f.timeout));try{l=!1,i.send(x,O)}catch(e){if(l)throw e;O(-1,e)}}else O(-1,"No Transport");function O(e,n,o,u){var h,d,g,x,T,S=n;l||(l=!0,a&&t.clearTimeout(a),i=void 0,s=u||"",E.readyState=0<e?4:0,h=200<=e&&e<300||304===e,o&&(x=function(t,e,n){for(var i,r,s,o,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){u.unshift(r);break}if(u[0]in n)s=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){s=r;break}o||(o=r)}s=s||o}if(s)return s!==u[0]&&u.unshift(s),n[s]}(f,E,o)),!h&&-1<w.inArray("script",f.dataTypes)&&(f.converters["text script"]=function(){}),x=function(t,e,n,i){var r,s,o,a,u,l={},c=t.dataTypes.slice();if(c[1])for(o in t.converters)l[o.toLowerCase()]=t.converters[o];for(s=c.shift();s;)if(t.responseFields[s]&&(n[t.responseFields[s]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=s,s=c.shift())if("*"===s)s=u;else if("*"!==u&&u!==s){if(!(o=l[u+" "+s]||l["* "+s]))for(r in l)if((a=r.split(" "))[1]===s&&(o=l[u+" "+a[0]]||l["* "+a[0]])){!0===o?o=l[r]:!0!==l[r]&&(s=a[0],c.unshift(a[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+u+" to "+s}}}return{state:"success",data:e}}(f,x,E,h),h?(f.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[r]=T),(T=E.getResponseHeader("etag"))&&(w.etag[r]=T)),204===e||"HEAD"===f.type?S="nocontent":304===e?S="notmodified":(S=x.state,d=x.data,h=!(g=x.error))):(g=S,!e&&S||(S="error",e<0&&(e=0))),E.status=e,E.statusText=(n||S)+"",h?y.resolveWith(p,[d,S,E]):y.rejectWith(p,[E,S,g]),E.statusCode(b),b=void 0,c&&m.trigger(h?"ajaxSuccess":"ajaxError",[E,f,h?d:g]),v.fireWith(p,[E,S]),c&&(m.trigger("ajaxComplete",[E,f]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(t,e,n){return w.get(t,e,n,"json")},getScript:function(t,e){return w.get(t,void 0,e,"script")}}),w.each(["get","post"],function(t,e){w[e]=function(t,n,i,r){return p(n)&&(r=r||i,i=n,n=void 0),w.ajax(w.extend({url:t,type:e,dataType:r,data:n,success:i},w.isPlainObject(t)&&t))}}),w.ajaxPrefilter(function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")}),w._evalUrl=function(t,e,n){return w.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){w.globalEval(t,e,n)}})},w.fn.extend({wrapAll:function(t){var e;return this[0]&&(p(t)&&(t=t.call(this[0])),e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return p(t)?this.each(function(e){w(this).wrapInner(t.call(this,e))}):this.each(function(){var e=w(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=p(t);return this.each(function(n){w(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(t){return!w.expr.pseudos.visible(t)},w.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var We={0:200,1223:204},Ve=w.ajaxSettings.xhr();f.cors=!!Ve&&"withCredentials"in Ve,f.ajax=Ve=!!Ve,w.ajaxTransport(function(e){var n,i;if(f.cors||Ve&&!e.crossDomain)return{send:function(r,s){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)a.setRequestHeader(o,r[o]);n=function(t){return function(){n&&(n=i=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===t?a.abort():"error"===t?"number"!=typeof a.status?s(0,"error"):s(a.status,a.statusText):s(We[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=n(),i=a.onerror=a.ontimeout=n("error"),void 0!==a.onabort?a.onabort=i:a.onreadystatechange=function(){4===a.readyState&&t.setTimeout(function(){n&&i()})},n=n("abort");try{a.send(e.hasContent&&e.data||null)}catch(r){if(n)throw r}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return w.globalEval(t),t}}}),w.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),w.ajaxTransport("script",function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=w("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),g.head.appendChild(e[0])},abort:function(){n&&n()}}});var Ye,Ge=[],Xe=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ge.pop()||w.expando+"_"+Se.guid++;return this[t]=!0,t}}),w.ajaxPrefilter("json jsonp",function(e,n,i){var r,s,o,a=!1!==e.jsonp&&(Xe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xe.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=p(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Xe,"$1"+r):!1!==e.jsonp&&(e.url+=(Ee.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||w.error(r+" was not called"),o[0]},e.dataTypes[0]="json",s=t[r],t[r]=function(){o=arguments},i.always(function(){void 0===s?w(t).removeProp(r):t[r]=s,e[r]&&(e.jsonpCallback=n.jsonpCallback,Ge.push(r)),o&&p(s)&&s(o[0]),o=s=void 0}),"script"}),f.createHTMLDocument=((Ye=g.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ye.childNodes.length),w.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(f.createHTMLDocument?((i=(e=g.implementation.createHTMLDocument("")).createElement("base")).href=g.location.href,e.head.appendChild(i)):e=g),s=!n&&[],(r=A.exec(t))?[e.createElement(r[1])]:(r=bt([t],e,s),s&&s.length&&w(s).remove(),w.merge([],r.childNodes)));var i,r,s},w.fn.load=function(t,e,n){var i,r,s,o=this,a=t.indexOf(" ");return-1<a&&(i=ge(t.slice(a)),t=t.slice(0,a)),p(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),0<o.length&&w.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){s=arguments,o.html(i?w("<div>").append(w.parseHTML(t)).find(i):t)}).always(n&&function(t,e){o.each(function(){n.apply(this,s||[t.responseText,e,t])})}),this},w.expr.pseudos.animated=function(t){return w.grep(w.timers,function(e){return t===e.elem}).length},w.offset={setOffset:function(t,e,n){var i,r,s,o,a,u,l=w.css(t,"position"),c=w(t),h={};"static"===l&&(t.style.position="relative"),a=c.offset(),s=w.css(t,"top"),u=w.css(t,"left"),("absolute"===l||"fixed"===l)&&-1<(s+u).indexOf("auto")?(o=(i=c.position()).top,r=i.left):(o=parseFloat(s)||0,r=parseFloat(u)||0),p(e)&&(e=e.call(t,n,w.extend({},a))),null!=e.top&&(h.top=e.top-a.top+o),null!=e.left&&(h.left=e.left-a.left+r),"using"in e?e.using.call(t,h):("number"==typeof h.top&&(h.top+="px"),"number"==typeof h.left&&(h.left+="px"),c.css(h))}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){w.offset.setOffset(this,t,e)});var e,n,i=this[0];return i?i.getClientRects().length?{top:(e=i.getBoundingClientRect()).top+(n=i.ownerDocument.defaultView).pageYOffset,left:e.left+n.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===w.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===w.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=w(t).offset()).top+=w.css(t,"borderTopWidth",!0),r.left+=w.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-w.css(i,"marginTop",!0),left:e.left-r.left-w.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===w.css(t,"position");)t=t.offsetParent;return t||it})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;w.fn[t]=function(i){return U(this,function(t,i,r){var s;if(m(t)?s=t:9===t.nodeType&&(s=t.defaultView),void 0===r)return s?s[e]:t[i];s?s.scrollTo(n?s.pageXOffset:r,n?r:s.pageYOffset):t[i]=r},t,i,arguments.length)}}),w.each(["top","left"],function(t,e){w.cssHooks[e]=Ut(f.pixelPosition,function(t,n){if(n)return n=$t(t,e),Lt.test(n)?w(t).position()[e]+"px":n})}),w.each({Height:"height",Width:"width"},function(t,e){w.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){w.fn[i]=function(r,s){var o=arguments.length&&(n||"boolean"!=typeof r),a=n||(!0===r||!0===s?"margin":"border");return U(this,function(e,n,r){var s;return m(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(s=e.documentElement,Math.max(e.body["scroll"+t],s["scroll"+t],e.body["offset"+t],s["offset"+t],s["client"+t])):void 0===r?w.css(e,n,a):w.style(e,n,r,a)},e,o?r:void 0,o)}})}),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){w.fn[e]=function(t){return this.on(e,t)}}),w.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){w.fn[e]=function(t,n){return 0<arguments.length?this.on(e,null,t,n):this.trigger(e)}});var He=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(t,e){var n,i,s;if("string"==typeof e&&(n=t[e],e=t,t=n),p(t))return i=r.call(arguments,2),(s=function(){return t.apply(e||this,i.concat(r.call(arguments)))}).guid=t.guid=t.guid||w.guid++,s},w.holdReady=function(t){t?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=_,w.isFunction=p,w.isWindow=m,w.camelCase=G,w.type=b,w.now=Date.now,w.isNumeric=function(t){var e=w.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},w.trim=function(t){return null==t?"":(t+"").replace(He,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var qe=t.jQuery,Ke=t.$;return w.noConflict=function(e){return t.$===w&&(t.$=Ke),e&&t.jQuery===w&&(t.jQuery=qe),w},void 0===e&&(t.jQuery=t.$=w),w}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.swal=e():t.swal=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="swal-button";e.CLASS_NAMES={MODAL:"swal-modal",OVERLAY:"swal-overlay",SHOW_MODAL:"swal-overlay--show-modal",MODAL_TITLE:"swal-title",MODAL_TEXT:"swal-text",ICON:"swal-icon",ICON_CUSTOM:"swal-icon--custom",CONTENT:"swal-content",FOOTER:"swal-footer",BUTTON_CONTAINER:"swal-button-container",BUTTON:i,CONFIRM_BUTTON:i+"--confirm",CANCEL_BUTTON:i+"--cancel",DANGER_BUTTON:i+"--danger",BUTTON_LOADING:i+"--loading",BUTTON_LOADER:i+"__loader"},e.default=e.CLASS_NAMES},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getNode=function(t){return document.querySelector("."+t)},e.stringToNode=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.insertAfter=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},e.removeNode=function(t){t.parentElement.removeChild(t)},e.throwErr=function(t){throw"SweetAlert: "+(t=t.replace(/ +(?= )/g,"")).trim()},e.isPlainObject=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},e.ordinalSuffixOf=function(t){var e=t%10,n=t%100;return 1===e&&11!==n?t+"st":2===e&&12!==n?t+"nd":3===e&&13!==n?t+"rd":t+"th"}},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(25));var r=n(26);e.overlayMarkup=r.default,i(n(27)),i(n(28)),i(n(29));var s=n(0),o=s.default.MODAL_TITLE,a=s.default.MODAL_TEXT,u=s.default.FOOTER;e.iconMarkup='\n  <div class="'+s.default.ICON+'"></div>',e.titleMarkup='\n  <div class="'+o+'"></div>\n',e.textMarkup='\n  <div class="'+a+'"></div>',e.footerMarkup='\n  <div class="'+u+'"></div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1);e.CONFIRM_KEY="confirm",e.CANCEL_KEY="cancel";var r={visible:!0,text:null,value:null,className:"",closeModal:!0},s=Object.assign({},r,{visible:!1,text:"Cancel",value:null}),o=Object.assign({},r,{text:"OK",value:!0});e.defaultButtonList={cancel:s,confirm:o};var a=function(t){switch(t){case e.CONFIRM_KEY:return o;case e.CANCEL_KEY:return s;default:var n=t.charAt(0).toUpperCase()+t.slice(1);return Object.assign({},r,{text:n,value:t})}},u=function(t,e){var n=a(t);return!0===e?Object.assign({},n,{visible:!0}):"string"==typeof e?Object.assign({},n,{visible:!0,text:e}):i.isPlainObject(e)?Object.assign({visible:!0},n,e):Object.assign({},n,{visible:!1})},l=function(t){var n={};switch(t.length){case 1:n[e.CANCEL_KEY]=Object.assign({},s,{visible:!1});break;case 2:n[e.CANCEL_KEY]=u(e.CANCEL_KEY,t[0]),n[e.CONFIRM_KEY]=u(e.CONFIRM_KEY,t[1]);break;default:i.throwErr("Invalid number of 'buttons' in array ("+t.length+").\n      If you want more than 2 buttons, you need to use an object!")}return n};e.getButtonListOpts=function(t){var n=e.defaultButtonList;return"string"==typeof t?n[e.CONFIRM_KEY]=u(e.CONFIRM_KEY,t):Array.isArray(t)?n=l(t):i.isPlainObject(t)?n=function(t){for(var e={},n=0,i=Object.keys(t);n<i.length;n++){var r=i[n],o=u(r,t[r]);e[r]=o}return e.cancel||(e.cancel=s),e}(t):!0===t?n=l([!0,!0]):!1===t?n=l([!1,!1]):void 0===t&&(n=e.defaultButtonList),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(2),s=n(0),o=s.default.MODAL,a=s.default.OVERLAY,u=n(30),l=n(31),c=n(32),h=n(33);e.injectElIntoModal=function(t){var e=i.getNode(o),n=i.stringToNode(t);return e.appendChild(n),n},e.initModalContent=function(t){(function(t,e){!function(t){t.className=o,t.textContent=""}(t);var n=e.className;n&&t.classList.add(n)})(i.getNode(o),t),u.default(t.icon),l.initTitle(t.title),l.initText(t.text),h.default(t.content),c.default(t.buttons,t.dangerMode)},e.default=function(){var t=i.getNode(a),e=i.stringToNode(r.modalMarkup);t.appendChild(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),r={isOpen:!1,promise:null,actions:{},timer:null},s=Object.assign({},r);e.resetState=function(){s=Object.assign({},r)},e.setActionValue=function(t){if("string"==typeof t)return o(i.CONFIRM_KEY,t);for(var e in t)o(e,t[e])};var o=function(t,e){s.actions[t]||(s.actions[t]={}),Object.assign(s.actions[t],{value:e})};e.setActionOptionsFor=function(t,e){var n=(void 0===e?{}:e).closeModal;Object.assign(s.actions[t],{closeModal:void 0===n||n})},e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(3),s=n(0),o=s.default.OVERLAY,a=s.default.SHOW_MODAL,u=s.default.BUTTON,l=s.default.BUTTON_LOADING,c=n(5);e.openModal=function(){i.getNode(o).classList.add(a),c.default.isOpen=!0},e.onAction=function(t){void 0===t&&(t=r.CANCEL_KEY);var e=c.default.actions[t],n=e.value;!1===e.closeModal?i.getNode(u+"--"+t).classList.add(l):(i.getNode(o).classList.remove(a),c.default.isOpen=!1),c.default.promise.resolve(n)},e.getState=function(){var t=Object.assign({},c.default);return delete t.promise,delete t.timer,t},e.stopLoading=function(){for(var t=document.querySelectorAll("."+u),e=0;e<t.length;e++)t[e].classList.remove(l)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){t.exports=e.sweetAlert=n(9)}).call(e,n(7))},function(t,e,n){(function(e){t.exports=e.swal=n(10)}).call(e,n(7))},function(t,e,n){"undefined"!=typeof window&&n(11),n(16);var i=n(23).default;t.exports=i},function(t,e,n){var i=n(12);"string"==typeof i&&(i=[[t.i,i,""]]),n(14)(i,{insertAt:"top",transform:void 0}),i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(13)(void 0)).push([t.i,'.swal-icon--error{border-color:#f27474;-webkit-animation:animateErrorIcon .5s;animation:animateErrorIcon .5s}.swal-icon--error__x-mark{position:relative;display:block;-webkit-animation:animateXMark .5s;animation:animateXMark .5s}.swal-icon--error__line{position:absolute;height:5px;width:47px;background-color:#f27474;display:block;top:37px;border-radius:2px}.swal-icon--error__line--left{-webkit-transform:rotate(45deg);transform:rotate(45deg);left:17px}.swal-icon--error__line--right{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:16px}@-webkit-keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@keyframes animateErrorIcon{0%{-webkit-transform:rotateX(100deg);transform:rotateX(100deg);opacity:0}to{-webkit-transform:rotateX(0deg);transform:rotateX(0deg);opacity:1}}@-webkit-keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}@keyframes animateXMark{0%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}50%{-webkit-transform:scale(.4);transform:scale(.4);margin-top:26px;opacity:0}80%{-webkit-transform:scale(1.15);transform:scale(1.15);margin-top:-6px}to{-webkit-transform:scale(1);transform:scale(1);margin-top:0;opacity:1}}.swal-icon--warning{border-color:#f8bb86;-webkit-animation:pulseWarning .75s infinite alternate;animation:pulseWarning .75s infinite alternate}.swal-icon--warning__body{width:5px;height:47px;top:10px;border-radius:2px;margin-left:-2px}.swal-icon--warning__body,.swal-icon--warning__dot{position:absolute;left:50%;background-color:#f8bb86}.swal-icon--warning__dot{width:7px;height:7px;border-radius:50%;margin-left:-4px;bottom:-11px}@-webkit-keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}@keyframes pulseWarning{0%{border-color:#f8d486}to{border-color:#f8bb86}}.swal-icon--success{border-color:#a5dc86}.swal-icon--success:after,.swal-icon--success:before{content:"";border-radius:50%;position:absolute;width:60px;height:120px;background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.swal-icon--success:before{border-radius:120px 0 0 120px;top:-7px;left:-33px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:60px 60px;transform-origin:60px 60px}.swal-icon--success:after{border-radius:0 120px 120px 0;top:-11px;left:30px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-transform-origin:0 60px;transform-origin:0 60px;-webkit-animation:rotatePlaceholder 4.25s ease-in;animation:rotatePlaceholder 4.25s ease-in}.swal-icon--success__ring{width:80px;height:80px;border:4px solid hsla(98,55%,69%,.2);border-radius:50%;box-sizing:content-box;position:absolute;left:-4px;top:-4px;z-index:2}.swal-icon--success__hide-corners{width:5px;height:90px;background-color:#fff;padding:1px;position:absolute;left:28px;top:8px;z-index:1;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}.swal-icon--success__line{height:5px;background-color:#a5dc86;display:block;border-radius:2px;position:absolute;z-index:2}.swal-icon--success__line--tip{width:25px;left:14px;top:46px;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:animateSuccessTip .75s;animation:animateSuccessTip .75s}.swal-icon--success__line--long{width:47px;right:8px;top:38px;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);-webkit-animation:animateSuccessLong .75s;animation:animateSuccessLong .75s}@-webkit-keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@keyframes rotatePlaceholder{0%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}5%{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}12%{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}to{-webkit-transform:rotate(-405deg);transform:rotate(-405deg)}}@-webkit-keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@keyframes animateSuccessTip{0%{width:0;left:1px;top:19px}54%{width:0;left:1px;top:19px}70%{width:50px;left:-8px;top:37px}84%{width:17px;left:21px;top:48px}to{width:25px;left:14px;top:45px}}@-webkit-keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}@keyframes animateSuccessLong{0%{width:0;right:46px;top:54px}65%{width:0;right:46px;top:54px}84%{width:55px;right:0;top:35px}to{width:47px;right:8px;top:38px}}.swal-icon--info{border-color:#c9dae1}.swal-icon--info:before{width:5px;height:29px;bottom:17px;border-radius:2px;margin-left:-2px}.swal-icon--info:after,.swal-icon--info:before{content:"";position:absolute;left:50%;background-color:#c9dae1}.swal-icon--info:after{width:7px;height:7px;border-radius:50%;margin-left:-3px;top:19px}.swal-icon{width:80px;height:80px;border-width:4px;border-style:solid;border-radius:50%;padding:0;position:relative;box-sizing:content-box;margin:20px auto}.swal-icon:first-child{margin-top:32px}.swal-icon--custom{width:auto;height:auto;max-width:100%;border:none;border-radius:0}.swal-icon img{max-width:100%;max-height:100%}.swal-title{color:rgba(0,0,0,.65);font-weight:600;text-transform:none;position:relative;display:block;padding:13px 16px;font-size:27px;line-height:normal;text-align:center;margin-bottom:0}.swal-title:first-child{margin-top:26px}.swal-title:not(:first-child){padding-bottom:0}.swal-title:not(:last-child){margin-bottom:13px}.swal-text{font-size:16px;position:relative;float:none;line-height:normal;vertical-align:top;text-align:left;display:inline-block;margin:0;padding:0 10px;font-weight:400;color:rgba(0,0,0,.64);max-width:calc(100% - 20px);overflow-wrap:break-word;box-sizing:border-box}.swal-text:first-child{margin-top:45px}.swal-text:last-child{margin-bottom:45px}.swal-footer{text-align:right;padding-top:13px;margin-top:13px;padding:13px 16px;border-radius:inherit;border-top-left-radius:0;border-top-right-radius:0}.swal-button-container{margin:5px;display:inline-block;position:relative}.swal-button{background-color:#7cd1f9;color:#fff;border:none;box-shadow:none;border-radius:5px;font-weight:600;font-size:14px;padding:10px 24px;margin:0;cursor:pointer}.swal-button:not([disabled]):hover{background-color:#78cbf2}.swal-button:active{background-color:#70bce0}.swal-button:focus{outline:none;box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(43,114,165,.29)}.swal-button[disabled]{opacity:.5;cursor:default}.swal-button::-moz-focus-inner{border:0}.swal-button--cancel{color:#555;background-color:#efefef}.swal-button--cancel:not([disabled]):hover{background-color:#e8e8e8}.swal-button--cancel:active{background-color:#d7d7d7}.swal-button--cancel:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(116,136,150,.29)}.swal-button--danger{background-color:#e64942}.swal-button--danger:not([disabled]):hover{background-color:#df4740}.swal-button--danger:active{background-color:#cf423b}.swal-button--danger:focus{box-shadow:0 0 0 1px #fff,0 0 0 3px rgba(165,43,43,.29)}.swal-content{padding:0 20px;margin-top:20px;font-size:medium}.swal-content:last-child{margin-bottom:20px}.swal-content__input,.swal-content__textarea{-webkit-appearance:none;background-color:#fff;border:none;font-size:14px;display:block;box-sizing:border-box;width:100%;border:1px solid rgba(0,0,0,.14);padding:10px 13px;border-radius:2px;transition:border-color .2s}.swal-content__input:focus,.swal-content__textarea:focus{outline:none;border-color:#6db8ff}.swal-content__textarea{resize:vertical}.swal-button--loading{color:transparent}.swal-button--loading~.swal-button__loader{opacity:1}.swal-button__loader{position:absolute;height:auto;width:43px;z-index:2;left:50%;top:50%;-webkit-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);text-align:center;pointer-events:none;opacity:0}.swal-button__loader div{display:inline-block;float:none;vertical-align:baseline;width:9px;height:9px;padding:0;border:none;margin:2px;opacity:.4;border-radius:7px;background-color:hsla(0,0%,100%,.9);transition:background .2s;-webkit-animation:swal-loading-anim 1s infinite;animation:swal-loading-anim 1s infinite}.swal-button__loader div:nth-child(3n+2){-webkit-animation-delay:.15s;animation-delay:.15s}.swal-button__loader div:nth-child(3n+3){-webkit-animation-delay:.3s;animation-delay:.3s}@-webkit-keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}@keyframes swal-loading-anim{0%{opacity:.4}20%{opacity:.4}50%{opacity:1}to{opacity:.4}}.swal-overlay{position:fixed;top:0;bottom:0;left:0;right:0;text-align:center;font-size:0;overflow-y:auto;background-color:rgba(0,0,0,.4);z-index:10000;pointer-events:none;opacity:0;transition:opacity .3s}.swal-overlay:before{content:" ";display:inline-block;vertical-align:middle;height:100%}.swal-overlay--show-modal{opacity:1;pointer-events:auto}.swal-overlay--show-modal .swal-modal{opacity:1;pointer-events:auto;box-sizing:border-box;-webkit-animation:showSweetAlert .3s;animation:showSweetAlert .3s;will-change:transform}.swal-modal{width:478px;opacity:0;pointer-events:none;background-color:#fff;text-align:center;border-radius:5px;position:static;margin:20px auto;display:inline-block;vertical-align:middle;-webkit-transform:scale(1);transform:scale(1);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;z-index:10001;transition:opacity .2s,-webkit-transform .3s;transition:transform .3s,opacity .2s;transition:transform .3s,opacity .2s,-webkit-transform .3s}@media (max-width:500px){.swal-modal{width:calc(100% - 20px)}}@-webkit-keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes showSweetAlert{0%{-webkit-transform:scale(1);transform:scale(1)}1%{-webkit-transform:scale(.5);transform:scale(.5)}45%{-webkit-transform:scale(1.05);transform:scale(1.05)}80%{-webkit-transform:scale(.95);transform:scale(.95)}to{-webkit-transform:scale(1);transform:scale(1)}}',""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(i);return[n].concat(i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"})).concat([r]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var s=this[r][0];"number"==typeof s&&(i[s]=!0)}for(r=0;r<t.length;r++){var o=t[r];"number"==typeof o[0]&&i[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(t,e,n){function i(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=p[i.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](i.parts[s]);for(;s<i.parts.length;s++)r.parts.push(c(i.parts[s],e))}else{var o=[];for(s=0;s<i.parts.length;s++)o.push(c(i.parts[s],e));p[i.id]={id:i.id,refs:1,parts:o}}}}function r(t,e){for(var n=[],i={},r=0;r<t.length;r++){var s=t[r],o=e.base?s[0]+e.base:s[0],a={css:s[1],media:s[2],sourceMap:s[3]};i[o]?i[o].parts.push(a):n.push(i[o]={id:o,parts:[a]})}return n}function s(t,e){var n=g(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=b[b.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),b.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function o(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=b.indexOf(t);e>=0&&b.splice(e,1)}function a(t){var e=document.createElement("style");return t.attrs.type="text/css",l(e,t.attrs),s(t,e),e}function u(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",l(e,t.attrs),s(t,e),e}function l(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function c(t,e){var n,i,r,s;if(e.transform&&t.css){if(!(s=e.transform(t.css)))return function(){};t.css=s}if(e.singleton){var l=v++;n=y||(y=a(e)),i=h.bind(null,n,l,!1),r=h.bind(null,n,l,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(e),i=f.bind(null,n,e),r=function(){o(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),i=d.bind(null,n),r=function(){o(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}function h(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(e,r);else{var s=document.createTextNode(r),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}function d(t,e){var n=e.css,i=e.media;if(i&&t.setAttribute("media",i),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e,n){var i=n.css,r=n.sourceMap;(e.convertToAbsoluteUrls||void 0===e.convertToAbsoluteUrls&&r)&&(i=x(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([i],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(s),o&&URL.revokeObjectURL(o)}var p={},m=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),g=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}(function(t){return document.querySelector(t)}),y=null,v=0,b=[],x=n(15);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=m()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=r(t,e);return i(n,e),function(t){for(var s=[],o=0;o<n.length;o++)(a=p[n[o].id]).refs--,s.push(a);for(t&&i(r(t,e),e),o=0;o<s.length;o++){var a;if(0===(a=s[o]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete p[a.id]}}}};var w=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,s=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(s)?t:(r=0===s.indexOf("//")?s:0===s.indexOf("/")?n+s:i+s.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){var i=n(17);"undefined"==typeof window||window.Promise||(window.Promise=i),n(21),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;for(var r=0|e,s=Math.max(r>=0?r:i-Math.abs(r),0);s<i;){if(function(t,e){return t===e||"number"==typeof t&&"number"==typeof e&&isNaN(t)&&isNaN(e)}(n[s],t))return!0;s++}return!1}}),"undefined"!=typeof window&&[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})},function(t,e,n){(function(e){!function(n){function i(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function s(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void a(e.promise,t)}o(e.promise,i)}else(1===t._state?o:a)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void c(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,u(t)}catch(e){a(t,e)}}function a(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)s(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,o(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}var h=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var n=new this.constructor(i);return s(this,new l(t,e,n)),n},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function i(s,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,function(t){i(s,t)},n)}e[s]=o,0==--r&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var r=e.length,s=0;s<e.length;s++)i(s,e[s])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var i=0,r=t.length;i<r;i++)t[i].then(e,n)})},r._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){h(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=r:n.Promise||(n.Promise=r)}(this)}).call(e,n(18).setImmediate)},function(t,e,n){function i(t,e){this._id=t,this._clearFn=e}var r=Function.prototype.apply;e.setTimeout=function(){return new i(r.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(r.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(19),e.setImmediate=setImmediate,e.clearImmediate=clearImmediate},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){delete a[t]}function r(t){if(u)setTimeout(r,0,t);else{var e=a[t];if(e){u=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{i(t),u=!1}}}}if(!t.setImmediate){var s,o=1,a={},u=!1,l=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,"[object process]"==={}.toString.call(t.process)?s=function(t){e.nextTick(function(){r(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&r(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){r(t.data)},s=function(e){t.port2.postMessage(e)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var t=l.documentElement;s=function(e){var n=l.createElement("script");n.onreadystatechange=function(){r(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():s=function(t){setTimeout(r,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];return a[o]={callback:t,args:e},s(o),o++},c.clearImmediate=i}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(7),n(20))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function s(){p&&d&&(p=!1,d.length?f=d.concat(f):m=-1,f.length&&o())}function o(){if(!p){var t=r(s);p=!0;for(var e=f.length;e;){for(d=f,f=[];++m<e;)d&&d[m].run();m=-1,e=f.length}d=null,p=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function u(){}var l,c,h=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{c="function"==typeof clearTimeout?clearTimeout:i}catch(t){c=i}}();var d,f=[],p=!1,m=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new a(t,e)),1!==f.length||p||r(o)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e,n){"use strict";n(22).polyfill()},function(t,e,n){"use strict";function i(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var s=Object.keys(Object(r)),o=0,a=s.length;o<a;o++){var u=s[o],l=Object.getOwnPropertyDescriptor(r,u);void 0!==l&&l.enumerable&&(n[u]=r[u])}}return n}t.exports={assign:i,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:i})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),r=n(6),s=n(5),o=n(36),a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof window){var n=o.getOpts.apply(void 0,t);return new Promise(function(t,e){s.default.promise={resolve:t,reject:e},i.default(n),setTimeout(function(){r.openModal()})})}};a.close=r.onAction,a.getState=r.getState,a.setActionValue=s.setActionValue,a.stopLoading=r.stopLoading,a.setDefaults=o.setDefaults,e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(0).default.MODAL,s=n(4),o=n(34),a=n(35),u=n(1);e.init=function(t){i.getNode(r)||(document.body||u.throwErr("You can only use SweetAlert AFTER the DOM has loaded!"),o.default(),s.default()),s.initModalContent(t),a.default(t)},e.default=e.init},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.modalMarkup='\n  <div class="'+i.default.MODAL+'" role="dialog" aria-modal="true"></div>',e.default=e.modalMarkup},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.default='<div \n    class="'+i.default.OVERLAY+'"\n    tabIndex="-1">\n  </div>'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0).default.ICON;e.errorIconMarkup=function(){var t=i+"--error",e=t+"__line";return'\n    <div class="'+t+'__x-mark">\n      <span class="'+e+" "+e+'--left"></span>\n      <span class="'+e+" "+e+'--right"></span>\n    </div>\n  '},e.warningIconMarkup=function(){var t=i+"--warning";return'\n    <span class="'+t+'__body">\n      <span class="'+t+'__dot"></span>\n    </span>\n  '},e.successIconMarkup=function(){var t=i+"--success";return'\n    <span class="'+t+"__line "+t+'__line--long"></span>\n    <span class="'+t+"__line "+t+'__line--tip"></span>\n\n    <div class="'+t+'__ring"></div>\n    <div class="'+t+'__hide-corners"></div>\n  '}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.contentMarkup='\n  <div class="'+i.default.CONTENT+'">\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0);e.buttonMarkup='\n  <div class="'+i.default.BUTTON_CONTAINER+'">\n\n    <button\n      class="'+i.default.BUTTON+'"\n    ></button>\n\n    <div class="'+i.default.BUTTON_LOADER+'">\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n\n  </div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),r=n(2),s=n(0),o=s.default.ICON,a=s.default.ICON_CUSTOM,u=["error","warning","success","info"],l={error:r.errorIconMarkup(),warning:r.warningIconMarkup(),success:r.successIconMarkup()};e.default=function(t){if(t){var e=i.injectElIntoModal(r.iconMarkup);u.includes(t)?function(t,e){e.classList.add(o+"--"+t);var n=l[t];n&&(e.innerHTML=n)}(t,e):function(t,e){e.classList.add(a);var n=document.createElement("img");n.src=t,e.appendChild(n)}(t,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),r=n(4),s=function(t){navigator.userAgent.includes("AppleWebKit")&&(t.style.display="none",t.style.display="")};e.initTitle=function(t){if(t){var e=r.injectElIntoModal(i.titleMarkup);e.textContent=t,s(e)}},e.initText=function(t){if(t){var e=document.createDocumentFragment();t.split("\n").forEach(function(t,n,i){e.appendChild(document.createTextNode(t)),n<i.length-1&&e.appendChild(document.createElement("br"))});var n=r.injectElIntoModal(i.textMarkup);n.appendChild(e),s(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(4),s=n(0),o=s.default.BUTTON,a=s.default.DANGER_BUTTON,u=n(3),l=n(2),c=n(6),h=n(5),d=function(t,e,n){var r=e.text,s=e.value,d=e.className,f=e.closeModal,p=i.stringToNode(l.buttonMarkup),m=p.querySelector("."+o);m.classList.add(o+"--"+t),d&&(Array.isArray(d)?d:d.split(" ")).filter(function(t){return t.length>0}).forEach(function(t){m.classList.add(t)}),n&&t===u.CONFIRM_KEY&&m.classList.add(a),m.textContent=r;var g={};return g[t]=s,h.setActionValue(g),h.setActionOptionsFor(t,{closeModal:f}),m.addEventListener("click",function(){return c.onAction(t)}),p};e.default=function(t,e){var n=r.injectElIntoModal(l.footerMarkup);for(var i in t){var s=t[i],o=d(i,s,e);s.visible&&n.appendChild(o)}0===n.children.length&&n.remove()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),r=n(4),s=n(2),o=n(5),a=n(6),u=n(0).default.CONTENT,l=function(t){t.addEventListener("input",function(t){o.setActionValue(t.target.value)}),t.addEventListener("keyup",function(t){if("Enter"===t.key)return a.onAction(i.CONFIRM_KEY)}),setTimeout(function(){t.focus(),o.setActionValue("")},0)};e.default=function(t){if(t){var e=r.injectElIntoModal(s.contentMarkup),n=t.element;"string"==typeof n?function(t,e,n){var i=document.createElement(e),r=u+"__"+e;for(var s in i.classList.add(r),n)i[s]=n[s];"input"===e&&l(i),t.appendChild(i)}(e,n,t.attributes):e.appendChild(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(2);e.default=function(){var t=i.stringToNode(r.overlayMarkup);document.body.appendChild(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),r=n(6),s=n(1),o=n(3),a=n(0),u=a.default.MODAL,l=a.default.BUTTON,c=a.default.OVERLAY,h=function(t){if(i.default.isOpen)switch(t.key){case"Escape":return r.onAction(o.CANCEL_KEY)}},d=function(t){if(i.default.isOpen)switch(t.key){case"Tab":return function(t){t.preventDefault(),p()}(t)}},f=function(t){if(i.default.isOpen)return"Tab"===t.key&&t.shiftKey?function(t){t.preventDefault(),m()}(t):void 0},p=function(){var t=s.getNode(l);t&&(t.tabIndex=0,t.focus())},m=function(){var t=s.getNode(u).querySelectorAll("."+l),e=t[t.length-1];e&&e.focus()},g=function(t){if(s.getNode(c)===t.target)return r.onAction(o.CANCEL_KEY)};e.default=function(t){t.closeOnEsc?document.addEventListener("keyup",h):document.removeEventListener("keyup",h),t.dangerMode?p():m(),function(){var t=s.getNode(u).querySelectorAll("."+l);t.length&&(function(t){t[t.length-1].addEventListener("keydown",d)}(t),function(t){t[0].addEventListener("keydown",f)}(t))}(),function(t){var e=s.getNode(c);e.removeEventListener("click",g),t&&e.addEventListener("click",g)}(t.closeOnClickOutside),function(t){i.default.timer&&clearTimeout(i.default.timer),t&&(i.default.timer=window.setTimeout(function(){return r.onAction(o.CANCEL_KEY)},t))}(t.timer)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=n(3),s=n(37),o=n(38),a={title:null,text:null,icon:null,buttons:r.defaultButtonList,content:null,className:null,closeOnClickOutside:!0,closeOnEsc:!0,dangerMode:!1,timer:null},u=Object.assign({},a);e.setDefaults=function(t){u=Object.assign({},a,t)};var l=function(t){var e=t&&t.button,n=t&&t.buttons;return void 0!==e&&void 0!==n&&i.throwErr("Cannot set both 'button' and 'buttons' options!"),void 0!==e?{confirm:e}:n},c=function(t){return i.ordinalSuffixOf(t+1)},h=function(t,e){i.throwErr(c(e)+" argument ('"+t+"') is invalid")},d=function(t,e){var n=t+1,r=e[n];i.isPlainObject(r)||void 0===r||i.throwErr("Expected "+c(n)+" argument ('"+r+"') to be a plain object")},f=function(t,e,n,r){var s=e instanceof Element;if("string"==typeof e){if(0===n)return{text:e};if(1===n)return{text:e,title:r[0]};if(2===n)return d(n,r),{icon:e};h(e,n)}else{if(s&&0===n)return d(n,r),{content:e};if(i.isPlainObject(e))return function(t,e){var n=t+1,r=e[n];void 0!==r&&i.throwErr("Unexpected "+c(n)+" argument ("+r+")")}(n,r),e;h(e,n)}};e.getOpts=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={};t.forEach(function(e,i){var r=f(0,e,i,t);Object.assign(n,r)});var i=l(n);n.buttons=r.getButtonListOpts(i),delete n.button,n.content=s.getContentOpts(n.content);var c=Object.assign({},a,u,n);return Object.keys(c).forEach(function(t){o.DEPRECATED_OPTS[t]&&o.logDeprecation(t)}),c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r={element:"input",attributes:{placeholder:""}};e.getContentOpts=function(t){return i.isPlainObject(t)?Object.assign({},t):t instanceof Element?{element:t}:"input"===t?r:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logDeprecation=function(t){var n=e.DEPRECATED_OPTS[t],i=n.replacement,r=n.subOption,s=n.link,o='SweetAlert warning: "'+t+'" option has been '+(n.onlyRename?"renamed":"deprecated")+".";i&&(o+=" Please use"+(r?' "'+r+'" in ':" ")+'"'+i+'" instead.');var a="https://sweetalert.js.org";o+=s?" More details: "+a+s:" More details: "+a+"/guides/#upgrading-from-1x",console.warn(o)},e.DEPRECATED_OPTS={type:{replacement:"icon",link:"/docs/#icon"},imageUrl:{replacement:"icon",link:"/docs/#icon"},customClass:{replacement:"className",onlyRename:!0,link:"/docs/#classname"},imageSize:{},showCancelButton:{replacement:"buttons",link:"/docs/#buttons"},showConfirmButton:{replacement:"button",link:"/docs/#button"},confirmButtonText:{replacement:"button",link:"/docs/#button"},confirmButtonColor:{},cancelButtonText:{replacement:"buttons",link:"/docs/#buttons"},closeOnConfirm:{replacement:"button",subOption:"closeModal",link:"/docs/#button"},closeOnCancel:{replacement:"buttons",subOption:"closeModal",link:"/docs/#buttons"},showLoaderOnConfirm:{replacement:"buttons"},animation:{},inputType:{replacement:"content",link:"/docs/#content"},inputValue:{replacement:"content",link:"/docs/#content"},inputPlaceholder:{replacement:"content",link:"/docs/#content"},html:{replacement:"content",link:"/docs/#content"},allowEscapeKey:{replacement:"closeOnEsc",onlyRename:!0,link:"/docs/#closeonesc"},allowClickOutside:{replacement:"closeOnClickOutside",onlyRename:!0,link:"/docs/#closeonclickoutside"}}}])});var queue=[],loaded=!1,SCALE_W=($(window).width()-5)/2133,SCALE_H=($(window).height()-5)/1041,SCALE=($(window).width()>$(window).height()?$(window).height()-5:$(window).width()-5)/1041,mode="menu",socket,playerN=0;function startGameMultiplayer(){setTimeout(function(){$("#game_start").text("Game start in 3"),setTimeout(function(){$("#game_start").text("Game start in 2"),setTimeout(function(){$("#game_start").text("Game start in 1"),setTimeout(function(){$("#game_start").text("Start!");for(var t=0;t<4;t++)game.scene.keys.BreakoutMultiplayer.balls[t].setData("onPaddle",!1),game.scene.keys.BreakoutMultiplayer.balls[t].setVelocity(game.scene.keys.BreakoutMultiplayer.ballsVelocitiy[t].x,game.scene.keys.BreakoutMultiplayer.ballsVelocitiy[t].y);setTimeout(function(){$("#game_start").text("")},1e3)},1e3)},1e3)},1e3)},1e3)}function getPaddlePosition(t,e,n){var i=($(window).width()-game.config.width)/2;return!0===n?Phaser.Math.Clamp(queue.reduce((t,e)=>t+e,0)/queue.length-i,e.width*t*.5/2,game.config.width-e.width*t*.5/2):Phaser.Math.Clamp(queue.reduce((t,e)=>t+e,0)/queue.length-i,e.height*t*.5/2,game.config.height-e.height*t*.5/2)}function drawPoint(t){var e=document.getElementById("plotting_canvas");e.style.zIndex="8000";var n=e.getContext("2d");n.fillStyle="red";var i=($(window).width()-game.config.width)/2,r=$(window).width()-i;ClearCanvas(),n.fillRect(t.x<i&&"multiplayer"===mode?i:t.x>r&&"multiplayer"===mode?r:t.x,t.y,10,10)}function paddle_move(t,e,n,i){var r=game.scene.keys.BreakoutMultiplayer.paddls[t-1],s=game.scene.keys.BreakoutMultiplayer.balls[t-1];switch(t){case 1:r.x=e?n*game.config.width:getPaddlePosition(SCALE,r,!0),s.getData("onPaddle")&&(s.x=r.x);break;case 2:r.x=e?n*game.config.width:game.config.width-getPaddlePosition(SCALE,r,!0),s.getData("onPaddle")&&(s.x=r.x);break;case 3:r.y=e?i*game.config.height:getPaddlePosition(SCALE,r,!1),s.getData("onPaddle")&&(s.y=r.y);break;case 4:r.y=e?i*game.config.height:game.config.height-getPaddlePosition(SCALE,r,!1),s.getData("onPaddle")&&(s.y=r.y)}e||socket.emit("update-paddle",{player_num:t,x:r.x/game.config.width,y:r.y/game.config.height})}function Restart(){webgazer.clearData(),ClearCalibration(),PopUpInstruction()}function Start(){loaded&&(mode="singleplayer",$("#mainScreen").hide(),ClearCanvas(),PointCalibrate>=9?(configBreakout.height=$(window).height()-5,configBreakout.width=$(window).width()-5,game=new Phaser.Game(configBreakout)):Restart())}function Recalibrate(){loaded&&(webgazer.showPredictionPoints(!0),$("#mainScreen").hide(),ClearCanvas(),mode="menu",Restart())}function Multiplayer(){$("#mainScreen").hide(),$("#createRoom").hide(),$("#joinRoom").hide(),$("#room").hide(),$("#multiplayer").show()}function HighScore(){$("#mainScreen").hide(),$("#highscores").show();var t=new CustomEvent("refreshScores");window.dispatchEvent(t)}function Help(){$("#mainScreen").hide(),$("#help").show()}function Authors(){$("#mainScreen").hide(),$("#authors").show()}function CreateRoom(){$("#multiplayer").hide(),$("#createRoom").show()}function GoToMenu(){$("#authors").hide(),$("#help").hide(),$("#highscores").hide(),$("#multiplayer").hide(),$("#room").hide(),$("#mainScreen").show()}function JoinRoom(){$("#multiplayer").hide(),$("#joinRoom").show()}function Room(){$("#createRoom").hide(),$("#joinRoom").hide(),$("#room").show()}function StartMultiplayer(t,e,n){if(loaded){Room(),(socket=io("https://83.212.82.139:5000")).emit("joined-room",{room_id:t,player_id:e,x:0,y:0}),socket.on("someone joined",()=>{var t=new CustomEvent("refreshRoom");window.dispatchEvent(t)}),socket.on("someone left",()=>{var t=new CustomEvent("refreshRoom");window.dispatchEvent(t)}),socket.on("paddle moved",t=>{paddle_move(t.player_num,!0,t.x,t.y)}),socket.on("start game",()=>{startGameMultiplayer()}),game=new Phaser.Game(configBreakoutMultiplayer);var i=0;switch(n){case 2:i=180;break;case 3:i=270;break;case 4:i=90}$("canvas:not(#plotting_canvas):not(#webgazerVideoFeed):not(#webgazerVideoCanvas):not(#webgazerFaceOverlay):not(#webgazerFaceFeedbackBox)").first().css("transform","rotate("+i+"deg)"),playerN=n,mode="multiplayer",webgazer.showPredictionPoints(!1)}}window.onload=async function(){var t;webgazer.params.showVideoPreview=!1,await webgazer.setGazeListener(function(t,e){if(!1===loaded&&($("#mainScreen").show(),$("#loading").hide()),loaded=!0,null!=t&&queue.length<5&&queue.push(t.x),null!=game&&null!=t&&null!=game.scene&&null!=game.scene.keys&&queue.length>=5)if(queue.push(t.x),queue.shift(),"singleplayer"===mode){if(null!=game.scene.keys.breakout&&null!=game.scene.keys.breakout.paddle){var n=game.scene.keys.breakout.paddle;n.x=getPaddlePosition(SCALE_W,n,!0)}}else"multiplayer"===mode&&(drawPoint(t),null!=game.scene.keys.BreakoutMultiplayer&&4===game.scene.keys.BreakoutMultiplayer.paddls.length&&paddle_move(playerN,!1))}).begin(),webgazer.showVideoPreview(!1).showPredictionPoints(!0).applyKalmanFilter(!0),(t=document.getElementById("plotting_canvas")).width=$(window).width()-5,t.height=$(window).height()-5,t.style.position="fixed"},window.saveDataAcrossSessions=!0,window.onbeforeunload=function(){webgazer.end()};var PointCalibrate=0,CalibrationPoints={};function ClearCanvas(){$(".Calibration").hide();var t=document.getElementById("plotting_canvas");t.getContext("2d").clearRect(0,0,t.width,t.height)}function PopUpInstruction(){ClearCanvas(),swal({title:"CALIBRATION",text:"Please click on each of the 9 points on the screen. You must click on each point 5 times till it goes yellow. This will calibrate your eye movements.",buttons:{cancel:"\u2190BACK",confirm:"OK\u2192"}}).then(t=>{t?ShowCalibrationPoint():$("#mainScreen").show()})}function ShowCalibrationPoint(){$(".Calibration").show(),$("#Pt5").hide()}function ClearCalibration(){$(".Calibration").css("background-color","red"),$(".Calibration").css("opacity",.2),$(".Calibration").prop("disabled",!1),CalibrationPoints={},PointCalibrate=0}function sleep(t){return new Promise(e=>setTimeout(e,t))}function calculatePrecision(t){var e=$(window).height(),n=$(window).width(),i=t[0],r=t[1],s=n/2,o=e/2,a=new Array(50);calculatePrecisionPercentages(a,e,i,r,s,o);var u=calculateAverage(a);return Math.round(u)}function calculatePrecisionPercentages(t,e,n,i,r,s){for(x=0;x<50;x++){var o=r-n[x],a=s-i[x],u=Math.sqrt(o*o+a*a),l=e/2,c=0;u<=l&&u>-1?c=100-u/l*100:u>l?c=0:u>-1&&(c=100),t[x]=c}}function calculateAverage(t){var e=0;for(x=0;x<50;x++)e+=t[x];return e/50}function store_points_variable(){webgazer.params.storingPoints=!0}function stop_storing_points_variable(){webgazer.params.storingPoints=!1}let levelTxt;$(document).ready(function(){ClearCanvas(),$(".Calibration").click(function(){var t=$(this).attr("id");if(CalibrationPoints[t]||(CalibrationPoints[t]=0),CalibrationPoints[t]++,5===CalibrationPoints[t])$(this).css("background-color","yellow"),$(this).prop("disabled",!0),PointCalibrate++;else if(CalibrationPoints[t]<5){var e=.2*CalibrationPoints[t]+.2;$(this).css("opacity",e)}if(8===PointCalibrate&&$("#Pt5").show(),PointCalibrate>=9){$(".Calibration").hide(),$("#Pt5").show();var n=document.getElementById("plotting_canvas");n.getContext("2d").clearRect(0,0,n.width,n.height),swal({title:"CALCULATING MEASURMENT",text:"Please don't move your mouse & stare at the middle dot for the next 5 seconds. This will allow us to calculate the accuracy of our predictions.",closeOnEsc:!1,closeOnClickOutside:!1,closeModal:!0,buttons:{confirm:"OK\u2192"}}).then(t=>{$(document).ready(function(){store_points_variable(),sleep(5e3).then(()=>{stop_storing_points_variable();var t=calculatePrecision(webgazer.getStoredPoints());const e=document.createElement("div");e.innerHTML="<p>Your accuracy measure is </p><h1 style='text-align: center; '>"+t+"%</h1>",swal({title:"CALCULATING DONE",content:e,closeOnClickOutside:!1,buttons:{cancel:"\u2190RECALIBRATE",confirm:"menu"===mode?"MENU\u2192":"START\u2192"}}).then(t=>{t?(ClearCanvas(),"menu"===mode?$("#mainScreen").show():(configBreakout.height=$(window).height()-5,configBreakout.width=$(window).width()-5,game=new Phaser.Game("singleplayer"===mode?configBreakout:configBreakoutMultiplayer))):(webgazer.clearData(),ClearCalibration(),ClearCanvas(),ShowCalibrationPoint())})})})})}})}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Phaser",[],e):"object"==typeof exports?exports.Phaser=e():t.Phaser=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,(function(e){return t[e]}).bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1371)}([function(t,e){function n(t,e,n){var i=n?t[e]:Object.getOwnPropertyDescriptor(t,e);return!n&&i.value&&"object"==typeof i.value&&(i=i.value),!(!i||!function(t){return!!t.get&&"function"==typeof t.get||!!t.set&&"function"==typeof t.set}(i))&&(void 0===i.enumerable&&(i.enumerable=!0),void 0===i.configurable&&(i.configurable=!0),i)}function i(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!!n&&(n.value&&"object"==typeof n.value&&(n=n.value),!1===n.configurable)}function r(t,e,r,s){for(var a in e)if(e.hasOwnProperty(a)){var u=n(e,a,r);if(!1!==u){if(i((s||t).prototype,a)){if(o.ignoreFinals)continue;throw new Error("cannot override final property '"+a+"', set Class.ignoreFinals = true to skip")}Object.defineProperty(t.prototype,a,u)}else t.prototype[a]=e[a]}}function s(t,e){if(e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)r(t,e[n].prototype||e[n])}}function o(t){var e,n;if(t||(t={}),t.initialize){if("function"!=typeof t.initialize)throw new Error("initialize must be a function");e=t.initialize,delete t.initialize}else if(t.Extends){var i=t.Extends;e=function(){i.apply(this,arguments)}}else e=function(){};t.Extends?(e.prototype=Object.create(t.Extends.prototype),e.prototype.constructor=e,n=t.Extends,delete t.Extends):e.prototype.constructor=e;var o=null;return t.Mixins&&(o=t.Mixins,delete t.Mixins),s(e,o),r(e,t,!0,n),e}o.extend=r,o.mixin=s,o.ignoreFinals=!1,t.exports=o},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e,n){var i=typeof t;return t&&"number"!==i&&"string"!==i&&t.hasOwnProperty(e)&&void 0!==t[e]?t[e]:n}},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.x=0,this.y=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0):(void 0===e&&(e=t),this.x=t||0,this.y=e||0)},clone:function(){return new i(this.x,this.y)},copy:function(t){return this.x=t.x||0,this.y=t.y||0,this},setFromObject:function(t){return this.x=t.x||0,this.y=t.y||0,this},set:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setTo:function(t,e){return this.set(t,e)},setToPolar:function(t,e){return null==e&&(e=1),this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this},equals:function(t){return this.x===t.x&&this.y===t.y},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},negate:function(){return this.x=-this.x,this.y=-this.y,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},length:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},lengthSq:function(){var t=this.x,e=this.y;return t*t+e*e},normalize:function(){var t=this.x,e=this.y,n=t*t+e*e;return n>0&&(n=1/Math.sqrt(n),this.x=t*n,this.y=e*n),this},normalizeRightHand:function(){var t=this.x;return this.x=-1*this.y,this.y=t,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this},transformMat3:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this},transformMat4:function(t){var e=this.x,n=this.y,i=t.val;return this.x=i[0]*e+i[4]*n+i[12],this.y=i[1]*e+i[5]*n+i[13],this},reset:function(){return this.x=0,this.y=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0),i.LEFT=new i(-1,0),i.UP=new i(0,-1),i.DOWN=new i(0,1),i.ONE=new i(1,1),t.exports=i},function(t,e,n){var i=n(0),r=n(46),s=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.type=r.POINT,this.x=t,this.y=e},setTo:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this}});t.exports=s},function(t,e,n){var i=n(0),r=n(20),s=n(21),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.systems.events.once(s.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(s.SHUTDOWN,this.shutdown,this)},existing:function(t){return(t.renderCanvas||t.renderWebGL)&&this.displayList.add(t),t.preUpdate&&this.updateList.add(t),t},shutdown:function(){this.systems.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectFactory",o,"add"),t.exports=o},function(t,e){t.exports=function(t,e,n){if(t&&"number"!=typeof t){if(t.hasOwnProperty(e))return t[e];if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=n,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o])){s=n;break}s=r[i[o]],r=r[i[o]]}return s}return n}return n}},function(t,e){t.exports=function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!{}.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0}},function(t,e){var n={},i={install:function(t){for(var e in n)t[e]=n[e]},register:function(t,e){n[t]=e},destroy:function(){n={}}};t.exports=i},function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,r="~";function s(){}function o(t,e,n,i,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new function(t,e,n){this.fn=t,this.context=e,this.once=n||!1}(n,i||t,s),a=r?r+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],o]:t._events[a].push(o):(t._events[a]=o,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function u(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(r?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},u.prototype.listeners=function(t){var e=this._events[r?r+t:t];if(!e)return[];if(e.fn)return[e.fn];for(var n=0,i=e.length,s=new Array(i);n<i;n++)s[n]=e[n].fn;return s},u.prototype.listenerCount=function(t){var e=this._events[r?r+t:t];return e?e.fn?1:e.length:0},u.prototype.emit=function(t,e,n,i,s,o){var a=r?r+t:t;if(!this._events[a])return!1;var u,l,c=this._events[a],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,i),!0;case 5:return c.fn.call(c.context,e,n,i,s),!0;case 6:return c.fn.call(c.context,e,n,i,s,o),!0}for(l=1,u=new Array(h-1);l<h;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var d,f=c.length;for(l=0;l<f;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,n);break;case 4:c[l].fn.call(c[l].context,e,n,i);break;default:if(!u)for(d=1,u=new Array(h-1);d<h;d++)u[d-1]=arguments[d];c[l].fn.apply(c[l].context,u)}}return!0},u.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},u.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},u.prototype.removeListener=function(t,e,n,i){var s=r?r+t:t;if(!this._events[s])return this;if(!e)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||i&&!o.once||n&&o.context!==n||a(this,s);else{for(var u=0,l=[],c=o.length;u<c;u++)(o[u].fn!==e||i&&!o[u].once||n&&o[u].context!==n)&&l.push(o[u]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},u.prototype.removeAllListeners=function(t){var e;return t?this._events[e=r?r+t:t]&&a(this,e):(this._events=new s,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},function(t,e){t.exports={getTintFromFloats:function(t,e,n,i){return((255&(255*i|0))<<24|(255&(255*t|0))<<16|(255&(255*e|0))<<8|255&(255*n|0))>>>0},getTintAppendFloatAlpha:function(t,e){return((255&(255*e|0))<<24|t)>>>0},getTintAppendFloatAlphaAndSwap:function(t,e){return((255&(255*e|0))<<24|(255&(0|t))<<16|(255&(t>>8|0))<<8|255&(t>>16|0))>>>0},getFloatsFromUintRGB:function(t){return[(255&(t>>16|0))/255,(255&(t>>8|0))/255,(255&(0|t))/255]},getComponentCount:function(t,e){for(var n=0,i=0;i<t.length;++i){var r=t[i];n+=r.type===e.FLOAT?r.size:1}return n}}},function(t,e,n){var i=n(0),r=n(47),s=n(147),o=n(255),a=n(46),u=n(55),l=n(150),c=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.RECTANGLE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return l(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getLineA:function(t){return void 0===t&&(t=new u),t.setTo(this.x,this.y,this.right,this.y),t},getLineB:function(t){return void 0===t&&(t=new u),t.setTo(this.right,this.y,this.right,this.bottom),t},getLineC:function(t){return void 0===t&&(t=new u),t.setTo(this.right,this.bottom,this.x,this.bottom),t},getLineD:function(t){return void 0===t&&(t=new u),t.setTo(this.x,this.bottom,this.x,this.y),t},left:{get:function(){return this.x},set:function(t){this.width=t>=this.right?0:this.right-t,this.x=t}},right:{get:function(){return this.x+this.width},set:function(t){this.width=t<=this.x?0:t-this.x}},top:{get:function(){return this.y},set:function(t){this.height=t>=this.bottom?0:this.bottom-t,this.y=t}},bottom:{get:function(){return this.y+this.height},set:function(t){this.height=t<=this.y?0:t-this.y}},centerX:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},centerY:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=c},function(t,e,n){t.exports={Alpha:n(250),Animation:n(482),BlendMode:n(253),ComputedSize:n(525),Crop:n(526),Depth:n(254),Flip:n(527),GetBounds:n(528),Mask:n(258),Origin:n(545),PathFollower:n(546),Pipeline:n(151),ScrollFactor:n(261),Size:n(547),Texture:n(548),TextureCrop:n(549),Tint:n(550),ToJSON:n(262),Transform:n(263),TransformMatrix:n(32),Visible:n(264)}},function(t,e,n){var i=n(0),r=n(262),s=n(111),o=n(9),a=n(90),u=new i({Extends:o,initialize:function(t,e){o.call(this),this.scene=t,this.type=e,this.state=0,this.parentContainer=null,this.name="",this.active=!0,this.tabIndex=-1,this.data=null,this.renderFlags=15,this.cameraFilter=0,this.input=null,this.body=null,this.ignoreDestroy=!1,t.sys.queueDepthSort()},setActive:function(t){return this.active=t,this},setName:function(t){return this.name=t,this},setState:function(t){return this.state=t,this},setDataEnabled:function(){return this.data||(this.data=new s(this)),this},setData:function(t,e){return this.data||(this.data=new s(this)),this.data.set(t,e),this},getData:function(t){return this.data||(this.data=new s(this)),this.data.get(t)},setInteractive:function(t,e,n){return this.scene.sys.input.enable(this,t,e,n),this},disableInteractive:function(){return this.input&&(this.input.enabled=!1),this},removeInteractive:function(){return this.scene.sys.input.clear(this),this.input=void 0,this},update:function(){},toJSON:function(){return r(this)},willRender:function(t){return!(u.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},getIndexList:function(){for(var t=this,e=this.parentContainer,n=[];e&&(n.unshift(e.getIndex(t)),t=e,e.parentContainer);)e=e.parentContainer;return n.unshift(this.scene.sys.displayList.getIndex(t)),n},destroy:function(t){if(void 0===t&&(t=!1),this.scene&&!this.ignoreDestroy){this.preDestroy&&this.preDestroy.call(this),this.emit(a.DESTROY,this);var e=this.scene.sys;t||(e.displayList.remove(this),e.updateList.remove(this)),this.input&&(e.input.clear(this),this.input=void 0),this.data&&(this.data.destroy(),this.data=void 0),this.body&&(this.body.destroy(),this.body=void 0),t||e.queueDepthSort(),this.active=!1,this.visible=!1,this.scene=void 0,this.parentContainer=void 0,this.removeAllListeners()}}});u.RENDER_MASK=15,t.exports=u},function(t,e,n){var i=n(166),r=n(6);t.exports=function(t,e,n){var s=r(t,e,null);if(null===s)return n;if(Array.isArray(s))return i.RND.pick(s);if("object"==typeof s){if(s.hasOwnProperty("randInt"))return i.RND.integerInRange(s.randInt[0],s.randInt[1]);if(s.hasOwnProperty("randFloat"))return i.RND.realInRange(s.randFloat[0],s.randFloat[1])}else if("function"==typeof s)return s(e);return s}},function(t,e,n){var i=n(0),r=n(20),s=n(21),o=new i({initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList,this.updateList=this.systems.updateList,this.systems.events.once(s.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(s.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.displayList=null,this.updateList=null}});o.register=function(t,e){o.prototype.hasOwnProperty(t)||(o.prototype[t]=e)},o.remove=function(t){o.prototype.hasOwnProperty(t)&&delete o.prototype[t]},r.register("GameObjectCreator",o,"make"),t.exports=o},function(t,e,n){var i=n(7),r=function(){var t,e,n,s,o,a,u=arguments[0]||{},l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),c===l&&(u=this,--l);l<c;l++)if(null!=(t=arguments[l]))for(e in t)n=u[e],u!==(s=t[e])&&(h&&s&&(i(s)||(o=Array.isArray(s)))?(o?(o=!1,a=n&&Array.isArray(n)?n:[]):a=n&&i(n)?n:{},u[e]=r(h,a,s)):void 0!==s&&(u[e]=s));return u};t.exports=r},function(t,e,n){t.exports={BLUR:n(529),BOOT:n(530),CONTEXT_LOST:n(531),CONTEXT_RESTORED:n(532),DESTROY:n(533),FOCUS:n(534),HIDDEN:n(535),PAUSE:n(536),POST_RENDER:n(537),POST_STEP:n(538),PRE_RENDER:n(539),PRE_STEP:n(540),READY:n(541),RESUME:n(542),STEP:n(543),VISIBLE:n(544)}},function(t,e){t.exports={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19}},function(t,e,n){var i=n(0),r=n(18),s=n(81),o=n(2),a=n(132),u=n(209),l=n(433),c=n(133),h=new i({initialize:function(t,e){this.loader=t,this.cache=o(e,"cache",!1),this.type=o(e,"type",!1),this.key=o(e,"key",!1);var n=this.key;if(t.prefix&&""!==t.prefix&&(this.key=t.prefix+n),!this.type||!this.key)throw new Error("Error calling 'Loader."+this.type+"' invalid key provided.");this.url=o(e,"url"),void 0===this.url?this.url=t.path+n+"."+o(e,"extension",""):"function"!=typeof this.url&&(this.url=t.path+this.url),this.src="",this.xhrSettings=c(o(e,"responseType",void 0)),o(e,"xhrSettings",!1)&&(this.xhrSettings=u(this.xhrSettings,o(e,"xhrSettings",{}))),this.xhrLoader=null,this.state="function"==typeof this.url?r.FILE_POPULATED:r.FILE_PENDING,this.bytesTotal=0,this.bytesLoaded=-1,this.percentComplete=-1,this.crossOrigin=void 0,this.data=void 0,this.config=o(e,"config",{})},setLink:function(t){this.linkFile=t,t.linkFile=this},resetXHR:function(){this.xhrLoader&&(this.xhrLoader.onload=void 0,this.xhrLoader.onerror=void 0,this.xhrLoader.onprogress=void 0)},load:function(){this.state===r.FILE_POPULATED?this.loader.nextFile(this,!0):(this.src=a(this,this.loader.baseURL),0===this.src.indexOf("data:")?console.warn("Local data URIs are not supported: "+this.key):this.xhrLoader=l(this,this.loader.xhr))},onLoad:function(t,e){var n=t.responseURL&&0===t.responseURL.indexOf("file://")&&0===e.target.status,i=!(e.target&&200!==e.target.status)||n;4===t.readyState&&t.status>=400&&t.status<=599&&(i=!1),this.resetXHR(),this.loader.nextFile(this,i)},onError:function(){this.resetXHR(),this.loader.nextFile(this,!1)},onProgress:function(t){t.lengthComputable&&(this.bytesLoaded=t.loaded,this.bytesTotal=t.total,this.percentComplete=Math.min(this.bytesLoaded/this.bytesTotal,1),this.loader.emit(s.FILE_PROGRESS,this,this.percentComplete))},onProcess:function(){this.state=r.FILE_PROCESSING,this.onProcessComplete()},onProcessComplete:function(){this.state=r.FILE_COMPLETE,this.multiFile&&this.multiFile.onFileComplete(this),this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=r.FILE_ERRORED,this.multiFile&&this.multiFile.onFileFailed(this),this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return this.cache&&this.cache.exists(this.key)},addToCache:function(){this.cache&&this.cache.add(this.key,this.data),this.pendingDestroy()},pendingDestroy:function(t){void 0===t&&(t=this.data);var e=this.key,n=this.type;this.loader.emit(s.FILE_COMPLETE,e,n,t),this.loader.emit(s.FILE_KEY_COMPLETE+n+"-"+e,e,n,t),this.loader.flagForRemoval(this)},destroy:function(){this.loader=null,this.cache=null,this.xhrSettings=null,this.multiFile=null,this.linkFile=null,this.data=null}});h.createObjectURL=function(t,e,n){if("function"==typeof URL)t.src=URL.createObjectURL(e);else{var i=new FileReader;i.onload=function(){t.removeAttribute("crossOrigin"),t.src="data:"+(e.type||n)+";base64,"+i.result.split(",")[1]},i.onerror=t.onerror,i.readAsDataURL(e)}},h.revokeObjectURL=function(t){"function"==typeof URL&&URL.revokeObjectURL(t.src)},t.exports=h},function(t,e){var n={},i={};t.exports={register:function(t,e,i,r){void 0===r&&(r=!1),n[t]={plugin:e,mapping:i,custom:r}},registerCustom:function(t,e,n,r){i[t]={plugin:e,mapping:n,data:r}},hasCore:function(t){return n.hasOwnProperty(t)},hasCustom:function(t){return i.hasOwnProperty(t)},getCore:function(t){return n[t]},getCustom:function(t){return i[t]},getCustomClass:function(t){return i.hasOwnProperty(t)?i[t].plugin:null},remove:function(t){n.hasOwnProperty(t)&&delete n[t]},removeCustom:function(t){i.hasOwnProperty(t)&&delete i[t]},destroyCorePlugins:function(){for(var t in n)n.hasOwnProperty(t)&&delete n[t]},destroyCustomPlugins:function(){for(var t in i)i.hasOwnProperty(t)&&delete i[t]}}},function(t,e,n){t.exports={BOOT:n(676),CREATE:n(677),DESTROY:n(678),PAUSE:n(679),POST_UPDATE:n(680),PRE_UPDATE:n(681),READY:n(682),RENDER:n(683),RESUME:n(684),SHUTDOWN:n(685),SLEEP:n(686),START:n(687),TRANSITION_COMPLETE:n(688),TRANSITION_INIT:n(689),TRANSITION_OUT:n(690),TRANSITION_START:n(691),TRANSITION_WAKE:n(692),UPDATE:n(693),WAKE:n(694)}},function(t,e){t.exports=function(t,e,n){return Math.max(e,Math.min(n,t))}},function(t,e){var n={PI2:2*Math.PI,TAU:.5*Math.PI,EPSILON:1e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null};t.exports=n},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=o.width),void 0===r&&(r=o.height);var a=i(s,"isNotEmpty",!1),u=i(s,"isColliding",!1),l=i(s,"hasInterestingFace",!1);t<0&&(n+=t,t=0),e<0&&(r+=e,e=0),t+n>o.width&&(n=Math.max(o.width-t,0)),e+r>o.height&&(r=Math.max(o.height-e,0));for(var c=[],h=e;h<e+r;h++)for(var d=t;d<t+n;d++){var f=o.data[h][d];if(null!==f){if(a&&-1===f.index)continue;if(u&&!f.collides)continue;if(l&&!f.hasInterestingFace)continue;c.push(f)}}return c}},function(t,e,n){var i,r,s,o=n(29),a=n(162),u=[],l=!1;t.exports={create2D:function(t,e,n){return i(t,e,n,o.CANVAS)},create:i=function(t,e,n,i,s){var c;void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=o.CANVAS),void 0===s&&(s=!1);var h=r(i);return null===h?(h={parent:t,canvas:document.createElement("canvas"),type:i},i===o.CANVAS&&u.push(h),c=h.canvas):(h.parent=t,c=h.canvas),s&&(h.parent=c),c.width=e,c.height=n,l&&i===o.CANVAS&&a.disable(c.getContext("2d")),c},createWebGL:function(t,e,n){return i(t,e,n,o.WEBGL)},disableSmoothing:function(){l=!0},enableSmoothing:function(){l=!1},first:r=function(t){if(void 0===t&&(t=o.CANVAS),t===o.WEBGL)return null;for(var e=0;e<u.length;e++){var n=u[e];if(!n.parent&&n.type===t)return n}return null},free:function(){return u.length-s()},pool:u,remove:function(t){var e=t instanceof HTMLCanvasElement;u.forEach(function(n){(e&&n.canvas===t||!e&&n.parent===t)&&(n.parent=null,n.canvas.width=1,n.canvas.height=1)})},total:s=function(){var t=0;return u.forEach(function(e){e.parent&&t++}),t}}},function(t,e){t.exports=function(t,e,n,i,r){var s=i.alpha*n.alpha;if(s<=0)return!1;var o=t._tempMatrix1.copyFromArray(i.matrix.matrix),a=t._tempMatrix2.applyITRS(n.x,n.y,n.rotation,n.scaleX,n.scaleY),u=t._tempMatrix3;return r?(o.multiplyWithOffset(r,-i.scrollX*n.scrollFactorX,-i.scrollY*n.scrollFactorY),a.e=n.x,a.f=n.y,o.multiply(a,u)):(a.e-=i.scrollX*n.scrollFactorX,a.f-=i.scrollY*n.scrollFactorY,o.multiply(a,u)),e.globalCompositeOperation=t.blendModes[n.blendMode],e.globalAlpha=s,e.save(),u.setToContext(e),e.imageSmoothingEnabled=!(!t.antialias||n.frame&&n.frame.source.scaleMode),!0}},function(t,e,n){var i=n(52),r=n(14);t.exports=function(t,e,n){e.x=r(n,"x",0),e.y=r(n,"y",0),e.depth=r(n,"depth",0),e.flipX=r(n,"flipX",!1),e.flipY=r(n,"flipY",!1);var s=r(n,"scale",null);"number"==typeof s?e.setScale(s):null!==s&&(e.scaleX=r(s,"x",1),e.scaleY=r(s,"y",1));var o=r(n,"scrollFactor",null);"number"==typeof o?e.setScrollFactor(o):null!==o&&(e.scrollFactorX=r(o,"x",1),e.scrollFactorY=r(o,"y",1)),e.rotation=r(n,"rotation",0);var a=r(n,"angle",null);null!==a&&(e.angle=a),e.alpha=r(n,"alpha",1);var u=r(n,"origin",null);if("number"==typeof u)e.setOrigin(u);else if(null!==u){var l=r(u,"x",.5),c=r(u,"y",.5);e.setOrigin(l,c)}return e.blendMode=r(n,"blendMode",i.NORMAL),e.visible=r(n,"visible",!0),r(n,"add",!0)&&t.sys.displayList.add(e),e.preUpdate&&t.sys.updateList.add(e),e}},function(t,e){t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,u=t.length;if(1===s)for(o=r;o<u;o++)t[o][e]=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]=n+a*i,a++;return t}},function(t,e,n){var i={VERSION:"3.20.1",BlendModes:n(52),ScaleModes:n(228),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};t.exports=i},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(55),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Depth,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Transform,r.Visible],initialize:function(t,e,n){void 0===e&&(e="Shape"),s.call(this,t,e),this.geom=n,this.pathData=[],this.pathIndexes=[],this.fillColor=16777215,this.fillAlpha=1,this.strokeColor=16777215,this.strokeAlpha=1,this.lineWidth=1,this.isFilled=!1,this.isStroked=!1,this.closePath=!0,this._tempLine=new o,this.initPipeline()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.isFilled=!1:(this.fillColor=t,this.fillAlpha=e,this.isFilled=!0),this},setStrokeStyle:function(t,e,n){return void 0===n&&(n=1),void 0===t?this.isStroked=!1:(this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=n,this.isStroked=!0),this},setClosePath:function(t){return this.closePath=t,this},preDestroy:function(){this.geom=null,this._tempLine=null,this.pathData=[],this.pathIndexes=[]}});t.exports=a},function(t,e){t.exports={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3}},function(t,e,n){var i=n(0),r=n(23),s=n(3),o=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),this.matrix=new Float32Array([t,e,n,i,r,s,0,0,1]),this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(t){this.matrix[0]=t}},b:{get:function(){return this.matrix[1]},set:function(t){this.matrix[1]=t}},c:{get:function(){return this.matrix[2]},set:function(t){this.matrix[2]=t}},d:{get:function(){return this.matrix[3]},set:function(t){this.matrix[3]=t}},e:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},f:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},tx:{get:function(){return this.matrix[4]},set:function(t){this.matrix[4]=t}},ty:{get:function(){return this.matrix[5]},set:function(t){this.matrix[5]=t}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*(Math.atan(-this.c/this.a)<0?-1:1)}},rotationNormalized:{get:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],s=t[3];return e||n?n>0?Math.acos(e/this.scaleX):-Math.acos(e/this.scaleX):i||s?r.TAU-(s>0?Math.acos(-i/this.scaleY):-Math.acos(i/this.scaleY)):0}},scaleX:{get:function(){return Math.sqrt(this.a*this.a+this.b*this.b)}},scaleY:{get:function(){return Math.sqrt(this.c*this.c+this.d*this.d)}},loadIdentity:function(){var t=this.matrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,this},translate:function(t,e){var n=this.matrix;return n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this},scale:function(t,e){var n=this.matrix;return n[0]*=t,n[1]*=t,n[2]*=e,n[3]*=e,this},rotate:function(t){var e=Math.sin(t),n=Math.cos(t),i=this.matrix,r=i[0],s=i[1],o=i[2],a=i[3];return i[0]=r*n+o*e,i[1]=s*n+a*e,i[2]=r*-e+o*n,i[3]=s*-e+a*n,this},multiply:function(t,e){var n=this.matrix,i=t.matrix,r=n[0],s=n[1],o=n[2],a=n[3],u=n[4],l=n[5],c=i[0],h=i[1],d=i[2],f=i[3],p=i[4],m=i[5],g=void 0===e?this:e;return g.a=c*r+h*o,g.b=c*s+h*a,g.c=d*r+f*o,g.d=d*s+f*a,g.e=p*r+m*o+u,g.f=p*s+m*a+l,g},multiplyWithOffset:function(t,e,n){var i=this.matrix,r=t.matrix,s=i[0],o=i[1],a=i[2],u=i[3],l=e*s+n*a+i[4],c=e*o+n*u+i[5],h=r[0],d=r[1],f=r[2],p=r[3],m=r[4],g=r[5];return i[0]=h*s+d*a,i[1]=h*o+d*u,i[2]=f*s+p*a,i[3]=f*o+p*u,i[4]=m*s+g*a+l,i[5]=m*o+g*u+c,this},transform:function(t,e,n,i,r,s){var o=this.matrix,a=o[0],u=o[1],l=o[2],c=o[3],h=o[4],d=o[5];return o[0]=t*a+e*l,o[1]=t*u+e*c,o[2]=n*a+i*l,o[3]=n*u+i*c,o[4]=r*a+s*l+h,o[5]=r*u+s*c+d,this},transformPoint:function(t,e,n){void 0===n&&(n={x:0,y:0});var i=this.matrix,r=i[1],s=i[3],o=i[5];return n.x=t*i[0]+e*i[2]+i[4],n.y=t*r+e*s+o,n},invert:function(){var t=this.matrix,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=e*r-n*i;return t[0]=r/a,t[1]=-n/a,t[2]=-i/a,t[3]=e/a,t[4]=(i*o-r*s)/a,t[5]=-(e*o-n*s)/a,this},copyFrom:function(t){var e=this.matrix;return e[0]=t.a,e[1]=t.b,e[2]=t.c,e[3]=t.d,e[4]=t.e,e[5]=t.f,this},copyFromArray:function(t){var e=this.matrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],this},copyToContext:function(t){var e=this.matrix;return t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t},setToContext:function(t){var e=this.matrix;return t.setTransform(e[0],e[1],e[2],e[3],e[4],e[5]),t},copyToArray:function(t){var e=this.matrix;return void 0===t?t=[e[0],e[1],e[2],e[3],e[4],e[5]]:(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5]),t},setTransform:function(t,e,n,i,r,s){var o=this.matrix;return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o[4]=r,o[5]=s,this},decomposeMatrix:function(){var t=this.decomposedMatrix,e=this.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(t.translateX=e[4],t.translateY=e[5],n||i){var a=Math.sqrt(n*n+i*i);t.rotation=i>0?Math.acos(n/a):-Math.acos(n/a),t.scaleX=a,t.scaleY=o/a}else if(r||s){var u=Math.sqrt(r*r+s*s);t.rotation=.5*Math.PI-(s>0?Math.acos(-r/u):-Math.acos(r/u)),t.scaleX=o/u,t.scaleY=u}else t.rotation=0,t.scaleX=0,t.scaleY=0;return t},applyITRS:function(t,e,n,i,r){var s=this.matrix,o=Math.sin(n),a=Math.cos(n);return s[4]=t,s[5]=e,s[0]=a*i,s[1]=o*i,s[2]=-o*r,s[3]=a*r,this},applyInverse:function(t,e,n){void 0===n&&(n=new s);var i=this.matrix,r=i[0],o=i[1],a=i[2],u=i[3],l=i[4],c=i[5],h=1/(r*u+a*-o);return n.x=u*h*t+-a*h*e+(c*a-l*u)*h,n.y=r*h*e+-o*h*t+(-c*r+l*o)*h,n},getX:function(t,e){return t*this.a+e*this.c+this.e},getY:function(t,e){return t*this.b+e*this.d+this.f},getCSSMatrix:function(){var t=this.matrix;return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"},destroy:function(){this.matrix=null,this.decomposedMatrix=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(160),s=n(276),o=n(161),a=n(277),u=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=255),this.r=0,this.g=0,this.b=0,this.a=255,this._h=0,this._s=0,this._v=0,this._locked=!1,this.gl=[0,0,0,1],this._color=0,this._color32=0,this._rgba="",this.setTo(t,e,n,i)},transparent:function(){return this._locked=!0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this._locked=!1,this.update(!0)},setTo:function(t,e,n,i,r){return void 0===i&&(i=255),void 0===r&&(r=!0),this._locked=!0,this.red=t,this.green=e,this.blue=n,this.alpha=i,this._locked=!1,this.update(r)},setGLTo:function(t,e,n,i){return void 0===i&&(i=1),this._locked=!0,this.redGL=t,this.greenGL=e,this.blueGL=n,this.alphaGL=i,this._locked=!1,this.update(!0)},setFromRGB:function(t){return this._locked=!0,this.red=t.r,this.green=t.g,this.blue=t.b,t.hasOwnProperty("a")&&(this.alpha=t.a),this._locked=!1,this.update(!0)},setFromHSV:function(t,e,n){return o(t,e,n,this)},update:function(t){if(void 0===t&&(t=!1),this._locked)return this;var e=this.r,n=this.g,i=this.b,o=this.a;return this._color=r(e,n,i),this._color32=s(e,n,i,o),this._rgba="rgba("+e+","+n+","+i+","+o/255+")",t&&a(e,n,i,this),this},updateHSV:function(){return a(this.r,this.g,this.b,this),this},clone:function(){return new u(this.r,this.g,this.b,this.a)},gray:function(t){return this.setTo(t,t,t)},random:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t)),i=Math.floor(t+Math.random()*(e-t)),r=Math.floor(t+Math.random()*(e-t));return this.setTo(n,i,r)},randomGray:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=Math.floor(t+Math.random()*(e-t));return this.setTo(n,n,n)},saturate:function(t){return this.s+=t/100,this},desaturate:function(t){return this.s-=t/100,this},lighten:function(t){return this.v+=t/100,this},darken:function(t){return this.v-=t/100,this},brighten:function(t){var e=this.r,n=this.g,i=this.b;return e=Math.max(0,Math.min(255,e-Math.round(-t/100*255))),n=Math.max(0,Math.min(255,n-Math.round(-t/100*255))),i=Math.max(0,Math.min(255,i-Math.round(-t/100*255))),this.setTo(e,n,i)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(t){this.gl[0]=Math.min(Math.abs(t),1),this.r=Math.floor(255*this.gl[0]),this.update(!0)}},greenGL:{get:function(){return this.gl[1]},set:function(t){this.gl[1]=Math.min(Math.abs(t),1),this.g=Math.floor(255*this.gl[1]),this.update(!0)}},blueGL:{get:function(){return this.gl[2]},set:function(t){this.gl[2]=Math.min(Math.abs(t),1),this.b=Math.floor(255*this.gl[2]),this.update(!0)}},alphaGL:{get:function(){return this.gl[3]},set:function(t){this.gl[3]=Math.min(Math.abs(t),1),this.a=Math.floor(255*this.gl[3]),this.update()}},red:{get:function(){return this.r},set:function(t){t=Math.floor(Math.abs(t)),this.r=Math.min(t,255),this.gl[0]=t/255,this.update(!0)}},green:{get:function(){return this.g},set:function(t){t=Math.floor(Math.abs(t)),this.g=Math.min(t,255),this.gl[1]=t/255,this.update(!0)}},blue:{get:function(){return this.b},set:function(t){t=Math.floor(Math.abs(t)),this.b=Math.min(t,255),this.gl[2]=t/255,this.update(!0)}},alpha:{get:function(){return this.a},set:function(t){t=Math.floor(Math.abs(t)),this.a=Math.min(t,255),this.gl[3]=t/255,this.update()}},h:{get:function(){return this._h},set:function(t){this._h=t,o(t,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(t){this._s=t,o(this._h,t,this._v,this)}},v:{get:function(){return this._v},set:function(t){this._v=t,o(this._h,this._s,t,this)}}});t.exports=u},function(t,e){t.exports=function(t,e,n,i,r,s){var o;void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=1);var a=0,u=t.length;if(1===s)for(o=r;o<u;o++)t[o][e]+=n+a*i,a++;else for(o=r;o>=0;o--)t[o][e]+=n+a*i,a++;return t}},function(t,e,n){var i=n(23);t.exports=function(t){return t*i.DEG_TO_RAD}},function(t,e){t.exports=function(t,e,n,i){var r=n||e.fillColor;t.fillStyle="rgba("+((16711680&r)>>>16)+","+((65280&r)>>>8)+","+(255&r)+","+(i||e.fillAlpha)+")"}},function(t,e,n){(function(e){var n={};t.exports=n,function(){n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n.extend=function(t,e){var i,r;"boolean"==typeof e?(i=2,r=e):(i=1,r=!0);for(var s=i;s<arguments.length;s++){var o=arguments[s];if(o)for(var a in o)r&&o[a]&&o[a].constructor===Object?t[a]&&t[a].constructor!==Object?t[a]=o[a]:(t[a]=t[a]||{},n.extend(t[a],r,o[a])):t[a]=o[a]}return t},n.clone=function(t,e){return n.extend({},e,t)},n.keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},n.values=function(t){var e=[];if(Object.keys){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(t[n[i]]);return e}for(var r in t)e.push(t[r]);return e},n.get=function(t,e,n,i){e=e.split(".").slice(n,i);for(var r=0;r<e.length;r+=1)t=t[e[r]];return t},n.set=function(t,e,i,r,s){var o=e.split(".").slice(r,s);return n.get(t,e,0,-1)[o[o.length-1]]=i,i},n.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(n.random()*(e+1)),r=t[e];t[e]=t[i],t[i]=r}return t},n.choose=function(t){return t[Math.floor(n.random()*t.length)]},n.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},n.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n.isFunction=function(t){return"function"==typeof t},n.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},n.isString=function(t){return"[object String]"===toString.call(t)},n.clamp=function(t,e,n){return t<e?e:t>n?n:t},n.sign=function(t){return t<0?-1:1},n.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-n._nowStartTime},n.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var t=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280};n.colorToNumber=function(t){return 3==(t=t.replace("#","")).length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.nextId=function(){return n._nextId++},n.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},n.map=function(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n},n.topologicalSort=function(t){var e=[],i=[],r=[];for(var s in t)i[s]||r[s]||n._topologicalSort(s,i,r,t,e);return e},n._topologicalSort=function(t,e,i,r,s){var o=r[t]||[];i[t]=!0;for(var a=0;a<o.length;a+=1){var u=o[a];i[u]||e[u]||n._topologicalSort(u,e,i,r,s)}i[t]=!1,e[t]=!0,s.push(t)},n.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var n=arguments[e];n._chained?t.push.apply(t,n._chained):t.push(n)}var i=function(){for(var e,n=new Array(arguments.length),i=0,r=arguments.length;i<r;i++)n[i]=arguments[i];for(i=0;i<t.length;i+=1){var s=t[i].apply(e,n);void 0!==s&&(e=s)}return e};return i._chained=t,i},n.chainPathBefore=function(t,e,i){return n.set(t,e,n.chain(i,n.get(t,e)))},n.chainPathAfter=function(t,e,i){return n.set(t,e,n.chain(n.get(t,e),i))},n._requireGlobal=function(t,n){return"undefined"!=typeof window?window[t]:void 0!==e?e[t]:null}}()}).call(this,n(227))},function(t,e){t.exports=function(t){return t.y+t.height-t.height*t.originY}},function(t,e){t.exports=function(t,e){return t.y=e-t.height+t.height*t.originY,t}},function(t,e){t.exports=function(t){return t.x-t.width*t.originX}},function(t,e){t.exports=function(t,e){return t.x=e+t.width*t.originX,t}},function(t,e){t.exports=function(t){return t.x+t.width-t.width*t.originX}},function(t,e){t.exports=function(t,e){return t.x=e-t.width+t.width*t.originX,t}},function(t,e){t.exports=function(t){return t.y-t.height*t.originY}},function(t,e){t.exports=function(t,e){return t.y=e+t.height*t.originY,t}},function(t,e){t.exports={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6}},function(t,e){t.exports=function(t,e,n){return!(t.width<=0||t.height<=0)&&t.x<=e&&t.x+t.width>=e&&t.y<=n&&t.y+t.height>=n}},function(t,e,n){t.exports={DESTROY:n(617),FADE_IN_COMPLETE:n(618),FADE_IN_START:n(619),FADE_OUT_COMPLETE:n(620),FADE_OUT_START:n(621),FLASH_COMPLETE:n(622),FLASH_START:n(623),PAN_COMPLETE:n(624),PAN_START:n(625),POST_RENDER:n(626),PRE_RENDER:n(627),SHAKE_COMPLETE:n(628),SHAKE_START:n(629),ZOOM_COMPLETE:n(630),ZOOM_START:n(631)}},function(t,e){t.exports=function(t,e,n,i){var r=n||e.strokeColor;t.strokeStyle="rgba("+((16711680&r)>>>16)+","+((65280&r)>>>8)+","+(255&r)+","+(i||e.strokeAlpha)+")",t.lineWidth=e.lineWidth}},function(t,e){t.exports={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14}},function(t,e,n){var i=n(137),r=n(24);t.exports=function(t,e,n,s,o){for(var a=null,u=null,l=null,c=null,h=r(t,e,n,s,null,o),d=0;d<h.length;d++){var f=h[d];f&&(f.collides?(a=i(f.x,f.y-1,!0,o),u=i(f.x,f.y+1,!0,o),l=i(f.x-1,f.y,!0,o),c=i(f.x+1,f.y,!0,o),f.faceTop=!a||!a.collides,f.faceBottom=!u||!u.collides,f.faceLeft=!l||!l.collides,f.faceRight=!c||!c.collides):f.resetFaces())}}},function(t,e){t.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}},function(t,e,n){t.exports={BOOT:n(798),DESTROY:n(799),DRAG_END:n(800),DRAG_ENTER:n(801),DRAG:n(802),DRAG_LEAVE:n(803),DRAG_OVER:n(804),DRAG_START:n(805),DROP:n(806),GAME_OUT:n(807),GAME_OVER:n(808),GAMEOBJECT_DOWN:n(809),GAMEOBJECT_DRAG_END:n(810),GAMEOBJECT_DRAG_ENTER:n(811),GAMEOBJECT_DRAG:n(812),GAMEOBJECT_DRAG_LEAVE:n(813),GAMEOBJECT_DRAG_OVER:n(814),GAMEOBJECT_DRAG_START:n(815),GAMEOBJECT_DROP:n(816),GAMEOBJECT_MOVE:n(817),GAMEOBJECT_OUT:n(818),GAMEOBJECT_OVER:n(819),GAMEOBJECT_POINTER_DOWN:n(820),GAMEOBJECT_POINTER_MOVE:n(821),GAMEOBJECT_POINTER_OUT:n(822),GAMEOBJECT_POINTER_OVER:n(823),GAMEOBJECT_POINTER_UP:n(824),GAMEOBJECT_POINTER_WHEEL:n(825),GAMEOBJECT_UP:n(826),GAMEOBJECT_WHEEL:n(827),MANAGER_BOOT:n(828),MANAGER_PROCESS:n(829),MANAGER_UPDATE:n(830),POINTER_DOWN:n(831),POINTER_DOWN_OUTSIDE:n(832),POINTER_MOVE:n(833),POINTER_OUT:n(834),POINTER_OVER:n(835),POINTER_UP:n(836),POINTER_UP_OUTSIDE:n(837),POINTER_WHEEL:n(838),POINTERLOCK_CHANGE:n(839),PRE_UPDATE:n(840),SHUTDOWN:n(841),START:n(842),UPDATE:n(843)}},function(t,e){t.exports=function(t,e,n){return t.radius>0&&e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom&&(t.x-e)*(t.x-e)+(t.y-n)*(t.y-n)<=t.radius*t.radius}},function(t,e,n){var i=n(0),r=n(256),s=n(148),o=n(46),a=n(149),u=n(3),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=o.LINE,this.x1=t,this.y1=e,this.x2=n,this.y2=i},getPoint:function(t,e){return r(this,t,e)},getPoints:function(t,e,n){return s(this,t,e,n)},getRandomPoint:function(t){return a(this,t)},setTo:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this},getPointA:function(t){return void 0===t&&(t=new u),t.set(this.x1,this.y1),t},getPointB:function(t){return void 0===t&&(t=new u),t.set(this.x2,this.y2),t},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(t){this.x1<=this.x2?this.x1=t:this.x2=t}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(t){this.x1>this.x2?this.x1=t:this.x2=t}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(t){this.y1<=this.y2?this.y1=t:this.y2=t}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(t){this.y1>this.y2?this.y1=t:this.y2=t}}});t.exports=l},function(t,e){t.exports=function(t){return Math.sqrt((t.x2-t.x1)*(t.x2-t.x1)+(t.y2-t.y1)*(t.y2-t.y1))}},function(t,e){t.exports=function(t,e,n){var i=n-e;return e+((t-e)%i+i)%i}},function(t,e){t.exports=function(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)}},function(t,e,n){t.exports={COMPLETE:n(866),DECODED:n(867),DECODED_ALL:n(868),DESTROY:n(869),DETUNE:n(870),GLOBAL_DETUNE:n(871),GLOBAL_MUTE:n(872),GLOBAL_RATE:n(873),GLOBAL_VOLUME:n(874),LOOP:n(875),LOOPED:n(876),MUTE:n(877),PAUSE_ALL:n(878),PAUSE:n(879),PLAY:n(880),RATE:n(881),RESUME_ALL:n(882),RESUME:n(883),SEEK:n(884),STOP_ALL:n(885),STOP:n(886),UNLOCKED:n(887),VOLUME:n(888)}},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(6),l=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,o){var c="json";if(l(e)){var h=e;e=a(h,"key"),n=a(h,"url"),i=a(h,"xhrSettings"),c=a(h,"extension",c),o=a(h,"dataKey",o)}s.call(this,t,{type:"json",cache:t.cacheManager.json,extension:c,responseType:"text",key:e,url:n,xhrSettings:i,config:o}),l(n)&&(this.data=o?u(n,o):n,this.state=r.FILE_POPULATED)},onProcess:function(){if(this.state!==r.FILE_POPULATED){this.state=r.FILE_PROCESSING;var t=JSON.parse(this.xhrLoader.responseText),e=this.config;this.data="string"==typeof e?u(t,e,t):t}this.onProcessComplete()}});o.register("json",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new c(this,t[r]));else this.addFile(new c(this,t,e,i,n));return this}),t.exports=c},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.loader=t,this.type=e,this.key=n,this.multiKeyIndex=t.multiKeyIndex++,this.files=i,this.complete=!1,this.pending=i.length,this.failed=0,this.config={},this.baseURL=t.baseURL,this.path=t.path,this.prefix=t.prefix;for(var r=0;r<i.length;r++)i[r].multiFile=this},isReadyToProcess:function(){return 0===this.pending&&0===this.failed&&!this.complete},addToMultiFile:function(t){return this.files.push(t),t.multiFile=this,this.pending++,this.complete=!1,this},onFileComplete:function(t){-1!==this.files.indexOf(t)&&this.pending--},onFileFailed:function(t){-1!==this.files.indexOf(t)&&this.failed++}});t.exports=i},function(t,e,n){var i={};t.exports=i;var r=n(86),s=n(101),o=n(452),a=n(37),u=n(102),l=n(1264);!function(){i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i.create=function(e){var n={id:a.nextId(),type:"body",label:"Body",gameObject:null,parts:[],plugin:{},angle:0,vertices:r.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},previousPositionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,ignoreGravity:!1,ignorePointer:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},i=a.extend(n,e);return t(i,e),i},i.nextGroup=function(t){return t?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var t=function(t,e){e=e||{},i.set(t,{bounds:t.bounds||u.create(t.vertices),positionPrev:t.positionPrev||s.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),r.rotate(t.vertices,t.angle,t.position),l.rotate(t.axes,t.angle),u.update(t.bounds,t.vertices,t.velocity),i.set(t,{axes:e.axes||t.axes,area:e.area||t.area,mass:e.mass||t.mass,inertia:e.inertia||t.inertia});var n=t.isStatic?"#2e2b44":a.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);t.render.fillStyle=t.render.fillStyle||n,t.render.strokeStyle=t.render.strokeStyle||"#000",t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};i.set=function(t,e,n){var r;for(r in"string"==typeof e&&(r=e,(e={})[r]=n),e)if(e.hasOwnProperty(r))switch(n=e[r],r){case"isStatic":i.setStatic(t,n);break;case"isSleeping":o.set(t,n);break;case"mass":i.setMass(t,n);break;case"density":i.setDensity(t,n);break;case"inertia":i.setInertia(t,n);break;case"vertices":i.setVertices(t,n);break;case"position":i.setPosition(t,n);break;case"angle":i.setAngle(t,n);break;case"velocity":i.setVelocity(t,n);break;case"angularVelocity":i.setAngularVelocity(t,n);break;case"parts":i.setParts(t,n);break;default:t[r]=n}},i.setStatic=function(t,e){for(var n=0;n<t.parts.length;n++){var i=t.parts[n];i.isStatic=e,e?(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia},i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null)}},i.setMass=function(t,e){t.inertia=t.inertia/(t.mass/6)*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},i.setDensity=function(t,e){i.setMass(t,e*t.area),t.density=e},i.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},i.setVertices=function(t,e){t.vertices=e[0].body===t?e:r.create(e,t),t.axes=l.fromVertices(t.vertices),t.area=r.area(t.vertices),i.setMass(t,t.density*t.area);var n=r.centre(t.vertices);r.translate(t.vertices,n,-1),i.setInertia(t,i._inertiaScale*r.inertia(t.vertices,t.mass)),r.translate(t.vertices,t.position),u.update(t.bounds,t.vertices,t.velocity)},i.setParts=function(t,e,n){var s;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,s=0;s<e.length;s++){var o=e[s];o!==t&&(o.parent=t,t.parts.push(o))}if(1!==t.parts.length){if(n=void 0===n||n){var a=[];for(s=0;s<e.length;s++)a=a.concat(e[s].vertices);r.clockwiseSort(a);var u=r.hull(a),l=r.centre(u);i.setVertices(t,u),r.translate(t.vertices,l)}var c=i._totalProperties(t);t.area=c.area,t.parent=t,t.position.x=c.centre.x,t.position.y=c.centre.y,t.positionPrev.x=c.centre.x,t.positionPrev.y=c.centre.y,i.setMass(t,c.mass),i.setInertia(t,c.inertia),i.setPosition(t,c.centre)}},i.setPosition=function(t,e){var n=s.sub(e,t.position);t.positionPrev.x+=n.x,t.positionPrev.y+=n.y;for(var i=0;i<t.parts.length;i++){var o=t.parts[i];o.position.x+=n.x,o.position.y+=n.y,r.translate(o.vertices,n),u.update(o.bounds,o.vertices,t.velocity)}},i.setAngle=function(t,e){var n=e-t.angle;t.anglePrev+=n;for(var i=0;i<t.parts.length;i++){var o=t.parts[i];o.angle+=n,r.rotate(o.vertices,n,t.position),l.rotate(o.axes,n),u.update(o.bounds,o.vertices,t.velocity),i>0&&(o.angle+=t.angularVelocity,s.rotateAbout(o.position,n,t.position,o.position))}},i.setVelocity=function(t,e){t.positionPrev.x=t.position.x-e.x,t.positionPrev.y=t.position.y-e.y,t.velocity.x=e.x,t.velocity.y=e.y,t.speed=s.magnitude(t.velocity)},i.setAngularVelocity=function(t,e){t.anglePrev=t.angle-e,t.angularVelocity=e,t.angularSpeed=Math.abs(t.angularVelocity)},i.translate=function(t,e){i.setPosition(t,s.add(t.position,e))},i.rotate=function(t,e,n){if(n){var r=Math.cos(e),s=Math.sin(e),o=t.position.x-n.x,a=t.position.y-n.y;i.setPosition(t,{x:n.x+(o*r-a*s),y:n.y+(o*s+a*r)}),i.setAngle(t,t.angle+e)}else i.setAngle(t,t.angle+e)},i.scale=function(t,e,n,s){var o=0,a=0;s=s||t.position;for(var c=0;c<t.parts.length;c++){var h=t.parts[c];r.scale(h.vertices,e,n,s),h.axes=l.fromVertices(h.vertices),h.area=r.area(h.vertices),i.setMass(h,t.density*h.area),r.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),i.setInertia(h,i._inertiaScale*r.inertia(h.vertices,h.mass)),r.translate(h.vertices,{x:h.position.x,y:h.position.y}),c>0&&(o+=h.area,a+=h.inertia),h.position.x=s.x+(h.position.x-s.x)*e,h.position.y=s.y+(h.position.y-s.y)*n,u.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=o,t.isStatic||(i.setMass(t,t.density*o),i.setInertia(t,a))),t.circleRadius&&(e===n?t.circleRadius*=e:t.circleRadius=null)},i.update=function(t,e,n,i){var o=Math.pow(e*n*t.timeScale,2),a=1-t.frictionAir*n*t.timeScale,c=t.position.y-t.positionPrev.y;t.velocity.x=(t.position.x-t.positionPrev.x)*a*i+t.force.x/t.mass*o,t.velocity.y=c*a*i+t.force.y/t.mass*o,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*a*i+t.torque/t.inertia*o,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=s.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var h=0;h<t.parts.length;h++){var d=t.parts[h];r.translate(d.vertices,t.velocity),h>0&&(d.position.x+=t.velocity.x,d.position.y+=t.velocity.y),0!==t.angularVelocity&&(r.rotate(d.vertices,t.angularVelocity,t.position),l.rotate(d.axes,t.angularVelocity),h>0&&s.rotateAbout(d.position,t.angularVelocity,t.position,d.position)),u.update(d.bounds,d.vertices,t.velocity)}},i.applyForce=function(t,e,n){t.force.x+=n.x,t.force.y+=n.y,t.torque+=(e.x-t.position.x)*n.y-(e.y-t.position.y)*n.x},i._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===t.parts.length?0:1;n<t.parts.length;n++){var i=t.parts[n],r=i.mass!==1/0?i.mass:1;e.mass+=r,e.area+=i.area,e.inertia+=i.inertia,e.centre=s.add(e.centre,s.mult(i.position,r))}return e.centre=s.div(e.centre,e.mass),e}}()},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=!0);var r=i.baseTileWidth,s=i.tilemapLayer;return s&&(void 0===n&&(n=s.scene.cameras.main),t-=s.x+n.scrollX*(1-s.scrollFactorX),r*=s.scaleX),e?Math.floor(t/r):t/r}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=!0);var r=i.baseTileHeight,s=i.tilemapLayer;return s&&(void 0===n&&(n=s.scene.cameras.main),t-=s.y+n.scrollY*(1-s.scrollFactorY),r*=s.scaleY),e?Math.floor(t/r):t/r}},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,a,u,l,c,f,m,g=e&&e.length,y=g?e[0]*n:t.length,v=r(t,0,y,n,!0),b=[];if(!v||v.next===v.prev)return b;if(g&&(v=function(t,e,n,i){var o,a,u,l=[];for(o=0,a=e.length;o<a;o++)(u=r(t,e[o]*i,o<a-1?e[o+1]*i:t.length,i,!1))===u.next&&(u.steiner=!0),l.push(p(u));for(l.sort(h),o=0;o<l.length;o++)d(l[o],n),n=s(n,n.next);return n}(t,e,v,n)),t.length>80*n){i=u=t[0],a=l=t[1];for(var x=n;x<y;x+=n)(c=t[x])<i&&(i=c),(f=t[x+1])<a&&(a=f),c>u&&(u=c),f>l&&(l=f);m=0!==(m=Math.max(u-i,l-a))?1/m:0}return o(v,b,n,i,a,m),b}function r(t,e,n,i,r){var s,o;if(r===O(t,e,n,i)>0)for(s=e;s<n;s+=i)o=T(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=T(s,t[s],t[s+1],o);return o&&v(o,o.next)&&(S(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function o(t,e,n,i,r,h,d){if(t){!d&&h&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=f(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,u,l=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;a>0||u>0&&i;)0!==a&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,l*=2}while(o>1)}(r)}(t,i,r,h);for(var p,m,g=t;t.prev!==t.next;)if(p=t.prev,m=t.next,h?u(t,i,r,h):a(t))e.push(p.i/n),e.push(t.i/n),e.push(m.i/n),S(t),t=m.next,g=m.next;else if((t=m)===g){d?1===d?o(t=l(t,e,n),e,n,i,r,h,2):2===d&&c(t,e,n,i,r,h):o(s(t),e,n,i,r,h,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(y(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(m(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&y(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,s=t,o=t.next;if(y(r,s,o)>=0)return!1;for(var a=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,l=f(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,n,i),c=f(a,u,e,n,i),h=t.prevZ,d=t.nextZ;h&&h.z>=l&&d&&d.z<=c;){if(h!==t.prev&&h!==t.next&&m(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&y(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&m(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=l;){if(h!==t.prev&&h!==t.next&&m(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&y(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=c;){if(d!==t.prev&&d!==t.next&&m(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!v(r,s)&&b(r,i,i.next,s)&&x(r,s)&&x(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),S(i),S(i.next),i=t=s),i=i.next}while(i!==t);return i}function c(t,e,n,i,r,a){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&g(u,l)){var c=w(u,l);return u=s(u,u.next),c=s(c,c.next),o(u,e,n,i,r,a),void o(c,e,n,i,r,a)}l=l.next}u=u.next}while(u!==t)}function h(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n.prev;var u,l=n,c=n.x,h=n.y,d=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=c&&r!==i.x&&m(s<h?r:o,s,c,h,s<h?o:r,s,i.x,i.y)&&((u=Math.abs(s-i.y)/(r-i.x))<d||u===d&&i.x>n.x)&&x(i,t)&&(n=i,d=u),i=i.next;return n}(t,e)){var n=w(e,t);s(n,n.next)}}function f(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function m(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,i){return!!(v(t,e)&&v(n,i)||v(t,i)&&v(n,e))||y(t,e,n)>0!=y(t,e,i)>0&&y(n,i,t)>0!=y(n,i,e)>0}function x(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function w(t,e){var n=new E(t.i,t.x,t.y),i=new E(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function T(t,e,n,i){var r=new E(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}t.exports=i,i.deviation=function(t,e,n,i){var r=e&&e.length,s=Math.abs(O(t,0,r?e[0]*n:t.length,n));if(r)for(var o=0,a=e.length;o<a;o++)s-=Math.abs(O(t,e[o]*n,o<a-1?e[o+1]*n:t.length,n));var u=0;for(o=0;o<i.length;o+=3){var l=i[o]*n,c=i[o+1]*n,h=i[o+2]*n;u+=Math.abs((t[l]-t[h])*(t[c+1]-t[l+1])-(t[l]-t[c])*(t[h+1]-t[l+1]))}return 0===s&&0===u?0:Math.abs((u-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&n.holes.push(i+=t[r-1].length)}return n}},function(t,e){t.exports=function(t){var e={};for(var n in t)e[n]=Array.isArray(t[n])?t[n].slice(0):t[n];return e}},function(t,e){t.exports=function(t,e,n,i){var r=t.length;if(e<0||e>r||e>=n||n>r||e+n>r){if(i)throw new Error("Range Error: Values outside acceptable range");return!1}return!0}},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(944),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Size,r.TextureCrop,r.Tint,r.Transform,r.Visible,o],initialize:function(t,e,n,i,o){s.call(this,t,"Sprite"),this._crop=this.resetCropObject(),this.anims=new r.Animation(this),this.setTexture(i,o),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()},preUpdate:function(t,e){this.anims.update(t,e)},play:function(t,e,n){return this.anims.play(t,e,n),this},toJSON:function(){return r.ToJSON(this)},preDestroy:function(){this.anims.destroy(),this.anims=void 0}});t.exports=a},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=t.strokeTint,a=i.getTintAppendFloatAlphaAndSwap(e.strokeColor,e.strokeAlpha*n);o.TL=a,o.TR=a,o.BL=a,o.BR=a;var u=e.pathData,l=u.length-1,c=e.lineWidth,h=c/2,d=u[0]-r,f=u[1]-s;e.closePath||(l-=2);for(var p=2;p<l;p+=2){var m=u[p]-r,g=u[p+1]-s;t.setTexture2D(),t.batchLine(d,f,m,g,h,h,c,p-2,!!e.closePath&&p===l-1),d=m,f=g}}},function(t,e,n){var i=n(0),r=n(83),s=n(401),o=n(402),a=n(46),u=n(55),l=n(153),c=new i({initialize:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.type=a.TRIANGLE,this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return l(this,t)},setTo:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),this.x1=t,this.y1=e,this.x2=n,this.y2=i,this.x3=r,this.y3=s,this},getLineA:function(t){return void 0===t&&(t=new u),t.setTo(this.x1,this.y1,this.x2,this.y2),t},getLineB:function(t){return void 0===t&&(t=new u),t.setTo(this.x2,this.y2,this.x3,this.y3),t},getLineC:function(t){return void 0===t&&(t=new u),t.setTo(this.x3,this.y3,this.x1,this.y1),t},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(t){var e;this.x1-=e=this.x1<=this.x2&&this.x1<=this.x3?this.x1-t:this.x2<=this.x1&&this.x2<=this.x3?this.x2-t:this.x3-t,this.x2-=e,this.x3-=e}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(t){var e;this.x1-=e=this.x1>=this.x2&&this.x1>=this.x3?this.x1-t:this.x2>=this.x1&&this.x2>=this.x3?this.x2-t:this.x3-t,this.x2-=e,this.x3-=e}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(t){var e;this.y1-=e=this.y1<=this.y2&&this.y1<=this.y3?this.y1-t:this.y2<=this.y1&&this.y2<=this.y3?this.y2-t:this.y3-t,this.y2-=e,this.y3-=e}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(t){var e;this.y1-=e=this.y1>=this.y2&&this.y1>=this.y3?this.y1-t:this.y2>=this.y1&&this.y2>=this.y3?this.y2-t:this.y3-t,this.y2-=e,this.y3-=e}}});t.exports=c},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function t(e,n,i,r,o){var l,c="png";if(u(n)){var h=n;n=a(h,"key"),i=a(h,"url"),l=a(h,"normalMap"),r=a(h,"xhrSettings"),c=a(h,"extension",c),o=a(h,"frameConfig")}if(Array.isArray(i)&&(l=i[1],i=i[0]),s.call(this,e,{type:"image",cache:e.textureManager,extension:c,responseType:"blob",key:n,url:i,xhrSettings:r,config:o}),l){var d=new t(e,this.key,l,r,o);d.type="normalMap",this.setLink(d),e.addFile(d)}},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=new Image,this.data.crossOrigin=this.crossOrigin;var t=this;this.data.onload=function(){s.revokeObjectURL(t.data),t.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(t.data),t.onProcessError()},s.createObjectURL(this.data,this.xhrLoader.response,"image/png")},addToCache:function(){var t,e=this.linkFile;e&&e.state===r.FILE_COMPLETE?(t="image"===this.type?this.cache.addImage(this.key,this.data,e.data):this.cache.addImage(e.key,e.data,this.data),this.pendingDestroy(t),e.pendingDestroy(t)):e||(t=this.cache.addImage(this.key,this.data),this.pendingDestroy(t))}});o.register("image",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this}),t.exports=l},function(t,e){t.exports=function(t,e){e?t.setCollision(!0,!0,!0,!0,!1):t.resetCollision(!1)}},function(t,e,n){var i=n(0),r=n(12),s=n(422),o=new i({Mixins:[r.Alpha,r.Flip,r.Visible],initialize:function(t,e,n,i,r,s,o,a){this.layer=t,this.index=e,this.x=n,this.y=i,this.width=r,this.height=s,this.baseWidth=void 0!==o?o:r,this.baseHeight=void 0!==a?a:s,this.pixelX=0,this.pixelY=0,this.updatePixelXY(),this.properties={},this.rotation=0,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceLeft=!1,this.faceRight=!1,this.faceTop=!1,this.faceBottom=!1,this.collisionCallback=null,this.collisionCallbackContext=this,this.tint=16777215,this.physics={}},containsPoint:function(t,e){return!(t<this.pixelX||e<this.pixelY||t>this.right||e>this.bottom)},copy:function(t){return this.index=t.index,this.alpha=t.alpha,this.properties=t.properties,this.visible=t.visible,this.setFlip(t.flipX,t.flipY),this.tint=t.tint,this.rotation=t.rotation,this.collideUp=t.collideUp,this.collideDown=t.collideDown,this.collideLeft=t.collideLeft,this.collideRight=t.collideRight,this.collisionCallback=t.collisionCallback,this.collisionCallbackContext=t.collisionCallbackContext,this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(t){var e=this.tilemapLayer;return e?e.tileToWorldX(this.x,t):this.x*this.baseWidth},getRight:function(t){var e=this.tilemapLayer;return e?this.getLeft(t)+this.width*e.scaleX:this.getLeft(t)+this.width},getTop:function(t){var e=this.tilemapLayer;return e?e.tileToWorldY(this.y,t)-(this.height-this.baseHeight)*e.scaleY:this.y*this.baseHeight-(this.height-this.baseHeight)},getBottom:function(t){var e=this.tilemapLayer;return e?this.getTop(t)+this.height*e.scaleY:this.getTop(t)+this.height},getBounds:function(t,e){return void 0===e&&(e=new s),e.x=this.getLeft(),e.y=this.getTop(),e.width=this.getRight()-e.x,e.height=this.getBottom()-e.y,e},getCenterX:function(t){return(this.getLeft(t)+this.getRight(t))/2},getCenterY:function(t){return(this.getTop(t)+this.getBottom(t))/2},destroy:function(){this.collisionCallback=void 0,this.collisionCallbackContext=void 0,this.properties=void 0},intersects:function(t,e,n,i){return!(n<=this.pixelX||i<=this.pixelY||t>=this.right||e>=this.bottom)},isInteresting:function(t,e){return t&&e?this.canCollide||this.hasInterestingFace:t?this.collides:!!e&&this.hasInterestingFace},resetCollision:function(t){return void 0===t&&(t=!0),this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,t&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},resetFaces:function(){return this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this},setCollision:function(t,e,n,i,r){return void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=t),void 0===r&&(r=!0),this.collideLeft=t,this.collideRight=e,this.collideUp=n,this.collideDown=i,this.faceLeft=t,this.faceRight=e,this.faceTop=n,this.faceBottom=i,r&&this.tilemapLayer&&this.tilemapLayer.calculateFacesAt(this.x,this.y),this},setCollisionCallback:function(t,e){return null===t?(this.collisionCallback=void 0,this.collisionCallbackContext=void 0):(this.collisionCallback=t,this.collisionCallbackContext=e),this},setSize:function(t,e,n,i){return void 0!==t&&(this.width=t),void 0!==e&&(this.height=e),void 0!==n&&(this.baseWidth=n),void 0!==i&&(this.baseHeight=i),this.updatePixelXY(),this},updatePixelXY:function(){return this.pixelX=this.x*this.baseWidth,this.pixelY=this.y*this.baseHeight,this},canCollide:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}},collides:{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}},hasInterestingFace:{get:function(){return this.faceTop||this.faceBottom||this.faceLeft||this.faceRight}},tileset:{get:function(){var t=this.layer.tilemapLayer;if(t){var e=t.gidMap[this.index];if(e)return e}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var t=this.tilemapLayer;return t?t.tilemap:null}}});t.exports=o},function(t,e){t.exports=function(t){return t.x-t.width*t.originX+.5*t.width}},function(t,e){t.exports=function(t,e){return t.x=e+t.width*t.originX-.5*t.width,t}},function(t,e){t.exports=function(t,e){return t.y=e+t.height*t.originY-.5*t.height,t}},function(t,e){t.exports=function(t){return t.y-t.height*t.originY+.5*t.height}},function(t,e,n){var i=n(0),r=n(54),s=n(247),o=n(248),a=n(46),u=n(145),l=new i({initialize:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.type=a.CIRCLE,this.x=t,this.y=e,this._radius=n,this._diameter=2*n},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return u(this,t)},setTo:function(t,e,n){return this.x=t,this.y=e,this._radius=n,this._diameter=2*n,this},setEmpty:function(){return this._radius=0,this._diameter=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},isEmpty:function(){return this._radius<=0},radius:{get:function(){return this._radius},set:function(t){this._radius=t,this._diameter=2*t}},diameter:{get:function(){return this._diameter},set:function(t){this._diameter=t,this._radius=.5*t}},left:{get:function(){return this.x-this._radius},set:function(t){this.x=t+this._radius}},right:{get:function(){return this.x+this._radius},set:function(t){this.x=t-this._radius}},top:{get:function(){return this.y-this._radius},set:function(t){this.y=t+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(t){this.y=t-this._radius}}});t.exports=l},function(t,e){t.exports=function(t,e){if(!(e>=t.length)){for(var n=t.length-1,i=t[e],r=e;r<n;r++)t[r]=t[r+1];return t.length=n,i}}},function(t,e,n){var i=n(0),r=n(173),s=n(11),o=n(3),a=new i({initialize:function(t){this.type=t,this.defaultDivisions=5,this.arcLengthDivisions=100,this.cacheArcLengths=[],this.needsUpdate=!0,this.active=!0,this._tmpVec2A=new o,this._tmpVec2B=new o},draw:function(t,e){return void 0===e&&(e=32),t.strokePoints(this.getPoints(e))},getBounds:function(t,e){t||(t=new s),void 0===e&&(e=16);var n=this.getLength();e>n&&(e=n/2);var i=Math.max(1,Math.round(n/e));return r(this.getSpacedPoints(i),t)},getDistancePoints:function(t){var e=this.getLength(),n=Math.max(1,e/t);return this.getSpacedPoints(n)},getEndPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(1,t)},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],i=this.getPoint(0,this._tmpVec2A),r=0;n.push(0);for(var s=1;s<=t;s++)r+=(e=this.getPoint(s/t,this._tmpVec2B)).distance(i),n.push(r),i.copy(e);return this.cacheArcLengths=n,n},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=this.defaultDivisions);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getRandomPoint:function(t){return void 0===t&&(t=new o),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=this.defaultDivisions);for(var e=[],n=0;n<=t;n++){var i=this.getUtoTmapping(n/t,null,t);e.push(this.getPoint(i))}return e},getStartPoint:function(t){return void 0===t&&(t=new o),this.getPointAt(0,t)},getTangent:function(t,e){void 0===e&&(e=new o);var n=t-1e-4,i=t+1e-4;return n<0&&(n=0),i>1&&(i=1),this.getPoint(n,this._tmpVec2A),this.getPoint(i,e),e.subtract(this._tmpVec2A).normalize()},getTangentAt:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)},getTFromDistance:function(t,e){return t<=0?0:this.getUtoTmapping(0,t,e)},getUtoTmapping:function(t,e,n){var i,r=this.getLengths(n),s=0,o=r.length;i=e?Math.min(e,r[o-1]):t*r[o-1];for(var a,u=0,l=o-1;u<=l;)if((a=r[s=Math.floor(u+(l-u)/2)]-i)<0)u=s+1;else{if(!(a>0)){l=s;break}l=s-1}if(r[s=l]===i)return s/(o-1);var c=r[s];return(s+(i-c)/(r[s+1]-c))/(o-1)},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()}});t.exports=a},function(t,e,n){t.exports={ADD:n(845),COMPLETE:n(846),FILE_COMPLETE:n(847),FILE_KEY_COMPLETE:n(848),FILE_LOAD_ERROR:n(849),FILE_LOAD:n(850),FILE_PROGRESS:n(851),POST_PROCESS:n(852),PROGRESS:n(853),START:n(854)}},function(t,e,n){var i=n(164),r=n(178);t.exports=function(t,e){var n=i.Power0;if("string"==typeof t)if(i.hasOwnProperty(t))n=i[t];else{var s="";t.indexOf(".")&&("in"===(s=t.substr(t.indexOf(".")+1)).toLowerCase()?s="easeIn":"out"===s.toLowerCase()?s="easeOut":"inout"===s.toLowerCase()&&(s="easeInOut")),t=r(t.substr(0,t.indexOf(".")+1)+s),i.hasOwnProperty(t)&&(n=i[t])}else"function"==typeof t?n=t:Array.isArray(t);if(!e)return n;var o=e.slice(0);return o.unshift(0),function(t){return o[0]=t,n.apply(this,o)}}},function(t,e){t.exports=function(t,e,n){var i=t.x3-t.x1,r=t.y3-t.y1,s=t.x2-t.x1,o=t.y2-t.y1,a=e-t.x1,u=n-t.y1,l=i*i+r*r,c=i*s+r*o,h=i*a+r*u,d=s*s+o*o,f=s*a+o*u,p=l*d-c*c,m=0===p?0:1/p,g=(d*h-c*f)*m,y=(l*f-c*h)*m;return g>=0&&y>=0&&g+y<1}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x1,s=t.y1,o=t.x2,a=t.y2,u=e.x1,l=e.y1,c=e.x2,h=e.y2,d=(h-l)*(o-r)-(c-u)*(a-s);if(0===d)return!1;var f=((c-u)*(s-l)-(h-l)*(r-u))/d,p=((o-r)*(s-l)-(a-s)*(r-u))/d;return f>=0&&f<=1&&p>=0&&p<=1&&(n.x=r+f*(o-r),n.y=s+f*(a-s),!0)}},function(t,e){t.exports=function(t){return Math.atan2(t.y2-t.y1,t.x2-t.x1)}},function(t,e,n){var i={};t.exports=i;var r=n(101),s=n(37);i.create=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i],s={x:r.x,y:r.y,index:i,body:e,isInternal:!1,contact:null};s.contact={vertex:s,normalImpulse:0,tangentImpulse:0},n.push(s)}return n},i.fromPath=function(t,e){var n=[];return t.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(t,e,i){n.push({x:parseFloat(e),y:parseFloat(i)})}),i.create(n,e)},i.centre=function(t){for(var e,n,s,o=i.area(t,!0),a={x:0,y:0},u=0;u<t.length;u++)e=r.cross(t[u],t[s=(u+1)%t.length]),n=r.mult(r.add(t[u],t[s]),e),a=r.add(a,n);return r.div(a,6*o)},i.mean=function(t){for(var e={x:0,y:0},n=0;n<t.length;n++)e.x+=t[n].x,e.y+=t[n].y;return r.div(e,t.length)},i.area=function(t,e){for(var n=0,i=t.length-1,r=0;r<t.length;r++)n+=(t[i].x-t[r].x)*(t[i].y+t[r].y),i=r;return e?n/2:Math.abs(n)/2},i.inertia=function(t,e){for(var n,i,s=0,o=0,a=t,u=0;u<a.length;u++)i=(u+1)%a.length,s+=(n=Math.abs(r.cross(a[i],a[u])))*(r.dot(a[i],a[i])+r.dot(a[i],a[u])+r.dot(a[u],a[u])),o+=n;return e/6*(s/o)},i.translate=function(t,e,n){var i;if(n)for(i=0;i<t.length;i++)t[i].x+=e.x*n,t[i].y+=e.y*n;else for(i=0;i<t.length;i++)t[i].x+=e.x,t[i].y+=e.y;return t},i.rotate=function(t,e,n){if(0!==e){for(var i=Math.cos(e),r=Math.sin(e),s=0;s<t.length;s++){var o=t[s],a=o.x-n.x,u=o.y-n.y;o.x=n.x+(a*i-u*r),o.y=n.y+(a*r+u*i)}return t}},i.contains=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=t[(n+1)%t.length];if((e.x-i.x)*(r.y-i.y)+(e.y-i.y)*(i.x-r.x)>0)return!1}return!0},i.scale=function(t,e,n,s){if(1===e&&1===n)return t;var o;s=s||i.centre(t);for(var a=0;a<t.length;a++)o=r.sub(t[a],s),t[a].x=s.x+o.x*e,t[a].y=s.y+o.y*n;return t},i.chamfer=function(t,e,n,i,o){e="number"==typeof e?[e]:e||[8],n=void 0!==n?n:-1,i=i||2,o=o||14;for(var a=[],u=0;u<t.length;u++){var l=t[u-1>=0?u-1:t.length-1],c=t[u],h=t[(u+1)%t.length],d=e[u<e.length?u:e.length-1];if(0!==d){var f=r.normalise({x:c.y-l.y,y:l.x-c.x}),p=r.normalise({x:h.y-c.y,y:c.x-h.x}),m=Math.sqrt(2*Math.pow(d,2)),g=r.mult(s.clone(f),d),y=r.normalise(r.mult(r.add(f,p),.5)),v=r.sub(c,r.mult(y,m)),b=n;-1===n&&(b=1.75*Math.pow(d,.32)),(b=s.clamp(b,i,o))%2==1&&(b+=1);for(var x=Math.acos(r.dot(f,p))/b,w=0;w<b;w++)a.push(r.add(r.rotate(g,x*w),v))}else a.push(c)}return a},i.clockwiseSort=function(t){var e=i.mean(t);return t.sort(function(t,n){return r.angle(e,t)-r.angle(e,n)}),t},i.isConvex=function(t){var e,n,i,r,s=0,o=t.length;if(o<3)return null;for(e=0;e<o;e++)if(r=(t[n=(e+1)%o].x-t[e].x)*(t[i=(e+2)%o].y-t[n].y),(r-=(t[n].y-t[e].y)*(t[i].x-t[n].x))<0?s|=1:r>0&&(s|=2),3===s)return!1;return 0!==s||null},i.hull=function(t){var e,n,i=[],s=[];for((t=t.slice(0)).sort(function(t,e){var n=t.x-e.x;return 0!==n?n:t.y-e.y}),n=0;n<t.length;n+=1){for(e=t[n];s.length>=2&&r.cross3(s[s.length-2],s[s.length-1],e)<=0;)s.pop();s.push(e)}for(n=t.length-1;n>=0;n-=1){for(e=t[n];i.length>=2&&r.cross3(i[i.length-2],i[i.length-1],e)<=0;)i.pop();i.push(e)}return i.pop(),s.pop(),i.concat(s)}},function(t,e,n){var i=n(22);t.exports=function(t,e,n){return(n-e)*i(t,0,1)}},function(t,e){t.exports=function(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}},function(t,e){t.exports={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26}},function(t,e,n){t.exports={DESTROY:n(555),VIDEO_COMPLETE:n(556),VIDEO_CREATED:n(557),VIDEO_ERROR:n(558),VIDEO_LOOP:n(559),VIDEO_PLAY:n(560),VIDEO_SEEKED:n(561),VIDEO_SEEKING:n(562),VIDEO_STOP:n(563),VIDEO_TIMEOUT:n(564),VIDEO_UNLOCKED:n(565)}},function(t,e,n){var i=n(0),r=n(12),s=n(35),o=n(9),a=n(48),u=n(11),l=n(32),c=n(159),h=n(3),d=new i({Extends:o,Mixins:[r.Alpha,r.Visible],initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),o.call(this),this.id=0,this.name="",this.resolution=1,this.roundPixels=!1,this.useBounds=!1,this.worldView=new u,this.dirty=!0,this._x=t,this._y=e,this._cx=0,this._cy=0,this._cw=0,this._ch=0,this._width=n,this._height=i,this._bounds=new u,this._scrollX=0,this._scrollY=0,this._zoom=1,this._rotation=0,this.matrix=new l,this.transparent=!0,this.backgroundColor=c("rgba(0,0,0,0)"),this.disableCull=!1,this.culledObjects=[],this.midPoint=new h(n/2,i/2),this.originX=.5,this.originY=.5,this._customViewport=!1,this.mask=null,this._maskCamera=null},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this},getScroll:function(t,e,n){void 0===n&&(n=new h);var i=.5*this.height;return n.x=t-.5*this.width,n.y=e-i,this.useBounds&&(n.x=this.clampX(n.x),n.y=this.clampY(n.y)),n},centerOnX:function(t){var e=.5*this.width;return this.midPoint.x=t,this.scrollX=t-e,this.useBounds&&(this.scrollX=this.clampX(this.scrollX)),this},centerOnY:function(t){var e=.5*this.height;return this.midPoint.y=t,this.scrollY=t-e,this.useBounds&&(this.scrollY=this.clampY(this.scrollY)),this},centerOn:function(t,e){return this.centerOnX(t),this.centerOnY(e),this},centerToBounds:function(){if(this.useBounds){var t=this._bounds,e=.5*this.width,n=.5*this.height;this.midPoint.set(t.centerX,t.centerY),this.scrollX=t.centerX-e,this.scrollY=t.centerY-n}return this},centerToSize:function(){return this.scrollX=.5*this.width,this.scrollY=.5*this.height,this},cull:function(t){if(this.disableCull)return t;var e=this.matrix.matrix,n=e[0],i=e[1],r=e[2],s=e[3],o=n*s-i*r;if(!o)return t;var a=e[4],u=e[5],l=this.scrollX,c=this.scrollY,h=this.width,d=this.height,f=this.culledObjects,p=t.length;o=1/o,f.length=0;for(var m=0;m<p;++m){var g=t[m];if(g.hasOwnProperty("width")&&!g.parentContainer){var y=g.width,v=g.height,b=g.x-l*g.scrollFactorX-y*g.originX,x=g.y-c*g.scrollFactorY-v*g.originY,w=this.y,T=this.x;(b+y)*n+(x+v)*r+a>T&&b*n+x*r+a<T+h&&(b+y)*i+(x+v)*s+u>w&&b*i+x*s+u<w+d&&f.push(g)}else f.push(g)}return f},getWorldPoint:function(t,e,n){void 0===n&&(n=new h);var i=this.matrix.matrix,r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],l=i[5],c=r*a-s*o;if(!c)return n.x=t,n.y=e,n;var d=a*(c=1/c),f=-s*c,p=-o*c,m=r*c,g=(o*l-a*u)*c,y=(s*u-r*l)*c,v=Math.cos(this.rotation),b=Math.sin(this.rotation),x=this.zoom,w=this.resolution,T=this.scrollX,S=this.scrollY,E=t+(T*v-S*b)*x,O=e+(T*b+S*v)*x;return n.x=(E*d+O*p)*w+g,n.y=(E*f+O*m)*w+y,n},ignore:function(t){var e=this.id;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?this.ignore(i):i.isParent?this.ignore(i.getChildren()):i.cameraFilter|=e}return this},preRender:function(t){var e=this.width,n=this.height,i=.5*e,r=.5*n,s=this.zoom*t,o=this.matrix,a=e*this.originX,u=n*this.originY,l=this.scrollX,c=this.scrollY;this.useBounds&&(l=this.clampX(l),c=this.clampY(c)),this.roundPixels&&(a=Math.round(a),u=Math.round(u)),this.scrollX=l,this.scrollY=c;var h=l+i,d=c+r;this.midPoint.set(h,d);var f=e/s,p=n/s;this.worldView.setTo(h-f/2,d-p/2,f,p),o.applyITRS(this.x+a,this.y+u,this.rotation,s,s),o.translate(-a,-u)},clampX:function(t){var e=this._bounds,n=this.displayWidth,i=e.x+(n-this.width)/2,r=Math.max(i,i+e.width-n);return t<i?t=i:t>r&&(t=r),t},clampY:function(t){var e=this._bounds,n=this.displayHeight,i=e.y+(n-this.height)/2,r=Math.max(i,i+e.height-n);return t<i?t=i:t>r&&(t=r),t},removeBounds:function(){return this.useBounds=!1,this.dirty=!0,this._bounds.setEmpty(),this},setAngle:function(t){return void 0===t&&(t=0),this.rotation=s(t),this},setBackgroundColor:function(t){return void 0===t&&(t="rgba(0,0,0,0)"),this.backgroundColor=c(t),this.transparent=0===this.backgroundColor.alpha,this},setBounds:function(t,e,n,i,r){return void 0===r&&(r=!1),this._bounds.setTo(t,e,n,i),this.dirty=!0,this.useBounds=!0,r?this.centerToBounds():(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},getBounds:function(t){void 0===t&&(t=new u);var e=this._bounds;return t.setTo(e.x,e.y,e.width,e.height),t},setName:function(t){return void 0===t&&(t=""),this.name=t,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setRoundPixels:function(t){return this.roundPixels=t,this},setScene:function(t){this.scene&&this._customViewport&&this.sceneManager.customViewports--,this.scene=t;var e=t.sys;this.sceneManager=e.game.scene,this.scaleManager=e.scale,this.cameraManager=e.cameras;var n=this.scaleManager.resolution;return this.resolution=n,this._cx=this._x*n,this._cy=this._y*n,this._cw=this._width*n,this._ch=this._height*n,this.updateSystem(),this},setScroll:function(t,e){return void 0===e&&(e=t),this.scrollX=t,this.scrollY=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},setViewport:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setZoom:function(t){return void 0===t&&(t=1),0===t&&(t=.001),this.zoom=t,this},setMask:function(t,e){return void 0===e&&(e=!0),this.mask=t,this._maskCamera=e?this.cameraManager.default:this,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},toJSON:function(){var t={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};return this.useBounds&&(t.bounds={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}),t},update:function(){},updateSystem:function(){if(this.scaleManager){var t=0!==this._x||0!==this._y||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height,e=this.sceneManager;t&&!this._customViewport?e.customViewports++:!t&&this._customViewport&&e.customViewports--,this.dirty=!0,this._customViewport=t}},destroy:function(){this.emit(a.DESTROY,this),this.removeAllListeners(),this.matrix.destroy(),this.culledObjects=[],this._customViewport&&this.sceneManager.customViewports--,this._bounds=null,this.scene=null,this.scaleManager=null,this.sceneManager=null,this.cameraManager=null},x:{get:function(){return this._x},set:function(t){this._x=t,this._cx=t*this.resolution,this.updateSystem()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._cy=t*this.resolution,this.updateSystem()}},width:{get:function(){return this._width},set:function(t){this._width=t,this._cw=t*this.resolution,this.updateSystem()}},height:{get:function(){return this._height},set:function(t){this._height=t,this._ch=t*this.resolution,this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(t){this._scrollX=t,this.dirty=!0}},scrollY:{get:function(){return this._scrollY},set:function(t){this._scrollY=t,this.dirty=!0}},zoom:{get:function(){return this._zoom},set:function(t){this._zoom=t,this.dirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t,this.dirty=!0}},centerX:{get:function(){return this.x+.5*this.width}},centerY:{get:function(){return this.y+.5*this.height}},displayWidth:{get:function(){return this.width/this.zoom}},displayHeight:{get:function(){return this.height/this.zoom}}});t.exports=d},function(t,e,n){t.exports={ENTER_FULLSCREEN:n(670),FULLSCREEN_FAILED:n(671),FULLSCREEN_UNSUPPORTED:n(672),LEAVE_FULLSCREEN:n(673),ORIENTATION_CHANGE:n(674),RESIZE:n(675)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.floor(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=n(0),r=n(22),s=n(16),o=new i({initialize:function(t,e,n,i,r,s,o){this.texture=t,this.name=e,this.source=t.source[n],this.sourceIndex=n,this.glTexture=this.source.glTexture,this.x=0,this.y=0,this.pivotX=0,this.pivotY=0,this.customPivot=!1,this.rotated=!1,this.autoRound=-1,this.customData={},this.u0=0,this.v0=0,this.u1=0,this.v1=0,this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:!1,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0}},this.setSize(s,o,i,r)},setSize:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this.cutX=n,this.cutY=i,this.cutWidth=t,this.cutHeight=e,this.width=t,this.height=e,this.halfWidth=Math.floor(.5*t),this.halfHeight=Math.floor(.5*e),this.centerX=Math.floor(t/2),this.centerY=Math.floor(e/2);var r=this.data,s=r.cut;s.x=n,s.y=i,s.w=t,s.h=e,s.r=n+t,s.b=i+e,r.sourceSize.w=t,r.sourceSize.h=e,r.spriteSourceSize.w=t,r.spriteSourceSize.h=e,r.radius=.5*Math.sqrt(t*t+e*e);var o=r.drawImage;return o.x=n,o.y=i,o.width=t,o.height=e,this.updateUVs()},setTrim:function(t,e,n,i,r,s){var o=this.data,a=o.spriteSourceSize;return o.trim=!0,o.sourceSize.w=t,o.sourceSize.h=e,a.x=n,a.y=i,a.w=r,a.h=s,a.r=n+r,a.b=i+s,this.x=n,this.y=i,this.width=r,this.height=s,this.halfWidth=.5*r,this.halfHeight=.5*s,this.centerX=Math.floor(r/2),this.centerY=Math.floor(s/2),this.updateUVs()},setCropUVs:function(t,e,n,i,s,o,a){var u=this.cutX,l=this.cutY,c=this.cutWidth,h=this.cutHeight,d=this.realWidth,f=this.realHeight,p=u+(e=r(e,0,d)),m=l+(n=r(n,0,f)),g=i=r(i,0,d-e),y=s=r(s,0,f-n),v=this.data;if(v.trim){var b=v.spriteSourceSize,x=e+(i=r(i,0,c-e)),w=n+(s=r(s,0,h-n));if(b.r<e||b.b<n||b.x>x||b.y>w)p=0,m=0,g=0,y=0;else{var T=Math.max(b.x,e),S=Math.max(b.y,n),E=Math.min(b.r,x)-T,O=Math.min(b.b,w)-S;g=E,y=O,p=o?u+(c-(T-b.x)-E):u+(T-b.x),m=a?l+(h-(S-b.y)-O):l+(S-b.y),e=T,n=S,i=E,s=O}}else o&&(p=u+(c-e-i)),a&&(m=l+(h-n-s));var C=this.source.width,_=this.source.height;return t.u0=Math.max(0,p/C),t.v0=Math.max(0,m/_),t.u1=Math.min(1,(p+g)/C),t.v1=Math.min(1,(m+y)/_),t.x=e,t.y=n,t.cx=p,t.cy=m,t.cw=g,t.ch=y,t.width=i,t.height=s,t.flipX=o,t.flipY=a,t},updateCropUVs:function(t,e,n){return this.setCropUVs(t,t.x,t.y,t.width,t.height,e,n)},updateUVs:function(){var t=this.cutX,e=this.cutY,n=this.cutWidth,i=this.cutHeight,r=this.data.drawImage;r.width=n,r.height=i;var s=this.source.width,o=this.source.height;return this.u0=t/s,this.v0=e/o,this.u1=(t+n)/s,this.v1=(e+i)/o,this},updateUVsInverted:function(){var t=this.source.width,e=this.source.height;return this.u0=(this.cutX+this.cutHeight)/t,this.v0=this.cutY/e,this.u1=this.cutX/t,this.v1=(this.cutY+this.cutWidth)/e,this},clone:function(){var t=new o(this.texture,this.name,this.sourceIndex);return t.cutX=this.cutX,t.cutY=this.cutY,t.cutWidth=this.cutWidth,t.cutHeight=this.cutHeight,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t.halfWidth=this.halfWidth,t.halfHeight=this.halfHeight,t.centerX=this.centerX,t.centerY=this.centerY,t.rotated=this.rotated,t.data=s(!0,t.data,this.data),t.updateUVs(),t},destroy:function(){this.source=null,this.texture=null,this.glTexture=null,this.customData=null,this.data=null},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},canvasData:{get:function(){return this.data.drawImage}}});t.exports=o},function(t,e,n){var i=n(0),r=n(96),s=n(374),o=n(375),a=n(46),u=n(152),l=new i({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.type=a.ELLIPSE,this.x=t,this.y=e,this.width=n,this.height=i},contains:function(t,e){return r(this,t,e)},getPoint:function(t,e){return s(this,t,e)},getPoints:function(t,e,n){return o(this,t,e,n)},getRandomPoint:function(t){return u(this,t)},setTo:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},setEmpty:function(){return this.width=0,this.height=0,this},setPosition:function(t,e){return void 0===e&&(e=t),this.x=t,this.y=e,this},setSize:function(t,e){return void 0===e&&(e=t),this.width=t,this.height=e,this},isEmpty:function(){return this.width<=0||this.height<=0},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-this.width/2},set:function(t){this.x=t+this.width/2}},right:{get:function(){return this.x+this.width/2},set:function(t){this.x=t-this.width/2}},top:{get:function(){return this.y-this.height/2},set:function(t){this.y=t+this.height/2}},bottom:{get:function(){return this.y+this.height/2},set:function(t){this.y=t-this.height/2}}});t.exports=l},function(t,e){t.exports=function(t,e,n){if(t.width<=0||t.height<=0)return!1;var i=(e-t.x)/t.width,r=(n-t.y)/t.height;return(i*=i)+(r*=r)<.25}},function(t,e,n){var i=n(235),r=n(0),s=n(90),o=n(2),a=n(6),u=n(7),l=n(368),c=n(107),h=n(68),d=new r({initialize:function(t,e,n){n?e&&!Array.isArray(e)&&(e=[e]):Array.isArray(e)?u(e[0])&&(n=e,e=null):u(e)&&(n=e,e=null),this.scene=t,this.children=new c(e),this.isParent=!0,this.classType=o(n,"classType",h),this.name=o(n,"name",""),this.active=o(n,"active",!0),this.maxSize=o(n,"maxSize",-1),this.defaultKey=o(n,"defaultKey",null),this.defaultFrame=o(n,"defaultFrame",null),this.runChildUpdate=o(n,"runChildUpdate",!1),this.createCallback=o(n,"createCallback",null),this.removeCallback=o(n,"removeCallback",null),this.createMultipleCallback=o(n,"createMultipleCallback",null),n&&this.createMultiple(n)},create:function(t,e,n,i,r,s){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.defaultKey),void 0===i&&(i=this.defaultFrame),void 0===r&&(r=!0),void 0===s&&(s=!0),this.isFull())return null;var o=new this.classType(this.scene,t,e,n,i);return this.scene.sys.displayList.add(o),o.preUpdate&&this.scene.sys.updateList.add(o),o.visible=r,o.setActive(s),this.add(o),o},createMultiple:function(t){if(this.isFull())return[];Array.isArray(t)||(t=[t]);var e=[];if(t[0].key)for(var n=0;n<t.length;n++){var i=this.createFromConfig(t[n]);e=e.concat(i)}return e},createFromConfig:function(t){if(this.isFull())return[];this.classType=o(t,"classType",this.classType);var e=o(t,"key",void 0),n=o(t,"frame",null),r=o(t,"visible",!0),s=o(t,"active",!0),u=[];if(void 0===e)return u;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var c=o(t,"repeat",0),h=o(t,"randomKey",!1),d=o(t,"randomFrame",!1),f=o(t,"yoyo",!1),p=o(t,"quantity",!1),m=o(t,"frameQuantity",1),g=o(t,"max",0),y=l(e,n,{max:g,qty:p||m,random:h,randomB:d,repeat:c,yoyo:f});t.createCallback&&(this.createCallback=t.createCallback),t.removeCallback&&(this.removeCallback=t.removeCallback);for(var v=0;v<y.length;v++){var b=this.create(0,0,y[v].a,y[v].b,r,s);if(!b)break;u.push(b)}var x=a(t,"setXY.x",0),w=a(t,"setXY.y",0),T=a(t,"setXY.stepX",0),S=a(t,"setXY.stepY",0);i.SetXY(u,x,w,T,S);var E=a(t,"setRotation.value",0),O=a(t,"setRotation.step",0);i.SetRotation(u,E,O);var C=a(t,"setScale.x",1),_=a(t,"setScale.y",C),A=a(t,"setScale.stepX",0),k=a(t,"setScale.stepY",0);i.SetScale(u,C,_,A,k);var R=a(t,"setAlpha.value",1),I=a(t,"setAlpha.step",0);i.SetAlpha(u,R,I);var M=o(t,"hitArea",null),N=o(t,"hitAreaCallback",null);M&&i.SetHitArea(u,M,N);var D=o(t,"gridAlign",!1);return D&&i.GridAlign(u,D),this.createMultipleCallback&&this.createMultipleCallback.call(this,u),u},preUpdate:function(t,e){if(this.runChildUpdate&&0!==this.children.size)for(var n=this.children.entries.slice(),i=0;i<n.length;i++){var r=n[i];r.active&&r.update(t,e)}},add:function(t,e){return void 0===e&&(e=!1),this.isFull()||(this.children.set(t),this.createCallback&&this.createCallback.call(this,t),e&&(this.scene.sys.displayList.add(t),t.preUpdate&&this.scene.sys.updateList.add(t)),t.on(s.DESTROY,this.remove,this)),this},addMultiple:function(t,e){if(void 0===e&&(e=!1),Array.isArray(t))for(var n=0;n<t.length;n++)this.add(t[n],e);return this},remove:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.children.contains(t)?(this.children.delete(t),this.removeCallback&&this.removeCallback.call(this,t),t.off(s.DESTROY,this.remove,this),n?t.destroy():e&&(t.scene.sys.displayList.remove(t),t.preUpdate&&t.scene.sys.updateList.remove(t)),this):this},clear:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var n=this.children,i=0;i<n.size;i++){var r=n.entries[i];r.off(s.DESTROY,this.remove,this),e?r.destroy():t&&(r.scene.sys.displayList.remove(r),r.preUpdate&&r.scene.sys.updateList.remove(r))}return this.children.clear(),this},contains:function(t){return this.children.contains(t)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getFirst:function(t,e,n,i,r,s,o){return this.getHandler(!0,1,t,e,n,i,r,s,o)},getFirstNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!0,t,e,n,i,r,s,o,a)},getLast:function(t,e,n,i,r,s,o){return this.getHandler(!1,1,t,e,n,i,r,s,o)},getLastNth:function(t,e,n,i,r,s,o,a){return this.getHandler(!1,t,e,n,i,r,s,o,a)},getHandler:function(t,e,n,i,r,s,o,a,u){var l,c;void 0===n&&(n=!1),void 0===i&&(i=!1);var h=0,d=this.children.entries;if(t)for(c=0;c<d.length;c++)if((l=d[c]).active===n){if(++h===e)break}else l=null;else for(c=d.length-1;c>=0;c--)if((l=d[c]).active===n){if(++h===e)break}else l=null;return l?("number"==typeof r&&(l.x=r),"number"==typeof s&&(l.y=s),l):i?this.create(r,s,o,a,u):null},get:function(t,e,n,i,r){return this.getFirst(!1,!0,t,e,n,i,r)},getFirstAlive:function(t,e,n,i,r,s){return this.getFirst(!0,t,e,n,i,r,s)},getFirstDead:function(t,e,n,i,r,s){return this.getFirst(!1,t,e,n,i,r,s)},playAnimation:function(t,e){return i.PlayAnimation(this.children.entries,t,e),this},isFull:function(){return-1!==this.maxSize&&this.children.size>=this.maxSize},countActive:function(t){void 0===t&&(t=!0);for(var e=0,n=0;n<this.children.size;n++)this.children.entries[n].active===t&&e++;return e},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var t=this.getTotalUsed();return(-1===this.maxSize?999999999999:this.maxSize)-t},setDepth:function(t,e){return i.SetDepth(this.children.entries,t,e),this},kill:function(t){this.children.contains(t)&&t.setActive(!1)},killAndHide:function(t){this.children.contains(t)&&(t.setActive(!1),t.setVisible(!1))},toggleVisible:function(){return i.ToggleVisible(this.children.entries),this},destroy:function(t){void 0===t&&(t=!1),this.scene&&!this.ignoreDestroy&&(this.clear(!1,t),this.scene=void 0,this.children=void 0)}});t.exports=d},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(947),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.GetBounds,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Size,r.TextureCrop,r.Tint,r.Transform,r.Visible,o],initialize:function(t,e,n,i,r){s.call(this,t,"Image"),this._crop=this.resetCropObject(),this.setTexture(i,r),this.setPosition(e,n),this.setSizeToFrame(),this.setOriginFromFrame(),this.initPipeline()}});t.exports=a},function(t,e){t.exports=function(t,e){return t.hasOwnProperty(e)}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s,o){for(var a=i.getTintAppendFloatAlphaAndSwap(n.fillColor,n.fillAlpha*r),u=n.pathData,l=n.pathIndexes,c=0;c<l.length;c+=3){var h=2*l[c],d=2*l[c+1],f=2*l[c+2],p=u[h+0]-s,m=u[h+1]-o,g=u[d+0]-s,y=u[d+1]-o,v=u[f+0]-s,b=u[f+1]-o,x=e.getX(p,m),w=e.getY(p,m),T=e.getX(g,y),S=e.getY(g,y),E=e.getX(v,b),O=e.getY(v,b);t.setTexture2D(),t.batchTri(x,w,T,S,E,O,0,0,1,1,a,a,a,t.tintEffect)}}},function(t,e){var n={};t.exports=n,n.create=function(t,e){return{x:t||0,y:e||0}},n.clone=function(t){return{x:t.x,y:t.y}},n.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},n.rotate=function(t,e,n){var i=Math.cos(e),r=Math.sin(e);n||(n={});var s=t.x*i-t.y*r;return n.y=t.x*r+t.y*i,n.x=s,n},n.rotateAbout=function(t,e,n,i){var r=Math.cos(e),s=Math.sin(e);i||(i={});var o=n.x+((t.x-n.x)*r-(t.y-n.y)*s);return i.y=n.y+((t.x-n.x)*s+(t.y-n.y)*r),i.x=o,i},n.normalise=function(t){var e=n.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},n.dot=function(t,e){return t.x*e.x+t.y*e.y},n.cross=function(t,e){return t.x*e.y-t.y*e.x},n.cross3=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},n.add=function(t,e,n){return n||(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n},n.sub=function(t,e,n){return n||(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},n.mult=function(t,e){return{x:t.x*e,y:t.y*e}},n.div=function(t,e){return{x:t.x/e,y:t.y/e}},n.perp=function(t,e){return{x:(e=!0===e?-1:1)*-t.y,y:e*t.x}},n.neg=function(t){return{x:-t.x,y:-t.y}},n.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(t,e){var n={};t.exports=n,n.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&n.update(e,t),e},n.update=function(t,e,n){t.min.x=1/0,t.max.x=-1/0,t.min.y=1/0,t.max.y=-1/0;for(var i=0;i<e.length;i++){var r=e[i];r.x>t.max.x&&(t.max.x=r.x),r.x<t.min.x&&(t.min.x=r.x),r.y>t.max.y&&(t.max.y=r.y),r.y<t.min.y&&(t.min.y=r.y)}n&&(n.x>0?t.max.x+=n.x:t.min.x+=n.x,n.y>0?t.max.y+=n.y:t.min.y+=n.y)},n.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},n.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},n.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},n.shift=function(t,e){var n=t.max.x-t.min.x,i=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+n,t.min.y=e.y,t.max.y=e.y+i}},function(t,e){t.exports=function(t,e,n){return t>=0&&t<n.width&&e>=0&&e<n.height}},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){void 0===t&&(t={}),this.name=r(t,"name","layer"),this.x=r(t,"x",0),this.y=r(t,"y",0),this.width=r(t,"width",0),this.height=r(t,"height",0),this.tileWidth=r(t,"tileWidth",0),this.tileHeight=r(t,"tileHeight",0),this.baseTileWidth=r(t,"baseTileWidth",this.tileWidth),this.baseTileHeight=r(t,"baseTileHeight",this.tileHeight),this.widthInPixels=r(t,"widthInPixels",this.width*this.baseTileWidth),this.heightInPixels=r(t,"heightInPixels",this.height*this.baseTileHeight),this.alpha=r(t,"alpha",1),this.visible=r(t,"visible",!0),this.properties=r(t,"properties",{}),this.indexes=r(t,"indexes",[]),this.collideIndexes=r(t,"collideIndexes",[]),this.callbacks=r(t,"callbacks",[]),this.bodies=r(t,"bodies",[]),this.data=r(t,"data",[]),this.tilemapLayer=r(t,"tilemapLayer",null)}});t.exports=s},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){void 0===t&&(t={}),this.name=r(t,"name","map"),this.width=r(t,"width",0),this.height=r(t,"height",0),this.infinite=r(t,"infinite",!1),this.tileWidth=r(t,"tileWidth",0),this.tileHeight=r(t,"tileHeight",0),this.widthInPixels=r(t,"widthInPixels",this.width*this.tileWidth),this.heightInPixels=r(t,"heightInPixels",this.height*this.tileHeight),this.format=r(t,"format",null),this.orientation=r(t,"orientation","orthogonal"),this.renderOrder=r(t,"renderOrder","right-down"),this.version=r(t,"version","1"),this.properties=r(t,"properties",{}),this.layers=r(t,"layers",[]),this.images=r(t,"images",[]),this.objects=r(t,"objects",{}),this.collision=r(t,"collision",{}),this.tilesets=r(t,"tilesets",[]),this.imageCollections=r(t,"imageCollections",[]),this.tiles=r(t,"tiles",[])}});t.exports=s},function(t,e,n){var i=n(66);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)||(n[r]=e[r]);return n}},function(t,e,n){var i=new(n(0))({initialize:function(t){if(this.entries=[],Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e])},set:function(t){return-1===this.entries.indexOf(t)&&this.entries.push(t),this},get:function(t,e){for(var n=0;n<this.entries.length;n++){var i=this.entries[n];if(i[t]===e)return i}},getArray:function(){return this.entries.slice(0)},delete:function(t){var e=this.entries.indexOf(t);return e>-1&&this.entries.splice(e,1),this},dump:function(){console.group("Set");for(var t=0;t<this.entries.length;t++)console.log(this.entries[t]);console.groupEnd()},each:function(t,e){var n,i=this.entries.slice(),r=i.length;if(e)for(n=0;n<r&&!1!==t.call(e,i[n],n);n++);else for(n=0;n<r&&!1!==t(i[n],n);n++);return this},iterate:function(t,e){var n,i=this.entries.length;if(e)for(n=0;n<i&&!1!==t.call(e,this.entries[n],n);n++);else for(n=0;n<i&&!1!==t(this.entries[n],n);n++);return this},iterateLocal:function(t){var e,n=[];for(e=1;e<arguments.length;e++)n.push(arguments[e]);var i=this.entries.length;for(e=0;e<i;e++){var r=this.entries[e];r[t].apply(r,n)}return this},clear:function(){return this.entries.length=0,this},contains:function(t){return this.entries.indexOf(t)>-1},union:function(t){var e=new i;return t.entries.forEach(function(t){e.set(t)}),this.entries.forEach(function(t){e.set(t)}),e},intersect:function(t){var e=new i;return this.entries.forEach(function(n){t.contains(n)&&e.set(n)}),e},difference:function(t){var e=new i;return this.entries.forEach(function(n){t.contains(n)||e.set(n)}),e},size:{get:function(){return this.entries.length},set:function(t){return t<this.entries.length?this.entries.length=t:this.entries.length}}});t.exports=i},function(t,e,n){var i=n(52),r=n(78),s=n(54),o=n(0),a=n(12),u=n(13),l=n(11),c=n(47),h=new o({Extends:u,Mixins:[a.Depth,a.GetBounds,a.Origin,a.Transform,a.ScrollFactor,a.Visible],initialize:function(t,e,n,r,s){void 0===r&&(r=1),void 0===s&&(s=r),u.call(this,t,"Zone"),this.setPosition(e,n),this.width=r,this.height=s,this.blendMode=i.NORMAL,this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e,n){void 0===n&&(n=!0),this.width=t,this.height=e,this.updateDisplayOrigin();var i=this.input;return n&&i&&!i.customHitArea&&(i.hitArea.width=t,i.hitArea.height=e),this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this},setCircleDropZone:function(t){return this.setDropZone(new r(0,0,t),s)},setRectangleDropZone:function(t,e){return this.setDropZone(new l(0,0,t,e),c)},setDropZone:function(t,e){return void 0===t?this.setRectangleDropZone(this.width,this.height):this.input||this.setInteractive(t,e,!0),this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(){},renderWebGL:function(){}});t.exports=h},function(t,e,n){t.exports={ADD_ANIMATION:n(507),ANIMATION_COMPLETE:n(508),ANIMATION_REPEAT:n(509),ANIMATION_RESTART:n(510),ANIMATION_START:n(511),PAUSE_ALL:n(512),REMOVE_ANIMATION:n(513),RESUME_ALL:n(514),SPRITE_ANIMATION_COMPLETE:n(515),SPRITE_ANIMATION_KEY_COMPLETE:n(516),SPRITE_ANIMATION_KEY_REPEAT:n(517),SPRITE_ANIMATION_KEY_RESTART:n(518),SPRITE_ANIMATION_KEY_START:n(519),SPRITE_ANIMATION_KEY_UPDATE:n(520),SPRITE_ANIMATION_REPEAT:n(521),SPRITE_ANIMATION_RESTART:n(522),SPRITE_ANIMATION_START:n(523),SPRITE_ANIMATION_UPDATE:n(524)}},function(t,e){t.exports=function(t){return 2*(t.width+t.height)}},function(t,e,n){var i=n(0),r=n(265),s=new i({initialize:function(t,e){this.parent=t,this.events=e,e||(this.events=t.events?t.events:t),this.list={},this.values={},this._frozen=!1,!t.hasOwnProperty("sys")&&this.events&&this.events.once("destroy",this.destroy,this)},get:function(t){var e=this.list;if(Array.isArray(t)){for(var n=[],i=0;i<t.length;i++)n.push(e[t[i]]);return n}return e[t]},getAll:function(){var t={};for(var e in this.list)this.list.hasOwnProperty(e)&&(t[e]=this.list[e]);return t},query:function(t){var e={};for(var n in this.list)this.list.hasOwnProperty(n)&&n.match(t)&&(e[n]=this.list[n]);return e},set:function(t,e){if(this._frozen)return this;if("string"==typeof t)return this.setValue(t,e);for(var n in t)this.setValue(n,t[n]);return this},setValue:function(t,e){if(this._frozen)return this;if(this.has(t))this.values[t]=e;else{var n=this,i=this.list,s=this.events,o=this.parent;Object.defineProperty(this.values,t,{enumerable:!0,configurable:!0,get:function(){return i[t]},set:function(e){if(!n._frozen){var a=i[t];i[t]=e,s.emit(r.CHANGE_DATA,o,t,e,a),s.emit(r.CHANGE_DATA_KEY+t,o,e,a)}}}),i[t]=e,s.emit(r.SET_DATA,o,t,e)}return this},each:function(t,e){for(var n=[this.parent,null,void 0],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[1]=r,n[2]=this.list[r],t.apply(e,n);return this},merge:function(t,e){for(var n in void 0===e&&(e=!0),t)t.hasOwnProperty(n)&&(e||!e&&!this.has(n))&&this.setValue(n,t[n]);return this},remove:function(t){if(this._frozen)return this;if(!Array.isArray(t))return this.removeValue(t);for(var e=0;e<t.length;e++)this.removeValue(t[e]);return this},removeValue:function(t){if(this.has(t)){var e=this.list[t];delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)}return this},pop:function(t){var e=void 0;return!this._frozen&&this.has(t)&&(e=this.list[t],delete this.list[t],delete this.values[t],this.events.emit(r.REMOVE_DATA,this.parent,t,e)),e},has:function(t){return this.list.hasOwnProperty(t)},setFreeze:function(t){return this._frozen=t,this},reset:function(){for(var t in this.list)delete this.list[t],delete this.values[t];return this._frozen=!1,this},destroy:function(){this.reset(),this.events.off(r.CHANGE_DATA),this.events.off(r.SET_DATA),this.events.off(r.REMOVE_DATA),this.parent=null},freeze:{get:function(){return this._frozen},set:function(t){this._frozen=!!t}},count:{get:function(){var t=0;for(var e in this.list)void 0!==this.list[e]&&t++;return t}}});t.exports=s},function(t,e){t.exports=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[n],t[n]=i}return t}},function(t,e){t.exports=function(t,e,n){return(e-t)*n+t}},function(t,e,n){(function(e){var n={android:!1,chromeOS:!1,cordova:!1,crosswalk:!1,desktop:!1,ejecta:!1,electron:!1,iOS:!1,iOSVersion:0,iPad:!1,iPhone:!1,kindle:!1,linux:!1,macOS:!1,node:!1,nodeWebkit:!1,pixelRatio:1,webApp:!1,windows:!1,windowsPhone:!1};t.exports=function(){var t=navigator.userAgent;/Windows/.test(t)?n.windows=!0:/Mac OS/.test(t)&&!/like Mac OS/.test(t)?n.macOS=!0:/Android/.test(t)?n.android=!0:/Linux/.test(t)?n.linux=!0:/iP[ao]d|iPhone/i.test(t)?(n.iOS=!0,navigator.appVersion.match(/OS (\d+)/),n.iOSVersion=parseInt(RegExp.$1,10),n.iPhone=-1!==t.toLowerCase().indexOf("iphone"),n.iPad=-1!==t.toLowerCase().indexOf("ipad")):/Kindle/.test(t)||/\bKF[A-Z][A-Z]+/.test(t)||/Silk.*Mobile Safari/.test(t)?n.kindle=!0:/CrOS/.test(t)&&(n.chromeOS=!0),(/Windows Phone/i.test(t)||/IEMobile/i.test(t))&&(n.android=!1,n.iOS=!1,n.macOS=!1,n.windows=!0,n.windowsPhone=!0);var i=/Silk/.test(t);return(n.windows||n.macOS||n.linux&&!i||n.chromeOS)&&(n.desktop=!0),(n.windowsPhone||/Windows NT/i.test(t)&&/Touch/i.test(t))&&(n.desktop=!1),navigator.standalone&&(n.webApp=!0),void 0!==window.cordova&&(n.cordova=!0),void 0!==e&&e.versions&&e.versions.node&&(n.node=!0),n.node&&"object"==typeof e.versions&&(n.nodeWebkit=!!e.versions["node-webkit"],n.electron=!!e.versions.electron),void 0!==window.ejecta&&(n.ejecta=!0),/Crosswalk/.test(t)&&(n.crosswalk=!0),n.pixelRatio=window.devicePixelRatio||1,n}()}).call(this,n(696))},function(t,e,n){var i,r=n(114),s={chrome:!1,chromeVersion:0,edge:!1,firefox:!1,firefoxVersion:0,ie:!1,ieVersion:0,mobileSafari:!1,opera:!1,safari:!1,safariVersion:0,silk:!1,trident:!1,tridentVersion:0};t.exports=(i=navigator.userAgent,/Edge\/\d+/.test(i)?s.edge=!0:/Chrome\/(\d+)/.test(i)&&!r.windowsPhone?(s.chrome=!0,s.chromeVersion=parseInt(RegExp.$1,10)):/Firefox\D+(\d+)/.test(i)?(s.firefox=!0,s.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(i)&&r.iOS?s.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(i)?(s.ie=!0,s.ieVersion=parseInt(RegExp.$1,10)):/Opera/.test(i)?s.opera=!0:/Safari/.test(i)&&!r.windowsPhone?s.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(i)&&(s.ie=!0,s.trident=!0,s.tridentVersion=parseInt(RegExp.$1,10),s.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(i)&&(s.silk=!0),s)},function(t,e){t.exports=function(t,e){return t>0&&0==(t&t-1)&&e>0&&0==(e&e-1)}},function(t,e,n){t.exports={ADD:n(743),ERROR:n(744),LOAD:n(745),READY:n(746),REMOVE:n(747)}},function(t,e){t.exports=function(t,e){var n;if(e)"string"==typeof e?n=document.getElementById(e):"object"==typeof e&&1===e.nodeType&&(n=e);else if(t.parentElement)return t;return n||(n=document.body),n.appendChild(t),t}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r){var s;if(void 0===r&&(r=t),!Array.isArray(e))return-1!==(s=t.indexOf(e))?(i(t,s),n&&n.call(r,e),e):null;for(var o=e.length-1;o>=0;){var a=e[o];-1!==(s=t.indexOf(a))?(i(t,s),n&&n.call(r,a)):e.pop(),o--}return e}},function(t,e){t.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175}},function(t,e){t.exports={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9}},function(t,e,n){var i=n(0),r=n(66),s=n(9),o=n(59),a=n(17),u=n(1),l=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.jsonCache=t.cache.json,this.sounds=[],this.mute=!1,this.volume=1,this.pauseOnBlur=!0,this._rate=1,this._detune=0,this.locked=this.locked||!1,this.unlocked=!1,t.events.on(a.BLUR,function(){this.pauseOnBlur&&this.onBlur()},this),t.events.on(a.FOCUS,function(){this.pauseOnBlur&&this.onFocus()},this),t.events.on(a.PRE_STEP,this.update,this),t.events.once(a.DESTROY,this.destroy,this)},add:u,addAudioSprite:function(t,e){void 0===e&&(e={});var n=this.add(t,e);for(var i in n.spritemap=this.jsonCache.get(t).spritemap,n.spritemap)if(n.spritemap.hasOwnProperty(i)){var s=r(e),o=n.spritemap[i];s.loop=!!o.hasOwnProperty("loop")&&o.loop,n.addMarker({name:i,start:o.start,duration:o.end-o.start,config:s})}return n},play:function(t,e){var n=this.add(t);return n.once(o.COMPLETE,n.destroy,n),e?e.name?(n.addMarker(e),n.play(e.name)):n.play(e):n.play()},playAudioSprite:function(t,e,n){var i=this.addAudioSprite(t);return i.once(o.COMPLETE,i.destroy,i),i.play(e,n)},remove:function(t){var e=this.sounds.indexOf(t);return-1!==e&&(t.destroy(),this.sounds.splice(e,1),!0)},removeByKey:function(t){for(var e=0,n=this.sounds.length-1;n>=0;n--){var i=this.sounds[n];i.key===t&&(i.destroy(),this.sounds.splice(n,1),e++)}return e},pauseAll:function(){this.forEachActiveSound(function(t){t.pause()}),this.emit(o.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(t){t.resume()}),this.emit(o.RESUME_ALL,this)},stopAll:function(){this.forEachActiveSound(function(t){t.stop()}),this.emit(o.STOP_ALL,this)},unlock:u,onBlur:u,onFocus:u,update:function(t,e){this.unlocked&&(this.unlocked=!1,this.locked=!1,this.emit(o.UNLOCKED,this));for(var n=this.sounds.length-1;n>=0;n--)this.sounds[n].pendingRemove&&this.sounds.splice(n,1);this.sounds.forEach(function(n){n.update(t,e)})},destroy:function(){this.removeAllListeners(),this.forEachActiveSound(function(t){t.destroy()}),this.sounds.length=0,this.sounds=null,this.game=null},forEachActiveSound:function(t,e){var n=this;this.sounds.forEach(function(i,r){i&&!i.pendingRemove&&t.call(e||n,i,r,n.sounds)})},setRate:function(t){return this.rate=t,this},rate:{get:function(){return this._rate},set:function(t){this._rate=t,this.forEachActiveSound(function(t){t.calculateRate()}),this.emit(o.GLOBAL_RATE,this,t)}},setDetune:function(t){return this.detune=t,this},detune:{get:function(){return this._detune},set:function(t){this._detune=t,this.forEachActiveSound(function(t){t.calculateRate()}),this.emit(o.GLOBAL_DETUNE,this,t)}}});t.exports=l},function(t,e,n){var i=n(0),r=n(9),s=n(59),o=n(16),a=n(1),u=new i({Extends:r,initialize:function(t,e,n){r.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=this.duration||0,this.totalDuration=this.totalDuration||0,this.config={mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0},this.currentConfig=this.config,this.config=o(this.config,n),this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(t){return!(!t||!t.name||"string"!=typeof t.name||(this.markers[t.name]?(console.error("addMarker "+t.name+" already exists in Sound"),1):(t=o(!0,{name:"",start:0,duration:this.totalDuration-(t.start||0),config:{mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0}},t),this.markers[t.name]=t,0)))},updateMarker:function(t){return!(!t||!t.name||"string"!=typeof t.name||(this.markers[t.name]?(this.markers[t.name]=o(!0,this.markers[t.name],t),0):(console.warn("Audio Marker: "+t.name+" missing in Sound: "+this.key),1)))},removeMarker:function(t){var e=this.markers[t];return e?(this.markers[t]=null,e):null},play:function(t,e){if(void 0===t&&(t=""),"object"==typeof t&&(e=t,t=""),"string"!=typeof t)return!1;if(t){if(!this.markers[t])return console.warn("Marker: "+t+" missing in Sound: "+this.key),!1;this.currentMarker=this.markers[t],this.currentConfig=this.currentMarker.config,this.duration=this.currentMarker.duration}else this.currentMarker=null,this.currentConfig=this.config,this.duration=this.totalDuration;return this.resetConfig(),this.currentConfig=o(this.currentConfig,e),this.isPlaying=!0,this.isPaused=!1,!0},pause:function(){return!(this.isPaused||!this.isPlaying||(this.isPlaying=!1,this.isPaused=!0,0))},resume:function(){return!(!this.isPaused||this.isPlaying||(this.isPlaying=!0,this.isPaused=!1,0))},stop:function(){return!(!this.isPaused&&!this.isPlaying||(this.isPlaying=!1,this.isPaused=!1,this.resetConfig(),0))},applyConfig:function(){this.mute=this.currentConfig.mute,this.volume=this.currentConfig.volume,this.rate=this.currentConfig.rate,this.detune=this.currentConfig.detune,this.loop=this.currentConfig.loop},resetConfig:function(){this.currentConfig.seek=0,this.currentConfig.delay=0},update:a,calculateRate:function(){var t=Math.pow(1.0005777895065548,this.currentConfig.detune+this.manager.detune);this.totalRate=this.currentConfig.rate*this.manager.rate*t},destroy:function(){this.pendingRemove||(this.emit(s.DESTROY,this),this.pendingRemove=!0,this.manager=null,this.key="",this.removeAllListeners(),this.isPlaying=!1,this.isPaused=!1,this.config=null,this.currentConfig=null,this.markers=null,this.currentMarker=null)}});t.exports=u},function(t,e,n){var i=n(180),r=n(0),s=n(1),o=n(126),a=new r({initialize:function(t){this.parent=t,this.list=[],this.position=0,this.addCallback=s,this.removeCallback=s,this._sortKey=""},add:function(t,e){return e?i.Add(this.list,t):i.Add(this.list,t,0,this.addCallback,this)},addAt:function(t,e,n){return n?i.AddAt(this.list,t,e):i.AddAt(this.list,t,e,0,this.addCallback,this)},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),o.inplace(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e){return i.CountAllMatching(this.list,t,e)},swap:function(t,e){i.Swap(this.list,t,e)},moveTo:function(t,e){return i.MoveTo(this.list,t,e)},remove:function(t,e){return e?i.Remove(this.list,t):i.Remove(this.list,t,this.removeCallback,this)},removeAt:function(t,e){return e?i.RemoveAt(this.list,t):i.RemoveAt(this.list,t,this.removeCallback,this)},removeBetween:function(t,e,n){return n?i.RemoveBetween(this.list,t,e):i.RemoveBetween(this.list,t,e,this.removeCallback,this)},removeAll:function(t){for(var e=this.list.length;e--;)this.remove(this.list[e],t);return this},bringToTop:function(t){return i.BringToTop(this.list,t)},sendToBack:function(t){return i.SendToBack(this.list,t)},moveUp:function(t){return i.MoveUp(this.list,t),t},moveDown:function(t){return i.MoveDown(this.list,t),t},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e){return i.Replace(this.list,t,e)},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){for(var n=[null],i=2;i<arguments.length;i++)n.push(arguments[i]);for(i=0;i<this.list.length;i++)n[0]=this.list[i],t.apply(e,n)},shutdown:function(){this.removeAll(),this.list=[]},destroy:function(){this.removeAll(),this.parent=null,this.addCallback=null,this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}}});t.exports=a},function(t,e,n){var i=n(181),r=n(366);t.exports=function(t,e){if(void 0===e&&(e=90),!i(t))return null;if("string"!=typeof e&&(e=(e%360+360)%360),90===e||-270===e||"rotateLeft"===e)(t=r(t)).reverse();else if(-90===e||270===e||"rotateRight"===e)t.reverse(),t=r(t);else if(180===Math.abs(e)||"rotate180"===e){for(var n=0;n<t.length;n++)t[n].reverse();t.reverse()}return t}},function(t,e,n){!function(){var e=function(t,e){return n(t.slice(),e)};function n(t,e){"function"!=typeof e&&(e=function(t,e){return String(t).localeCompare(e)});var n=t.length;if(n<=1)return t;for(var r=new Array(n),s=1;s<n;s*=2){i(t,e,s,r);var o=t;t=r,r=o}return t}e.inplace=function(t,e){var r=n(t,e);return r!==t&&i(r,null,t.length,t),t};var i=function(t,e,n,i){var r,s,o,a,u,l=t.length,c=0,h=2*n;for(r=0;r<l;r+=h)for(o=(s=r+n)+n,s>l&&(s=l),o>l&&(o=l),a=r,u=s;;)if(a<s&&u<o)e(t[a],t[u])<=0?i[c++]=t[a++]:i[c++]=t[u++];else if(a<s)i[c++]=t[a++];else{if(!(u<o))break;i[c++]=t[u++]}};t.exports=e}()},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(922),a=n(923),u=n(184),l=n(924),c=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Mask,r.Origin,r.Pipeline,r.ScrollFactor,r.Texture,r.Tint,r.Transform,r.Visible,l],initialize:function(t,e,n,i,r,a,u){void 0===r&&(r=""),void 0===u&&(u=0),s.call(this,t,"BitmapText"),this.font=i;var l=this.scene.sys.cache.bitmapFont.get(i);this.fontData=l.data,this._text="",this._fontSize=a||this.fontData.size,this._letterSpacing=0,this._align=u,this._bounds=o(this,!1,this._bounds),this._dirty=!1,this.setTexture(l.texture,l.frame),this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.setText(r)},setLeftAlign:function(){return this._align=c.ALIGN_LEFT,this._dirty=!0,this},setCenterAlign:function(){return this._align=c.ALIGN_CENTER,this._dirty=!0,this},setRightAlign:function(){return this._align=c.ALIGN_RIGHT,this._dirty=!0,this},setFontSize:function(t){return this._fontSize=t,this._dirty=!0,this},setLetterSpacing:function(t){return void 0===t&&(t=0),this._letterSpacing=t,this._dirty=!0,this},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this.text&&(this._text=t.toString(),this._dirty=!0,this.updateDisplayOrigin()),this},getTextBounds:function(t){return this._dirty&&o(this,t,this._bounds),this._bounds},setFont:function(t,e,n){if(void 0===e&&(e=this._fontSize),void 0===n&&(n=this._align),t!==this.font){var i=this.scene.sys.cache.bitmapFont.get(t);i&&(this.font=t,this.fontData=i.data,this._fontSize=e,this._align=n,this.setTexture(i.texture,i.frame),o(this,!1,this._bounds))}return this},align:{set:function(t){this._align=t,this._dirty=!0},get:function(){return this._align}},text:{set:function(t){this.setText(t)},get:function(){return this._text}},fontSize:{set:function(t){this._fontSize=t,this._dirty=!0},get:function(){return this._fontSize}},letterSpacing:{set:function(t){this._letterSpacing=t,this._dirty=!0},get:function(){return this._letterSpacing}},width:{get:function(){return this.getTextBounds(!1),this._bounds.global.width}},height:{get:function(){return this.getTextBounds(!1),this._bounds.global.height}},toJSON:function(){var t=r.ToJSON(this);return t.data={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,align:this.align},t}});c.ALIGN_LEFT=0,c.ALIGN_CENTER=1,c.ALIGN_RIGHT=2,c.ParseFromAtlas=a,c.ParseXMLBitmapFont=u,t.exports=c},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(1049),a=n(1),u=new i({Extends:s,Mixins:[r.BlendMode,r.Depth,r.GetBounds,r.Mask,r.Pipeline,r.Size,r.Texture,r.Transform,r.Visible,r.ScrollFactor,o],initialize:function(t,e,n,i,r,o,a,u,l){if(s.call(this,t,"Mesh"),i.length!==r.length)throw new Error("Mesh Vertex count must match UV count");var c,h=i.length/2|0;if(o.length>0&&o.length<h)throw new Error("Mesh Color count must match Vertex count");if(a.length>0&&a.length<h)throw new Error("Mesh Alpha count must match Vertex count");if(0===o.length)for(c=0;c<h;++c)o[c]=16777215;if(0===a.length)for(c=0;c<h;++c)a[c]=1;this.vertices=new Float32Array(i),this.uv=new Float32Array(r),this.colors=new Uint32Array(o),this.alphas=new Float32Array(a),this.tintFill=!1,this.setTexture(u,l),this.setPosition(e,n),this.setSizeToFrame(),this.initPipeline()},setAlpha:a});t.exports=u},function(t,e){t.exports=function(t,e){return!(t.width<=0||t.height<=0||e.width<=0||e.height<=0||t.right<e.x||t.bottom<e.y||t.x>e.right||t.y>e.bottom)}},function(t,e,n){var i=n(6),r={},s={register:function(t,e,n,i,s){r[t]={plugin:e,mapping:n,settingsKey:i,configKey:s}},getPlugin:function(t){return r[t]},install:function(t){var e=t.scene.sys,n=e.settings.input,s=e.game.config;for(var o in r){var a=r[o].plugin,u=r[o].mapping;i(n,r[o].settingsKey,s[r[o].configKey])&&(t[u]=new a(t))}},remove:function(t){r.hasOwnProperty(t)&&delete r[t]}};t.exports=s},function(t,e,n){t.exports={ANY_KEY_DOWN:n(1187),ANY_KEY_UP:n(1188),COMBO_MATCH:n(1189),DOWN:n(1190),KEY_DOWN:n(1191),KEY_UP:n(1192),UP:n(1193)}},function(t,e){t.exports=function(t,e){return!!t.url&&(t.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?t.url:e+t.url)}},function(t,e){t.exports=function(t,e,n,i,r){return void 0===t&&(t=""),void 0===e&&(e=!0),void 0===n&&(n=""),void 0===i&&(i=""),void 0===r&&(r=0),{responseType:t,async:e,user:n,password:i,timeout:r,header:void 0,headerValue:void 0,requestedWith:!1,overrideMimeType:void 0}}},function(t,e,n){var i=n(0),r=n(211),s=n(68),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},function(t,e,n){var i={};t.exports=i;var r=n(86),s=n(37),o=n(62),a=n(102),u=n(101),l=n(1360);i.rectangle=function(t,e,n,i,a){a=a||{};var u={label:"Rectangle Body",position:{x:t,y:e},vertices:r.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var l=a.chamfer;u.vertices=r.chamfer(u.vertices,l.radius,l.quality,l.qualityMin,l.qualityMax),delete a.chamfer}return o.create(s.extend({},u,a))},i.trapezoid=function(t,e,n,i,a,u){u=u||{};var l=n*(a*=.5),c=l+(1-2*a)*n,h=c+l,d={label:"Trapezoid Body",position:{x:t,y:e},vertices:r.fromPath(a<.5?"L 0 0 L "+l+" "+-i+" L "+c+" "+-i+" L "+h+" 0":"L 0 0 L "+c+" "+-i+" L "+h+" 0")};if(u.chamfer){var f=u.chamfer;d.vertices=r.chamfer(d.vertices,f.radius,f.quality,f.qualityMin,f.qualityMax),delete u.chamfer}return o.create(s.extend({},d,u))},i.circle=function(t,e,n,r,o){r=r||{};var a={label:"Circle Body",circleRadius:n};o=o||25;var u=Math.ceil(Math.max(10,Math.min(o,n)));return u%2==1&&(u+=1),i.polygon(t,e,u,n,s.extend({},a,r))},i.polygon=function(t,e,n,a,u){if(u=u||{},n<3)return i.circle(t,e,a,u);for(var l=2*Math.PI/n,c="",h=.5*l,d=0;d<n;d+=1){var f=h+d*l,p=Math.cos(f)*a,m=Math.sin(f)*a;c+="L "+p.toFixed(3)+" "+m.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:t,y:e},vertices:r.fromPath(c)};if(u.chamfer){var y=u.chamfer;g.vertices=r.chamfer(g.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete u.chamfer}return o.create(s.extend({},g,u))},i.fromVertices=function(t,e,n,i,c,h,d){var f,p,m,g,y,v,b,x,w;for(i=i||{},p=[],c=void 0!==c&&c,h=void 0!==h?h:.01,d=void 0!==d?d:10,l||s.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),s.isArray(n[0])||(n=[n]),x=0;x<n.length;x+=1)if((m=r.isConvex(g=n[x]))||!l)g=m?r.clockwiseSort(g):r.hull(g),p.push({position:{x:t,y:e},vertices:g});else{var T=g.map(function(t){return[t.x,t.y]});l.makeCCW(T),!1!==h&&l.removeCollinearPoints(T,h);var S=l.quickDecomp(T);for(y=0;y<S.length;y++){var E=S[y].map(function(t){return{x:t[0],y:t[1]}});d>0&&r.area(E)<d||p.push({position:r.centre(E),vertices:E})}}for(y=0;y<p.length;y++)p[y]=o.create(s.extend(p[y],i));if(c)for(y=0;y<p.length;y++){var O=p[y];for(v=y+1;v<p.length;v++){var C=p[v];if(a.overlaps(O.bounds,C.bounds)){var _=O.vertices,A=C.vertices;for(b=0;b<O.vertices.length;b++)for(w=0;w<C.vertices.length;w++){var k=u.magnitudeSquared(u.sub(_[(b+1)%_.length],A[w])),R=u.magnitudeSquared(u.sub(_[b],A[(w+1)%A.length]));k<5&&R<5&&(_[b].isInternal=!0,A[w].isInternal=!0)}}}}return p.length>1?(f=o.create(s.extend({parts:p.slice(0)},i)),o.setPosition(f,{x:t,y:e}),f):p[0]}},function(t,e,n){t.exports={CalculateFacesAt:n(214),CalculateFacesWithin:n(51),Copy:n(1281),CreateFromTiles:n(1282),CullTiles:n(1283),Fill:n(1284),FilterTiles:n(1285),FindByIndex:n(1286),FindTile:n(1287),ForEachTile:n(1288),GetTileAt:n(137),GetTileAtWorldXY:n(1289),GetTilesWithin:n(24),GetTilesWithinShape:n(1290),GetTilesWithinWorldXY:n(1291),HasTileAt:n(455),HasTileAtWorldXY:n(1292),IsInLayerBounds:n(103),PutTileAt:n(215),PutTileAtWorldXY:n(1293),PutTilesAt:n(1294),Randomize:n(1295),RemoveTileAt:n(456),RemoveTileAtWorldXY:n(1296),RenderDebug:n(1297),ReplaceByIndex:n(454),SetCollision:n(1298),SetCollisionBetween:n(1299),SetCollisionByExclusion:n(1300),SetCollisionByProperty:n(1301),SetCollisionFromCollisionGroup:n(1302),SetTileIndexCallback:n(1303),SetTileLocationCallback:n(1304),Shuffle:n(1305),SwapByIndex:n(1306),TileToWorldX:n(138),TileToWorldXY:n(1307),TileToWorldY:n(139),WeightedRandomize:n(1308),WorldToTileX:n(63),WorldToTileXY:n(1309),WorldToTileY:n(64)}},function(t,e,n){var i=n(103);t.exports=function(t,e,n,r){if(void 0===n&&(n=!1),i(t,e,r)){var s=r.data[e][t]||null;return null===s?null:-1===s.index?n?s:null:s}return null}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileWidth,r=n.tilemapLayer,s=0;return r&&(void 0===e&&(e=r.scene.cameras.main),s=r.x+e.scrollX*(1-r.scrollFactorX),i*=r.scaleX),s+t*i}},function(t,e){t.exports=function(t,e,n){var i=n.baseTileHeight,r=n.tilemapLayer,s=0;return r&&(void 0===e&&(e=r.scene.cameras.main),s=r.y+e.scrollY*(1-r.scrollFactorY),i*=r.scaleY),s+t*i}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o,a){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o={}),void 0===a&&(a={}),this.name=t,this.firstgid=e,this.tileWidth=n,this.tileHeight=i,this.tileMargin=r,this.tileSpacing=s,this.tileProperties=o,this.tileData=a,this.image=null,this.glTexture=null,this.rows=0,this.columns=0,this.total=0,this.texCoordinates=[]},getTileProperties:function(t){return this.containsTileIndex(t)?this.tileProperties[t-this.firstgid]:null},getTileData:function(t){return this.containsTileIndex(t)?this.tileData[t-this.firstgid]:null},getTileCollisionGroup:function(t){var e=this.getTileData(t);return e&&e.objectgroup?e.objectgroup:null},containsTileIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},getTileTextureCoordinates:function(t){return this.containsTileIndex(t)?this.texCoordinates[t-this.firstgid]:null},setImage:function(t){return this.image=t,this.glTexture=t.get().source.glTexture,this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setTileSize:function(t,e){return void 0!==t&&(this.tileWidth=t),void 0!==e&&(this.tileHeight=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},setSpacing:function(t,e){return void 0!==t&&(this.tileMargin=t),void 0!==e&&(this.tileSpacing=e),this.image&&this.updateTileData(this.image.source[0].width,this.image.source[0].height),this},updateTileData:function(t,e){var n=(e-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),i=(t-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);n%1==0&&i%1==0||console.warn("Image tile area not tile size multiple in: "+this.name),n=Math.floor(n),i=Math.floor(i),this.rows=n,this.columns=i,this.total=n*i,this.texCoordinates.length=0;for(var r=this.tileMargin,s=this.tileMargin,o=0;o<this.rows;o++){for(var a=0;a<this.columns;a++)this.texCoordinates.push({x:r,y:s}),r+=this.tileWidth+this.tileSpacing;r=this.tileMargin,s+=this.tileHeight+this.tileSpacing}return this}});t.exports=i},function(t,e){t.exports=function(t,e,n){return t.hasOwnProperty(e)?"function"==typeof t[e]?function(n,i,r,s,o,a){return t[e](n,i,r,s,o,a)}:function(){return t[e]}:"function"==typeof n?n:function(){return n}}},function(t,e,n){var i=n(223),r=n(14),s=n(88),o=n(82),a=n(141),u=n(477),l=n(221),c=n(6),h=n(222),d=n(224),f=n(226);t.exports=function(t,e,n){void 0===n&&(n=i);for(var p=n.targets?n.targets:l(e),m=u(e),g=a(e,"delay",n.delay),y=a(e,"duration",n.duration),v=c(e,"easeParams",n.easeParams),b=o(c(e,"ease",n.ease),v),x=a(e,"hold",n.hold),w=a(e,"repeat",n.repeat),T=a(e,"repeatDelay",n.repeatDelay),S=s(e,"yoyo",n.yoyo),E=s(e,"flipX",n.flipX),O=s(e,"flipY",n.flipY),C=[],_=0;_<m.length;_++)for(var A=m[_].key,k=m[_].value,R=0;R<p.length;R++){var I=h(A,k),M=f(p[R],R,A,I.getEnd,I.getStart,I.getActive,o(c(k,"ease",b),v),a(k,"delay",g),a(k,"duration",y),s(k,"yoyo",S),a(k,"hold",x),a(k,"repeat",w),a(k,"repeatDelay",T),s(k,"flipX",E),s(k,"flipY",O));C.push(M)}var N=new d(t,C,p);N.offset=r(e,"offset",null),N.completeDelay=r(e,"completeDelay",0),N.loop=Math.round(r(e,"loop",0)),N.loopDelay=Math.round(r(e,"loopDelay",0)),N.paused=s(e,"paused",!1),N.useFrames=s(e,"useFrames",!1);for(var D=c(e,"callbackScope",N),P=[N,null],F=d.TYPES,L=0;L<F.length;L++){var j=F[L],B=c(e,j,!1);if(B){var z=c(e,j+"Scope",D),$=c(e,j+"Params",[]);N.setCallback(j,B,P.concat($),z)}}return N}},function(t,e){t.exports={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x+t.radius*Math.cos(e),n.y=t.y+t.radius*Math.sin(e),n}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=2*Math.PI*Math.random(),r=Math.random()+Math.random(),s=r>1?2-r:r,o=s*Math.cos(n),a=s*Math.sin(n);return e.x=t.x+o*t.radius,e.y=t.y+a*t.radius,e}},function(t,e,n){var i=n(22),r=n(0),s=n(9),o=n(109),a=n(251),u=n(252),l=n(6),c=new r({Extends:s,initialize:function(t,e,n){s.call(this),this.manager=t,this.key=e,this.type="frame",this.frames=this.getFrames(t.textureManager,l(n,"frames",[]),l(n,"defaultTextureKey",null)),this.frameRate=l(n,"frameRate",null),this.duration=l(n,"duration",null),null===this.duration&&null===this.frameRate?(this.frameRate=24,this.duration=this.frameRate/this.frames.length*1e3):this.duration&&null===this.frameRate?this.frameRate=this.frames.length/(this.duration/1e3):this.duration=this.frames.length/this.frameRate*1e3,this.msPerFrame=1e3/this.frameRate,this.skipMissedFrames=l(n,"skipMissedFrames",!0),this.delay=l(n,"delay",0),this.repeat=l(n,"repeat",0),this.repeatDelay=l(n,"repeatDelay",0),this.yoyo=l(n,"yoyo",!1),this.showOnStart=l(n,"showOnStart",!1),this.hideOnComplete=l(n,"hideOnComplete",!1),this.paused=!1,this.manager.on(o.PAUSE_ALL,this.pause,this),this.manager.on(o.RESUME_ALL,this.resume,this)},addFrame:function(t){return this.addFrameAt(this.frames.length,t)},addFrameAt:function(t,e){var n=this.getFrames(this.manager.textureManager,e);if(n.length>0){if(0===t)this.frames=n.concat(this.frames);else if(t===this.frames.length)this.frames=this.frames.concat(n);else{var i=this.frames.slice(0,t),r=this.frames.slice(t);this.frames=i.concat(n,r)}this.updateFrameSequence()}return this},checkFrame:function(t){return t>=0&&t<this.frames.length},completeAnimation:function(t){this.hideOnComplete&&(t.parent.visible=!1),t.stop()},getFirstTick:function(t,e){void 0===e&&(e=!0),t.accumulator=0,t.nextTick=t.msPerFrame+t.currentFrame.duration,e&&(t.nextTick+=t._delay)},getFrameAt:function(t){return this.frames[t]},getFrames:function(t,e,n){var i,r,s,o,a=[],c=1;if("string"==typeof e){var h=t.get(o=e).getFrameNames();e=[],h.forEach(function(t,n){e.push({key:o,frame:n})})}if(!Array.isArray(e)||0===e.length)return a;for(s=0;s<e.length;s++){var d=e[s],f=l(d,"key",n);if(f){var p=l(d,"frame",0),m=t.getFrame(f,p);(r=new u(f,p,c,m)).duration=l(d,"duration",0),r.isFirst=!i,i&&(i.nextFrame=r,r.prevFrame=i),a.push(r),i=r,c++}}if(a.length>0){r.isLast=!0,r.nextFrame=a[0],a[0].prevFrame=r;var g=1/(a.length-1);for(s=0;s<a.length;s++)a[s].progress=s*g}return a},getNextTick:function(t){t.accumulator-=t.nextTick,t.nextTick=t.msPerFrame+t.currentFrame.duration},load:function(t,e){e>=this.frames.length&&(e=0),t.currentAnim!==this&&(t.currentAnim=this,t.frameRate=this.frameRate,t.duration=this.duration,t.msPerFrame=this.msPerFrame,t.skipMissedFrames=this.skipMissedFrames,t._delay=this.delay,t._repeat=this.repeat,t._repeatDelay=this.repeatDelay,t._yoyo=this.yoyo);var n=this.frames[e];0!==e||t.forward||(n=this.getLastFrame()),t.updateFrame(n)},getFrameByProgress:function(t){return t=i(t,0,1),a(t,this.frames,"progress")},nextFrame:function(t){var e=t.currentFrame;e.isLast?t._yoyo?this.handleYoyoFrame(t,!1):t.repeatCounter>0?t._reverse&&t.forward?t.forward=!1:this.repeatAnimation(t):this.completeAnimation(t):this.updateAndGetNextTick(t,e.nextFrame)},handleYoyoFrame:function(t,e){if(e||(e=!1),t._reverse===!e&&t.repeatCounter>0)return t.forward=e,void this.repeatAnimation(t);t._reverse===e||0!==t.repeatCounter?(t.forward=e,this.updateAndGetNextTick(t,e?t.currentFrame.nextFrame:t.currentFrame.prevFrame)):this.completeAnimation(t)},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(t){var e=t.currentFrame;e.isFirst?t._yoyo?this.handleYoyoFrame(t,!0):t.repeatCounter>0?t._reverse&&!t.forward?(t.currentFrame=this.getLastFrame(),this.repeatAnimation(t)):(t.forward=!0,this.repeatAnimation(t)):this.completeAnimation(t):this.updateAndGetNextTick(t,e.prevFrame)},updateAndGetNextTick:function(t,e){t.updateFrame(e),this.getNextTick(t)},removeFrame:function(t){var e=this.frames.indexOf(t);return-1!==e&&this.removeFrameAt(e),this},removeFrameAt:function(t){return this.frames.splice(t,1),this.updateFrameSequence(),this},repeatAnimation:function(t){if(2===t._pendingStop)return this.completeAnimation(t);if(t._repeatDelay>0&&!1===t.pendingRepeat)t.pendingRepeat=!0,t.accumulator-=t.nextTick,t.nextTick+=t._repeatDelay;else if(t.repeatCounter--,t.updateFrame(t.currentFrame[t.forward?"nextFrame":"prevFrame"]),t.isPlaying){this.getNextTick(t),t.pendingRepeat=!1;var e=t.currentFrame,n=t.parent;this.emit(o.ANIMATION_REPEAT,this,e),n.emit(o.SPRITE_ANIMATION_KEY_REPEAT+this.key,this,e,t.repeatCounter,n),n.emit(o.SPRITE_ANIMATION_REPEAT,this,e,t.repeatCounter,n)}},setFrame:function(t){t.forward?this.nextFrame(t):this.previousFrame(t)},toJSON:function(){var t={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showOnStart:this.showOnStart,hideOnComplete:this.hideOnComplete};return this.frames.forEach(function(e){t.frames.push(e.toJSON())}),t},updateFrameSequence:function(){for(var t,e=this.frames.length,n=1/(e-1),i=0;i<e;i++)(t=this.frames[i]).index=i+1,t.isFirst=!1,t.isLast=!1,t.progress=i*n,0===i?(t.isFirst=!0,1===e?(t.isLast=!0,t.nextFrame=t,t.prevFrame=t):(t.isLast=!1,t.prevFrame=this.frames[e-1],t.nextFrame=this.frames[i+1])):i===e-1&&e>1?(t.isLast=!0,t.prevFrame=this.frames[e-2],t.nextFrame=this.frames[0]):e>1&&(t.prevFrame=this.frames[i-1],t.nextFrame=this.frames[i+1]);return this},pause:function(){return this.paused=!0,this},resume:function(){return this.paused=!1,this},destroy:function(){this.removeAllListeners(),this.manager.off(o.PAUSE_ALL,this.pause,this),this.manager.off(o.RESUME_ALL,this.resume,this),this.manager.remove(this.key);for(var t=0;t<this.frames.length;t++)this.frames[t].destroy();this.frames=[],this.manager=null}});t.exports=c},function(t,e,n){var i=n(110),r=n(4);t.exports=function(t,e,n){if(void 0===n&&(n=new r),e<=0||e>=1)return n.x=t.x,n.y=t.y,n;var s=i(t)*e;return e>.5?(s-=t.width+t.height)<=t.width?(n.x=t.right-s,n.y=t.bottom):(n.x=t.x,n.y=t.bottom-(s-t.width)):s<=t.width?(n.x=t.x+s,n.y=t.y):(n.x=t.right,n.y=t.y+(s-t.width)),n}},function(t,e,n){var i=n(56),r=n(4);t.exports=function(t,e,n,s){void 0===s&&(s=[]),e||(e=i(t)/n);for(var o=t.x1,a=t.y1,u=t.x2,l=t.y2,c=0;c<e;c++){var h=c/e;s.push(new r(o+(u-o)*h,a+(l-a)*h))}return s}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random();return e.x=t.x1+n*(t.x2-t.x1),e.y=t.y1+n*(t.y2-t.y1),e}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.x+Math.random()*t.width,e.y=t.y+Math.random()*t.height,e}},function(t,e){t.exports={defaultPipeline:null,pipeline:null,initPipeline:function(t){void 0===t&&(t="TextureTintPipeline");var e=this.scene.sys.game.renderer;return!!(e&&e.gl&&e.hasPipeline(t))&&(this.defaultPipeline=e.getPipeline(t),this.pipeline=this.defaultPipeline,!0)},setPipeline:function(t){var e=this.scene.sys.game.renderer;return e&&e.gl&&e.hasPipeline(t)&&(this.pipeline=e.getPipeline(t)),this},resetPipeline:function(){return this.pipeline=this.defaultPipeline,null!==this.pipeline},getPipelineName:function(){return this.pipeline.name}}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());return e.x=t.x+r*Math.cos(n)*t.width/2,e.y=t.y+r*Math.sin(n)*t.height/2,e}},function(t,e,n){var i=n(4);t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x2-t.x1,r=t.y2-t.y1,s=t.x3-t.x1,o=t.y3-t.y1,a=Math.random(),u=Math.random();return a+u>=1&&(a=1-a,u=1-u),e.x=t.x1+(n*a+s*u),e.y=t.y1+(r*a+o*u),e}},function(t,e){t.exports=function(t,e,n,i,r){var s=i+Math.atan2(t.y-n,t.x-e);return t.x=e+r*Math.cos(s),t.y=n+r*Math.sin(s),t}},function(t,e){t.exports=function(t,e,n){return(t=Math.max(0,Math.min(1,(t-e)/(n-e))))*t*t*(t*(6*t-15)+10)}},function(t,e){t.exports=function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){if(this.entries={},this.size=0,Array.isArray(t))for(var e=0;e<t.length;e++)this.set(t[e][0],t[e][1])},set:function(t,e){return this.has(t)||this.size++,this.entries[t]=e,this},get:function(t){if(this.has(t))return this.entries[t]},getArray:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},has:function(t){return this.entries.hasOwnProperty(t)},delete:function(t){return this.has(t)&&(delete this.entries[t],this.size--),this},clear:function(){return Object.keys(this.entries).forEach(function(t){delete this.entries[t]},this),this.size=0,this},keys:function(){return Object.keys(this.entries)},values:function(){var t=[],e=this.entries;for(var n in e)t.push(e[n]);return t},dump:function(){var t=this.entries;for(var e in console.group("Map"),t)console.log(e,t[e]);console.groupEnd()},each:function(t){var e=this.entries;for(var n in e)if(!1===t(n,e[n]))break;return this},contains:function(t){var e=this.entries;for(var n in e)if(e[n]===t)return!0;return!1},merge:function(t,e){void 0===e&&(e=!1);var n=this.entries,i=t.entries;for(var r in i)n.hasOwnProperty(r)&&e?n[r]=i[r]:this.set(r,i[r]);return this}});t.exports=i},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=" "),void 0===i&&(i=3);var r=0;if(e+1>=(t=t.toString()).length)switch(i){case 1:t=new Array(e+1-t.length).join(n)+t;break;case 3:var s=Math.ceil((r=e-t.length)/2);t=new Array(r-s+1).join(n)+t+new Array(s+1).join(n);break;default:t+=new Array(e+1-t.length).join(n)}return t}},function(t,e,n){var i=n(275),r=n(278),s=n(280),o=n(281);t.exports=function(t){switch(typeof t){case"string":return"rgb"===t.substr(0,3).toLowerCase()?o(t):i(t);case"number":return r(t);case"object":return s(t)}}},function(t,e){t.exports=function(t,e,n){return t<<16|e<<8|n}},function(t,e,n){var i=n(160);t.exports=function(t,e,n,r){void 0===e&&(e=1),void 0===n&&(n=1);var s=Math.floor(6*t),o=6*t-s,a=Math.floor(n*(1-e)*255),u=Math.floor(n*(1-o*e)*255),l=Math.floor(n*(1-(1-o)*e)*255),c=n=Math.floor(n*=255),h=n,d=n,f=s%6;return 0===f?(h=l,d=a):1===f?(c=u,d=a):2===f?(c=a,d=l):3===f?(c=a,h=u):4===f?(c=l,h=a):5===f&&(h=a,d=u),r?r.setTo?r.setTo(c,h,d,r.alpha,!1):(r.r=c,r.g=h,r.b=d,r.color=i(c,h,d),r):{r:c,g:h,b:d,color:i(c,h,d)}}},function(t,e){var n,i="";t.exports={disable:function(t){return""===i&&(i=n(t)),i&&(t[i]=!1),t},enable:function(t){return""===i&&(i=n(t)),i&&(t[i]=!0),t},getPrefix:n=function(t){for(var e=["i","webkitI","msI","mozI","oI"],n=0;n<e.length;n++){var i=e[n]+"mageSmoothingEnabled";if(i in t)return i}return null},isEnabled:function(t){return null!==i?t[i]:null}}},function(t,e){t.exports=function(t,e,n){return t.x=e-t.width/2,t.y=n-t.height/2,t}},function(t,e,n){var i=n(283),r=n(284),s=n(285),o=n(286),a=n(287),u=n(288),l=n(289),c=n(290),h=n(291),d=n(292),f=n(293),p=n(294);t.exports={Power0:l,Power1:c.Out,Power2:o.Out,Power3:h.Out,Power4:d.Out,Linear:l,Quad:c.Out,Cubic:o.Out,Quart:h.Out,Quint:d.Out,Sine:f.Out,Expo:u.Out,Circ:s.Out,Elastic:a.Out,Back:i.Out,Bounce:r.Out,Stepped:p,"Quad.easeIn":c.In,"Cubic.easeIn":o.In,"Quart.easeIn":h.In,"Quint.easeIn":d.In,"Sine.easeIn":f.In,"Expo.easeIn":u.In,"Circ.easeIn":s.In,"Elastic.easeIn":a.In,"Back.easeIn":i.In,"Bounce.easeIn":r.In,"Quad.easeOut":c.Out,"Cubic.easeOut":o.Out,"Quart.easeOut":h.Out,"Quint.easeOut":d.Out,"Sine.easeOut":f.Out,"Expo.easeOut":u.Out,"Circ.easeOut":s.Out,"Elastic.easeOut":a.Out,"Back.easeOut":i.Out,"Bounce.easeOut":r.Out,"Quad.easeInOut":c.InOut,"Cubic.easeInOut":o.InOut,"Quart.easeInOut":h.InOut,"Quint.easeInOut":d.InOut,"Sine.easeInOut":f.InOut,"Expo.easeInOut":u.InOut,"Circ.easeInOut":s.InOut,"Elastic.easeInOut":a.InOut,"Back.easeInOut":i.InOut,"Bounce.easeInOut":r.InOut}},function(t,e,n){var i=n(114),r=n(115),s=n(25),o={canvas:!1,canvasBitBltShift:null,file:!1,fileSystem:!1,getUserMedia:!0,littleEndian:!1,localStorage:!1,pointerLock:!1,support32bit:!1,vibration:!1,webGL:!1,worker:!1};t.exports=function(){o.canvas=!!window.CanvasRenderingContext2D;try{o.localStorage=!!localStorage.getItem}catch(t){o.localStorage=!1}o.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),o.fileSystem=!!window.requestFileSystem;var t,e,n,a=!1;return o.webGL=function(){if(window.WebGLRenderingContext)try{var t=s.createWebGL(this),e=t.getContext("webgl")||t.getContext("experimental-webgl"),n=s.create2D(this),i=n.getContext("2d").createImageData(1,1);return a=i.data instanceof Uint8ClampedArray,s.remove(t),s.remove(n),!!e}catch(t){return!1}return!1}(),o.worker=!!window.Worker,o.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,o.getUserMedia=o.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,r.firefox&&r.firefoxVersion<21&&(o.getUserMedia=!1),!i.iOS&&(r.ie||r.firefox||r.chrome)&&(o.canvasBitBltShift=!0),(r.safari||r.mobileSafari)&&(o.canvasBitBltShift=!1),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(o.vibration=!0),"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(o.littleEndian=(t=new ArrayBuffer(4),e=new Uint8Array(t),n=new Uint32Array(t),e[0]=161,e[1]=178,e[2]=195,e[3]=212,3569595041===n[0]||2712847316!==n[0]&&null)),o.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==o.littleEndian&&a,o}()},function(t,e,n){var i=n(23),r=n(16),s={Angle:n(701),Distance:n(709),Easing:n(711),Fuzzy:n(712),Interpolation:n(715),Pow2:n(720),Snap:n(722),RandomDataGenerator:n(724),Average:n(725),Bernstein:n(303),Between:n(169),CatmullRom:n(168),CeilTo:n(726),Clamp:n(22),DegToRad:n(35),Difference:n(727),Factorial:n(304),FloatBetween:n(310),FloorTo:n(728),FromPercent:n(87),GetSpeed:n(729),IsEven:n(730),IsEvenStrict:n(731),Linear:n(113),MaxAdd:n(732),MinSub:n(733),Percent:n(734),RadToDeg:n(170),RandomXY:n(735),RandomXYZ:n(736),RandomXYZW:n(737),Rotate:n(311),RotateAround:n(257),RotateAroundDistance:n(154),RoundAwayFromZero:n(312),RoundTo:n(738),SinCosTableGenerator:n(739),SmootherStep:n(155),SmoothStep:n(156),ToXY:n(740),TransformXY:n(313),Within:n(741),Wrap:n(57),Vector2:n(3),Vector3:n(171),Vector4:n(314),Matrix3:n(315),Matrix4:n(316),Quaternion:n(317),RotateVec3:n(742)};s=r(!1,s,i),t.exports=s},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),Math.abs(t-e)<n}},function(t,e){t.exports=function(t,e,n,i,r){var s=.5*(i-e),o=.5*(r-n),a=t*t;return(2*n-2*i+s+o)*(t*a)+(-3*n+3*i-2*s-o)*a+s*t+n}},function(t,e){t.exports=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},function(t,e,n){var i=n(23);t.exports=function(t){return t*i.RAD_TO_DEG}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n){this.x=0,this.y=0,this.z=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0)},up:function(){return this.x=0,this.y=1,this.z=0,this},clone:function(){return new i(this.x,this.y,this.z)},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this},set:function(t,e,n){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0):(this.x=t||0,this.y=e||0,this.z=n||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this},scale:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return Math.sqrt(e*e+n*n+i*i)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0;return e*e+n*n+i*i},length:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},lengthSq:function(){var t=this.x,e=this.y,n=this.z;return t*t+e*e+n*n},normalize:function(){var t=this.x,e=this.y,n=this.z,i=t*t+e*e+n*n;return i>0&&(i=1/Math.sqrt(i),this.x=t*i,this.y=e*i,this.z=n*i),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z;return this.x=n*o-i*s,this.y=i*r-e*o,this.z=e*s-n*r,this},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this},transformMat3:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=e*r[0]+n*r[3]+i*r[6],this.y=e*r[1]+n*r[4]+i*r[7],this.z=e*r[2]+n*r[5]+i*r[8],this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=t.val;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},transformCoordinates:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=e*r[1]+n*r[5]+i*r[9]+r[13],o=e*r[2]+n*r[6]+i*r[10]+r[14],a=e*r[3]+n*r[7]+i*r[11]+r[15];return this.x=(e*r[0]+n*r[4]+i*r[8]+r[12])/a,this.y=s/a,this.z=o/a,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,u=a*e+s*i-o*n,l=a*n+o*e-r*i,c=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=u*a+h*-r+l*-o-c*-s,this.y=l*a+h*-s+c*-r-u*-o,this.z=c*a+h*-o+u*-s-l*-r,this},project:function(t){var e=this.x,n=this.y,i=this.z,r=t.val,s=r[1],o=r[2],a=r[5],u=r[6],l=r[9],c=r[10],h=r[13],d=r[14],f=1/(e*r[3]+n*r[7]+i*r[11]+r[15]);return this.x=(e*r[0]+n*r[4]+i*r[8]+r[12])*f,this.y=(e*s+n*a+i*l+h)*f,this.z=(e*o+n*u+i*c+d)*f,this},unproject:function(t,e){var n=t.w,i=n-this.y-1-t.y,r=this.z;return this.x=2*(this.x-t.x)/t.z-1,this.y=2*i/n-1,this.z=2*r-1,this.project(e)},reset:function(){return this.x=0,this.y=0,this.z=0,this}});i.ZERO=new i,i.RIGHT=new i(1,0,0),i.LEFT=new i(-1,0,0),i.UP=new i(0,-1,0),i.DOWN=new i(0,1,0),i.FORWARD=new i(0,0,1),i.BACK=new i(0,0,-1),i.ONE=new i(1,1,1),t.exports=i},function(t,e,n){t.exports={Global:["game","anims","cache","plugins","registry","scale","sound","textures"],CoreScene:["EventEmitter","CameraManager","GameObjectCreator","GameObjectFactory","ScenePlugin","DisplayList","UpdateList"],DefaultScene:["Clock","DataManagerPlugin","InputPlugin","Loader","TweenManager","LightsPlugin"]}},function(t,e,n){var i=n(11);t.exports=function(t,e){if(void 0===e&&(e=new i),0===t.length)return e;for(var n,r,s,o=Number.MAX_VALUE,a=Number.MAX_VALUE,u=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,c=0;c<t.length;c++)n=t[c],Array.isArray(n)?(r=n[0],s=n[1]):(r=n.x,s=n.y),o=Math.min(o,r),a=Math.min(a,s),u=Math.max(u,r),l=Math.max(l,s);return e.x=o,e.y=a,e.width=u-o,e.height=l-a,e}},function(t,e,n){var i={CENTER:n(337),ORIENTATION:n(338),SCALE_MODE:n(339),ZOOM:n(340)};t.exports=i},function(t,e){t.exports=function(t){t.parentNode&&t.parentNode.removeChild(t)}},function(t,e){t.exports={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8}},function(t,e,n){var i=n(0),r=n(121),s=n(172),o=n(21),a=n(855),u=n(856),l=n(1),c=n(353),h=new i({initialize:function(t,e){this.scene=t,this.config=e,this.settings=c.create(e),this.sceneUpdate=l},init:function(t){this.settings.status=r.INIT,this.sceneUpdate=l,this.game=t,this.renderer=t.renderer,this.canvas=t.canvas,this.context=t.context;var e=t.plugins;this.plugins=e,e.addToScene(this,s.Global,[s.CoreScene,u(this),a(this)]),this.events.emit(o.BOOT,this),this.settings.isBooted=!0},install:function(t){Array.isArray(t)||(t=[t]),this.plugins.installLocal(this,t)},step:function(t,e){this.events.emit(o.PRE_UPDATE,t,e),this.events.emit(o.UPDATE,t,e),this.sceneUpdate.call(this.scene,t,e),this.events.emit(o.POST_UPDATE,t,e)},render:function(t){var e=this.displayList;e.depthSort(),this.cameras.render(t,e),this.events.emit(o.RENDER,t)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(t){return this.settings.active&&(this.settings.status=r.PAUSED,this.settings.active=!1,this.events.emit(o.PAUSE,this,t)),this},resume:function(t){return this.settings.active||(this.settings.status=r.RUNNING,this.settings.active=!0,this.events.emit(o.RESUME,this,t)),this},sleep:function(t){return this.settings.status=r.SLEEPING,this.settings.active=!1,this.settings.visible=!1,this.events.emit(o.SLEEP,this,t),this},wake:function(t){var e=this.settings;return e.status=r.RUNNING,e.active=!0,e.visible=!0,this.events.emit(o.WAKE,this,t),e.isTransition&&this.events.emit(o.TRANSITION_WAKE,e.transitionFrom,e.transitionDuration),this},isSleeping:function(){return this.settings.status===r.SLEEPING},isActive:function(){return this.settings.status===r.RUNNING},isPaused:function(){return this.settings.status===r.PAUSED},isTransitioning:function(){return this.settings.isTransition||null!==this.scenePlugin._target},isTransitionOut:function(){return null!==this.scenePlugin._target&&this.scenePlugin._duration>0},isTransitionIn:function(){return this.settings.isTransition},isVisible:function(){return this.settings.visible},setVisible:function(t){return this.settings.visible=t,this},setActive:function(t,e){return t?this.resume(e):this.pause(e)},start:function(t){t&&(this.settings.data=t),this.settings.status=r.START,this.settings.active=!0,this.settings.visible=!0,this.events.emit(o.START,this),this.events.emit(o.READY,this,t)},shutdown:function(t){this.events.off(o.TRANSITION_INIT),this.events.off(o.TRANSITION_START),this.events.off(o.TRANSITION_COMPLETE),this.events.off(o.TRANSITION_OUT),this.settings.status=r.SHUTDOWN,this.settings.active=!1,this.settings.visible=!1,this.events.emit(o.SHUTDOWN,this,t)},destroy:function(){this.settings.status=r.DESTROYED,this.settings.active=!1,this.settings.visible=!1,this.events.emit(o.DESTROY,this),this.events.removeAllListeners();for(var t=["scene","game","anims","cache","plugins","registry","sound","textures","add","camera","displayList","events","make","scenePlugin","updateList"],e=0;e<t.length;e++)this[t[e]]=null}});t.exports=h},function(t,e){t.exports=function(t){return t&&t[0].toUpperCase()+t.slice(1)}},function(t,e,n){var i=n(0),r=n(94),s=n(356),o=new i({initialize:function(t,e,n,i,r){Array.isArray(n)||(n=[n]),this.manager=t,this.key=e,this.source=[],this.dataSource=[],this.frames={},this.customData={},this.firstFrame="__BASE",this.frameTotal=0;for(var o=0;o<n.length;o++)this.source.push(new s(this,n[o],i,r))},add:function(t,e,n,i,s,o){if(this.has(t))return null;var a=new r(this,t,e,n,i,s,o);return this.frames[t]=a,"__BASE"===this.firstFrame&&(this.firstFrame=t),this.frameTotal++,a},remove:function(t){return!!this.has(t)&&(this.get(t).destroy(),delete this.frames[t],!0)},has:function(t){return this.frames[t]},get:function(t){t||(t=this.firstFrame);var e=this.frames[t];return e||(console.warn("Texture.frame missing: "+t),e=this.frames[this.firstFrame]),e},getTextureSourceIndex:function(t){for(var e=0;e<this.source.length;e++)if(this.source[e]===t)return e;return-1},getFramesFromTextureSource:function(t,e){void 0===e&&(e=!1);var n=[];for(var i in this.frames)if("__BASE"!==i||e){var r=this.frames[i];r.sourceIndex===t&&n.push(r)}return n},getFrameNames:function(t){void 0===t&&(t=!1);var e=Object.keys(this.frames);if(!t){var n=e.indexOf("__BASE");-1!==n&&e.splice(n,1)}return e},getSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e=this.frames[t];return e?e.source.image:(console.warn("Texture.frame missing: "+t),this.frames.__BASE.source.image)},getDataSourceImage:function(t){null!=t&&1!==this.frameTotal||(t="__BASE");var e,n=this.frames[t];return n?e=n.sourceIndex:(console.warn("Texture.frame missing: "+t),e=this.frames.__BASE.sourceIndex),this.dataSource[e].image},setDataSource:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=this.source[e];this.dataSource.push(new s(this,t[e],n.width,n.height))}},setFilter:function(t){var e;for(e=0;e<this.source.length;e++)this.source[e].setFilter(t);for(e=0;e<this.dataSource.length;e++)this.dataSource[e].setFilter(t)},destroy:function(){var t;for(t=0;t<this.source.length;t++)this.source[t].destroy();for(t=0;t<this.dataSource.length;t++)this.dataSource[t].destroy();for(var e in this.frames)this.frames[e].destroy();this.source=[],this.dataSource=[],this.frames={},this.manager.removeKey(this.key),this.manager=null}});t.exports=o},function(t,e,n){t.exports={Matrix:n(891),Add:n(898),AddAt:n(899),BringToTop:n(900),CountAllMatching:n(901),Each:n(902),EachInRange:n(903),FindClosestInSorted:n(251),GetAll:n(904),GetFirst:n(905),GetRandom:n(182),MoveDown:n(906),MoveTo:n(907),MoveUp:n(908),NumberArray:n(909),NumberArrayStep:n(910),QuickSelect:n(367),Range:n(368),Remove:n(119),RemoveAt:n(911),RemoveBetween:n(912),RemoveRandomElement:n(913),Replace:n(914),RotateLeft:n(267),RotateRight:n(268),SafeRange:n(67),SendToBack:n(915),SetAll:n(916),Shuffle:n(112),SpliceOne:n(79),StableSort:n(126),Swap:n(917)}},function(t,e){t.exports=function(t){if(!Array.isArray(t)||t.length<2||!Array.isArray(t[0]))return!1;for(var e=t[0].length,n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var i=e+Math.floor(Math.random()*n);return void 0===t[i]?null:t[i]}},function(t,e,n){var i=n(0),r=n(9),s=n(919),o=new i({Extends:r,initialize:function(){r.call(this),this._pending=[],this._active=[],this._destroy=[],this._toProcess=0},add:function(t){return this._pending.push(t),this._toProcess++,t},remove:function(t){return this._destroy.push(t),this._toProcess++,t},removeAll:function(){for(var t=this._active,e=this._destroy,n=t.length;n--;)e.push(t[n]),this._toProcess++;return this},update:function(){if(0===this._toProcess)return this._active;var t,e,n=this._destroy,i=this._active;for(t=0;t<n.length;t++){var r=i.indexOf(e=n[t]);-1!==r&&(i.splice(r,1),this.emit(s.REMOVE,e))}for(n.length=0,n=this._pending,t=0;t<n.length;t++)this._active.push(e=n[t]),this.emit(s.ADD,e);return n.length=0,this._toProcess=0,this._active},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0,this._pending=[],this._active=[],this._destroy=[]}});t.exports=o},function(t,e){function n(t,e){return parseInt(t.getAttribute(e),10)}t.exports=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0);var s={},o=t.getElementsByTagName("info")[0],a=t.getElementsByTagName("common")[0];s.font=o.getAttribute("face"),s.size=n(o,"size"),s.lineHeight=n(a,"lineHeight")+i,s.chars={};var u=t.getElementsByTagName("char"),l=void 0!==r&&r.trimmed;if(l)var c=r.height,h=r.width;for(var d=0;d<u.length;d++){var f=u[d],p=n(f,"id"),m=n(f,"x"),g=n(f,"y"),y=n(f,"width"),v=n(f,"height");l&&(m<h&&(h=m),g<c&&(c=g)),s.chars[p]={x:m,y:g,width:y,height:v,centerX:Math.floor(y/2),centerY:Math.floor(v/2),xOffset:n(f,"xoffset"),yOffset:n(f,"yoffset"),xAdvance:n(f,"xadvance")+e,data:{},kerning:{}}}if(l&&0!==c&&0!==h)for(var b in s.chars){var x=s.chars[b];x.x-=r.x,x.y-=r.y}var w=t.getElementsByTagName("kerning");for(d=0;d<w.length;d++){var T=w[d],S=n(T,"first"),E=n(T,"second"),O=n(T,"amount");s.chars[E].kerning[S]=O}return s}},function(t,e,n){var i=n(927),r=n(930),s=n(0),o=n(12),a=n(94),u=n(13),l=n(124),c=new s({Extends:u,Mixins:[o.Alpha,o.BlendMode,o.Depth,o.Mask,o.Pipeline,o.ScrollFactor,o.Size,o.Texture,o.Transform,o.Visible,i],initialize:function(t,e,n,i,r){u.call(this,t,"Blitter"),this.setTexture(i,r),this.setPosition(e,n),this.initPipeline(),this.children=new l,this.renderList=[],this.dirty=!1},create:function(t,e,n,i,s){void 0===i&&(i=!0),void 0===s&&(s=this.children.length),void 0===n?n=this.frame:n instanceof a||(n=this.texture.get(n));var o=new r(this,t,e,n,i);return this.children.addAt(o,s,!1),this.dirty=!0,o},createFromCallback:function(t,e,n,i){for(var r=this.createMultiple(e,n,i),s=0;s<r.length;s++)t.call(this,r[s],s);return r},createMultiple:function(t,e,n){void 0===e&&(e=this.frame.name),void 0===n&&(n=!0),Array.isArray(e)||(e=[e]);var i=[],r=this;return e.forEach(function(e){for(var s=0;s<t;s++)i.push(r.create(0,0,e,n))}),i},childCanRender:function(t){return t.visible&&t.alpha>0},getRenderList:function(){return this.dirty&&(this.renderList=this.children.list.filter(this.childCanRender,this),this.dirty=!1),this.renderList},clear:function(){this.children.removeAll(),this.dirty=!0},preDestroy:function(){this.children.destroy(),this.renderList=[]}});t.exports=c},function(t,e,n){var i=n(180),r=n(52),s=n(0),o=n(12),a=n(90),u=n(13),l=n(11),c=n(931),h=n(370),d=n(3),f=new s({Extends:u,Mixins:[o.Alpha,o.BlendMode,o.ComputedSize,o.Depth,o.Mask,o.Transform,o.Visible,c],initialize:function(t,e,n,i){u.call(this,t,"Container"),this.list=[],this.exclusive=!0,this.maxSize=-1,this.position=0,this.localTransform=new o.TransformMatrix,this.tempTransformMatrix=new o.TransformMatrix,this._displayList=t.sys.displayList,this._sortKey="",this._sysEvents=t.sys.events,this.scrollFactorX=1,this.scrollFactorY=1,this.setPosition(e,n),this.clearAlpha(),this.setBlendMode(r.SKIP_CHECK),i&&this.add(i)},originX:{get:function(){return.5}},originY:{get:function(){return.5}},displayOriginX:{get:function(){return.5*this.width}},displayOriginY:{get:function(){return.5*this.height}},setExclusive:function(t){return void 0===t&&(t=!0),this.exclusive=t,this},getBounds:function(t){if(void 0===t&&(t=new l),t.setTo(this.x,this.y,0,0),this.list.length>0)for(var e=this.list,n=new l,i=0;i<e.length;i++){var r=e[i];r.getBounds&&(r.getBounds(n),h(n,t,t))}return t},addHandler:function(t){t.once(a.DESTROY,this.remove,this),this.exclusive&&(this._displayList.remove(t),t.parentContainer&&t.parentContainer.remove(t),t.parentContainer=this)},removeHandler:function(t){t.off(a.DESTROY,this.remove),this.exclusive&&(t.parentContainer=null)},pointToContainer:function(t,e){if(void 0===e&&(e=new d),this.parentContainer)return this.parentContainer.pointToContainer(t,e);var n=this.tempTransformMatrix;return n.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY),n.invert(),n.transformPoint(t.x,t.y,e),e},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(t){return i.Add(this.list,t,this.maxSize,this.addHandler,this),this},addAt:function(t,e){return i.AddAt(this.list,t,e,this.maxSize,this.addHandler,this),this},getAt:function(t){return this.list[t]},getIndex:function(t){return this.list.indexOf(t)},sort:function(t,e){return t?(void 0===e&&(e=function(e,n){return e[t]-n[t]}),i.StableSort.inplace(this.list,e),this):this},getByName:function(t){return i.GetFirst(this.list,"name",t)},getRandom:function(t,e){return i.GetRandom(this.list,t,e)},getFirst:function(t,e,n,r){return i.GetFirst(this.list,t,e,n,r)},getAll:function(t,e,n,r){return i.GetAll(this.list,t,e,n,r)},count:function(t,e,n,r){return i.CountAllMatching(this.list,t,e,n,r)},swap:function(t,e){return i.Swap(this.list,t,e),this},moveTo:function(t,e){return i.MoveTo(this.list,t,e),this},remove:function(t,e){var n=i.Remove(this.list,t,this.removeHandler,this);if(e&&n){Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++)n[r].destroy()}return this},removeAt:function(t,e){var n=i.RemoveAt(this.list,t,this.removeHandler,this);return e&&n&&n.destroy(),this},removeBetween:function(t,e,n){var r=i.RemoveBetween(this.list,t,e,this.removeHandler,this);if(n)for(var s=0;s<r.length;s++)r[s].destroy();return this},removeAll:function(t){var e=i.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(t)for(var n=0;n<e.length;n++)e[n].destroy();return this},bringToTop:function(t){return i.BringToTop(this.list,t),this},sendToBack:function(t){return i.SendToBack(this.list,t),this},moveUp:function(t){return i.MoveUp(this.list,t),this},moveDown:function(t){return i.MoveDown(this.list,t),this},reverse:function(){return this.list.reverse(),this},shuffle:function(){return i.Shuffle(this.list),this},replace:function(t,e,n){return i.Replace(this.list,t,e)&&(this.addHandler(e),this.removeHandler(t),n&&t.destroy()),this},exists:function(t){return this.list.indexOf(t)>-1},setAll:function(t,e,n,r){return i.SetAll(this.list,t,e,n,r),this},each:function(t,e){var n,i=[null],r=this.list.slice(),s=r.length;for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<s;n++)i[0]=r[n],t.apply(e,i);return this},iterate:function(t,e){var n,i=[null];for(n=2;n<arguments.length;n++)i.push(arguments[n]);for(n=0;n<this.list.length;n++)i[0]=this.list[n],t.apply(e,i);return this},setScrollFactor:function(t,e,n){return void 0===e&&(e=t),void 0===n&&(n=!1),this.scrollFactorX=t,this.scrollFactorY=e,n&&(i.SetAll(this.list,"scrollFactorX",t),i.SetAll(this.list,"scrollFactorY",e)),this},length:{get:function(){return this.list.length}},first:{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}},last:{get:function(){return this.list.length>0?(this.position=this.list.length-1,this.list[this.position]):null}},next:{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}},previous:{get:function(){return this.position>0?(this.position--,this.list[this.position]):null}},preDestroy:function(){this.removeAll(!!this.exclusive),this.localTransform.destroy(),this.tempTransformMatrix.destroy(),this.list=[],this._displayList=null}});t.exports=f},function(t,e,n){var i=n(127),r=n(0),s=n(936),o=new r({Extends:i,Mixins:[s],initialize:function(t,e,n,r,s,o,a){i.call(this,t,e,n,r,s,o,a),this.type="DynamicBitmapText",this.scrollX=0,this.scrollY=0,this.cropWidth=0,this.cropHeight=0,this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(t,e){return this.cropWidth=t,this.cropHeight=e,this},setDisplayCallback:function(t){return this.displayCallback=t,this},setScrollX:function(t){return this.scrollX=t,this},setScrollY:function(t){return this.scrollY=t,this}});t.exports=o},function(t,e,n){var i=n(91),r=n(0),s=n(189),o=n(250),a=n(253),u=n(254),l=n(258),c=n(151),h=n(263),d=n(264),f=n(261),p=n(32),m=n(95),g=n(13),y=n(2),v=n(6),b=n(23),x=n(942),w=new r({Extends:g,Mixins:[o,a,u,l,c,h,d,f,x],initialize:function(t,e){var n=v(e,"x",0),i=v(e,"y",0);g.call(this,t,"Graphics"),this.setPosition(n,i),this.initPipeline(),this.displayOriginX=0,this.displayOriginY=0,this.commandBuffer=[],this.defaultFillColor=-1,this.defaultFillAlpha=1,this.defaultStrokeWidth=1,this.defaultStrokeColor=-1,this.defaultStrokeAlpha=1,this._lineWidth=1,this._tempMatrix1=new p,this._tempMatrix2=new p,this._tempMatrix3=new p,this.setDefaultStyles(e)},setDefaultStyles:function(t){return v(t,"lineStyle",null)&&(this.defaultStrokeWidth=v(t,"lineStyle.width",1),this.defaultStrokeColor=v(t,"lineStyle.color",16777215),this.defaultStrokeAlpha=v(t,"lineStyle.alpha",1),this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)),v(t,"fillStyle",null)&&(this.defaultFillColor=v(t,"fillStyle.color",16777215),this.defaultFillAlpha=v(t,"fillStyle.alpha",1),this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)),this},lineStyle:function(t,e,n){return void 0===n&&(n=1),this.commandBuffer.push(s.LINE_STYLE,t,e,n),this._lineWidth=t,this},fillStyle:function(t,e){return void 0===e&&(e=1),this.commandBuffer.push(s.FILL_STYLE,t,e),this},fillGradientStyle:function(t,e,n,i,r){return void 0===r&&(r=1),this.commandBuffer.push(s.GRADIENT_FILL_STYLE,r,t,e,n,i),this},lineGradientStyle:function(t,e,n,i,r,o){return void 0===o&&(o=1),this.commandBuffer.push(s.GRADIENT_LINE_STYLE,t,o,e,n,i,r),this},setTexture:function(t,e,n){if(void 0===n&&(n=0),void 0===t)this.commandBuffer.push(s.CLEAR_TEXTURE);else{var i=this.scene.sys.textures.getFrame(t,e);i&&(2===n&&(n=3),this.commandBuffer.push(s.SET_TEXTURE,i,n))}return this},beginPath:function(){return this.commandBuffer.push(s.BEGIN_PATH),this},closePath:function(){return this.commandBuffer.push(s.CLOSE_PATH),this},fillPath:function(){return this.commandBuffer.push(s.FILL_PATH),this},fill:function(){return this.commandBuffer.push(s.FILL_PATH),this},strokePath:function(){return this.commandBuffer.push(s.STROKE_PATH),this},stroke:function(){return this.commandBuffer.push(s.STROKE_PATH),this},fillCircleShape:function(t){return this.fillCircle(t.x,t.y,t.radius)},strokeCircleShape:function(t){return this.strokeCircle(t.x,t.y,t.radius)},fillCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,b.PI2),this.fillPath(),this},strokeCircle:function(t,e,n){return this.beginPath(),this.arc(t,e,n,0,b.PI2),this.strokePath(),this},fillRectShape:function(t){return this.fillRect(t.x,t.y,t.width,t.height)},strokeRectShape:function(t){return this.strokeRect(t.x,t.y,t.width,t.height)},fillRect:function(t,e,n,i){return this.commandBuffer.push(s.FILL_RECT,t,e,n,i),this},strokeRect:function(t,e,n,i){var r=this._lineWidth/2,s=t-r,o=t+r;return this.beginPath(),this.moveTo(t,e),this.lineTo(t,e+i),this.strokePath(),this.beginPath(),this.moveTo(t+n,e),this.lineTo(t+n,e+i),this.strokePath(),this.beginPath(),this.moveTo(s,e),this.lineTo(o+n,e),this.strokePath(),this.beginPath(),this.moveTo(s,e+i),this.lineTo(o+n,e+i),this.strokePath(),this},fillRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,u=r;return"number"!=typeof r&&(s=y(r,"tl",20),o=y(r,"tr",20),a=y(r,"bl",20),u=y(r,"br",20)),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),this.arc(t+n-o,e+o,o,-b.TAU,0),this.lineTo(t+n,e+i-u),this.arc(t+n-u,e+i-u,u,0,b.TAU),this.lineTo(t+a,e+i),this.arc(t+a,e+i-a,a,b.TAU,Math.PI),this.lineTo(t,e+s),this.arc(t+s,e+s,s,-Math.PI,-b.TAU),this.fillPath(),this},strokeRoundedRect:function(t,e,n,i,r){void 0===r&&(r=20);var s=r,o=r,a=r,u=r;return"number"!=typeof r&&(s=y(r,"tl",20),o=y(r,"tr",20),a=y(r,"bl",20),u=y(r,"br",20)),this.beginPath(),this.moveTo(t+s,e),this.lineTo(t+n-o,e),this.arc(t+n-o,e+o,o,-b.TAU,0),this.lineTo(t+n,e+i-u),this.arc(t+n-u,e+i-u,u,0,b.TAU),this.lineTo(t+a,e+i),this.arc(t+a,e+i-a,a,b.TAU,Math.PI),this.lineTo(t,e+s),this.arc(t+s,e+s,s,-Math.PI,-b.TAU),this.strokePath(),this},fillPointShape:function(t,e){return this.fillPoint(t.x,t.y,e)},fillPoint:function(t,e,n){return!n||n<1?n=1:(t-=n/2,e-=n/2),this.commandBuffer.push(s.FILL_RECT,t,e,n,n),this},fillTriangleShape:function(t){return this.fillTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},strokeTriangleShape:function(t){return this.strokeTriangle(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)},fillTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.FILL_TRIANGLE,t,e,n,i,r,o),this},strokeTriangle:function(t,e,n,i,r,o){return this.commandBuffer.push(s.STROKE_TRIANGLE,t,e,n,i,r,o),this},strokeLineShape:function(t){return this.lineBetween(t.x1,t.y1,t.x2,t.y2)},lineBetween:function(t,e,n,i){return this.beginPath(),this.moveTo(t,e),this.lineTo(n,i),this.strokePath(),this},lineTo:function(t,e){return this.commandBuffer.push(s.LINE_TO,t,e),this},moveTo:function(t,e){return this.commandBuffer.push(s.MOVE_TO,t,e),this},strokePoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.strokePath(),this},fillPoints:function(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=t.length),this.beginPath(),this.moveTo(t[0].x,t[0].y);for(var r=1;r<i;r++)this.lineTo(t[r].x,t[r].y);return e&&this.lineTo(t[0].x,t[0].y),n&&this.closePath(),this.fillPath(),this},strokeEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.strokePoints(n,!0)},strokeEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new m(t,e,n,i).getPoints(r);return this.strokePoints(s,!0)},fillEllipseShape:function(t,e){void 0===e&&(e=32);var n=t.getPoints(e);return this.fillPoints(n,!0)},fillEllipse:function(t,e,n,i,r){void 0===r&&(r=32);var s=new m(t,e,n,i).getPoints(r);return this.fillPoints(s,!0)},arc:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this},slice:function(t,e,n,i,r,o,a){return void 0===o&&(o=!1),void 0===a&&(a=0),this.commandBuffer.push(s.BEGIN_PATH),this.commandBuffer.push(s.MOVE_TO,t,e),this.commandBuffer.push(s.ARC,t,e,n,i,r,o,a),this.commandBuffer.push(s.CLOSE_PATH),this},save:function(){return this.commandBuffer.push(s.SAVE),this},restore:function(){return this.commandBuffer.push(s.RESTORE),this},translateCanvas:function(t,e){return this.commandBuffer.push(s.TRANSLATE,t,e),this},scaleCanvas:function(t,e){return this.commandBuffer.push(s.SCALE,t,e),this},rotateCanvas:function(t){return this.commandBuffer.push(s.ROTATE,t),this},clear:function(){return this.commandBuffer.length=0,this.defaultFillColor>-1&&this.fillStyle(this.defaultFillColor,this.defaultFillAlpha),this.defaultStrokeColor>-1&&this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha),this},generateTexture:function(t,e,n){var i,r,s=this.scene.sys,o=s.game.renderer;if(void 0===e&&(e=s.scale.width),void 0===n&&(n=s.scale.height),w.TargetCamera.setScene(this.scene),w.TargetCamera.setViewport(0,0,e,n),w.TargetCamera.scrollX=this.x,w.TargetCamera.scrollY=this.y,"string"==typeof t)if(s.textures.exists(t)){var a=(i=s.textures.get(t)).getSourceImage();a instanceof HTMLCanvasElement&&(r=a.getContext("2d"))}else r=(i=s.textures.createCanvas(t,e,n)).getSourceImage().getContext("2d");else t instanceof HTMLCanvasElement&&(r=t.getContext("2d"));return r&&(this.renderCanvas(o,this,0,w.TargetCamera,null,r,!1),i&&i.refresh()),this},preDestroy:function(){this.commandBuffer=[]}});w.TargetCamera=new i,t.exports=w},function(t,e){t.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,SET_TEXTURE:19,CLEAR_TEXTURE:20,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.height/2;return n.x=t.x+t.width/2*Math.cos(e),n.y=t.y+r*Math.sin(e),n}},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(378),a=n(124),u=n(380),l=n(952),c=new i({Extends:s,Mixins:[r.Depth,r.Mask,r.Pipeline,r.Transform,r.Visible,l],initialize:function(t,e,n,i){if(s.call(this,t,"ParticleEmitterManager"),this.blendMode=-1,this.timeScale=1,this.texture=null,this.frame=null,this.frameNames=[],null===n||"object"!=typeof n&&!Array.isArray(n)||(i=n,n=null),this.setTexture(e,n),this.initPipeline(),this.emitters=new a(this),this.wells=new a(this),i){Array.isArray(i)||(i=[i]);for(var r=0;r<i.length;r++)this.createEmitter(i[r])}},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){this.frame=this.texture.get(t);var e=[];return this.texture.getFramesFromTextureSource(this.frame.sourceIndex).forEach(function(t){e.push(t.name)}),this.frameNames=e,this.defaultFrame=this.frame,this},setEmitterFrames:function(t,e){Array.isArray(t)||(t=[t]);var n=e.frames;n.length=0;for(var i=0;i<t.length;i++){var r=t[i];-1!==this.frameNames.indexOf(r)&&n.push(this.texture.get(r))}return e.defaultFrame=n.length>0?n[0]:this.defaultFrame,this},addEmitter:function(t){return this.emitters.add(t)},createEmitter:function(t){return this.addEmitter(new u(this,t))},addGravityWell:function(t){return this.wells.add(t)},createGravityWell:function(t){return this.addGravityWell(new o(t))},emitParticle:function(t,e,n){for(var i=this.emitters.list,r=0;r<i.length;r++){var s=i[r];s.active&&s.emitParticle(t,e,n)}return this},emitParticleAt:function(t,e,n){return this.emitParticle(n,t,e)},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},getProcessors:function(){return this.wells.getAll("active",!0)},preUpdate:function(t,e){e*=this.timeScale;for(var n=this.emitters.list,i=0;i<n.length;i++){var r=n[i];r.active&&r.preUpdate(t,e)}},setAlpha:function(){},setScrollFactor:function(){},setBlendMode:function(){}});t.exports=c},function(t,e,n){var i=n(52),r=n(91),s=n(25),o=n(0),a=n(12),u=n(29),l=n(94),c=n(13),h=n(956),d=n(10),f=n(193),p=new o({Extends:c,Mixins:[a.Alpha,a.BlendMode,a.ComputedSize,a.Crop,a.Depth,a.Flip,a.GetBounds,a.Mask,a.Origin,a.Pipeline,a.ScrollFactor,a.Tint,a.Transform,a.Visible,h],initialize:function(t,e,n,i,o,a,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=32),void 0===o&&(o=32),c.call(this,t,"RenderTexture"),this.renderer=t.sys.game.renderer,this.textureManager=t.sys.textures,this.globalTint=16777215,this.globalAlpha=1,this.canvas=null,this.framebuffer=null,this.dirty=!1,this._crop=this.resetCropObject(),this.texture=null,this.frame=null,this._saved=!1,void 0===a?(this.canvas=s.create2D(this,i,o),this.texture=t.sys.textures.addCanvas(f(),this.canvas),this.frame=this.texture.get()):(this.texture=t.sys.textures.get(a),this.frame=this.texture.get(l),this.canvas=this.frame.source.image,this._saved=!0,this.dirty=!0,this.width=this.frame.cutWidth,this.height=this.frame.cutHeight),this.context=this.canvas.getContext("2d"),this._eraseMode=!1,this.camera=new r(0,0,i,o),this.gl=null,this.glTexture=null;var h=this.renderer;h.type===u.WEBGL?(this.gl=h.gl,this.glTexture=this.frame.source.glTexture,this.drawGameObject=this.batchGameObjectWebGL,this.framebuffer=h.createFramebuffer(i,o,this.glTexture,!1)):h.type===u.CANVAS&&(this.drawGameObject=this.batchGameObjectCanvas),this.camera.setScene(t),this.setPosition(e,n),void 0===a&&this.setSize(i,o),this.setOrigin(0,0),this.initPipeline()},setSize:function(t,e){return this.resize(t,e)},resize:function(t,e){if(void 0===e&&(e=t),t!==this.width||e!==this.height){if("__BASE"===this.frame.name){if(this.canvas.width=t,this.canvas.height=e,this.texture.width=t,this.texture.height=e,this.gl){var n=this.gl;this.renderer.deleteTexture(this.frame.source.glTexture),this.renderer.deleteFramebuffer(this.framebuffer);var i=this.renderer.createTexture2D(0,n.NEAREST,n.NEAREST,n.CLAMP_TO_EDGE,n.CLAMP_TO_EDGE,n.RGBA,null,t,e,!1);this.framebuffer=this.renderer.createFramebuffer(t,e,i,!1),this.frame.source.isRenderTexture=!0,this.frame.glTexture=i,this.glTexture=i}this.frame.source.width=t,this.frame.source.height=e,this.camera.setSize(t,e),this.frame.setSize(t,e),this.width=t,this.height=e}}else{var r=this.texture.getSourceImage();this.frame.cutX+t>r.width&&(t=r.width-this.frame.cutX),this.frame.cutY+e>r.height&&(e=r.height-this.frame.cutY),this.frame.setSize(t,e,this.frame.cutX,this.frame.cutY)}this.updateDisplayOrigin();var s=this.input;return s&&!s.customHitArea&&(s.hitArea.width=t,s.hitArea.height=e),this},setGlobalTint:function(t){return this.globalTint=t,this},setGlobalAlpha:function(t){return this.globalAlpha=t,this},saveTexture:function(t){return this.textureManager.renameTexture(this.texture.key,t),this._saved=!0,this.texture},fill:function(t,e,n,i,r,s){void 0===e&&(e=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.frame.cutWidth),void 0===s&&(s=this.frame.cutHeight);var o=255&(t>>16|0),a=255&(t>>8|0),u=255&(0|t),l=this.gl,c=this.frame;if(this.camera.preRender(1,1),l){var h=this.camera._cx,f=this.camera._cy,p=this.camera._cw,m=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,!1),this.renderer.pushScissor(h,f,p,m,m);var g=this.pipeline;g.projOrtho(0,this.texture.width,0,this.texture.height,-1e3,1e3),g.drawFillRect(n,i,r,s,d.getTintFromFloats(o/255,a/255,u/255,1),e),this.renderer.setFramebuffer(null,!1),this.renderer.popScissor(),g.projOrtho(0,g.width,g.height,0,-1e3,1e3)}else this.renderer.setContext(this.context),this.context.fillStyle="rgba("+o+","+a+","+u+","+e+")",this.context.fillRect(n+c.cutX,i+c.cutY,r,s),this.renderer.setContext();return this.dirty=!0,this},clear:function(){if(this.dirty){var t=this.gl;if(t){var e=this.renderer;e.setFramebuffer(this.framebuffer,!0),this.frame.cutWidth===this.canvas.width&&this.frame.cutHeight===this.canvas.height||t.scissor(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),e.setFramebuffer(null,!0)}else{var n=this.context;n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight),n.restore()}this.dirty=!1}return this},erase:function(t,e,n){this._eraseMode=!0;var r=this.renderer.currentBlendMode;return this.renderer.setBlendMode(i.ERASE),this.draw(t,e,n,1,16777215),this.renderer.setBlendMode(r),this._eraseMode=!1,this},draw:function(t,e,n,i,r){void 0===i&&(i=this.globalAlpha),r=void 0===r?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(r>>16)+(65280&r)+((255&r)<<16),Array.isArray(t)||(t=[t]);var s=this.gl;if(this.camera.preRender(1,1),s){var o=this.camera._cx,a=this.camera._cy,u=this.camera._cw,l=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,!1),this.renderer.pushScissor(o,a,u,l,l);var c=this.pipeline;c.projOrtho(0,this.texture.width,0,this.texture.height,-1e3,1e3),this.batchList(t,e,n,i,r),c.flush(),this.renderer.setFramebuffer(null,!1),this.renderer.popScissor(),c.projOrtho(0,c.width,c.height,0,-1e3,1e3)}else this.renderer.setContext(this.context),this.batchList(t,e,n,i,r),this.renderer.setContext();return this.dirty=!0,this},drawFrame:function(t,e,n,i,r,s){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.globalAlpha),s=void 0===s?(this.globalTint>>16)+(65280&this.globalTint)+((255&this.globalTint)<<16):(s>>16)+(65280&s)+((255&s)<<16);var o=this.gl,a=this.textureManager.getFrame(t,e);if(a){if(this.camera.preRender(1,1),o){var u=this.camera._cx,l=this.camera._cy,c=this.camera._cw,h=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,!1),this.renderer.pushScissor(u,l,c,h,h);var d=this.pipeline;d.projOrtho(0,this.texture.width,0,this.texture.height,-1e3,1e3),d.batchTextureFrame(a,n+this.frame.cutX,i+this.frame.cutY,s,r,this.camera.matrix,null),d.flush(),this.renderer.setFramebuffer(null,!1),this.renderer.popScissor(),d.projOrtho(0,d.width,d.height,0,-1e3,1e3)}else this.batchTextureFrame(a,n+this.frame.cutX,i+this.frame.cutY,r,s);this.dirty=!0}return this},batchList:function(t,e,n,i,r){for(var s=0;s<t.length;s++){var o=t[s];o&&o!==this&&(o.renderWebGL||o.renderCanvas?this.drawGameObject(o,e,n):o.isParent||o.list?this.batchGroup(o.getChildren(),e,n):"string"==typeof o?this.batchTextureFrameKey(o,null,e,n,i,r):o instanceof l?this.batchTextureFrame(o,e,n,i,r):Array.isArray(o)&&this.batchList(o,e,n,i,r))}},batchGroup:function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),e+=this.frame.cutX,n+=this.frame.cutY;for(var i=0;i<t.length;i++){var r=t[i];r.willRender()&&this.drawGameObject(r,r.x+e,r.y+n)}},batchGameObjectWebGL:function(t,e,n){void 0===e&&(e=t.x),void 0===n&&(n=t.y);var i=t.x,r=t.y;this._eraseMode||this.renderer.setBlendMode(t.blendMode),t.setPosition(e+this.frame.cutX,n+this.frame.cutY),t.renderWebGL(this.renderer,t,0,this.camera,null),t.setPosition(i,r)},batchGameObjectCanvas:function(t,e,n){void 0===e&&(e=t.x),void 0===n&&(n=t.y);var r=t.x,s=t.y;if(this._eraseMode){var o=t.blendMode;t.blendMode=i.ERASE}t.setPosition(e+this.frame.cutX,n+this.frame.cutY),t.renderCanvas(this.renderer,t,0,this.camera,null),t.setPosition(r,s),this._eraseMode&&(t.blendMode=o)},batchTextureFrameKey:function(t,e,n,i,r,s){var o=this.textureManager.getFrame(t,e);o&&this.batchTextureFrame(o,n,i,r,s)},batchTextureFrame:function(t,e,n,i,r){if(void 0===e&&(e=0),void 0===n&&(n=0),e+=this.frame.cutX,n+=this.frame.cutY,this.gl)this.pipeline.batchTextureFrame(t,e,n,r,i,this.camera.matrix,null);else{var s=this.context,o=t.canvasData,a=t.source.image,u=this.camera.matrix;s.globalAlpha=this.globalAlpha,s.setTransform(u[0],u[1],u[2],u[3],u[4],u[5]),s.drawImage(a,o.x,o.y,o.width,o.height,e,n,o.width,o.height)}},snapshotArea:function(t,e,n,i,r,s,o){return this.gl?this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,r,!1,t,e,n,i,s,o):this.renderer.snapshotCanvas(this.canvas,r,!1,t,e,n,i,s,o),this},snapshot:function(t,e,n){return this.gl?this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,t,!1,0,0,this.width,this.height,e,n):this.renderer.snapshotCanvas(this.canvas,t,!1,0,0,this.width,this.height,e,n),this},snapshotPixel:function(t,e,n){return this.gl?this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,n,!0,t,e):this.renderer.snapshotCanvas(this.canvas,n,!0,t,e),this},preDestroy:function(){this._saved||(s.remove(this.canvas),this.gl&&this.renderer.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.camera.destroy(),this.canvas=null,this.context=null,this.framebuffer=null,this.texture=null,this.glTexture=null)}});t.exports=p},function(t,e){t.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}},function(t,e,n){var i=n(118),r=n(25),s=n(0),o=n(12),a=n(17),u=n(13),l=n(962),c=n(6),h=n(175),d=n(963),f=n(966),p=new s({Extends:u,Mixins:[o.Alpha,o.BlendMode,o.ComputedSize,o.Crop,o.Depth,o.Flip,o.GetBounds,o.Mask,o.Origin,o.Pipeline,o.ScrollFactor,o.Tint,o.Transform,o.Visible,d],initialize:function(t,e,n,i,s){void 0===e&&(e=0),void 0===n&&(n=0),u.call(this,t,"Text"),this.renderer=t.sys.game.renderer,this.setPosition(e,n),this.setOrigin(0,0),this.initPipeline(),this.canvas=r.create(this),this.context=this.canvas.getContext("2d"),this.style=new f(this,s),this.autoRound=!0,this.splitRegExp=/(?:\r\n|\r|\n)/,this._text=void 0,this.padding={left:0,right:0,top:0,bottom:0},this.width=1,this.height=1,this.lineSpacing=0,this.dirty=!1,0===this.style.resolution&&(this.style.resolution=t.sys.game.config.resolution),this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.frame.source.resolution=this.style.resolution,this.renderer&&this.renderer.gl&&(this.renderer.deleteTexture(this.frame.source.glTexture),this.frame.source.glTexture=null),this.initRTL(),this.setText(i),s&&s.padding&&this.setPadding(s.padding),s&&s.lineSpacing&&(this.lineSpacing=s.lineSpacing),t.sys.game.events.on(a.CONTEXT_RESTORED,function(){this.dirty=!0},this)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",i(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(t){var e=this.style;if(e.wordWrapCallback){var n=e.wordWrapCallback.call(e.wordWrapCallbackScope,t,this);return Array.isArray(n)&&(n=n.join("\n")),n}return e.wordWrapWidth?e.wordWrapUseAdvanced?this.advancedWordWrap(t,this.context,this.style.wordWrapWidth):this.basicWordWrap(t,this.context,this.style.wordWrapWidth):t},advancedWordWrap:function(t,e,n){for(var i="",r=t.replace(/ +/gi," ").split(this.splitRegExp),s=r.length,o=0;o<s;o++){var a=r[o],u="";if(a=a.replace(/^ *|\s*$/gi,""),e.measureText(a).width<n)i+=a+"\n";else{for(var l=n,c=a.split(" "),h=0;h<c.length;h++){var d=c[h],f=d+" ",p=e.measureText(f).width;if(p>l){if(0===h){for(var m=f;m.length&&(m=m.slice(0,-1),!((p=e.measureText(m).width)<=l)););if(!m.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var g=d.substr(m.length);c[h]=g,u+=m}var y=c.slice(c[h].length?h:h+1).join(" ").replace(/[ \n]*$/gi,"");r[o+1]=y+" "+(r[o+1]||""),s=r.length;break}u+=f,l-=p}i+=u.replace(/[ \n]*$/gi,"")+"\n"}}return i.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(t,e,n){for(var i="",r=t.split(this.splitRegExp),s=0;s<r.length;s++){for(var o=n,a=r[s].split(" "),u=0;u<a.length;u++){var l=e.measureText(a[u]).width+e.measureText(" ").width;l>o?(u>0&&(i+="\n"),i+=a[u]+" ",o=n-l):(o-=l,i+=a[u],u<a.length-1&&(i+=" "))}s<r.length-1&&(i+="\n")}return i},getWrappedText:function(t){return void 0===t&&(t=this._text),this.style.syncFont(this.canvas,this.context),this.runWordWrap(t).split(this.splitRegExp)},setText:function(t){return t||0===t||(t=""),Array.isArray(t)&&(t=t.join("\n")),t!==this._text&&(this._text=t.toString(),this.updateText()),this},setStyle:function(t){return this.style.setStyle(t)},setFont:function(t){return this.style.setFont(t)},setFontFamily:function(t){return this.style.setFontFamily(t)},setFontSize:function(t){return this.style.setFontSize(t)},setFontStyle:function(t){return this.style.setFontStyle(t)},setFixedSize:function(t,e){return this.style.setFixedSize(t,e)},setBackgroundColor:function(t){return this.style.setBackgroundColor(t)},setFill:function(t){return this.style.setFill(t)},setColor:function(t){return this.style.setColor(t)},setStroke:function(t,e){return this.style.setStroke(t,e)},setShadow:function(t,e,n,i,r,s){return this.style.setShadow(t,e,n,i,r,s)},setShadowOffset:function(t,e){return this.style.setShadowOffset(t,e)},setShadowColor:function(t){return this.style.setShadowColor(t)},setShadowBlur:function(t){return this.style.setShadowBlur(t)},setShadowStroke:function(t){return this.style.setShadowStroke(t)},setShadowFill:function(t){return this.style.setShadowFill(t)},setWordWrapWidth:function(t,e){return this.style.setWordWrapWidth(t,e)},setWordWrapCallback:function(t,e){return this.style.setWordWrapCallback(t,e)},setAlign:function(t){return this.style.setAlign(t)},setResolution:function(t){return this.style.setResolution(t)},setLineSpacing:function(t){return this.lineSpacing=t,this.updateText()},setPadding:function(t,e,n,i){if("object"==typeof t){var r=t,s=c(r,"x",null);null!==s?(t=s,n=s):(t=c(r,"left",0),n=c(r,"right",t));var o=c(r,"y",null);null!==o?(e=o,i=o):(e=c(r,"top",0),i=c(r,"bottom",e))}else void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=t),void 0===i&&(i=e);return this.padding.left=t,this.padding.top=e,this.padding.right=n,this.padding.bottom=i,this.updateText()},setMaxLines:function(t){return this.style.setMaxLines(t)},updateText:function(){var t=this.canvas,e=this.context,n=this.style,i=n.resolution,r=n.metrics;n.syncFont(t,e);var s=this._text;(n.wordWrapWidth||n.wordWrapCallback)&&(s=this.runWordWrap(this._text));var o,a=s.split(this.splitRegExp),u=l(this,r,a),c=this.padding;0===n.fixedWidth?(this.width=u.width+c.left+c.right,o=u.width):(this.width=n.fixedWidth,(o=this.width-c.left-c.right)<u.width&&(o=u.width)),this.height=0===n.fixedHeight?u.height+c.top+c.bottom:n.fixedHeight;var h,d,f=this.width,p=this.height;this.updateDisplayOrigin(),f*=i,p*=i,f=Math.max(f,1),p=Math.max(p,1),t.width!==f||t.height!==p?(t.width=f,t.height=p,this.frame.setSize(f,p),n.syncFont(t,e)):e.clearRect(0,0,f,p),e.save(),e.scale(i,i),n.backgroundColor&&(e.fillStyle=n.backgroundColor,e.fillRect(0,0,f,p)),n.syncStyle(t,e),e.textBaseline="alphabetic",e.translate(c.left,c.top);for(var m=0;m<u.lines;m++){if(h=n.strokeThickness/2,d=n.strokeThickness/2+m*u.lineHeight+r.ascent,m>0&&(d+=u.lineSpacing*m),n.rtl)h=f-h;else if("right"===n.align)h+=o-u.lineWidths[m];else if("center"===n.align)h+=(o-u.lineWidths[m])/2;else if("justify"===n.align&&u.lineWidths[m]/u.width>=.85){for(var g=u.width-u.lineWidths[m],y=e.measureText(" ").width,v=a[m].trim(),b=v.split(" "),x=Math.floor((g+=(a[m].length-v.length)*y)/y),w=0;x>0;)b[w]+=" ",w=(w+1)%(b.length-1||1),--x;a[m]=b.join(" ")}this.autoRound&&(h=Math.round(h),d=Math.round(d)),n.strokeThickness&&(this.style.syncShadow(e,n.shadowStroke),e.strokeText(a[m],h,d)),n.color&&(this.style.syncShadow(e,n.shadowFill),e.fillText(a[m],h,d))}e.restore(),this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(t,this.frame.source.glTexture,!0),this.frame.glTexture=this.frame.source.glTexture),this.dirty=!0;var T=this.input;return T&&!T.customHitArea&&(T.hitArea.width=this.width,T.hitArea.height=this.height),this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(t){this.setText(t)}},toJSON:function(){var t=o.ToJSON(this),e={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};return t.data=e,t},preDestroy:function(){this.style.rtl&&h(this.canvas),r.remove(this.canvas),this.texture.destroy()}});t.exports=p},function(t,e,n){var i=n(25),r=n(0),s=n(12),o=n(17),a=n(13),u=n(308),l=n(162),c=n(968),h=n(3),d=new r({Extends:a,Mixins:[s.Alpha,s.BlendMode,s.ComputedSize,s.Crop,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Tint,s.Transform,s.Visible,c],initialize:function(t,e,n,r,s,l,c){var d=t.sys.game.renderer;a.call(this,t,"TileSprite");var f=t.sys.textures.get(l),p=f.get(c);r&&s?(r=Math.floor(r),s=Math.floor(s)):(r=p.width,s=p.height),this._tilePosition=new h,this._tileScale=new h(1,1),this.dirty=!1,this.renderer=d,this.canvas=i.create(this,r,s),this.context=this.canvas.getContext("2d"),this.displayTexture=f,this.displayFrame=p,this._crop=this.resetCropObject(),this.texture=t.sys.textures.addCanvas(null,this.canvas,!0),this.frame=this.texture.get(),this.potWidth=u(p.width),this.potHeight=u(p.height),this.fillCanvas=i.create2D(this,this.potWidth,this.potHeight),this.fillContext=this.fillCanvas.getContext("2d"),this.fillPattern=null,this.setPosition(e,n),this.setSize(r,s),this.setFrame(c),this.setOriginFromFrame(),this.initPipeline(),t.sys.game.events.on(o.CONTEXT_RESTORED,function(t){var e=t.gl;this.dirty=!0,this.fillPattern=null,this.fillPattern=t.createTexture2D(0,e.LINEAR,e.LINEAR,e.REPEAT,e.REPEAT,e.RGBA,this.fillCanvas,this.potWidth,this.potHeight)},this)},setTexture:function(t,e){return this.displayTexture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t){return this.displayFrame=this.displayTexture.get(t),this.displayFrame.cutWidth&&this.displayFrame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.dirty=!0,this.updateTileTexture(),this},setTilePosition:function(t,e){return void 0!==t&&(this.tilePositionX=t),void 0!==e&&(this.tilePositionY=e),this},setTileScale:function(t,e){return void 0===t&&(t=this.tileScaleX),void 0===e&&(e=t),this.tileScaleX=t,this.tileScaleY=e,this},updateTileTexture:function(){if(this.dirty&&this.renderer){var t=this.displayFrame;if(t.source.isRenderTexture||t.source.isGLTexture)return console.warn("TileSprites can only use Image or Canvas based textures"),void(this.dirty=!1);var e=this.fillContext,n=this.fillCanvas,i=this.potWidth,r=this.potHeight;this.renderer.gl||(i=t.cutWidth,r=t.cutHeight),e.clearRect(0,0,i,r),n.width=i,n.height=r,e.drawImage(t.source.image,t.cutX,t.cutY,t.cutWidth,t.cutHeight,0,0,i,r),this.fillPattern=this.renderer.gl?this.renderer.canvasToTexture(n,this.fillPattern):e.createPattern(n,"repeat"),this.updateCanvas(),this.dirty=!1}},updateCanvas:function(){var t=this.canvas;if(t.width===this.width&&t.height===this.height||(t.width=this.width,t.height=this.height,this.frame.setSize(this.width,this.height),this.updateDisplayOrigin(),this.dirty=!0),!this.dirty||this.renderer&&this.renderer.gl)this.dirty=!1;else{var e=this.context;this.scene.sys.game.config.antialias||l.disable(e);var n=this._tileScale.x,i=this._tileScale.y,r=this._tilePosition.x,s=this._tilePosition.y;e.clearRect(0,0,this.width,this.height),e.save(),e.scale(n,i),e.translate(-r,-s),e.fillStyle=this.fillPattern,e.fillRect(r,s,this.width/n,this.height/i),e.restore(),this.dirty=!1}},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern),i.remove(this.canvas),i.remove(this.fillCanvas),this.fillPattern=null,this.fillContext=null,this.fillCanvas=null,this.displayTexture=null,this.displayFrame=null,this.texture.destroy(),this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(t){this._tilePosition.x=t,this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(t){this._tilePosition.y=t,this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(t){this._tileScale.x=t,this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},set:function(t){this._tileScale.y=t,this.dirty=!0}}});t.exports=d},function(t,e,n){var i=n(0),r=n(22),s=n(12),o=n(90),a=n(17),u=n(13),l=n(59),c=n(193),h=n(971),d=new i({Extends:u,Mixins:[s.Alpha,s.BlendMode,s.Depth,s.Flip,s.GetBounds,s.Mask,s.Origin,s.Pipeline,s.ScrollFactor,s.Size,s.TextureCrop,s.Tint,s.Transform,s.Visible,h],initialize:function(t,e,n,i){u.call(this,t,"Video"),this.video=null,this.videoTexture=null,this.videoTextureSource=null,this.snapshotTexture=null,this.flipY=!1,this._key=c(),this.touchLocked=!0,this.playWhenUnlocked=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._systemMuted=!1,this._codeMuted=!1,this._systemPaused=!1,this._codePaused=!1,this._callbacks={play:this.playHandler.bind(this),error:this.loadErrorHandler.bind(this),end:this.completeHandler.bind(this),time:this.timeUpdateHandler.bind(this),seeking:this.seekingHandler.bind(this),seeked:this.seekedHandler.bind(this)},this._crop=this.resetCropObject(),this.markers={},this._markerIn=-1,this._markerOut=Number.MAX_SAFE_INTEGER,this._lastUpdate=0,this._cacheKey="",this._isSeeking=!1,this.setPosition(e,n),this.initPipeline(),i&&this.changeSource(i,!1);var r=t.sys.game.events;r.on(a.PAUSE,this.globalPause,this),r.on(a.RESUME,this.globalResume,this);var s=t.sys.sound;s&&s.on(l.GLOBAL_MUTE,this.globalMute,this)},play:function(t,e,n){if(this.touchLocked&&this.playWhenUnlocked||this.isPlaying())return this;var i=this.video;if(!i)return console.warn("Video not loaded"),this;void 0===t&&(t=i.loop);var r=this.scene.sys.sound;r&&r.mute&&this.setMute(!0),isNaN(e)||(this._markerIn=e),!isNaN(n)&&n>e&&(this._markerOut=n),i.loop=t;var s=this._callbacks,o=i.play();return void 0!==o?o.then(this.playPromiseSuccessHandler.bind(this)).catch(this.playPromiseErrorHandler.bind(this)):(i.addEventListener("playing",s.play,!0),i.readyState<2&&(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval))),i.addEventListener("ended",s.end,!0),i.addEventListener("timeupdate",s.time,!0),i.addEventListener("seeking",s.seeking,!0),i.addEventListener("seeked",s.seeked,!0),this},changeSource:function(t,e,n,i,r){void 0===e&&(e=!0),this.video&&this.stop();var s=this.scene.sys.cache.video.get(t);return s?(this.video=s,this._cacheKey=t,this._codePaused=s.paused,this._codeMuted=s.muted,this.videoTexture?(this.scene.sys.textures.remove(this._key),this.videoTexture=this.scene.sys.textures.create(this._key,s,s.videoWidth,s.videoHeight),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,s.videoWidth,s.videoHeight),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(o.VIDEO_CREATED,this,s.videoWidth,s.videoHeight)):this.updateTexture(),s.currentTime=0,this._lastUpdate=0,e&&this.play(n,i,r)):this.video=null,this},addMarker:function(t,e,n){return!isNaN(e)&&e>=0&&!isNaN(n)&&(this.markers[t]=[e,n]),this},playMarker:function(t,e){var n=this.markers[t];return n&&this.play(e,n[0],n[1]),this},removeMarker:function(t){return delete this.markers[t],this},snapshot:function(t,e){return void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.snapshotArea(0,0,this.width,this.height,t,e)},snapshotArea:function(t,e,n,i,r,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),void 0===r&&(r=n),void 0===s&&(s=i);var o=this.video,a=this.snapshotTexture;return a?(a.setSize(r,s),o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)):(a=this.scene.sys.textures.createCanvas(c(),r,s),this.snapshotTexture=a,o&&a.context.drawImage(o,t,e,n,i,0,0,r,s)),a.update()},saveSnapshotTexture:function(t){return this.snapshotTexture?this.scene.sys.textures.renameTexture(this.snapshotTexture.key,t):this.snapshotTexture=this.scene.sys.textures.createCanvas(t,this.width,this.height),this.snapshotTexture},loadURL:function(t,e,n){void 0===e&&(e="loadeddata"),void 0===n&&(n=!1),this.video&&this.stop(),this.videoTexture&&this.scene.sys.textures.remove(this._key);var i=document.createElement("video");return i.controls=!1,n&&(i.muted=!0,i.defaultMuted=!0,i.setAttribute("autoplay","autoplay")),i.setAttribute("playsinline","playsinline"),i.setAttribute("preload","auto"),i.addEventListener("error",this._callbacks.error,!0),i.src=t,i.load(),this.video=i,this},playPromiseSuccessHandler:function(){this.touchLocked=!1,this.emit(o.VIDEO_PLAY,this),this._markerIn>-1&&(this.video.currentTime=this._markerIn)},playPromiseErrorHandler:function(t){this.scene.sys.input.once("pointerdown",this.unlockHandler,this),this.touchLocked=!0,this.playWhenUnlocked=!0,this.emit(o.VIDEO_ERROR,this,t)},playHandler:function(){this.touchLocked=!1,this.emit(o.VIDEO_PLAY,this),this.video.removeEventListener("playing",this._callbacks.play,!0)},loadErrorHandler:function(t){this.stop(),this.emit(o.VIDEO_ERROR,this,t)},unlockHandler:function(){this.touchLocked=!1,this.playWhenUnlocked=!1,this.emit(o.VIDEO_UNLOCKED,this),this._markerIn>-1&&(this.video.currentTime=this._markerIn),this.video.play(),this.emit(o.VIDEO_PLAY,this)},completeHandler:function(){this.emit(o.VIDEO_COMPLETE,this)},timeUpdateHandler:function(){this.video&&this.video.currentTime<this._lastUpdate&&(this.emit(o.VIDEO_LOOP,this),this._lastUpdate=0)},preUpdate:function(){var t=this.video;if(t){var e=t.currentTime;e!==this._lastUpdate&&(this._lastUpdate=e,this.updateTexture(),e>=this._markerOut&&(t.loop?(t.currentTime=this._markerIn,this.updateTexture(),this._lastUpdate=e,this.emit(o.VIDEO_LOOP,this)):(this.emit(o.VIDEO_COMPLETE,this),this.stop())))}},checkVideoProgress:function(){this.video.readyState>=2?this.updateTexture():(this.retry--,this.retry>0?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval):this.emit(o.VIDEO_TIMEOUT,this))},updateTexture:function(){var t=this.video,e=t.videoWidth,n=t.videoHeight;if(this.videoTexture){var i=this.videoTextureSource;i.source!==t&&(i.source=t,i.width=e,i.height=n),i.update()}else this.videoTexture=this.scene.sys.textures.create(this._key,t,e,n),this.videoTextureSource=this.videoTexture.source[0],this.videoTexture.add("__BASE",0,0,0,e,n),this.setTexture(this.videoTexture),this.setSizeToFrame(),this.updateDisplayOrigin(),this.emit(o.VIDEO_CREATED,this,e,n)},getVideoKey:function(){return this._cacheKey},seekTo:function(t){var e=this.video;if(e){var n=e.duration;n===1/0||isNaN(n)||this.setCurrentTime(n*t)}return this},getCurrentTime:function(){return this.video?this.video.currentTime:0},setCurrentTime:function(t){var e=this.video;if(e){if("string"==typeof t){var n=t[0],i=parseFloat(t.substr(1));"+"===n?t=e.currentTime+i:"-"===n&&(t=e.currentTime-i)}e.currentTime=t,this._lastUpdate=t}return this},isSeeking:function(){return this._isSeeking},seekingHandler:function(){this._isSeeking=!0,this.emit(o.VIDEO_SEEKING,this)},seekedHandler:function(){this._isSeeking=!1,this.emit(o.VIDEO_SEEKED,this),this.video&&this.updateTexture()},getProgress:function(){var t=this.video;if(t){var e=t.currentTime,n=t.duration;if(n!==1/0&&!isNaN(n))return e/n}return 0},getDuration:function(){return this.video?this.video.duration:0},setMute:function(t){void 0===t&&(t=!0),this._codeMuted=t;var e=this.video;return e&&(e.muted=!!this._systemMuted||t),this},isMuted:function(){return this._codeMuted},globalMute:function(t,e){this._systemMuted=e;var n=this.video;n&&(n.muted=!!this._codeMuted||e)},globalPause:function(){this._systemPaused=!0,this.video&&this.video.pause()},globalResume:function(){this._systemPaused=!1,this.video&&!this._codePaused&&this.video.play()},setPaused:function(t){void 0===t&&(t=!0);var e=this.video;return this._codePaused=t,e&&(t?e.paused||e.pause():t||e.paused&&!this._systemPaused&&e.play()),this},getVolume:function(){return this.video?this.video.volume:1},setVolume:function(t){return void 0===t&&(t=1),this.video&&(this.video.volume=r(t,0,1)),this},getPlaybackRate:function(){return this.video?this.video.playbackRate:1},setPlaybackRate:function(t){return this.video&&(this.video.playbackRate=t),this},getLoop:function(){return!!this.video&&this.video.loop},setLoop:function(t){return void 0===t&&(t=!0),this.video&&(this.video.loop=t),this},isPlaying:function(){return!!this.video&&!(this.video.paused||this.video.ended)},isPaused:function(){return this.video&&this.video.paused||this._codePaused||this._systemPaused},saveTexture:function(t,e){return void 0===e&&(e=!1),this.videoTexture&&this.scene.sys.textures.renameTexture(this._key,t),this._key=t,this.flipY=e,this.videoTextureSource&&this.videoTextureSource.setFlipY(e),this.videoTexture},stop:function(){var t=this.video;if(t){var e=this._callbacks;for(var n in e)t.removeEventListener(n,e[n],!0);t.pause()}return this._retryID&&window.clearTimeout(this._retryID),this.emit(o.VIDEO_STOP,this),this},removeVideoElement:function(){var t=this.video;if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("autoplay"),t.removeAttribute("src"),this.video=null}},destroy:function(t){void 0===t&&(t=!1),this.stop(),t&&this.removeVideoElement();var e=this.scene.sys.game.events;e.off(a.PAUSE,this.globalPause,this),e.off(a.RESUME,this.globalResume,this);var n=this.scene.sys.sound;n&&n.off(l.GLOBAL_MUTE,this.globalMute,this),this._retryID&&window.clearTimeout(this._retryID)}});t.exports=d},function(t,e,n){var i=n(0),r=n(198),s=n(395),o=n(46),a=new i({initialize:function(t){this.type=o.POLYGON,this.area=0,this.points=[],t&&this.setTo(t)},contains:function(t,e){return r(this,t,e)},setTo:function(t){if(this.area=0,this.points=[],"string"==typeof t&&(t=t.split(" ")),!Array.isArray(t))return this;for(var e,n=Number.MAX_VALUE,i=0;i<t.length;i++)e={x:0,y:0},"number"==typeof t[i]||"string"==typeof t[i]?(e.x=parseFloat(t[i]),e.y=parseFloat(t[i+1]),i++):Array.isArray(t[i])?(e.x=t[i][0],e.y=t[i][1]):(e.x=t[i].x,e.y=t[i].y),this.points.push(e),e.y<n&&(n=e.y);return this.calculateArea(n),this},calculateArea:function(){if(this.points.length<3)return this.area=0,this.area;for(var t,e,n=0,i=0;i<this.points.length-1;i++)n+=((e=this.points[i+1]).x-(t=this.points[i]).x)*(t.y+e.y);return this.area=.5*-(n+=((t=this.points[0]).x-(e=this.points[this.points.length-1]).x)*(e.y+t.y)),this.area},getPoints:function(t,e,n){return s(this,t,e,n)}});t.exports=a},function(t,e){t.exports=function(t,e,n){for(var i=!1,r=-1,s=t.points.length-1;++r<t.points.length;s=r){var o=t.points[r].x,a=t.points[r].y,u=t.points[s].y;(a<=n&&n<u||u<=n&&n<a)&&e<(t.points[s].x-o)*(n-a)/(u-a)+o&&(i=!i)}return i}},function(t,e,n){var i=n(0),r=n(128),s=new i({Extends:r,initialize:function(t,e,n,i,s){r.call(this,t,e,n,[0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,1,1,1,0,0,1,1,1,0],[16777215,16777215,16777215,16777215,16777215,16777215],[1,1,1,1,1,1],i,s),this.resetPosition()},setFrame:function(t){return this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this.uv[0]=(t=this.frame).u0,this.uv[1]=t.v0,this.uv[2]=t.u0,this.uv[3]=t.v1,this.uv[4]=t.u1,this.uv[5]=t.v1,this.uv[6]=t.u0,this.uv[7]=t.v0,this.uv[8]=t.u1,this.uv[9]=t.v1,this.uv[10]=t.u1,this.uv[11]=t.v0,this},topLeftX:{get:function(){return this.x+this.vertices[0]},set:function(t){this.vertices[0]=t-this.x,this.vertices[6]=t-this.x}},topLeftY:{get:function(){return this.y+this.vertices[1]},set:function(t){this.vertices[1]=t-this.y,this.vertices[7]=t-this.y}},topRightX:{get:function(){return this.x+this.vertices[10]},set:function(t){this.vertices[10]=t-this.x}},topRightY:{get:function(){return this.y+this.vertices[11]},set:function(t){this.vertices[11]=t-this.y}},bottomLeftX:{get:function(){return this.x+this.vertices[2]},set:function(t){this.vertices[2]=t-this.x}},bottomLeftY:{get:function(){return this.y+this.vertices[3]},set:function(t){this.vertices[3]=t-this.y}},bottomRightX:{get:function(){return this.x+this.vertices[4]},set:function(t){this.vertices[4]=t-this.x,this.vertices[8]=t-this.x}},bottomRightY:{get:function(){return this.y+this.vertices[5]},set:function(t){this.vertices[5]=t-this.y,this.vertices[9]=t-this.y}},topLeftAlpha:{get:function(){return this.alphas[0]},set:function(t){this.alphas[0]=t,this.alphas[3]=t}},topRightAlpha:{get:function(){return this.alphas[5]},set:function(t){this.alphas[5]=t}},bottomLeftAlpha:{get:function(){return this.alphas[1]},set:function(t){this.alphas[1]=t}},bottomRightAlpha:{get:function(){return this.alphas[2]},set:function(t){this.alphas[2]=t,this.alphas[4]=t}},topLeftColor:{get:function(){return this.colors[0]},set:function(t){this.colors[0]=t,this.colors[3]=t}},topRightColor:{get:function(){return this.colors[5]},set:function(t){this.colors[5]=t}},bottomLeftColor:{get:function(){return this.colors[1]},set:function(t){this.colors[1]=t}},bottomRightColor:{get:function(){return this.colors[2]},set:function(t){this.colors[2]=t,this.colors[4]=t}},setTopLeft:function(t,e){return this.topLeftX=t,this.topLeftY=e,this},setTopRight:function(t,e){return this.topRightX=t,this.topRightY=e,this},setBottomLeft:function(t,e){return this.bottomLeftX=t,this.bottomLeftY=e,this},setBottomRight:function(t,e){return this.bottomRightX=t,this.bottomRightY=e,this},resetPosition:function(){var t=this.x,e=this.y,n=Math.floor(this.width/2),i=Math.floor(this.height/2);return this.setTopLeft(t-n,e-i),this.setTopRight(t+n,e-i),this.setBottomLeft(t-n,e+i),this.setBottomRight(t+n,e+i),this},resetAlpha:function(){var t=this.alphas;return t[0]=1,t[1]=1,t[2]=1,t[3]=1,t[4]=1,t[5]=1,this},resetColors:function(){var t=this.colors;return t[0]=16777215,t[1]=16777215,t[2]=16777215,t[3]=16777215,t[4]=16777215,t[5]=16777215,this},reset:function(){return this.resetPosition(),this.resetAlpha(),this.resetColors()}});t.exports=s},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(2),a=n(16),u=n(403),l=n(1052),c=n(32),h=new i({Extends:s,Mixins:[r.ComputedSize,r.Depth,r.GetBounds,r.Mask,r.Origin,r.ScrollFactor,r.Transform,r.Visible,l],initialize:function(t,e,n,i,r,o,a,u){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=128),void 0===o&&(o=128),s.call(this,t,"Shader"),this.blendMode=-1;var l=t.sys.renderer;this.renderer=l,this.gl=l.gl,this.vertexData=new ArrayBuffer(2*Float32Array.BYTES_PER_ELEMENT*6),this.vertexBuffer=l.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW),this.program=null,this.bytes=new Uint8Array(this.vertexData),this.vertexViewF32=new Float32Array(this.vertexData),this._tempMatrix1=new c,this._tempMatrix2=new c,this._tempMatrix3=new c,this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.uniforms={},this.pointer=null,this._rendererWidth=l.width,this._rendererHeight=l.height,this._textureCount=0,this.framebuffer=null,this.glTexture=null,this.renderToTexture=!1,this.texture=null,this.setPosition(n,i),this.setSize(r,o),this.setOrigin(.5,.5),this.setShader(e,a,u)},willRender:function(t){return!!this.renderToTexture||!(s.RENDER_MASK!==this.renderFlags||0!==this.cameraFilter&&this.cameraFilter&t.id)},setRenderToTexture:function(t,e){if(void 0===e&&(e=!1),!this.renderToTexture){var n=this.width,i=this.height,r=this.renderer;this.glTexture=r.createTextureFromSource(null,n,i,0),this.glTexture.flipY=e,this.framebuffer=r.createFramebuffer(n,i,this.glTexture,!1),this._rendererWidth=n,this._rendererHeight=i,this.renderToTexture=!0,this.projOrtho(0,this.width,this.height,0),t&&(this.texture=this.scene.sys.textures.addGLTexture(t,this.glTexture,n,i))}if(this.shader){var s=r.currentPipeline;r.clearPipeline(),this.load(),this.flush(),r.rebindPipeline(s)}return this},setShader:function(t,e,n){if(void 0===e&&(e=[]),"string"==typeof t){var i=this.scene.sys.cache.shader;if(!i.has(t))return console.warn("Shader missing: "+t),this;this.shader=i.get(t)}else this.shader=t;var r=this.renderer;this.program&&this.gl.deleteProgram(this.program);var s=r.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);r.setMatrix4(s,"uViewMatrix",!1,this.viewMatrix),r.setMatrix4(s,"uProjectionMatrix",!1,this.projectionMatrix),r.setFloat2(s,"uResolution",this.width,this.height),this.program=s;var o=new Date,u={resolution:{type:"2f",value:{x:this.width,y:this.height}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:this.width/2,y:this.height/2}},date:{type:"4fv",value:[o.getFullYear(),o.getMonth(),o.getDate(),60*o.getHours()*60+60*o.getMinutes()+o.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};this.uniforms=this.shader.uniforms?a(!0,{},this.shader.uniforms,u):u;for(var l=0;l<4;l++)e[l]&&this.setSampler2D("iChannel"+l,e[l],l,n);return this.initUniforms(),this.projOrtho(0,this._rendererWidth,this._rendererHeight,0),this},setPointer:function(t){return this.pointer=t,this},projOrtho:function(t,e,n,i){var r=1/(t-e),s=1/(n-i),o=this.projectionMatrix;o[0]=-2*r,o[5]=-2*s,o[10]=-.001,o[12]=(t+e)*r,o[13]=(i+n)*s,o[14]=-0,this.renderer.setMatrix4(this.program,"uProjectionMatrix",!1,this.projectionMatrix),this._rendererWidth=e,this._rendererHeight=n},initUniforms:function(){var t=this.gl,e=this.renderer.glFuncMap,n=this.program;for(var i in this._textureCount=0,this.uniforms){var r=this.uniforms[i],s=r.type,o=e[s];r.uniformLocation=t.getUniformLocation(n,i),"sampler2D"!==s&&(r.glMatrix=o.matrix,r.glValueLength=o.length,r.glFunc=o.func)}},setSampler2DBuffer:function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s={});var o=this.uniforms[t];return o.value=e,s.width=n,s.height=i,o.textureData=s,this._textureCount=r,this.initSampler2D(o),this},setSampler2D:function(t,e,n,i){void 0===n&&(n=0);var r=this.scene.sys.textures;if(r.exists(e)){var s=r.getFrame(e),o=this.uniforms[t],a=s.source;o.textureKey=e,o.source=a.image,o.value=s.glTexture,a.isGLTexture&&(i||(i={}),i.width=a.width,i.height=a.height),i&&(o.textureData=i),this._textureCount=n,this.initSampler2D(o)}return this},setUniform:function(t,e){return u(this.uniforms,t,e),this},getUniform:function(t){return o(this.uniforms,t,null)},setChannel0:function(t,e){return this.setSampler2D("iChannel0",t,0,e)},setChannel1:function(t,e){return this.setSampler2D("iChannel1",t,1,e)},setChannel2:function(t,e){return this.setSampler2D("iChannel2",t,2,e)},setChannel3:function(t,e){return this.setSampler2D("iChannel3",t,3,e)},initSampler2D:function(t){if(t.value){var e=this.gl;e.activeTexture(e.TEXTURE0+this._textureCount),e.bindTexture(e.TEXTURE_2D,t.value);var n=t.textureData;if(n){var i=e[o(n,"magFilter","linear").toUpperCase()],r=e[o(n,"minFilter","linear").toUpperCase()],s=e[o(n,"wrapS","repeat").toUpperCase()],a=e[o(n,"wrapT","repeat").toUpperCase()],u=e[o(n,"format","rgba").toUpperCase()];if(n.repeat&&(s=e.REPEAT,a=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var l=o(n,"width",512),c=o(n,"height",2),h=o(n,"border",0);e.texImage2D(e.TEXTURE_2D,0,u,l,c,h,u,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,u,e.RGBA,e.UNSIGNED_BYTE,t.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a)}this.renderer.setProgram(this.program),e.uniform1i(t.uniformLocation,this._textureCount),this._textureCount++}},syncUniforms:function(){var t,e,n,i,r,s=this.gl,o=this.uniforms,a=0;for(var u in o)n=(t=o[u]).glFunc,e=t.glValueLength,i=t.uniformLocation,null!==(r=t.value)&&(1===e?t.glMatrix?n.call(s,i,t.transpose,r):n.call(s,i,r):2===e?n.call(s,i,r.x,r.y):3===e?n.call(s,i,r.x,r.y,r.z):4===e?n.call(s,i,r.x,r.y,r.z,r.w):"sampler2D"===t.type&&(s.activeTexture(s["TEXTURE"+a]),s.bindTexture(s.TEXTURE_2D,r),s.uniform1i(i,a),a++))},load:function(t){var e=this.gl,n=this.width,i=this.height,r=this.renderer,s=this.program,o=this.viewMatrix;if(!this.renderToTexture){var a=-this._displayOriginX,u=-this._displayOriginY;o[0]=t[0],o[1]=t[1],o[4]=t[2],o[5]=t[3],o[8]=t[4],o[9]=t[5],o[12]=o[0]*a+o[4]*u,o[13]=o[1]*a+o[5]*u}e.useProgram(s),e.uniformMatrix4fv(e.getUniformLocation(s,"uViewMatrix"),!1,o),e.uniform2f(e.getUniformLocation(s,"uResolution"),this.width,this.height);var l=this.uniforms,c=l.resolution;c.value.x=n,c.value.y=i,l.time.value=r.game.loop.getDuration();var h=this.pointer;if(h){var d=l.mouse,f=1-h.y/i;d.value.x=(h.x/n).toFixed(2),d.value.y=f.toFixed(2)}this.syncUniforms()},flush:function(){var t=this.width,e=this.height,n=this.program,i=this.gl,r=this.vertexBuffer,s=this.renderer,o=2*Float32Array.BYTES_PER_ELEMENT;this.renderToTexture&&(s.setFramebuffer(this.framebuffer),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)),i.bindBuffer(i.ARRAY_BUFFER,r);var a=i.getAttribLocation(n,"inPosition");-1!==a&&(i.enableVertexAttribArray(a),i.vertexAttribPointer(a,2,i.FLOAT,!1,o,0));var u=this.vertexViewF32;u[3]=e,u[4]=t,u[5]=e,u[8]=t,u[9]=e,u[10]=t,i.bufferSubData(i.ARRAY_BUFFER,0,this.bytes.subarray(0,6*o)),i.drawArrays(i.TRIANGLES,0,6),this.renderToTexture&&s.setFramebuffer(null,!1)},setAlpha:function(){},setBlendMode:function(){},preDestroy:function(){var t=this.gl;t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),this.renderToTexture&&(this.renderer.deleteFramebuffer(this.framebuffer),this.texture.destroy(),this.framebuffer=null,this.glTexture=null,this.texture=null)}});t.exports=h},function(t,e,n){var i=n(4),r=n(202);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a=t.x1,u=t.y1,l=e.radius,c=t.x2-a,h=t.y2-u,d=a-e.x,f=u-e.y,p=c*c+h*h,m=2*(c*d+h*f),g=m*m-4*p*(d*d+f*f-l*l);if(0===g){var y=-m/(2*p);s=a+y*c,o=u+y*h,y>=0&&y<=1&&n.push(new i(s,o))}else if(g>0){var v=(-m-Math.sqrt(g))/(2*p);s=a+v*c,o=u+v*h,v>=0&&v<=1&&n.push(new i(s,o));var b=(-m+Math.sqrt(g))/(2*p);s=a+b*c,o=u+b*h,b>=0&&b<=1&&n.push(new i(s,o))}}return n}},function(t,e,n){var i=n(54),r=new(n(4));t.exports=function(t,e,n){if(void 0===n&&(n=r),i(e,t.x1,t.y1))return n.x=t.x1,n.y=t.y1,!0;if(i(e,t.x2,t.y2))return n.x=t.x2,n.y=t.y2,!0;var s=t.x2-t.x1,o=t.y2-t.y1,a=s*s+o*o,u=s,l=o;if(a>0){var c=((e.x-t.x1)*s+(e.y-t.y1)*o)/a;u*=c,l*=c}return n.x=t.x1+u,n.y=t.y1+l,u*u+l*l<=a&&u*s+l*o>=0&&i(e,n.x,n.y)}},function(t,e,n){var i=n(4),r=n(84),s=n(410);t.exports=function(t,e,n){if(void 0===n&&(n=[]),s(t,e))for(var o=e.getLineA(),a=e.getLineB(),u=e.getLineC(),l=e.getLineD(),c=[new i,new i,new i,new i],h=[r(o,t,c[0]),r(a,t,c[1]),r(u,t,c[2]),r(l,t,c[3])],d=0;d<4;d++)h[d]&&n.push(c[d]);return n}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=!1),void 0===i&&(i=[]);for(var r,s,o,a,u,l,c=t.x3-t.x1,h=t.y3-t.y1,d=t.x2-t.x1,f=t.y2-t.y1,p=c*c+h*h,m=c*d+h*f,g=d*d+f*f,y=p*g-m*m,v=0===y?0:1/y,b=t.x1,x=t.y1,w=0;w<e.length&&(s=(p*(l=d*(o=e[w].x-b)+f*(a=e[w].y-x))-m*(u=c*o+h*a))*v,!((r=(g*u-m*l)*v)>=0&&s>=0&&r+s<1&&(i.push({x:e[w].x,y:e[w].y}),n)));w++);return i}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,t.x2=(o=t.x2-e)*r-(a=t.y2-n)*s+e,t.y2=o*s+a*r+n,t}},function(t,e){t.exports=function(t){return 0===t.height?NaN:t.width/t.height}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x1-e,a=t.y1-n;return t.x1=o*r-a*s+e,t.y1=o*s+a*r+n,t.x2=(o=t.x2-e)*r-(a=t.y2-n)*s+e,t.y2=o*s+a*r+n,t.x3=(o=t.x3-e)*r-(a=t.y3-n)*s+e,t.y3=o*s+a*r+n,t}},function(t,e,n){t.exports={BUTTON_DOWN:n(1173),BUTTON_UP:n(1174),CONNECTED:n(1175),DISCONNECTED:n(1176),GAMEPAD_BUTTON_DOWN:n(1177),GAMEPAD_BUTTON_UP:n(1178)}},function(t,e,n){var i=n(16),r=n(133);t.exports=function(t,e){var n=void 0===t?r():i({},t);if(e)for(var s in e)void 0!==e[s]&&(n[s]=e[s]);return n}},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=n(342),c=new i({Extends:s,initialize:function(t,e,n,i){var r="xml";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"xml",cache:t.cacheManager.xml,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=l(this.xhrLoader.responseText),this.data?this.onProcessComplete():(console.warn("Invalid XMLFile: "+this.key),this.onProcessError())}});o.register("xml",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this}),t.exports=c},function(t,e,n){t.exports={Acceleration:n(1233),Angular:n(1234),Bounce:n(1235),Debug:n(1236),Drag:n(1237),Enable:n(1238),Friction:n(1239),Gravity:n(1240),Immovable:n(1241),Mass:n(1242),Size:n(1243),Velocity:n(1244)}},function(t,e,n){t.exports={COLLIDE:n(1246),OVERLAP:n(1247),PAUSE:n(1248),RESUME:n(1249),TILE_COLLIDE:n(1250),TILE_OVERLAP:n(1251),WORLD_BOUNDS:n(1252),WORLD_STEP:n(1253)}},function(t,e,n){var i={};t.exports=i;var r=n(233),s=n(37),o=n(102),a=n(62);i.create=function(t){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},t)},i.setModified=function(t,e,n,r){if(t.isModified=e,n&&t.parent&&i.setModified(t.parent,e,n,r),r)for(var s=0;s<t.composites.length;s++)i.setModified(t.composites[s],e,n,r)},i.add=function(t,e){var n=[].concat(e);r.trigger(t,"beforeAdd",{object:e});for(var o=0;o<n.length;o++){var a=n[o];switch(a.type){case"body":if(a.parent!==a){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(t,a);break;case"constraint":i.addConstraint(t,a);break;case"composite":i.addComposite(t,a);break;case"mouseConstraint":i.addConstraint(t,a.constraint)}}return r.trigger(t,"afterAdd",{object:e}),t},i.remove=function(t,e,n){var s=[].concat(e);r.trigger(t,"beforeRemove",{object:e});for(var o=0;o<s.length;o++){var a=s[o];switch(a.type){case"body":i.removeBody(t,a,n);break;case"constraint":i.removeConstraint(t,a,n);break;case"composite":i.removeComposite(t,a,n);break;case"mouseConstraint":i.removeConstraint(t,a.constraint)}}return r.trigger(t,"afterRemove",{object:e}),t},i.addComposite=function(t,e){return t.composites.push(e),e.parent=t,i.setModified(t,!0,!0,!1),t},i.removeComposite=function(t,e,n){var r=t.composites.indexOf(e);if(-1!==r&&(i.removeCompositeAt(t,r),i.setModified(t,!0,!0,!1)),n)for(var s=0;s<t.composites.length;s++)i.removeComposite(t.composites[s],e,!0);return t},i.removeCompositeAt=function(t,e){return t.composites.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addBody=function(t,e){return t.bodies.push(e),i.setModified(t,!0,!0,!1),t},i.removeBody=function(t,e,n){var r=t.bodies.indexOf(e);if(-1!==r&&(i.removeBodyAt(t,r),i.setModified(t,!0,!0,!1)),n)for(var s=0;s<t.composites.length;s++)i.removeBody(t.composites[s],e,!0);return t},i.removeBodyAt=function(t,e){return t.bodies.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addConstraint=function(t,e){return t.constraints.push(e),i.setModified(t,!0,!0,!1),t},i.removeConstraint=function(t,e,n){var r=t.constraints.indexOf(e);if(-1!==r&&i.removeConstraintAt(t,r),n)for(var s=0;s<t.composites.length;s++)i.removeConstraint(t.composites[s],e,!0);return t},i.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),i.setModified(t,!0,!0,!1),t},i.clear=function(t,e,n){if(n)for(var r=0;r<t.composites.length;r++)i.clear(t.composites[r],e,!0);return e?t.bodies=t.bodies.filter(function(t){return t.isStatic}):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,i.setModified(t,!0,!0,!1),t},i.allBodies=function(t){for(var e=[].concat(t.bodies),n=0;n<t.composites.length;n++)e=e.concat(i.allBodies(t.composites[n]));return e},i.allConstraints=function(t){for(var e=[].concat(t.constraints),n=0;n<t.composites.length;n++)e=e.concat(i.allConstraints(t.composites[n]));return e},i.allComposites=function(t){for(var e=[].concat(t.composites),n=0;n<t.composites.length;n++)e=e.concat(i.allComposites(t.composites[n]));return e},i.get=function(t,e,n){var r,s;switch(n){case"body":r=i.allBodies(t);break;case"constraint":r=i.allConstraints(t);break;case"composite":r=i.allComposites(t).concat(t)}return r?0===(s=r.filter(function(t){return t.id.toString()===e.toString()})).length?null:s[0]:null},i.move=function(t,e,n){return i.remove(t,e),i.add(n,e),t},i.rebase=function(t){for(var e=i.allBodies(t).concat(i.allConstraints(t)).concat(i.allComposites(t)),n=0;n<e.length;n++)e[n].id=s.nextId();return i.setModified(t,!0,!0,!1),t},i.translate=function(t,e,n){for(var r=n?i.allBodies(t):t.bodies,s=0;s<r.length;s++)a.translate(r[s],e);return i.setModified(t,!0,!0,!1),t},i.rotate=function(t,e,n,r){for(var s=Math.cos(e),o=Math.sin(e),u=r?i.allBodies(t):t.bodies,l=0;l<u.length;l++){var c=u[l],h=c.position.x-n.x,d=c.position.y-n.y;a.setPosition(c,{x:n.x+(h*s-d*o),y:n.y+(h*o+d*s)}),a.rotate(c,e)}return i.setModified(t,!0,!0,!1),t},i.scale=function(t,e,n,r,s){for(var o=s?i.allBodies(t):t.bodies,u=0;u<o.length;u++){var l=o[u];a.setPosition(l,{x:r.x+(l.position.x-r.x)*e,y:r.y+(l.position.y-r.y)*n}),a.scale(l,e,n)}return i.setModified(t,!0,!0,!1),t},i.bounds=function(t){for(var e=i.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return o.create(n)}},function(t,e,n){var i=n(137);t.exports=function(t,e,n){var r=i(t,e,!0,n),s=i(t,e-1,!0,n),o=i(t,e+1,!0,n),a=i(t-1,e,!0,n),u=i(t+1,e,!0,n),l=r&&r.collides;return l&&(r.faceTop=!0,r.faceBottom=!0,r.faceLeft=!0,r.faceRight=!0),s&&s.collides&&(l&&(r.faceTop=!1),s.faceBottom=!l),o&&o.collides&&(l&&(r.faceBottom=!1),o.faceTop=!l),a&&a.collides&&(l&&(r.faceLeft=!1),a.faceRight=!l),u&&u.collides&&(l&&(r.faceRight=!1),u.faceLeft=!l),r&&!r.collides&&r.resetFaces(),r}},function(t,e,n){var i=n(73),r=n(103),s=n(214),o=n(72);t.exports=function(t,e,n,a,u){if(!r(e,n,u))return null;void 0===a&&(a=!0);var l=u.data[n][e],c=l&&l.collides;if(t instanceof i)null===u.data[n][e]&&(u.data[n][e]=new i(u,t.index,e,n,t.width,t.height)),u.data[n][e].copy(t);else{var h=t;null===u.data[n][e]?u.data[n][e]=new i(u,h,e,n,u.tileWidth,u.tileHeight):u.data[n][e].index=h}var d=u.data[n][e],f=-1!==u.collideIndexes.indexOf(d.index);return o(d,f),a&&c!==d.collides&&s(e,n,u),d}},function(t,e){t.exports=function(t,e,n){var i=n.collideIndexes.indexOf(t);e&&-1===i?n.collideIndexes.push(t):e||-1===i||n.collideIndexes.splice(i,1)}},function(t,e,n){var i=n(31),r=n(104),s=n(105),o=n(73);t.exports=function(t,e,n,a,u){for(var l=new r({tileWidth:n,tileHeight:a}),c=new s({name:t,tileWidth:n,tileHeight:a,format:i.ARRAY_2D,layers:[l]}),h=[],d=e.length,f=0,p=0;p<e.length;p++){h[p]=[];for(var m=e[p],g=0;g<m.length;g++){var y=parseInt(m[g],10);h[p][g]=isNaN(y)||-1===y?u?null:new o(l,-1,g,p,n,a):new o(l,y,g,p,n,a)}0===f&&(f=m.length)}return c.width=l.width=f,c.height=l.height=d,c.widthInPixels=l.widthInPixels=f*n,c.heightInPixels=l.heightInPixels=d*a,l.data=h,c}},function(t,e){t.exports=function(t){var e=Boolean(2147483648&t),n=Boolean(1073741824&t),i=Boolean(536870912&t);t&=536870911;var r=0,s=!1;return e&&n&&i?(r=Math.PI/2,s=!0):e&&n&&!i?(r=Math.PI,s=!1):e&&!n&&i?(r=Math.PI/2,s=!1):!e||n||i?!e&&n&&i?(r=3*Math.PI/2,s=!1):e||!n||i?e||n||!i?e||n||i||(r=0,s=!1):(r=3*Math.PI/2,s=!0):(r=Math.PI,s=!0):(r=0,s=!0),{gid:t,flippedHorizontal:e,flippedVertical:n,flippedAntiDiagonal:i,rotation:r,flipped:s}}},function(t,e,n){var i=n(465),r=n(218),s=function(t){return{x:t.x,y:t.y}},o=["id","name","type","rotation","properties","visible","x","y","width","height"];t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0);var a=i(t,o);if(a.x+=e,a.y+=n,t.gid){var u=r(t.gid);a.gid=u.gid,a.flippedHorizontal=u.flippedHorizontal,a.flippedVertical=u.flippedVertical,a.flippedAntiDiagonal=u.flippedAntiDiagonal}else t.polyline?a.polyline=t.polyline.map(s):t.polygon?a.polygon=t.polygon.map(s):t.ellipse?(a.ellipse=t.ellipse,a.width=t.width,a.height=t.height):t.text?(a.width=t.width,a.height=t.height,a.text=t.text):(a.rectangle=!0,a.width=t.width,a.height=t.height);return a}},function(t,e,n){var i=n(31),r=n(105),s=n(457),o=n(473);t.exports=function(t,e,n,a,u,l,c,h){void 0===n&&(n=32),void 0===a&&(a=32),void 0===u&&(u=10),void 0===l&&(l=10),void 0===h&&(h=!1);var d=null;if(Array.isArray(c))d=s(void 0!==e?e:"map",i.ARRAY_2D,c,n,a,h);else if(void 0!==e){var f=t.cache.tilemap.get(e);f?d=s(e,f.format,f.data,n,a,h):console.warn("No map data found for key "+e)}return null===d&&(d=new r({tileWidth:n,tileHeight:a,width:u,height:l})),new o(t,d)}},function(t,e,n){var i=n(6);t.exports=function(t){var e=i(t,"targets",null);return null===e||("function"==typeof e&&(e=e.call()),Array.isArray(e)||(e=[e])),e}},function(t,e){function n(t){return!!t.getActive&&"function"==typeof t.getActive}function i(t){return!!t.getStart&&"function"==typeof t.getStart}function r(t){return!!t.getEnd&&"function"==typeof t.getEnd}var s=function(t,e){var o,a,u=function(t,e,n){return n},l=function(t,e,n){return n},c=null,h=typeof e;if("number"===h)u=function(){return e};else if("string"===h){var d=e[0],f=parseFloat(e.substr(2));switch(d){case"+":u=function(t,e,n){return n+f};break;case"-":u=function(t,e,n){return n-f};break;case"*":u=function(t,e,n){return n*f};break;case"/":u=function(t,e,n){return n/f};break;default:u=function(){return parseFloat(e)}}}else if("function"===h)u=e;else if("object"===h)if(i(a=e)||r(a)||n(a))n(e)&&(c=e.getActive),r(e)&&(u=e.getEnd),i(e)&&(l=e.getStart);else if(e.hasOwnProperty("value"))o=s(t,e.value);else{var p=e.hasOwnProperty("to"),m=e.hasOwnProperty("from"),g=e.hasOwnProperty("start");if(p&&(m||g)){if(o=s(t,e.to),g){var y=s(t,e.start);o.getActive=y.getEnd}if(m){var v=s(t,e.from);o.getStart=v.getEnd}}}return o||(o={getActive:c,getEnd:u,getStart:l}),o};t.exports=s},function(t,e){t.exports={targets:null,delay:0,duration:1e3,ease:"Power0",easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:!1,flipX:!1,flipY:!1}},function(t,e,n){var i=n(0),r=n(9),s=n(225),o=n(15),a=n(5),u=n(89),l=new i({Extends:r,initialize:function(t,e,n){r.call(this),this.parent=t,this.parentIsTimeline=t.hasOwnProperty("isTimeline"),this.data=e,this.totalData=e.length,this.targets=n,this.totalTargets=n.length,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.startDelay=0,this.hasStarted=!1,this.isSeeking=!1,this.completeDelay=0,this.countdown=0,this.offset=0,this.calculatedOffset=0,this.state=u.PENDING_ADD,this._pausedState=u.INIT,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onActive:null,onComplete:null,onLoop:null,onRepeat:null,onStart:null,onUpdate:null,onYoyo:null}},getValue:function(t){return void 0===t&&(t=0),this.data[t].current},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===u.ACTIVE},isPaused:function(){return this.state===u.PAUSED},hasTarget:function(t){return-1!==this.targets.indexOf(t)},updateTo:function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<this.totalData;i++){var r=this.data[i];r.key===t&&(r.end=e,n&&(r.start=r.current))}return this},restart:function(){return this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0,this.state===u.ACTIVE?this.seek(0):this.state===u.REMOVED?(this.seek(0),this.parent.makeActive(this),this):this.state===u.PENDING_ADD?this:this.play()},calcDuration:function(){for(var t=0,e=Number.MAX_SAFE_INTEGER,n=this.data,i=0;i<this.totalData;i++){var r=n[i];r.t1=r.duration+r.hold,r.yoyo&&(r.t1+=r.duration),r.t2=r.t1+r.repeatDelay,r.totalDuration=r.delay+r.t1,-1===r.repeat?r.totalDuration+=999999999999*r.t2:r.repeat>0&&(r.totalDuration+=r.t2*r.repeat),r.totalDuration>t&&(t=r.totalDuration),r.delay<e&&(e=r.delay)}this.duration=Math.max(t,.001),this.loopCounter=-1===this.loop?999999999999:this.loop,this.totalDuration=this.loopCounter>0?this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.duration+this.completeDelay,this.startDelay=e},init:function(){if(this.paused&&!this.parentIsTimeline)return this.state=u.PENDING_ADD,this._pausedState=u.INIT,!1;for(var t=this.data,e=this.totalTargets,n=0;n<this.totalData;n++){var i=t[n],r=i.target,s=i.gen,o=i.key,a=i.index;i.delay=s.delay(r,o,0,a,e,this),i.duration=Math.max(s.duration(r,o,0,a,e,this),.001),i.hold=s.hold(r,o,0,a,e,this),i.repeat=s.repeat(r,o,0,a,e,this),i.repeatDelay=s.repeatDelay(r,o,0,a,e,this)}return this.calcDuration(),this.progress=0,this.totalProgress=0,this.elapsed=0,this.totalElapsed=0,this.state=u.INIT,!0},makeActive:function(){this.parent.makeActive(this),this.dispatchTweenEvent(s.TWEEN_ACTIVE,this.callbacks.onActive)},nextState:function(){this.loopCounter>0?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweenData(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.state=u.LOOP_DELAY):(this.state=u.ACTIVE,this.dispatchTweenEvent(s.TWEEN_LOOP,this.callbacks.onLoop))):this.completeDelay>0?(this.state=u.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=u.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete))},pause:function(){return this.state===u.PAUSED||(this.paused=!0,this._pausedState=this.state,this.state=u.PAUSED),this},play:function(t){void 0===t&&(t=!1);var e=this.state;return e!==u.INIT||this.parentIsTimeline?e===u.ACTIVE||e===u.PENDING_ADD&&this._pausedState===u.PENDING_ADD?this:this.parentIsTimeline||e!==u.PENDING_REMOVE&&e!==u.REMOVED?(this.parentIsTimeline?(this.resetTweenData(t),0===this.calculatedOffset?this.state=u.ACTIVE:(this.countdown=this.calculatedOffset,this.state=u.OFFSET_DELAY)):this.paused?(this.paused=!1,this.makeActive()):(this.resetTweenData(t),this.state=u.ACTIVE,this.makeActive()),this):(this.seek(0),this.parent.makeActive(this),this):(this.resetTweenData(!1),this.state=u.ACTIVE,this)},resetTweenData:function(t){for(var e=this.data,n=this.totalData,i=this.totalTargets,r=0;r<n;r++){var s=e[r],o=s.target,a=s.key,l=s.index;s.progress=0,s.elapsed=0,s.repeatCounter=-1===s.repeat?999999999999:s.repeat,t?(s.start=s.getStartValue(o,a,s.start,l,i,this),s.end=s.getEndValue(o,a,s.end,l,i,this),s.current=s.start,s.state=u.PLAYING_FORWARD):s.state=u.PENDING_RENDER,s.delay>0&&(s.elapsed=s.delay,s.state=u.DELAY),s.getActiveValue&&(o[a]=s.getActiveValue(s.target,s.key,s.start))}},resume:function(){return this.state===u.PAUSED?(this.paused=!1,this.state=this._pausedState):this.play(),this},seek:function(t,e){if(void 0===e&&(e=16.6),this.totalDuration>=36e5)return console.warn("Tween.seek duration too long"),this;this.state===u.REMOVED&&this.makeActive(),this.elapsed=0,this.progress=0,this.totalElapsed=0,this.totalProgress=0;for(var n=this.data,i=this.totalTargets,r=0;r<this.totalData;r++){var s=n[r],o=s.target,a=s.gen,l=s.key,c=s.index;s.progress=0,s.elapsed=0,s.repeatCounter=-1===s.repeat?999999999999:s.repeat,s.delay=a.delay(o,l,0,c,i,this),s.duration=Math.max(a.duration(o,l,0,c,i,this),.001),s.hold=a.hold(o,l,0,c,i,this),s.repeat=a.repeat(o,l,0,c,i,this),s.repeatDelay=a.repeatDelay(o,l,0,c,i,this),s.current=s.start,s.state=u.PLAYING_FORWARD,this.updateTweenData(this,s,0,c,i),s.delay>0&&(s.elapsed=s.delay,s.state=u.DELAY)}this.calcDuration();var h=!1;this.state===u.PAUSED&&(h=!0,this.state=u.ACTIVE),this.isSeeking=!0;do{this.update(0,e)}while(this.totalProgress<t);return this.isSeeking=!1,h&&(this.state=u.PAUSED),this},setCallback:function(t,e,n,i){return this.callbacks[t]={func:e,scope:i,params:n},this},complete:function(t){return void 0===t&&(t=0),t?(this.state=u.COMPLETE_DELAY,this.countdown=t):(this.state=u.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete)),this},remove:function(){return this.parent.remove(this),this},stop:function(t){return this.state===u.ACTIVE&&void 0!==t&&this.seek(t),this.state!==u.REMOVED&&(this.state!==u.PAUSED&&this.state!==u.PENDING_ADD||(this.parentIsTimeline?(this.parent.manager._destroy.push(this),this.parent.manager._toProcess++):(this.parent._destroy.push(this),this.parent._toProcess++)),this.removeAllListeners(),this.state=u.PENDING_REMOVE),this},update:function(t,e){if(this.state===u.PAUSED)return!1;switch(this.useFrames&&(e=1*this.parent.timeScale),this.elapsed+=e*=this.timeScale,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=e,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case u.ACTIVE:this.hasStarted||this.isSeeking||(this.startDelay-=e,this.startDelay<=0&&(this.hasStarted=!0,this.dispatchTweenEvent(s.TWEEN_START,this.callbacks.onStart)));for(var n=!1,i=0;i<this.totalData;i++)this.updateTweenData(this,this.data[i],e)&&(n=!0);n||this.nextState();break;case u.LOOP_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=u.ACTIVE,this.dispatchTweenEvent(s.TWEEN_LOOP,this.callbacks.onLoop));break;case u.OFFSET_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=u.ACTIVE);break;case u.COMPLETE_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=u.PENDING_REMOVE,this.dispatchTweenEvent(s.TWEEN_COMPLETE,this.callbacks.onComplete))}return this.state===u.PENDING_REMOVE},dispatchTweenDataEvent:function(t,e,n){this.isSeeking||(this.emit(t,this,n.key,n.target),e&&(e.params[1]=n.target,e.func.apply(e.scope,e.params)))},dispatchTweenEvent:function(t,e){this.isSeeking||(this.emit(t,this,this.targets),e&&(e.params[1]=this.targets,e.func.apply(e.scope,e.params)))},setStateFromEnd:function(t,e,n){return e.yoyo?(e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),this.dispatchTweenDataEvent(s.TWEEN_YOYO,t.callbacks.onYoyo,e),e.start=e.getStartValue(e.target,e.key,e.start,e.index,t.totalTargets,t),u.PLAYING_BACKWARD):e.repeatCounter>0?(e.repeatCounter--,e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),e.start=e.getStartValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.end=e.getEndValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.repeatDelay>0?(e.elapsed=e.repeatDelay-n,e.current=e.start,e.target[e.key]=e.current,u.REPEAT_DELAY):(this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e),u.PLAYING_FORWARD)):u.COMPLETE},setStateFromStart:function(t,e,n){return e.repeatCounter>0?(e.repeatCounter--,e.elapsed=n,e.progress=n/e.duration,e.flipX&&e.target.toggleFlipX(),e.flipY&&e.target.toggleFlipY(),e.end=e.getEndValue(e.target,e.key,e.start,e.index,t.totalTargets,t),e.repeatDelay>0?(e.elapsed=e.repeatDelay-n,e.current=e.start,e.target[e.key]=e.current,u.REPEAT_DELAY):(this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e),u.PLAYING_FORWARD)):u.COMPLETE},updateTweenData:function(t,e,n){var i=e.target;switch(e.state){case u.PLAYING_FORWARD:case u.PLAYING_BACKWARD:if(!i){e.state=u.COMPLETE;break}var r=e.elapsed,o=e.duration,a=0;(r+=n)>o&&(a=r-o,r=o);var l=e.state===u.PLAYING_FORWARD,c=r/o;if(e.elapsed=r,e.progress=c,1===c)l?(e.current=e.end,i[e.key]=e.end,e.hold>0?(e.elapsed=e.hold-a,e.state=u.HOLD_DELAY):e.state=this.setStateFromEnd(t,e,a)):(e.current=e.start,i[e.key]=e.start,e.state=this.setStateFromStart(t,e,a));else{var h=e.ease(l?c:1-c);e.current=e.start+(e.end-e.start)*h,i[e.key]=e.current}this.dispatchTweenDataEvent(s.TWEEN_UPDATE,t.callbacks.onUpdate,e);break;case u.DELAY:e.elapsed-=n,e.elapsed<=0&&(e.elapsed=Math.abs(e.elapsed),e.state=u.PENDING_RENDER);break;case u.REPEAT_DELAY:e.elapsed-=n,e.elapsed<=0&&(e.elapsed=Math.abs(e.elapsed),e.state=u.PLAYING_FORWARD,this.dispatchTweenDataEvent(s.TWEEN_REPEAT,t.callbacks.onRepeat,e));break;case u.HOLD_DELAY:e.elapsed-=n,e.elapsed<=0&&(e.state=this.setStateFromEnd(t,e,Math.abs(e.elapsed)));break;case u.PENDING_RENDER:i?(e.start=e.getStartValue(i,e.key,i[e.key],e.index,t.totalTargets,t),e.end=e.getEndValue(i,e.key,e.start,e.index,t.totalTargets,t),e.current=e.start,i[e.key]=e.start,e.state=u.PLAYING_FORWARD):e.state=u.COMPLETE}return e.state!==u.COMPLETE}});l.TYPES=["onActive","onComplete","onLoop","onRepeat","onStart","onUpdate","onYoyo"],a.register("tween",function(t){return this.scene.sys.tweens.add(t)}),o.register("tween",function(t){return this.scene.sys.tweens.create(t)}),t.exports=l},function(t,e,n){t.exports={TIMELINE_COMPLETE:n(1326),TIMELINE_LOOP:n(1327),TIMELINE_PAUSE:n(1328),TIMELINE_RESUME:n(1329),TIMELINE_START:n(1330),TIMELINE_UPDATE:n(1331),TWEEN_ACTIVE:n(1332),TWEEN_COMPLETE:n(1333),TWEEN_LOOP:n(1334),TWEEN_REPEAT:n(1335),TWEEN_START:n(1336),TWEEN_UPDATE:n(1337),TWEEN_YOYO:n(1338)}},function(t,e){t.exports=function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p){return{target:t,index:e,key:n,getActiveValue:s,getEndValue:i,getStartValue:r,ease:o,duration:0,totalDuration:0,delay:0,yoyo:l,hold:0,repeat:0,repeatDelay:0,flipX:f,flipY:p,progress:0,elapsed:0,repeatCounter:0,start:0,current:0,end:0,t1:0,t2:0,gen:{delay:a,duration:u,hold:c,repeat:h,repeatDelay:d},state:0}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports={DEFAULT:0,LINEAR:0,NEAREST:1}},function(t,e,n){var i=n(57);t.exports=function(t){return i(t,-Math.PI,Math.PI)}},function(t,e,n){var i=n(57);t.exports=function(t){return i(t,-180,180)}},function(t,e,n){var i=n(0),r=n(10),s=new i({initialize:function(t){this.name="WebGLPipeline",this.game=t.game,this.view=t.game.canvas,this.resolution=1,this.width=0,this.height=0,this.gl=t.gl,this.vertexCount=0,this.vertexCapacity=t.vertexCapacity,this.renderer=t.renderer,this.vertexData=t.vertices?t.vertices:new ArrayBuffer(t.vertexCapacity*t.vertexSize),this.vertexBuffer=this.renderer.createVertexBuffer(t.vertices?t.vertices:this.vertexData.byteLength,this.gl.STREAM_DRAW),this.program=this.renderer.createProgram(t.vertShader,t.fragShader),this.attributes=t.attributes,this.vertexSize=t.vertexSize,this.topology=t.topology,this.bytes=new Uint8Array(this.vertexData),this.vertexComponentCount=r.getComponentCount(t.attributes,this.gl),this.flushLocked=!1,this.active=!1},boot:function(){},addAttribute:function(t,e,n,i,s){return this.attributes.push({name:t,size:e,type:this.renderer.glFormats[n],normalized:i,offset:s}),this.vertexComponentCount=r.getComponentCount(this.attributes,this.gl),this},shouldFlush:function(){return this.vertexCount>=this.vertexCapacity},resize:function(t,e,n){return this.width=t*n,this.height=e*n,this.resolution=n,this},bind:function(){var t=this.gl,e=this.vertexBuffer,n=this.attributes,i=this.program,r=this.renderer,s=this.vertexSize;r.setProgram(i),r.setVertexBuffer(e);for(var o=0;o<n.length;++o){var a=n[o],u=t.getAttribLocation(i,a.name);u>=0?(t.enableVertexAttribArray(u),t.vertexAttribPointer(u,a.size,a.type,a.normalized,s,a.offset)):-1!==u&&t.disableVertexAttribArray(u)}return this},onBind:function(){return this},onPreRender:function(){return this},onRender:function(){return this},onPostRender:function(){return this},flush:function(){if(this.flushLocked)return this;this.flushLocked=!0;var t=this.gl,e=this.vertexCount,n=this.topology;if(0!==e)return t.bufferSubData(t.ARRAY_BUFFER,0,this.bytes.subarray(0,e*this.vertexSize)),t.drawArrays(n,0,e),this.vertexCount=0,this.flushLocked=!1,this;this.flushLocked=!1},destroy:function(){var t=this.gl;return t.deleteProgram(this.program),t.deleteBuffer(this.vertexBuffer),delete this.program,delete this.vertexBuffer,delete this.gl,this},setFloat1:function(t,e){return this.renderer.setFloat1(this.program,t,e),this},setFloat2:function(t,e,n){return this.renderer.setFloat2(this.program,t,e,n),this},setFloat3:function(t,e,n,i){return this.renderer.setFloat3(this.program,t,e,n,i),this},setFloat4:function(t,e,n,i,r){return this.renderer.setFloat4(this.program,t,e,n,i,r),this},setFloat1v:function(t,e){return this.renderer.setFloat1v(this.program,t,e),this},setFloat2v:function(t,e){return this.renderer.setFloat2v(this.program,t,e),this},setFloat3v:function(t,e){return this.renderer.setFloat3v(this.program,t,e),this},setFloat4v:function(t,e){return this.renderer.setFloat4v(this.program,t,e),this},setInt1:function(t,e){return this.renderer.setInt1(this.program,t,e),this},setInt2:function(t,e,n){return this.renderer.setInt2(this.program,t,e,n),this},setInt3:function(t,e,n,i){return this.renderer.setInt3(this.program,t,e,n,i),this},setInt4:function(t,e,n,i,r){return this.renderer.setInt4(this.program,t,e,n,i,r),this},setMatrix2:function(t,e,n){return this.renderer.setMatrix2(this.program,t,e,n),this},setMatrix3:function(t,e,n){return this.renderer.setMatrix3(this.program,t,e,n),this},setMatrix4:function(t,e,n){return this.renderer.setMatrix4(this.program,t,e,n),this}});t.exports=s},function(t,e,n){var i=n(0),r=n(65),s=n(2),o=n(490),a=n(751),u=n(752),l=n(32),c=n(10),h=n(231),d=new i({Extends:h,Mixins:[o],initialize:function(t){var e=t.renderer.config;h.call(this,{game:t.game,renderer:t.renderer,gl:t.renderer.gl,topology:s(t,"topology",t.renderer.gl.TRIANGLES),vertShader:s(t,"vertShader",u),fragShader:s(t,"fragShader",a),vertexCapacity:s(t,"vertexCapacity",6*e.batchSize),vertexSize:s(t,"vertexSize",5*Float32Array.BYTES_PER_ELEMENT+4*Uint8Array.BYTES_PER_ELEMENT),attributes:[{name:"inPosition",size:2,type:t.renderer.gl.FLOAT,normalized:!1,offset:0},{name:"inTexCoord",size:2,type:t.renderer.gl.FLOAT,normalized:!1,offset:2*Float32Array.BYTES_PER_ELEMENT},{name:"inTintEffect",size:1,type:t.renderer.gl.FLOAT,normalized:!1,offset:4*Float32Array.BYTES_PER_ELEMENT},{name:"inTint",size:4,type:t.renderer.gl.UNSIGNED_BYTE,normalized:!0,offset:5*Float32Array.BYTES_PER_ELEMENT}]}),this.vertexViewF32=new Float32Array(this.vertexData),this.vertexViewU32=new Uint32Array(this.vertexData),this.maxQuads=e.batchSize,this.batches=[],this._tempMatrix1=new l,this._tempMatrix2=new l,this._tempMatrix3=new l,this._tempMatrix4=new l,this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}],this.tintEffect=2,this.strokeTint={TL:0,TR:0,BL:0,BR:0},this.fillTint={TL:0,TR:0,BL:0,BR:0},this.currentFrame={u0:0,v0:0,u1:1,v1:1},this.firstQuad=[0,0,0,0,0],this.prevQuad=[0,0,0,0,0],this.polygonCache=[],this.mvpInit()},onBind:function(){return h.prototype.onBind.call(this),this.mvpUpdate(),this},resize:function(t,e,n){return h.prototype.resize.call(this,t,e,n),this.projOrtho(0,this.width,this.height,0,-1e3,1e3),this},setTexture2D:function(t,e){return void 0===t&&(t=this.renderer.blankTexture.glTexture),void 0===e&&(e=0),this.requireTextureBatch(t,e)&&this.pushBatch(t,e),this},requireTextureBatch:function(t,e){var n=this.batches,i=n.length;return!(i>0&&(e>0?n[i-1].textures[e-1]:n[i-1].texture)===t)},pushBatch:function(t,e){if(0===e)this.batches.push({first:this.vertexCount,texture:t,textures:[]});else{var n=[];n[e-1]=t,this.batches.push({first:this.vertexCount,texture:null,textures:n})}},flush:function(){if(this.flushLocked)return this;this.flushLocked=!0;var t,e,n,i=this.gl,r=this.vertexCount,s=this.topology,o=this.vertexSize,a=this.renderer,u=this.batches,l=u.length,c=0,h=null;if(0===l||0===r)return this.flushLocked=!1,this;i.bufferSubData(i.ARRAY_BUFFER,0,this.bytes.subarray(0,r*o));for(var d=0;d<l-1;d++){if(t=u[d+1],(h=u[d]).textures.length>0){for(e=0;e<h.textures.length;++e)(n=h.textures[e])&&a.setTexture2D(n,1+e,!1);i.activeTexture(i.TEXTURE0)}c=t.first-h.first,null===h.texture||c<=0||(a.setTexture2D(h.texture,0,!1),i.drawArrays(s,h.first,c))}if((h=u[l-1]).textures.length>0){for(e=0;e<h.textures.length;++e)(n=h.textures[e])&&a.setTexture2D(n,1+e,!1);i.activeTexture(i.TEXTURE0)}return c=r-h.first,h.texture&&c>0&&(a.setTexture2D(h.texture,0,!1),i.drawArrays(s,h.first,c)),this.vertexCount=0,u.length=0,this.flushLocked=!1,this},batchSprite:function(t,e,n){this.renderer.setPipeline(this);var i=this._tempMatrix1,r=this._tempMatrix2,s=this._tempMatrix3,o=t.frame,a=o.glTexture,u=o.u0,l=o.v0,h=o.u1,d=o.v1,f=o.x,p=o.y,m=o.cutWidth,g=o.cutHeight,y=o.customPivot,v=t.displayOriginX,b=t.displayOriginY,x=-v+f,w=-b+p;if(t.isCropped){var T=t._crop;T.flipX===t.flipX&&T.flipY===t.flipY||o.updateCropUVs(T,t.flipX,t.flipY),u=T.u0,l=T.v0,h=T.u1,d=T.v1,m=T.width,g=T.height,x=-v+(f=T.x),w=-b+(p=T.y)}var S=1,E=1;t.flipX&&(y||(x+=2*v-o.realWidth),S=-1),(t.flipY||o.source.isGLTexture&&!a.flipY)&&(y||(w+=2*b-o.realHeight),E=-1),r.applyITRS(t.x,t.y,t.rotation,t.scaleX*S,t.scaleY*E),i.copyFrom(e.matrix),n?(i.multiplyWithOffset(n,-e.scrollX*t.scrollFactorX,-e.scrollY*t.scrollFactorY),r.e=t.x,r.f=t.y,i.multiply(r,s)):(r.e-=e.scrollX*t.scrollFactorX,r.f-=e.scrollY*t.scrollFactorY,i.multiply(r,s));var O=x+m,C=w+g,_=s.getX(x,w),A=s.getY(x,w),k=s.getX(x,C),R=s.getY(x,C),I=s.getX(O,C),M=s.getY(O,C),N=s.getX(O,w),D=s.getY(O,w),P=c.getTintAppendFloatAlpha(t._tintTL,e.alpha*t._alphaTL),F=c.getTintAppendFloatAlpha(t._tintTR,e.alpha*t._alphaTR),L=c.getTintAppendFloatAlpha(t._tintBL,e.alpha*t._alphaBL),j=c.getTintAppendFloatAlpha(t._tintBR,e.alpha*t._alphaBR);e.roundPixels&&(_=Math.round(_),A=Math.round(A),k=Math.round(k),R=Math.round(R),I=Math.round(I),M=Math.round(M),N=Math.round(N),D=Math.round(D)),this.setTexture2D(a,0),this.batchQuad(_,A,k,R,I,M,N,D,u,l,h,d,P,F,L,j,t._isTinted&&t.tintFill,a,0)},batchQuad:function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v){var b=!1;this.vertexCount+6>this.vertexCapacity&&(this.flush(),b=!0,this.setTexture2D(y,v));var x=this.vertexViewF32,w=this.vertexViewU32,T=this.vertexCount*this.vertexComponentCount-1;return x[++T]=t,x[++T]=e,x[++T]=u,x[++T]=l,x[++T]=g,w[++T]=d,x[++T]=n,x[++T]=i,x[++T]=u,x[++T]=h,x[++T]=g,w[++T]=p,x[++T]=r,x[++T]=s,x[++T]=c,x[++T]=h,x[++T]=g,w[++T]=m,x[++T]=t,x[++T]=e,x[++T]=u,x[++T]=l,x[++T]=g,w[++T]=d,x[++T]=r,x[++T]=s,x[++T]=c,x[++T]=h,x[++T]=g,w[++T]=m,x[++T]=o,x[++T]=a,x[++T]=c,x[++T]=l,x[++T]=g,w[++T]=f,this.vertexCount+=6,b},batchTri:function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p,m){var g=!1;this.vertexCount+3>this.vertexCapacity&&(this.flush(),this.setTexture2D(p,m),g=!0);var y=this.vertexViewF32,v=this.vertexViewU32,b=this.vertexCount*this.vertexComponentCount-1;return y[++b]=t,y[++b]=e,y[++b]=o,y[++b]=a,y[++b]=f,v[++b]=c,y[++b]=n,y[++b]=i,y[++b]=o,y[++b]=l,y[++b]=f,v[++b]=h,y[++b]=r,y[++b]=s,y[++b]=u,y[++b]=l,y[++b]=f,v[++b]=d,this.vertexCount+=3,g},batchTexture:function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v,b,x,w,T,S,E,O,C,_,A,k,R){this.renderer.setPipeline(this,t);var I=this._tempMatrix1,M=this._tempMatrix2,N=this._tempMatrix3,D=y/n+C,P=v/i+_,F=(y+b)/n+C,L=(v+x)/i+_,j=o,B=a,z=-m,$=-g;if(t.isCropped){var U=t._crop;j=U.width,B=U.height,o=U.width,a=U.height;var W=y=U.x,V=v=U.y;h&&(W=b-U.x-U.width),d&&!e.isRenderTexture&&(V=x-U.y-U.height),D=W/n+C,P=V/i+_,F=(W+U.width)/n+C,L=(V+U.height)/i+_,z=-m+y,$=-g+v}h&&(j*=-1,z+=o),(d^=!R&&e.isRenderTexture?1:0)&&(B*=-1,$+=a);var Y=z+j,G=$+B;M.applyITRS(r,s,c,u,l),I.copyFrom(A.matrix),k?(I.multiplyWithOffset(k,-A.scrollX*f,-A.scrollY*p),M.e=r,M.f=s,I.multiply(M,N)):(M.e-=A.scrollX*f,M.f-=A.scrollY*p,I.multiply(M,N));var X=N.getX(z,$),H=N.getY(z,$),q=N.getX(z,G),K=N.getY(z,G),J=N.getX(Y,G),Q=N.getY(Y,G),Z=N.getX(Y,$),tt=N.getY(Y,$);A.roundPixels&&(X=Math.round(X),H=Math.round(H),q=Math.round(q),K=Math.round(K),J=Math.round(J),Q=Math.round(Q),Z=Math.round(Z),tt=Math.round(tt)),this.setTexture2D(e,0),this.batchQuad(X,H,q,K,J,Q,Z,tt,D,P,F,L,w,T,S,E,O,e,0)},batchTextureFrame:function(t,e,n,i,r,s,o){this.renderer.setPipeline(this);var a=this._tempMatrix1.copyFrom(s),u=this._tempMatrix2,l=e+t.width,h=n+t.height;o?a.multiply(o,u):u=a;var d=u.getX(e,n),f=u.getY(e,n),p=u.getX(e,h),m=u.getY(e,h),g=u.getX(l,h),y=u.getY(l,h),v=u.getX(l,n),b=u.getY(l,n);this.setTexture2D(t.glTexture,0),i=c.getTintAppendFloatAlpha(i,r),this.batchQuad(d,f,p,m,g,y,v,b,t.u0,t.v0,t.u1,t.v1,i,i,i,i,0,t.glTexture,0)},drawFillRect:function(t,e,n,i,r,s){var o=t+n,a=e+i;this.setTexture2D();var u=c.getTintAppendFloatAlphaAndSwap(r,s);this.batchQuad(t,e,t,a,o,a,o,e,0,0,1,1,u,u,u,u,2)},batchFillRect:function(t,e,n,i,r,s){this.renderer.setPipeline(this);var o=this._tempMatrix3;s&&s.multiply(r,o);var a=t+n,u=e+i,l=o.getX(t,e),c=o.getY(t,e),h=o.getX(t,u),d=o.getY(t,u),f=o.getX(a,u),p=o.getY(a,u),m=o.getX(a,e),g=o.getY(a,e),y=this.currentFrame;this.batchQuad(l,c,h,d,f,p,m,g,y.u0,y.v0,y.u1,y.v1,this.fillTint.TL,this.fillTint.TR,this.fillTint.BL,this.fillTint.BR,this.tintEffect)},batchFillTriangle:function(t,e,n,i,r,s,o,a){this.renderer.setPipeline(this);var u=this._tempMatrix3;a&&a.multiply(o,u);var l=u.getX(t,e),c=u.getY(t,e),h=u.getX(n,i),d=u.getY(n,i),f=u.getX(r,s),p=u.getY(r,s),m=this.currentFrame;this.batchTri(l,c,h,d,f,p,m.u0,m.v0,m.u1,m.v1,this.fillTint.TL,this.fillTint.TR,this.fillTint.BL,this.tintEffect)},batchStrokeTriangle:function(t,e,n,i,r,s,o,a,u){var l=this.tempTriangle;l[0].x=t,l[0].y=e,l[0].width=o,l[1].x=n,l[1].y=i,l[1].width=o,l[2].x=r,l[2].y=s,l[2].width=o,l[3].x=t,l[3].y=e,l[3].width=o,this.batchStrokePath(l,o,!1,a,u)},batchFillPath:function(t,e,n){this.renderer.setPipeline(this);var i=this._tempMatrix3;n&&n.multiply(e,i);for(var s,o,a=t.length,u=this.polygonCache,l=this.fillTint.TL,c=this.fillTint.TR,h=this.fillTint.BL,d=this.tintEffect,f=0;f<a;++f)u.push((o=t[f]).x,o.y);a=(s=r(u)).length;for(var p=this.currentFrame,m=0;m<a;m+=3){var g=2*s[m+0],y=2*s[m+1],v=2*s[m+2],b=u[g+0],x=u[g+1],w=u[y+0],T=u[y+1],S=u[v+0],E=u[v+1],O=i.getX(b,x),C=i.getY(b,x),_=i.getX(w,T),A=i.getY(w,T),k=i.getX(S,E),R=i.getY(S,E);this.batchTri(O,C,_,A,k,R,p.u0,p.v0,p.u1,p.v1,l,c,h,d)}u.length=0},batchStrokePath:function(t,e,n,i,r){this.renderer.setPipeline(this),this.prevQuad[4]=0,this.firstQuad[4]=0;for(var s=t.length-1,o=0;o<s;o++){var a=t[o],u=t[o+1];this.batchLine(a.x,a.y,u.x,u.y,a.width/2,u.width/2,e,o,!n&&o===s-1,i,r)}},batchLine:function(t,e,n,i,r,s,o,a,u,l,c){this.renderer.setPipeline(this);var h=this._tempMatrix3;c&&c.multiply(l,h);var d=n-t,f=i-e,p=Math.sqrt(d*d+f*f),m=r*(i-e)/p,g=r*(t-n)/p,y=s*(i-e)/p,v=s*(t-n)/p,b=n-y,x=i-v,w=t-m,T=e-g,S=n+y,E=i+v,O=t+m,C=e+g,_=h.getX(b,x),A=h.getY(b,x),k=h.getX(w,T),R=h.getY(w,T),I=h.getX(S,E),M=h.getY(S,E),N=h.getX(O,C),D=h.getY(O,C),P=this.strokeTint,F=this.tintEffect,L=P.TL,j=P.TR,B=P.BL,z=P.BR,$=this.currentFrame,U=$.u0,W=$.v0,V=$.u1,Y=$.v1;if(this.batchQuad(N,D,k,R,_,A,I,M,U,W,V,Y,L,j,B,z,F),!(o<=2)){var G=this.prevQuad,X=this.firstQuad;a>0&&G[4]?this.batchQuad(N,D,k,R,G[0],G[1],G[2],G[3],U,W,V,Y,L,j,B,z,F):(X[0]=N,X[1]=D,X[2]=k,X[3]=R,X[4]=1),u&&X[4]?this.batchQuad(_,A,I,M,X[0],X[1],X[2],X[3],U,W,V,Y,L,j,B,z,F):(G[0]=_,G[1]=A,G[2]=I,G[3]=M,G[4]=1)}}});t.exports=d},function(t,e,n){var i={};t.exports=i;var r=n(37);i.on=function(t,e,n){for(var i,r=e.split(" "),s=0;s<r.length;s++)i=r[s],t.events=t.events||{},t.events[i]=t.events[i]||[],t.events[i].push(n);return n},i.off=function(t,e,n){if(e){"function"==typeof e&&(n=e,e=r.keys(t.events).join(" "));for(var i=e.split(" "),s=0;s<i.length;s++){var o=t.events[i[s]],a=[];if(n&&o)for(var u=0;u<o.length;u++)o[u]!==n&&a.push(o[u]);t.events[i[s]]=a}}else t.events={}},i.trigger=function(t,e,n){var i,s,o,a,u=t.events;if(u&&r.keys(u).length>0){n||(n={}),i=e.split(" ");for(var l=0;l<i.length;l++)if(o=u[s=i[l]]){(a=r.clone(n,!1)).name=s,a.source=t;for(var c=0;c<o.length;c++)o[c].apply(t,[a])}}}},function(t,e,n){var i={};t.exports=i;var r=n(86),s=n(101),o=n(452),a=n(102),u=n(1264),l=n(37);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(t){var e=t;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?s.add(e.bodyA.position,e.pointA):e.pointA,i=e.bodyB?s.add(e.bodyB.position,e.pointB):e.pointB,r=s.magnitude(s.sub(n,i));e.length=void 0!==e.length?e.length:r,e.id=e.id||l.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var o={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===e.length&&e.stiffness>.1?(o.type="pin",o.anchors=!1):e.stiffness<.9&&(o.type="spring"),e.render=l.extend(o,e.render),e},i.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var n=t[e],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(t,e){for(var n=0;n<t.length;n+=1){var r=t[n],s=!r.bodyA||r.bodyA&&r.bodyA.isStatic,o=!r.bodyB||r.bodyB&&r.bodyB.isStatic;(s||o)&&i.solve(t[n],e)}for(n=0;n<t.length;n+=1)s=!(r=t[n]).bodyA||r.bodyA&&r.bodyA.isStatic,o=!r.bodyB||r.bodyB&&r.bodyB.isStatic,s||o||i.solve(t[n],e)},i.solve=function(t,e){var n=t.bodyA,r=t.bodyB,o=t.pointA,a=t.pointB;if(n||r){n&&!n.isStatic&&(s.rotate(o,n.angle-t.angleA,o),t.angleA=n.angle),r&&!r.isStatic&&(s.rotate(a,r.angle-t.angleB,a),t.angleB=r.angle);var u=o,l=a;if(n&&(u=s.add(n.position,o)),r&&(l=s.add(r.position,a)),u&&l){var c=s.sub(u,l),h=s.magnitude(c);h<i._minLength&&(h=i._minLength);var d,f,p,m,g,y=s.mult(c,(h-t.length)/h*(t.stiffness<1?t.stiffness*e:t.stiffness)),v=(n?n.inverseMass:0)+(r?r.inverseMass:0),b=v+((n?n.inverseInertia:0)+(r?r.inverseInertia:0));if(t.damping){var x=s.create();p=s.div(c,h),g=s.sub(r&&s.sub(r.position,r.positionPrev)||x,n&&s.sub(n.position,n.positionPrev)||x),m=s.dot(p,g)}n&&!n.isStatic&&(n.constraintImpulse.x-=y.x*(f=n.inverseMass/v),n.constraintImpulse.y-=y.y*f,n.position.x-=y.x*f,n.position.y-=y.y*f,t.damping&&(n.positionPrev.x-=t.damping*p.x*m*f,n.positionPrev.y-=t.damping*p.y*m*f),d=s.cross(o,y)/b*i._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle-=d,n.angle-=d),r&&!r.isStatic&&(r.constraintImpulse.x+=y.x*(f=r.inverseMass/v),r.constraintImpulse.y+=y.y*f,r.position.x+=y.x*f,r.position.y+=y.y*f,t.damping&&(r.positionPrev.x+=t.damping*p.x*m*f,r.positionPrev.y+=t.damping*p.y*m*f),d=s.cross(a,y)/b*i._torqueDampen*r.inverseInertia*(1-t.angularStiffness),r.constraintImpulse.angle+=d,r.angle+=d)}}},i.postSolveAll=function(t){for(var e=0;e<t.length;e++){var n=t[e],l=n.constraintImpulse;if(!(n.isStatic||0===l.x&&0===l.y&&0===l.angle)){o.set(n,!1);for(var c=0;c<n.parts.length;c++){var h=n.parts[c];r.translate(h.vertices,l),c>0&&(h.position.x+=l.x,h.position.y+=l.y),0!==l.angle&&(r.rotate(h.vertices,l.angle,n.position),u.rotate(h.axes,l.angle),c>0&&s.rotateAbout(h.position,l.angle,n.position,h.position)),a.update(h.bounds,h.vertices,n.velocity)}l.angle*=i._warming,l.x*=i._warming,l.y*=i._warming}}}},function(t,e,n){t.exports={Angle:n(502),Call:n(503),GetFirst:n(504),GetLast:n(505),GridAlign:n(506),IncAlpha:n(566),IncX:n(567),IncXY:n(568),IncY:n(569),PlaceOnCircle:n(570),PlaceOnEllipse:n(571),PlaceOnLine:n(572),PlaceOnRectangle:n(573),PlaceOnTriangle:n(574),PlayAnimation:n(575),PropertyValueInc:n(34),PropertyValueSet:n(28),RandomCircle:n(576),RandomEllipse:n(577),RandomLine:n(578),RandomRectangle:n(579),RandomTriangle:n(580),Rotate:n(581),RotateAround:n(582),RotateAroundDistance:n(583),ScaleX:n(584),ScaleXY:n(585),ScaleY:n(586),SetAlpha:n(587),SetBlendMode:n(588),SetDepth:n(589),SetHitArea:n(590),SetOrigin:n(591),SetRotation:n(592),SetScale:n(593),SetScaleX:n(594),SetScaleY:n(595),SetTint:n(596),SetVisible:n(597),SetX:n(598),SetXY:n(599),SetY:n(600),ShiftPosition:n(601),Shuffle:n(602),SmootherStep:n(603),SmoothStep:n(604),Spread:n(605),ToggleVisible:n(606),WrapInRectangle:n(607)}},function(t,e,n){var i=n(143),r=[];r[i.BOTTOM_CENTER]=n(237),r[i.BOTTOM_LEFT]=n(238),r[i.BOTTOM_RIGHT]=n(239),r[i.CENTER]=n(240),r[i.LEFT_CENTER]=n(242),r[i.RIGHT_CENTER]=n(243),r[i.TOP_CENTER]=n(244),r[i.TOP_LEFT]=n(245),r[i.TOP_RIGHT]=n(246),t.exports=function(t,e,n,i,s){return r[n](t,e,i,s)}},function(t,e,n){var i=n(38),r=n(74),s=n(39),o=n(75);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(38),r=n(40),s=n(39),o=n(41);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(38),r=n(42),s=n(39),o=n(43);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(241),r=n(74),s=n(77);t.exports=function(t,e,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),i(t,r(e)+n,s(e)+o),t}},function(t,e,n){var i=n(75),r=n(76);t.exports=function(t,e,n){return i(t,e),r(t,n)}},function(t,e,n){var i=n(77),r=n(40),s=n(76),o=n(41);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(77),r=n(42),s=n(76),o=n(43);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(74),r=n(44),s=n(75),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(40),r=n(44),s=n(41),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(43),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(144),r=n(87),s=n(23),o=n(4);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},function(t,e,n){var i=n(249),r=n(144),s=n(87),o=n(23);t.exports=function(t,e,n,a){void 0===a&&(a=[]),e||(e=i(t)/n);for(var u=0;u<e;u++){var l=s(u/e,0,o.PI2);a.push(r(t,l))}return a}},function(t,e){t.exports=function(t){return Math.PI*t.radius*2}},function(t,e,n){var i=n(22),r={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(t,e,n,r){return void 0===t&&(t=1),void 0===e?this.alpha=t:(this._alphaTL=i(t,0,1),this._alphaTR=i(e,0,1),this._alphaBL=i(n,0,1),this._alphaBR=i(r,0,1)),this},alpha:{get:function(){return this._alpha},set:function(t){var e=i(t,0,1);this._alpha=e,this._alphaTL=e,this._alphaTR=e,this._alphaBL=e,this._alphaBR=e,0===e?this.renderFlags&=-3:this.renderFlags|=2}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(t){var e=i(t,0,1);this._alphaTL=e,0!==e&&(this.renderFlags|=2)}},alphaTopRight:{get:function(){return this._alphaTR},set:function(t){var e=i(t,0,1);this._alphaTR=e,0!==e&&(this.renderFlags|=2)}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(t){var e=i(t,0,1);this._alphaBL=e,0!==e&&(this.renderFlags|=2)}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(t){var e=i(t,0,1);this._alphaBR=e,0!==e&&(this.renderFlags|=2)}}};t.exports=r},function(t,e){t.exports=function(t,e,n){if(!e.length)return NaN;if(1===e.length)return e[0];var i,r,s=1;if(n){if(t<e[0][n])return e[0];for(;e[s][n]<t;)s++}else for(;e[s]<t;)s++;return s>e.length&&(s=e.length),n?(r=e[s][n])-t<=t-(i=e[s-1][n])?e[s]:e[s-1]:(r=e[s])-t<=t-(i=e[s-1])?r:i}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.textureKey=t,this.textureFrame=e,this.index=n,this.frame=i,this.isFirst=!1,this.isLast=!1,this.prevFrame=null,this.nextFrame=null,this.duration=0,this.progress=0},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration}},destroy:function(){this.frame=void 0}});t.exports=i},function(t,e,n){var i=n(52),r={_blendMode:i.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(t){"string"==typeof t&&(t=i[t]),(t|=0)>=-1&&(this._blendMode=t)}},setBlendMode:function(t){return this.blendMode=t,this}};t.exports=r},function(t,e){t.exports={_depth:0,depth:{get:function(){return this._depth},set:function(t){this.scene.sys.queueDepthSort(),this._depth=t}},setDepth:function(t){return void 0===t&&(t=0),this.depth=t,this}}},function(t,e,n){var i=n(147),r=n(110);t.exports=function(t,e,n,s){void 0===s&&(s=[]),e||(e=r(t)/n);for(var o=0;o<e;o++)s.push(i(t,o/e));return s}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){return void 0===n&&(n=new i),n.x=t.x1+(t.x2-t.x1)*e,n.y=t.y1+(t.y2-t.y1)*e,n}},function(t,e){t.exports=function(t,e,n,i){var r=Math.cos(i),s=Math.sin(i),o=t.x-e,a=t.y-n;return t.x=o*r-a*s+e,t.y=o*s+a*r+n,t}},function(t,e,n){var i=n(259),r=n(260),s={mask:null,setMask:function(t){return this.mask=t,this},clearMask:function(t){return void 0===t&&(t=!1),t&&this.mask&&this.mask.destroy(),this.mask=null,this},createBitmapMask:function(t){return void 0===t&&(this.texture||this.shader)&&(t=this),new i(this.scene,t)},createGeometryMask:function(t){return void 0===t&&"Graphics"===this.type&&(t=this),new r(this.scene,t)}};t.exports=s},function(t,e,n){var i=n(0),r=n(17),s=new i({initialize:function(t,e){var n=t.sys.game.renderer;if(this.renderer=n,this.bitmapMask=e,this.maskTexture=null,this.mainTexture=null,this.dirty=!0,this.mainFramebuffer=null,this.maskFramebuffer=null,this.prevFramebuffer=null,this.invertAlpha=!1,this.isStencil=!1,n&&n.gl){var i=n.width,s=n.height,o=n.gl,a=0==(i&i-1)&&0==(s&s-1)?o.REPEAT:o.CLAMP_TO_EDGE,u=o.LINEAR;this.mainTexture=n.createTexture2D(0,u,u,a,a,o.RGBA,null,i,s),this.maskTexture=n.createTexture2D(0,u,u,a,a,o.RGBA,null,i,s),this.mainFramebuffer=n.createFramebuffer(i,s,this.mainTexture,!0),this.maskFramebuffer=n.createFramebuffer(i,s,this.maskTexture,!0),t.sys.game.events.on(r.CONTEXT_RESTORED,function(t){var e=t.width,n=t.height,i=t.gl,r=0==(e&e-1)&&0==(n&n-1)?i.REPEAT:i.CLAMP_TO_EDGE,s=i.LINEAR;this.mainTexture=t.createTexture2D(0,s,s,r,r,i.RGBA,null,e,n),this.maskTexture=t.createTexture2D(0,s,s,r,r,i.RGBA,null,e,n),this.mainFramebuffer=t.createFramebuffer(e,n,this.mainTexture,!0),this.maskFramebuffer=t.createFramebuffer(e,n,this.maskTexture,!0)},this)}},setBitmap:function(t){this.bitmapMask=t},preRenderWebGL:function(t,e,n){t.pipelines.BitmapMaskPipeline.beginMask(this,e,n)},postRenderWebGL:function(t,e){t.pipelines.BitmapMaskPipeline.endMask(this,e)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null;var t=this.renderer;t&&t.gl&&(t.deleteTexture(this.mainTexture),t.deleteTexture(this.maskTexture),t.deleteFramebuffer(this.mainFramebuffer),t.deleteFramebuffer(this.maskFramebuffer)),this.mainTexture=null,this.maskTexture=null,this.mainFramebuffer=null,this.maskFramebuffer=null,this.prevFramebuffer=null,this.renderer=null}});t.exports=s},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.geometryMask=e,this.invertAlpha=!1,this.isStencil=!0,this.level=0},setShape:function(t){return this.geometryMask=t,this},setInvertAlpha:function(t){return void 0===t&&(t=!0),this.invertAlpha=t,this},preRenderWebGL:function(t,e,n){var i=t.gl;t.flush(),0===t.maskStack.length&&(i.enable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),t.maskCount=0),t.currentCameraMask.mask!==this&&(t.currentMask.mask=this),t.maskStack.push({mask:this,camera:n}),this.applyStencil(t,n,!0),t.maskCount++},applyStencil:function(t,e,n){var i=t.gl,r=this.geometryMask,s=t.maskCount;i.colorMask(!1,!1,!1,!1),n?(i.stencilFunc(i.EQUAL,s,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR)):(i.stencilFunc(i.EQUAL,s+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR)),r.renderWebGL(t,r,0,e),t.flush(),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.stencilFunc(this.invertAlpha?i.NOTEQUAL:i.EQUAL,n?s+1:s,255)},postRenderWebGL:function(t){var e=t.gl;if(t.maskStack.pop(),t.maskCount--,0===t.maskStack.length)t.flush(),t.currentMask.mask=null,e.disable(e.STENCIL_TEST);else{t.flush();var n=t.maskStack[t.maskStack.length-1];n.mask.applyStencil(t,n.camera,!1),t.currentCameraMask.mask!==n.mask?(t.currentMask.mask=n.mask,t.currentMask.camera=n.camera):t.currentMask.mask=null}},preRenderCanvas:function(t,e,n){var i=this.geometryMask;t.currentContext.save(),i.renderCanvas(t,i,0,n,null,null,!0),t.currentContext.clip()},postRenderCanvas:function(t){t.currentContext.restore()},destroy:function(){this.geometryMask=null}});t.exports=i},function(t,e){t.exports={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(t,e){return void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this}}},function(t,e){t.exports=function(t){var e={name:t.name,type:t.type,x:t.x,y:t.y,depth:t.depth,scale:{x:t.scaleX,y:t.scaleY},origin:{x:t.originX,y:t.originY},flipX:t.flipX,flipY:t.flipY,rotation:t.rotation,alpha:t.alpha,visible:t.visible,blendMode:t.blendMode,textureKey:"",frameKey:"",data:{}};return t.texture&&(e.textureKey=t.texture.key,e.frameKey=t.frame.name),e}},function(t,e,n){var i=n(23),r=n(32),s=n(229),o=n(230),a={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(t){this._scaleX=t,this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleX:{get:function(){return this._scaleX},set:function(t){this._scaleX=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},scaleY:{get:function(){return this._scaleY},set:function(t){this._scaleY=t,0===t?this.renderFlags&=-5:this.renderFlags|=4}},angle:{get:function(){return o(this._rotation*i.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*i.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=s(t)}},setPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=n,this.w=i,this},setRandomPosition:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),this.x=t+Math.random()*n,this.y=e+Math.random()*i,this},setRotation:function(t){return void 0===t&&(t=0),this.rotation=t,this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,this},setScale:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scaleX=t,this.scaleY=e,this},setX:function(t){return void 0===t&&(t=0),this.x=t,this},setY:function(t){return void 0===t&&(t=0),this.y=t,this},setZ:function(t){return void 0===t&&(t=0),this.z=t,this},setW:function(t){return void 0===t&&(t=0),this.w=t,this},getLocalTransformMatrix:function(t){return void 0===t&&(t=new r),t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(t,e){void 0===t&&(t=new r),void 0===e&&(e=new r);var n=this.parentContainer;if(!n)return this.getLocalTransformMatrix(t);for(t.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);n;)e.applyITRS(n.x,n.y,n._rotation,n._scaleX,n._scaleY),e.multiply(t,t),n=n.parentContainer;return t},getParentRotation:function(){for(var t=0,e=this.parentContainer;e;)t+=e.rotation,e=e.parentContainer;return t}};t.exports=a},function(t,e){t.exports={_visible:!0,visible:{get:function(){return this._visible},set:function(t){t?(this._visible=!0,this.renderFlags|=1):(this._visible=!1,this.renderFlags&=-2)}},setVisible:function(t){return this.visible=t,this}}},function(t,e,n){t.exports={CHANGE_DATA:n(551),CHANGE_DATA_KEY:n(552),REMOVE_DATA:n(553),SET_DATA:n(554)}},function(t,e,n){var i=n(110),r=n(4);t.exports=function(t,e,n,s){if(void 0===s&&(s=[]),!e&&!n)return s;e?n=Math.round(i(t)/e):e=i(t)/n;for(var o=t.x,a=t.y,u=0,l=0;l<n;l++)switch(s.push(new r(o,a)),u){case 0:(o+=e)>=t.right&&(u=1,a+=o-t.right,o=t.right);break;case 1:(a+=e)>=t.bottom&&(u=2,o-=a-t.bottom,a=t.bottom);break;case 2:(o-=e)<=t.left&&(u=3,a-=t.left-o,o=t.left);break;case 3:(a-=e)<=t.top&&(u=0,a=t.top)}return s}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.shift(),t.push(n);return n}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);for(var n=null,i=0;i<e;i++)n=t.pop(),t.unshift(n);return n}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=[]);var i=Math.round(t.x1),r=Math.round(t.y1),s=Math.round(t.x2),o=Math.round(t.y2),a=Math.abs(s-i),u=Math.abs(o-r),l=i<s?1:-1,c=r<o?1:-1,h=a-u;n.push({x:i,y:r});for(var d=1;i!==s||r!==o;){var f=h<<1;f>-u&&(h-=u,i+=l),f<a&&(h+=a,r+=c),d%e==0&&n.push({x:i,y:r}),d++}return n}},function(t,e,n){var i=n(146),r=n(0),s=n(157),o=n(9),a=n(109),u=n(17),l=n(6),c=n(158),h=new r({Extends:o,initialize:function(t){o.call(this),this.game=t,this.textureManager=null,this.globalTimeScale=1,this.anims=new s,this.paused=!1,this.name="AnimationManager",t.events.once(u.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures,this.game.events.once(u.DESTROY,this.destroy,this)},add:function(t,e){if(!this.anims.has(t))return e.key=t,this.anims.set(t,e),this.emit(a.ADD_ANIMATION,t,e),this;console.warn("Animation key exists: "+t)},exists:function(t){return this.anims.has(t)},create:function(t){var e=t.key,n=!1;return e&&((n=this.get(e))||(n=new i(this,e,t),this.anims.set(e,n),this.emit(a.ADD_ANIMATION,e,n))),n},fromJSON:function(t,e){void 0===e&&(e=!1),e&&this.anims.clear(),"string"==typeof t&&(t=JSON.parse(t));var n=[];if(t.hasOwnProperty("anims")&&Array.isArray(t.anims)){for(var i=0;i<t.anims.length;i++)n.push(this.create(t.anims[i]));t.hasOwnProperty("globalTimeScale")&&(this.globalTimeScale=t.globalTimeScale)}else t.hasOwnProperty("key")&&"frame"===t.type&&n.push(this.create(t));return n},generateFrameNames:function(t,e){var n=l(e,"prefix",""),i=l(e,"start",0),r=l(e,"end",0),s=l(e,"suffix",""),o=l(e,"zeroPad",0),a=l(e,"outputArray",[]),u=l(e,"frames",!1),h=this.textureManager.get(t);if(!h)return a;var d,f,p=i<r?1:-1;if(r+=p,e)if(Array.isArray(u))for(d=0;d<u.length;d++)f=n+c(u[d],o,"0",1)+s,h.has(f)&&a.push({key:t,frame:f});else for(d=i;d!==r;d+=p)f=n+c(d,o,"0",1)+s,h.has(f)&&a.push({key:t,frame:f});else for(u=h.getFrameNames(),d=0;d<u.length;d++)a.push({key:t,frame:u[d]});return a},generateFrameNumbers:function(t,e){var n,i=l(e,"start",0),r=l(e,"end",-1),s=l(e,"first",!1),o=l(e,"outputArray",[]),a=l(e,"frames",!1),u=this.textureManager.get(t);if(!u)return o;if(s&&u.has(s)&&o.push({key:t,frame:s}),Array.isArray(a))for(n=0;n<a.length;n++)u.has(a[n])&&o.push({key:t,frame:a[n]});else{-1===r&&(r=u.frameTotal);var c=i<r?1:-1;for(r+=c,n=i;n!==r;n+=c)u.has(n)&&o.push({key:t,frame:n})}return o},get:function(t){return this.anims.get(t)},load:function(t,e,n){var i=this.get(e);return i?i.load(t,n):console.warn("Missing animation: "+e),t},pauseAll:function(){return this.paused||(this.paused=!0,this.emit(a.PAUSE_ALL)),this},play:function(t,e){if(Array.isArray(e)||(e=[e]),this.get(t)){for(var n=0;n<e.length;n++)e[n].anims.play(t);return this}},remove:function(t){var e=this.get(t);return e&&(this.emit(a.REMOVE_ANIMATION,t,e),this.anims.delete(t)),e},resumeAll:function(){return this.paused&&(this.paused=!1,this.emit(a.RESUME_ALL)),this},staggerPlay:function(t,e,n){if(void 0===n&&(n=0),Array.isArray(e)||(e=[e]),this.get(t)){for(var i=0;i<e.length;i++)e[i].anims.delayedPlay(n*i,t);return this}},toJSON:function(t){if(void 0!==t&&""!==t)return this.anims.get(t).toJSON();var e={anims:[],globalTimeScale:this.globalTimeScale};return this.anims.each(function(t,n){e.anims.push(n.toJSON())}),e},destroy:function(){this.anims.clear(),this.textureManager=null,this.game=null}});t.exports=h},function(t,e,n){var i=n(0),r=n(157),s=n(9),o=n(272),a=new i({initialize:function(){this.entries=new r,this.events=new s},add:function(t,e){return this.entries.set(t,e),this.events.emit(o.ADD,this,t,e),this},has:function(t){return this.entries.has(t)},exists:function(t){return this.entries.has(t)},get:function(t){return this.entries.get(t)},remove:function(t){var e=this.get(t);return e&&(this.entries.delete(t),this.events.emit(o.REMOVE,this,t,e.data)),this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear(),this.events.removeAllListeners(),this.entries=null,this.events=null}});t.exports=a},function(t,e,n){t.exports={ADD:n(610),REMOVE:n(611)}},function(t,e,n){var i=n(271),r=n(0),s=n(17),o=new r({initialize:function(t){this.game=t,this.binary=new i,this.bitmapFont=new i,this.json=new i,this.physics=new i,this.shader=new i,this.audio=new i,this.video=new i,this.text=new i,this.html=new i,this.obj=new i,this.tilemap=new i,this.xml=new i,this.custom={},this.game.events.once(s.DESTROY,this.destroy,this)},addCustom:function(t){return this.custom.hasOwnProperty(t)||(this.custom[t]=new i),this.custom[t]},destroy:function(){for(var t=["binary","bitmapFont","json","physics","shader","audio","video","text","html","obj","tilemap","xml"],e=0;e<t.length;e++)this[t[e]].destroy(),this[t[e]]=null;for(var n in this.custom)this.custom[n].destroy();this.custom=null,this.game=null}});t.exports=o},function(t,e,n){var i=n(91),r=n(25),s=n(163),o=n(22),a=n(0),u=n(12),l=n(282),c=n(113),h=n(11),d=n(3),f=new a({Extends:i,Mixins:[u.Flip,u.Tint],initialize:function(t,e,n,r){i.call(this,t,e,n,r),this.inputEnabled=!0,this.fadeEffect=new l.Fade(this),this.flashEffect=new l.Flash(this),this.shakeEffect=new l.Shake(this),this.panEffect=new l.Pan(this),this.zoomEffect=new l.Zoom(this),this.lerp=new d(1,1),this.followOffset=new d,this.deadzone=null,this._follow=null,this.renderToTexture=!1,this.canvas=null,this.context=null,this.glTexture=null,this.framebuffer=null,this.pipeline=null},setRenderToTexture:function(t){var e=this.scene.sys.game.renderer;return e.gl?(this.glTexture=e.createTextureFromSource(null,this.width,this.height,0),this.framebuffer=e.createFramebuffer(this.width,this.height,this.glTexture,!1)):(this.canvas=r.create2D(this,this.width,this.height),this.context=this.canvas.getContext("2d")),this.renderToTexture=!0,t&&this.setPipeline(t),this},setPipeline:function(t){if("string"==typeof t){var e=this.scene.sys.game.renderer;e.gl&&e.hasPipeline(t)&&(this.pipeline=e.getPipeline(t))}else this.pipeline=t;return this},clearRenderToTexture:function(){if(this.scene){var t=this.scene.sys.game.renderer;if(t)return t.gl?(this.framebuffer&&t.deleteFramebuffer(this.framebuffer),this.glTexture&&t.deleteTexture(this.glTexture),this.framebuffer=null,this.glTexture=null,this.pipeline=null):(r.remove(this),this.canvas=null,this.context=null),this.renderToTexture=!1,this}},setDeadzone:function(t,e){if(void 0===t)this.deadzone=null;else{if(this.deadzone?(this.deadzone.width=t,this.deadzone.height=e):this.deadzone=new h(0,0,t,e),this._follow){var n=this.width/2,i=this.height/2,r=this._follow.x-this.followOffset.x,o=this._follow.y-this.followOffset.y;this.midPoint.set(r,o),this.scrollX=r-n,this.scrollY=o-i}s(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(t,e,n,i,r,s){return this.fadeEffect.start(!1,t,e,n,i,!0,r,s)},fadeOut:function(t,e,n,i,r,s){return this.fadeEffect.start(!0,t,e,n,i,!0,r,s)},fadeFrom:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!1,t,e,n,i,r,s,o)},fade:function(t,e,n,i,r,s,o){return this.fadeEffect.start(!0,t,e,n,i,r,s,o)},flash:function(t,e,n,i,r,s,o){return this.flashEffect.start(t,e,n,i,r,s,o)},shake:function(t,e,n,i,r){return this.shakeEffect.start(t,e,n,i,r)},pan:function(t,e,n,i,r,s,o){return this.panEffect.start(t,e,n,i,r,s,o)},zoomTo:function(t,e,n,i,r,s){return this.zoomEffect.start(t,e,n,i,r,s)},preRender:function(t){var e=this.width,n=this.height,i=.5*e,r=.5*n,o=this.zoom*t,a=this.matrix,u=e*this.originX,l=n*this.originY,h=this._follow,d=this.deadzone,f=this.scrollX,p=this.scrollY;if(d&&s(d,this.midPoint.x,this.midPoint.y),h&&!this.panEffect.isRunning){var m=h.x-this.followOffset.x,g=h.y-this.followOffset.y;d?(m<d.x?f=c(f,f-(d.x-m),this.lerp.x):m>d.right&&(f=c(f,f+(m-d.right),this.lerp.x)),g<d.y?p=c(p,p-(d.y-g),this.lerp.y):g>d.bottom&&(p=c(p,p+(g-d.bottom),this.lerp.y))):(f=c(f,m-u,this.lerp.x),p=c(p,g-l,this.lerp.y))}this.useBounds&&(f=this.clampX(f),p=this.clampY(p)),this.roundPixels&&(u=Math.round(u),l=Math.round(l)),this.scrollX=f,this.scrollY=p;var y=f+i,v=p+r;this.midPoint.set(y,v);var b=e/o,x=n/o;this.worldView.setTo(y-b/2,v-x/2,b,x),a.applyITRS(this.x+u,this.y+l,this.rotation,o,o),a.translate(-u,-l),this.shakeEffect.preRender()},setLerp:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.lerp.set(t,e),this},setFollowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.followOffset.set(t,e),this},startFollow:function(t,e,n,i,r,s){void 0===e&&(e=!1),void 0===n&&(n=1),void 0===i&&(i=n),void 0===r&&(r=0),void 0===s&&(s=r),this._follow=t,this.roundPixels=e,n=o(n,0,1),i=o(i,0,1),this.lerp.set(n,i),this.followOffset.set(r,s);var a=this.width/2,u=this.height/2,l=t.x-r,c=t.y-s;return this.midPoint.set(l,c),this.scrollX=l-a,this.scrollY=c-u,this.useBounds&&(this.scrollX=this.clampX(this.scrollX),this.scrollY=this.clampY(this.scrollY)),this},stopFollow:function(){return this._follow=null,this},resetFX:function(){return this.panEffect.reset(),this.shakeEffect.reset(),this.flashEffect.reset(),this.fadeEffect.reset(),this},update:function(t,e){this.visible&&(this.panEffect.update(t,e),this.zoomEffect.update(t,e),this.shakeEffect.update(t,e),this.flashEffect.update(t,e),this.fadeEffect.update(t,e))},destroy:function(){this.clearRenderToTexture(),this.resetFX(),i.prototype.destroy.call(this),this._follow=null,this.deadzone=null}});t.exports=f},function(t,e,n){var i=n(33);t.exports=function(t){var e=new i;t=t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,i){return e+e+n+n+i+i});var n=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(n){var r=parseInt(n[1],16),s=parseInt(n[2],16),o=parseInt(n[3],16);e.setTo(r,s,o)}return e}},function(t,e){t.exports=function(t,e,n,i){return i<<24|t<<16|e<<8|n}},function(t,e){t.exports=function(t,e,n,i){void 0===i&&(i={h:0,s:0,v:0}),t/=255,e/=255,n/=255;var r=Math.min(t,e,n),s=Math.max(t,e,n),o=s-r,a=0,u=0===s?0:o/s,l=s;return s!==r&&(s===t?a=(e-n)/o+(e<n?6:0):s===e?a=(n-t)/o+2:s===n&&(a=(t-e)/o+4),a/=6),i.hasOwnProperty("_h")?(i._h=a,i._s=u,i._v=l):(i.h=a,i.s=u,i.v=l),i}},function(t,e,n){var i=n(33),r=n(279);t.exports=function(t){var e=r(t);return new i(e.r,e.g,e.b,e.a)}},function(t,e){t.exports=function(t){return t>16777215?{a:t>>>24,r:t>>16&255,g:t>>8&255,b:255&t}:{a:255,r:t>>16&255,g:t>>8&255,b:255&t}}},function(t,e,n){var i=n(33);t.exports=function(t){return new i(t.r,t.g,t.b,t.a)}},function(t,e,n){var i=n(33);t.exports=function(t){var e=new i,n=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t.toLowerCase());if(n){var r=parseInt(n[1],10),s=parseInt(n[2],10),o=parseInt(n[3],10),a=void 0!==n[4]?parseFloat(n[4]):1;e.setTo(r,s,o,255*a)}return e}},function(t,e,n){t.exports={Fade:n(632),Flash:n(633),Pan:n(634),Shake:n(667),Zoom:n(668)}},function(t,e,n){t.exports={In:n(635),Out:n(636),InOut:n(637)}},function(t,e,n){t.exports={In:n(638),Out:n(639),InOut:n(640)}},function(t,e,n){t.exports={In:n(641),Out:n(642),InOut:n(643)}},function(t,e,n){t.exports={In:n(644),Out:n(645),InOut:n(646)}},function(t,e,n){t.exports={In:n(647),Out:n(648),InOut:n(649)}},function(t,e,n){t.exports={In:n(650),Out:n(651),InOut:n(652)}},function(t,e,n){t.exports=n(653)},function(t,e,n){t.exports={In:n(654),Out:n(655),InOut:n(656)}},function(t,e,n){t.exports={In:n(657),Out:n(658),InOut:n(659)}},function(t,e,n){t.exports={In:n(660),Out:n(661),InOut:n(662)}},function(t,e,n){t.exports={In:n(663),Out:n(664),InOut:n(665)}},function(t,e,n){t.exports=n(666)},function(t,e,n){var i=n(0),r=n(29),s=n(296),o=n(2),a=n(6),u=n(7),l=n(166),c=n(1),h=n(172),d=n(159),f=new i({initialize:function(t){void 0===t&&(t={}),this.width=a(t,"width",1024),this.height=a(t,"height",768),this.zoom=a(t,"zoom",1),this.resolution=a(t,"resolution",1),this.parent=a(t,"parent",void 0),this.scaleMode=a(t,"scaleMode",0),this.expandParent=a(t,"expandParent",!0),this.autoRound=a(t,"autoRound",!1),this.autoCenter=a(t,"autoCenter",0),this.resizeInterval=a(t,"resizeInterval",500),this.fullscreenTarget=a(t,"fullscreenTarget",null),this.minWidth=a(t,"minWidth",0),this.maxWidth=a(t,"maxWidth",0),this.minHeight=a(t,"minHeight",0),this.maxHeight=a(t,"maxHeight",0);var e=a(t,"scale",null);e&&(this.width=a(e,"width",this.width),this.height=a(e,"height",this.height),this.zoom=a(e,"zoom",this.zoom),this.resolution=a(e,"resolution",this.resolution),this.parent=a(e,"parent",this.parent),this.scaleMode=a(e,"mode",this.scaleMode),this.expandParent=a(e,"expandParent",this.expandParent),this.autoRound=a(e,"autoRound",this.autoRound),this.autoCenter=a(e,"autoCenter",this.autoCenter),this.resizeInterval=a(e,"resizeInterval",this.resizeInterval),this.fullscreenTarget=a(e,"fullscreenTarget",this.fullscreenTarget),this.minWidth=a(e,"min.width",this.minWidth),this.maxWidth=a(e,"max.width",this.maxWidth),this.minHeight=a(e,"min.height",this.minHeight),this.maxHeight=a(e,"max.height",this.maxHeight)),this.renderType=a(t,"type",r.AUTO),this.canvas=a(t,"canvas",null),this.context=a(t,"context",null),this.canvasStyle=a(t,"canvasStyle",null),this.customEnvironment=a(t,"customEnvironment",!1),this.sceneConfig=a(t,"scene",null),this.seed=a(t,"seed",[(Date.now()*Math.random()).toString()]),l.RND=new l.RandomDataGenerator(this.seed),this.gameTitle=a(t,"title",""),this.gameURL=a(t,"url","https://phaser.io"),this.gameVersion=a(t,"version",""),this.autoFocus=a(t,"autoFocus",!0),this.domCreateContainer=a(t,"dom.createContainer",!1),this.domBehindCanvas=a(t,"dom.behindCanvas",!1),this.inputKeyboard=a(t,"input.keyboard",!0),this.inputKeyboardEventTarget=a(t,"input.keyboard.target",window),this.inputKeyboardCapture=a(t,"input.keyboard.capture",[]),this.inputMouse=a(t,"input.mouse",!0),this.inputMouseEventTarget=a(t,"input.mouse.target",null),this.inputMouseCapture=a(t,"input.mouse.capture",!0),this.inputTouch=a(t,"input.touch",s.input.touch),this.inputTouchEventTarget=a(t,"input.touch.target",null),this.inputTouchCapture=a(t,"input.touch.capture",!0),this.inputActivePointers=a(t,"input.activePointers",1),this.inputSmoothFactor=a(t,"input.smoothFactor",0),this.inputWindowEvents=a(t,"input.windowEvents",!0),this.inputGamepad=a(t,"input.gamepad",!1),this.inputGamepadEventTarget=a(t,"input.gamepad.target",window),this.disableContextMenu=a(t,"disableContextMenu",!1),this.audio=a(t,"audio"),this.hideBanner=!1===a(t,"banner",null),this.hidePhaser=a(t,"banner.hidePhaser",!1),this.bannerTextColor=a(t,"banner.text","#ffffff"),this.bannerBackgroundColor=a(t,"banner.background",["#ff0000","#ffff00","#00ff00","#00ffff","#000000"]),""===this.gameTitle&&this.hidePhaser&&(this.hideBanner=!0),this.fps=a(t,"fps",null);var n=a(t,"render",t);this.antialias=a(n,"antialias",!0),this.antialiasGL=a(n,"antialiasGL",!0),this.desynchronized=a(n,"desynchronized",!1),this.roundPixels=a(n,"roundPixels",!1),this.pixelArt=a(n,"pixelArt",1!==this.zoom),this.pixelArt&&(this.antialias=!1,this.roundPixels=!0),this.transparent=a(n,"transparent",!1),this.clearBeforeRender=a(n,"clearBeforeRender",!0),this.premultipliedAlpha=a(n,"premultipliedAlpha",!0),this.failIfMajorPerformanceCaveat=a(n,"failIfMajorPerformanceCaveat",!1),this.powerPreference=a(n,"powerPreference","default"),this.batchSize=a(n,"batchSize",2e3),this.maxLights=a(n,"maxLights",10);var i=a(t,"backgroundColor",0);this.backgroundColor=d(i),0===i&&this.transparent&&(this.backgroundColor.alpha=0),this.preBoot=a(t,"callbacks.preBoot",c),this.postBoot=a(t,"callbacks.postBoot",c),this.physics=a(t,"physics",{}),this.defaultPhysicsSystem=a(this.physics,"default",!1),this.loaderBaseURL=a(t,"loader.baseURL",""),this.loaderPath=a(t,"loader.path",""),this.loaderMaxParallelDownloads=a(t,"loader.maxParallelDownloads",32),this.loaderCrossOrigin=a(t,"loader.crossOrigin",void 0),this.loaderResponseType=a(t,"loader.responseType",""),this.loaderAsync=a(t,"loader.async",!0),this.loaderUser=a(t,"loader.user",""),this.loaderPassword=a(t,"loader.password",""),this.loaderTimeout=a(t,"loader.timeout",0),this.installGlobalPlugins=[],this.installScenePlugins=[];var f=a(t,"plugins",null),p=h.DefaultScene;f&&(Array.isArray(f)?this.defaultPlugins=f:u(f)&&(this.installGlobalPlugins=o(f,"global",[]),this.installScenePlugins=o(f,"scene",[]),Array.isArray(f.default)?p=f.default:Array.isArray(f.defaultMerge)&&(p=p.concat(f.defaultMerge)))),this.defaultPlugins=p;var m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg";this.defaultImage=a(t,"images.default",m+"AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg=="),this.missingImage=a(t,"images.missing",m+"CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg=="),window&&(window.FORCE_WEBGL?this.renderType=r.WEBGL:window.FORCE_CANVAS&&(this.renderType=r.CANVAS))}});t.exports=f},function(t,e,n){t.exports={os:n(114),browser:n(115),features:n(165),input:n(697),audio:n(698),video:n(699),fullscreen:n(700),canvasFeatures:n(297)}},function(t,e,n){var i,r,s,o=n(25),a={supportInverseAlpha:!1,supportNewBlendModes:!1};t.exports=(void 0!==document&&(a.supportNewBlendModes=(i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",r="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",(s=new Image).onload=function(){var t=new Image;t.onload=function(){var e=o.create(t,6,1).getContext("2d");if(e.globalCompositeOperation="multiply",e.drawImage(s,0,0),e.drawImage(t,2,0),!e.getImageData(2,0,1,1))return!1;var n=e.getImageData(2,0,1,1).data;o.remove(t),a.supportNewBlendModes=255===n[0]&&0===n[1]&&0===n[2]},t.src=i+"/wCKxvRF"+r},s.src=i+"AP804Oa6"+r,!1),a.supportInverseAlpha=function(){var t=o.create(this,2,1).getContext("2d");t.fillStyle="rgba(10, 20, 30, 0.5)",t.fillRect(0,0,1,1);var e=t.getImageData(0,0,1,1);if(null===e)return!1;t.putImageData(e,1,0);var n=t.getImageData(1,0,1,1);return n.data[0]===e.data[0]&&n.data[1]===e.data[1]&&n.data[2]===e.data[2]&&n.data[3]===e.data[3]}()),a)},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(i-e,n-t)}},function(t,e){t.exports=function(t){return(t%=2*Math.PI)>=0?t:t+2*Math.PI}},function(t,e){t.exports=function(t,e,n,i){var r=t-n,s=e-i;return r*r+s*s}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t>e-n}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=1e-4),t<e+n}},function(t,e,n){var i=n(304);t.exports=function(t,e){return i(t)/i(e)/i(t-e)}},function(t,e){t.exports=function(t){if(0===t)return 1;for(var e=t;--t;)e*=t;return e}},function(t,e){t.exports=function(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}},function(t,e){t.exports=function(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}},function(t,e,n){var i=n(156);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e){t.exports=function(t){var e=Math.log(t)/.6931471805599453;return 1<<Math.ceil(e)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.ceil(t/e),i?(n+t)/e:n+t)}},function(t,e){t.exports=function(t,e){return Math.random()*(e-t)+t}},function(t,e){t.exports=function(t,e){var n=t.x,i=t.y;return t.x=n*Math.cos(e)-i*Math.sin(e),t.y=n*Math.sin(e)+i*Math.cos(e),t}},function(t,e){t.exports=function(t){return t>0?Math.ceil(t):Math.floor(t)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s,o,a,u){void 0===u&&(u=new i);var l=Math.sin(s),c=Math.cos(s),h=c*o,d=l*o,f=-l*a,p=c*a,m=1/(h*p+f*-d);return u.x=p*m*t+-f*m*e+(r*f-n*p)*m,u.y=h*m*e+-d*m*t+(-r*h+n*d)*m,u}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){this.x=0,this.y=0,this.z=0,this.w=0,"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},clone:function(){return new i(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z||0,this.w=t.w||0,this},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z||0,this.w+=t.w||0,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z||0,this.w-=t.w||0,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this.x=t*r,this.y=e*r,this.z=n*r,this.w=i*r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this.w=s+e*(t.w-s),this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z||1,this.w*=t.w||1,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z||1,this.w/=t.w||1,this},distance:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return Math.sqrt(e*e+n*n+i*i+r*r)},distanceSq:function(t){var e=t.x-this.x,n=t.y-this.y,i=t.z-this.z||0,r=t.w-this.w||0;return e*e+n*n+i*i+r*r},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},transformMat4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.val;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this},transformQuat:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,u=a*e+s*i-o*n,l=a*n+o*e-r*i,c=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=u*a+h*-r+l*-o-c*-s,this.y=l*a+h*-s+c*-r-u*-o,this.z=c*a+h*-o+u*-s-l*-r,this},reset:function(){return this.x=0,this.y=0,this.z=0,this.w=0,this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.distSq=i.prototype.distanceSq,i.prototype.len=i.prototype.length,i.prototype.lenSq=i.prototype.lengthSq,t.exports=i},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(9),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},fromMat4:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],u=t[7],l=t[8],c=l*s-o*u,h=-l*r+o*a,d=u*r-s*a,f=e*c+n*h+i*d;return f?(t[0]=c*(f=1/f),t[1]=(-l*n+i*u)*f,t[2]=(o*n-i*s)*f,t[3]=h*f,t[4]=(l*e-i*a)*f,t[5]=(-o*e+i*r)*f,t[6]=d*f,t[7]=(-u*e+n*a)*f,t[8]=(s*e-n*r)*f,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],u=t[7],l=t[8];return t[0]=s*l-o*u,t[1]=i*u-n*l,t[2]=n*o-i*s,t[3]=o*a-r*l,t[4]=e*l-i*a,t[5]=i*r-e*o,t[6]=r*u-s*a,t[7]=n*a-e*u,t[8]=e*s-n*r,this},determinant:function(){var t=this.val,e=t[3],n=t[4],i=t[5],r=t[6],s=t[7],o=t[8];return t[0]*(o*n-i*s)+t[1]*(-o*e+i*r)+t[2]*(s*e-n*r)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=t.val,d=h[0],f=h[1],p=h[2],m=h[3],g=h[4],y=h[5],v=h[6],b=h[7],x=h[8];return e[0]=d*n+f*s+p*u,e[1]=d*i+f*o+p*l,e[2]=d*r+f*a+p*c,e[3]=m*n+g*s+y*u,e[4]=m*i+g*o+y*l,e[5]=m*r+g*a+y*c,e[6]=v*n+b*s+x*u,e[7]=v*i+b*o+x*l,e[8]=v*r+b*a+x*c,this},translate:function(t){var e=this.val,n=t.x,i=t.y;return e[6]=n*e[0]+i*e[3]+e[6],e[7]=n*e[1]+i*e[4]+e[7],e[8]=n*e[2]+i*e[5]+e[8],this},rotate:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=Math.sin(t),l=Math.cos(t);return e[0]=l*n+u*s,e[1]=l*i+u*o,e[2]=l*r+u*a,e[3]=l*s-u*n,e[4]=l*o-u*i,e[5]=l*a-u*r,this},scale:function(t){var e=this.val,n=t.x,i=t.y;return e[0]=n*e[0],e[1]=n*e[1],e[2]=n*e[2],e[3]=i*e[3],e[4]=i*e[4],e[5]=i*e[5],this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,o=n+n,a=i+i,u=e*s,l=e*o,c=e*a,h=n*o,d=n*a,f=i*a,p=r*s,m=r*o,g=r*a,y=this.val;return y[0]=1-(h+f),y[3]=l+g,y[6]=c-m,y[1]=l-g,y[4]=1-(u+f),y[7]=d+p,y[2]=c+m,y[5]=d-p,y[8]=1-(u+h),this},normalFromMat4:function(t){var e=t.val,n=this.val,i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],y=e[14],v=e[15],b=i*u-r*a,x=i*l-s*a,w=i*c-o*a,T=r*l-s*u,S=r*c-o*u,E=s*c-o*l,O=h*g-d*m,C=h*y-f*m,_=h*v-p*m,A=d*y-f*g,k=d*v-p*g,R=f*v-p*y,I=b*R-x*k+w*A+T*_-S*C+E*O;return I?(n[0]=(u*R-l*k+c*A)*(I=1/I),n[1]=(l*_-a*R-c*C)*I,n[2]=(a*k-u*_+c*O)*I,n[3]=(s*k-r*R-o*A)*I,n[4]=(i*R-s*_+o*C)*I,n[5]=(r*_-i*k-o*O)*I,n[6]=(g*E-y*S+v*T)*I,n[7]=(y*w-m*E-v*x)*I,n[8]=(m*S-g*w+v*b)*I,this):null}});t.exports=i},function(t,e,n){var i=new(n(0))({initialize:function(t){this.val=new Float32Array(16),t?this.copy(t):this.identity()},clone:function(){return new i(this)},set:function(t){return this.copy(t)},copy:function(t){var e=this.val,n=t.val;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},fromArray:function(t){var e=this.val;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},zero:function(){var t=this.val;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=0,this},xyz:function(t,e,n){this.identity();var i=this.val;return i[12]=t,i[13]=e,i[14]=n,this},scaling:function(t,e,n){this.zero();var i=this.val;return i[0]=t,i[5]=e,i[10]=n,i[15]=1,this},identity:function(){var t=this.val;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},transpose:function(){var t=this.val,e=t[1],n=t[2],i=t[3],r=t[6],s=t[7],o=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=r,t[11]=t[14],t[12]=i,t[13]=s,t[14]=o,this},invert:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],y=e*o-n*s,v=e*a-i*s,b=e*u-r*s,x=n*a-i*o,w=n*u-r*o,T=i*u-r*a,S=l*p-c*f,E=l*m-h*f,O=l*g-d*f,C=c*m-h*p,_=c*g-d*p,A=h*g-d*m,k=y*A-v*_+b*C+x*O-w*E+T*S;return k?(t[0]=(o*A-a*_+u*C)*(k=1/k),t[1]=(i*_-n*A-r*C)*k,t[2]=(p*T-m*w+g*x)*k,t[3]=(h*w-c*T-d*x)*k,t[4]=(a*O-s*A-u*E)*k,t[5]=(e*A-i*O+r*E)*k,t[6]=(m*b-f*T-g*v)*k,t[7]=(l*T-h*b+d*v)*k,t[8]=(s*_-o*O+u*S)*k,t[9]=(n*O-e*_-r*S)*k,t[10]=(f*w-p*b+g*y)*k,t[11]=(c*b-l*w-d*y)*k,t[12]=(o*E-s*C-a*S)*k,t[13]=(e*C-n*E+i*S)*k,t[14]=(p*v-f*x-m*y)*k,t[15]=(l*x-c*v+h*y)*k,this):null},adjoint:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return t[0]=o*(h*g-d*m)-c*(a*g-u*m)+p*(a*d-u*h),t[1]=-(n*(h*g-d*m)-c*(i*g-r*m)+p*(i*d-r*h)),t[2]=n*(a*g-u*m)-o*(i*g-r*m)+p*(i*u-r*a),t[3]=-(n*(a*d-u*h)-o*(i*d-r*h)+c*(i*u-r*a)),t[4]=-(s*(h*g-d*m)-l*(a*g-u*m)+f*(a*d-u*h)),t[5]=e*(h*g-d*m)-l*(i*g-r*m)+f*(i*d-r*h),t[6]=-(e*(a*g-u*m)-s*(i*g-r*m)+f*(i*u-r*a)),t[7]=e*(a*d-u*h)-s*(i*d-r*h)+l*(i*u-r*a),t[8]=s*(c*g-d*p)-l*(o*g-u*p)+f*(o*d-u*c),t[9]=-(e*(c*g-d*p)-l*(n*g-r*p)+f*(n*d-r*c)),t[10]=e*(o*g-u*p)-s*(n*g-r*p)+f*(n*u-r*o),t[11]=-(e*(o*d-u*c)-s*(n*d-r*c)+l*(n*u-r*o)),t[12]=-(s*(c*m-h*p)-l*(o*m-a*p)+f*(o*h-a*c)),t[13]=e*(c*m-h*p)-l*(n*m-i*p)+f*(n*h-i*c),t[14]=-(e*(o*m-a*p)-s*(n*m-i*p)+f*(n*a-i*o)),t[15]=e*(o*h-a*c)-s*(n*h-i*c)+l*(n*a-i*o),this},determinant:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return(e*o-n*s)*(h*g-d*m)-(e*a-i*s)*(c*g-d*p)+(e*u-r*s)*(c*m-h*p)+(n*a-i*o)*(l*g-d*f)-(n*u-r*o)*(l*m-h*f)+(i*u-r*a)*(l*p-c*f)},multiply:function(t){var e=this.val,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=t.val,b=v[0],x=v[1],w=v[2],T=v[3];return e[0]=b*n+x*o+w*c+T*p,e[1]=b*i+x*a+w*h+T*m,e[2]=b*r+x*u+w*d+T*g,e[3]=b*s+x*l+w*f+T*y,e[4]=(b=v[4])*n+(x=v[5])*o+(w=v[6])*c+(T=v[7])*p,e[5]=b*i+x*a+w*h+T*m,e[6]=b*r+x*u+w*d+T*g,e[7]=b*s+x*l+w*f+T*y,e[8]=(b=v[8])*n+(x=v[9])*o+(w=v[10])*c+(T=v[11])*p,e[9]=b*i+x*a+w*h+T*m,e[10]=b*r+x*u+w*d+T*g,e[11]=b*s+x*l+w*f+T*y,e[12]=(b=v[12])*n+(x=v[13])*o+(w=v[14])*c+(T=v[15])*p,e[13]=b*i+x*a+w*h+T*m,e[14]=b*r+x*u+w*d+T*g,e[15]=b*s+x*l+w*f+T*y,this},multiplyLocal:function(t){var e=[],n=this.val,i=t.val;return e[0]=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12],e[1]=n[0]*i[1]+n[1]*i[5]+n[2]*i[9]+n[3]*i[13],e[2]=n[0]*i[2]+n[1]*i[6]+n[2]*i[10]+n[3]*i[14],e[3]=n[0]*i[3]+n[1]*i[7]+n[2]*i[11]+n[3]*i[15],e[4]=n[4]*i[0]+n[5]*i[4]+n[6]*i[8]+n[7]*i[12],e[5]=n[4]*i[1]+n[5]*i[5]+n[6]*i[9]+n[7]*i[13],e[6]=n[4]*i[2]+n[5]*i[6]+n[6]*i[10]+n[7]*i[14],e[7]=n[4]*i[3]+n[5]*i[7]+n[6]*i[11]+n[7]*i[15],e[8]=n[8]*i[0]+n[9]*i[4]+n[10]*i[8]+n[11]*i[12],e[9]=n[8]*i[1]+n[9]*i[5]+n[10]*i[9]+n[11]*i[13],e[10]=n[8]*i[2]+n[9]*i[6]+n[10]*i[10]+n[11]*i[14],e[11]=n[8]*i[3]+n[9]*i[7]+n[10]*i[11]+n[11]*i[15],e[12]=n[12]*i[0]+n[13]*i[4]+n[14]*i[8]+n[15]*i[12],e[13]=n[12]*i[1]+n[13]*i[5]+n[14]*i[9]+n[15]*i[13],e[14]=n[12]*i[2]+n[13]*i[6]+n[14]*i[10]+n[15]*i[14],e[15]=n[12]*i[3]+n[13]*i[7]+n[14]*i[11]+n[15]*i[15],this.fromArray(e)},translate:function(t){var e=t.x,n=t.y,i=t.z,r=this.val;return r[12]=r[0]*e+r[4]*n+r[8]*i+r[12],r[13]=r[1]*e+r[5]*n+r[9]*i+r[13],r[14]=r[2]*e+r[6]*n+r[10]*i+r[14],r[15]=r[3]*e+r[7]*n+r[11]*i+r[15],this},translateXYZ:function(t,e,n){var i=this.val;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this},scale:function(t){var e=t.x,n=t.y,i=t.z,r=this.val;return r[0]=r[0]*e,r[1]=r[1]*e,r[2]=r[2]*e,r[3]=r[3]*e,r[4]=r[4]*n,r[5]=r[5]*n,r[6]=r[6]*n,r[7]=r[7]*n,r[8]=r[8]*i,r[9]=r[9]*i,r[10]=r[10]*i,r[11]=r[11]*i,this},scaleXYZ:function(t,e,n){var i=this.val;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,o=t.y,a=t.z,u=r*s,l=r*o;return this.fromArray([u*s+n,u*o-i*a,u*a+i*o,0,u*o+i*a,l*o+n,l*a-i*s,0,u*a-i*o,l*a+i*s,r*a*a+n,0,0,0,0,1]),this},rotate:function(t,e){var n=this.val,i=e.x,r=e.y,s=e.z,o=Math.sqrt(i*i+r*r+s*s);if(Math.abs(o)<1e-6)return null;i*=o=1/o,r*=o,s*=o;var a=Math.sin(t),u=Math.cos(t),l=1-u,c=n[0],h=n[1],d=n[2],f=n[3],p=n[4],m=n[5],g=n[6],y=n[7],v=n[8],b=n[9],x=n[10],w=n[11],T=i*i*l+u,S=r*i*l+s*a,E=s*i*l-r*a,O=i*r*l-s*a,C=r*r*l+u,_=s*r*l+i*a,A=i*s*l+r*a,k=r*s*l-i*a,R=s*s*l+u;return n[0]=c*T+p*S+v*E,n[1]=h*T+m*S+b*E,n[2]=d*T+g*S+x*E,n[3]=f*T+y*S+w*E,n[4]=c*O+p*C+v*_,n[5]=h*O+m*C+b*_,n[6]=d*O+g*C+x*_,n[7]=f*O+y*C+w*_,n[8]=c*A+p*k+v*R,n[9]=h*A+m*k+b*R,n[10]=d*A+g*k+x*R,n[11]=f*A+y*k+w*R,this},rotateX:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[4],s=e[5],o=e[6],a=e[7],u=e[8],l=e[9],c=e[10],h=e[11];return e[4]=r*i+u*n,e[5]=s*i+l*n,e[6]=o*i+c*n,e[7]=a*i+h*n,e[8]=u*i-r*n,e[9]=l*i-s*n,e[10]=c*i-o*n,e[11]=h*i-a*n,this},rotateY:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[8],l=e[9],c=e[10],h=e[11];return e[0]=r*i-u*n,e[1]=s*i-l*n,e[2]=o*i-c*n,e[3]=a*i-h*n,e[8]=r*n+u*i,e[9]=s*n+l*i,e[10]=o*n+c*i,e[11]=a*n+h*i,this},rotateZ:function(t){var e=this.val,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[4],l=e[5],c=e[6],h=e[7];return e[0]=r*i+u*n,e[1]=s*i+l*n,e[2]=o*i+c*n,e[3]=a*i+h*n,e[4]=u*i-r*n,e[5]=l*i-s*n,e[6]=c*i-o*n,e[7]=h*i-a*n,this},fromRotationTranslation:function(t,e){var n=this.val,i=t.x,r=t.y,s=t.z,o=t.w,a=i+i,u=r+r,l=s+s,c=i*a,h=i*u,d=i*l,f=r*u,p=r*l,m=s*l,g=o*a,y=o*u,v=o*l;return n[0]=1-(f+m),n[1]=h+v,n[2]=d-y,n[3]=0,n[4]=h-v,n[5]=1-(c+m),n[6]=p+g,n[7]=0,n[8]=d+y,n[9]=p-g,n[10]=1-(c+f),n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},fromQuat:function(t){var e=this.val,n=t.x,i=t.y,r=t.z,s=t.w,o=n+n,a=i+i,u=r+r,l=n*o,c=n*a,h=n*u,d=i*a,f=i*u,p=r*u,m=s*o,g=s*a,y=s*u;return e[0]=1-(d+p),e[1]=c+y,e[2]=h-g,e[3]=0,e[4]=c-y,e[5]=1-(l+p),e[6]=f+m,e[7]=0,e[8]=h+g,e[9]=f-m,e[10]=1-(l+d),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},frustum:function(t,e,n,i,r,s){var o=this.val,a=1/(e-t),u=1/(i-n),l=1/(r-s);return o[0]=2*r*a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r*u,o[6]=0,o[7]=0,o[8]=(e+t)*a,o[9]=(i+n)*u,o[10]=(s+r)*l,o[11]=-1,o[12]=0,o[13]=0,o[14]=s*r*2*l,o[15]=0,this},perspective:function(t,e,n,i){var r=this.val,s=1/Math.tan(t/2),o=1/(n-i);return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(i+n)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*i*n*o,r[15]=0,this},perspectiveLH:function(t,e,n,i){var r=this.val;return r[0]=2*n/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*n/e,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=-i/(n-i),r[11]=1,r[12]=0,r[13]=0,r[14]=n*i/(n-i),r[15]=0,this},ortho:function(t,e,n,i,r,s){var o=this.val,a=t-e,u=n-i,l=r-s;return u=0===u?u:1/u,l=0===l?l:1/l,o[0]=-2*(a=0===a?a:1/a),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*u,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*l,o[11]=0,o[12]=(t+e)*a,o[13]=(i+n)*u,o[14]=(s+r)*l,o[15]=1,this},lookAt:function(t,e,n){var i=this.val,r=t.x,s=t.y,o=t.z,a=n.x,u=n.y,l=n.z,c=e.x,h=e.y,d=e.z;if(Math.abs(r-c)<1e-6&&Math.abs(s-h)<1e-6&&Math.abs(o-d)<1e-6)return this.identity();var f=r-c,p=s-h,m=o-d,g=1/Math.sqrt(f*f+p*p+m*m),y=u*(m*=g)-l*(p*=g),v=l*(f*=g)-a*m,b=a*p-u*f;(g=Math.sqrt(y*y+v*v+b*b))?(y*=g=1/g,v*=g,b*=g):(y=0,v=0,b=0);var x=p*b-m*v,w=m*y-f*b,T=f*v-p*y;return(g=Math.sqrt(x*x+w*w+T*T))?(x*=g=1/g,w*=g,T*=g):(x=0,w=0,T=0),i[0]=y,i[1]=x,i[2]=f,i[3]=0,i[4]=v,i[5]=w,i[6]=p,i[7]=0,i[8]=b,i[9]=T,i[10]=m,i[11]=0,i[12]=-(y*r+v*s+b*o),i[13]=-(x*r+w*s+T*o),i[14]=-(f*r+p*s+m*o),i[15]=1,this},yawPitchRoll:function(t,e,n){this.zero(),r.zero(),s.zero();var i=this.val,o=r.val,a=s.val,u=Math.sin(n),l=Math.cos(n);return i[10]=1,i[15]=1,i[0]=l,i[1]=u,i[4]=-u,i[5]=l,u=Math.sin(e),l=Math.cos(e),o[0]=1,o[15]=1,o[5]=l,o[10]=l,o[9]=-u,o[6]=u,u=Math.sin(t),l=Math.cos(t),a[5]=1,a[15]=1,a[0]=l,a[2]=-u,a[8]=u,a[10]=l,this.multiplyLocal(r),this.multiplyLocal(s),this},setWorldMatrix:function(t,e,n,i,o){return this.yawPitchRoll(t.y,t.x,t.z),r.scaling(n.x,n.y,n.z),s.xyz(e.x,e.y,e.z),this.multiplyLocal(r),this.multiplyLocal(s),void 0!==i&&this.multiplyLocal(i),void 0!==o&&this.multiplyLocal(o),this}}),r=new i,s=new i;t.exports=i},function(t,e,n){var i=n(0),r=n(171),s=n(315),o=new Int8Array([1,2,0]),a=new Float32Array([0,0,0]),u=new r(1,0,0),l=new r(0,1,0),c=new r,h=new s,d=new i({initialize:function(t,e,n,i){"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},set:function(t,e,n,i){return"object"==typeof t?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.w=t.w||0):(this.x=t||0,this.y=e||0,this.z=n||0,this.w=i||0),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},scale:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},length:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return Math.sqrt(t*t+e*e+n*n+i*i)},lengthSq:function(){var t=this.x,e=this.y,n=this.z,i=this.w;return t*t+e*e+n*n+i*i},normalize:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i;return r>0&&(r=1/Math.sqrt(r),this.x=t*r,this.y=e*r,this.z=n*r,this.w=i*r),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lerp:function(t,e){void 0===e&&(e=0);var n=this.x,i=this.y,r=this.z,s=this.w;return this.x=n+e*(t.x-n),this.y=i+e*(t.y-i),this.z=r+e*(t.z-r),this.w=s+e*(t.w-s),this},rotationTo:function(t,e){var n=t.x*e.x+t.y*e.y+t.z*e.z;return n<-.999999?(c.copy(u).cross(t).length()<1e-6&&c.copy(l).cross(t),c.normalize(),this.setAxisAngle(c,Math.PI)):n>.999999?(this.x=0,this.y=0,this.z=0,this.w=1,this):(c.copy(t).cross(e),this.x=c.x,this.y=c.y,this.z=c.z,this.w=1+n,this.normalize())},setAxes:function(t,e,n){var i=h.val;return i[0]=e.x,i[3]=e.y,i[6]=e.z,i[1]=n.x,i[4]=n.y,i[7]=n.z,i[2]=-t.x,i[5]=-t.y,i[8]=-t.z,this.fromMat3(h).normalize()},identity:function(){return this.x=0,this.y=0,this.z=0,this.w=1,this},setAxisAngle:function(t,e){e*=.5;var n=Math.sin(e);return this.x=n*t.x,this.y=n*t.y,this.z=n*t.z,this.w=Math.cos(e),this},multiply:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,s=t.x,o=t.y,a=t.z,u=t.w;return this.x=e*u+r*s+n*a-i*o,this.y=n*u+r*o+i*s-e*a,this.z=i*u+r*a+e*o-n*s,this.w=r*u-e*s-n*o-i*a,this},slerp:function(t,e){var n=this.x,i=this.y,r=this.z,s=this.w,o=t.x,a=t.y,u=t.z,l=t.w,c=n*o+i*a+r*u+s*l;c<0&&(c=-c,o=-o,a=-a,u=-u,l=-l);var h=1-e,d=e;if(1-c>1e-6){var f=Math.acos(c),p=Math.sin(f);h=Math.sin((1-e)*f)/p,d=Math.sin(e*f)/p}return this.x=h*n+d*o,this.y=h*i+d*a,this.z=h*r+d*u,this.w=h*s+d*l,this},invert:function(){var t=this.x,e=this.y,n=this.z,i=this.w,r=t*t+e*e+n*n+i*i,s=r?1/r:0;return this.x=-t*s,this.y=-e*s,this.z=-n*s,this.w=i*s,this},conjugate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},rotateX:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.x=e*o+r*s,this.y=n*o+i*s,this.z=i*o-n*s,this.w=r*o-e*s,this},rotateY:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.x=e*o-i*s,this.y=n*o+r*s,this.z=i*o+e*s,this.w=r*o-n*s,this},rotateZ:function(t){t*=.5;var e=this.x,n=this.y,i=this.z,r=this.w,s=Math.sin(t),o=Math.cos(t);return this.x=e*o+n*s,this.y=n*o-e*s,this.z=i*o+r*s,this.w=r*o-i*s,this},calculateW:function(){var t=this.x,e=this.y,n=this.z;return this.w=-Math.sqrt(1-t*t-e*e-n*n),this},fromMat3:function(t){var e,n=t.val,i=n[0]+n[4]+n[8];if(i>0)e=Math.sqrt(i+1),this.w=.5*e,this.x=(n[7]-n[5])*(e=.5/e),this.y=(n[2]-n[6])*e,this.z=(n[3]-n[1])*e;else{var r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);var s=o[r],u=o[s];e=Math.sqrt(n[3*r+r]-n[3*s+s]-n[3*u+u]+1),a[r]=.5*e,a[s]=(n[3*s+r]+n[3*r+s])*(e=.5/e),a[u]=(n[3*u+r]+n[3*r+u])*e,this.x=a[0],this.y=a[1],this.z=a[2],this.w=(n[3*u+s]-n[3*s+u])*e}return this}});t.exports=d},function(t,e,n){var i=n(319),r=n(25),s=n(29),o=n(165);t.exports=function(t){var e=t.config;if((e.customEnvironment||e.canvas)&&e.renderType===s.AUTO)throw new Error("Must set explicit renderType in custom environment");if(!e.customEnvironment&&!e.canvas&&e.renderType!==s.HEADLESS)if(e.renderType===s.CANVAS||e.renderType!==s.CANVAS&&!o.webGL){if(!o.canvas)throw new Error("Cannot create Canvas or WebGL context, aborting.");e.renderType=s.CANVAS}else e.renderType=s.WEBGL;e.antialias||r.disableSmoothing();var a,u,l=t.scale.baseSize,c=l.width,h=l.height;e.canvas?(t.canvas=e.canvas,t.canvas.width=c,t.canvas.height=h):t.canvas=r.create(t,c,h,e.renderType),e.canvasStyle&&(t.canvas.style=e.canvasStyle),e.antialias||i.setCrisp(t.canvas),e.renderType!==s.HEADLESS&&(a=n(483),u=n(486),e.renderType===s.WEBGL?t.renderer=new u(t):(t.renderer=new a(t),t.context=t.renderer.gameContext))}},function(t,e){t.exports={setCrisp:function(t){return["optimizeSpeed","-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated"].forEach(function(e){t.style["image-rendering"]=e}),t.style.msInterpolationMode="nearest-neighbor",t},setBicubic:function(t){return t.style["image-rendering"]="auto",t.style.msInterpolationMode="bicubic",t}}},function(t,e,n){var i=n(29);t.exports=function(t){var e=t.config;if(!e.hideBanner){var n="WebGL";e.renderType===i.CANVAS?n="Canvas":e.renderType===i.HEADLESS&&(n="Headless");var r,s=e.audio,o=t.device.audio;if(r=!o.webAudio||s&&s.disableWebAudio?s&&s.noAudio||!o.webAudio&&!o.audioData?"No Audio":"HTML5 Audio":"Web Audio",t.device.browser.ie)window.console&&console.log("Phaser v"+i.VERSION+" / https://phaser.io");else{var a,u="",l=[u];Array.isArray(e.bannerBackgroundColor)?(e.bannerBackgroundColor.forEach(function(t){u=u.concat("%c "),l.push("background: "+t),a=t}),l[l.length-1]="color: "+e.bannerTextColor+"; background: "+a):(u=u.concat("%c "),l.push("color: "+e.bannerTextColor+"; background: "+e.bannerBackgroundColor)),l.push("background: #fff"),e.gameTitle&&(u=u.concat(e.gameTitle),e.gameVersion&&(u=u.concat(" v"+e.gameVersion)),e.hidePhaser||(u=u.concat(" / "))),e.hidePhaser||(u=u.concat("Phaser v"+i.VERSION+" ("+n+" | "+r+")")),u=u.concat(" %c "+e.gameURL),l[0]=u,console.log.apply(console,l)}}}},function(t,e,n){var i=n(0),r=n(6),s=n(1),o=n(322),a=new i({initialize:function(t,e){this.game=t,this.raf=new o,this.started=!1,this.running=!1,this.minFps=r(e,"min",5),this.targetFps=r(e,"target",60),this._min=1e3/this.minFps,this._target=1e3/this.targetFps,this.actualFps=this.targetFps,this.nextFpsUpdate=0,this.framesThisSecond=0,this.callback=s,this.forceSetTimeOut=r(e,"forceSetTimeOut",!1),this.time=0,this.startTime=0,this.lastTime=0,this.frame=0,this.inFocus=!0,this._pauseTime=0,this._coolDown=0,this.delta=0,this.deltaIndex=0,this.deltaHistory=[],this.deltaSmoothingMax=r(e,"deltaHistory",10),this.panicMax=r(e,"panicMax",120),this.rawDelta=0,this.now=0},blur:function(){this.inFocus=!1},focus:function(){this.inFocus=!0,this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta(),this.startTime+=this.time-this._pauseTime},resetDelta:function(){var t=window.performance.now();this.time=t,this.lastTime=t,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=Math.min(this._target,this.deltaHistory[e]);this.delta=0,this.deltaIndex=0,this._coolDown=this.panicMax},start:function(t){if(this.started)return this;this.started=!0,this.running=!0;for(var e=0;e<this.deltaSmoothingMax;e++)this.deltaHistory[e]=this._target;this.resetDelta(),this.startTime=window.performance.now(),this.callback=t,this.raf.start(this.step.bind(this),this.forceSetTimeOut)},step:function(){var t=window.performance.now();this.now=t;var e=t-this.lastTime;e<0&&(e=0),this.rawDelta=e;var n=this.deltaIndex,i=this.deltaHistory,r=this.deltaSmoothingMax,s=e;(this._coolDown>0||!this.inFocus)&&(this._coolDown--,s=Math.min(s,this._target)),s>this._min&&(s=i[n],s=Math.min(s,this._min)),i[n]=s,this.deltaIndex++,this.deltaIndex>r&&(this.deltaIndex=0);for(var o=0,a=0;a<r;a++)o+=i[a];this.delta=o/=r,this.time+=this.rawDelta,t>this.nextFpsUpdate&&(this.actualFps=.25*this.framesThisSecond+.75*this.actualFps,this.nextFpsUpdate=t+1e3,this.framesThisSecond=0),this.framesThisSecond++,this.callback(t,o,o/this._target),this.lastTime=t,this.frame++},tick:function(){this.step()},sleep:function(){this.running&&(this.raf.stop(),this.running=!1)},wake:function(t){this.running?this.sleep():t&&(this.startTime+=-this.lastTime+(this.lastTime+window.performance.now())),this.raf.start(this.step.bind(this),this.useRAF),this.running=!0,this.step()},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1e3},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){return this.running=!1,this.started=!1,this.raf.stop(),this},destroy:function(){this.stop(),this.callback=s,this.raf=null,this.game=null}});t.exports=a},function(t,e,n){var i=n(0),r=n(1),s=new i({initialize:function(){this.isRunning=!1,this.callback=r,this.tick=0,this.isSetTimeOut=!1,this.timeOutID=null,this.lastTime=0;var t=this;this.step=function e(){var n=window.performance.now();t.lastTime=t.tick,t.tick=n,t.callback(n),t.timeOutID=window.requestAnimationFrame(e)},this.stepTimeout=function e(){var n=Date.now(),i=Math.max(16+t.lastTime-n,0);t.lastTime=t.tick,t.tick=n,t.callback(n),t.timeOutID=window.setTimeout(e,i)}},start:function(t,e){this.isRunning||(this.callback=t,this.isSetTimeOut=e,this.isRunning=!0,this.timeOutID=e?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step))},stop:function(){this.isRunning=!1,this.isSetTimeOut?clearTimeout(this.timeOutID):window.cancelAnimationFrame(this.timeOutID)},destroy:function(){this.stop(),this.callback=r}});t.exports=s},function(t,e,n){var i=n(17);t.exports=function(t){var e,n=t.events;void 0!==document.hidden?e="visibilitychange":["webkit","moz","ms"].forEach(function(t){void 0!==document[t+"Hidden"]&&(document.hidden=function(){return document[t+"Hidden"]},e=t+"visibilitychange")}),e&&document.addEventListener(e,function(t){document.hidden||"pause"===t.type?n.emit(i.HIDDEN):n.emit(i.VISIBLE)},!1),window.onblur=function(){n.emit(i.BLUR)},window.onfocus=function(){n.emit(i.FOCUS)},window.focus&&t.config.autoFocus&&window.focus()}},function(t,e,n){var i=n(325),r=n(25),s=n(6);t.exports=function(t){var e=s(t,"data",[]),n=s(t,"canvas",null),o=s(t,"palette",i),a=s(t,"pixelWidth",1),u=s(t,"pixelHeight",a),l=s(t,"resizeCanvas",!0),c=s(t,"clearCanvas",!0),h=s(t,"preRender",null),d=s(t,"postRender",null),f=Math.floor(Math.abs(e[0].length*a)),p=Math.floor(Math.abs(e.length*u));n||(n=r.create2D(this,f,p),l=!1,c=!1),l&&(n.width=f,n.height=p);var m=n.getContext("2d");c&&m.clearRect(0,0,f,p),h&&h(n,m);for(var g=0;g<e.length;g++)for(var y=e[g],v=0;v<y.length;v++){var b=y[v];"."!==b&&" "!==b&&(m.fillStyle=o[b],m.fillRect(v*a,g*u,a,u))}return d&&d(n,m),n}},function(t,e){t.exports={0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"}},function(t,e,n){var i=n(0),r=n(305),s=n(80),o=n(3),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,"CubicBezierCurve"),Array.isArray(t)&&(i=new o(t[6],t[7]),n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n,this.p3=i},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,s=this.p2,a=this.p3;return e.set(r(t,n.x,i.x,s.x,a.x),r(t,n.y,i.y,s.y,a.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]),s=new o(e[6],e[7]);return new a(n,i,r,s)},t.exports=a},function(t,e,n){var i=n(0),r=n(80),s=n(35),o=n(6),a=n(170),u=n(3),l=new i({Extends:r,initialize:function(t,e,n,i,a,l,c,h){if("object"==typeof t){var d=t;t=o(d,"x",0),e=o(d,"y",0),n=o(d,"xRadius",0),i=o(d,"yRadius",n),a=o(d,"startAngle",0),l=o(d,"endAngle",360),c=o(d,"clockwise",!1),h=o(d,"rotation",0)}else void 0===i&&(i=n),void 0===a&&(a=0),void 0===l&&(l=360),void 0===c&&(c=!1),void 0===h&&(h=0);r.call(this,"EllipseCurve"),this.p0=new u(t,e),this._xRadius=n,this._yRadius=i,this._startAngle=s(a),this._endAngle=s(l),this._clockwise=c,this._rotation=s(h)},getStartPoint:function(t){return void 0===t&&(t=new u),this.getPoint(0,t)},getResolution:function(t){return 2*t},getPoint:function(t,e){void 0===e&&(e=new u);for(var n=2*Math.PI,i=this._endAngle-this._startAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),this._clockwise&&!r&&(i===n?i=-n:i-=n);var s=this._startAngle+t*i,o=this.p0.x+this._xRadius*Math.cos(s),a=this.p0.y+this._yRadius*Math.sin(s);if(0!==this._rotation){var l=Math.cos(this._rotation),c=Math.sin(this._rotation),h=o-this.p0.x,d=a-this.p0.y;o=h*l-d*c+this.p0.x,a=h*c+d*l+this.p0.y}return e.set(o,a)},setXRadius:function(t){return this.xRadius=t,this},setYRadius:function(t){return this.yRadius=t,this},setWidth:function(t){return this.xRadius=2*t,this},setHeight:function(t){return this.yRadius=2*t,this},setStartAngle:function(t){return this.startAngle=t,this},setEndAngle:function(t){return this.endAngle=t,this},setClockwise:function(t){return this.clockwise=t,this},setRotation:function(t){return this.rotation=t,this},x:{get:function(){return this.p0.x},set:function(t){this.p0.x=t}},y:{get:function(){return this.p0.y},set:function(t){this.p0.y=t}},xRadius:{get:function(){return this._xRadius},set:function(t){this._xRadius=t}},yRadius:{get:function(){return this._yRadius},set:function(t){this._yRadius=t}},startAngle:{get:function(){return a(this._startAngle)},set:function(t){this._startAngle=s(t)}},endAngle:{get:function(){return a(this._endAngle)},set:function(t){this._endAngle=s(t)}},clockwise:{get:function(){return this._clockwise},set:function(t){this._clockwise=t}},angle:{get:function(){return a(this._rotation)},set:function(t){this._rotation=s(t)}},rotation:{get:function(){return this._rotation},set:function(t){this._rotation=t}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:a(this._startAngle),endAngle:a(this._endAngle),clockwise:this._clockwise,rotation:a(this._rotation)}}});l.fromJSON=function(t){return new l(t)},t.exports=l},function(t,e,n){var i=n(0),r=n(80),s=n(173),o=n(11),a=n(3),u=new a,l=new i({Extends:r,initialize:function(t,e){r.call(this,"LineCurve"),Array.isArray(t)&&(e=new a(t[2],t[3]),t=new a(t[0],t[1])),this.p0=t,this.p1=e},getBounds:function(t){return void 0===t&&(t=new o),s([this.p0,this.p1],t)},getStartPoint:function(t){return void 0===t&&(t=new a),t.copy(this.p0)},getResolution:function(t){return void 0===t&&(t=1),t},getPoint:function(t,e){return void 0===e&&(e=new a),1===t?e.copy(this.p1):(e.copy(this.p1).subtract(this.p0).scale(t).add(this.p0),e)},getPointAt:function(t,e){return this.getPoint(t,e)},getTangent:function(){return u.copy(this.p1).subtract(this.p0).normalize()},draw:function(t){return t.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});l.fromJSON=function(t){var e=t.points,n=new a(e[0],e[1]),i=new a(e[2],e[3]);return new l(n,i)},t.exports=l},function(t,e,n){var i=n(0),r=n(80),s=n(306),o=n(3),a=new i({Extends:r,initialize:function(t,e,n){r.call(this,"QuadraticBezier"),Array.isArray(t)&&(n=new o(t[4],t[5]),e=new o(t[2],t[3]),t=new o(t[0],t[1])),this.p0=t,this.p1=e,this.p2=n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.p0)},getResolution:function(t){return t},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.p0,i=this.p1,r=this.p2;return e.set(s(t,n.x,i.x,r.x),s(t,n.y,i.y,r.y))},draw:function(t,e){void 0===e&&(e=32);var n=this.getPoints(e);t.beginPath(),t.moveTo(this.p0.x,this.p0.y);for(var i=1;i<n.length;i++)t.lineTo(n[i].x,n[i].y);return t.strokePath(),t},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});a.fromJSON=function(t){var e=t.points,n=new o(e[0],e[1]),i=new o(e[2],e[3]),r=new o(e[4],e[5]);return new a(n,i,r)},t.exports=a},function(t,e,n){var i=n(168),r=n(0),s=n(80),o=n(3),a=new r({Extends:s,initialize:function(t){void 0===t&&(t=[]),s.call(this,"SplineCurve"),this.points=[],this.addPoints(t)},addPoints:function(t){for(var e=0;e<t.length;e++){var n=new o;"number"==typeof t[e]?(n.x=t[e],n.y=t[e+1],e++):Array.isArray(t[e])?(n.x=t[e][0],n.y=t[e][1]):(n.x=t[e].x,n.y=t[e].y),this.points.push(n)}return this},addPoint:function(t,e){var n=new o(t,e);return this.points.push(n),n},getStartPoint:function(t){return void 0===t&&(t=new o),t.copy(this.points[0])},getResolution:function(t){return t*this.points.length},getPoint:function(t,e){void 0===e&&(e=new o);var n=this.points,r=(n.length-1)*t,s=Math.floor(r),a=r-s,u=n[0===s?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],h=n[s>n.length-3?n.length-1:s+2];return e.set(i(a,u.x,l.x,c.x,h.x),i(a,u.y,l.y,c.y,h.y))},toJSON:function(){for(var t=[],e=0;e<this.points.length;e++)t.push(this.points[e].x),t.push(this.points[e].y);return{type:this.type,points:t}}});a.fromJSON=function(t){return new a(t.points)},t.exports=a},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i){e&&""!==e||(e=["precision mediump float;","uniform vec2 resolution;","varying vec2 fragCoord;","void main () {","    vec2 uv = fragCoord / resolution.xy;","    gl_FragColor = vec4(uv.xyx, 1.0);","}"].join("\n")),n&&""!==n||(n=["precision mediump float;","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform vec2 uResolution;","attribute vec2 inPosition;","varying vec2 fragCoord;","void main () {","gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);","fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);","}"].join("\n")),void 0===i&&(i=null),this.key=t,this.fragmentSrc=e,this.vertexSrc=n,this.uniforms=i}});t.exports=i},function(t,e,n){var i=n(33);i.ColorToRGBA=n(786),i.ComponentToHex=n(333),i.GetColor=n(160),i.GetColor32=n(276),i.HexStringToColor=n(275),i.HSLToColor=n(787),i.HSVColorWheel=n(788),i.HSVToRGB=n(161),i.HueToComponent=n(334),i.IntegerToColor=n(278),i.IntegerToRGB=n(279),i.Interpolate=n(789),i.ObjectToColor=n(280),i.RandomRGB=n(790),i.RGBStringToColor=n(281),i.RGBToHSV=n(277),i.RGBToString=n(791),i.ValueToColor=n(159),t.exports=i},function(t,e){t.exports=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},function(t,e){t.exports=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},function(t,e,n){var i=n(114);t.exports=function(t){if("complete"!==document.readyState&&"interactive"!==document.readyState){var e=function(){document.removeEventListener("deviceready",e,!0),document.removeEventListener("DOMContentLoaded",e,!0),window.removeEventListener("load",e,!0),t()};document.body?i.cordova?document.addEventListener("deviceready",e,!1):(document.addEventListener("DOMContentLoaded",e,!0),window.addEventListener("load",e,!0)):window.setTimeout(e,20)}else t()}},function(t,e,n){var i=n(174);t.exports=function(t,e){var n=window.screen,r=!!n&&(n.orientation||n.mozOrientation||n.msOrientation);if(r&&"string"==typeof r.type)return r.type;if("string"==typeof r)return r;if(n)return n.height>n.width?i.PORTRAIT:i.LANDSCAPE;if("number"==typeof window.orientation)return 0===window.orientation||180===window.orientation?i.PORTRAIT:i.LANDSCAPE;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return i.PORTRAIT;if(window.matchMedia("(orientation: landscape)").matches)return i.LANDSCAPE}return e>t?i.PORTRAIT:i.LANDSCAPE}},function(t,e){t.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}},function(t,e){t.exports={LANDSCAPE:"landscape-primary",PORTRAIT:"portrait-primary"}},function(t,e){t.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5}},function(t,e){t.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}},function(t,e){t.exports=function(t){var e;return""!==t&&("string"==typeof t?e=document.getElementById(t):t&&1===t.nodeType&&(e=t)),e||(e=document.body),e}},function(t,e){t.exports=function(t){var e="";try{window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM")).loadXML(t)}catch(t){e=null}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length?e:null}},function(t,e,n){var i=n(0),r=n(176),s=n(9),o=n(53),a=n(17),u=n(344),l=n(345),c=n(346),h=n(347),d=n(32),f=n(313),p=new i({initialize:function(t,e){this.game=t,this.config=e,this.enabled=!0,this.events=new s,this.isOver=!0,this.defaultCursor="",this.keyboard=e.inputKeyboard?new u(this):null,this.mouse=e.inputMouse?new l(this):null,this.touch=e.inputTouch?new h(this):null,this.pointers=[],this.pointersTotal=e.inputActivePointers,e.inputTouch&&1===this.pointersTotal&&(this.pointersTotal=2);for(var n=0;n<=this.pointersTotal;n++){var i=new c(this,n);i.smoothFactor=e.inputSmoothFactor,this.pointers.push(i)}this.mousePointer=e.inputMouse?this.pointers[0]:null,this.activePointer=this.pointers[0],this.globalTopOnly=!0,this.time=0,this._tempPoint={x:0,y:0},this._tempHitTest=[],this._tempMatrix=new d,this._tempMatrix2=new d,this._tempSkip=!1,this.mousePointerContainer=[this.mousePointer],t.events.once(a.BOOT,this.boot,this)},boot:function(){this.canvas=this.game.canvas,this.scaleManager=this.game.scale,this.events.emit(o.MANAGER_BOOT),this.game.events.on(a.PRE_RENDER,this.preRender,this),this.game.events.once(a.DESTROY,this.destroy,this)},setCanvasOver:function(t){this.isOver=!0,this.events.emit(o.GAME_OVER,t)},setCanvasOut:function(t){this.isOver=!1,this.events.emit(o.GAME_OUT,t)},preRender:function(){var t=this.game.loop.now,e=this.game.loop.delta,n=this.game.scene.getScenes(!0,!0);this.time=t,this.events.emit(o.MANAGER_UPDATE);for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&r.sys.input.updatePoll(t,e)&&this.globalTopOnly)return}},setDefaultCursor:function(t){this.defaultCursor=t,this.canvas.style.cursor!==t&&(this.canvas.style.cursor=t)},setCursor:function(t){t.cursor&&(this.canvas.style.cursor=t.cursor)},resetCursor:function(t){t.cursor&&this.canvas&&(this.canvas.style.cursor=this.defaultCursor)},addPointer:function(t){void 0===t&&(t=1);var e=[];this.pointersTotal+t>10&&(t=10-this.pointersTotal);for(var n=0;n<t;n++){var i=new c(this,this.pointers.length);i.smoothFactor=this.config.inputSmoothFactor,this.pointers.push(i),this.pointersTotal++,e.push(i)}return e},updateInputPlugins:function(t,e){var n=this.game.scene.getScenes(!0,!0);this._tempSkip=!1;for(var i=0;i<n.length;i++){var r=n[i];if(r.sys.input&&(r.sys.input.update(t,e)&&this.globalTopOnly||this._tempSkip))return}},onTouchStart:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(!a.active){a.touchstart(s,t),this.activePointer=a,n.push(a);break}}this.updateInputPlugins(r.TOUCH_START,n)},onTouchMove:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchmove(s,t),this.activePointer=a,n.push(a);break}}this.updateInputPlugins(r.TOUCH_MOVE,n)},onTouchEnd:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchend(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_END,n)},onTouchCancel:function(t){for(var e=this.pointers,n=[],i=0;i<t.changedTouches.length;i++)for(var s=t.changedTouches[i],o=1;o<this.pointersTotal;o++){var a=e[o];if(a.active&&a.identifier===s.identifier){a.touchcancel(s,t),n.push(a);break}}this.updateInputPlugins(r.TOUCH_CANCEL,n)},onMouseDown:function(t){this.mousePointer.down(t),this.mousePointer.updateMotion(),this.updateInputPlugins(r.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(t){this.mousePointer.move(t),this.mousePointer.updateMotion(),this.updateInputPlugins(r.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(t){this.mousePointer.up(t),this.mousePointer.updateMotion(),this.updateInputPlugins(r.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(t){this.mousePointer.wheel(t),this.updateInputPlugins(r.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(t){var e=this.mouse.locked;this.mousePointer.locked=e,this.events.emit(o.POINTERLOCK_CHANGE,t,e)},inputCandidate:function(t,e){var n=t.input;if(!n||!n.enabled||!n.alwaysEnabled&&!t.willRender(e))return!1;var i=!0,r=t.parentContainer;if(r)do{if(!r.willRender(e)){i=!1;break}r=r.parentContainer}while(r);return i},hitTest:function(t,e,n,i){void 0===i&&(i=this._tempHitTest);var r=this._tempPoint,s=n.scrollX,o=n.scrollY;i.length=0;var a=t.x,u=t.y;1!==n.resolution&&(a+=n._x,u+=n._y),n.getWorldPoint(a,u,r),t.worldX=r.x,t.worldY=r.y;for(var l={x:0,y:0},c=this._tempMatrix,h=this._tempMatrix2,d=0;d<e.length;d++){var p=e[d];if(this.inputCandidate(p,n)){var m=r.x+s*p.scrollFactorX-s,g=r.y+o*p.scrollFactorY-o;p.parentContainer?(p.getWorldTransformMatrix(c,h),c.applyInverse(m,g,l)):f(m,g,p.x,p.y,p.rotation,p.scaleX,p.scaleY,l),this.pointWithinHitArea(p,l.x,l.y)&&i.push(p)}}return i},pointWithinHitArea:function(t,e,n){e+=t.displayOriginX,n+=t.displayOriginY;var i=t.input;return!(!i||!i.hitAreaCallback(i.hitArea,e,n,t)||(i.localX=e,i.localY=n,0))},pointWithinInteractiveObject:function(t,e,n){return!!t.hitArea&&(n+=t.gameObject.displayOriginY,t.localX=e+=t.gameObject.displayOriginX,t.localY=n,t.hitAreaCallback(t.hitArea,e,n,t))},transformPointer:function(t,e,n,i){var r=t.position,s=t.prevPosition;s.x=r.x,s.y=r.y;var o=this.scaleManager.transformX(e),a=this.scaleManager.transformY(n),u=t.smoothFactor;i&&0!==u?(r.x=o*u+s.x*(1-u),r.y=a*u+s.y*(1-u)):(r.x=o,r.y=a)},destroy:function(){this.events.removeAllListeners(),this.game.events.off(a.PRE_RENDER),this.keyboard&&this.keyboard.destroy(),this.mouse&&this.mouse.destroy(),this.touch&&this.touch.destroy();for(var t=0;t<this.pointers.length;t++)this.pointers[t].destroy();this.pointers=[],this._tempHitTest=[],this._tempMatrix.destroy(),this.canvas=null,this.game=null}});t.exports=p},function(t,e,n){var i=n(119),r=n(0),s=n(17),o=n(53),a=n(120),u=n(0),l=new r({initialize:function(t){this.manager=t,this.queue=[],this.preventDefault=!0,this.captures=[],this.enabled=!1,this.onKeyDown=u,this.onKeyUp=u,t.events.once(o.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputKeyboard,this.target=t.inputKeyboardEventTarget,this.addCapture(t.inputKeyboardCapture),!this.target&&window&&(this.target=window),this.enabled&&this.target&&this.startListeners(),this.manager.game.events.on(s.POST_STEP,this.postUpdate,this)},startListeners:function(){var t=this;this.onKeyDown=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&(t.queue.push(e),t.manager.useQueue||t.manager.events.emit(o.MANAGER_PROCESS),t.preventDefault&&!(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault())},this.onKeyUp=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&(t.queue.push(e),t.manager.useQueue||t.manager.events.emit(o.MANAGER_PROCESS),t.preventDefault&&!(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)&&t.captures.indexOf(e.keyCode)>-1&&e.preventDefault())};var e=this.target;e&&(e.addEventListener("keydown",this.onKeyDown,!1),e.addEventListener("keyup",this.onKeyUp,!1),this.enabled=!0)},stopListeners:function(){var t=this.target;t.removeEventListener("keydown",this.onKeyDown,!1),t.removeEventListener("keyup",this.onKeyUp,!1),this.enabled=!1},postUpdate:function(){this.queue=[]},addCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var i=t[n];"string"==typeof i&&(i=a[i.trim().toUpperCase()]),-1===e.indexOf(i)&&e.push(i)}this.preventDefault=e.length>0},removeCapture:function(t){"string"==typeof t&&(t=t.split(",")),Array.isArray(t)||(t=[t]);for(var e=this.captures,n=0;n<t.length;n++){var r=t[n];"string"==typeof r&&(r=a[r.toUpperCase()]),i(e,r)}this.preventDefault=e.length>0},clearCaptures:function(){this.captures=[],this.preventDefault=!1},destroy:function(){this.stopListeners(),this.clearCaptures(),this.queue=[],this.manager.game.events.off(s.POST_RENDER,this.postUpdate,this),this.target=null,this.enabled=!1,this.manager=null}});t.exports=l},function(t,e,n){var i=n(0),r=n(165),s=n(53),o=n(0),a=new i({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.locked=!1,this.onMouseMove=o,this.onMouseDown=o,this.onMouseUp=o,this.onMouseDownWindow=o,this.onMouseUpWindow=o,this.onMouseOver=o,this.onMouseOut=o,this.onMouseWheel=o,this.pointerLockChange=o,t.events.once(s.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputMouse,this.target=t.inputMouseEventTarget,this.capture=t.inputMouseCapture,this.target?"string"==typeof this.target&&(this.target=document.getElementById(this.target)):this.target=this.manager.game.canvas,t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},requestPointerLock:function(){if(r.pointerLock){var t=this.target;t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock()}},releasePointerLock:function(){r.pointerLock&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock())},startListeners:function(){var t=this,e=this.manager.canvas,n=window&&window.focus&&this.manager.game.config.autoFocus;this.onMouseMove=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onMouseMove(e),t.capture&&e.preventDefault())},this.onMouseDown=function(i){n&&window.focus(),!i.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onMouseDown(i),t.capture&&i.target===e&&i.preventDefault())},this.onMouseDownWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onMouseDown(n)},this.onMouseUp=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onMouseUp(n),t.capture&&n.target===e&&n.preventDefault())},this.onMouseUpWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onMouseUp(n)},this.onMouseOver=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOver(e)},this.onMouseOut=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOut(e)},this.onMouseWheel=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.onMouseWheel(e)};var i=this.target;if(i){var s={passive:!0},o={passive:!1};i.addEventListener("mousemove",this.onMouseMove,this.capture?o:s),i.addEventListener("mousedown",this.onMouseDown,this.capture?o:s),i.addEventListener("mouseup",this.onMouseUp,this.capture?o:s),i.addEventListener("mouseover",this.onMouseOver,this.capture?o:s),i.addEventListener("mouseout",this.onMouseOut,this.capture?o:s),i.addEventListener("wheel",this.onMouseWheel,this.capture?o:s),window&&this.manager.game.config.inputWindowEvents&&(window.addEventListener("mousedown",this.onMouseDownWindow,o),window.addEventListener("mouseup",this.onMouseUpWindow,o)),r.pointerLock&&(this.pointerLockChange=function(e){var n=t.target;t.locked=document.pointerLockElement===n||document.mozPointerLockElement===n||document.webkitPointerLockElement===n,t.manager.onPointerLockChange(e)},document.addEventListener("pointerlockchange",this.pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this.pointerLockChange,!0)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("mouseover",this.onMouseOver),t.removeEventListener("mouseout",this.onMouseOut),window&&(window.removeEventListener("mousedown",this.onMouseDownWindow),window.removeEventListener("mouseup",this.onMouseUpWindow)),r.pointerLock&&(document.removeEventListener("pointerlockchange",this.pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this.pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this.pointerLockChange,!0))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=a},function(t,e,n){var i=n(298),r=n(0),s=n(58),o=n(167),a=n(307),u=n(3),l=new r({initialize:function(t,e){this.manager=t,this.id=e,this.camera=null,this.button=0,this.buttons=0,this.position=new u,this.prevPosition=new u,this.midPoint=new u(-1,-1),this.velocity=new u,this.angle=0,this.distance=0,this.smoothFactor=0,this.motionFactor=.2,this.worldX=0,this.worldY=0,this.moveTime=0,this.downX=0,this.downY=0,this.downTime=0,this.upX=0,this.upY=0,this.upTime=0,this.primaryDown=!1,this.isDown=!1,this.wasTouch=!1,this.wasCanceled=!1,this.movementX=0,this.movementY=0,this.identifier=0,this.pointerId=null,this.active=0===e,this.locked=!1,this.deltaX=0,this.deltaY=0,this.deltaZ=0},updateWorldPoint:function(t){var e=this.x,n=this.y;1!==t.resolution&&(e+=t._x,n+=t._y);var i=t.getWorldPoint(e,n);return this.worldX=i.x,this.worldY=i.y,this},positionToCamera:function(t,e){return t.getWorldPoint(this.x,this.y,e)},updateMotion:function(){var t=this.position.x,e=this.position.y,n=this.midPoint.x,r=this.midPoint.y;if(t!==n||e!==r){var s=a(this.motionFactor,n,t),u=a(this.motionFactor,r,e);o(s,t,.1)&&(s=t),o(u,e,.1)&&(u=e),this.midPoint.set(s,u);var l=t-s,c=e-u;this.velocity.set(l,c),this.angle=i(s,u,t,e),this.distance=Math.sqrt(l*l+c*c)}},up:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=t.timeStamp),this.isDown=!1,this.wasTouch=!1},down:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.button=t.button,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),0===t.button&&(this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=t.timeStamp),this.isDown=!0,this.wasTouch=!1},move:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.locked&&(this.movementX=t.movementX||t.mozMovementX||t.webkitMovementX||0,this.movementY=t.movementY||t.mozMovementY||t.webkitMovementY||0),this.moveTime=t.timeStamp,this.wasTouch=!1},wheel:function(t){"buttons"in t&&(this.buttons=t.buttons),this.event=t,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.deltaX=t.deltaX,this.deltaY=t.deltaY,this.deltaZ=t.deltaZ,this.wasTouch=!1},touchstart:function(t,e){t.pointerId&&(this.pointerId=t.pointerId),this.identifier=t.identifier,this.target=t.target,this.active=!0,this.buttons=1,this.event=e,this.downElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!0,this.downX=this.x,this.downY=this.y,this.downTime=e.timeStamp,this.isDown=!0,this.wasTouch=!0,this.wasCanceled=!1,this.updateMotion()},touchmove:function(t,e){this.event=e,this.manager.transformPointer(this,t.pageX,t.pageY,!0),this.moveTime=e.timeStamp,this.wasTouch=!0,this.updateMotion()},touchend:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!1,this.active=!1,this.updateMotion()},touchcancel:function(t,e){this.buttons=0,this.event=e,this.upElement=t.target,this.manager.transformPointer(this,t.pageX,t.pageY,!1),this.primaryDown=!1,this.upX=this.x,this.upY=this.y,this.upTime=e.timeStamp,this.isDown=!1,this.wasTouch=!0,this.wasCanceled=!0,this.active=!1},noButtonDown:function(){return 0===this.buttons},leftButtonDown:function(){return!!(1&this.buttons)},rightButtonDown:function(){return!!(2&this.buttons)},middleButtonDown:function(){return!!(4&this.buttons)},backButtonDown:function(){return!!(8&this.buttons)},forwardButtonDown:function(){return!!(16&this.buttons)},leftButtonReleased:function(){return 0===this.button&&!this.isDown},rightButtonReleased:function(){return 2===this.button&&!this.isDown},middleButtonReleased:function(){return 1===this.button&&!this.isDown},backButtonReleased:function(){return 3===this.button&&!this.isDown},forwardButtonReleased:function(){return 4===this.button&&!this.isDown},getDistance:function(){return this.isDown?s(this.downX,this.downY,this.x,this.y):s(this.downX,this.downY,this.upX,this.upY)},getDistanceX:function(){return this.isDown?Math.abs(this.downX-this.x):Math.abs(this.downX-this.upX)},getDistanceY:function(){return this.isDown?Math.abs(this.downY-this.y):Math.abs(this.downY-this.upY)},getDuration:function(){return this.isDown?this.manager.time-this.downTime:this.upTime-this.downTime},getAngle:function(){return this.isDown?i(this.downX,this.downY,this.x,this.y):i(this.downX,this.downY,this.upX,this.upY)},getInterpolatedPosition:function(t,e){void 0===t&&(t=10),void 0===e&&(e=[]);for(var n=this.prevPosition.x,i=this.prevPosition.y,r=this.position.x,s=this.position.y,o=0;o<t;o++){var u=1/t*o;e[o]={x:a(u,n,r),y:a(u,i,s)}}return e},destroy:function(){this.camera=null,this.manager=null,this.position=null},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},time:{get:function(){return this.event?this.event.timeStamp:0}}});t.exports=l},function(t,e,n){var i=n(0),r=n(53),s=n(1),o=new i({initialize:function(t){this.manager=t,this.capture=!0,this.enabled=!1,this.onTouchStart=s,this.onTouchStartWindow=s,this.onTouchMove=s,this.onTouchEnd=s,this.onTouchEndWindow=s,this.onTouchCancel=s,this.onTouchCancelWindow=s,this.onTouchOver=s,this.onTouchOut=s,t.events.once(r.MANAGER_BOOT,this.boot,this)},boot:function(){var t=this.manager.config;this.enabled=t.inputTouch,this.target=t.inputTouchEventTarget,this.capture=t.inputTouchCapture,this.target||(this.target=this.manager.game.canvas),t.disableContextMenu&&this.disableContextMenu(),this.enabled&&this.target&&this.startListeners()},disableContextMenu:function(){return document.body.addEventListener("contextmenu",function(t){return t.preventDefault(),!1}),this},startListeners:function(){var t=this,e=this.manager.canvas,n=window&&window.focus&&this.manager.game.config.autoFocus;this.onTouchStart=function(i){n&&window.focus(),!i.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchStart(i),t.capture&&i.cancelable&&i.target===e&&i.preventDefault())},this.onTouchStartWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onTouchStart(n)},this.onTouchMove=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchMove(e),t.capture&&e.cancelable&&e.preventDefault())},this.onTouchEnd=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchEnd(n),t.capture&&n.cancelable&&n.target===e&&n.preventDefault())},this.onTouchEndWindow=function(n){!n.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&n.target!==e&&t.manager.onTouchEnd(n)},this.onTouchCancel=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&(t.manager.onTouchCancel(e),t.capture&&e.preventDefault())},this.onTouchCancelWindow=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.onTouchCancel(e)},this.onTouchOver=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOver(e)},this.onTouchOut=function(e){!e.defaultPrevented&&t.enabled&&t.manager&&t.manager.enabled&&t.manager.setCanvasOut(e)};var i=this.target;if(i){var r={passive:!0},s={passive:!1};i.addEventListener("touchstart",this.onTouchStart,this.capture?s:r),i.addEventListener("touchmove",this.onTouchMove,this.capture?s:r),i.addEventListener("touchend",this.onTouchEnd,this.capture?s:r),i.addEventListener("touchcancel",this.onTouchCancel,this.capture?s:r),i.addEventListener("touchover",this.onTouchOver,this.capture?s:r),i.addEventListener("touchout",this.onTouchOut,this.capture?s:r),window&&this.manager.game.config.inputWindowEvents&&(window.addEventListener("touchstart",this.onTouchStartWindow,s),window.addEventListener("touchend",this.onTouchEndWindow,s),window.addEventListener("touchcancel",this.onTouchCancelWindow,s)),this.enabled=!0}},stopListeners:function(){var t=this.target;t.removeEventListener("touchstart",this.onTouchStart),t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("touchcancel",this.onTouchCancel),t.removeEventListener("touchover",this.onTouchOver),t.removeEventListener("touchout",this.onTouchOut),window&&(window.removeEventListener("touchstart",this.onTouchStartWindow),window.removeEventListener("touchend",this.onTouchEndWindow))},destroy:function(){this.stopListeners(),this.target=null,this.enabled=!1,this.manager=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(17),s=n(9),o=n(8),a=n(15),u=n(5),l=n(2),c=n(20),h=n(119),d=new i({Extends:s,initialize:function(t){s.call(this),this.game=t,this.plugins=[],this.scenePlugins=[],this._pendingGlobal=[],this._pendingScene=[],t.isBooted?this.boot():t.events.once(r.BOOT,this.boot,this)},boot:function(){var t,e,n,i,s,o,a,u=this.game.config,c=u.installGlobalPlugins;for(c=c.concat(this._pendingGlobal),t=0;t<c.length;t++)n=l(e=c[t],"key",null),i=l(e,"plugin",null),s=l(e,"start",!1),o=l(e,"mapping",null),a=l(e,"data",null),n&&(i?this.install(n,i,s,o,a):console.warn("Missing `plugin` for key: "+n));for(c=(c=u.installScenePlugins).concat(this._pendingScene),t=0;t<c.length;t++)n=l(e=c[t],"key",null),i=l(e,"plugin",null),o=l(e,"mapping",null),n&&(i?this.installScenePlugin(n,i,o):console.warn("Missing `plugin` for key: "+n));this._pendingGlobal=[],this._pendingScene=[],this.game.events.once(r.DESTROY,this.destroy,this)},addToScene:function(t,e,n){var i,r,s,o=this.game,a=t.scene,u=t.settings.map,l=t.settings.isBooted;for(i=0;i<e.length;i++)o[r=e[i]]?(t[r]=o[r],u.hasOwnProperty(r)&&(a[u[r]]=t[r])):"game"===r&&u.hasOwnProperty(r)&&(a[u[r]]=o);for(var h=0;h<n.length;h++)for(s=n[h],i=0;i<s.length;i++)if(c.hasCore(r=s[i])){var d=c.getCore(r),f=new d.plugin(a,this);t[d.mapping]=f,d.custom?a[d.mapping]=f:u.hasOwnProperty(d.mapping)&&(a[u[d.mapping]]=f),l&&f.boot()}for(s=this.plugins,i=0;i<s.length;i++){var p=s[i];p.mapping&&(a[p.mapping]=p.plugin)}},getDefaultScenePlugins:function(){return this.game.config.defaultPlugins.concat(this.scenePlugins)},installScenePlugin:function(t,e,n,i,r){if(void 0===r&&(r=!1),"function"==typeof e){if(c.hasCore(t)){if(!r&&c.hasCore(t))return void console.warn("Scene Plugin key in use: "+t)}else c.register(t,e,n,!0),this.scenePlugins.push(t);if(i){var s=new e(i,this);i.sys[t]=s,n&&""!==n&&(i[n]=s),s.boot()}}else console.warn("Invalid Scene Plugin: "+t)},install:function(t,e,n,i,r){if(void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=null),"function"!=typeof e)return console.warn("Invalid Plugin: "+t),null;if(c.hasCustom(t))return console.warn("Plugin key in use: "+t),null;if(null!==i&&(n=!0),this.game.isBooted){if(c.registerCustom(t,e,i,r),n)return this.start(t)}else this._pendingGlobal.push({key:t,plugin:e,start:n,mapping:i,data:r});return null},getIndex:function(t){for(var e=this.plugins,n=0;n<e.length;n++)if(e[n].key===t)return n;return-1},getEntry:function(t){var e=this.getIndex(t);if(-1!==e)return this.plugins[e]},isActive:function(t){var e=this.getEntry(t);return e&&e.active},start:function(t,e){void 0===e&&(e=t);var n=this.getEntry(e);return n&&!n.active?(n.active=!0,n.plugin.start()):n||(n=this.createEntry(t,e)),n?n.plugin:null},createEntry:function(t,e){var n=c.getCustom(t);if(n){var i=new n.plugin(this);this.plugins.push(n={key:e,plugin:i,active:!0,mapping:n.mapping,data:n.data}),i.init(n.data),i.start()}return n},stop:function(t){var e=this.getEntry(t);return e&&e.active&&(e.active=!1,e.plugin.stop()),this},get:function(t,e){void 0===e&&(e=!0);var n=this.getEntry(t);if(n)return n.plugin;var i=this.getClass(t);return i&&e?(n=this.createEntry(t,t))?n.plugin:null:i||null},getClass:function(t){return c.getCustomClass(t)},removeGlobalPlugin:function(t){var e=this.getEntry(t);e&&h(this.plugins,e),c.removeCustom(t)},removeScenePlugin:function(t){h(this.scenePlugins,t),c.remove(t)},registerGameObject:function(t,e,n){return e&&u.register(t,e),n&&a.register(t,n),this},removeGameObject:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),e&&u.remove(t),n&&a.remove(t),this},registerFileType:function(t,e,n){o.register(t,e),n&&n.sys.load&&(n.sys.load[t]=e)},destroy:function(){for(var t=0;t<this.plugins.length;t++)this.plugins[t].plugin.destroy();c.destroyCustomPlugins(),this.game.noReturn&&c.destroyCorePlugins(),this.game=null,this.plugins=[],this.scenePlugins=[]}});t.exports=d},function(t,e,n){var i=n(174),r=n(0),s=n(9),o=n(92),a=n(17),u=n(844),l=n(341),c=n(336),h=n(1),d=n(11),f=n(350),p=n(93),m=n(3),g=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.canvasBounds=new d,this.parent=null,this.parentIsWindow=!1,this.parentSize=new f,this.gameSize=new f,this.baseSize=new f,this.displaySize=new f,this.scaleMode=i.SCALE_MODE.NONE,this.resolution=1,this.zoom=1,this._resetZoom=!1,this.displayScale=new m(1,1),this.autoRound=!1,this.autoCenter=i.CENTER.NO_CENTER,this.orientation=i.ORIENTATION.LANDSCAPE,this.fullscreenTarget=null,this._createdFullscreenTarget=!1,this._requestedFullscreenChange=!1,this.dirty=!1,this.resizeInterval=500,this._lastCheck=0,this._checkOrientation=!1,this.listeners={orientationChange:h,windowResize:h,fullScreenChange:h,fullScreenError:h}},preBoot:function(){this.parseConfig(this.game.config),this.game.events.once("boot",this.boot,this)},boot:function(){var t=this.game;this.canvas=t.canvas,this.fullscreen=t.device.fullscreen,this.scaleMode!==i.SCALE_MODE.RESIZE&&this.displaySize.setAspectMode(this.scaleMode),this.scaleMode===i.SCALE_MODE.NONE?this.resize(this.width,this.height):(this.getParentBounds(),this.parentSize.width>0&&this.parentSize.height>0&&this.displaySize.setParent(this.parentSize),this.refresh()),t.events.on(a.PRE_STEP,this.step,this),this.startListeners()},parseConfig:function(t){this.getParent(t),this.getParentBounds();var e=t.width,n=t.height,r=t.scaleMode,s=t.resolution,o=t.zoom,a=t.autoRound;if("string"==typeof e){var u=this.parentSize.width;0===u&&(u=window.innerWidth);var l=parseInt(e,10)/100;e=Math.floor(u*l)}if("string"==typeof n){var h=this.parentSize.height;0===h&&(h=window.innerHeight);var d=parseInt(n,10)/100;n=Math.floor(h*d)}this.resolution=1,this.scaleMode=r,this.autoRound=a,this.autoCenter=t.autoCenter,this.resizeInterval=t.resizeInterval,a&&(e=Math.floor(e),n=Math.floor(n)),this.gameSize.setSize(e,n),o===i.ZOOM.MAX_ZOOM&&(o=this.getMaxZoom()),this.zoom=o,1!==o&&(this._resetZoom=!0),this.baseSize.setSize(e*s,n*s),a&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),t.minWidth>0&&this.displaySize.setMin(t.minWidth*o,t.minHeight*o),t.maxWidth>0&&this.displaySize.setMax(t.maxWidth*o,t.maxHeight*o),this.displaySize.setSize(e,n),this.orientation=c(e,n)},getParent:function(t){var e=t.parent;if(null!==e){if(this.parent=l(e),this.parentIsWindow=this.parent===document.body,t.expandParent&&t.scaleMode!==i.SCALE_MODE.NONE){var n=this.parent.getBoundingClientRect();(this.parentIsWindow||0===n.height)&&(document.documentElement.style.height="100%",document.body.style.height="100%",n=this.parent.getBoundingClientRect(),this.parentIsWindow||0!==n.height||(this.parent.style.overflow="hidden",this.parent.style.width="100%",this.parent.style.height="100%"))}t.fullscreenTarget&&!this.fullscreenTarget&&(this.fullscreenTarget=l(t.fullscreenTarget))}},getParentBounds:function(){if(!this.parent)return!1;var t=this.parentSize,e=this.parent.getBoundingClientRect();this.parentIsWindow&&this.game.device.os.iOS&&(e.height=u(!0));var n=this.resolution,i=e.width*n,r=e.height*n;return(t.width!==i||t.height!==r)&&(t.setSize(i,r),!0)},lockOrientation:function(t){var e=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;return!!e&&e(t)},setParentSize:function(t,e){return this.parentSize.setSize(t,e),this.refresh()},setGameSize:function(t,e){var n=this.autoRound,i=this.resolution;n&&(t=Math.floor(t),e=Math.floor(e));var r=this.width,s=this.height;return this.gameSize.resize(t,e),this.baseSize.resize(t*i,e*i),n&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t,e),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height,this.refresh(r,s)},resize:function(t,e){var n=this.zoom,i=this.resolution,r=this.autoRound;r&&(t=Math.floor(t),e=Math.floor(e));var s=this.width,o=this.height;this.gameSize.resize(t,e),this.baseSize.resize(t*i,e*i),r&&(this.baseSize.width=Math.floor(this.baseSize.width),this.baseSize.height=Math.floor(this.baseSize.height)),this.displaySize.setSize(t*n*i,e*n*i),this.canvas.width=this.baseSize.width,this.canvas.height=this.baseSize.height;var a=this.canvas.style,u=t*n,l=e*n;return r&&(u=Math.floor(u),l=Math.floor(l)),u===t&&l===e||(a.width=u+"px",a.height=l+"px"),this.refresh(s,o)},setZoom:function(t){return this.zoom=t,this._resetZoom=!0,this.refresh()},setMaxZoom:function(){return this.zoom=this.getMaxZoom(),this._resetZoom=!0,this.refresh()},refresh:function(t,e){void 0===t&&(t=this.width),void 0===e&&(e=this.height),this.updateScale(),this.updateBounds(),this.updateOrientation(),this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var n=this.game.domContainer;if(n){this.baseSize.setCSS(n);var i=this.canvas.style,r=n.style;r.transform="scale("+this.displaySize.width/this.baseSize.width+","+this.displaySize.height/this.baseSize.height+")",r.marginLeft=i.marginLeft,r.marginTop=i.marginTop}return this.emit(o.RESIZE,this.gameSize,this.baseSize,this.displaySize,this.resolution,t,e),this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=!1;var t=c(this.width,this.height);t!==this.orientation&&(this.orientation=t,this.emit(o.ORIENTATION_CHANGE,t))}},updateScale:function(){var t,e,n=this.canvas.style,r=this.zoom,s=this.autoRound;this.scaleMode===i.SCALE_MODE.NONE?(this.displaySize.setSize(this.gameSize.width*r*1,this.gameSize.height*r*1),t=this.displaySize.width/1,e=this.displaySize.height/1,s&&(t=Math.floor(t),e=Math.floor(e)),this._resetZoom&&(n.width=t+"px",n.height=e+"px",this._resetZoom=!1)):this.scaleMode===i.SCALE_MODE.RESIZE?(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),this.gameSize.setSize(this.displaySize.width,this.displaySize.height),this.baseSize.setSize(1*this.displaySize.width,1*this.displaySize.height),t=this.displaySize.width/1,e=this.displaySize.height/1,s&&(t=Math.floor(t),e=Math.floor(e)),this.canvas.width=t,this.canvas.height=e):(this.displaySize.setSize(this.parentSize.width,this.parentSize.height),t=this.displaySize.width/1,e=this.displaySize.height/1,s&&(t=Math.floor(t),e=Math.floor(e)),n.width=t+"px",n.height=e+"px"),this.getParentBounds(),this.updateCenter()},getMaxZoom:function(){var t=p(this.parentSize.width,this.gameSize.width,0,!0),e=p(this.parentSize.height,this.gameSize.height,0,!0);return Math.max(Math.min(t,e),1)},updateCenter:function(){var t=this.autoCenter;if(t!==i.CENTER.NO_CENTER){var e=this.canvas,n=e.style,r=e.getBoundingClientRect(),s=r.height,o=Math.floor((this.parentSize.width-r.width)/2),a=Math.floor((this.parentSize.height-s)/2);t===i.CENTER.CENTER_HORIZONTALLY?a=0:t===i.CENTER.CENTER_VERTICALLY&&(o=0),n.marginLeft=o+"px",n.marginTop=a+"px"}},updateBounds:function(){var t=this.canvasBounds,e=this.canvas.getBoundingClientRect();t.x=e.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0),t.y=e.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0),t.width=e.width,t.height=e.height},transformX:function(t){return(t-this.canvasBounds.left)*this.displayScale.x},transformY:function(t){return(t-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(t){void 0===t&&(t={navigationUI:"hide"});var e=this.fullscreen;if(e.available){if(!e.active){var n,i=this.getFullscreenTarget();this._requestedFullscreenChange=!0,(n=i[e.request](e.keyboard?Element.ALLOW_KEYBOARD_INPUT:t))?n.then(this.fullscreenSuccessHandler.bind(this)).catch(this.fullscreenErrorHandler.bind(this)):e.active?this.fullscreenSuccessHandler():this.fullscreenErrorHandler()}}else this.emit(o.FULLSCREEN_UNSUPPORTED)},fullscreenSuccessHandler:function(){this.getParentBounds(),this.refresh(),this.emit(o.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(t){this.removeFullscreenTarget(),this.emit(o.FULLSCREEN_FAILED,t)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var t=document.createElement("div");t.style.margin="0",t.style.padding="0",t.style.width="100%",t.style.height="100%",this.fullscreenTarget=t,this._createdFullscreenTarget=!0}return this._createdFullscreenTarget&&(this.canvas.parentNode.insertBefore(this.fullscreenTarget,this.canvas),this.fullscreenTarget.appendChild(this.canvas)),this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var t=this.fullscreenTarget;if(t&&t.parentNode){var e=t.parentNode;e.insertBefore(this.canvas,t),e.removeChild(t)}}},stopFullscreen:function(){var t=this.fullscreen;if(!t.available)return this.emit(o.FULLSCREEN_UNSUPPORTED),!1;t.active&&(this._requestedFullscreenChange=!0,document[t.cancel]()),this.removeFullscreenTarget(),this.getParentBounds(),this.emit(o.LEAVE_FULLSCREEN),this.refresh()},toggleFullscreen:function(t){this.fullscreen.active?this.stopFullscreen():this.startFullscreen(t)},startListeners:function(){var t=this,e=this.listeners;e.orientationChange=function(){t._checkOrientation=!0,t.dirty=!0},e.windowResize=function(){t.dirty=!0},window.addEventListener("orientationchange",e.orientationChange,!1),window.addEventListener("resize",e.windowResize,!1),this.fullscreen.available&&(e.fullScreenChange=function(e){return t.onFullScreenChange(e)},e.fullScreenError=function(e){return t.onFullScreenError(e)},["webkit","moz",""].forEach(function(t){document.addEventListener(t+"fullscreenchange",e.fullScreenChange,!1),document.addEventListener(t+"fullscreenerror",e.fullScreenError,!1)}),document.addEventListener("MSFullscreenChange",e.fullScreenChange,!1),document.addEventListener("MSFullscreenError",e.fullScreenError,!1))},onFullScreenChange:function(){this._requestedFullscreenChange||this.stopFullscreen(),this._requestedFullscreenChange=!1},onFullScreenError:function(){this.removeFullscreenTarget()},step:function(t,e){this.parent&&(this._lastCheck+=e,(this.dirty||this._lastCheck>this.resizeInterval)&&(this.getParentBounds()&&this.refresh(),this.dirty=!1,this._lastCheck=0))},stopListeners:function(){var t=this.listeners;window.removeEventListener("orientationchange",t.orientationChange,!1),window.removeEventListener("resize",t.windowResize,!1),["webkit","moz",""].forEach(function(e){document.removeEventListener(e+"fullscreenchange",t.fullScreenChange,!1),document.removeEventListener(e+"fullscreenerror",t.fullScreenError,!1)}),document.removeEventListener("MSFullscreenChange",t.fullScreenChange,!1),document.removeEventListener("MSFullscreenError",t.fullScreenError,!1)},destroy:function(){this.removeAllListeners(),this.stopListeners(),this.game=null,this.canvas=null,this.canvasBounds=null,this.parent=null,this.fullscreenTarget=null,this.parentSize.destroy(),this.gameSize.destroy(),this.baseSize.destroy(),this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return this.orientation===i.ORIENTATION.PORTRAIT}},isLandscape:{get:function(){return this.orientation===i.ORIENTATION.LANDSCAPE}},isGamePortrait:{get:function(){return this.height>this.width}},isGameLandscape:{get:function(){return this.width>this.height}}});t.exports=g},function(t,e,n){var i=n(22),r=n(0),s=n(93),o=n(3),a=new r({initialize:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=0),void 0===i&&(i=null),this._width=t,this._height=e,this._parent=i,this.aspectMode=n,this.aspectRatio=0===e?1:t/e,this.minWidth=0,this.minHeight=0,this.maxWidth=Number.MAX_VALUE,this.maxHeight=Number.MAX_VALUE,this.snapTo=new o},setAspectMode:function(t){return void 0===t&&(t=0),this.aspectMode=t,this.setSize(this._width,this._height)},setSnap:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.snapTo.set(t,e),this.setSize(this._width,this._height)},setParent:function(t){return this._parent=t,this.setSize(this._width,this._height)},setMin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.minWidth=i(t,0,this.maxWidth),this.minHeight=i(e,0,this.maxHeight),this.setSize(this._width,this._height)},setMax:function(t,e){return void 0===t&&(t=Number.MAX_VALUE),void 0===e&&(e=t),this.maxWidth=i(t,this.minWidth,Number.MAX_VALUE),this.maxHeight=i(e,this.minHeight,Number.MAX_VALUE),this.setSize(this._width,this._height)},setSize:function(t,e){switch(void 0===t&&(t=0),void 0===e&&(e=t),this.aspectMode){case a.NONE:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height;break;case a.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(this._width*(1/this.aspectRatio),!1);break;case a.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(s(e,this.snapTo.y)),this._width=this.getNewWidth(this._height*this.aspectRatio,!1);break;case a.FIT:this.constrain(t,e,!0);break;case a.ENVELOP:this.constrain(t,e,!1)}return this},setAspectRatio:function(t){return this.aspectRatio=t,this.setSize(this._width,this._height)},resize:function(t,e){return this._width=this.getNewWidth(s(t,this.snapTo.x)),this._height=this.getNewHeight(s(e,this.snapTo.y)),this.aspectRatio=0===this._height?1:this._width/this._height,this},getNewWidth:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minWidth,this.maxWidth),e&&this._parent&&t>this._parent.width&&(t=Math.max(this.minWidth,this._parent.width)),t},getNewHeight:function(t,e){return void 0===e&&(e=!0),t=i(t,this.minHeight,this.maxHeight),e&&this._parent&&t>this._parent.height&&(t=Math.max(this.minHeight,this._parent.height)),t},constrain:function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=t),void 0===n&&(n=!0),t=this.getNewWidth(t),e=this.getNewHeight(e);var i=this.snapTo,r=0===e?1:t/e;return n&&this.aspectRatio>r||!n&&this.aspectRatio<r?(e=(t=s(t,i.x))/this.aspectRatio,i.y>0&&(t=(e=s(e,i.y))*this.aspectRatio)):(n&&this.aspectRatio<r||!n&&this.aspectRatio>r)&&(t=(e=s(e,i.y))*this.aspectRatio,i.x>0&&(e=(t=s(t,i.x))*(1/this.aspectRatio))),this._width=t,this._height=e,this},fitTo:function(t,e){return this.constrain(t,e,!0)},envelop:function(t,e){return this.constrain(t,e,!1)},setWidth:function(t){return this.setSize(t,this._height)},setHeight:function(t){return this.setSize(this._width,t)},toString:function(){return"[{ Size (width="+this._width+" height="+this._height+" aspectRatio="+this.aspectRatio+" aspectMode="+this.aspectMode+") }]"},setCSS:function(t){t&&t.style&&(t.style.width=this._width+"px",t.style.height=this._height+"px")},copy:function(t){return t.setAspectMode(this.aspectMode),t.aspectRatio=this.aspectRatio,t.setSize(this.width,this.height)},destroy:function(){this._parent=null,this.snapTo=null},width:{get:function(){return this._width},set:function(t){this.setSize(t,this._height)}},height:{get:function(){return this._height},set:function(t){this.setSize(this._width,t)}}});a.NONE=0,a.WIDTH_CONTROLS_HEIGHT=1,a.HEIGHT_CONTROLS_WIDTH=2,a.FIT=3,a.ENVELOP=4,t.exports=a},function(t,e,n){var i=n(0),r=n(121),s=n(21),o=n(17),a=n(6),u=n(81),l=n(1),c=n(352),h=n(177),d=new i({initialize:function(t,e){if(this.game=t,this.keys={},this.scenes=[],this._pending=[],this._start=[],this._queue=[],this._data={},this.isProcessing=!1,this.isBooted=!1,this.customViewports=0,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)this._pending.push({key:"default",scene:e[n],autoStart:0===n,data:{}})}t.events.once(o.READY,this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var t,e,n,i;for(t=0;t<this._pending.length;t++){var r;n=(e=this._pending[t]).key,(i=e.scene)instanceof c?r=this.createSceneFromInstance(n,i):"object"==typeof i?r=this.createSceneFromObject(n,i):"function"==typeof i&&(r=this.createSceneFromFunction(n,i)),this.keys[n=r.sys.settings.key]=r,this.scenes.push(r),this._data[n]&&(r.sys.settings.data=this._data[n].data,this._data[n].autoStart&&(e.autoStart=!0)),(e.autoStart||r.sys.settings.active)&&this._start.push(n)}for(this._pending.length=0,this._data={},this.isBooted=!0,t=0;t<this._start.length;t++)this.start(e=this._start[t]);this._start.length=0}},processQueue:function(){var t=this._pending.length;if(0!==t||0!==this._queue.length){var e,n;if(t){for(e=0;e<t;e++)this.add((n=this._pending[e]).key,n.scene,n.autoStart,n.data);for(e=0;e<this._start.length;e++)this.start(n=this._start[e]);return this._start.length=0,void(this._pending.length=0)}for(e=0;e<this._queue.length;e++)this[(n=this._queue[e]).op](n.keyA,n.keyB);this._queue.length=0}},add:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i={}),this.isProcessing||!this.isBooted?(this._pending.push({key:t,scene:e,autoStart:n,data:i}),this.isBooted||(this._data[t]={data:i}),null):(t=this.getKey(t,e),e instanceof c?r=this.createSceneFromInstance(t,e):"object"==typeof e?(e.key=t,r=this.createSceneFromObject(t,e)):"function"==typeof e&&(r=this.createSceneFromFunction(t,e)),r.sys.settings.data=i,this.keys[t=r.sys.settings.key]=r,this.scenes.push(r),(n||r.sys.settings.active)&&(this._pending.length?this._start.push(t):this.start(t)),r);var r},remove:function(t){if(this.isProcessing)this._queue.push({op:"remove",keyA:t,keyB:null});else{var e=this.getScene(t);if(!e||e.sys.isTransitioning())return this;var n=this.scenes.indexOf(e),i=e.sys.settings.key;n>-1&&(delete this.keys[i],this.scenes.splice(n,1),this._start.indexOf(i)>-1&&(n=this._start.indexOf(i),this._start.splice(n,1)),e.sys.destroy())}return this},bootScene:function(t){var e,n=t.sys,i=n.settings;t.init&&(t.init.call(t,i.data),i.status=r.INIT,i.isTransition&&n.events.emit(s.TRANSITION_INIT,i.transitionFrom,i.transitionDuration)),n.load&&(e=n.load).reset(),e&&t.preload?(t.preload.call(t),0===e.list.size?this.create(t):(i.status=r.LOADING,e.once(u.COMPLETE,this.loadComplete,this),e.start())):this.create(t)},loadComplete:function(t){var e=t.scene;this.game.sound&&this.game.sound.onBlurPausedSounds&&this.game.sound.unlock(),this.create(e)},payloadComplete:function(t){this.bootScene(t.scene)},update:function(t,e){this.processQueue(),this.isProcessing=!0;for(var n=this.scenes.length-1;n>=0;n--){var i=this.scenes[n].sys;i.settings.status>r.START&&i.settings.status<=r.RUNNING&&i.step(t,e)}},render:function(t){for(var e=0;e<this.scenes.length;e++){var n=this.scenes[e].sys;n.settings.visible&&n.settings.status>=r.LOADING&&n.settings.status<r.SLEEPING&&n.render(t)}this.isProcessing=!1},create:function(t){var e=t.sys,n=e.settings;t.create&&(n.status=r.CREATING,t.create.call(t,n.data),n.status===r.DESTROYED)||(n.isTransition&&e.events.emit(s.TRANSITION_START,n.transitionFrom,n.transitionDuration),t.update&&(e.sceneUpdate=t.update),n.status=r.RUNNING,e.events.emit(s.CREATE,t))},createSceneFromFunction:function(t,e){var n=new e;if(n instanceof c){var i=n.sys.settings.key;if(""!==i&&(t=i),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return this.createSceneFromInstance(t,n)}return n.sys=new h(n),n.sys.settings.key=t,n.sys.init(this.game),n},createSceneFromInstance:function(t,e){var n=e.sys.settings.key;return""!==n?t=n:e.sys.settings.key=t,e.sys.init(this.game),e},createSceneFromObject:function(t,e){var n=new c(e),i=n.sys.settings.key;""!==i?t=i:n.sys.settings.key=t,n.sys.init(this.game);for(var r=["init","preload","create","update","render"],s=0;s<r.length;s++){var o=a(e,r[s],null);o&&(n[r[s]]=o)}if(e.hasOwnProperty("extend"))for(var u in e.extend)if(e.extend.hasOwnProperty(u)){var l=e.extend[u];"data"===u&&n.hasOwnProperty("data")&&"object"==typeof l?n.data.merge(l):"sys"!==u&&(n[u]=l)}return n},getKey:function(t,e){if(t||(t="default"),"function"==typeof e)return t;if(e instanceof c?t=e.sys.settings.key:"object"==typeof e&&e.hasOwnProperty("key")&&(t=e.key),this.keys.hasOwnProperty(t))throw new Error("Cannot add a Scene with duplicate key: "+t);return t},getScenes:function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1);for(var n=[],i=this.scenes,r=0;r<i.length;r++){var s=i[r];s&&(!t||t&&s.sys.isActive())&&n.push(s)}return e?n.reverse():n},getScene:function(t){if("string"==typeof t){if(this.keys[t])return this.keys[t]}else for(var e=0;e<this.scenes.length;e++)if(t===this.scenes[e])return t;return null},isActive:function(t){var e=this.getScene(t);return e?e.sys.isActive():null},isPaused:function(t){var e=this.getScene(t);return e?e.sys.isPaused():null},isVisible:function(t){var e=this.getScene(t);return e?e.sys.isVisible():null},isSleeping:function(t){var e=this.getScene(t);return e?e.sys.isSleeping():null},pause:function(t,e){var n=this.getScene(t);return n&&n.sys.pause(e),this},resume:function(t,e){var n=this.getScene(t);return n&&n.sys.resume(e),this},sleep:function(t,e){var n=this.getScene(t);return n&&!n.sys.isTransitioning()&&n.sys.sleep(e),this},wake:function(t,e){var n=this.getScene(t);return n&&n.sys.wake(e),this},run:function(t,e){var n=this.getScene(t);if(!n){for(var i=0;i<this._pending.length;i++)if(this._pending[i].key===t){this.queueOp("start",t,e);break}return this}n.sys.isSleeping()?n.sys.wake(e):n.sys.isPaused()?n.sys.resume(e):this.start(t,e)},start:function(t,e){if(!this.isBooted)return this._data[t]={autoStart:!0,data:e},this;var n=this.getScene(t);if(n){var i;if(n.sys.isActive()||n.sys.isPaused())n.sys.shutdown(),n.sys.start(e);else if(n.sys.start(e),n.sys.load&&(i=n.sys.load),i&&n.sys.settings.hasOwnProperty("pack")&&(i.reset(),i.addPack({payload:n.sys.settings.pack})))return n.sys.settings.status=r.LOADING,i.once(u.COMPLETE,this.payloadComplete,this),i.start(),this;this.bootScene(n)}return this},stop:function(t,e){var n=this.getScene(t);return n&&!n.sys.isTransitioning()&&n.sys.shutdown(e),this},switch:function(t,e){var n=this.getScene(t),i=this.getScene(e);return n&&i&&n!==i&&(this.sleep(t),this.isSleeping(e)?this.wake(e):this.start(e)),this},getAt:function(t){return this.scenes[t]},getIndex:function(t){var e=this.getScene(t);return this.scenes.indexOf(e)},bringToTop:function(t){if(this.isProcessing)this._queue.push({op:"bringToTop",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e<this.scenes.length){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.push(n)}}return this},sendToBack:function(t){if(this.isProcessing)this._queue.push({op:"sendToBack",keyA:t,keyB:null});else{var e=this.getIndex(t);if(-1!==e&&e>0){var n=this.getScene(t);this.scenes.splice(e,1),this.scenes.unshift(n)}}return this},moveDown:function(t){if(this.isProcessing)this._queue.push({op:"moveDown",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e>0){var n=e-1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveUp:function(t){if(this.isProcessing)this._queue.push({op:"moveUp",keyA:t,keyB:null});else{var e=this.getIndex(t);if(e<this.scenes.length-1){var n=e+1,i=this.getScene(t),r=this.getAt(n);this.scenes[e]=r,this.scenes[n]=i}}return this},moveAbove:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveAbove",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i){var r=this.getAt(i);this.scenes.splice(i,1),this.scenes.splice(n+1,0,r)}}return this},moveBelow:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"moveBelow",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(-1!==n&&-1!==i){var r=this.getAt(i);this.scenes.splice(i,1),0===n?this.scenes.unshift(r):this.scenes.splice(n,0,r)}}return this},queueOp:function(t,e,n){return this._queue.push({op:t,keyA:e,keyB:n}),this},swapPosition:function(t,e){if(t===e)return this;if(this.isProcessing)this._queue.push({op:"swapPosition",keyA:t,keyB:e});else{var n=this.getIndex(t),i=this.getIndex(e);if(n!==i&&-1!==n&&-1!==i){var r=this.getAt(n);this.scenes[n]=this.scenes[i],this.scenes[i]=r}}return this},dump:function(){for(var t=[],e=["pending","init","start","loading","creating","running","paused","sleeping","shutdown","destroyed"],n=0;n<this.scenes.length;n++){var i=this.scenes[n].sys,s=!i.settings.visible||i.settings.status!==r.RUNNING&&i.settings.status!==r.PAUSED?"[-] ":"[*] ";t.push(s+=i.settings.key+" ("+e[i.settings.status]+")")}console.log(t.join("\n"))},destroy:function(){for(var t=0;t<this.scenes.length;t++)this.scenes[t].sys.destroy();this.update=l,this.scenes=[],this._pending=[],this._start=[],this._queue=[],this.game=null}});t.exports=d},function(t,e,n){var i=n(0),r=n(177),s=new i({initialize:function(t){this.sys=new r(this,t)},update:function(){}});t.exports=s},function(t,e,n){var i=n(121),r=n(6),s=n(106),o=n(857),a={create:function(t){return"string"==typeof t?t={key:t}:void 0===t&&(t={}),{status:i.PENDING,key:r(t,"key",""),active:r(t,"active",!1),visible:r(t,"visible",!0),isBooted:!1,isTransition:!1,transitionFrom:null,transitionDuration:0,transitionAllowInput:!0,data:{},pack:r(t,"pack",!1),cameras:r(t,"cameras",null),map:r(t,"map",s(o,r(t,"mapAdd",{}))),physics:r(t,"physics",{}),loader:r(t,"loader",{}),plugins:r(t,"plugins",!1),input:r(t,"input",{})}}};t.exports=a},function(t,e,n){var i=n(25),r=n(355),s=n(0),o=n(33),a=n(29),u=n(9),l=n(117),c=n(17),h=n(324),d=n(6),f=n(357),p=n(179),m=new s({Extends:u,initialize:function(t){u.call(this),this.game=t,this.name="TextureManager",this.list={},this._tempCanvas=i.create2D(this,1,1),this._tempContext=this._tempCanvas.getContext("2d"),this._pending=0,t.events.once(c.BOOT,this.boot,this)},boot:function(){this._pending=2,this.on(l.LOAD,this.updatePending,this),this.on(l.ERROR,this.updatePending,this),this.addBase64("__DEFAULT",this.game.config.defaultImage),this.addBase64("__MISSING",this.game.config.missingImage),this.game.events.once(c.DESTROY,this.destroy,this)},updatePending:function(){this._pending--,0===this._pending&&(this.off(l.LOAD),this.off(l.ERROR),this.emit(l.READY))},checkKey:function(t){return!this.exists(t)||(console.error("Texture key already in use: "+t),!1)},remove:function(t){if("string"==typeof t){if(!this.exists(t))return console.warn("No texture found matching key: "+t),this;t=this.get(t)}return this.list.hasOwnProperty(t.key)&&(t.destroy(),this.emit(l.REMOVE,t.key)),this},removeKey:function(t){return this.list.hasOwnProperty(t)&&delete this.list[t],this},addBase64:function(t,e){if(this.checkKey(t)){var n=this,i=new Image;i.onerror=function(){n.emit(l.ERROR,t)},i.onload=function(){var e=n.create(t,i);f.Image(e,0),n.emit(l.ADD,t,e),n.emit(l.LOAD,t,e)},i.src=e}return this},getBase64:function(t,e,n,r){void 0===n&&(n="image/png"),void 0===r&&(r=.92);var s="",o=this.getFrame(t,e);if(o&&(o.source.isRenderTexture||o.source.isGLTexture))console.warn("Cannot getBase64 from WebGL Texture");else if(o){var a=o.canvasData,u=i.create2D(this,a.width,a.height);u.getContext("2d").drawImage(o.source.image,a.x,a.y,a.width,a.height,0,0,a.width,a.height),s=u.toDataURL(n,r),i.remove(u)}return s},addImage:function(t,e,n){var i=null;return this.checkKey(t)&&(i=this.create(t,e),f.Image(i,0),n&&i.setDataSource(n),this.emit(l.ADD,t,i)),i},addGLTexture:function(t,e,n,i){var r=null;return this.checkKey(t)&&((r=this.create(t,e,n,i)).add("__BASE",0,0,0,n,i),this.emit(l.ADD,t,r)),r},addRenderTexture:function(t,e){var n=null;return this.checkKey(t)&&((n=this.create(t,e)).add("__BASE",0,0,0,e.width,e.height),this.emit(l.ADD,t,n)),n},generate:function(t,e){if(this.checkKey(t)){var n=i.create(this,1,1);return e.canvas=n,h(e),this.addCanvas(t,n)}return null},createCanvas:function(t,e,n){if(void 0===e&&(e=256),void 0===n&&(n=256),this.checkKey(t)){var r=i.create(this,e,n,a.CANVAS,!0);return this.addCanvas(t,r)}return null},addCanvas:function(t,e,n){void 0===n&&(n=!1);var i=null;return n?i=new r(this,t,e,e.width,e.height):this.checkKey(t)&&(i=new r(this,t,e,e.width,e.height),this.list[t]=i,this.emit(l.ADD,t,i)),i},addAtlas:function(t,e,n,i){return Array.isArray(n.textures)||Array.isArray(n.frames)?this.addAtlasJSONArray(t,e,n,i):this.addAtlasJSONHash(t,e,n,i)},addAtlasJSONArray:function(t,e,n,i){var r=null;if(this.checkKey(t)){if(r=this.create(t,e),Array.isArray(n))for(var s=1===n.length,o=0;o<r.source.length;o++)f.JSONArray(r,o,s?n[0]:n[o]);else f.JSONArray(r,0,n);i&&r.setDataSource(i),this.emit(l.ADD,t,r)}return r},addAtlasJSONHash:function(t,e,n,i){var r=null;if(this.checkKey(t)){if(r=this.create(t,e),Array.isArray(n))for(var s=0;s<n.length;s++)f.JSONHash(r,s,n[s]);else f.JSONHash(r,0,n);i&&r.setDataSource(i),this.emit(l.ADD,t,r)}return r},addAtlasXML:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=this.create(t,e),f.AtlasXML(r,0,n),i&&r.setDataSource(i),this.emit(l.ADD,t,r)),r},addUnityAtlas:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=this.create(t,e),f.UnityYAML(r,0,n),i&&r.setDataSource(i),this.emit(l.ADD,t,r)),r},addSpriteSheet:function(t,e,n){var i=null;if(this.checkKey(t)){var r=(i=this.create(t,e)).source[0].width;f.SpriteSheet(i,0,0,0,r,i.source[0].height,n),this.emit(l.ADD,t,i)}return i},addSpriteSheetFromAtlas:function(t,e){if(!this.checkKey(t))return null;var n=d(e,"atlas",null),i=d(e,"frame",null);if(n&&i){var r=this.get(n).get(i);if(r){var s=this.create(t,r.source.image);return r.trimmed?f.SpriteSheetFromAtlas(s,r,e):f.SpriteSheet(s,0,r.cutX,r.cutY,r.cutWidth,r.cutHeight,e),this.emit(l.ADD,t,s),s}}},create:function(t,e,n,i){var r=null;return this.checkKey(t)&&(r=new p(this,t,e,n,i),this.list[t]=r),r},exists:function(t){return this.list.hasOwnProperty(t)},get:function(t){return void 0===t&&(t="__DEFAULT"),this.list[t]?this.list[t]:t instanceof p?t:this.list.__MISSING},cloneFrame:function(t,e){if(this.list[t])return this.list[t].get(e).clone()},getFrame:function(t,e){if(this.list[t])return this.list[t].get(e)},getTextureKeys:function(){var t=[];for(var e in this.list)"__DEFAULT"!==e&&"__MISSING"!==e&&t.push(e);return t},getPixel:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(e+=s.y,(t+=s.x)>=s.x&&t<s.r&&e>=s.y&&e<s.b){var a=this._tempContext;a.clearRect(0,0,1,1),a.drawImage(r.source.image,t,e,1,1,0,0,1,1);var u=a.getImageData(0,0,1,1);return new o(u.data[0],u.data[1],u.data[2],u.data[3])}}return null},getPixelAlpha:function(t,e,n,i){var r=this.getFrame(n,i);if(r){t-=r.x,e-=r.y;var s=r.data.cut;if(e+=s.y,(t+=s.x)>=s.x&&t<s.r&&e>=s.y&&e<s.b){var o=this._tempContext;return o.clearRect(0,0,1,1),o.drawImage(r.source.image,t,e,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[3]}}return null},setTexture:function(t,e,n){return this.list[e]&&(t.texture=this.list[e],t.frame=t.texture.get(n)),t},renameTexture:function(t,e){var n=this.get(t);return!(!n||t===e||(n.key=e,this.list[e]=n,delete this.list[t],0))},each:function(t,e){for(var n=[null],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[0]=this.list[r],t.apply(e,n)},destroy:function(){for(var t in this.list)this.list[t].destroy();this.list={},this.game=null,i.remove(this._tempCanvas)}});t.exports=m},function(t,e,n){var i=n(0),r=n(22),s=n(33),o=n(29),a=n(116),u=n(179),l=new i({Extends:u,initialize:function(t,e,n,i,r){u.call(this,t,e,n,i,r),this.add("__BASE",0,0,0,i,r),this._source=this.frames.__BASE.source,this.canvas=this._source.image,this.context=this.canvas.getContext("2d"),this.width=i,this.height=r,this.imageData=this.context.getImageData(0,0,i,r),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data)},update:function(){return this.imageData=this.context.getImageData(0,0,this.width,this.height),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this.manager.game.config.renderType===o.WEBGL&&this.refresh(),this},draw:function(t,e,n){return this.context.drawImage(n,t,e),this.update()},drawFrame:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=this.manager.getFrame(t,e);if(r){var s=r.canvasData,o=r.cutWidth,a=r.cutHeight,u=r.source.resolution;return this.context.drawImage(r.source.image,s.x,s.y,o,a,n,i,o/u,a/u),this.update()}return this},setPixel:function(t,e,n,i,r,s){if(void 0===s&&(s=255),t=Math.abs(Math.floor(t)),e=Math.abs(Math.floor(e)),this.getIndex(t,e)>-1){var o=this.context.getImageData(t,e,1,1);o.data[0]=n,o.data[1]=i,o.data[2]=r,o.data[3]=s,this.context.putImageData(o,t,e)}return this},putData:function(t,e,n,i,r,s,o){return void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=t.width),void 0===o&&(o=t.height),this.context.putImageData(t,e,n,i,r,s,o),this},getData:function(t,e,n,i){return t=r(Math.floor(t),0,this.width-1),e=r(Math.floor(e),0,this.height-1),n=r(n,1,this.width-t),i=r(i,1,this.height-e),this.context.getImageData(t,e,n,i)},getPixel:function(t,e,n){n||(n=new s);var i=this.getIndex(t,e);if(i>-1){var r=this.data;n.setTo(r[i+0],r[i+1],r[i+2],r[i+3])}return n},getPixels:function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=n),t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e));for(var o=r(t,0,this.width),a=r(t+n,0,this.width),u=r(e,0,this.height),l=r(e+i,0,this.height),c=new s,h=[],d=u;d<l;d++){for(var f=[],p=o;p<a;p++)c=this.getPixel(p,d,c),f.push({x:p,y:d,color:c.color,alpha:c.alphaGL});h.push(f)}return h},getIndex:function(t,e){return t=Math.abs(Math.round(t)),e=Math.abs(Math.round(e)),t<this.width&&e<this.height?4*(t+e*this.width):-1},refresh:function(){return this._source.update(),this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.width),void 0===i&&(i=this.height),this.context.clearRect(t,e,n,i),this.update()},setSize:function(t,e){return void 0===e&&(e=t),t===this.width&&e===this.height||(this.canvas.width=t,this.canvas.height=e,this._source.width=t,this._source.height=e,this._source.isPowerOf2=a(t,e),this.frames.__BASE.setSize(t,e,0,0),this.refresh()),this},destroy:function(){u.prototype.destroy.call(this),this._source=null,this.canvas=null,this.context=null,this.imageData=null,this.data=null,this.pixels=null,this.buffer=null}});t.exports=l},function(t,e,n){var i=n(25),r=n(0),s=n(116),o=n(228),a=new r({initialize:function(t,e,n,i,r){void 0===r&&(r=!1);var a=t.manager.game;this.renderer=a.renderer,this.texture=t,this.source=e,this.image=e,this.compressionAlgorithm=null,this.resolution=1,this.width=n||e.naturalWidth||e.videoWidth||e.width||0,this.height=i||e.naturalHeight||e.videoHeight||e.height||0,this.scaleMode=o.DEFAULT,this.isCanvas=e instanceof HTMLCanvasElement,this.isVideo=e instanceof HTMLVideoElement,this.isRenderTexture="RenderTexture"===e.type,this.isGLTexture=window.hasOwnProperty("WebGLTexture")&&e instanceof WebGLTexture,this.isPowerOf2=s(this.width,this.height),this.glTexture=null,this.flipY=r,this.init(a)},init:function(t){this.renderer&&(this.renderer.gl?this.isCanvas?this.glTexture=this.renderer.createCanvasTexture(this.image,!1,this.flipY):this.isVideo?this.glTexture=this.renderer.createVideoTexture(this.image,!1,this.flipY):this.isRenderTexture?(this.image=this.source.canvas,this.glTexture=this.renderer.createTextureFromSource(null,this.width,this.height,this.scaleMode)):this.glTexture=this.isGLTexture?this.source:this.renderer.createTextureFromSource(this.image,this.width,this.height,this.scaleMode):this.isRenderTexture&&(this.image=this.source.canvas)),t.config.antialias||this.setFilter(1)},setFilter:function(t){this.renderer.gl&&this.renderer.setTextureFilter(this.glTexture,t),this.scaleMode=t},setFlipY:function(t){return void 0===t&&(t=!0),this.flipY=t,this},update:function(){var t=this.renderer.gl;t&&this.isCanvas?this.glTexture=this.renderer.updateCanvasTexture(this.image,this.glTexture,this.flipY):t&&this.isVideo&&(this.glTexture=this.renderer.updateVideoTexture(this.image,this.glTexture,this.flipY))},destroy:function(){this.glTexture&&this.renderer.deleteTexture(this.glTexture),this.isCanvas&&i.remove(this.image),this.renderer=null,this.texture=null,this.source=null,this.image=null,this.glTexture=null}});t.exports=a},function(t,e,n){t.exports={AtlasXML:n(858),Canvas:n(859),Image:n(860),JSONArray:n(861),JSONHash:n(862),SpriteSheet:n(863),SpriteSheetFromAtlas:n(864),UnityYAML:n(865)}},function(t,e,n){var i=n(359),r=n(361),s=n(363);t.exports={create:function(t){var e=t.config.audio,n=t.device.audio;return e&&e.noAudio||!n.webAudio&&!n.audioData?new r(t):!n.webAudio||e&&e.disableWebAudio?new i(t):new s(t)}}},function(t,e,n){var i=n(122),r=n(0),s=n(59),o=n(360),a=new r({Extends:i,initialize:function(t){this.override=!0,this.audioPlayDelay=.1,this.loopEndOffset=.05,this.onBlurPausedSounds=[],this.locked="ontouchstart"in window,this.lockedActionsQueue=this.locked?[]:null,this._mute=!1,this._volume=1,i.call(this,t)},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},unlock:function(){this.locked=!1;var t=this;if(this.game.cache.audio.entries.each(function(e,n){for(var i=0;i<n.length;i++)if("true"===n[i].dataset.locked)return t.locked=!0,!1;return!0}),this.locked){var e=!1,n=function(){e=!0},i=function(){if(e)e=!1;else{document.body.removeEventListener("touchmove",n),document.body.removeEventListener("touchend",i);var r=[];if(t.game.cache.audio.entries.each(function(t,e){for(var n=0;n<e.length;n++){var i=e[n];"true"===i.dataset.locked&&r.push(i)}return!0}),0!==r.length){var s=r[r.length-1];s.oncanplaythrough=function(){s.oncanplaythrough=null,r.forEach(function(t){t.dataset.locked="false"}),t.unlocked=!0},r.forEach(function(t){t.load()})}}};this.once(s.UNLOCKED,function(){for(this.forEachActiveSound(function(t){null===t.currentMarker&&0===t.duration&&(t.duration=t.tags[0].duration),t.totalDuration=t.tags[0].duration});this.lockedActionsQueue.length;){var t=this.lockedActionsQueue.shift();t.sound[t.prop].apply?t.sound[t.prop].apply(t.sound,t.value||[]):t.sound[t.prop]=t.value}},this),document.body.addEventListener("touchmove",n,!1),document.body.addEventListener("touchend",i,!1)}},onBlur:function(){this.forEachActiveSound(function(t){t.isPlaying&&(this.onBlurPausedSounds.push(t),t.onBlur())})},onFocus:function(){this.onBlurPausedSounds.forEach(function(t){t.onFocus()}),this.onBlurPausedSounds.length=0},destroy:function(){i.prototype.destroy.call(this),this.onBlurPausedSounds.length=0,this.onBlurPausedSounds=null},isLocked:function(t,e,n){return"true"===t.tags[0].dataset.locked&&(this.lockedActionsQueue.push({sound:t,prop:e,value:n}),!0)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return this._mute},set:function(t){this._mute=t,this.forEachActiveSound(function(t){t.updateMute()}),this.emit(s.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this._volume},set:function(t){this._volume=t,this.forEachActiveSound(function(t){t.updateVolume()}),this.emit(s.GLOBAL_VOLUME,this,t)}}});t.exports=a},function(t,e,n){var i=n(123),r=n(0),s=n(59),o=new r({Extends:i,initialize:function(t,e,n){void 0===n&&(n={}),this.tags=t.game.cache.audio.get(e),this.tags?(this.audio=null,this.startTime=0,this.previousTime=0,this.duration=this.tags[0].duration,this.totalDuration=this.tags[0].duration,i.call(this,t,e,n)):console.warn("Audio cache entry missing: "+e)},play:function(t,e){return!(this.manager.isLocked(this,"play",[t,e])||!i.prototype.play.call(this,t,e)||!this.pickAndPlayAudioTag()||(this.emit(s.PLAY,this),0))},pause:function(){return!(this.manager.isLocked(this,"pause")||this.startTime>0||!i.prototype.pause.call(this)||(this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.stopAndReleaseAudioTag(),this.emit(s.PAUSE,this),0))},resume:function(){return!(this.manager.isLocked(this,"resume")||this.startTime>0||!i.prototype.resume.call(this)||!this.pickAndPlayAudioTag()||(this.emit(s.RESUME,this),0))},stop:function(){return!this.manager.isLocked(this,"stop")&&!!i.prototype.stop.call(this)&&(this.stopAndReleaseAudioTag(),this.emit(s.STOP,this),!0)},pickAndPlayAudioTag:function(){if(!this.pickAudioTag())return this.reset(),!1;var t=this.currentConfig.delay,e=(this.currentMarker?this.currentMarker.start:0)+this.currentConfig.seek;return this.previousTime=e,this.audio.currentTime=e,this.applyConfig(),0===t?(this.startTime=0,this.audio.paused&&this.playCatchPromise()):(this.startTime=window.performance.now()+1e3*t,this.audio.paused||this.audio.pause()),this.resetConfig(),!0},pickAudioTag:function(){if(this.audio)return!0;for(var t=0;t<this.tags.length;t++){var e=this.tags[t];if("false"===e.dataset.used)return e.dataset.used="true",this.audio=e,!0}if(!this.manager.override)return!1;var n=[];this.manager.forEachActiveSound(function(t){t.key===this.key&&t.audio&&n.push(t)},this),n.sort(function(t,e){return t.loop===e.loop?e.seek/e.duration-t.seek/t.duration:t.loop?1:-1});var i=n[0];return this.audio=i.audio,i.reset(),i.audio=null,i.startTime=0,i.previousTime=0,!0},playCatchPromise:function(){var t=this.audio.play();t&&t.catch(function(t){console.warn(t)})},stopAndReleaseAudioTag:function(){this.audio.pause(),this.audio.dataset.used="false",this.audio=null,this.startTime=0,this.previousTime=0},reset:function(){i.prototype.stop.call(this)},onBlur:function(){this.isPlaying=!1,this.isPaused=!0,this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0),this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1e3),this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=!0,this.isPaused=!1,this.pickAndPlayAudioTag()},update:function(t,e){if(this.isPlaying)if(this.startTime>0)this.startTime<t-this.manager.audioPlayDelay&&(this.audio.currentTime+=Math.max(0,t-this.startTime)/1e3,this.startTime=0,this.previousTime=this.audio.currentTime,this.playCatchPromise());else{var n=this.currentMarker?this.currentMarker.start:0,i=n+this.duration,r=this.audio.currentTime;if(this.currentConfig.loop)r>=i-this.manager.loopEndOffset?(this.audio.currentTime=n+Math.max(0,r-i),r=this.audio.currentTime):r<n&&(this.audio.currentTime+=n,r=this.audio.currentTime),r<this.previousTime&&this.emit(s.LOOPED,this);else if(r>=i)return this.reset(),this.stopAndReleaseAudioTag(),void this.emit(s.COMPLETE,this);this.previousTime=r}},destroy:function(){i.prototype.destroy.call(this),this.tags=null,this.audio&&this.stopAndReleaseAudioTag()},updateMute:function(){this.audio&&(this.audio.muted=this.currentConfig.mute||this.manager.mute)},updateVolume:function(){this.audio&&(this.audio.volume=this.currentConfig.volume*this.manager.volume)},calculateRate:function(){i.prototype.calculateRate.call(this),this.audio&&(this.audio.playbackRate=this.totalRate)},mute:{get:function(){return this.currentConfig.mute},set:function(t){this.currentConfig.mute=t,this.manager.isLocked(this,"mute",t)||(this.updateMute(),this.emit(s.MUTE,this,t))}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.currentConfig.volume},set:function(t){this.currentConfig.volume=t,this.manager.isLocked(this,"volume",t)||(this.updateVolume(),this.emit(s.VOLUME,this,t))}},setVolume:function(t){return this.volume=t,this},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.manager.isLocked(this,s.RATE,t)||(this.calculateRate(),this.emit(s.RATE,this,t))}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.manager.isLocked(this,s.DETUNE,t)||(this.calculateRate(),this.emit(s.DETUNE,this,t))}},setDetune:function(t){return this.detune=t,this},seek:{get:function(){return this.isPlaying?this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0):this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.isLocked(this,"seek",t)||this.startTime>0||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.isPlaying?(this.previousTime=t,this.audio.currentTime=t):this.isPaused&&(this.currentConfig.seek=t),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.manager.isLocked(this,"loop",t)||(this.audio&&(this.audio.loop=t),this.emit(s.LOOP,this,t))}},setLoop:function(t){return this.loop=t,this}});t.exports=o},function(t,e,n){var i=n(122),r=n(0),s=n(9),o=n(362),a=n(1),u=new r({Extends:s,initialize:function(t){s.call(this),this.game=t,this.sounds=[],this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.pauseOnBlur=!0,this.locked=!1},add:function(t,e){var n=new o(this,t,e);return this.sounds.push(n),n},addAudioSprite:function(t,e){var n=this.add(t,e);return n.spritemap={},n},play:function(t,e){return!1},playAudioSprite:function(t,e,n){return!1},remove:function(t){return i.prototype.remove.call(this,t)},removeByKey:function(t){return i.prototype.removeByKey.call(this,t)},pauseAll:a,resumeAll:a,stopAll:a,update:a,setRate:a,setDetune:a,setMute:a,setVolume:a,forEachActiveSound:function(t,e){i.prototype.forEachActiveSound.call(this,t,e)},destroy:function(){i.prototype.destroy.call(this)}});t.exports=u},function(t,e,n){var i=n(123),r=n(0),s=n(9),o=n(16),a=new r({Extends:s,initialize:function(t,e,n){void 0===n&&(n={}),s.call(this),this.manager=t,this.key=e,this.isPlaying=!1,this.isPaused=!1,this.totalRate=1,this.duration=0,this.totalDuration=0,this.config=o({mute:!1,volume:1,rate:1,detune:0,seek:0,loop:!1,delay:0},n),this.currentConfig=this.config,this.mute=!1,this.volume=1,this.rate=1,this.detune=0,this.seek=0,this.loop=!1,this.markers={},this.currentMarker=null,this.pendingRemove=!1},addMarker:function(t){return!1},updateMarker:function(t){return!1},removeMarker:function(t){return null},play:function(t,e){return!1},pause:function(){return!1},resume:function(){return!1},stop:function(){return!1},destroy:function(){this.manager.remove(this),i.prototype.destroy.call(this)}});t.exports=a},function(t,e,n){var i=n(364),r=n(122),s=n(0),o=n(59),a=n(365),u=new s({Extends:r,initialize:function(t){this.context=this.createAudioContext(t),this.masterMuteNode=this.context.createGain(),this.masterVolumeNode=this.context.createGain(),this.masterMuteNode.connect(this.masterVolumeNode),this.masterVolumeNode.connect(this.context.destination),this.destination=this.masterMuteNode,this.locked="suspended"===this.context.state&&("ontouchstart"in window||"onclick"in window),r.call(this,t),this.locked&&this.unlock()},createAudioContext:function(t){var e=t.config.audio;return e&&e.context?(e.context.resume(),e.context):new AudioContext},add:function(t,e){var n=new a(this,t,e);return this.sounds.push(n),n},decodeAudio:function(t,e){var n;n=Array.isArray(t)?t:[{key:t,data:e}];for(var r=this.game.cache.audio,s=n.length,a=0;a<n.length;a++){var u=n[a],l=u.key,c=u.data;"string"==typeof c&&(c=i(c));var h=(function(t,e){r.add(t,e),this.emit(o.DECODED,t),0==--s&&this.emit(o.DECODED_ALL)}).bind(this,l),d=(function(t,e){console.error("Error decoding audio: "+t+" - ",e?e.message:""),0==--s&&this.emit(o.DECODED_ALL)}).bind(this,l);this.context.decodeAudioData(c,h,d)}},unlock:function(){var t=this,e=function e(){t.context&&t.context.resume().then(function(){document.body.removeEventListener("touchstart",e),document.body.removeEventListener("touchend",e),document.body.removeEventListener("click",e),t.unlocked=!0},function(){document.body.removeEventListener("touchstart",e),document.body.removeEventListener("touchend",e),document.body.removeEventListener("click",e)})};document.body&&(document.body.addEventListener("touchstart",e,!1),document.body.addEventListener("touchend",e,!1),document.body.addEventListener("click",e,!1))},onBlur:function(){this.locked||this.context.suspend()},onFocus:function(){this.locked||this.context.resume()},destroy:function(){if(this.destination=null,this.masterVolumeNode.disconnect(),this.masterVolumeNode=null,this.masterMuteNode.disconnect(),this.masterMuteNode=null,this.game.config.audio&&this.game.config.audio.context)this.context.suspend();else{var t=this;this.context.close().then(function(){t.context=null})}r.prototype.destroy.call(this)},setMute:function(t){return this.mute=t,this},mute:{get:function(){return 0===this.masterMuteNode.gain.value},set:function(t){this.masterMuteNode.gain.setValueAtTime(t?0:1,0),this.emit(o.GLOBAL_MUTE,this,t)}},setVolume:function(t){return this.volume=t,this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(t){this.masterVolumeNode.gain.setValueAtTime(t,0),this.emit(o.GLOBAL_VOLUME,this,t)}}});t.exports=u},function(t,e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),r=0;r<n.length;r++)i[n.charCodeAt(r)]=r;t.exports=function(t){var e,n,r,s,o=(t=t.substr(t.indexOf(",")+1)).length,a=.75*o,u=0;"="===t[o-1]&&(a--,"="===t[o-2]&&a--);for(var l=new ArrayBuffer(a),c=new Uint8Array(l),h=0;h<o;h+=4)e=i[t.charCodeAt(h)],n=i[t.charCodeAt(h+1)],r=i[t.charCodeAt(h+2)],s=i[t.charCodeAt(h+3)],c[u++]=e<<2|n>>4,c[u++]=(15&n)<<4|r>>2,c[u++]=(3&r)<<6|63&s;return l}},function(t,e,n){var i=n(123),r=n(0),s=n(59),o=new r({Extends:i,initialize:function(t,e,n){void 0===n&&(n={}),this.audioBuffer=t.game.cache.audio.get(e),this.audioBuffer?(this.source=null,this.loopSource=null,this.muteNode=t.context.createGain(),this.volumeNode=t.context.createGain(),this.playTime=0,this.startTime=0,this.loopTime=0,this.rateUpdates=[],this.hasEnded=!1,this.hasLooped=!1,this.muteNode.connect(this.volumeNode),this.volumeNode.connect(t.destination),this.duration=this.audioBuffer.duration,this.totalDuration=this.audioBuffer.duration,i.call(this,t,e,n)):console.warn("Audio cache entry missing: "+e)},play:function(t,e){return!!i.prototype.play.call(this,t,e)&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource(),this.emit(s.PLAY,this),!0)},pause:function(){return!(this.manager.context.currentTime<this.startTime||!i.prototype.pause.call(this)||(this.currentConfig.seek=this.getCurrentTime(),this.stopAndRemoveBufferSource(),this.emit(s.PAUSE,this),0))},resume:function(){return!(this.manager.context.currentTime<this.startTime||!i.prototype.resume.call(this)||(this.createAndStartBufferSource(),this.emit(s.RESUME,this),0))},stop:function(){return!!i.prototype.stop.call(this)&&(this.stopAndRemoveBufferSource(),this.emit(s.STOP,this),!0)},createAndStartBufferSource:function(){var t=this.currentConfig.seek,e=this.manager.context.currentTime+this.currentConfig.delay,n=(this.currentMarker?this.currentMarker.start:0)+t,i=this.duration-t;this.playTime=e-t,this.startTime=e,this.source=this.createBufferSource(),this.applyConfig(),this.source.start(Math.max(0,e),Math.max(0,n),Math.max(0,i)),this.resetConfig()},createAndStartLoopBufferSource:function(){var t=this.getLoopTime(),e=this.currentMarker?this.currentMarker.start:0,n=this.duration;this.loopTime=t,this.loopSource=this.createBufferSource(),this.loopSource.playbackRate.setValueAtTime(this.totalRate,0),this.loopSource.start(Math.max(0,t),Math.max(0,e),Math.max(0,n))},createBufferSource:function(){var t=this,e=this.manager.context.createBufferSource();return e.buffer=this.audioBuffer,e.connect(this.muteNode),e.onended=function(e){e.target===t.source&&(t.currentConfig.loop?t.hasLooped=!0:t.hasEnded=!0)},e},stopAndRemoveBufferSource:function(){this.source&&(this.source.stop(),this.source.disconnect(),this.source=null),this.playTime=0,this.startTime=0,this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){this.loopSource&&(this.loopSource.stop(),this.loopSource.disconnect(),this.loopSource=null),this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:1}),i.prototype.applyConfig.call(this)},update:function(t,e){this.hasEnded?(this.hasEnded=!1,i.prototype.stop.call(this),this.stopAndRemoveBufferSource(),this.emit(s.COMPLETE,this)):this.hasLooped&&(this.hasLooped=!1,this.source=this.loopSource,this.loopSource=null,this.playTime=this.startTime=this.loopTime,this.rateUpdates.length=0,this.rateUpdates.push({time:0,rate:this.totalRate}),this.createAndStartLoopBufferSource(),this.emit(s.LOOPED,this))},destroy:function(){i.prototype.destroy.call(this),this.audioBuffer=null,this.stopAndRemoveBufferSource(),this.muteNode.disconnect(),this.muteNode=null,this.volumeNode.disconnect(),this.volumeNode=null,this.rateUpdates.length=0,this.rateUpdates=null},calculateRate:function(){i.prototype.calculateRate.call(this);var t=this.manager.context.currentTime;this.source&&"number"==typeof this.totalRate&&this.source.playbackRate.setValueAtTime(this.totalRate,t),this.isPlaying&&(this.rateUpdates.push({time:Math.max(this.startTime,t)-this.playTime,rate:this.totalRate}),this.loopSource&&(this.stopAndRemoveLoopBufferSource(),this.createAndStartLoopBufferSource()))},getCurrentTime:function(){for(var t=0,e=0;e<this.rateUpdates.length;e++)t+=((e<this.rateUpdates.length-1?this.rateUpdates[e+1].time:this.manager.context.currentTime-this.playTime)-this.rateUpdates[e].time)*this.rateUpdates[e].rate;return t},getLoopTime:function(){for(var t=0,e=0;e<this.rateUpdates.length-1;e++)t+=(this.rateUpdates[e+1].time-this.rateUpdates[e].time)*this.rateUpdates[e].rate;var n=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+n.time+(this.duration-t)/n.rate},rate:{get:function(){return this.currentConfig.rate},set:function(t){this.currentConfig.rate=t,this.calculateRate(),this.emit(s.RATE,this,t)}},setRate:function(t){return this.rate=t,this},detune:{get:function(){return this.currentConfig.detune},set:function(t){this.currentConfig.detune=t,this.calculateRate(),this.emit(s.DETUNE,this,t)}},setDetune:function(t){return this.detune=t,this},mute:{get:function(){return 0===this.muteNode.gain.value},set:function(t){this.currentConfig.mute=t,this.muteNode.gain.setValueAtTime(t?0:1,0),this.emit(s.MUTE,this,t)}},setMute:function(t){return this.mute=t,this},volume:{get:function(){return this.volumeNode.gain.value},set:function(t){this.currentConfig.volume=t,this.volumeNode.gain.setValueAtTime(t,0),this.emit(s.VOLUME,this,t)}},setVolume:function(t){return this.volume=t,this},seek:{get:function(){return this.isPlaying?this.manager.context.currentTime<this.startTime?this.startTime-this.playTime:this.getCurrentTime():this.isPaused?this.currentConfig.seek:0},set:function(t){this.manager.context.currentTime<this.startTime||(this.isPlaying||this.isPaused)&&(t=Math.min(Math.max(0,t),this.duration),this.currentConfig.seek=t,this.isPlaying&&(this.stopAndRemoveBufferSource(),this.createAndStartBufferSource()),this.emit(s.SEEK,this,t))}},setSeek:function(t){return this.seek=t,this},loop:{get:function(){return this.currentConfig.loop},set:function(t){this.currentConfig.loop=t,this.isPlaying&&(this.stopAndRemoveLoopBufferSource(),t&&this.createAndStartLoopBufferSource()),this.emit(s.LOOP,this,t)}},setLoop:function(t){return this.loop=t,this}});t.exports=o},function(t,e){t.exports=function(t){for(var e=t.length,n=t[0].length,i=new Array(n),r=0;r<n;r++){i[r]=new Array(e);for(var s=e-1;s>-1;s--)i[r][s]=t[s][r]}return i}},function(t,e){function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e){return t<e?-1:t>e?1:0}var r=function(t,e,s,o,a){for(void 0===s&&(s=0),void 0===o&&(o=t.length-1),void 0===a&&(a=i);o>s;){if(o-s>600){var u=o-s+1,l=e-s+1,c=Math.log(u),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(u-h)/u)*(l-u/2<0?-1:1),f=Math.max(s,Math.floor(e-l*h/u+d)),p=Math.min(o,Math.floor(e+(u-l)*h/u+d));r(t,e,f,p,a)}var m=t[e],g=s,y=o;for(n(t,s,e),a(t[o],m)>0&&n(t,s,o);g<y;){for(n(t,g,y),g++,y--;a(t[g],m)<0;)g++;for(;a(t[y],m)>0;)y--}0===a(t[s],m)?n(t,s,y):n(t,++y,o),y<=e&&(s=y+1),e<=y&&(o=y-1)}};t.exports=r},function(t,e,n){var i=n(6),r=n(112),s=function(t,e,n){for(var i=[],r=0;r<t.length;r++)for(var s=0;s<e.length;s++)for(var o=0;o<n;o++)i.push({a:t[r],b:e[s]});return i};t.exports=function(t,e,n){var o=i(n,"max",0),a=i(n,"qty",1),u=i(n,"random",!1),l=i(n,"randomB",!1),c=i(n,"repeat",0),h=i(n,"yoyo",!1),d=[];if(l&&r(e),-1===c)if(0===o)c=0;else{var f=t.length*e.length*a;h&&(f*=2),c=Math.ceil(o/f)}for(var p=0;p<=c;p++){var m=s(t,e,a);u&&r(m),d=d.concat(m),h&&(m.reverse(),d=d.concat(m))}return o&&d.splice(o),d}},function(t,e,n){var i=n(14);t.exports=function(t,e){var n=i(e,"anims",null);if(null===n)return t;if("string"==typeof n)t.anims.play(n);else if("object"==typeof n){var r=t.anims,s=i(n,"key",void 0),o=i(n,"startFrame",void 0),a=i(n,"delay",0),u=i(n,"repeat",0),l=i(n,"repeatDelay",0),c=i(n,"yoyo",!1),h=i(n,"play",!1),d=i(n,"delayedPlay",0);r.setDelay(a),r.setRepeat(u),r.setRepeatDelay(l),r.setYoyo(c),h?r.play(s,o):d>0?r.delayedPlay(d,s,o):r.load(s)}return t}},function(t,e,n){var i=n(11);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=Math.min(t.x,e.x),s=Math.min(t.y,e.y),o=Math.max(t.right,e.right)-r,a=Math.max(t.bottom,e.bottom)-s;return n.setTo(r,s,o,a)}},function(t,e,n){var i=n(0),r=n(12),s=n(934),o=n(13),a=n(7),u=n(175),l=n(314),c=new i({Extends:o,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Origin,r.ScrollFactor,r.Transform,r.Visible,s],initialize:function(t,e,n,i,r,s){o.call(this,t,"DOMElement"),this.parent=t.sys.game.domContainer,this.cache=t.sys.cache.html,this.transformOnly=!1,this.skewX=0,this.skewY=0,this.rotate3d=new l,this.rotate3dAngle="deg",this.width=0,this.height=0,this.displayWidth=0,this.displayHeight=0,this.handler=this.dispatchNativeEvent.bind(this),this.setPosition(e,n),"string"==typeof i?"#"===i[0]?this.setElement(i.substr(1),r,s):this.createElement(i,r,s):i&&this.setElement(i,r,s)},setSkew:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.skewX=t,this.skewY=e,this},setPerspective:function(t){return this.parent.style.perspective=t+"px",this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(t){this.parent.style.perspective=t+"px"}},addListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.addEventListener(t[e],this.handler,!1)}return this},removeListener:function(t){if(this.node){t=t.split(" ");for(var e=0;e<t.length;e++)this.node.removeEventListener(t[e],this.handler)}return this},dispatchNativeEvent:function(t){this.emit(t.type,t)},createElement:function(t,e,n){return this.setElement(document.createElement(t),e,n)},setElement:function(t,e,n){var i;if(this.removeElement(),"string"==typeof t?("#"===t[0]&&(t=t.substr(1)),i=document.getElementById(t)):"object"==typeof t&&1===t.nodeType&&(i=t),!i)return this;if(this.node=i,e&&a(e))for(var r in e)i.style[r]=e[r];else"string"==typeof e&&(i.style=e);return i.style.zIndex="0",i.style.display="inline",i.style.position="absolute",i.phaser=this,this.parent&&this.parent.appendChild(i),n&&(i.innerText=n),this.updateSize()},createFromCache:function(t,e){var n=this.cache.get(t);return n&&this.createFromHTML(n,e),this},createFromHTML:function(t,e){void 0===e&&(e="div"),this.removeElement();var n=document.createElement(e);return this.node=n,n.style.zIndex="0",n.style.display="inline",n.style.position="absolute",n.phaser=this,this.parent&&this.parent.appendChild(n),n.innerHTML=t,this.updateSize()},removeElement:function(){return this.node&&(u(this.node),this.node=null),this},updateSize:function(){var t=this.node,e=t.getBoundingClientRect();return this.width=t.clientWidth,this.height=t.clientHeight,this.displayWidth=e.width||0,this.displayHeight=e.height||0,this},getChildByProperty:function(t,e){if(this.node)for(var n=this.node.querySelectorAll("*"),i=0;i<n.length;i++)if(n[i][t]===e)return n[i];return null},getChildByID:function(t){return this.getChildByProperty("id",t)},getChildByName:function(t){return this.getChildByProperty("name",t)},setClassName:function(t){return this.node&&(this.node.className=t,this.updateSize()),this},setText:function(t){return this.node&&(this.node.innerText=t,this.updateSize()),this},setHTML:function(t){return this.node&&(this.node.innerHTML=t,this.updateSize()),this},preUpdate:function(){var t=this.parentContainer,e=this.node;e&&t&&!t.willRender()&&(e.style.display="none")},willRender:function(){return!0},preDestroy:function(){this.removeElement()}});t.exports=c},function(t,e,n){var i=n(935),r=n(13);t.exports=function(t,e,n,s,o){var a=e.node,u=a.style;if(!a||!u||r.RENDER_MASK!==e.renderFlags||0!==e.cameraFilter&&e.cameraFilter&s.id||e.parentContainer&&!e.parentContainer.willRender())a&&(u.display="none");else{var l=e.parentContainer,c=s.alpha*e.alpha;l&&(c*=l.alpha);var h=t._tempMatrix1,d=t._tempMatrix2,f=t._tempMatrix3,p=0,m=0,g="0%",y="0%";o?(d.applyITRS(e.x-(p=e.width*e.scaleX*e.originX),e.y-(m=e.height*e.scaleY*e.originY),e.rotation,e.scaleX,e.scaleY),h.copyFrom(s.matrix),h.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),d.e=e.x-p,d.f=e.y-m,h.multiply(d,f)):(d.applyITRS(e.x-(p=e.width*e.originX),e.y-(m=e.height*e.originY),e.rotation,e.scaleX,e.scaleY),h.copyFrom(s.matrix),g=100*e.originX+"%",y=100*e.originY+"%",d.e-=s.scrollX*e.scrollFactorX,d.f-=s.scrollY*e.scrollFactorY,h.multiply(d,f)),e.transformOnly||(u.display="block",u.opacity=c,u.zIndex=e._depth,u.pointerEvents="auto",u.mixBlendMode=i[e._blendMode]),u.transform=f.getCSSMatrix()+" skew("+e.skewX+"rad, "+e.skewY+"rad) rotate3d("+e.rotate3d.x+","+e.rotate3d.y+","+e.rotate3d.z+","+e.rotate3d.w+e.rotate3dAngle+")",u.transformOrigin=g+" "+y}}},function(t,e,n){var i=n(0),r=n(12),s=n(13),o=n(939),a=new i({Extends:s,Mixins:[r.Alpha,r.BlendMode,r.Depth,r.Flip,r.Origin,r.ScrollFactor,r.Size,r.Texture,r.Tint,r.Transform,r.Visible,o],initialize:function(t){s.call(this,t,"Extern")},preUpdate:function(){},render:function(){}});t.exports=a},function(t,e,n){var i=n(190),r=n(87),s=n(23),o=n(4);t.exports=function(t,e,n){void 0===n&&(n=new o);var a=r(e,0,s.PI2);return i(t,a,n)}},function(t,e,n){var i=n(376),r=n(190),s=n(87),o=n(23);t.exports=function(t,e,n,a){void 0===a&&(a=[]),e||(e=i(t)/n);for(var u=0;u<e;u++){var l=s(u/e,0,o.PI2);a.push(r(t,l))}return a}},function(t,e){t.exports=function(t){var e=t.width/2,n=t.height/2,i=Math.pow(e-n,2)/Math.pow(e+n,2);return Math.PI*(e+n)*(1+3*i/(10+Math.sqrt(4-3*i)))}},function(t,e,n){var i=n(189),r=n(26);t.exports=function(t,e,n,s,o,a,u){var l=e.commandBuffer,c=l.length,h=a||t.currentContext;if(0!==c&&r(t,h,e,s,o)){var d=0,f=0,p=1;h.beginPath();for(var m=0;m<c;++m)switch(l[m]){case i.ARC:h.arc(l[m+1],l[m+2],l[m+3],l[m+4],l[m+5],l[m+6]),m+=7;break;case i.LINE_STYLE:p=l[m+1],h.strokeStyle="rgba("+((16711680&(d=l[m+2]))>>>16)+","+((65280&d)>>>8)+","+(255&d)+","+l[m+3]+")",h.lineWidth=p,m+=3;break;case i.FILL_STYLE:h.fillStyle="rgba("+((16711680&(f=l[m+1]))>>>16)+","+((65280&f)>>>8)+","+(255&f)+","+l[m+2]+")",m+=2;break;case i.BEGIN_PATH:h.beginPath();break;case i.CLOSE_PATH:h.closePath();break;case i.FILL_PATH:u||h.fill();break;case i.STROKE_PATH:u||h.stroke();break;case i.FILL_RECT:u?h.rect(l[m+1],l[m+2],l[m+3],l[m+4]):h.fillRect(l[m+1],l[m+2],l[m+3],l[m+4]),m+=4;break;case i.FILL_TRIANGLE:h.beginPath(),h.moveTo(l[m+1],l[m+2]),h.lineTo(l[m+3],l[m+4]),h.lineTo(l[m+5],l[m+6]),h.closePath(),u||h.fill(),m+=6;break;case i.STROKE_TRIANGLE:h.beginPath(),h.moveTo(l[m+1],l[m+2]),h.lineTo(l[m+3],l[m+4]),h.lineTo(l[m+5],l[m+6]),h.closePath(),u||h.stroke(),m+=6;break;case i.LINE_TO:h.lineTo(l[m+1],l[m+2]),m+=2;break;case i.MOVE_TO:h.moveTo(l[m+1],l[m+2]),m+=2;break;case i.LINE_FX_TO:h.lineTo(l[m+1],l[m+2]),m+=5;break;case i.MOVE_FX_TO:h.moveTo(l[m+1],l[m+2]),m+=5;break;case i.SAVE:h.save();break;case i.RESTORE:h.restore();break;case i.TRANSLATE:h.translate(l[m+1],l[m+2]),m+=2;break;case i.SCALE:h.scale(l[m+1],l[m+2]),m+=2;break;case i.ROTATE:h.rotate(l[m+1]),m+=1;break;case i.GRADIENT_FILL_STYLE:m+=5;break;case i.GRADIENT_LINE_STYLE:m+=6;break;case i.SET_TEXTURE:m+=2}h.restore()}}},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t,e,n,i,s){if("object"==typeof t){var o=t;t=r(o,"x",0),e=r(o,"y",0),n=r(o,"power",0),i=r(o,"epsilon",100),s=r(o,"gravity",50)}else void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=100),void 0===s&&(s=50);this.x=t,this.y=e,this.active=!0,this._gravity=s,this._power=0,this._epsilon=0,this.power=n,this.epsilon=i},update:function(t,e){var n=this.x-t.x,i=this.y-t.y,r=n*n+i*i;if(0!==r){var s=Math.sqrt(r);r<this._epsilon&&(r=this._epsilon);var o=this._power*e/(r*s)*100;t.velocityX+=n*o,t.velocityY+=i*o}},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(t){this._epsilon=t*t}},power:{get:function(){return this._power/this._gravity},set:function(t){this._power=t*this._gravity}},gravity:{get:function(){return this._gravity},set:function(t){var e=this.power;this._gravity=t,this.power=e}}});t.exports=s},function(t,e,n){var i=n(0),r=n(35),s=n(58),o=new i({initialize:function(t){this.emitter=t,this.frame=null,this.x=0,this.y=0,this.velocityX=0,this.velocityY=0,this.accelerationX=0,this.accelerationY=0,this.maxVelocityX=1e4,this.maxVelocityY=1e4,this.bounce=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.angle=0,this.rotation=0,this.tint=16777215,this.life=1e3,this.lifeCurrent=1e3,this.delayCurrent=0,this.lifeT=0,this.data={tint:{min:16777215,max:16777215,current:16777215},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1}}},isAlive:function(){return this.lifeCurrent>0},resetPosition:function(){this.x=0,this.y=0},fire:function(t,e){var n=this.emitter;this.frame=n.getFrame(),n.emitZone&&n.emitZone.getPoint(this),void 0===t?(n.follow&&(this.x+=n.follow.x+n.followOffset.x),this.x+=n.x.onEmit(this,"x")):this.x+=t,void 0===e?(n.follow&&(this.y+=n.follow.y+n.followOffset.y),this.y+=n.y.onEmit(this,"y")):this.y+=e,this.life=n.lifespan.onEmit(this,"lifespan"),this.lifeCurrent=this.life,this.lifeT=0;var i=n.speedX.onEmit(this,"speedX"),o=n.speedY?n.speedY.onEmit(this,"speedY"):i;if(n.radial){var a=r(n.angle.onEmit(this,"angle"));this.velocityX=Math.cos(a)*Math.abs(i),this.velocityY=Math.sin(a)*Math.abs(o)}else if(n.moveTo){var u=n.moveToX.onEmit(this,"moveToX"),l=n.moveToY?n.moveToY.onEmit(this,"moveToY"):u,c=Math.atan2(l-this.y,u-this.x),h=s(this.x,this.y,u,l)/(this.life/1e3);this.velocityX=Math.cos(c)*h,this.velocityY=Math.sin(c)*h}else this.velocityX=i,this.velocityY=o;n.acceleration&&(this.accelerationX=n.accelerationX.onEmit(this,"accelerationX"),this.accelerationY=n.accelerationY.onEmit(this,"accelerationY")),this.maxVelocityX=n.maxVelocityX.onEmit(this,"maxVelocityX"),this.maxVelocityY=n.maxVelocityY.onEmit(this,"maxVelocityY"),this.delayCurrent=n.delay.onEmit(this,"delay"),this.scaleX=n.scaleX.onEmit(this,"scaleX"),this.scaleY=n.scaleY?n.scaleY.onEmit(this,"scaleY"):this.scaleX,this.angle=n.rotate.onEmit(this,"rotate"),this.rotation=r(this.angle),this.bounce=n.bounce.onEmit(this,"bounce"),this.alpha=n.alpha.onEmit(this,"alpha"),this.tint=n.tint.onEmit(this,"tint")},computeVelocity:function(t,e,n,i){var r=this.velocityX,s=this.velocityY,o=this.accelerationX,a=this.accelerationY,u=this.maxVelocityX,l=this.maxVelocityY;r+=t.gravityX*n,s+=t.gravityY*n,o&&(r+=o*n),a&&(s+=a*n),r>u?r=u:r<-u&&(r=-u),s>l?s=l:s<-l&&(s=-l),this.velocityX=r,this.velocityY=s;for(var c=0;c<i.length;c++)i[c].update(this,e,n)},checkBounds:function(t){var e=t.bounds,n=-this.bounce;this.x<e.x&&t.collideLeft?(this.x=e.x,this.velocityX*=n):this.x>e.right&&t.collideRight&&(this.x=e.right,this.velocityX*=n),this.y<e.y&&t.collideTop?(this.y=e.y,this.velocityY*=n):this.y>e.bottom&&t.collideBottom&&(this.y=e.bottom,this.velocityY*=n)},update:function(t,e,n){if(this.delayCurrent>0)return this.delayCurrent-=t,!1;var i=this.emitter,s=1-this.lifeCurrent/this.life;return this.lifeT=s,this.computeVelocity(i,t,e,n),this.x+=this.velocityX*e,this.y+=this.velocityY*e,i.bounds&&this.checkBounds(i),i.deathZone&&i.deathZone.willKill(this)?(this.lifeCurrent=0,!0):(this.scaleX=i.scaleX.onUpdate(this,"scaleX",s,this.scaleX),this.scaleY=i.scaleY?i.scaleY.onUpdate(this,"scaleY",s,this.scaleY):this.scaleX,this.angle=i.rotate.onUpdate(this,"rotate",s,this.angle),this.rotation=r(this.angle),this.alpha=i.alpha.onUpdate(this,"alpha",s,this.alpha),this.tint=i.tint.onUpdate(this,"tint",s,this.tint),this.lifeCurrent-=t,this.lifeCurrent<=0)}});t.exports=o},function(t,e,n){var i=n(52),r=n(0),s=n(12),o=n(381),a=n(382),u=n(951),l=n(2),c=n(182),h=n(383),d=n(99),f=n(379),p=n(384),m=n(11),g=n(126),y=n(3),v=n(57),b=new r({Mixins:[s.BlendMode,s.Mask,s.ScrollFactor,s.Visible],initialize:function(t,e){this.manager=t,this.texture=t.texture,this.frames=[t.defaultFrame],this.defaultFrame=t.defaultFrame,this.configFastMap=["active","blendMode","collideBottom","collideLeft","collideRight","collideTop","deathCallback","deathCallbackScope","emitCallback","emitCallbackScope","follow","frequency","gravityX","gravityY","maxParticles","name","on","particleBringToTop","particleClass","radial","timeScale","trackVisible","visible"],this.configOpMap=["accelerationX","accelerationY","angle","alpha","bounce","delay","lifespan","maxVelocityX","maxVelocityY","moveToX","moveToY","quantity","rotate","scaleX","scaleY","speedX","speedY","tint","x","y"],this.name="",this.particleClass=f,this.x=new u(e,"x",0,!0),this.y=new u(e,"y",0,!0),this.radial=!0,this.gravityX=0,this.gravityY=0,this.acceleration=!1,this.accelerationX=new u(e,"accelerationX",0,!0),this.accelerationY=new u(e,"accelerationY",0,!0),this.maxVelocityX=new u(e,"maxVelocityX",1e4,!0),this.maxVelocityY=new u(e,"maxVelocityY",1e4,!0),this.speedX=new u(e,"speedX",0,!0),this.speedY=new u(e,"speedY",0,!0),this.moveTo=!1,this.moveToX=new u(e,"moveToX",0,!0),this.moveToY=new u(e,"moveToY",0,!0),this.bounce=new u(e,"bounce",0,!0),this.scaleX=new u(e,"scaleX",1),this.scaleY=new u(e,"scaleY",1),this.tint=new u(e,"tint",4294967295),this.alpha=new u(e,"alpha",1),this.lifespan=new u(e,"lifespan",1e3,!0),this.angle=new u(e,"angle",{min:0,max:360},!0),this.rotate=new u(e,"rotate",0),this.emitCallback=null,this.emitCallbackScope=null,this.deathCallback=null,this.deathCallbackScope=null,this.maxParticles=0,this.quantity=new u(e,"quantity",1,!0),this.delay=new u(e,"delay",0,!0),this.frequency=0,this.on=!0,this.particleBringToTop=!0,this.timeScale=1,this.emitZone=null,this.deathZone=null,this.bounds=null,this.collideLeft=!0,this.collideRight=!0,this.collideTop=!0,this.collideBottom=!0,this.active=!0,this.visible=!0,this.blendMode=i.NORMAL,this.follow=null,this.followOffset=new y,this.trackVisible=!1,this.currentFrame=0,this.randomFrame=!0,this.frameQuantity=1,this.dead=[],this.alive=[],this._counter=0,this._frameCounter=0,e&&this.fromJSON(e)},fromJSON:function(t){if(!t)return this;var e=0,n="";for(e=0;e<this.configFastMap.length;e++)d(t,n=this.configFastMap[e])&&(this[n]=l(t,n));for(e=0;e<this.configOpMap.length;e++)d(t,n=this.configOpMap[e])&&this[n].loadConfig(t);if(this.acceleration=0!==this.accelerationX.propertyValue||0!==this.accelerationY.propertyValue,this.moveTo=0!==this.moveToX.propertyValue||0!==this.moveToY.propertyValue,d(t,"speed")&&(this.speedX.loadConfig(t,"speed"),this.speedY=null),(h(t,["speedX","speedY"])||this.moveTo)&&(this.radial=!1),d(t,"scale")&&(this.scaleX.loadConfig(t,"scale"),this.scaleY=null),d(t,"callbackScope")){var i=l(t,"callbackScope",null);this.emitCallbackScope=i,this.deathCallbackScope=i}return d(t,"emitZone")&&this.setEmitZone(t.emitZone),d(t,"deathZone")&&this.setDeathZone(t.deathZone),d(t,"bounds")&&this.setBounds(t.bounds),d(t,"followOffset")&&this.followOffset.setFromObject(l(t,"followOffset",0)),d(t,"frame")&&this.setFrame(t.frame),this},toJSON:function(t){void 0===t&&(t={});var e=0,n="";for(e=0;e<this.configFastMap.length;e++)t[n=this.configFastMap[e]]=this[n];for(e=0;e<this.configOpMap.length;e++)this[n=this.configOpMap[e]]&&(t[n]=this[n].toJSON());return this.speedY||(delete t.speedX,t.speed=this.speedX.toJSON()),this.scaleY||(delete t.scaleX,t.scale=this.scaleX.toJSON()),t},startFollow:function(t,e,n,i){return void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=!1),this.follow=t,this.followOffset.set(e,n),this.trackVisible=i,this},stopFollow:function(){return this.follow=null,this.followOffset.set(0,0),this.trackVisible=!1,this},getFrame:function(){if(1===this.frames.length)return this.defaultFrame;if(this.randomFrame)return c(this.frames);var t=this.frames[this.currentFrame];return this._frameCounter++,this._frameCounter===this.frameQuantity&&(this._frameCounter=0,this.currentFrame=v(this.currentFrame+1,0,this._frameLength)),t},setFrame:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=1),this.randomFrame=e,this.frameQuantity=n,this.currentFrame=0,this._frameCounter=0;var i=typeof t;if(Array.isArray(t)||"string"===i||"number"===i)this.manager.setEmitterFrames(t,this);else if("object"===i){var r=t;(t=l(r,"frames",null))&&this.manager.setEmitterFrames(t,this);var s=l(r,"cycle",!1);this.randomFrame=!s,this.frameQuantity=l(r,"quantity",n)}return this._frameLength=this.frames.length,1===this._frameLength&&(this.frameQuantity=1,this.randomFrame=!1),this},setRadial:function(t){return void 0===t&&(t=!0),this.radial=t,this},setPosition:function(t,e){return this.x.onChange(t),this.y.onChange(e),this},setBounds:function(t,e,n,i){if("object"==typeof t){var r=t;t=r.x,e=r.y,n=d(r,"w")?r.w:r.width,i=d(r,"h")?r.h:r.height}return this.bounds?this.bounds.setTo(t,e,n,i):this.bounds=new m(t,e,n,i),this},setSpeedX:function(t){return this.speedX.onChange(t),this.radial=!1,this},setSpeedY:function(t){return this.speedY&&(this.speedY.onChange(t),this.radial=!1),this},setSpeed:function(t){return this.speedX.onChange(t),this.speedY=null,this.radial=!0,this},setScaleX:function(t){return this.scaleX.onChange(t),this},setScaleY:function(t){return this.scaleY.onChange(t),this},setScale:function(t){return this.scaleX.onChange(t),this.scaleY=null,this},setGravityX:function(t){return this.gravityX=t,this},setGravityY:function(t){return this.gravityY=t,this},setGravity:function(t,e){return this.gravityX=t,this.gravityY=e,this},setAlpha:function(t){return this.alpha.onChange(t),this},setEmitterAngle:function(t){return this.angle.onChange(t),this},setAngle:function(t){return this.angle.onChange(t),this},setLifespan:function(t){return this.lifespan.onChange(t),this},setQuantity:function(t){return this.quantity.onChange(t),this},setFrequency:function(t,e){return this.frequency=t,this._counter=0,e&&this.quantity.onChange(e),this},setEmitZone:function(t){if(void 0===t)this.emitZone=null;else{var e=l(t,"type","random"),n=l(t,"source",null);switch(e){case"random":this.emitZone=new p(n);break;case"edge":var i=l(t,"quantity",1),r=l(t,"stepRate",0),s=l(t,"yoyo",!1),o=l(t,"seamless",!0);this.emitZone=new a(n,i,r,s,o)}}return this},setDeathZone:function(t){if(void 0===t)this.deathZone=null;else{var e=l(t,"type","onEnter"),n=l(t,"source",null);n&&"function"==typeof n.contains&&(this.deathZone=new o(n,"onEnter"===e))}return this},reserve:function(t){for(var e=this.dead,n=0;n<t;n++)e.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return this.maxParticles>0&&this.getParticleCount()===this.maxParticles},onParticleEmit:function(t,e){return void 0===t?(this.emitCallback=null,this.emitCallbackScope=null):"function"==typeof t&&(this.emitCallback=t,e&&(this.emitCallbackScope=e)),this},onParticleDeath:function(t,e){return void 0===t?(this.deathCallback=null,this.deathCallbackScope=null):"function"==typeof t&&(this.deathCallback=t,e&&(this.deathCallbackScope=e)),this},killAll:function(){for(var t=this.dead,e=this.alive;e.length>0;)t.push(e.pop());return this},forEachAlive:function(t,e){for(var n=this.alive,i=n.length,r=0;r<i;++r)t.call(e,n[r],this);return this},forEachDead:function(t,e){for(var n=this.dead,i=n.length,r=0;r<i;++r)t.call(e,n[r],this);return this},start:function(){return this.on=!0,this._counter=0,this},stop:function(){return this.on=!1,this},pause:function(){return this.active=!1,this},resume:function(){return this.active=!0,this},depthSort:function(){return g.inplace(this.alive,this.depthSortCallback),this},flow:function(t,e){return void 0===e&&(e=1),this.frequency=t,this.quantity.onChange(e),this.start()},explode:function(t,e,n){return this.frequency=-1,this.emitParticle(t,e,n)},emitParticleAt:function(t,e,n){return this.emitParticle(n,t,e)},emitParticle:function(t,e,n){if(!this.atLimit()){void 0===t&&(t=this.quantity.onEmit());for(var i=this.dead,r=0;r<t;r++){var s=i.pop();if(s||(s=new this.particleClass(this)),s.fire(e,n),this.particleBringToTop?this.alive.push(s):this.alive.unshift(s),this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,s,this),this.atLimit())break}return s}},preUpdate:function(t,e){var n=(e*=this.timeScale)/1e3;this.trackVisible&&(this.visible=this.follow.visible);var i=this.manager.getProcessors(),r=this.alive,s=this.dead,o=0,a=[],u=r.length;for(o=0;o<u;o++){var l=r[o];l.update(e,n,i)&&a.push({index:o,particle:l})}if((u=a.length)>0){var c=this.deathCallback,h=this.deathCallbackScope;for(o=u-1;o>=0;o--){var d=a[o];r.splice(d.index,1),s.push(d.particle),c&&c.call(h,d.particle),d.particle.resetPosition()}}this.on&&(0===this.frequency?this.emitParticle():this.frequency>0&&(this._counter-=e,this._counter<=0&&(this.emitParticle(),this._counter=this.frequency-Math.abs(this._counter))))},depthSortCallback:function(t,e){return t.y-e.y}});t.exports=b},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.source=t,this.killOnEnter=e},willKill:function(t){var e=this.source.contains(t.x,t.y);return e&&this.killOnEnter||!e&&!this.killOnEnter}});t.exports=i},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r){void 0===i&&(i=!1),void 0===r&&(r=!0),this.source=t,this.points=[],this.quantity=e,this.stepRate=n,this.yoyo=i,this.counter=-1,this.seamless=r,this._length=0,this._direction=0,this.updateSource()},updateSource:function(){if(this.points=this.source.getPoints(this.quantity,this.stepRate),this.seamless){var t=this.points[0],e=this.points[this.points.length-1];t.x===e.x&&t.y===e.y&&this.points.pop()}var n=this._length;return this._length=this.points.length,this._length<n&&this.counter>this._length&&(this.counter=this._length-1),this},changeSource:function(t){return this.source=t,this.updateSource()},getPoint:function(t){0===this._direction?(this.counter++,this.counter>=this._length&&(this.yoyo?(this._direction=1,this.counter=this._length-1):this.counter=0)):(this.counter--,-1===this.counter&&(this.yoyo?(this._direction=0,this.counter=0):this.counter=this._length-1));var e=this.points[this.counter];e&&(t.x=e.x,t.y=e.y)}});t.exports=i},function(t,e){t.exports=function(t,e){for(var n=0;n<e.length;n++)if(t.hasOwnProperty(e[n]))return!0;return!1}},function(t,e,n){var i=n(0),r=n(3),s=new i({initialize:function(t){this.source=t,this._tempVec=new r},getPoint:function(t){var e=this._tempVec;this.source.getRandomPoint(e),t.x=e.x,t.y=e.y}});t.exports=s},function(t,e,n){var i=n(0),r=n(12),s=n(68),o=new i({Extends:s,Mixins:[r.PathFollower],initialize:function(t,e,n,i,r,o){s.call(this,t,n,i,r,o),this.path=e},preUpdate:function(t,e){this.anims.update(t,e),this.pathUpdate(t)}});t.exports=o},function(t,e,n){var i=n(974),r=n(0),s=n(35),o=n(65),a=n(78),u=n(23),l=n(30),c=new r({Extends:l,Mixins:[i],initialize:function(t,e,n,i,r,s,o,u,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=0),void 0===s&&(s=360),void 0===o&&(o=!1),l.call(this,t,"Arc",new a(0,0,i)),this._startAngle=r,this._endAngle=s,this._anticlockwise=o,this._iterations=.01,this.setPosition(e,n);var h=2*this.geom.radius;this.setSize(h,h),void 0!==u&&this.setFillStyle(u,c),this.updateDisplayOrigin(),this.updateData()},iterations:{get:function(){return this._iterations},set:function(t){this._iterations=t,this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(t){this.geom.radius=t;var e=2*t;this.setSize(e,e),this.updateDisplayOrigin(),this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(t){this._startAngle=t,this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(t){this._endAngle=t,this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(t){this._anticlockwise=t,this.updateData()}},setRadius:function(t){return this.radius=t,this},setIterations:function(t){return void 0===t&&(t=.01),this.iterations=t,this},setStartAngle:function(t,e){return this._startAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},setEndAngle:function(t,e){return this._endAngle=t,void 0!==e&&(this._anticlockwise=e),this.updateData()},updateData:function(){var t=this._iterations,e=t,n=this.geom.radius,i=s(this._startAngle),r=s(this._endAngle),a=n,l=n;r-=i,this._anticlockwise?r<-u.PI2?r=-u.PI2:r>0&&(r=r%u.PI2-u.PI2):r>u.PI2?r=u.PI2:r<0&&(r=u.PI2+r%u.PI2);for(var c,h=[a+Math.cos(i)*n,l+Math.sin(i)*n];e<1;)c=r*e+i,h.push(a+Math.cos(c)*n,l+Math.sin(c)*n),e+=t;return c=r+i,h.push(a+Math.cos(c)*n,l+Math.sin(c)*n),h.push(a+Math.cos(i)*n,l+Math.sin(i)*n),this.pathIndexes=o(h),this.pathData=h,this}});t.exports=c},function(t,e,n){var i=n(0),r=n(977),s=n(65),o=n(11),a=n(30),u=new i({Extends:a,Mixins:[r],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),a.call(this,t,"Curve",i),this._smoothness=32,this._curveBounds=new o,this.closePath=!1,this.setPosition(e,n),void 0!==r&&this.setFillStyle(r,s),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){var t=this._curveBounds,e=this._smoothness;this.geom.getBounds(t,e),this.setSize(t.width,t.height),this.updateDisplayOrigin();for(var n=[],i=this.geom.getPoints(e),r=0;r<i.length;r++)n.push(i[r].x,i[r].y);return n.push(i[0].x,i[0].y),this.pathIndexes=s(n),this.pathData=n,this}});t.exports=u},function(t,e,n){var i=n(0),r=n(65),s=n(980),o=n(95),a=n(30),u=new i({Extends:a,Mixins:[s],initialize:function(t,e,n,i,r,s,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===r&&(r=128),a.call(this,t,"Ellipse",new o(i/2,r/2,i,r)),this._smoothness=64,this.setPosition(e,n),this.width=i,this.height=r,void 0!==s&&this.setFillStyle(s,u),this.updateDisplayOrigin(),this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(t){this._smoothness=t,this.updateData()}},setSize:function(t,e){return this.geom.setSize(t,e),this.updateData()},setSmoothness:function(t){return this._smoothness=t,this.updateData()},updateData:function(){for(var t=[],e=this.geom.getPoints(this._smoothness),n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=r(t),this.pathData=t,this}});t.exports=u},function(t,e,n){var i=n(0),r=n(30),s=n(983),o=new i({Extends:r,Mixins:[s],initialize:function(t,e,n,i,s,o,a,u,l,c,h){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===s&&(s=128),void 0===o&&(o=32),void 0===a&&(a=32),r.call(this,t,"Grid",null),this.cellWidth=o,this.cellHeight=a,this.showCells=!0,this.outlineFillColor=0,this.outlineFillAlpha=0,this.showOutline=!0,this.showAltCells=!1,this.setPosition(e,n),this.setSize(i,s),void 0!==u&&this.setFillStyle(u,l),void 0!==c&&this.setOutlineStyle(c,h),this.updateDisplayOrigin()},setFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showCells=!1:(this.fillColor=t,this.fillAlpha=e,this.showCells=!0),this},setAltFillStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showAltCells=!1:(this.altFillColor=t,this.altFillAlpha=e,this.showAltCells=!0),this},setOutlineStyle:function(t,e){return void 0===e&&(e=1),void 0===t?this.showOutline=!1:(this.outlineFillColor=t,this.outlineFillAlpha=e,this.showOutline=!0),this}});t.exports=o},function(t,e,n){var i=n(986),r=n(0),s=n(30),o=new r({Extends:s,Mixins:[i],initialize:function(t,e,n,i,r,o,a,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=15658734),void 0===a&&(a=10066329),void 0===u&&(u=13421772),s.call(this,t,"IsoBox",null),this.projection=4,this.fillTop=o,this.fillLeft=a,this.fillRight=u,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},function(t,e,n){var i=n(0),r=n(989),s=n(30),o=new i({Extends:s,Mixins:[r],initialize:function(t,e,n,i,r,o,a,u,l){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=48),void 0===r&&(r=32),void 0===o&&(o=!1),void 0===a&&(a=15658734),void 0===u&&(u=10066329),void 0===l&&(l=13421772),s.call(this,t,"IsoTriangle",null),this.projection=4,this.fillTop=a,this.fillLeft=u,this.fillRight=l,this.showTop=!0,this.showLeft=!0,this.showRight=!0,this.isReversed=o,this.isFilled=!0,this.setPosition(e,n),this.setSize(i,r),this.updateDisplayOrigin()},setProjection:function(t){return this.projection=t,this},setReversed:function(t){return this.isReversed=t,this},setFaces:function(t,e,n){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),this.showTop=t,this.showLeft=e,this.showRight=n,this},setFillStyle:function(t,e,n){return this.fillTop=t,this.fillLeft=e,this.fillRight=n,this.isFilled=!0,this}});t.exports=o},function(t,e,n){var i=n(0),r=n(30),s=n(55),o=n(992),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,u,l,c){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=128),void 0===u&&(u=0),r.call(this,t,"Line",new s(i,o,a,u));var h=this.geom.right-this.geom.left,d=this.geom.bottom-this.geom.top;this.lineWidth=1,this._startWidth=1,this._endWidth=1,this.setPosition(e,n),this.setSize(h,d),void 0!==l&&this.setStrokeStyle(1,l,c),this.updateDisplayOrigin()},setLineWidth:function(t,e){return void 0===e&&(e=t),this._startWidth=t,this._endWidth=e,this.lineWidth=t,this},setTo:function(t,e,n,i){return this.geom.setTo(t,e,n,i),this}});t.exports=a},function(t,e,n){var i=n(995),r=n(0),s=n(65),o=n(394),a=n(197),u=n(30),l=n(397),c=new r({Extends:u,Mixins:[i],initialize:function(t,e,n,i,r,s){void 0===e&&(e=0),void 0===n&&(n=0),u.call(this,t,"Polygon",new a(i));var l=o(this.geom);this.setPosition(e,n),this.setSize(l.width,l.height),void 0!==r&&this.setFillStyle(r,s),this.updateDisplayOrigin(),this.updateData()},smooth:function(t){void 0===t&&(t=1);for(var e=0;e<t;e++)l(this.geom);return this.updateData()},updateData:function(){for(var t=[],e=this.geom.points,n=0;n<e.length;n++)t.push(e[n].x,e[n].y);return t.push(e[0].x,e[0].y),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=c},function(t,e,n){var i=n(11);t.exports=function(t,e){void 0===e&&(e=new i);for(var n,r=1/0,s=1/0,o=-r,a=-s,u=0;u<t.points.length;u++)n=t.points[u],r=Math.min(r,n.x),s=Math.min(s,n.y),o=Math.max(o,n.x),a=Math.max(a,n.y);return e.x=r,e.y=s,e.width=o-r,e.height=a-s,e}},function(t,e,n){var i=n(56),r=n(55),s=n(396);t.exports=function(t,e,n,o){void 0===o&&(o=[]);var a=t.points,u=s(t);e||(e=u/n);for(var l=0;l<e;l++)for(var c=u*(l/e),h=0,d=0;d<a.length;d++){var f=a[d],p=a[(d+1)%a.length],m=new r(f.x,f.y,p.x,p.y),g=i(m);if(!(c<h||c>h+g)){var y=m.getPoint((c-h)/g);o.push(y);break}h+=g}return o}},function(t,e,n){var i=n(56),r=n(55);t.exports=function(t){for(var e=t.points,n=0,s=0;s<e.length;s++){var o=e[s],a=e[(s+1)%e.length],u=new r(o.x,o.y,a.x,a.y);n+=i(u)}return n}},function(t,e){var n=function(t,e){return t[0]=e[0],t[1]=e[1],t};t.exports=function(t){var e,i=[],r=t.points;for(e=0;e<r.length;e++)i.push([r[e].x,r[e].y]);var s=[];for(i.length>0&&s.push(n([0,0],i[0])),e=0;e<i.length-1;e++){var o=i[e],a=i[e+1],u=o[0],l=o[1],c=a[0],h=a[1];s.push([.85*u+.15*c,.85*l+.15*h]),s.push([.15*u+.85*c,.15*l+.85*h])}return i.length>1&&s.push(n([0,0],i[i.length-1])),t.setTo(s)}},function(t,e,n){var i=n(0),r=n(11),s=n(30),o=n(998),a=new i({Extends:s,Mixins:[o],initialize:function(t,e,n,i,o,a,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=128),void 0===o&&(o=128),s.call(this,t,"Rectangle",new r(0,0,i,o)),this.setPosition(e,n),this.setSize(i,o),void 0!==a&&this.setFillStyle(a,u),this.updateDisplayOrigin(),this.updateData()},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),e.getLineD(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(1001),r=n(0),s=n(65),o=n(30),a=new r({Extends:o,Mixins:[i],initialize:function(t,e,n,i,r,s,a,u){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=5),void 0===r&&(r=32),void 0===s&&(s=64),o.call(this,t,"Star",null),this._points=i,this._innerRadius=r,this._outerRadius=s,this.setPosition(e,n),this.setSize(2*s,2*s),void 0!==a&&this.setFillStyle(a,u),this.updateDisplayOrigin(),this.updateData()},setPoints:function(t){return this._points=t,this.updateData()},setInnerRadius:function(t){return this._innerRadius=t,this.updateData()},setOuterRadius:function(t){return this._outerRadius=t,this.updateData()},points:{get:function(){return this._points},set:function(t){this._points=t,this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this.updateData()}},updateData:function(){var t=[],e=this._points,n=this._innerRadius,i=this._outerRadius,r=Math.PI/2*3,o=Math.PI/e,a=i,u=i;t.push(a,u+-i);for(var l=0;l<e;l++)t.push(a+Math.cos(r)*i,u+Math.sin(r)*i),r+=o,t.push(a+Math.cos(r)*n,u+Math.sin(r)*n),r+=o;return t.push(a,u+-i),this.pathIndexes=s(t),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(0),r=n(30),s=n(70),o=n(1004),a=new i({Extends:r,Mixins:[o],initialize:function(t,e,n,i,o,a,u,l,c,h,d){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=128),void 0===a&&(a=64),void 0===u&&(u=0),void 0===l&&(l=128),void 0===c&&(c=128),r.call(this,t,"Triangle",new s(i,o,a,u,l,c));var f=this.geom.right-this.geom.left,p=this.geom.bottom-this.geom.top;this.setPosition(e,n),this.setSize(f,p),void 0!==h&&this.setFillStyle(h,d),this.updateDisplayOrigin(),this.updateData()},setTo:function(t,e,n,i,r,s){return this.geom.setTo(t,e,n,i,r,s),this.updateData()},updateData:function(){var t=[],e=this.geom,n=this._tempLine;return e.getLineA(n),t.push(n.x1,n.y1,n.x2,n.y2),e.getLineB(n),t.push(n.x2,n.y2),e.getLineC(n),t.push(n.x2,n.y2),this.pathData=t,this}});t.exports=a},function(t,e,n){var i=n(4),r=n(56);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();if(e<=0||e>=1)return n.x=s.x1,n.y=s.y1,n;var u=r(s),l=r(o),c=r(a),h=(u+l+c)*e,d=0;return h<u?(n.x=s.x1+(s.x2-s.x1)*(d=h/u),n.y=s.y1+(s.y2-s.y1)*d):h>u+l?(d=(h-=u+l)/c,n.x=a.x1+(a.x2-a.x1)*d,n.y=a.y1+(a.y2-a.y1)*d):(d=(h-=u)/l,n.x=o.x1+(o.x2-o.x1)*d,n.y=o.y1+(o.y2-o.y1)*d),n}},function(t,e,n){var i=n(56),r=n(4);t.exports=function(t,e,n,s){void 0===s&&(s=[]);var o=t.getLineA(),a=t.getLineB(),u=t.getLineC(),l=i(o),c=i(a),h=i(u),d=l+c+h;e||(e=d/n);for(var f=0;f<e;f++){var p=d*(f/e),m=0,g=new r;p<l?(g.x=o.x1+(o.x2-o.x1)*(m=p/l),g.y=o.y1+(o.y2-o.y1)*m):p>l+c?(m=(p-=l+c)/h,g.x=u.x1+(u.x2-u.x1)*m,g.y=u.y1+(u.y2-u.y1)*m):(m=(p-=l)/c,g.x=a.x1+(a.x2-a.x1)*m,g.y=a.y1+(a.y2-a.y1)*m),s.push(g)}return s}},function(t,e){t.exports=function(t,e,n){if(!t||"number"==typeof t)return!1;if(t.hasOwnProperty(e))return t[e]=n,!0;if(-1!==e.indexOf(".")){for(var i=e.split("."),r=t,s=t,o=0;o<i.length;o++){if(!r.hasOwnProperty(i[o]))return!1;s=r,r=r[i[o]]}return s[i[i.length-1]]=n,!0}return!1}},function(t,e,n){var i=n(0),r=n(10),s=new i({initialize:function(t,e,n,i,r,s,o){this.x=t,this.y=e,this.radius=n,this.r=i,this.g=r,this.b=s,this.intensity=o,this.scrollFactorX=1,this.scrollFactorY=1},set:function(t,e,n,i,r,s,o){return this.x=t,this.y=e,this.radius=n,this.r=i,this.g=r,this.b=s,this.intensity=o,this.scrollFactorX=1,this.scrollFactorY=1,this},setScrollFactor:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=t),this.scrollFactorX=t,this.scrollFactorY=e,this},setColor:function(t){var e=r.getFloatsFromUintRGB(t);return this.r=e[0],this.g=e[1],this.b=e[2],this},setIntensity:function(t){return this.intensity=t,this},setPosition:function(t,e){return this.x=t,this.y=e,this},setRadius:function(t){return this.radius=t,this}});t.exports=s},function(t,e,n){var i=n(0),r=n(404),s=n(10),o=new i({initialize:function(){this.lightPool=[],this.lights=[],this.culledLights=[],this.ambientColor={r:.1,g:.1,b:.1},this.active=!1,this.maxLights=-1},enable:function(){return-1===this.maxLights&&(this.maxLights=this.scene.sys.game.renderer.config.maxLights),this.active=!0,this},disable:function(){return this.active=!1,this},cull:function(t){var e=this.lights,n=this.culledLights,i=e.length,r=t.x+t.width/2,s=t.y+t.height/2,o=(t.width+t.height)/2,a={x:0,y:0},u=t.matrix,l=this.systems.game.config.height;n.length=0;for(var c=0;c<i&&n.length<this.maxLights;c++){var h=e[c];u.transformPoint(h.x,h.y,a);var d=r-(a.x-t.scrollX*h.scrollFactorX*t.zoom),f=s-(l-(a.y-t.scrollY*h.scrollFactorY*t.zoom));Math.sqrt(d*d+f*f)<h.radius+o&&n.push(e[c])}return n},forEachLight:function(t){if(t){for(var e=this.lights,n=e.length,i=0;i<n;++i)t(e[i]);return this}},setAmbientColor:function(t){var e=s.getFloatsFromUintRGB(t);return this.ambientColor.r=e[0],this.ambientColor.g=e[1],this.ambientColor.b=e[2],this},getMaxVisibleLights:function(){return 10},getLightCount:function(){return this.lights.length},addLight:function(t,e,n,i,o){var a,u=null;return t=void 0===t?0:t,e=void 0===e?0:e,n=void 0===n?100:n,o=void 0===o?1:o,a=s.getFloatsFromUintRGB(i=void 0===i?16777215:i),u=null,this.lightPool.length>0?(u=this.lightPool.pop()).set(t,e,n,a[0],a[1],a[2],o):u=new r(t,e,n,a[0],a[1],a[2],o),this.lights.push(u),u},removeLight:function(t){var e=this.lights.indexOf(t);return e>=0&&(this.lightPool.push(t),this.lights.splice(e,1)),this},shutdown:function(){for(;this.lights.length>0;)this.lightPool.push(this.lights.pop());this.ambientColor={r:.1,g:.1,b:.1},this.culledLights.length=0,this.lights.length=0},destroy:function(){this.shutdown()}});t.exports=o},function(t,e,n){var i=n(46),r=n(16),s={Circle:n(1062),Ellipse:n(1072),Intersects:n(407),Line:n(1091),Point:n(1112),Polygon:n(1126),Rectangle:n(422),Triangle:n(1156)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={CircleToCircle:n(408),CircleToRectangle:n(409),GetCircleToCircle:n(1082),GetCircleToRectangle:n(1083),GetLineToCircle:n(201),GetLineToRectangle:n(203),GetRectangleIntersection:n(1084),GetRectangleToRectangle:n(1085),GetRectangleToTriangle:n(1086),GetTriangleToCircle:n(1087),GetTriangleToLine:n(414),GetTriangleToTriangle:n(1088),LineToCircle:n(202),LineToLine:n(84),LineToRectangle:n(410),PointToLine:n(418),PointToLineSegment:n(1089),RectangleToRectangle:n(129),RectangleToTriangle:n(411),RectangleToValues:n(1090),TriangleToCircle:n(413),TriangleToLine:n(415),TriangleToTriangle:n(416)}},function(t,e,n){var i=n(58);t.exports=function(t,e){return i(t.x,t.y,e.x,e.y)<=t.radius+e.radius}},function(t,e){t.exports=function(t,e){var n=e.width/2,i=e.height/2,r=Math.abs(t.x-e.x-n),s=Math.abs(t.y-e.y-i);if(r>n+t.radius||s>i+t.radius)return!1;if(r<=n||s<=i)return!0;var o=r-n,a=s-i;return o*o+a*a<=t.radius*t.radius}},function(t,e){t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=e.x,a=e.y,u=e.right,l=e.bottom,c=0;if(n>=o&&n<=u&&i>=a&&i<=l||r>=o&&r<=u&&s>=a&&s<=l)return!0;if(n<o&&r>=o){if((c=i+(s-i)*(o-n)/(r-n))>a&&c<=l)return!0}else if(n>u&&r<=u&&(c=i+(s-i)*(u-n)/(r-n))>=a&&c<=l)return!0;if(i<a&&s>=a){if((c=n+(r-n)*(a-i)/(s-i))>=o&&c<=u)return!0}else if(i>l&&s<=l&&(c=n+(r-n)*(l-i)/(s-i))>=o&&c<=u)return!0;return!1}},function(t,e,n){var i=n(84),r=n(47),s=n(204),o=n(412);t.exports=function(t,e){if(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)return!1;var n=e.getLineA(),a=e.getLineB(),u=e.getLineC();if(r(t,n.x1,n.y1)||r(t,n.x2,n.y2))return!0;if(r(t,a.x1,a.y1)||r(t,a.x2,a.y2))return!0;if(r(t,u.x1,u.y1)||r(t,u.x2,u.y2))return!0;var l=t.getLineA(),c=t.getLineB(),h=t.getLineC(),d=t.getLineD();if(i(n,l)||i(n,c)||i(n,h)||i(n,d))return!0;if(i(a,l)||i(a,c)||i(a,h)||i(a,d))return!0;if(i(u,l)||i(u,c)||i(u,h)||i(u,d))return!0;var f=o(t);return s(e,f,!0).length>0}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x,y:t.y}),e.push({x:t.right,y:t.y}),e.push({x:t.right,y:t.bottom}),e.push({x:t.x,y:t.bottom}),e}},function(t,e,n){var i=n(202),r=n(83);t.exports=function(t,e){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top||!r(t,e.x,e.y)&&!i(t.getLineA(),e)&&!i(t.getLineB(),e)&&!i(t.getLineC(),e))}},function(t,e,n){var i=n(4),r=n(415),s=n(84);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e))for(var o=t.getLineA(),a=t.getLineB(),u=t.getLineC(),l=[new i,new i,new i],c=[s(o,e,l[0]),s(a,e,l[1]),s(u,e,l[2])],h=0;h<3;h++)c[h]&&n.push(l[h]);return n}},function(t,e,n){var i=n(83),r=n(84);t.exports=function(t,e){return!!(i(t,e.getPointA())||i(t,e.getPointB())||r(t.getLineA(),e)||r(t.getLineB(),e)||r(t.getLineC(),e))}},function(t,e,n){var i=n(204),r=n(417),s=n(84);t.exports=function(t,e){if(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)return!1;var n=t.getLineA(),o=t.getLineB(),a=t.getLineC(),u=e.getLineA(),l=e.getLineB(),c=e.getLineC();if(s(n,u)||s(n,l)||s(n,c))return!0;if(s(o,u)||s(o,l)||s(o,c))return!0;if(s(a,u)||s(a,l)||s(a,c))return!0;var h=r(t),d=i(e,h,!0);return d.length>0||(h=r(e),(d=i(t,h,!0)).length>0)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=[]),e.push({x:t.x1,y:t.y1}),e.push({x:t.x2,y:t.y2}),e.push({x:t.x3,y:t.y3}),e}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=1);var i=e.x1,r=e.y1,s=e.x2,o=e.y2,a=t.x,u=t.y,l=(s-i)*(s-i)+(o-r)*(o-r);if(0===l)return!1;var c=((a-i)*(s-i)+(u-r)*(o-r))/l;return c<0?Math.sqrt((i-a)*(i-a)+(r-u)*(r-u))<=n:c>=0&&c<=1?Math.abs(((r-u)*(s-i)-(i-a)*(o-r))/l)*Math.sqrt(l)<=n:Math.sqrt((s-a)*(s-a)+(o-u)*(o-u))<=n}},function(t,e,n){var i=n(23),r=n(57),s=n(85);t.exports=function(t){var e=s(t)-i.TAU;return r(e,-Math.PI,Math.PI)}},function(t,e){t.exports=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},function(t,e){t.exports=function(t){return t.x*t.x+t.y*t.y}},function(t,e,n){var i=n(11);i.Area=n(1131),i.Ceil=n(1132),i.CeilAll=n(1133),i.CenterOn=n(163),i.Clone=n(1134),i.Contains=n(47),i.ContainsPoint=n(1135),i.ContainsRect=n(423),i.CopyFrom=n(1136),i.Decompose=n(412),i.Equals=n(1137),i.FitInside=n(1138),i.FitOutside=n(1139),i.Floor=n(1140),i.FloorAll=n(1141),i.FromPoints=n(173),i.GetAspectRatio=n(206),i.GetCenter=n(1142),i.GetPoint=n(147),i.GetPoints=n(255),i.GetSize=n(1143),i.Inflate=n(1144),i.Intersection=n(1145),i.MarchingAnts=n(266),i.MergePoints=n(1146),i.MergeRect=n(1147),i.MergeXY=n(1148),i.Offset=n(1149),i.OffsetPoint=n(1150),i.Overlaps=n(1151),i.Perimeter=n(110),i.PerimeterPoint=n(1152),i.Random=n(150),i.RandomOutside=n(1153),i.SameDimensions=n(1154),i.Scale=n(1155),i.Union=n(370),t.exports=i},function(t,e){t.exports=function(t,e){return!(e.width*e.height>t.width*t.height)&&e.x>t.x&&e.x<t.right&&e.right>t.x&&e.right<t.right&&e.y>t.y&&e.y<t.bottom&&e.bottom>t.y&&e.bottom<t.bottom}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2+t.x3)/3,e.y=(t.y1+t.y2+t.y3)/3,e}},function(t,e){t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t.x3+=e,t.y3+=n,t}},function(t,e,n){var i=n(4);function r(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x1,s=t.y1,o=t.x2,a=t.y2,u=t.x3,l=t.y3,c=r(u,l,o,a),h=r(n,s,u,l),d=r(o,a,n,s),f=c+h+d;return e.x=(n*c+o*h+u*d)/f,e.y=(s*c+a*h+l*d)/f,e}},function(t,e){t.exports=function(t,e,n){return{gameObject:t,enabled:!0,alwaysEnabled:!1,draggable:!1,dropZone:!1,cursor:!1,target:null,camera:null,hitArea:e,hitAreaCallback:n,hitAreaDebug:null,customHitArea:!1,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragX:0,dragY:0}}},function(t,e,n){var i=new(n(0))({initialize:function(t,e){this.pad=t,this.events=t.events,this.index=e,this.value=0,this.threshold=.1},update:function(t){this.value=t},getValue:function(){return Math.abs(this.value)<this.threshold?0:this.value},destroy:function(){this.pad=null,this.events=null}});t.exports=i},function(t,e,n){var i=n(0),r=n(208),s=new i({initialize:function(t,e){this.pad=t,this.events=t.manager,this.index=e,this.value=0,this.threshold=1,this.pressed=!1},update:function(t){this.value=t;var e=this.pad,n=this.index;t>=this.threshold?this.pressed||(this.pressed=!0,this.events.emit(r.BUTTON_DOWN,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_DOWN,n,t,this)):this.pressed&&(this.pressed=!1,this.events.emit(r.BUTTON_UP,e,this,t),this.pad.emit(r.GAMEPAD_BUTTON_UP,n,t,this))},destroy:function(){this.pad=null,this.events=null}});t.exports=s},function(t,e,n){var i=n(428),r=n(429),s=n(0),o=n(9),a=n(3),u=new s({Extends:o,initialize:function(t,e){o.call(this),this.manager=t,this.pad=e,this.id=e.id,this.index=e.index;for(var n=[],s=0;s<e.buttons.length;s++)n.push(new r(this,s));this.buttons=n;var u=[];for(s=0;s<e.axes.length;s++)u.push(new i(this,s));this.axes=u,this.vibration=e.vibrationActuator;var l={value:0,pressed:!1};this._LCLeft=n[14]?n[14]:l,this._LCRight=n[15]?n[15]:l,this._LCTop=n[12]?n[12]:l,this._LCBottom=n[13]?n[13]:l,this._RCLeft=n[2]?n[2]:l,this._RCRight=n[1]?n[1]:l,this._RCTop=n[3]?n[3]:l,this._RCBottom=n[0]?n[0]:l,this._FBLeftTop=n[4]?n[4]:l,this._FBLeftBottom=n[6]?n[6]:l,this._FBRightTop=n[5]?n[5]:l,this._FBRightBottom=n[7]?n[7]:l;var c={value:0};this._HAxisLeft=u[0]?u[0]:c,this._VAxisLeft=u[1]?u[1]:c,this._HAxisRight=u[2]?u[2]:c,this._VAxisRight=u[3]?u[3]:c,this.leftStick=new a,this.rightStick=new a},getAxisTotal:function(){return this.axes.length},getAxisValue:function(t){return this.axes[t].getValue()},setAxisThreshold:function(t){for(var e=0;e<this.axes.length;e++)this.axes[e].threshold=t},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(t){return this.buttons[t].value},isButtonDown:function(t){return this.buttons[t].pressed},update:function(t){var e,n=this.buttons,i=t.buttons,r=n.length;for(e=0;e<r;e++)n[e].update(i[e].value);var s=this.axes,o=t.axes;for(r=s.length,e=0;e<r;e++)s[e].update(o[e]);r>=2&&(this.leftStick.set(s[0].getValue(),s[1].getValue()),r>=4&&this.rightStick.set(s[2].getValue(),s[3].getValue()))},destroy:function(){var t;for(this.removeAllListeners(),this.manager=null,this.pad=null,t=0;t<this.buttons.length;t++)this.buttons[t].destroy();for(t=0;t<this.axes.length;t++)this.axes[t].destroy();this.buttons=[],this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});t.exports=u},function(t,e,n){var i=n(0),r=n(9),s=n(131),o=new i({Extends:r,initialize:function(t,e){r.call(this),this.plugin=t,this.keyCode=e,this.originalEvent=void 0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.location=0,this.timeDown=0,this.duration=0,this.timeUp=0,this.emitOnRepeat=!1,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1},setEmitOnRepeat:function(t){return this.emitOnRepeat=t,this},onDown:function(t){this.originalEvent=t,this.enabled&&(this.altKey=t.altKey,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.location=t.location,this.repeats++,this.isDown?this.emitOnRepeat&&this.emit(s.DOWN,this,t):(this.isDown=!0,this.isUp=!1,this.timeDown=t.timeStamp,this.duration=0,this._justDown=!0,this._justUp=!1,this.emit(s.DOWN,this,t)))},onUp:function(t){this.originalEvent=t,this.enabled&&(this.isDown=!1,this.isUp=!0,this.timeUp=t.timeStamp,this.duration=this.timeUp-this.timeDown,this.repeats=0,this._justDown=!1,this._justUp=!0,this._tick=-1,this.emit(s.UP,this,t))},reset:function(){return this.preventDefault=!0,this.enabled=!0,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.metaKey=!1,this.timeDown=0,this.duration=0,this.timeUp=0,this.repeats=0,this._justDown=!1,this._justUp=!1,this._tick=-1,this},getDuration:function(){return this.isDown?this.plugin.game.loop.time-this.timeDown:0},destroy:function(){this.removeAllListeners(),this.originalEvent=null,this.plugin=null}});t.exports=o},function(t,e,n){var i=n(0),r=n(131),s=n(2),o=n(1195),a=n(1197),u=new i({initialize:function(t,e,n){if(void 0===n&&(n={}),e.length<2)return!1;this.manager=t,this.enabled=!0,this.keyCodes=[];for(var i=0;i<e.length;i++){var u=e[i];"string"==typeof u?this.keyCodes.push(u.toUpperCase().charCodeAt(0)):"number"==typeof u?this.keyCodes.push(u):u.hasOwnProperty("keyCode")&&this.keyCodes.push(u.keyCode)}this.current=this.keyCodes[0],this.index=0,this.size=this.keyCodes.length,this.timeLastMatched=0,this.matched=!1,this.timeMatched=0,this.resetOnWrongKey=s(n,"resetOnWrongKey",!0),this.maxKeyDelay=s(n,"maxKeyDelay",0),this.resetOnMatch=s(n,"resetOnMatch",!1),this.deleteOnMatch=s(n,"deleteOnMatch",!1);var l=this;this.onKeyDown=function(t){!l.matched&&l.enabled&&o(t,l)&&(l.manager.emit(r.COMBO_MATCH,l,t),l.resetOnMatch?a(l):l.deleteOnMatch&&l.destroy())},this.manager.on(r.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=!1,this.keyCodes=[],this.manager.off(r.ANY_KEY_DOWN,this.onKeyDown),this.manager=null}});t.exports=u},function(t,e,n){var i=n(209);t.exports=function(t,e){var n=i(e,t.xhrSettings),r=new XMLHttpRequest;return r.open("GET",t.src,n.async,n.user,n.password),r.responseType=t.xhrSettings.responseType,r.timeout=n.timeout,n.header&&n.headerValue&&r.setRequestHeader(n.header,n.headerValue),n.requestedWith&&r.setRequestHeader("X-Requested-With",n.requestedWith),n.overrideMimeType&&r.overrideMimeType(n.overrideMimeType),r.onload=t.onLoad.bind(t,r),r.onerror=t.onError.bind(t,r),r.onprogress=t.onProgress.bind(t),r.send(),r}},function(t,e,n){var i=n(0),r=n(29),s=n(19),o=n(8),a=n(2),u=n(435),l=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,r){if(l(e)){var o=e;e=a(o,"key"),i=a(o,"xhrSettings"),r=a(o,"context",r)}s.call(this,t,{type:"audio",cache:t.cacheManager.audio,extension:n.type,responseType:"arraybuffer",key:e,url:n.url,xhrSettings:i,config:{context:r}})},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(e){t.data=e,t.onProcessComplete()},function(e){console.error("Error decoding audio: "+this.key+" - ",e?e.message:null),t.onProcessError()}),this.config.context=null}});c.create=function(t,e,n,i,r){var s=t.systems.game,o=s.config.audio,h=s.device.audio;l(e)&&(n=a(e,"url",[]),i=a(e,"config",{}));var d=c.getAudioURL(s,n);return d?!h.webAudio||o&&o.disableWebAudio?new u(t,e,d,i):new c(t,e,d,r,s.sound.context):null},c.getAudioURL=function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=a(e[n],"url",e[n]);if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return i;var r=i.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=a(e[n],"type",r?r[1]:"").toLowerCase(),t.device.audio[r])return{url:i,type:r}}return null},o.register("audio",function(t,e,n,i){var r,s=this.systems.game,o=s.config.audio,a=s.device.audio;if(o&&o.noAudio||!a.webAudio&&!a.audioData)return this;if(Array.isArray(t))for(var u=0;u<t.length;u++)(r=c.create(this,t[u]))&&this.addFile(r);else(r=c.create(this,t,e,n,i))&&this.addFile(r);return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(81),s=n(19),o=n(2),a=n(132),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i){if(u(e)){var r=e;e=o(r,"key"),i=o(r,"config",i)}s.call(this,t,{type:"audio",cache:t.cacheManager.audio,extension:n.type,key:e,url:n.url,config:i}),this.locked="ontouchstart"in window,this.loaded=!1,this.filesLoaded=0,this.filesTotal=0},onLoad:function(){this.loaded||(this.loaded=!0,this.loader.nextFile(this,!0))},onError:function(){for(var t=0;t<this.data.length;t++){var e=this.data[t];e.oncanplaythrough=null,e.onerror=null}this.loader.nextFile(this,!1)},onProgress:function(t){var e=t.target;e.oncanplaythrough=null,e.onerror=null,this.filesLoaded++,this.percentComplete=Math.min(this.filesLoaded/this.filesTotal,1),this.loader.emit(r.FILE_PROGRESS,this,this.percentComplete),this.filesLoaded===this.filesTotal&&this.onLoad()},load:function(){this.data=[];var t=this.config&&this.config.instances||1;this.filesTotal=t,this.filesLoaded=0,this.percentComplete=0;for(var e=0;e<t;e++){var n=new Audio;n.dataset={},n.dataset.name=this.key+("0"+e).slice(-2),n.dataset.used="false",this.locked?n.dataset.locked="true":(n.dataset.locked="false",n.preload="auto",n.oncanplaythrough=this.onProgress.bind(this),n.onerror=this.onError.bind(this)),this.data.push(n)}for(e=0;e<this.data.length;e++)(n=this.data[e]).src=a(this,this.loader.baseURL),this.locked||n.load();this.locked&&setTimeout(this.onLoad.bind(this))}});t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i){var r="js";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"script",cache:!1,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("script",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i){var r="txt";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"text",cache:t.cacheManager.text,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("text",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this}),t.exports=l},function(t,e,n){var i=n(439),r=n(134),s=n(0),o=n(50),a=n(440),u=n(441),l=new s({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},collider:function(t,e,n,i,r){return this.world.addCollider(t,e,n,i,r)},overlap:function(t,e,n,i,r){return this.world.addOverlap(t,e,n,i,r)},existing:function(t,e){return this.world.enableBody(t,e?o.STATIC_BODY:o.DYNAMIC_BODY),t},staticImage:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,o.STATIC_BODY),s},image:function(t,e,n,r){var s=new i(this.scene,t,e,n,r);return this.sys.displayList.add(s),this.world.enableBody(s,o.DYNAMIC_BODY),s},staticSprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,o.STATIC_BODY),s},sprite:function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.sys.displayList.add(s),this.sys.updateList.add(s),this.world.enableBody(s,o.DYNAMIC_BODY),s},staticGroup:function(t,e){return this.sys.updateList.add(new u(this.world,this.world.scene,t,e))},group:function(t,e){return this.sys.updateList.add(new a(this.world,this.world.scene,t,e))},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=l},function(t,e,n){var i=n(0),r=n(211),s=n(98),o=new i({Extends:s,Mixins:[r.Acceleration,r.Angular,r.Bounce,r.Debug,r.Drag,r.Enable,r.Friction,r.Gravity,r.Immovable,r.Mass,r.Size,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.body=null}});t.exports=o},function(t,e,n){var i=n(134),r=n(0),s=n(50),o=n(2),a=n(97),u=n(7),l=new r({Extends:a,initialize:function(t,e,n,r){if(n||r)if(u(n))r=n,n=null,r.createCallback=this.createCallbackHandler,r.removeCallback=this.removeCallbackHandler;else if(Array.isArray(n)&&u(n[0])){r=n[0];var l=this;n.forEach(function(t){t.createCallback=l.createCallbackHandler,t.removeCallback=l.removeCallbackHandler})}else r={createCallback:this.createCallbackHandler,removeCallback:this.removeCallbackHandler};else r={createCallback:this.createCallbackHandler,removeCallback:this.removeCallbackHandler};this.world=t,r.classType=o(r,"classType",i),this.physicsType=s.DYNAMIC_BODY,this.defaults={setCollideWorldBounds:o(r,"collideWorldBounds",!1),setBoundsRectangle:o(r,"customBoundsRectangle",null),setAccelerationX:o(r,"accelerationX",0),setAccelerationY:o(r,"accelerationY",0),setAllowDrag:o(r,"allowDrag",!0),setAllowGravity:o(r,"allowGravity",!0),setAllowRotation:o(r,"allowRotation",!0),setBounceX:o(r,"bounceX",0),setBounceY:o(r,"bounceY",0),setDragX:o(r,"dragX",0),setDragY:o(r,"dragY",0),setEnable:o(r,"enable",!0),setGravityX:o(r,"gravityX",0),setGravityY:o(r,"gravityY",0),setFrictionX:o(r,"frictionX",0),setFrictionY:o(r,"frictionY",0),setVelocityX:o(r,"velocityX",0),setVelocityY:o(r,"velocityY",0),setAngularVelocity:o(r,"angularVelocity",0),setAngularAcceleration:o(r,"angularAcceleration",0),setAngularDrag:o(r,"angularDrag",0),setMass:o(r,"mass",1),setImmovable:o(r,"immovable",!1)},Array.isArray(n)&&(r=null),a.call(this,e,n,r)},createCallbackHandler:function(t){t.body||this.world.enableBody(t,s.DYNAMIC_BODY);var e=t.body;for(var n in this.defaults)e[n](this.defaults[n])},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},setVelocity:function(t,e,n){void 0===n&&(n=0);for(var i=this.getChildren(),r=0;r<i.length;r++)i[r].body.velocity.set(t+r*n,e+r*n);return this},setVelocityX:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.x=t+i*e;return this},setVelocityY:function(t,e){void 0===e&&(e=0);for(var n=this.getChildren(),i=0;i<n.length;i++)n[i].body.velocity.y=t+i*e;return this}});t.exports=l},function(t,e,n){var i=n(134),r=n(0),s=n(50),o=n(2),a=n(97),u=n(7),l=new r({Extends:a,initialize:function(t,e,n,r){n||r?u(n)?(r=n,n=null,r.createCallback=this.createCallbackHandler,r.removeCallback=this.removeCallbackHandler,r.createMultipleCallback=this.createMultipleCallbackHandler,r.classType=o(r,"classType",i)):Array.isArray(n)&&u(n[0])&&(r=n,n=null,r.forEach(function(t){t.createCallback=this.createCallbackHandler,t.removeCallback=this.removeCallbackHandler,t.createMultipleCallback=this.createMultipleCallbackHandler,t.classType=o(t,"classType",i)})):r={createCallback:this.createCallbackHandler,removeCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:i},this.world=t,this.physicsType=s.STATIC_BODY,a.call(this,e,n,r)},createCallbackHandler:function(t){t.body||this.world.enableBody(t,s.STATIC_BODY)},removeCallbackHandler:function(t){t.body&&this.world.disableBody(t)},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){for(var t=this.children.entries,e=0;e<t.length;e++)t[e].body.reset();return this}});t.exports=l},function(t,e,n){var i=n(443),r=n(22),s=n(0),o=n(444),a=n(50),u=n(58),l=n(9),c=n(212),h=n(167),d=n(301),f=n(302),p=n(445),m=n(446),g=n(6),y=n(183),v=n(1254),b=n(11),x=n(447),w=n(1255),T=n(1260),S=n(1261),E=n(107),O=n(449),C=n(448),_=n(32),A=n(3),k=n(57),R=new s({Extends:l,initialize:function(t,e){l.call(this),this.scene=t,this.bodies=new E,this.staticBodies=new E,this.pendingDestroy=new E,this.colliders=new y,this.gravity=new A(g(e,"gravity.x",0),g(e,"gravity.y",0)),this.bounds=new b(g(e,"x",0),g(e,"y",0),g(e,"width",t.sys.scale.width),g(e,"height",t.sys.scale.height)),this.checkCollision={up:g(e,"checkCollision.up",!0),down:g(e,"checkCollision.down",!0),left:g(e,"checkCollision.left",!0),right:g(e,"checkCollision.right",!0)},this.fps=g(e,"fps",60),this._elapsed=0,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this.stepsLastFrame=0,this.timeScale=g(e,"timeScale",1),this.OVERLAP_BIAS=g(e,"overlapBias",4),this.TILE_BIAS=g(e,"tileBias",16),this.forceX=g(e,"forceX",!1),this.isPaused=g(e,"isPaused",!1),this._total=0,this.drawDebug=g(e,"debug",!1),this.defaults={debugShowBody:g(e,"debugShowBody",!0),debugShowStaticBody:g(e,"debugShowStaticBody",!0),debugShowVelocity:g(e,"debugShowVelocity",!0),bodyDebugColor:g(e,"debugBodyColor",16711935),staticBodyDebugColor:g(e,"debugStaticBodyColor",255),velocityDebugColor:g(e,"debugVelocityColor",65280)},this.maxEntries=g(e,"maxEntries",16),this.useTree=g(e,"useTree",!0),this.tree=new x(this.maxEntries),this.staticTree=new x(this.maxEntries),this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0},this._tempMatrix=new _,this._tempMatrix2=new _,this.drawDebug&&this.createDebugGraphic()},enable:function(t,e){void 0===e&&(e=a.DYNAMIC_BODY),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(i.isParent)for(var r=i.getChildren(),s=0;s<r.length;s++){var o=r[s];o.isParent?this.enable(o,e):this.enableBody(o,e)}else this.enableBody(i,e)}},enableBody:function(t,e){return void 0===e&&(e=a.DYNAMIC_BODY),t.body||(e===a.DYNAMIC_BODY?t.body=new i(this,t):e===a.STATIC_BODY&&(t.body=new O(this,t))),this.add(t.body),t},add:function(t){return t.physicsType===a.DYNAMIC_BODY?this.bodies.set(t):t.physicsType===a.STATIC_BODY&&(this.staticBodies.set(t),this.staticTree.insert(t)),t.enable=!0,t},disable:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];if(n.isParent)for(var i=n.getChildren(),r=0;r<i.length;r++){var s=i[r];s.isParent?this.disable(s):this.disableBody(s.body)}else this.disableBody(n.body)}},disableBody:function(t){this.remove(t),t.enable=!1},remove:function(t){t.physicsType===a.DYNAMIC_BODY?(this.tree.remove(t),this.bodies.delete(t)):t.physicsType===a.STATIC_BODY&&(this.staticBodies.delete(t),this.staticTree.remove(t))},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},setBounds:function(t,e,n,i,r,s,o,a){return this.bounds.setTo(t,e,n,i),void 0!==r&&this.setBoundsCollision(r,s,o,a),this},setBoundsCollision:function(t,e,n,i){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),this.checkCollision.left=t,this.checkCollision.right=e,this.checkCollision.up=n,this.checkCollision.down=i,this},pause:function(){return this.isPaused=!0,this.emit(c.PAUSE),this},resume:function(){return this.isPaused=!1,this.emit(c.RESUME),this},addCollider:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new o(this,!1,t,e,n,i,r);return this.colliders.add(s),s},addOverlap:function(t,e,n,i,r){void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n);var s=new o(this,!0,t,e,n,i,r);return this.colliders.add(s),s},removeCollider:function(t){return this.colliders.remove(t),this},setFPS:function(t){return this.fps=t,this._frameTime=1/this.fps,this._frameTimeMS=1e3*this._frameTime,this},update:function(t,e){if(!this.isPaused&&0!==this.bodies.size){var n,i,r=this._frameTime,s=this._frameTimeMS*this.timeScale;this._elapsed+=e;var o=this.bodies.entries,a=this._elapsed>=s;for(n=0;n<o.length;n++)(i=o[n]).enable&&i.preUpdate(a,r);if(a){this._elapsed-=s,this.stepsLastFrame=1,this.useTree&&(this.tree.clear(),this.tree.load(o));var u=this.colliders.update();for(n=0;n<u.length;n++){var l=u[n];l.active&&l.update()}this.emit(c.WORLD_STEP)}for(;this._elapsed>=s;)this._elapsed-=s,this.step(r)}},step:function(t){var e,n,i=this.bodies.entries,r=i.length;for(e=0;e<r;e++)(n=i[e]).enable&&n.update(t);this.useTree&&(this.tree.clear(),this.tree.load(i));var s=this.colliders.update();for(e=0;e<s.length;e++){var o=s[e];o.active&&o.update()}this.emit(c.WORLD_STEP),this.stepsLastFrame++},postUpdate:function(){var t,e,n=this.bodies.entries,i=n.length,r=this.bodies,s=this.staticBodies;if(this.stepsLastFrame)for(this.stepsLastFrame=0,t=0;t<i;t++)(e=n[t]).enable&&e.postUpdate();if(this.drawDebug){var o=this.debugGraphic;for(o.clear(),t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o);for(i=(n=s.entries).length,t=0;t<i;t++)(e=n[t]).willDrawDebug()&&e.drawDebug(o)}var u=this.pendingDestroy;if(u.size>0){var l=this.tree,c=this.staticTree;for(i=(n=u.entries).length,t=0;t<i;t++)(e=n[t]).physicsType===a.DYNAMIC_BODY?(l.remove(e),r.delete(e)):e.physicsType===a.STATIC_BODY&&(c.remove(e),s.delete(e)),e.world=void 0,e.gameObject=void 0;u.clear()}},updateMotion:function(t,e){t.allowRotation&&this.computeAngularVelocity(t,e),this.computeVelocity(t,e)},computeAngularVelocity:function(t,e){var n=t.angularVelocity,i=t.angularAcceleration,s=t.angularDrag,o=t.maxAngular;i?n+=i*e:t.allowDrag&&s&&(d(n-(s*=e),0,.1)?n-=s:f(n+s,0,.1)?n+=s:n=0);var a=(n=r(n,-o,o))-t.angularVelocity;t.angularVelocity+=a,t.rotation+=t.angularVelocity*e},computeVelocity:function(t,e){var n=t.velocity.x,i=t.acceleration.x,s=t.drag.x,o=t.maxVelocity.x,a=t.velocity.y,u=t.acceleration.y,l=t.drag.y,c=t.maxVelocity.y,p=t.speed,m=t.maxSpeed,g=t.allowDrag,y=t.useDamping;t.allowGravity&&(n+=(this.gravity.x+t.gravity.x)*e,a+=(this.gravity.y+t.gravity.y)*e),i?n+=i*e:g&&s&&(y?(n*=s,p=Math.sqrt(n*n+a*a),h(p,0,.001)&&(n=0)):d(n-(s*=e),0,.01)?n-=s:f(n+s,0,.01)?n+=s:n=0),u?a+=u*e:g&&l&&(y?(a*=l,p=Math.sqrt(n*n+a*a),h(p,0,.001)&&(a=0)):d(a-(l*=e),0,.01)?a-=l:f(a+l,0,.01)?a+=l:a=0),n=r(n,-o,o),a=r(a,-c,c),t.velocity.set(n,a),m>-1&&p>m&&(t.velocity.normalize().scale(m),p=m),t.speed=p},separate:function(t,e,n,i,r){if(!t.enable||!e.enable||t.checkCollision.none||e.checkCollision.none||!this.intersects(t,e))return!1;if(n&&!1===n.call(i,t.gameObject,e.gameObject))return!1;if(t.isCircle&&e.isCircle)return this.separateCircle(t,e,r);if(t.isCircle!==e.isCircle){var s=t.isCircle?e:t,o={x:s.x,y:s.y,right:s.right,bottom:s.bottom},a=(t.isCircle?t:e).center;if((a.y<o.y||a.y>o.bottom)&&(a.x<o.x||a.x>o.right))return this.separateCircle(t,e,r)}var u=!1,l=!1;this.forceX||Math.abs(this.gravity.y+t.gravity.y)<Math.abs(this.gravity.x+t.gravity.x)?(u=T(t,e,r,this.OVERLAP_BIAS),this.intersects(t,e)&&(l=S(t,e,r,this.OVERLAP_BIAS))):(l=S(t,e,r,this.OVERLAP_BIAS),this.intersects(t,e)&&(u=T(t,e,r,this.OVERLAP_BIAS)));var h=u||l;return h&&(r?(t.onOverlap||e.onOverlap)&&this.emit(c.OVERLAP,t.gameObject,e.gameObject,t,e):(t.onCollide||e.onCollide)&&this.emit(c.COLLIDE,t.gameObject,e.gameObject,t,e)),h},separateCircle:function(t,e,n,i){p(t,e,!1,i),m(t,e,!1,i);var r=0;if(t.isCircle!==e.isCircle){var s={x:e.isCircle?t.position.x:e.position.x,y:e.isCircle?t.position.y:e.position.y,right:e.isCircle?t.right:e.right,bottom:e.isCircle?t.bottom:e.bottom},o={x:t.isCircle?t.center.x:e.center.x,y:t.isCircle?t.center.y:e.center.y,radius:t.isCircle?t.halfWidth:e.halfWidth};o.y<s.y?o.x<s.x?r=u(o.x,o.y,s.x,s.y)-o.radius:o.x>s.right&&(r=u(o.x,o.y,s.right,s.y)-o.radius):o.y>s.bottom&&(o.x<s.x?r=u(o.x,o.y,s.x,s.bottom)-o.radius:o.x>s.right&&(r=u(o.x,o.y,s.right,s.bottom)-o.radius)),r*=-1}else r=t.halfWidth+e.halfWidth-u(t.center.x,t.center.y,e.center.x,e.center.y);if(n||0===r||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==r&&(t.onOverlap||e.onOverlap)&&this.emit(c.OVERLAP,t.gameObject,e.gameObject,t,e),0!==r;var a=t.center.y-e.center.y,l=Math.sqrt(Math.pow(t.center.x-e.center.x,2)+Math.pow(a,2)),h=(e.center.x-t.center.x)/l||0,d=(e.center.y-t.center.y)/l||0,f=2*(t.velocity.x*h+t.velocity.y*d-e.velocity.x*h-e.velocity.y*d)/(t.mass+e.mass);t.immovable||(t.velocity.x=t.velocity.x-f*t.mass*h,t.velocity.y=t.velocity.y-f*t.mass*d),e.immovable||(e.velocity.x=e.velocity.x+f*e.mass*h,e.velocity.y=e.velocity.y+f*e.mass*d);var g=Math.atan2(e.velocity.y-t.velocity.y,e.velocity.x-t.velocity.x),y=this._frameTime;return t.immovable||e.immovable||(r/=2),t.immovable||(t.x+=t.velocity.x*y-r*Math.cos(g),t.y+=t.velocity.y*y-r*Math.sin(g)),e.immovable||(e.x+=e.velocity.x*y+r*Math.cos(g),e.y+=e.velocity.y*y+r*Math.sin(g)),t.velocity.x*=t.bounce.x,t.velocity.y*=t.bounce.y,e.velocity.x*=e.bounce.x,e.velocity.y*=e.bounce.y,(t.onCollide||e.onCollide)&&this.emit(c.COLLIDE,t.gameObject,e.gameObject,t,e),!0},intersects:function(t,e){return t!==e&&(t.isCircle||e.isCircle?t.isCircle?e.isCircle?u(t.center.x,t.center.y,e.center.x,e.center.y)<=t.halfWidth+e.halfWidth:this.circleBodyIntersects(t,e):this.circleBodyIntersects(e,t):!(t.right<=e.position.x||t.bottom<=e.position.y||t.position.x>=e.right||t.position.y>=e.bottom))},circleBodyIntersects:function(t,e){var n=r(t.center.x,e.left,e.right),i=r(t.center.y,e.top,e.bottom);return(t.center.x-n)*(t.center.x-n)+(t.center.y-i)*(t.center.y-i)<=t.halfWidth*t.halfWidth},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.collideObjects(t,e,n,i,r,!1)},collideObjects:function(t,e,n,i,r,s){var o,a;t.isParent&&void 0===t.physicsType&&(t=t.children.entries),e&&e.isParent&&void 0===e.physicsType&&(e=e.children.entries);var u=Array.isArray(t),l=Array.isArray(e);if(this._total=0,u||l)if(!u&&l)for(o=0;o<e.length;o++)this.collideHandler(t,e[o],n,i,r,s);else if(u&&!l)if(e)for(o=0;o<t.length;o++)this.collideHandler(t[o],e,n,i,r,s);else for(o=0;o<t.length;o++){var c=t[o];for(a=o+1;a<t.length;a++)o!==a&&this.collideHandler(c,t[a],n,i,r,s)}else for(o=0;o<t.length;o++)for(a=0;a<e.length;a++)this.collideHandler(t[o],e[a],n,i,r,s);else this.collideHandler(t,e,n,i,r,s);return this._total>0},collideHandler:function(t,e,n,i,r,s){if(void 0===e&&t.isParent)return this.collideGroupVsGroup(t,t,n,i,r,s);if(!t||!e)return!1;if(t.body){if(e.body)return this.collideSpriteVsSprite(t,e,n,i,r,s);if(e.isParent)return this.collideSpriteVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideSpriteVsTilemapLayer(t,e,n,i,r,s)}else if(t.isParent){if(e.body)return this.collideSpriteVsGroup(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsGroup(t,e,n,i,r,s);if(e.isTilemap)return this.collideGroupVsTilemapLayer(t,e,n,i,r,s)}else if(t.isTilemap){if(e.body)return this.collideSpriteVsTilemapLayer(e,t,n,i,r,s);if(e.isParent)return this.collideGroupVsTilemapLayer(e,t,n,i,r,s)}},collideSpriteVsSprite:function(t,e,n,i,r,s){return!(!t.body||!e.body||(this.separate(t.body,e.body,i,r,s)&&(n&&n.call(r,t,e),this._total++),0))},collideSpriteVsGroup:function(t,e,n,i,r,s){var o,u,l,c=t.body;if(0!==e.length&&c&&c.enable)if(this.useTree){var h=this.treeMinMax;h.minX=c.left,h.minY=c.top,h.maxX=c.right,h.maxY=c.bottom;var d=e.physicsType===a.DYNAMIC_BODY?this.tree.search(h):this.staticTree.search(h);for(u=d.length,o=0;o<u;o++)c!==(l=d[o])&&e.contains(l.gameObject)&&this.separate(c,l,i,r,s)&&(n&&n.call(r,c.gameObject,l.gameObject),this._total++)}else{var f=e.getChildren(),p=e.children.entries.indexOf(t);for(u=f.length,o=0;o<u;o++)(l=f[o].body)&&o!==p&&l.enable&&this.separate(c,l,i,r,s)&&(n&&n.call(r,c.gameObject,l.gameObject),this._total++)}},collideGroupVsTilemapLayer:function(t,e,n,i,r,s){var o=t.getChildren();if(0===o.length)return!1;for(var a=!1,u=0;u<o.length;u++)o[u].body&&this.collideSpriteVsTilemapLayer(o[u],e,n,i,r,s)&&(a=!0);return a},collideTiles:function(t,e,n,i,r){return!(!t.body.enable||0===e.length)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!1,!1)},overlapTiles:function(t,e,n,i,r){return!(!t.body.enable||0===e.length)&&this.collideSpriteVsTilesHandler(t,e,n,i,r,!0,!1)},collideSpriteVsTilemapLayer:function(t,e,n,i,r,s){var o=t.body;if(!o.enable)return!1;var a=o.position.x,u=o.width,l=o.height,c=e.layer;if(c.tileWidth>c.baseTileWidth){var h=(c.tileWidth-c.baseTileWidth)*e.scaleX;a-=h,u+=h}c.tileHeight>c.baseTileHeight&&(l+=(c.tileHeight-c.baseTileHeight)*e.scaleY);var d=e.getTilesWithinWorldXY(a,o.position.y,u,l);return 0!==d.length&&this.collideSpriteVsTilesHandler(t,d,n,i,r,s,!0)},collideSpriteVsTilesHandler:function(t,e,n,i,r,s,o){for(var a,u,l=t.body,h={left:0,right:0,top:0,bottom:0},d=!1,f=0;f<e.length;f++)u=(a=e[f]).tilemapLayer,h.left=u.tileToWorldX(a.x),h.top=u.tileToWorldY(a.y),a.baseHeight!==a.height&&(h.top-=(a.height-a.baseHeight)*u.scaleY),h.right=h.left+a.width*u.scaleX,h.bottom=h.top+a.height*u.scaleY,C(h,l)&&(!i||i.call(r,t,a))&&v(a,t)&&(s||w(f,l,a,h,u,this.TILE_BIAS,o))&&(this._total++,d=!0,n&&n.call(r,t,a),s&&l.onOverlap?this.emit(c.TILE_OVERLAP,t,a,l):l.onCollide&&this.emit(c.TILE_COLLIDE,t,a,l));return d},collideGroupVsGroup:function(t,e,n,i,r,s){if(0!==t.length&&0!==e.length)for(var o=t.getChildren(),a=0;a<o.length;a++)this.collideSpriteVsGroup(o[a],e,n,i,r,s)},wrap:function(t,e){t.body?this.wrapObject(t,e):t.getChildren?this.wrapArray(t.getChildren(),e):Array.isArray(t)?this.wrapArray(t,e):this.wrapObject(t,e)},wrapArray:function(t,e){for(var n=0;n<t.length;n++)this.wrapObject(t[n],e)},wrapObject:function(t,e){void 0===e&&(e=0),t.x=k(t.x,this.bounds.left-e,this.bounds.right+e),t.y=k(t.y,this.bounds.top-e,this.bounds.bottom+e)},shutdown:function(){this.tree.clear(),this.staticTree.clear(),this.bodies.clear(),this.staticBodies.clear(),this.colliders.destroy(),this.removeAllListeners()},destroy:function(){this.shutdown(),this.scene=null}});t.exports=R},function(t,e,n){var i=n(0),r=n(50),s=n(212),o=n(170),a=n(11),u=n(47),l=n(3),c=new i({initialize:function(t,e){var n=e.width?e.width:64,i=e.height?e.height:64;this.world=t,this.gameObject=e,this.transform={x:e.x,y:e.y,rotation:e.angle,scaleX:e.scaleX,scaleY:e.scaleY,displayOriginX:e.displayOriginX,displayOriginY:e.displayOriginY},this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new l,this.position=new l(e.x,e.y),this.prev=new l(e.x,e.y),this.prevFrame=new l(e.x,e.y),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=n,this.height=i,this.sourceWidth=n,this.sourceHeight=i,e.frame&&(this.sourceWidth=e.frame.realWidth,this.sourceHeight=e.frame.realHeight),this.halfWidth=Math.abs(n/2),this.halfHeight=Math.abs(i/2),this.center=new l(e.x+this.halfWidth,e.y+this.halfHeight),this.velocity=new l,this.newVelocity=new l,this.deltaMax=new l,this.acceleration=new l,this.allowDrag=!0,this.drag=new l,this.allowGravity=!0,this.gravity=new l,this.bounce=new l,this.worldBounce=null,this.customBoundsRectangle=t.bounds,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.maxVelocity=new l(1e4,1e4),this.maxSpeed=-1,this.friction=new l(1,0),this.useDamping=!1,this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=r.FACING_NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.syncBounds=!1,this.physicsType=r.DYNAMIC_BODY,this._sx=e.scaleX,this._sy=e.scaleY,this._dx=0,this._dy=0,this._bounds=new a},updateBounds:function(){var t=this.gameObject,e=this.transform;if(t.parentContainer){var n=t.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);e.x=n.tx,e.y=n.ty,e.rotation=o(n.rotation),e.scaleX=n.scaleX,e.scaleY=n.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY}else e.x=t.x,e.y=t.y,e.rotation=t.angle,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.displayOriginX=t.displayOriginX,e.displayOriginY=t.displayOriginY;var i=!1;if(this.syncBounds){var r=t.getBounds(this._bounds);this.width=r.width,this.height=r.height,i=!0}else{var s=Math.abs(e.scaleX),a=Math.abs(e.scaleY);this._sx===s&&this._sy===a||(this.width=this.sourceWidth*s,this.height=this.sourceHeight*a,this._sx=s,this._sy=a,i=!0)}i&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter())},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},resetFlags:function(){this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.none=!0,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.overlapR=0,this.overlapX=0,this.overlapY=0,this.embedded=!1},preUpdate:function(t,e){t&&this.resetFlags(),this.updateBounds();var n=this.transform;this.position.x=n.x+n.scaleX*(this.offset.x-n.displayOriginX),this.position.y=n.y+n.scaleY*(this.offset.y-n.displayOriginY),this.updateCenter(),this.rotation=n.rotation,this.preRotation=this.rotation,this.moves&&(this.prev.x=this.position.x,this.prev.y=this.position.y,this.prevFrame.x=this.position.x,this.prevFrame.y=this.position.y),t&&this.update(e)},update:function(t){if(this.prev.x=this.position.x,this.prev.y=this.position.y,this.moves){this.world.updateMotion(this,t);var e=this.velocity.x,n=this.velocity.y;this.newVelocity.set(e*t,n*t),this.position.add(this.newVelocity),this.updateCenter(),this.angle=Math.atan2(n,e),this.speed=Math.sqrt(e*e+n*n),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.world.emit(s.WORLD_BOUNDS,this,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)}this._dx=this.position.x-this.prev.x,this._dy=this.position.y-this.prev.y},postUpdate:function(){var t=this.position.x-this.prevFrame.x,e=this.position.y-this.prevFrame.y;if(this.moves){var n=this.deltaMax.x,i=this.deltaMax.y;0!==n&&0!==t&&(t<0&&t<-n?t=-n:t>0&&t>n&&(t=n)),0!==i&&0!==e&&(e<0&&e<-i?e=-i:e>0&&e>i&&(e=i)),this.gameObject.x+=t,this.gameObject.y+=e}t<0?this.facing=r.FACING_LEFT:t>0&&(this.facing=r.FACING_RIGHT),e<0?this.facing=r.FACING_UP:e>0&&(this.facing=r.FACING_DOWN),this.allowRotation&&(this.gameObject.angle+=this.deltaZ())},setBoundsRectangle:function(t){return this.customBoundsRectangle=t||this.world.bounds,this},checkWorldBounds:function(){var t=this.position,e=this.customBoundsRectangle,n=this.world.checkCollision,i=this.worldBounce?-this.worldBounce.x:-this.bounce.x,r=this.worldBounce?-this.worldBounce.y:-this.bounce.y,s=!1;return t.x<e.x&&n.left?(t.x=e.x,this.velocity.x*=i,this.blocked.left=!0,s=!0):this.right>e.right&&n.right&&(t.x=e.right-this.width,this.velocity.x*=i,this.blocked.right=!0,s=!0),t.y<e.y&&n.up?(t.y=e.y,this.velocity.y*=r,this.blocked.up=!0,s=!0):this.bottom>e.bottom&&n.down&&(t.y=e.bottom-this.height,this.velocity.y*=r,this.blocked.down=!0,s=!0),s&&(this.blocked.none=!1),s},setOffset:function(t,e){return void 0===e&&(e=t),this.offset.set(t,e),this.updateCenter(),this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;return!t&&i.frame&&(t=i.frame.realWidth),!e&&i.frame&&(e=i.frame.realHeight),this.sourceWidth=t,this.sourceHeight=e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.updateCenter(),n&&i.getCenter&&this.offset.set(i.displayWidth/2-this.halfWidth,i.displayHeight/2-this.halfHeight),this.isCircle=!1,this.radius=0,this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.isCircle=!0,this.radius=t,this.sourceWidth=2*t,this.sourceHeight=2*t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter()):this.isCircle=!1,this},reset:function(t,e){this.stop();var n=this.gameObject;n.setPosition(t,e),n.getTopLeft?n.getTopLeft(this.position):this.position.set(t,e),this.prev.copy(this.position),this.prevFrame.copy(this.position),this.rotation=n.angle,this.preRotation=n.angle,this.updateBounds(),this.updateCenter()},stop:function(){return this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?this.radius>0&&t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom&&(this.center.x-t)*(this.center.x-t)+(this.center.y-e)*(this.center.y-e)<=this.radius*this.radius:u(this,t,e)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this._dx>0?this._dx:-this._dx},deltaAbsY:function(){return this._dy>0?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=!1,this.world&&this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor),this.isCircle?t.strokeCircle(n,i,this.width/2):(this.checkCollision.up&&t.lineBetween(e.x,e.y,e.x+this.width,e.y),this.checkCollision.right&&t.lineBetween(e.x+this.width,e.y,e.x+this.width,e.y+this.height),this.checkCollision.down&&t.lineBetween(e.x,e.y+this.height,e.x+this.width,e.y+this.height),this.checkCollision.left&&t.lineBetween(e.x,e.y,e.x,e.y+this.height))),this.debugShowVelocity&&(t.lineStyle(t.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1),t.lineBetween(n,i,n+this.velocity.x/2,i+this.velocity.y/2))},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},setCollideWorldBounds:function(t,e,n){void 0===t&&(t=!0),this.collideWorldBounds=t;var i=void 0!==e,r=void 0!==n;return(i||r)&&(this.worldBounce||(this.worldBounce=new l),i&&(this.worldBounce.x=e),r&&(this.worldBounce.y=n)),this},setVelocity:function(t,e){return this.velocity.set(t,e),t=this.velocity.x,e=this.velocity.y,this.speed=Math.sqrt(t*t+e*e),this},setVelocityX:function(t){this.velocity.x=t;var e=this.velocity.y;return this.speed=Math.sqrt(t*t+e*e),this},setVelocityY:function(t){this.velocity.y=t;var e=this.velocity.x;return this.speed=Math.sqrt(e*e+t*t),this},setMaxVelocity:function(t,e){return this.maxVelocity.set(t,e),this},setMaxSpeed:function(t){return this.maxSpeed=t,this},setBounce:function(t,e){return this.bounce.set(t,e),this},setBounceX:function(t){return this.bounce.x=t,this},setBounceY:function(t){return this.bounce.y=t,this},setAcceleration:function(t,e){return this.acceleration.set(t,e),this},setAccelerationX:function(t){return this.acceleration.x=t,this},setAccelerationY:function(t){return this.acceleration.y=t,this},setAllowDrag:function(t){return void 0===t&&(t=!0),this.allowDrag=t,this},setAllowGravity:function(t){return void 0===t&&(t=!0),this.allowGravity=t,this},setAllowRotation:function(t){return void 0===t&&(t=!0),this.allowRotation=t,this},setDrag:function(t,e){return this.drag.set(t,e),this},setDragX:function(t){return this.drag.x=t,this},setDragY:function(t){return this.drag.y=t,this},setGravity:function(t,e){return this.gravity.set(t,e),this},setGravityX:function(t){return this.gravity.x=t,this},setGravityY:function(t){return this.gravity.y=t,this},setFriction:function(t,e){return this.friction.set(t,e),this},setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setAngularVelocity:function(t){return this.angularVelocity=t,this},setAngularAcceleration:function(t){return this.angularAcceleration=t,this},setAngularDrag:function(t){return this.angularDrag=t,this},setMass:function(t){return this.mass=t,this},setImmovable:function(t){return void 0===t&&(t=!0),this.immovable=t,this},setEnable:function(t){return void 0===t&&(t=!0),this.enable=t,this},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=c},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o){this.world=t,this.name="",this.active=!0,this.overlapOnly=e,this.object1=n,this.object2=i,this.collideCallback=r,this.processCallback=s,this.callbackContext=o},setName:function(t){return this.name=t,this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this),this.active=!1,this.world=null,this.object1=null,this.object2=null,this.collideCallback=null,this.processCallback=null,this.callbackContext=null}});t.exports=i},function(t,e,n){var i=n(50);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsX()+e.deltaAbsX()+r;return 0===t._dx&&0===e._dx?(t.embedded=!0,e.embedded=!0):t._dx>e._dx?(s=t.right-e.x)>o&&!n||!1===t.checkCollision.right||!1===e.checkCollision.left?s=0:(t.touching.none=!1,t.touching.right=!0,e.touching.none=!1,e.touching.left=!0,e.physicsType===i.STATIC_BODY&&(t.blocked.none=!1,t.blocked.right=!0),t.physicsType===i.STATIC_BODY&&(e.blocked.none=!1,e.blocked.left=!0)):t._dx<e._dx&&(-(s=t.x-e.width-e.x)>o&&!n||!1===t.checkCollision.left||!1===e.checkCollision.right?s=0:(t.touching.none=!1,t.touching.left=!0,e.touching.none=!1,e.touching.right=!0,e.physicsType===i.STATIC_BODY&&(t.blocked.none=!1,t.blocked.left=!0),t.physicsType===i.STATIC_BODY&&(e.blocked.none=!1,e.blocked.right=!0))),t.overlapX=s,e.overlapX=s,s}},function(t,e,n){var i=n(50);t.exports=function(t,e,n,r){var s=0,o=t.deltaAbsY()+e.deltaAbsY()+r;return 0===t._dy&&0===e._dy?(t.embedded=!0,e.embedded=!0):t._dy>e._dy?(s=t.bottom-e.y)>o&&!n||!1===t.checkCollision.down||!1===e.checkCollision.up?s=0:(t.touching.none=!1,t.touching.down=!0,e.touching.none=!1,e.touching.up=!0,e.physicsType===i.STATIC_BODY&&(t.blocked.none=!1,t.blocked.down=!0),t.physicsType===i.STATIC_BODY&&(e.blocked.none=!1,e.blocked.up=!0)):t._dy<e._dy&&(-(s=t.y-e.bottom)>o&&!n||!1===t.checkCollision.up||!1===e.checkCollision.down?s=0:(t.touching.none=!1,t.touching.up=!0,e.touching.none=!1,e.touching.down=!0,e.physicsType===i.STATIC_BODY&&(t.blocked.none=!1,t.blocked.up=!0),t.physicsType===i.STATIC_BODY&&(e.blocked.none=!1,e.blocked.down=!0))),t.overlapY=s,e.overlapY=s,s}},function(t,e,n){var i=n(367);function r(t){if(!(this instanceof r))return new r(t,[".left",".top",".right",".bottom"]);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=m(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],u(r,t.leaf?i(s):s);return r}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,n,r,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,i(t,o,e,n,s),a.push(e,o,o,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,s,o,a,u=[];e;){for(r=0,s=e.children.length;r<s;r++)o=e.children[r],p(t,a=e.leaf?i(o):o)&&(e.leaf?n.push(o):f(t,a)?this._all(o,n):u.push(o));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,s,o,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(s=e.children[i],p(t,o=e.leaf?n(s):s)){if(e.leaf||f(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,u=this.toBBox(t),l=[],c=[];a||l.length;){if(a||(a=l.pop(),i=l[l.length-1],n=c.pop(),o=!0),a.leaf&&-1!==(r=s(t,a.children,e)))return a.children.splice(r,1),l.push(a),this._condense(l),this;o||a.leaf||!f(a,u)?i?(n++,a=i.children[n],o=!1):a=null:(l.push(a),c.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=m(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=m([])).leaf=!1,r.height=i;var u,l,c,h,d=Math.ceil(s/a),f=d*Math.ceil(Math.sqrt(a));for(g(t,e,n,f,this.compareMinX),u=e;u<=n;u+=f)for(g(t,u,c=Math.min(u+f-1,n),d,this.compareMinY),l=u;l<=c;l+=d)h=Math.min(l+d-1,c),r.children.push(this._build(t,l,h,i-1));return o(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,s,o,a,u,l,c,d,f,p;i.push(e),!e.leaf&&i.length-1!==n;){for(c=d=1/0,r=0,s=e.children.length;r<s;r++)u=h(o=e.children[r]),f=t,p=o,(l=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-u)<d?(d=l,c=u<c?u:c,a=o):l===d&&u<c&&(c=u,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=n?t:(0,this.toBBox)(t),r=[],s=this._chooseSubtree(i,this.data,e,r);for(s.children.push(t),u(s,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=m(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,s,o,u,l,c,d,f,p,m,g,y,v;for(l=c=1/0,i=e;i<=n-e;i++)f=r=a(t,0,i,this.toBBox),p=s=a(t,i,n,this.toBBox),m=Math.max(f.minX,p.minX),g=Math.max(f.minY,p.minY),y=Math.min(f.maxX,p.maxX),v=Math.min(f.maxY,p.maxY),o=Math.max(0,y-m)*Math.max(0,v-g),u=h(r)+h(s),o<l?(l=o,d=i,c=u<c?u:c):o===l&&u<c&&(c=u,d=i);return d},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,s,o=this.toBBox,l=a(t,0,e,o),c=a(t,n-e,n,o),h=d(l)+d(c);for(r=e;r<n-e;r++)s=t.children[r],u(l,t.leaf?o(s):s),h+=d(l);for(r=n-e-1;r>=e;r--)s=t.children[r],u(c,t.leaf?o(s):s),h+=d(c);return h},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)u(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},compareMinX:function(t,e){return t.left-e.left},compareMinY:function(t,e){return t.top-e.top},toBBox:function(t){return{minX:t.left,minY:t.top,maxX:t.right,maxY:t.bottom}}},t.exports=r},function(t,e){t.exports=function(t,e){return!(e.right<=t.left||e.bottom<=t.top||e.position.x>=t.right||e.position.y>=t.bottom)}},function(t,e,n){var i=n(54),r=n(0),s=n(50),o=n(47),a=n(3),u=new r({initialize:function(t,e){var n=e.width?e.width:64,i=e.height?e.height:64;this.world=t,this.gameObject=e,this.debugShowBody=t.defaults.debugShowStaticBody,this.debugBodyColor=t.defaults.staticBodyDebugColor,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new a,this.position=new a(e.x-e.displayOriginX,e.y-e.displayOriginY),this.width=n,this.height=i,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center=new a(e.x+this.halfWidth,e.y+this.halfHeight),this.velocity=a.ZERO,this.allowGravity=!1,this.gravity=a.ZERO,this.bounce=a.ZERO,this.onWorldBounds=!1,this.onCollide=!1,this.onOverlap=!1,this.mass=1,this.immovable=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={none:!0,up:!1,down:!1,left:!1,right:!1},this.physicsType=s.STATIC_BODY,this._dx=0,this._dy=0},setGameObject:function(t,e){return t&&t!==this.gameObject&&(this.gameObject.body=null,t.body=this,this.gameObject=t),e&&this.updateFromGameObject(),this},updateFromGameObject:function(){this.world.staticTree.remove(this);var t=this.gameObject;return t.getTopLeft(this.position),this.width=t.displayWidth,this.height=t.displayHeight,this.halfWidth=Math.abs(this.width/2),this.halfHeight=Math.abs(this.height/2),this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.world.staticTree.insert(this),this},setOffset:function(t,e){return void 0===e&&(e=t),this.world.staticTree.remove(this),this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(t,e),this.position.x+=this.offset.x,this.position.y+=this.offset.y,this.updateCenter(),this.world.staticTree.insert(this),this},setSize:function(t,e,n){void 0===n&&(n=!0);var i=this.gameObject;if(!t&&i.frame&&(t=i.frame.realWidth),!e&&i.frame&&(e=i.frame.realHeight),this.world.staticTree.remove(this),this.width=t,this.height=e,this.halfWidth=Math.floor(t/2),this.halfHeight=Math.floor(e/2),n&&i.getCenter){var r=i.displayWidth/2,s=i.displayHeight/2;this.position.x-=this.offset.x,this.position.y-=this.offset.y,this.offset.set(r-this.halfWidth,s-this.halfHeight),this.position.x+=this.offset.x,this.position.y+=this.offset.y}return this.updateCenter(),this.isCircle=!1,this.radius=0,this.world.staticTree.insert(this),this},setCircle:function(t,e,n){return void 0===e&&(e=this.offset.x),void 0===n&&(n=this.offset.y),t>0?(this.world.staticTree.remove(this),this.isCircle=!0,this.radius=t,this.width=2*t,this.height=2*t,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.set(e,n),this.updateCenter(),this.world.staticTree.insert(this)):this.isCircle=!1,this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(t,e){var n=this.gameObject;void 0===t&&(t=n.x),void 0===e&&(e=n.y),this.world.staticTree.remove(this),n.setPosition(t,e),n.getTopLeft(this.position),this.updateCenter(),this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(t){return t.x=this.x,t.y=this.y,t.right=this.right,t.bottom=this.bottom,t},hitTest:function(t,e){return this.isCircle?i(this,t,e):o(this,t,e)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=!1,this.world.pendingDestroy.set(this)},drawDebug:function(t){var e=this.position,n=e.x+this.halfWidth,i=e.y+this.halfHeight;this.debugShowBody&&(t.lineStyle(t.defaultStrokeWidth,this.debugBodyColor,1),this.isCircle?t.strokeCircle(n,i,this.width/2):t.strokeRect(e.x,e.y,this.width,this.height))},willDrawDebug:function(){return this.debugShowBody},setMass:function(t){return t<=0&&(t=.1),this.mass=t,this},x:{get:function(){return this.position.x},set:function(t){this.world.staticTree.remove(this),this.position.x=t,this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(t){this.world.staticTree.remove(this),this.position.y=t,this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});t.exports=u},function(t,e){t.exports={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8}},function(t,e){t.exports={NONE:0,A:1,B:2,BOTH:3}},function(t,e,n){var i={};t.exports=i;var r=n(233);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(t,e){for(var n=e*e*e,r=0;r<t.length;r++){var s=t[r],o=s.speed*s.speed+s.angularSpeed*s.angularSpeed;if(0===s.force.x&&0===s.force.y){var a=Math.min(s.motion,o),u=Math.max(s.motion,o);s.motion=i._minBias*a+(1-i._minBias)*u,s.sleepThreshold>0&&s.motion<i._motionSleepThreshold*n?(s.sleepCounter+=1,s.sleepCounter>=s.sleepThreshold&&i.set(s,!0)):s.sleepCounter>0&&(s.sleepCounter-=1)}else i.set(s,!1)}},i.afterCollisions=function(t,e){for(var n=e*e*e,r=0;r<t.length;r++){var s=t[r];if(s.isActive){var o=s.collision,a=o.bodyA.parent,u=o.bodyB.parent;if(!(a.isSleeping&&u.isSleeping||a.isStatic||u.isStatic)&&(a.isSleeping||u.isSleeping)){var l=a.isSleeping&&!a.isStatic?a:u;!l.isStatic&&(l===a?u:a).motion>i._motionWakeThreshold*n&&i.set(l,!1)}}}},i.set=function(t,e){var n=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,n||r.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,n&&r.trigger(t,"sleepEnd"))}},function(t,e,n){var i=new(n(0))({initialize:function(t){this.pluginManager=t,this.game=t.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=i},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a){for(var u=i(n,r,s,o,null,a),l=0;l<u.length;l++)u[l]&&u[l].index===t&&(u[l].index=e)}},function(t,e,n){var i=n(103);t.exports=function(t,e,n){if(i(t,e,n)){var r=n.data[e][t];return null!==r&&r.index>-1}return!1}},function(t,e,n){var i=n(73),r=n(103),s=n(214);t.exports=function(t,e,n,o,a){if(void 0===n&&(n=!1),void 0===o&&(o=!0),!r(t,e,a))return null;var u=a.data[e][t];return u?(a.data[e][t]=n?null:new i(a,-1,t,e,u.width,u.height),o&&u&&u.collides&&s(t,e,a),u):null}},function(t,e,n){var i=n(31),r=n(217),s=n(458),o=n(459),a=n(470);t.exports=function(t,e,n,u,l,c){var h;switch(e){case i.ARRAY_2D:h=r(t,n,u,l,c);break;case i.CSV:h=s(t,n,u,l,c);break;case i.TILED_JSON:h=o(t,n,c);break;case i.WELTMEISTER:h=a(t,n,c);break;default:console.warn("Unrecognized tilemap data format: "+e),h=null}return h}},function(t,e,n){var i=n(31),r=n(217);t.exports=function(t,e,n,s,o){var a=e.trim().split("\n").map(function(t){return t.split(",")}),u=r(t,a,n,s,o);return u.format=i.CSV,u}},function(t,e,n){var i=n(31),r=n(105),s=n(460),o=n(462),a=n(463),u=n(466),l=n(468),c=n(469);t.exports=function(t,e,n){if("orthogonal"!==e.orientation)return console.warn("Only orthogonal map types are supported in this version of Phaser"),null;var h=new r({width:e.width,height:e.height,name:t,tileWidth:e.tilewidth,tileHeight:e.tileheight,orientation:e.orientation,format:i.TILED_JSON,version:e.version,properties:e.properties,renderOrder:e.renderorder,infinite:e.infinite});h.layers=s(e,n),h.images=o(e);var d=a(e);return h.tilesets=d.tilesets,h.imageCollections=d.imageCollections,h.objects=u(e),h.tiles=l(h),c(h),h}},function(t,e,n){var i=n(461),r=n(2),s=n(104),o=n(218),a=n(73);t.exports=function(t,e){for(var n=r(t,"infinite",!1),u=[],l=0;l<t.layers.length;l++)if("tilelayer"===t.layers[l].type){var c=t.layers[l];if(c.compression)console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+c.name+"'");else{var h,d,f,p;c.encoding&&"base64"===c.encoding&&(c.data=i(c.data),delete c.encoding);var m=[],g=0;if(n){var y=r(c,"startx",0)+c.x,v=r(c,"starty",0)+c.y;h=new s({name:c.name,x:y,y:v,width:c.width,height:c.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:c.opacity,visible:c.visible,properties:r(c,"properties",{})});for(var b=0;b<c.height;b++){m.push([null]);for(var x=0;x<c.width;x++)m[b][x]=null}for(b=0,I=c.chunks.length;b<I;b++)for(var w=c.chunks[b],T=w.x-y,S=w.y-v,E=0,O=0,C=w.data.length;O<C;O++){var _=g+T,A=E+S;(d=o(w.data[O])).gid>0?((f=new a(h,d.gid,_,A,t.tilewidth,t.tileheight)).rotation=d.rotation,f.flipX=d.flipped,m[A][_]=f):(p=e?null:new a(h,-1,_,A,t.tilewidth,t.tileheight),m[A][_]=p),++g===w.width&&(E++,g=0)}}else{h=new s({name:c.name,x:r(c,"offsetx",0)+c.x,y:r(c,"offsety",0)+c.y,width:c.width,height:c.height,tileWidth:t.tilewidth,tileHeight:t.tileheight,alpha:c.opacity,visible:c.visible,properties:r(c,"properties",{})});for(var k=[],R=0,I=c.data.length;R<I;R++)(d=o(c.data[R])).gid>0?((f=new a(h,d.gid,g,m.length,t.tilewidth,t.tileheight)).rotation=d.rotation,f.flipX=d.flipped,k.push(f)):(p=e?null:new a(h,-1,g,m.length,t.tilewidth,t.tileheight),k.push(p)),++g===c.width&&(m.push(k),g=0,k=[])}h.data=m,u.push(h)}}return u}},function(t,e){t.exports=function(t){for(var e=window.atob(t),n=e.length,i=new Array(n/4),r=0;r<n;r+=4)i[r/4]=(e.charCodeAt(r)|e.charCodeAt(r+1)<<8|e.charCodeAt(r+2)<<16|e.charCodeAt(r+3)<<24)>>>0;return i}},function(t,e,n){var i=n(2);t.exports=function(t){for(var e=[],n=0;n<t.layers.length;n++)if("imagelayer"===t.layers[n].type){var r=t.layers[n];e.push({name:r.name,image:r.image,x:i(r,"offsetx",0)+r.x,y:i(r,"offsety",0)+r.y,alpha:r.opacity,visible:r.visible,properties:i(r,"properties",{})})}return e}},function(t,e,n){var i=n(140),r=n(464),s=n(219);t.exports=function(t){for(var e,n=[],o=[],a=null,u=0;u<t.tilesets.length;u++){var l=t.tilesets[u];if(l.source)console.warn("Phaser can't load external tilesets. Use the Embed Tileset button and then export the map again.");else if(l.image){var c=new i(l.name,l.firstgid,l.tilewidth,l.tileheight,l.margin,l.spacing);if(t.version>1){if(Array.isArray(l.tiles)){for(var h={},d={},f=0;f<l.tiles.length;f++){var p=l.tiles[f];if(p.properties){var m={};p.properties.forEach(function(t){m[t.name]=t.value}),d[p.id]=m}if(p.objectgroup&&(h[p.id]={objectgroup:p.objectgroup},p.objectgroup.objects)){var g=p.objectgroup.objects.map(function(t){return s(t)});h[p.id].objectgroup.objects=g}p.animation&&(h.hasOwnProperty(p.id)?h[p.id].animation=p.animation:h[p.id]={animation:p.animation})}c.tileData=h,c.tileProperties=d}}else if(l.tileproperties&&(c.tileProperties=l.tileproperties),l.tiles)for(e in c.tileData=l.tiles,c.tileData){var y=c.tileData[e].objectgroup;if(y&&y.objects){var v=y.objects.map(function(t){return s(t)});c.tileData[e].objectgroup.objects=v}}c.updateTileData(l.imagewidth,l.imageheight),n.push(c)}else{var b=new r(l.name,l.firstgid,l.tilewidth,l.tileheight,l.margin,l.spacing,l.properties);for(e in l.tiles){var x=l.tiles[e].image,w=l.firstgid+parseInt(e,10);b.addImage(w,x)}o.push(b)}a&&(a.lastgid=l.firstgid-1),a=l}return{tilesets:n,imageCollections:o}}},function(t,e,n){var i=new(n(0))({initialize:function(t,e,n,i,r,s,o){(void 0===n||n<=0)&&(n=32),(void 0===i||i<=0)&&(i=32),void 0===r&&(r=0),void 0===s&&(s=0),this.name=t,this.firstgid=0|e,this.imageWidth=0|n,this.imageHeight=0|i,this.imageMargin=0|r,this.imageSpacing=0|s,this.properties=o||{},this.images=[],this.total=0},containsImageIndex:function(t){return t>=this.firstgid&&t<this.firstgid+this.total},addImage:function(t,e){return this.images.push({gid:t,image:e}),this.total++,this}});t.exports=i},function(t,e,n){var i=n(99);t.exports=function(t,e){for(var n={},r=0;r<e.length;r++){var s=e[r];i(t,s)&&(n[s]=t[s])}return n}},function(t,e,n){var i=n(2),r=n(219),s=n(467);t.exports=function(t){for(var e=[],n=0;n<t.layers.length;n++)if("objectgroup"===t.layers[n].type){for(var o=t.layers[n],a=i(o,"offsetx",0),u=i(o,"offsety",0),l=[],c=0;c<o.objects.length;c++){var h=r(o.objects[c],a,u);l.push(h)}var d=new s(o);d.objects=l,e.push(d)}return e}},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){void 0===t&&(t={}),this.name=r(t,"name","object layer"),this.opacity=r(t,"opacity",1),this.properties=r(t,"properties",{}),this.propertyTypes=r(t,"propertytypes",{}),this.type=r(t,"type","objectgroup"),this.visible=r(t,"visible",!0),this.objects=r(t,"objects",[])}});t.exports=s},function(t,e){t.exports=function(t){for(var e=[],n=0;n<t.tilesets.length;n++)for(var i=t.tilesets[n],r=i.tileMargin,s=i.tileMargin,o=0,a=0,u=0,l=i.firstgid;l<i.firstgid+i.total&&(e[l]=[r,s,n],r+=i.tileWidth+i.tileSpacing,++o!==i.total)&&(++a!==i.columns||(r=i.tileMargin,s+=i.tileHeight+i.tileSpacing,a=0,++u!==i.rows));l++);return e}},function(t,e,n){var i=n(16);t.exports=function(t){for(var e,n,r,s,o=0;o<t.layers.length;o++){e=t.layers[o],r=null;for(var a=0;a<e.data.length;a++){s=e.data[a];for(var u=0;u<s.length;u++)null===(n=s[u])||n.index<0||(n.width=(r=t.tilesets[t.tiles[n.index][2]]).tileWidth,n.height=r.tileHeight,r.tileProperties&&r.tileProperties[n.index-r.firstgid]&&(n.properties=i(n.properties,r.tileProperties[n.index-r.firstgid])))}}}},function(t,e,n){var i=n(31),r=n(105),s=n(471),o=n(472);t.exports=function(t,e,n){if(0===e.layer.length)return console.warn("No layers found in the Weltmeister map: "+t),null;for(var a=0,u=0,l=0;l<e.layer.length;l++)e.layer[l].width>a&&(a=e.layer[l].width),e.layer[l].height>u&&(u=e.layer[l].height);var c=new r({width:a,height:u,name:t,tileWidth:e.layer[0].tilesize,tileHeight:e.layer[0].tilesize,format:i.WELTMEISTER});return c.layers=s(e,n),c.tilesets=o(e),c}},function(t,e,n){var i=n(104),r=n(73);t.exports=function(t,e){for(var n=[],s=0;s<t.layer.length;s++){for(var o=t.layer[s],a=new i({name:o.name,width:o.width,height:o.height,tileWidth:o.tilesize,tileHeight:o.tilesize,visible:1===o.visible}),u=[],l=[],c=0;c<o.data.length;c++){for(var h=0;h<o.data[c].length;h++){var d,f=o.data[c][h]-1;d=f>-1?new r(a,f,h,c,o.tilesize,o.tilesize):e?null:new r(a,-1,h,c,o.tilesize,o.tilesize),u.push(d)}l.push(u),u=[]}a.data=l,n.push(a)}return n}},function(t,e,n){var i=n(140);t.exports=function(t){for(var e=[],n=[],r=0;r<t.layer.length;r++){var s=t.layer[r],o=s.tilesetName;""!==o&&-1===n.indexOf(o)&&(n.push(o),e.push(new i(o,0,s.tilesize,s.tilesize,0,0)))}return e}},function(t,e,n){var i=n(0),r=n(35),s=n(474),o=n(16),a=n(31),u=n(104),l=n(311),c=n(79),h=n(475),d=n(73),f=n(136),p=n(140),m=new i({initialize:function(t,e){this.scene=t,this.tileWidth=e.tileWidth,this.tileHeight=e.tileHeight,this.width=e.width,this.height=e.height,this.orientation=e.orientation,this.renderOrder=e.renderOrder,this.format=e.format,this.version=e.version,this.properties=e.properties,this.widthInPixels=e.widthInPixels,this.heightInPixels=e.heightInPixels,this.imageCollections=e.imageCollections,this.images=e.images,this.layers=e.layers,this.tilesets=e.tilesets,this.objects=e.objects,this.currentLayerIndex=0},setRenderOrder:function(t){var e=["right-down","left-down","right-up","left-up"];return"number"==typeof t&&(t=e[t]),e.indexOf(t)>-1&&(this.renderOrder=t),this},addTilesetImage:function(t,e,n,i,r,s,o){if(void 0===t)return null;if(null!=e||(e=t),!this.scene.sys.textures.exists(e))return console.warn("Invalid Tileset Image: "+e),null;var u=this.scene.sys.textures.get(e),l=this.getTilesetIndex(t);if(null===l&&this.format===a.TILED_JSON)return console.warn("No data found for Tileset: "+t),null;var c=this.tilesets[l];return c?(c.setTileSize(n,i),c.setSpacing(r,s),c.setImage(u),c):(void 0===n&&(n=this.tileWidth),void 0===i&&(i=this.tileHeight),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),(c=new p(t,o,n,i,r,s)).setImage(u),this.tilesets.push(c),c)},convertLayerToStatic:function(t){if(null===(t=this.getLayer(t)))return null;var e=t.tilemapLayer;if(!(e&&e instanceof s))return null;var n=new h(e.scene,e.tilemap,e.layerIndex,e.tileset,e.x,e.y);return this.scene.sys.displayList.add(n),e.destroy(),n},copy:function(t,e,n,i,r,s,o,a){return a=this.getLayer(a),this._isStaticCall(a,"copy")?this:null!==a?(f.Copy(t,e,n,i,r,s,o,a),this):null},createBlankDynamicLayer:function(t,e,n,i,r,o,a,l){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=this.width),void 0===o&&(o=this.height),void 0===a&&(a=this.tileWidth),void 0===l&&(l=this.tileHeight),null!==this.getLayerIndex(t))return console.warn("Invalid Tilemap Layer ID: "+t),null;for(var c,h=new u({name:t,tileWidth:a,tileHeight:l,width:r,height:o}),f=0;f<o;f++){c=[];for(var p=0;p<r;p++)c.push(new d(h,-1,p,f,a,l,this.tileWidth,this.tileHeight));h.data.push(c)}this.layers.push(h),this.currentLayerIndex=this.layers.length-1;var m=new s(this.scene,this,this.currentLayerIndex,e,n,i);return m.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(m),m},createDynamicLayer:function(t,e,n,i){var r=this.getLayerIndex(t);if(null===r)return console.warn("Invalid Tilemap Layer ID: "+t),null;var o=this.layers[r];if(o.tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=r,void 0===n&&(n=o.x),void 0===i&&(i=o.y);var a=new s(this.scene,this,r,e,n,i);return a.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(a),a},createFromObjects:function(t,e,n,i){void 0===n&&(n={}),void 0===i&&(i=this.scene);var s=this.getObjectLayer(t);if(s){for(var a=s.objects,u=[],c=0;c<a.length;c++){var h=!1,d=a[c];if((void 0!==d.gid&&"number"==typeof e&&d.gid===e||void 0!==d.id&&"number"==typeof e&&d.id===e||void 0!==d.name&&"string"==typeof e&&d.name===e)&&(h=!0),h){var f=o({},n,d.properties);f.x=d.x,f.y=d.y;var p=i.make.sprite(f);p.name=d.name,d.width&&(p.displayWidth=d.width),d.height&&(p.displayHeight=d.height);var m={x:p.originX*p.displayWidth,y:(p.originY-1)*p.displayHeight};if(d.rotation){var g=r(d.rotation);l(m,g),p.rotation=g}for(var y in p.x+=m.x,p.y+=m.y,void 0===d.flippedHorizontal&&void 0===d.flippedVertical||p.setFlip(d.flippedHorizontal,d.flippedVertical),d.visible||(p.visible=!1),d.properties)p.hasOwnProperty(y)||p.setData(y,d.properties[y]);u.push(p)}}return u}console.warn("Cannot create from object. Invalid objectgroup name given: "+t)},createFromTiles:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:f.CreateFromTiles(t,e,n,i,r,s)},createStaticLayer:function(t,e,n,i){var r=this.getLayerIndex(t);if(null===r)return console.warn("Invalid Tilemap Layer ID: "+t),null;if(this.layers[r].tilemapLayer)return console.warn("Tilemap Layer ID already exists:"+t),null;this.currentLayerIndex=r,void 0===n&&this.layers[r].x&&(n=this.layers[r].x),void 0===i&&this.layers[r].y&&(i=this.layers[r].y);var s=new h(this.scene,this,r,e,n,i);return s.setRenderOrder(this.renderOrder),this.scene.sys.displayList.add(s),s},destroy:function(){this.removeAllLayers(),this.tilesets.length=0,this.objects.length=0,this.scene=void 0},fill:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(this._isStaticCall(o,"fill")||f.Fill(t,e,n,i,r,s,o),this)},filterObjects:function(t,e,n){if("string"==typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.filter(e,n)},filterTiles:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:f.FilterTiles(t,e,n,i,r,s,o,a)},findByIndex:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.FindByIndex(t,e,n,i)},findObject:function(t,e,n){if("string"==typeof t){var i=t;if(!(t=this.getObjectLayer(t)))return console.warn("No object layer found with the name: "+i),null}return t.objects.find(e,n)||null},findTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:f.FindTile(t,e,n,i,r,s,o,a)},forEachTile:function(t,e,n,i,r,s,o,a){return null===(a=this.getLayer(a))?null:(f.ForEachTile(t,e,n,i,r,s,o,a),this)},getImageIndex:function(t){return this.getIndex(this.images,t)},getIndex:function(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return n;return null},getLayer:function(t){var e=this.getLayerIndex(t);return null!==e?this.layers[e]:null},getObjectLayer:function(t){var e=this.getIndex(this.objects,t);return null!==e?this.objects[e]:null},getLayerIndex:function(t){return void 0===t?this.currentLayerIndex:"string"==typeof t?this.getLayerIndexByName(t):"number"==typeof t&&t<this.layers.length?t:t instanceof h||t instanceof s?t.layerIndex:null},getLayerIndexByName:function(t){return this.getIndex(this.layers,t)},getTileAt:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.GetTileAt(t,e,n,i)},getTileAtWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:f.GetTileAtWorldXY(t,e,n,i,r)},getTilesWithin:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:f.GetTilesWithin(t,e,n,i,r,s)},getTilesWithinShape:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.GetTilesWithinShape(t,e,n,i)},getTilesWithinWorldXY:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:f.GetTilesWithinWorldXY(t,e,n,i,r,s,o)},getTileset:function(t){var e=this.getIndex(this.tilesets,t);return null!==e?this.tilesets[e]:null},getTilesetIndex:function(t){return this.getIndex(this.tilesets,t)},hasTileAt:function(t,e,n){return null===(n=this.getLayer(n))?null:f.HasTileAt(t,e,n)},hasTileAtWorldXY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.HasTileAtWorldXY(t,e,n,i)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(t){this.setLayer(t)}},putTileAt:function(t,e,n,i,r){return r=this.getLayer(r),this._isStaticCall(r,"putTileAt")||null===r?null:f.PutTileAt(t,e,n,i,r)},putTileAtWorldXY:function(t,e,n,i,r,s){return s=this.getLayer(s),this._isStaticCall(s,"putTileAtWorldXY")||null===s?null:f.PutTileAtWorldXY(t,e,n,i,r,s)},putTilesAt:function(t,e,n,i,r){return r=this.getLayer(r),this._isStaticCall(r,"putTilesAt")?this:null===r?null:(f.PutTilesAt(t,e,n,i,r),this)},randomize:function(t,e,n,i,r,s){return s=this.getLayer(s),this._isStaticCall(s,"randomize")?this:null===s?null:(f.Randomize(t,e,n,i,r,s),this)},calculateFacesAt:function(t,e,n){return null===(n=this.getLayer(n))?null:(f.CalculateFacesAt(t,e,n),this)},calculateFacesWithin:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(f.CalculateFacesWithin(t,e,n,i,r),this)},removeLayer:function(t){var e=this.getLayerIndex(t);return null!==e?(c(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},destroyLayer:function(t){var e=this.getLayerIndex(t);return null!==e?((t=this.layers[e]).destroy(),c(this.layers,e),this.currentLayerIndex===e&&(this.currentLayerIndex=0),this):null},removeAllLayers:function(){for(var t=this.layers,e=0;e<t.length;e++)t[e].tilemapLayer&&t[e].tilemapLayer.destroy(!1);return t.length=0,this.currentLayerIndex=0,this},removeTile:function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=!0);var i=[];Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];i.push(this.removeTileAt(s.x,s.y,!0,n,s.tilemapLayer)),e>-1&&this.putTileAt(e,s.x,s.y,n,s.tilemapLayer)}return i},removeTileAt:function(t,e,n,i,r){return r=this.getLayer(r),this._isStaticCall(r,"removeTileAt")||null===r?null:f.RemoveTileAt(t,e,n,i,r)},removeTileAtWorldXY:function(t,e,n,i,r,s){return s=this.getLayer(s),this._isStaticCall(s,"removeTileAtWorldXY")||null===s?null:f.RemoveTileAtWorldXY(t,e,n,i,r,s)},renderDebug:function(t,e,n){return null===(n=this.getLayer(n))?null:(f.RenderDebug(t,e,n),this)},renderDebugFull:function(t,e){for(var n=this.layers,i=0;i<n.length;i++)f.RenderDebug(t,e,n[i]);return this},replaceByIndex:function(t,e,n,i,r,s,o){return o=this.getLayer(o),this._isStaticCall(o,"replaceByIndex")?this:null===o?null:(f.ReplaceByIndex(t,e,n,i,r,s,o),this)},setCollision:function(t,e,n,i,r){return null===(i=this.getLayer(i))?null:(f.SetCollision(t,e,n,i,r),this)},setCollisionBetween:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:(f.SetCollisionBetween(t,e,n,i,r),this)},setCollisionByProperty:function(t,e,n,i){return null===(i=this.getLayer(i))?null:(f.SetCollisionByProperty(t,e,n,i),this)},setCollisionByExclusion:function(t,e,n,i){return null===(i=this.getLayer(i))?null:(f.SetCollisionByExclusion(t,e,n,i),this)},setCollisionFromCollisionGroup:function(t,e,n){return null===(n=this.getLayer(n))?null:(f.SetCollisionFromCollisionGroup(t,e,n),this)},setTileIndexCallback:function(t,e,n,i){return null===(i=this.getLayer(i))?null:(f.SetTileIndexCallback(t,e,n,i),this)},setTileLocationCallback:function(t,e,n,i,r,s,o){return null===(o=this.getLayer(o))?null:(f.SetTileLocationCallback(t,e,n,i,r,s,o),this)},setLayer:function(t){var e=this.getLayerIndex(t);return null!==e&&(this.currentLayerIndex=e),this},setBaseTileSize:function(t,e){this.tileWidth=t,this.tileHeight=e,this.widthInPixels=this.width*t,this.heightInPixels=this.height*e;for(var n=0;n<this.layers.length;n++){this.layers[n].baseTileWidth=t,this.layers[n].baseTileHeight=e;for(var i=this.layers[n].data,r=this.layers[n].width,s=this.layers[n].height,o=0;o<s;o++)for(var a=0;a<r;a++){var u=i[o][a];null!==u&&u.setSize(void 0,void 0,t,e)}}return this},setLayerTileSize:function(t,e,n){if(null===(n=this.getLayer(n)))return this;n.tileWidth=t,n.tileHeight=e;for(var i=n.data,r=n.width,s=n.height,o=0;o<s;o++)for(var a=0;a<r;a++){var u=i[o][a];null!==u&&u.setSize(t,e)}return this},shuffle:function(t,e,n,i,r){return r=this.getLayer(r),this._isStaticCall(r,"shuffle")?this:null===r?null:(f.Shuffle(t,e,n,i,r),this)},swapByIndex:function(t,e,n,i,r,s,o){return o=this.getLayer(o),this._isStaticCall(o,"swapByIndex")?this:null===o?null:(f.SwapByIndex(t,e,n,i,r,s,o),this)},tileToWorldX:function(t,e,n){return null===(n=this.getLayer(n))?null:f.TileToWorldX(t,e,n)},tileToWorldY:function(t,e,n){return null===(n=this.getLayer(n))?null:f.TileToWorldY(t,e,n)},tileToWorldXY:function(t,e,n,i,r){return null===(r=this.getLayer(r))?null:f.TileToWorldXY(t,e,n,i,r)},weightedRandomize:function(t,e,n,i,r,s){return s=this.getLayer(s),this._isStaticCall(s,"weightedRandomize")?this:null===s?null:(f.WeightedRandomize(t,e,n,i,r,s),this)},worldToTileX:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.WorldToTileX(t,e,n,i)},worldToTileY:function(t,e,n,i){return null===(i=this.getLayer(i))?null:f.WorldToTileY(t,e,n,i)},worldToTileXY:function(t,e,n,i,r,s){return null===(s=this.getLayer(s))?null:f.WorldToTileXY(t,e,n,i,r,s)},_isStaticCall:function(t,e){return t.tilemapLayer instanceof h&&(console.warn(e+": You cannot change the tiles in a static tilemap layer"),!0)}});t.exports=m},function(t,e,n){var i=n(0),r=n(12),s=n(1313),o=n(13),a=n(136),u=new i({Extends:o,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Depth,r.Flip,r.GetBounds,r.Origin,r.Pipeline,r.Transform,r.Visible,r.ScrollFactor,s],initialize:function(t,e,n,i,r,s){o.call(this,t,"DynamicTilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=n,this.layer=e.layers[n],this.layer.tilemapLayer=this,this.tileset=[],this.culledTiles=[],this.skipCull=!1,this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=a.CullTiles,this._renderOrder=0,this.gidMap=[],this.setTilesets(i),this.setAlpha(this.layer.alpha),this.setPosition(r,s),this.setOrigin(),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.initPipeline("TextureTintPipeline")},setTilesets:function(t){var e=[],n=[],i=this.tilemap;Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];if("string"==typeof s&&(s=i.getTileset(s)),s){n.push(s);for(var o=s.firstgid,a=0;a<s.total;a++)e[o+a]=s}}this.gidMap=e,this.tileset=n},setRenderOrder:function(t){return"string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4&&(this._renderOrder=t),this},calculateFacesAt:function(t,e){return a.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,n,i){return a.CalculateFacesWithin(t,e,n,i,this.layer),this},createFromTiles:function(t,e,n,i,r){return a.CreateFromTiles(t,e,n,i,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles,this._renderOrder)},copy:function(t,e,n,i,r,s,o){return a.Copy(t,e,n,i,r,s,o,this.layer),this},destroy:function(t){void 0===t&&(t=!0),this.tilemap&&(this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null,this.gidMap=[],this.tileset=[],o.prototype.destroy.call(this))},fill:function(t,e,n,i,r,s){return a.Fill(t,e,n,i,r,s,this.layer),this},filterTiles:function(t,e,n,i,r,s,o){return a.FilterTiles(t,e,n,i,r,s,o,this.layer)},findByIndex:function(t,e,n){return a.FindByIndex(t,e,n,this.layer)},findTile:function(t,e,n,i,r,s,o){return a.FindTile(t,e,n,i,r,s,o,this.layer)},forEachTile:function(t,e,n,i,r,s,o){return a.ForEachTile(t,e,n,i,r,s,o,this.layer),this},getTileAt:function(t,e,n){return a.GetTileAt(t,e,n,this.layer)},getTileAtWorldXY:function(t,e,n,i){return a.GetTileAtWorldXY(t,e,n,i,this.layer)},getTilesWithin:function(t,e,n,i,r){return a.GetTilesWithin(t,e,n,i,r,this.layer)},getTilesWithinShape:function(t,e,n){return a.GetTilesWithinShape(t,e,n,this.layer)},getTilesWithinWorldXY:function(t,e,n,i,r,s){return a.GetTilesWithinWorldXY(t,e,n,i,r,s,this.layer)},hasTileAt:function(t,e){return a.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,n){return a.HasTileAtWorldXY(t,e,n,this.layer)},putTileAt:function(t,e,n,i){return a.PutTileAt(t,e,n,i,this.layer)},putTileAtWorldXY:function(t,e,n,i,r){return a.PutTileAtWorldXY(t,e,n,i,r,this.layer)},putTilesAt:function(t,e,n,i){return a.PutTilesAt(t,e,n,i,this.layer),this},randomize:function(t,e,n,i,r){return a.Randomize(t,e,n,i,r,this.layer),this},removeTileAt:function(t,e,n,i){return a.RemoveTileAt(t,e,n,i,this.layer)},removeTileAtWorldXY:function(t,e,n,i,r){return a.RemoveTileAtWorldXY(t,e,n,i,r,this.layer)},renderDebug:function(t,e){return a.RenderDebug(t,e,this.layer),this},replaceByIndex:function(t,e,n,i,r,s){return a.ReplaceByIndex(t,e,n,i,r,s,this.layer),this},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},setCollision:function(t,e,n,i){return a.SetCollision(t,e,n,this.layer,i),this},setCollisionBetween:function(t,e,n,i){return a.SetCollisionBetween(t,e,n,i,this.layer),this},setCollisionByProperty:function(t,e,n){return a.SetCollisionByProperty(t,e,n,this.layer),this},setCollisionByExclusion:function(t,e,n){return a.SetCollisionByExclusion(t,e,n,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return a.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileIndexCallback:function(t,e,n){return a.SetTileIndexCallback(t,e,n,this.layer),this},setTileLocationCallback:function(t,e,n,i,r,s){return a.SetTileLocationCallback(t,e,n,i,r,s,this.layer),this},shuffle:function(t,e,n,i){return a.Shuffle(t,e,n,i,this.layer),this},swapByIndex:function(t,e,n,i,r,s){return a.SwapByIndex(t,e,n,i,r,s,this.layer),this},tileToWorldX:function(t,e){return a.TileToWorldX(t,e,this.layer)},tileToWorldY:function(t,e){return a.TileToWorldY(t,e,this.layer)},tileToWorldXY:function(t,e,n,i){return a.TileToWorldXY(t,e,n,i,this.layer)},weightedRandomize:function(t,e,n,i,r){return a.WeightedRandomize(t,e,n,i,r,this.layer),this},worldToTileX:function(t,e,n){return a.WorldToTileX(t,e,n,this.layer)},worldToTileY:function(t,e,n){return a.WorldToTileY(t,e,n,this.layer)},worldToTileXY:function(t,e,n,i,r){return a.WorldToTileXY(t,e,n,i,r,this.layer)}});t.exports=u},function(t,e,n){var i=n(0),r=n(12),s=n(17),o=n(13),a=n(1316),u=n(136),l=n(32),c=n(10),h=new i({Extends:o,Mixins:[r.Alpha,r.BlendMode,r.ComputedSize,r.Depth,r.Flip,r.GetBounds,r.Origin,r.Pipeline,r.Transform,r.Visible,r.ScrollFactor,a],initialize:function(t,e,n,i,r,a){o.call(this,t,"StaticTilemapLayer"),this.isTilemap=!0,this.tilemap=e,this.layerIndex=n,this.layer=e.layers[n],this.layer.tilemapLayer=this,this.tileset=[],this.culledTiles=[],this.skipCull=!1,this.tilesDrawn=0,this.tilesTotal=this.layer.width*this.layer.height,this.cullPaddingX=1,this.cullPaddingY=1,this.cullCallback=u.CullTiles,this.renderer=t.sys.game.renderer,this.vertexBuffer=[],this.bufferData=[],this.vertexViewF32=[],this.vertexViewU32=[],this.dirty=[],this.vertexCount=[],this._renderOrder=0,this._tempMatrix=new l,this.gidMap=[],this.setTilesets(i),this.setAlpha(this.layer.alpha),this.setPosition(r,a),this.setOrigin(),this.setSize(e.tileWidth*this.layer.width,e.tileHeight*this.layer.height),this.updateVBOData(),this.initPipeline("TextureTintPipeline"),t.sys.game.events.on(s.CONTEXT_RESTORED,function(){this.updateVBOData()},this)},setTilesets:function(t){var e=[],n=[],i=this.tilemap;Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++){var s=t[r];if("string"==typeof s&&(s=i.getTileset(s)),s){n.push(s);for(var o=s.firstgid,a=0;a<s.total;a++)e[o+a]=s}}this.gidMap=e,this.tileset=n},updateVBOData:function(){for(var t=0;t<this.tileset.length;t++)this.dirty[t]=!0,this.vertexCount[t]=0,this.vertexBuffer[t]=null,this.bufferData[t]=null,this.vertexViewF32[t]=null,this.vertexViewU32[t]=null;return this},upload:function(t,e){var n=this.renderer,i=n.gl;if(this.dirty[e]){var r,s,o,a=this.tileset[e],u=this.layer.width,l=this.layer.height,c=a.image.source[0].width,h=a.image.source[0].height,d=this.layer.data,f=this._renderOrder,p=a.firstgid,m=a.firstgid+a.total,g=this.vertexBuffer[e],y=this.bufferData[e],v=-1,b=u*l*n.pipelines.TextureTintPipeline.vertexSize*6;if(this.vertexCount[e]=0,null===y&&(y=new ArrayBuffer(b),this.bufferData[e]=y,this.vertexViewF32[e]=new Float32Array(y),this.vertexViewU32[e]=new Uint32Array(y)),0===f)for(s=0;s<l;s++)for(o=0;o<u;o++)!(r=d[s][o])||r.index<p||r.index>m||!r.visible||(v=this.batchTile(v,r,a,c,h,t,e));else if(1===f)for(s=0;s<l;s++)for(o=u-1;o>=0;o--)!(r=d[s][o])||r.index<p||r.index>m||!r.visible||(v=this.batchTile(v,r,a,c,h,t,e));else if(2===f)for(s=l-1;s>=0;s--)for(o=0;o<u;o++)!(r=d[s][o])||r.index<p||r.index>m||!r.visible||(v=this.batchTile(v,r,a,c,h,t,e));else if(3===f)for(s=l-1;s>=0;s--)for(o=u-1;o>=0;o--)!(r=d[s][o])||r.index<p||r.index>m||!r.visible||(v=this.batchTile(v,r,a,c,h,t,e));this.dirty[e]=!1,null===g?(g=n.createVertexBuffer(y,i.STATIC_DRAW),this.vertexBuffer[e]=g):(n.setVertexBuffer(g),i.bufferSubData(i.ARRAY_BUFFER,0,y))}return this},batchTile:function(t,e,n,i,r,s,o){var a=n.getTileTextureCoordinates(e.index);if(!a)return t;var u=n.tileWidth,l=n.tileHeight,h=u/2,d=l/2,f=a.x/i,p=a.y/r,m=(a.x+u)/i,g=(a.y+l)/r,y=this._tempMatrix,v=-h,b=-d;e.flipX&&(u*=-1,v+=n.tileWidth),e.flipY&&(l*=-1,b+=n.tileHeight);var x=v+u,w=b+l;y.applyITRS(h+e.pixelX,d+e.pixelY,e.rotation,1,1);var T=c.getTintAppendFloatAlpha(16777215,s.alpha*this.alpha*e.alpha),S=y.getX(v,b),E=y.getY(v,b),O=y.getX(v,w),C=y.getY(v,w),_=y.getX(x,w),A=y.getY(x,w),k=y.getX(x,b),R=y.getY(x,b);s.roundPixels&&(S=Math.round(S),E=Math.round(E),O=Math.round(O),C=Math.round(C),_=Math.round(_),A=Math.round(A),k=Math.round(k),R=Math.round(R));var I=this.vertexViewF32[o],M=this.vertexViewU32[o];return I[++t]=S,I[++t]=E,I[++t]=f,I[++t]=p,I[++t]=0,M[++t]=T,I[++t]=O,I[++t]=C,I[++t]=f,I[++t]=g,I[++t]=0,M[++t]=T,I[++t]=_,I[++t]=A,I[++t]=m,I[++t]=g,I[++t]=0,M[++t]=T,I[++t]=S,I[++t]=E,I[++t]=f,I[++t]=p,I[++t]=0,M[++t]=T,I[++t]=_,I[++t]=A,I[++t]=m,I[++t]=g,I[++t]=0,M[++t]=T,I[++t]=k,I[++t]=R,I[++t]=m,I[++t]=p,I[++t]=0,M[++t]=T,this.vertexCount[o]+=6,t},setRenderOrder:function(t){if("string"==typeof t&&(t=["right-down","left-down","right-up","left-up"].indexOf(t)),t>=0&&t<4){this._renderOrder=t;for(var e=0;e<this.tileset.length;e++)this.dirty[e]=!0}return this},calculateFacesAt:function(t,e){return u.CalculateFacesAt(t,e,this.layer),this},calculateFacesWithin:function(t,e,n,i){return u.CalculateFacesWithin(t,e,n,i,this.layer),this},createFromTiles:function(t,e,n,i,r){return u.CreateFromTiles(t,e,n,i,r,this.layer)},cull:function(t){return this.cullCallback(this.layer,t,this.culledTiles)},setSkipCull:function(t){return void 0===t&&(t=!0),this.skipCull=t,this},setCullPadding:function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.cullPaddingX=t,this.cullPaddingY=e,this},findByIndex:function(t,e,n){return u.FindByIndex(t,e,n,this.layer)},findTile:function(t,e,n,i,r,s,o){return u.FindTile(t,e,n,i,r,s,o,this.layer)},filterTiles:function(t,e,n,i,r,s,o){return u.FilterTiles(t,e,n,i,r,s,o,this.layer)},forEachTile:function(t,e,n,i,r,s,o){return u.ForEachTile(t,e,n,i,r,s,o,this.layer),this},getTileAt:function(t,e,n){return u.GetTileAt(t,e,n,this.layer)},getTileAtWorldXY:function(t,e,n,i){return u.GetTileAtWorldXY(t,e,n,i,this.layer)},getTilesWithin:function(t,e,n,i,r){return u.GetTilesWithin(t,e,n,i,r,this.layer)},getTilesWithinWorldXY:function(t,e,n,i,r,s){return u.GetTilesWithinWorldXY(t,e,n,i,r,s,this.layer)},getTilesWithinShape:function(t,e,n){return u.GetTilesWithinShape(t,e,n,this.layer)},hasTileAt:function(t,e){return u.HasTileAt(t,e,this.layer)},hasTileAtWorldXY:function(t,e,n){return u.HasTileAtWorldXY(t,e,n,this.layer)},renderDebug:function(t,e){return u.RenderDebug(t,e,this.layer),this},setCollision:function(t,e,n,i){return u.SetCollision(t,e,n,this.layer,i),this},setCollisionBetween:function(t,e,n,i){return u.SetCollisionBetween(t,e,n,i,this.layer),this},setCollisionByProperty:function(t,e,n){return u.SetCollisionByProperty(t,e,n,this.layer),this},setCollisionByExclusion:function(t,e,n){return u.SetCollisionByExclusion(t,e,n,this.layer),this},setTileIndexCallback:function(t,e,n){return u.SetTileIndexCallback(t,e,n,this.layer),this},setCollisionFromCollisionGroup:function(t,e){return u.SetCollisionFromCollisionGroup(t,e,this.layer),this},setTileLocationCallback:function(t,e,n,i,r,s){return u.SetTileLocationCallback(t,e,n,i,r,s,this.layer),this},tileToWorldX:function(t,e){return u.TileToWorldX(t,e,this.layer)},tileToWorldY:function(t,e){return u.TileToWorldY(t,e,this.layer)},tileToWorldXY:function(t,e,n,i){return u.TileToWorldXY(t,e,n,i,this.layer)},worldToTileX:function(t,e,n){return u.WorldToTileX(t,e,n,this.layer)},worldToTileY:function(t,e,n){return u.WorldToTileY(t,e,n,this.layer)},worldToTileXY:function(t,e,n,i,r){return u.WorldToTileXY(t,e,n,i,r,this.layer)},destroy:function(t){if(void 0===t&&(t=!0),this.tilemap){this.layer.tilemapLayer===this&&(this.layer.tilemapLayer=void 0),t&&this.tilemap.removeLayer(this),this.tilemap=void 0,this.layer=void 0,this.culledTiles.length=0,this.cullCallback=null;for(var e=0;e<this.tileset.length;e++)this.dirty[e]=!0,this.vertexCount[e]=0,this.vertexBuffer[e]=null,this.bufferData[e]=null,this.vertexViewF32[e]=null,this.vertexViewU32[e]=null;this.gidMap=[],this.tileset=[],o.prototype.destroy.call(this)}}});t.exports=h},function(t,e,n){var i=n(0),r=n(2),s=new i({initialize:function(t){this.delay=0,this.repeat=0,this.repeatCount=0,this.loop=!1,this.timeScale=1,this.startAt=0,this.elapsed=0,this.paused=!1,this.hasDispatched=!1,this.reset(t)},reset:function(t){return this.delay=r(t,"delay",0),this.repeat=r(t,"repeat",0),this.loop=r(t,"loop",!1),this.callback=r(t,"callback",void 0),this.callbackScope=r(t,"callbackScope",this.callback),this.args=r(t,"args",[]),this.timeScale=r(t,"timeScale",1),this.startAt=r(t,"startAt",0),this.paused=r(t,"paused",!1),this.elapsed=this.startAt,this.hasDispatched=!1,this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this},getProgress:function(){return this.elapsed/this.delay},getOverallProgress:function(){return this.repeat>0?(this.elapsed+this.delay*(this.repeat-this.repeatCount))/(this.delay+this.delay*this.repeat):this.getProgress()},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return.001*this.elapsed},remove:function(t){void 0===t&&(t=!1),this.elapsed=this.delay,this.hasDispatched=!t,this.repeatCount=0},destroy:function(){this.callback=void 0,this.callbackScope=void 0,this.args=[]}});t.exports=s},function(t,e,n){var i=n(1325);t.exports=function(t){var e,n=[];if(t.hasOwnProperty("props"))for(e in t.props)"_"!==e.substr(0,1)&&n.push({key:e,value:t.props[e]});else for(e in t)-1===i.indexOf(e)&&"_"!==e.substr(0,1)&&n.push({key:e,value:t[e]});return n}},function(t,e,n){var i=n(6);t.exports=function(t){var e=i(t,"tweens",null);return null===e?[]:("function"==typeof e&&(e=e.call()),Array.isArray(e)||(e=[e]),e)}},function(t,e,n){var i=n(223),r=n(14),s=n(88),o=n(82),a=n(141),u=n(6),l=n(222),c=n(224),h=n(226);t.exports=function(t,e,n){void 0===n&&(n=i);var d=u(e,"from",0),f=u(e,"to",1),p=[{value:d}],m=a(e,"delay",n.delay),g=a(e,"duration",n.duration),y=u(e,"easeParams",n.easeParams),v=o(u(e,"ease",n.ease),y),b=a(e,"hold",n.hold),x=a(e,"repeat",n.repeat),w=a(e,"repeatDelay",n.repeatDelay),T=s(e,"yoyo",n.yoyo),S=[],E=l("value",f),O=h(p[0],0,"value",E.getEnd,E.getStart,E.getActive,v,m,g,T,b,x,w,!1,!1);O.start=d,O.current=d,O.to=f,S.push(O);var C=new c(t,S,p);C.offset=r(e,"offset",null),C.completeDelay=r(e,"completeDelay",0),C.loop=Math.round(r(e,"loop",0)),C.loopDelay=Math.round(r(e,"loopDelay",0)),C.paused=s(e,"paused",!1),C.useFrames=s(e,"useFrames",!1);for(var _=u(e,"callbackScope",C),A=[C,null],k=c.TYPES,R=0;R<k.length;R++){var I=k[R],M=u(e,I,!1);if(M){var N=u(e,I+"Scope",_),D=u(e,I+"Params",[]);C.setCallback(I,M,A.concat(D),N)}}return C}},function(t,e,n){var i=n(66),r=n(223),s=n(14),o=n(88),a=n(82),u=n(141),l=n(221),c=n(478),h=n(6),d=n(481),f=n(142);t.exports=function(t,e){var n=new d(t),p=c(e);if(0===p.length)return n.paused=!0,n;var m=i(r);m.targets=l(e);var g=s(e,"totalDuration",0);m.duration=g>0?Math.floor(g/p.length):u(e,"duration",m.duration),m.delay=u(e,"delay",m.delay),m.easeParams=h(e,"easeParams",m.easeParams),m.ease=a(h(e,"ease",m.ease),m.easeParams),m.hold=u(e,"hold",m.hold),m.repeat=u(e,"repeat",m.repeat),m.repeatDelay=u(e,"repeatDelay",m.repeatDelay),m.yoyo=o(e,"yoyo",m.yoyo),m.flipX=o(e,"flipX",m.flipX),m.flipY=o(e,"flipY",m.flipY);for(var y=0;y<p.length;y++)n.queue(f(n,p[y],m));n.completeDelay=s(e,"completeDelay",0),n.loop=Math.round(s(e,"loop",0)),n.loopDelay=Math.round(s(e,"loopDelay",0)),n.paused=o(e,"paused",!1),n.useFrames=o(e,"useFrames",!1);var v=h(e,"callbackScope",n),b=[n],x=h(e,"onStart",!1);if(x){var w=h(e,"onStartScope",v),T=h(e,"onStartParams",[]);n.setCallback("onStart",x,b.concat(T),w)}var S=h(e,"onUpdate",!1);if(S){var E=h(e,"onUpdateScope",v),O=h(e,"onUpdateParams",[]);n.setCallback("onUpdate",S,b.concat(O),E)}var C=h(e,"onLoop",!1);if(C){var _=h(e,"onLoopScope",v),A=h(e,"onLoopParams",[]);n.setCallback("onLoop",C,b.concat(A),_)}var k=h(e,"onYoyo",!1);if(k){var R=h(e,"onYoyoScope",v),I=h(e,"onYoyoParams",[]);n.setCallback("onYoyo",k,b.concat(null,I),R)}var M=h(e,"onComplete",!1);if(M){var N=h(e,"onCompleteScope",v),D=h(e,"onCompleteParams",[]);n.setCallback("onComplete",M,b.concat(D),N)}return n}},function(t,e,n){var i=n(0),r=n(9),s=n(225),o=n(142),a=n(89),u=new i({Extends:r,initialize:function(t){r.call(this),this.manager=t,this.isTimeline=!0,this.data=[],this.totalData=0,this.useFrames=!1,this.timeScale=1,this.loop=0,this.loopDelay=0,this.loopCounter=0,this.completeDelay=0,this.countdown=0,this.state=a.PENDING_ADD,this._pausedState=a.PENDING_ADD,this.paused=!1,this.elapsed=0,this.totalElapsed=0,this.duration=0,this.progress=0,this.totalDuration=0,this.totalProgress=0,this.callbacks={onComplete:null,onLoop:null,onStart:null,onUpdate:null,onYoyo:null}},dispatchTimelineEvent:function(t,e){this.emit(t,this,this.targets),e&&(e.params[1]=this.targets,e.func.apply(e.scope,e.params))},setTimeScale:function(t){return this.timeScale=t,this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return this.state===a.ACTIVE},add:function(t){return this.queue(o(this,t))},queue:function(t){return this.isPlaying()||(t.parent=this,t.parentIsTimeline=!0,this.data.push(t),this.totalData=this.data.length),this},hasOffset:function(t){return null!==t.offset},isOffsetAbsolute:function(t){return"number"==typeof t},isOffsetRelative:function(t){if("string"==typeof t){var e=t[0];if("-"===e||"+"===e)return!0}return!1},getRelativeOffset:function(t,e){var n=t[0],i=parseFloat(t.substr(2)),r=e;switch(n){case"+":r+=i;break;case"-":r-=i}return Math.max(0,r)},calcDuration:function(){for(var t=0,e=0,n=0,i=0;i<this.totalData;i++){var r=this.data[i];r.init(),this.hasOffset(r)?this.isOffsetAbsolute(r.offset)?(r.calculatedOffset=r.offset,0===r.offset&&(n=0)):this.isOffsetRelative(r.offset)&&(r.calculatedOffset=this.getRelativeOffset(r.offset,t)):r.calculatedOffset=n,t=r.totalDuration+r.calculatedOffset,e+=r.totalDuration,n+=r.totalDuration}this.duration=e,this.loopCounter=-1===this.loop?999999999999:this.loop,this.totalDuration=this.loopCounter>0?this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.duration+this.completeDelay},init:function(){return this.calcDuration(),this.progress=0,this.totalProgress=0,!this.paused||(this.state=a.PAUSED,!1)},resetTweens:function(t){for(var e=0;e<this.totalData;e++)this.data[e].play(t)},setCallback:function(t,e,n,i){return-1!==u.TYPES.indexOf(t)&&(this.callbacks[t]={func:e,scope:i,params:n}),this},makeActive:function(t){return this.manager.makeActive(t)},play:function(){if(this.state!==a.ACTIVE){if(this.paused)return this.paused=!1,void this.manager.makeActive(this);this.resetTweens(!1),this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_START,this.callbacks.onStart)}},nextState:function(){this.loopCounter>0?(this.elapsed=0,this.progress=0,this.loopCounter--,this.resetTweens(!0),this.loopDelay>0?(this.countdown=this.loopDelay,this.state=a.LOOP_DELAY):(this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_LOOP,this.callbacks.onLoop))):this.completeDelay>0?(this.state=a.COMPLETE_DELAY,this.countdown=this.completeDelay):(this.state=a.PENDING_REMOVE,this.dispatchTimelineEvent(s.TIMELINE_COMPLETE,this.callbacks.onComplete))},update:function(t,e){if(this.state!==a.PAUSED){switch(this.useFrames&&(e=1*this.manager.timeScale),this.elapsed+=e*=this.timeScale,this.progress=Math.min(this.elapsed/this.duration,1),this.totalElapsed+=e,this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1),this.state){case a.ACTIVE:for(var n=this.totalData,i=0;i<this.totalData;i++)this.data[i].update(t,e)&&n--;this.dispatchTimelineEvent(s.TIMELINE_UPDATE,this.callbacks.onUpdate),0===n&&this.nextState();break;case a.LOOP_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=a.ACTIVE,this.dispatchTimelineEvent(s.TIMELINE_LOOP,this.callbacks.onLoop));break;case a.COMPLETE_DELAY:this.countdown-=e,this.countdown<=0&&(this.state=a.PENDING_REMOVE,this.dispatchTimelineEvent(s.TIMELINE_COMPLETE,this.callbacks.onComplete))}return this.state===a.PENDING_REMOVE}},stop:function(){this.state=a.PENDING_REMOVE},pause:function(){if(this.state!==a.PAUSED)return this.paused=!0,this._pausedState=this.state,this.state=a.PAUSED,this.emit(s.TIMELINE_PAUSE,this),this},resume:function(){return this.state===a.PAUSED&&(this.paused=!1,this.state=this._pausedState,this.emit(s.TIMELINE_RESUME,this)),this},hasTarget:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].hasTarget(t))return!0;return!1},destroy:function(){for(var t=0;t<this.data.length;t++)this.data[t].stop()}});u.TYPES=["onStart","onUpdate","onLoop","onComplete","onYoyo"],t.exports=u},function(t,e,n){var i=n(146),r=n(0),s=n(109),o=new r({initialize:function(t){this.parent=t,this.animationManager=t.scene.sys.anims,this.animationManager.once(s.REMOVE_ANIMATION,this.remove,this),this.isPlaying=!1,this.currentAnim=null,this.currentFrame=null,this.nextAnim=null,this._timeScale=1,this.frameRate=0,this.duration=0,this.msPerFrame=0,this.skipMissedFrames=!0,this._delay=0,this._repeat=0,this._repeatDelay=0,this._yoyo=!1,this.forward=!0,this._reverse=!1,this.accumulator=0,this.nextTick=0,this.repeatCounter=0,this.pendingRepeat=!1,this._paused=!1,this._wasPlaying=!1,this._pendingStop=0},chain:function(t){return t instanceof i&&(t=t.key),this.nextAnim=t,this.parent},setDelay:function(t){return void 0===t&&(t=0),this._delay=t,this.parent},getDelay:function(){return this._delay},delayedPlay:function(t,e,n){return this.play(e,!0,n),this.nextTick+=t,this.parent},getCurrentKey:function(){if(this.currentAnim)return this.currentAnim.key},load:function(t,e){return void 0===e&&(e=0),this.isPlaying&&this.stop(),this.animationManager.load(this,t,e),this.parent},pause:function(t){return this._paused||(this._paused=!0,this._wasPlaying=this.isPlaying,this.isPlaying=!1),void 0!==t&&this.updateFrame(t),this.parent},resume:function(t){return this._paused&&(this._paused=!1,this.isPlaying=this._wasPlaying),void 0!==t&&this.updateFrame(t),this.parent},isPaused:{get:function(){return this._paused}},play:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=0),t instanceof i&&(t=t.key),e&&this.isPlaying&&this.currentAnim.key===t?this.parent:(this.forward=!0,this._reverse=!1,this._startAnimation(t,n))},playReverse:function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=0),t instanceof i&&(t=t.key),e&&this.isPlaying&&this.currentAnim.key===t?this.parent:(this.forward=!1,this._reverse=!0,this._startAnimation(t,n))},_startAnimation:function(t,e){this.load(t,e);var n=this.currentAnim,i=this.parent;if(!n)return i;this.repeatCounter=-1===this._repeat?Number.MAX_VALUE:this._repeat,n.getFirstTick(this),this.isPlaying=!0,this.pendingRepeat=!1,n.showOnStart&&(i.visible=!0);var r=this.currentFrame;return n.emit(s.ANIMATION_START,n,r,i),i.emit(s.SPRITE_ANIMATION_KEY_START+t,n,r,i),i.emit(s.SPRITE_ANIMATION_START,n,r,i),i},reverse:function(){return this.isPlaying&&(this._reverse=!this._reverse,this.forward=!this.forward),this.parent},getProgress:function(){var t=this.currentFrame.progress;return this.forward||(t=1-t),t},setProgress:function(t){return this.forward||(t=1-t),this.setCurrentFrame(this.currentAnim.getFrameByProgress(t)),this.parent},remove:function(t,e){void 0===e&&(e=this.currentAnim),this.isPlaying&&e.key===this.currentAnim.key&&(this.stop(),this.setCurrentFrame(this.currentAnim.frames[0]))},getRepeat:function(){return this._repeat},setRepeat:function(t){return this._repeat=t,this.repeatCounter=-1===t?Number.MAX_VALUE:t,this.parent},getRepeatDelay:function(){return this._repeatDelay},setRepeatDelay:function(t){return this._repeatDelay=t,this.parent},restart:function(t){void 0===t&&(t=!1);var e=this.currentAnim;e.getFirstTick(this,t),this.forward=!0,this.isPlaying=!0,this.pendingRepeat=!1,this._paused=!1,this.updateFrame(e.frames[0]);var n=this.parent,i=this.currentFrame;return e.emit(s.ANIMATION_RESTART,e,i,n),n.emit(s.SPRITE_ANIMATION_KEY_RESTART+e.key,e,i,n),n.emit(s.SPRITE_ANIMATION_RESTART,e,i,n),this.parent},stop:function(){this._pendingStop=0,this.isPlaying=!1;var t=this.parent,e=this.currentAnim,n=this.currentFrame;if(e&&(e.emit(s.ANIMATION_COMPLETE,e,n,t),t.emit(s.SPRITE_ANIMATION_KEY_COMPLETE+e.key,e,n,t),t.emit(s.SPRITE_ANIMATION_COMPLETE,e,n,t)),this.nextAnim){var i=this.nextAnim;this.nextAnim=null,this.play(i)}return t},stopAfterDelay:function(t){return this._pendingStop=1,this._pendingStopValue=t,this.parent},stopOnRepeat:function(){return this._pendingStop=2,this.parent},stopOnFrame:function(t){return this._pendingStop=3,this._pendingStopValue=t,this.parent},setTimeScale:function(t){return void 0===t&&(t=1),this._timeScale=t,this.parent},getTimeScale:function(){return this._timeScale},getTotalFrames:function(){return this.currentAnim.frames.length},update:function(t,e){if(this.currentAnim&&this.isPlaying&&!this.currentAnim.paused){if(this.accumulator+=e*this._timeScale,1===this._pendingStop&&(this._pendingStopValue-=e,this._pendingStopValue<=0))return this.currentAnim.completeAnimation(this);this.accumulator>=this.nextTick&&this.currentAnim.setFrame(this)}},setCurrentFrame:function(t){var e=this.parent;return this.currentFrame=t,e.texture=t.frame.texture,e.frame=t.frame,e.isCropped&&e.frame.updateCropUVs(e._crop,e.flipX,e.flipY),e.setSizeToFrame(),t.frame.customPivot?e.setOrigin(t.frame.pivotX,t.frame.pivotY):e.updateDisplayOrigin(),e},updateFrame:function(t){var e=this.setCurrentFrame(t);if(this.isPlaying){t.setAlpha&&(e.alpha=t.alpha);var n=this.currentAnim;e.emit(s.SPRITE_ANIMATION_KEY_UPDATE+n.key,n,t,e),e.emit(s.SPRITE_ANIMATION_UPDATE,n,t,e),3===this._pendingStop&&this._pendingStopValue===t&&this.currentAnim.completeAnimation(this)}},nextFrame:function(){return this.currentAnim&&this.currentAnim.nextFrame(this),this.parent},previousFrame:function(){return this.currentAnim&&this.currentAnim.previousFrame(this),this.parent},setYoyo:function(t){return void 0===t&&(t=!1),this._yoyo=t,this.parent},getYoyo:function(){return this._yoyo},destroy:function(){this.animationManager.off(s.REMOVE_ANIMATION,this.remove,this),this.animationManager=null,this.parent=null,this.currentAnim=null,this.currentFrame=null}});t.exports=o},function(t,e,n){var i=n(484),r=n(48),s=n(0),o=n(29),a=n(485),u=n(92),l=n(32),c=new s({initialize:function(t){this.game=t,this.type=o.CANVAS,this.drawCount=0,this.width=0,this.height=0,this.config={clearBeforeRender:t.config.clearBeforeRender,backgroundColor:t.config.backgroundColor,resolution:t.config.resolution,antialias:t.config.antialias,roundPixels:t.config.roundPixels},this.gameCanvas=t.canvas,this.gameContext=this.game.config.context?this.game.config.context:this.gameCanvas.getContext("2d",{alpha:t.config.transparent,desynchronized:t.config.desynchronized}),this.currentContext=this.gameContext,this.antialias=t.config.antialias,this.blendModes=a(),this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92},this._tempMatrix1=new l,this._tempMatrix2=new l,this._tempMatrix3=new l,this._tempMatrix4=new l,this.init()},init:function(){this.game.scale.on(u.RESIZE,this.onResize,this);var t=this.game.scale.baseSize;this.resize(t.width,t.height)},onResize:function(t,e){e.width===this.width&&e.height===this.height||this.resize(e.width,e.height)},resize:function(t,e){this.width=t,this.height=e},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(t){return this.currentContext.globalCompositeOperation=t,this},setContext:function(t){return this.currentContext=t||this.gameContext,this},setAlpha:function(t){return this.currentContext.globalAlpha=t,this},preRender:function(){var t=this.gameContext,e=this.config,n=this.width,i=this.height;t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),e.clearBeforeRender&&t.clearRect(0,0,n,i),e.transparent||(t.fillStyle=e.backgroundColor.rgba,t.fillRect(0,0,n,i)),t.save(),this.drawCount=0},render:function(t,e,n,i){var s=e.list,o=s.length,a=i._cx,u=i._cy,l=i._cw,c=i._ch,h=i.renderToTexture?i.context:t.sys.context;h.save(),this.game.scene.customViewports&&(h.beginPath(),h.rect(a,u,l,c),h.clip()),this.currentContext=h;var d=i.mask;d&&d.preRenderCanvas(this,null,i._maskCamera),i.transparent||(h.fillStyle=i.backgroundColor.rgba,h.fillRect(a,u,l,c)),h.globalAlpha=i.alpha,h.globalCompositeOperation="source-over",this.drawCount+=s.length,i.renderToTexture&&i.emit(r.PRE_RENDER,i),i.matrix.copyToContext(h);for(var f=0;f<o;f++){var p=s[f];p.willRender(i)&&(p.mask&&p.mask.preRenderCanvas(this,p,i),p.renderCanvas(this,p,n,i),p.mask&&p.mask.postRenderCanvas(this,p,i))}h.setTransform(1,0,0,1,0,0),h.globalCompositeOperation="source-over",h.globalAlpha=1,i.flashEffect.postRenderCanvas(h),i.fadeEffect.postRenderCanvas(h),i.dirty=!1,d&&d.postRenderCanvas(this),h.restore(),i.renderToTexture&&(i.emit(r.POST_RENDER,i),t.sys.context.drawImage(i.canvas,a,u))},postRender:function(){this.gameContext.restore();var t=this.snapshotState;t.callback&&(i(this.gameCanvas,t),t.callback=null)},snapshotCanvas:function(t,e,n,r,s,o,a,u,l){void 0===n&&(n=!1),this.snapshotArea(r,s,o,a,e,u,l);var c=this.snapshotState;return c.getPixel=n,i(this.canvas,c),c.callback=null,this},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=Math.min(n,this.gameCanvas.width),a.height=Math.min(i,this.gameCanvas.height),this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},batchSprite:function(t,e,n,i){var r=n.alpha*t.alpha;if(0!==r){var s=this.currentContext,o=this._tempMatrix1,a=this._tempMatrix2,u=this._tempMatrix3,l=e.canvasData,c=l.x,h=l.y,d=e.cutWidth,f=e.cutHeight,p=e.customPivot,m=e.source.resolution,g=t.displayOriginX,y=t.displayOriginY,v=-g+e.x,b=-y+e.y;if(t.isCropped){var x=t._crop;x.flipX===t.flipX&&x.flipY===t.flipY||e.updateCropUVs(x,t.flipX,t.flipY),d=x.cw,f=x.ch,c=x.cx,h=x.cy,v=-g+x.x,b=-y+x.y,t.flipX&&(v>=0?v=-(v+d):v<0&&(v=Math.abs(v)-d)),t.flipY&&(b>=0?b=-(b+f):b<0&&(b=Math.abs(b)-f))}var w=1,T=1;t.flipX&&(p||(v+=2*g-e.realWidth),w=-1),t.flipY&&(p||(b+=2*y-e.realHeight),T=-1),a.applyITRS(t.x,t.y,t.rotation,t.scaleX*w,t.scaleY*T),o.copyFrom(n.matrix),i?(o.multiplyWithOffset(i,-n.scrollX*t.scrollFactorX,-n.scrollY*t.scrollFactorY),a.e=t.x,a.f=t.y,o.multiply(a,u)):(a.e-=n.scrollX*t.scrollFactorX,a.f-=n.scrollY*t.scrollFactorY,o.multiply(a,u)),s.save(),u.setToContext(s),s.globalCompositeOperation=this.blendModes[t.blendMode],s.globalAlpha=r,s.imageSmoothingEnabled=!(!this.antialias||e.source.scaleMode),s.drawImage(e.source.image,c,h,d,f,v,b,d/m,f/m),s.restore()}},destroy:function(){this.gameCanvas=null,this.gameContext=null,this.game=null}});t.exports=c},function(t,e,n){var i=n(25),r=n(33),s=n(2);t.exports=function(t,e){var n=s(e,"callback"),o=s(e,"type","image/png"),a=s(e,"encoder",.92),u=Math.abs(Math.round(s(e,"x",0))),l=Math.abs(Math.round(s(e,"y",0))),c=s(e,"width",t.width),h=s(e,"height",t.height);if(s(e,"getPixel",!1)){var d=t.getContext("2d").getImageData(u,l,1,1).data;n.call(null,new r(d[0],d[1],d[2],d[3]/255))}else if(0!==u||0!==l||c!==t.width||h!==t.height){var f=i.createWebGL(this,c,h);f.getContext("2d").drawImage(t,u,l,c,h,0,0,c,h);var p=new Image;p.onerror=function(){n.call(null),i.remove(f)},p.onload=function(){n.call(null,p),i.remove(f)},p.src=f.toDataURL(o,a)}else{var m=new Image;m.onerror=function(){n.call(null)},m.onload=function(){n.call(null,m)},m.src=t.toDataURL(o,a)}}},function(t,e,n){var i=n(52),r=n(297);t.exports=function(){var t=[],e=r.supportNewBlendModes,n="source-over";return t[i.NORMAL]=n,t[i.ADD]="lighter",t[i.MULTIPLY]=e?"multiply":n,t[i.SCREEN]=e?"screen":n,t[i.OVERLAY]=e?"overlay":n,t[i.DARKEN]=e?"darken":n,t[i.LIGHTEN]=e?"lighten":n,t[i.COLOR_DODGE]=e?"color-dodge":n,t[i.COLOR_BURN]=e?"color-burn":n,t[i.HARD_LIGHT]=e?"hard-light":n,t[i.SOFT_LIGHT]=e?"soft-light":n,t[i.DIFFERENCE]=e?"difference":n,t[i.EXCLUSION]=e?"exclusion":n,t[i.HUE]=e?"hue":n,t[i.SATURATION]=e?"saturation":n,t[i.COLOR]=e?"color":n,t[i.LUMINOSITY]=e?"luminosity":n,t[i.ERASE]="destination-out",t[i.SOURCE_IN]="source-in",t[i.SOURCE_OUT]="source-out",t[i.SOURCE_ATOP]="source-atop",t[i.DESTINATION_OVER]="destination-over",t[i.DESTINATION_IN]="destination-in",t[i.DESTINATION_OUT]="destination-out",t[i.DESTINATION_ATOP]="destination-atop",t[i.LIGHTER]="lighter",t[i.COPY]="copy",t[i.XOR]="xor",t}},function(t,e,n){var i=n(91),r=n(48),s=n(0),o=n(29),a=n(17),u=n(116),l=n(1),c=n(92),h=n(79),d=n(117),f=n(32),p=n(10),m=n(487),g=n(488),y=n(489),v=n(232),b=new s({initialize:function(t){var e=t.config;this.config={clearBeforeRender:e.clearBeforeRender,antialias:e.antialias,backgroundColor:e.backgroundColor,contextCreation:{alpha:e.transparent,desynchronized:e.desynchronized,depth:!1,antialias:e.antialiasGL,premultipliedAlpha:e.premultipliedAlpha,stencil:!0,failIfMajorPerformanceCaveat:e.failIfMajorPerformanceCaveat,powerPreference:e.powerPreference},resolution:e.resolution,roundPixels:e.roundPixels,maxTextures:e.maxTextures,maxTextureSize:e.maxTextureSize,batchSize:e.batchSize,maxLights:e.maxLights},this.game=t,this.type=o.WEBGL,this.width=0,this.height=0,this.canvas=t.canvas,this.blendModes=[],this.nativeTextures=[],this.contextLost=!1,this.pipelines=null,this.snapshotState={x:0,y:0,width:1,height:1,getPixel:!1,callback:null,type:"image/png",encoder:.92,isFramebuffer:!1,bufferWidth:0,bufferHeight:0},this.currentActiveTextureUnit=0,this.currentTextures=new Array(16),this.currentFramebuffer=null,this.currentPipeline=null,this.currentProgram=null,this.currentVertexBuffer=null,this.currentIndexBuffer=null,this.currentBlendMode=1/0,this.currentScissorEnabled=!1,this.currentScissor=null,this.scissorStack=[],this.contextLostHandler=l,this.contextRestoredHandler=l,this.gl=null,this.supportedExtensions=null,this.extensions={},this.glFormats=[],this.compression={ETC1:!1,PVRTC:!1,S3TC:!1},this.drawingBufferHeight=0,this.blankTexture=null,this.defaultCamera=new i(0,0,0,0),this._tempMatrix1=new f,this._tempMatrix2=new f,this._tempMatrix3=new f,this._tempMatrix4=new f,this.maskCount=0,this.maskStack=[],this.currentMask={mask:null,camera:null},this.currentCameraMask={mask:null,camera:null},this.glFuncMap=null,this.currentType="",this.newType=!1,this.nextTypeMatch=!1,this.init(this.config)},init:function(t){var e,n=this.game,i=this.canvas,r=t.backgroundColor;if(!(e=n.config.context?n.config.context:i.getContext("webgl",t.contextCreation)||i.getContext("experimental-webgl",t.contextCreation))||e.isContextLost())throw this.contextLost=!0,new Error("WebGL unsupported");this.gl=e;var s=this;this.contextLostHandler=function(t){s.contextLost=!0,s.game.events.emit(a.CONTEXT_LOST,s),t.preventDefault()},this.contextRestoredHandler=function(){s.contextLost=!1,s.init(s.config),s.game.events.emit(a.CONTEXT_RESTORED,s)},i.addEventListener("webglcontextlost",this.contextLostHandler,!1),i.addEventListener("webglcontextrestored",this.contextRestoredHandler,!1),n.context=e;for(var u=0;u<=27;u++)this.blendModes.push({func:[e.ONE,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_ADD});this.blendModes[1].func=[e.ONE,e.DST_ALPHA],this.blendModes[2].func=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],this.blendModes[3].func=[e.ONE,e.ONE_MINUS_SRC_COLOR],this.blendModes[17]={func:[e.ZERO,e.ONE_MINUS_SRC_ALPHA],equation:e.FUNC_REVERSE_SUBTRACT},this.glFormats[0]=e.BYTE,this.glFormats[1]=e.SHORT,this.glFormats[2]=e.UNSIGNED_BYTE,this.glFormats[3]=e.UNSIGNED_SHORT,this.glFormats[4]=e.FLOAT,this.glFuncMap={mat2:{func:e.uniformMatrix2fv,length:1,matrix:!0},mat3:{func:e.uniformMatrix3fv,length:1,matrix:!0},mat4:{func:e.uniformMatrix4fv,length:1,matrix:!0},"1f":{func:e.uniform1f,length:1},"1fv":{func:e.uniform1fv,length:1},"1i":{func:e.uniform1i,length:1},"1iv":{func:e.uniform1iv,length:1},"2f":{func:e.uniform2f,length:2},"2fv":{func:e.uniform2fv,length:1},"2i":{func:e.uniform2i,length:2},"2iv":{func:e.uniform2iv,length:1},"3f":{func:e.uniform3f,length:3},"3fv":{func:e.uniform3fv,length:1},"3i":{func:e.uniform3i,length:3},"3iv":{func:e.uniform3iv,length:1},"4f":{func:e.uniform4f,length:4},"4fv":{func:e.uniform4fv,length:1},"4i":{func:e.uniform4i,length:4},"4iv":{func:e.uniform4iv,length:1}};var l=e.getSupportedExtensions();t.maxTextures||(t.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),t.maxTextureSize||(t.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE));var c="WEBGL_compressed_texture_",h="WEBKIT_"+c;this.compression.ETC1=e.getExtension(c+"etc1")||e.getExtension(h+"etc1"),this.compression.PVRTC=e.getExtension(c+"pvrtc")||e.getExtension(h+"pvrtc"),this.compression.S3TC=e.getExtension(c+"s3tc")||e.getExtension(h+"s3tc"),this.supportedExtensions=l,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.clearColor(r.redGL,r.greenGL,r.blueGL,r.alphaGL);for(var f=0;f<this.currentTextures.length;++f)this.currentTextures[f]=null;return this.pipelines={},this.addPipeline("TextureTintPipeline",new v({game:n,renderer:this})),this.addPipeline("BitmapMaskPipeline",new g({game:n,renderer:this})),this.addPipeline("Light2D",new y({game:n,renderer:this,maxLights:t.maxLights})),this.setBlendMode(o.BlendModes.NORMAL),n.textures.once(d.READY,this.boot,this),this},boot:function(){for(var t in this.pipelines)this.pipelines[t].boot();var e=this.game.textures.getFrame("__DEFAULT");this.pipelines.TextureTintPipeline.currentFrame=e,this.blankTexture=e;var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,null),n.enable(n.SCISSOR_TEST),this.setPipeline(this.pipelines.TextureTintPipeline),this.game.scale.on(c.RESIZE,this.onResize,this);var i=this.game.scale.baseSize;this.resize(i.width,i.height,this.game.scale.resolution)},onResize:function(t,e,n,i){e.width===this.width&&e.height===this.height&&i===this.resolution||this.resize(e.width,e.height,i)},resize:function(t,e,n){var i=this.gl,r=this.pipelines;for(var s in this.width=t,this.height=e,this.resolution=n,i.viewport(0,0,t,e),r)r[s].resize(t,e,n);return this.drawingBufferHeight=i.drawingBufferHeight,i.scissor(0,i.drawingBufferHeight-e,t,e),this.defaultCamera.setSize(t,e),this},hasExtension:function(t){return!!this.supportedExtensions&&this.supportedExtensions.indexOf(t)},getExtension:function(t){return this.hasExtension(t)?(t in this.extensions||(this.extensions[t]=this.gl.getExtension(t)),this.extensions[t]):null},flush:function(){this.currentPipeline&&this.currentPipeline.flush()},hasPipeline:function(t){return t in this.pipelines},getPipeline:function(t){return this.hasPipeline(t)?this.pipelines[t]:null},removePipeline:function(t){return delete this.pipelines[t],this},addPipeline:function(t,e){return this.hasPipeline(t)?console.warn("Pipeline exists: "+t):this.pipelines[t]=e,e.name=t,this.pipelines[t].resize(this.width,this.height,this.config.resolution),e},pushScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=[t,e,n,i];return this.scissorStack.push(s),this.setScissor(t,e,n,i,r),this.currentScissor=s,s},setScissor:function(t,e,n,i,r){void 0===r&&(r=this.drawingBufferHeight);var s=this.gl,o=this.currentScissor,a=n>0&&i>0;o&&a&&(a=o[0]!==t||o[1]!==e||o[2]!==n||o[3]!==i),a&&(this.flush(),s.scissor(t,r-e-i,n,i))},popScissor:function(){var t=this.scissorStack;t.pop();var e=t[t.length-1];e&&this.setScissor(e[0],e[1],e[2],e[3]),this.currentScissor=e},setPipeline:function(t,e){return this.currentPipeline===t&&this.currentPipeline.vertexBuffer===this.currentVertexBuffer&&this.currentPipeline.program===this.currentProgram||(this.flush(),this.currentPipeline=t,this.currentPipeline.bind()),this.currentPipeline.onBind(e),this.currentPipeline},hasActiveStencilMask:function(){var t=this.currentMask.mask,e=this.currentCameraMask.mask;return t&&t.isStencil||e&&e.isStencil},rebindPipeline:function(t){var e=this.gl;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),this.hasActiveStencilMask()?e.clear(e.DEPTH_BUFFER_BIT):(e.disable(e.STENCIL_TEST),e.clear(e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)),e.viewport(0,0,this.width,this.height),this.setBlendMode(0,!0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.blankTexture.glTexture),this.currentActiveTextureUnit=0,this.currentTextures[0]=this.blankTexture.glTexture,this.currentPipeline=t,this.currentPipeline.bind(),this.currentPipeline.onBind()},clearPipeline:function(){this.flush(),this.currentPipeline=null,this.currentProgram=null,this.currentVertexBuffer=null,this.currentIndexBuffer=null,this.setBlendMode(0,!0)},setBlendMode:function(t,e){void 0===e&&(e=!1);var n=this.gl,i=this.blendModes[t];return!!(e||t!==o.BlendModes.SKIP_CHECK&&this.currentBlendMode!==t)&&(this.flush(),n.enable(n.BLEND),n.blendEquation(i.equation),i.func.length>2?n.blendFuncSeparate(i.func[0],i.func[1],i.func[2],i.func[3]):n.blendFunc(i.func[0],i.func[1]),this.currentBlendMode=t,!0)},addBlendMode:function(t,e){return this.blendModes.push({func:t,equation:e})-1},updateBlendMode:function(t,e,n){return this.blendModes[t]&&(this.blendModes[t].func=e,n&&(this.blendModes[t].equation=n)),this},removeBlendMode:function(t){return t>17&&this.blendModes[t]&&this.blendModes.splice(t,1),this},setBlankTexture:function(t){void 0===t&&(t=!1),!t&&0===this.currentActiveTextureUnit&&this.currentTextures[0]||this.setTexture2D(this.blankTexture.glTexture,0)},setTexture2D:function(t,e,n){void 0===n&&(n=!0);var i=this.gl;return t!==this.currentTextures[e]&&(n&&this.flush(),this.currentActiveTextureUnit!==e&&(i.activeTexture(i.TEXTURE0+e),this.currentActiveTextureUnit=e),i.bindTexture(i.TEXTURE_2D,t),this.currentTextures[e]=t),this},setFramebuffer:function(t,e){void 0===e&&(e=!1);var n=this.gl,i=this.width,r=this.height;return t!==this.currentFramebuffer&&(t&&t.renderTexture?(i=t.renderTexture.width,r=t.renderTexture.height):this.flush(),n.bindFramebuffer(n.FRAMEBUFFER,t),n.viewport(0,0,i,r),e&&(t?(this.drawingBufferHeight=r,this.pushScissor(0,0,i,r)):(this.drawingBufferHeight=this.height,this.popScissor())),this.currentFramebuffer=t),this},setProgram:function(t){var e=this.gl;return t!==this.currentProgram&&(this.flush(),e.useProgram(t),this.currentProgram=t),this},setVertexBuffer:function(t){var e=this.gl;return t!==this.currentVertexBuffer&&(this.flush(),e.bindBuffer(e.ARRAY_BUFFER,t),this.currentVertexBuffer=t),this},setIndexBuffer:function(t){var e=this.gl;return t!==this.currentIndexBuffer&&(this.flush(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.currentIndexBuffer=t),this},createTextureFromSource:function(t,e,n,i){var r=this.gl,s=r.NEAREST,a=r.CLAMP_TO_EDGE;return u(e=t?t.width:e,n=t?t.height:n)&&(a=r.REPEAT),i===o.ScaleModes.LINEAR&&this.config.antialias&&(s=r.LINEAR),t||"number"!=typeof e||"number"!=typeof n?this.createTexture2D(0,s,s,a,a,r.RGBA,t):this.createTexture2D(0,s,s,a,a,r.RGBA,null,e,n)},createTexture2D:function(t,e,n,i,r,s,o,a,u,l,c,h){l=null==l||l,void 0===c&&(c=!1),void 0===h&&(h=!1);var d=this.gl,f=d.createTexture();return this.setTexture2D(f,0),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,n),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,r),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,h),null==o?d.texImage2D(d.TEXTURE_2D,t,s,a,u,0,s,d.UNSIGNED_BYTE,null):(c||(a=o.width,u=o.height),d.texImage2D(d.TEXTURE_2D,t,s,s,d.UNSIGNED_BYTE,o)),this.setTexture2D(null,0),f.isAlphaPremultiplied=l,f.isRenderTexture=!1,f.width=a,f.height=u,this.nativeTextures.push(f),f},createFramebuffer:function(t,e,n,i){var r,s=this.gl,o=s.createFramebuffer();if(this.setFramebuffer(o),i){var a=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,a),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t,e),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,a)}if(n.isRenderTexture=!0,n.isAlphaPremultiplied=!1,s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),(r=s.checkFramebufferStatus(s.FRAMEBUFFER))!==s.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer incomplete. Framebuffer status: "+{36054:"Incomplete Attachment",36055:"Missing Attachment",36057:"Incomplete Dimensions",36061:"Framebuffer Unsupported"}[r]);return o.renderTexture=n,this.setFramebuffer(null),o},createProgram:function(t,e){var n=this.gl,i=n.createProgram(),r=n.createShader(n.VERTEX_SHADER),s=n.createShader(n.FRAGMENT_SHADER);if(n.shaderSource(r,t),n.shaderSource(s,e),n.compileShader(r),n.compileShader(s),!n.getShaderParameter(r,n.COMPILE_STATUS))throw new Error("Failed to compile Vertex Shader:\n"+n.getShaderInfoLog(r));if(!n.getShaderParameter(s,n.COMPILE_STATUS))throw new Error("Failed to compile Fragment Shader:\n"+n.getShaderInfoLog(s));if(n.attachShader(i,r),n.attachShader(i,s),n.linkProgram(i),!n.getProgramParameter(i,n.LINK_STATUS))throw new Error("Failed to link program:\n"+n.getProgramInfoLog(i));return i},createVertexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return this.setVertexBuffer(i),n.bufferData(n.ARRAY_BUFFER,t,e),this.setVertexBuffer(null),i},createIndexBuffer:function(t,e){var n=this.gl,i=n.createBuffer();return this.setIndexBuffer(i),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,e),this.setIndexBuffer(null),i},deleteTexture:function(t){var e=this.nativeTextures.indexOf(t);return-1!==e&&h(this.nativeTextures,e),this.gl.deleteTexture(t),this.currentTextures[0]!==t||this.game.pendingDestroy||this.setBlankTexture(!0),this},deleteFramebuffer:function(t){return this.gl.deleteFramebuffer(t),this},deleteProgram:function(t){return this.gl.deleteProgram(t),this},deleteBuffer:function(t){return this.gl.deleteBuffer(t),this},preRenderCamera:function(t){var e=t._cx,n=t._cy,i=t._cw,s=t._ch,o=this.pipelines.TextureTintPipeline,a=t.backgroundColor;if(t.renderToTexture){this.flush(),this.pushScissor(e,n,i,-s),this.setFramebuffer(t.framebuffer);var u=this.gl;u.clearColor(0,0,0,0),u.clear(u.COLOR_BUFFER_BIT),o.projOrtho(e,i+e,n,s+n,-1e3,1e3),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),a.alphaGL>0&&o.drawFillRect(e,n,i+e,s+n,p.getTintFromFloats(a.redGL,a.greenGL,a.blueGL,1),a.alphaGL),t.emit(r.PRE_RENDER,t)}else this.pushScissor(e,n,i,s),t.mask&&(this.currentCameraMask.mask=t.mask,this.currentCameraMask.camera=t._maskCamera,t.mask.preRenderWebGL(this,t,t._maskCamera)),a.alphaGL>0&&o.drawFillRect(e,n,i,s,p.getTintFromFloats(a.redGL,a.greenGL,a.blueGL,1),a.alphaGL)},getCurrentStencilMask:function(){var t=null,e=this.maskStack,n=this.currentCameraMask;return e.length>0?t=e[e.length-1]:n.mask&&n.mask.isStencil&&(t=n),t},postRenderCamera:function(t){var e=this.pipelines.TextureTintPipeline;if(t.flashEffect.postRenderWebGL(e,p.getTintFromFloats),t.fadeEffect.postRenderWebGL(e,p.getTintFromFloats),t.dirty=!1,this.popScissor(),t.renderToTexture){e.flush(),this.setFramebuffer(null),t.emit(r.POST_RENDER,t),e.projOrtho(0,e.width,e.height,0,-1e3,1e3);var n=p.getTintAppendFloatAlpha;(t.pipeline?t.pipeline:e).batchTexture(t,t.glTexture,t.width,t.height,t.x,t.y,t.width,t.height,t.zoom,t.zoom,t.rotation,t.flipX,!t.flipY,1,1,0,0,0,0,t.width,t.height,n(t._tintTL,t._alphaTL),n(t._tintTR,t._alphaTR),n(t._tintBL,t._alphaBL),n(t._tintBR,t._alphaBR),t._isTinted&&t.tintFill,0,0,this.defaultCamera,null),this.setBlankTexture(!0)}t.mask&&(this.currentCameraMask.mask=null,t.mask.postRenderWebGL(this,t._maskCamera))},preRender:function(){if(!this.contextLost){var t=this.gl,e=this.pipelines;if(t.bindFramebuffer(t.FRAMEBUFFER,null),this.config.clearBeforeRender){var n=this.config.backgroundColor;t.clearColor(n.redGL,n.greenGL,n.blueGL,n.alphaGL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}for(var i in t.enable(t.SCISSOR_TEST),e)e[i].onPreRender();this.currentScissor=[0,0,this.width,this.height],this.scissorStack=[this.currentScissor],this.game.scene.customViewports&&t.scissor(0,this.drawingBufferHeight-this.height,this.width,this.height),this.currentMask.mask=null,this.currentCameraMask.mask=null,this.maskStack.length=0,this.setPipeline(this.pipelines.TextureTintPipeline)}},render:function(t,e,n,i){if(!this.contextLost){var r=e.list,s=r.length,a=this.pipelines;for(var u in a)a[u].onRender(t,i);if(this.preRenderCamera(i),0===s)return this.setBlendMode(o.BlendModes.NORMAL),void this.postRenderCamera(i);this.currentType="";for(var l=this.currentMask,c=0;c<s;c++){var h=r[c];if(h.willRender(i)){h.blendMode!==this.currentBlendMode&&this.setBlendMode(h.blendMode);var d=h.mask;(l=this.currentMask).mask&&l.mask!==d&&l.mask.postRenderWebGL(this,l.camera),d&&l.mask!==d&&d.preRenderWebGL(this,h,i);var f=h.type;f!==this.currentType&&(this.newType=!0,this.currentType=f),this.nextTypeMatch=c<s-1&&r[c+1].type===this.currentType,h.renderWebGL(this,h,n,i),this.newType=!1}}(l=this.currentMask).mask&&l.mask.postRenderWebGL(this,l.camera),this.setBlendMode(o.BlendModes.NORMAL),this.postRenderCamera(i)}},postRender:function(){if(!this.contextLost){this.flush();var t=this.snapshotState;t.callback&&(m(this.canvas,t),t.callback=null);var e=this.pipelines;for(var n in e)e[n].onPostRender()}},snapshot:function(t,e,n){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,t,e,n)},snapshotArea:function(t,e,n,i,r,s,o){var a=this.snapshotState;return a.callback=r,a.type=s,a.encoder=o,a.getPixel=!1,a.x=t,a.y=e,a.width=Math.min(n,this.gl.drawingBufferWidth),a.height=Math.min(i,this.gl.drawingBufferHeight),this},snapshotPixel:function(t,e,n){return this.snapshotArea(t,e,1,1,n),this.snapshotState.getPixel=!0,this},snapshotFramebuffer:function(t,e,n,i,r,s,o,a,u,l,c){void 0===r&&(r=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=e),void 0===u&&(u=n);var h=this.currentFramebuffer;this.snapshotArea(s,o,a,u,i,l,c);var d=this.snapshotState;return d.getPixel=r,d.isFramebuffer=!0,d.bufferWidth=e,d.bufferHeight=n,this.setFramebuffer(t),m(this.canvas,d),this.setFramebuffer(h),d.callback=null,d.isFramebuffer=!1,this},canvasToTexture:function(t,e,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),e?this.updateCanvasTexture(t,e,i):this.createCanvasTexture(t,n,i)},createCanvasTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=t.width,s=t.height,o=i.CLAMP_TO_EDGE;!e&&u(r,s)&&(o=i.REPEAT);var a=this.config.antialias?i.LINEAR:i.NEAREST;return this.createTexture2D(0,a,a,o,o,i.RGBA,t,r,s,!0,!1,n)},updateCanvasTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.width,s=t.height;return r>0&&s>0&&(this.setTexture2D(e,0),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,this.setTexture2D(null,0)),e},createVideoTexture:function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=this.gl,r=t.videoWidth,s=t.videoHeight,o=i.CLAMP_TO_EDGE;!e&&u(r,s)&&(o=i.REPEAT);var a=this.config.antialias?i.LINEAR:i.NEAREST;return this.createTexture2D(0,a,a,o,o,i.RGBA,t,r,s,!0,!0,n)},updateVideoTexture:function(t,e,n){void 0===n&&(n=!1);var i=this.gl,r=t.videoWidth,s=t.videoHeight;return r>0&&s>0&&(this.setTexture2D(e,0),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),e.width=r,e.height=s,this.setTexture2D(null,0)),e},setTextureFilter:function(t,e){var n=this.gl,i=[n.LINEAR,n.NEAREST][e];return this.setTexture2D(t,0),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,i),this.setTexture2D(null,0),this},setFloat1:function(t,e,n){return this.setProgram(t),this.gl.uniform1f(this.gl.getUniformLocation(t,e),n),this},setFloat2:function(t,e,n,i){return this.setProgram(t),this.gl.uniform2f(this.gl.getUniformLocation(t,e),n,i),this},setFloat3:function(t,e,n,i,r){return this.setProgram(t),this.gl.uniform3f(this.gl.getUniformLocation(t,e),n,i,r),this},setFloat4:function(t,e,n,i,r,s){return this.setProgram(t),this.gl.uniform4f(this.gl.getUniformLocation(t,e),n,i,r,s),this},setFloat1v:function(t,e,n){return this.setProgram(t),this.gl.uniform1fv(this.gl.getUniformLocation(t,e),n),this},setFloat2v:function(t,e,n){return this.setProgram(t),this.gl.uniform2fv(this.gl.getUniformLocation(t,e),n),this},setFloat3v:function(t,e,n){return this.setProgram(t),this.gl.uniform3fv(this.gl.getUniformLocation(t,e),n),this},setFloat4v:function(t,e,n){return this.setProgram(t),this.gl.uniform4fv(this.gl.getUniformLocation(t,e),n),this},setInt1:function(t,e,n){return this.setProgram(t),this.gl.uniform1i(this.gl.getUniformLocation(t,e),n),this},setInt2:function(t,e,n,i){return this.setProgram(t),this.gl.uniform2i(this.gl.getUniformLocation(t,e),n,i),this},setInt3:function(t,e,n,i,r){return this.setProgram(t),this.gl.uniform3i(this.gl.getUniformLocation(t,e),n,i,r),this},setInt4:function(t,e,n,i,r,s){return this.setProgram(t),this.gl.uniform4i(this.gl.getUniformLocation(t,e),n,i,r,s),this},setMatrix2:function(t,e,n,i){return this.setProgram(t),this.gl.uniformMatrix2fv(this.gl.getUniformLocation(t,e),n,i),this},setMatrix3:function(t,e,n,i){return this.setProgram(t),this.gl.uniformMatrix3fv(this.gl.getUniformLocation(t,e),n,i),this},setMatrix4:function(t,e,n,i){return this.setProgram(t),this.gl.uniformMatrix4fv(this.gl.getUniformLocation(t,e),n,i),this},getMaxTextures:function(){return this.config.maxTextures},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){for(var t=0;t<this.nativeTextures.length;t++)this.gl.deleteTexture(this.nativeTextures[t]);for(var e in this.nativeTextures=[],this.pipelines)this.pipelines[e].destroy(),delete this.pipelines[e];this.defaultCamera.destroy(),this.currentMask=null,this.currentCameraMask=null,this.canvas.removeEventListener("webglcontextlost",this.contextLostHandler,!1),this.canvas.removeEventListener("webglcontextrestored",this.contextRestoredHandler,!1),this.game=null,this.gl=null,this.canvas=null,this.maskStack=[],this.contextLost=!0,this.extensions={}}});t.exports=b},function(t,e,n){var i=n(25),r=n(33),s=n(2);t.exports=function(t,e){var n=t.getContext("experimental-webgl"),o=s(e,"callback"),a=s(e,"type","image/png"),u=s(e,"encoder",.92),l=s(e,"x",0),c=s(e,"y",0),h=s(e,"getPixel",!1),d=s(e,"isFramebuffer",!1),f=d?s(e,"bufferWidth",1):n.drawingBufferWidth,p=d?s(e,"bufferHeight",1):n.drawingBufferHeight;if(h){var m=new Uint8Array(4);n.readPixels(l,d?c:p-c,1,1,n.RGBA,n.UNSIGNED_BYTE,m),o.call(null,new r(m[0],m[1],m[2],m[3]/255))}else{var g=s(e,"width",f),y=s(e,"height",p),v=g*y*4,b=new Uint8Array(v);n.readPixels(l,p-c-y,g,y,n.RGBA,n.UNSIGNED_BYTE,b);for(var x=i.createWebGL(this,g,y),w=x.getContext("2d"),T=w.getImageData(0,0,g,y),S=T.data,E=0;E<y;E++)for(var O=0;O<g;O++){var C=4*((y-E)*g+O),_=d?v-4*(E*g+(g-O)):4*(E*g+O);S[_+0]=b[C+0],S[_+1]=b[C+1],S[_+2]=b[C+2],S[_+3]=b[C+3]}w.putImageData(T,0,0);var A=new Image;A.onerror=function(){o.call(null),i.remove(x)},A.onload=function(){o.call(null,A),i.remove(x)},A.src=x.toDataURL(a,u)}}},function(t,e,n){var i=n(0),r=n(748),s=n(749),o=n(231),a=new i({Extends:o,initialize:function(t){o.call(this,{game:t.game,renderer:t.renderer,gl:t.renderer.gl,topology:t.topology?t.topology:t.renderer.gl.TRIANGLES,vertShader:t.vertShader?t.vertShader:s,fragShader:t.fragShader?t.fragShader:r,vertexCapacity:t.vertexCapacity?t.vertexCapacity:3,vertexSize:t.vertexSize?t.vertexSize:2*Float32Array.BYTES_PER_ELEMENT,vertices:new Float32Array([-1,1,-1,-7,7,1]).buffer,attributes:[{name:"inPosition",size:2,type:t.renderer.gl.FLOAT,normalized:!1,offset:0}]}),this.vertexViewF32=new Float32Array(this.vertexData),this.maxQuads=1,this.resolutionDirty=!0},onBind:function(){o.prototype.onBind.call(this);var t=this.renderer,e=this.program;return this.resolutionDirty&&(t.setFloat2(e,"uResolution",this.width,this.height),t.setInt1(e,"uMainSampler",0),t.setInt1(e,"uMaskSampler",1),this.resolutionDirty=!1),this},resize:function(t,e,n){return o.prototype.resize.call(this,t,e,n),this.resolutionDirty=!0,this},beginMask:function(t,e,n){var i=this.renderer,r=this.gl;t.bitmapMask&&r&&(i.flush(),t.prevFramebuffer=i.currentFramebuffer,i.setFramebuffer(t.mainFramebuffer),r.disable(r.STENCIL_TEST),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),i.currentCameraMask.mask!==t&&(i.currentMask.mask=t,i.currentMask.camera=n))},endMask:function(t,e){var n=this.gl,i=this.renderer,r=t.bitmapMask;if(r&&n){i.flush(),i.setFramebuffer(t.maskFramebuffer),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),i.setBlendMode(0,!0),r.renderWebGL(i,r,0,e),i.flush(),i.setFramebuffer(t.prevFramebuffer);var s=i.getCurrentStencilMask();s?(n.enable(n.STENCIL_TEST),s.mask.applyStencil(i,s.camera,!0)):i.currentMask.mask=null,i.setPipeline(this),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,t.maskTexture),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.mainTexture),n.uniform1i(n.getUniformLocation(this.program,"uInvertMaskAlpha"),t.invertAlpha),n.drawArrays(this.topology,0,3)}}});t.exports=a},function(t,e,n){var i=n(0),r=n(750),s=n(232),o=10,a=new i({Extends:s,initialize:function(t){t.fragShader=r.replace("%LIGHT_COUNT%",(o=t.maxLights).toString()),s.call(this,t),this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1])},boot:function(){this.defaultNormalMap=this.game.textures.getFrame("__DEFAULT")},onBind:function(t){s.prototype.onBind.call(this);var e=this.renderer,n=this.program;return this.mvpUpdate(),e.setInt1(n,"uNormSampler",1),e.setFloat2(n,"uResolution",this.width,this.height),t&&this.setNormalMap(t),this},onRender:function(t,e){this.active=!1;var n=t.sys.lights;if(!n||n.lights.length<=0||!n.active)return this;var i=n.cull(e),r=Math.min(i.length,o);if(0===r)return this;this.active=!0;var s,a=this.renderer,u=this.program,l=e.matrix,c={x:0,y:0},h=a.height;for(s=0;s<o;++s)a.setFloat1(u,"uLights["+s+"].radius",0);for(a.setFloat4(u,"uCamera",e.x,e.y,e.rotation,e.zoom),a.setFloat3(u,"uAmbientLightColor",n.ambientColor.r,n.ambientColor.g,n.ambientColor.b),s=0;s<r;++s){var d=i[s],f="uLights["+s+"].";l.transformPoint(d.x,d.y,c),a.setFloat2(u,f+"position",c.x-e.scrollX*d.scrollFactorX*e.zoom,h-(c.y-e.scrollY*d.scrollFactorY*e.zoom)),a.setFloat3(u,f+"color",d.r,d.g,d.b),a.setFloat1(u,f+"intensity",d.intensity),a.setFloat1(u,f+"radius",d.radius)}return this.currentNormalMapRotation=null,this},batchTexture:function(t,e,n,i,r,s,o,a,u,l,c,h,d,f,p,m,g,y,v,b,x,w,T,S,E,O,C,_,A,k){var R;if(this.active)if(this.renderer.setPipeline(this),t.displayTexture?R=t.displayTexture.dataSource[t.displayFrame.sourceIndex]:t.texture?R=t.texture.dataSource[t.frame.sourceIndex]:t.tileset&&(R=t.tileset.image.dataSource[0]),R){this.setTexture2D(R.glTexture,1),this.setNormalMapRotation(c);var I=this._tempMatrix1,M=this._tempMatrix2,N=this._tempMatrix3,D=y/n+C,P=v/i+_,F=(y+b)/n+C,L=(v+x)/i+_,j=o,B=a,z=-m,$=-g;if(t.isCropped){var U=t._crop;j=U.width,B=U.height,o=U.width,a=U.height;var W=y=U.x,V=v=U.y;h&&(W=b-U.x-U.width),d&&!e.isRenderTexture&&(V=x-U.y-U.height),D=W/n+C,P=V/i+_,F=(W+U.width)/n+C,L=(V+U.height)/i+_,z=-m+y,$=-g+v}h&&(j*=-1,z+=o),(d^=e.isRenderTexture?1:0)&&(B*=-1,$+=a);var Y=z+j,G=$+B;M.applyITRS(r,s,c,u,l),I.copyFrom(A.matrix),k?(I.multiplyWithOffset(k,-A.scrollX*f,-A.scrollY*p),M.e=r,M.f=s,I.multiply(M,N)):(M.e-=A.scrollX*f,M.f-=A.scrollY*p,I.multiply(M,N));var X=N.getX(z,$),H=N.getY(z,$),q=N.getX(z,G),K=N.getY(z,G),J=N.getX(Y,G),Q=N.getY(Y,G),Z=N.getX(Y,$),tt=N.getY(Y,$);A.roundPixels&&(X=Math.round(X),H=Math.round(H),q=Math.round(q),K=Math.round(K),J=Math.round(J),Q=Math.round(Q),Z=Math.round(Z),tt=Math.round(tt)),this.setTexture2D(e,0),this.batchQuad(X,H,q,K,J,Q,Z,tt,D,P,F,L,w,T,S,E,O,e,0)}else console.warn("Normal map missing or invalid")},setNormalMap:function(t){var e;this.active&&t&&(t.texture&&(e=t.texture.dataSource[t.frame.sourceIndex]),e||(e=this.defaultNormalMap),this.setTexture2D(e.glTexture,1),this.renderer.setPipeline(t.defaultPipeline))},setNormalMapRotation:function(t){if(t!==this.currentNormalMapRotation||0===this.batches.length){this.batches.length>0&&this.flush();var e=this.inverseRotationMatrix;if(t){var n=-t,i=Math.cos(n),r=Math.sin(n);e[1]=r,e[3]=-r,e[0]=e[4]=i}else e[0]=e[4]=1,e[1]=e[3]=0;this.renderer.setMatrix3(this.program,"uInverseRotationMatrix",!1,e),this.currentNormalMapRotation=t}},batchSprite:function(t,e,n){if(this.active){var i=t.texture.dataSource[t.frame.sourceIndex];i&&(this.renderer.setPipeline(this),this.setTexture2D(i.glTexture,1),this.setNormalMapRotation(t.rotation),s.prototype.batchSprite.call(this,t,e,n))}}});a.LIGHT_COUNT=o,t.exports=a},function(t,e){var n={modelMatrixDirty:!1,viewMatrixDirty:!1,projectionMatrixDirty:!1,modelMatrix:null,viewMatrix:null,projectionMatrix:null,mvpInit:function(){return this.modelMatrixDirty=!0,this.viewMatrixDirty=!0,this.projectionMatrixDirty=!0,this.modelMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this},mvpUpdate:function(){var t=this.program;return this.modelMatrixDirty&&(this.renderer.setMatrix4(t,"uModelMatrix",!1,this.modelMatrix),this.modelMatrixDirty=!1),this.viewMatrixDirty&&(this.renderer.setMatrix4(t,"uViewMatrix",!1,this.viewMatrix),this.viewMatrixDirty=!1),this.projectionMatrixDirty&&(this.renderer.setMatrix4(t,"uProjectionMatrix",!1,this.projectionMatrix),this.projectionMatrixDirty=!1),this},modelIdentity:function(){var t=this.modelMatrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this.modelMatrixDirty=!0,this},modelScale:function(t,e,n){var i=this.modelMatrix;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this.modelMatrixDirty=!0,this},modelTranslate:function(t,e,n){var i=this.modelMatrix;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this.modelMatrixDirty=!0,this},modelRotateX:function(t){var e=this.modelMatrix,n=Math.sin(t),i=Math.cos(t),r=e[4],s=e[5],o=e[6],a=e[7],u=e[8],l=e[9],c=e[10],h=e[11];return e[4]=r*i+u*n,e[5]=s*i+l*n,e[6]=o*i+c*n,e[7]=a*i+h*n,e[8]=u*i-r*n,e[9]=l*i-s*n,e[10]=c*i-o*n,e[11]=h*i-a*n,this.modelMatrixDirty=!0,this},modelRotateY:function(t){var e=this.modelMatrix,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[8],l=e[9],c=e[10],h=e[11];return e[0]=r*i-u*n,e[1]=s*i-l*n,e[2]=o*i-c*n,e[3]=a*i-h*n,e[8]=r*n+u*i,e[9]=s*n+l*i,e[10]=o*n+c*i,e[11]=a*n+h*i,this.modelMatrixDirty=!0,this},modelRotateZ:function(t){var e=this.modelMatrix,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[4],l=e[5],c=e[6],h=e[7];return e[0]=r*i+u*n,e[1]=s*i+l*n,e[2]=o*i+c*n,e[3]=a*i+h*n,e[4]=u*i-r*n,e[5]=l*i-s*n,e[6]=c*i-o*n,e[7]=h*i-a*n,this.modelMatrixDirty=!0,this},viewIdentity:function(){var t=this.viewMatrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this.viewMatrixDirty=!0,this},viewScale:function(t,e,n){var i=this.viewMatrix;return i[0]=i[0]*t,i[1]=i[1]*t,i[2]=i[2]*t,i[3]=i[3]*t,i[4]=i[4]*e,i[5]=i[5]*e,i[6]=i[6]*e,i[7]=i[7]*e,i[8]=i[8]*n,i[9]=i[9]*n,i[10]=i[10]*n,i[11]=i[11]*n,this.viewMatrixDirty=!0,this},viewTranslate:function(t,e,n){var i=this.viewMatrix;return i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this.viewMatrixDirty=!0,this},viewRotateX:function(t){var e=this.viewMatrix,n=Math.sin(t),i=Math.cos(t),r=e[4],s=e[5],o=e[6],a=e[7],u=e[8],l=e[9],c=e[10],h=e[11];return e[4]=r*i+u*n,e[5]=s*i+l*n,e[6]=o*i+c*n,e[7]=a*i+h*n,e[8]=u*i-r*n,e[9]=l*i-s*n,e[10]=c*i-o*n,e[11]=h*i-a*n,this.viewMatrixDirty=!0,this},viewRotateY:function(t){var e=this.viewMatrix,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[8],l=e[9],c=e[10],h=e[11];return e[0]=r*i-u*n,e[1]=s*i-l*n,e[2]=o*i-c*n,e[3]=a*i-h*n,e[8]=r*n+u*i,e[9]=s*n+l*i,e[10]=o*n+c*i,e[11]=a*n+h*i,this.viewMatrixDirty=!0,this},viewRotateZ:function(t){var e=this.viewMatrix,n=Math.sin(t),i=Math.cos(t),r=e[0],s=e[1],o=e[2],a=e[3],u=e[4],l=e[5],c=e[6],h=e[7];return e[0]=r*i+u*n,e[1]=s*i+l*n,e[2]=o*i+c*n,e[3]=a*i+h*n,e[4]=u*i-r*n,e[5]=l*i-s*n,e[6]=c*i-o*n,e[7]=h*i-a*n,this.viewMatrixDirty=!0,this},viewLoad2D:function(t){var e=this.viewMatrix;return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=0,e[4]=t[2],e[5]=t[3],e[6]=0,e[7]=0,e[8]=t[4],e[9]=t[5],e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this.viewMatrixDirty=!0,this},viewLoad:function(t){var e=this.viewMatrix;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this.viewMatrixDirty=!0,this},projIdentity:function(){var t=this.projectionMatrix;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this.projectionMatrixDirty=!0,this},projOrtho:function(t,e,n,i,r,s){var o=this.projectionMatrix,a=1/(t-e),u=1/(n-i),l=1/(r-s);return o[0]=-2*a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*u,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*l,o[11]=0,o[12]=(t+e)*a,o[13]=(i+n)*u,o[14]=(s+r)*l,o[15]=1,this.projectionMatrixDirty=!0,this},projPersp:function(t,e,n,i){var r=this.projectionMatrix,s=1/Math.tan(t/2),o=1/(n-i);return r[0]=s/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(i+n)*o,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*i*n*o,r[15]=0,this.projectionMatrixDirty=!0,this}};t.exports=n},function(t,e,n){t.exports={Bounce:n(1398),Collision:n(1399),Force:n(1400),Friction:n(1401),Gravity:n(1402),Mass:n(1403),Static:n(1404),Sensor:n(1405),SetBody:n(1406),Sleep:n(1407),Transform:n(1420),Velocity:n(1421)}},function(t,e){var n={};t.exports=n,n.create=function(t,e){var i=t.bodyA,r=t.bodyB,s={id:n.id(i,r),bodyA:i,bodyB:r,activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:i.isSensor||r.isSensor,timeCreated:e,timeUpdated:e,collision:null,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return n.update(s,t,e),s},n.update=function(t,e,i){if(t.collision=e,e.collided){var r=e.supports,s=t.activeContacts,o=e.parentA,a=e.parentB;t.inverseMass=o.inverseMass+a.inverseMass,t.friction=Math.min(o.friction,a.friction),t.frictionStatic=Math.max(o.frictionStatic,a.frictionStatic),t.restitution=Math.max(o.restitution,a.restitution),t.slop=Math.max(o.slop,a.slop);for(var u=0;u<r.length;u++)s[u]=r[u].contact;var l=r.length;l<s.length&&(s.length=l),t.separation=e.depth,n.setActive(t,!0,i)}else!0===t.isActive&&n.setActive(t,!1,i)},n.setActive=function(t,e,n){e?(t.isActive=!0,t.timeUpdated=n):(t.isActive=!1,t.activeContacts.length=0)},n.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}},function(t,e,n){n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501)},function(t,e){Array.prototype.forEach||(Array.prototype.forEach=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var i=arguments.length>=2?arguments[1]:void 0,r=0;r<n;r++)r in e&&t.call(i,e[r],r,e)})},function(t,e){Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})},function(t,e){!function(){function t(t){t&&(t.setTargetAtTime||(t.setTargetAtTime=t.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var e=this.internal_createGain();return t(e.gain),e},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(e){var n=e?this.internal_createDelay(e):this.internal_createDelay();return t(n.delayTime),n},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();return e.start?(e.internal_start=e.start,e.start=function(t,n,i){void 0!==i?e.internal_start(t||0,n,i):e.internal_start(t||0,n||0)}):e.start=function(t,e,n){e||n?this.noteGrainOn(t||0,e,n):this.noteOn(t||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(t){this.noteOff(t||0)},t(e.playbackRate),e},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();return t(e.threshold),t(e.knee),t(e.ratio),t(e.reduction),t(e.attack),t(e.release),e},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();return t(e.frequency),t(e.detune),t(e.Q),t(e.gain),e},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start?(e.internal_start=e.start,e.start=function(t){e.internal_start(t||0)}):e.start=function(t){this.noteOn(t||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(t){this.noteOff(t||0)},e.setPeriodicWave||(e.setPeriodicWave=e.setWaveTable),t(e.frequency),t(e.detune),e})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}()},function(t,e){window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){})},function(t,e){Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)})},function(t,e){!function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}()},function(t,e,n){(function(t){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!t.performance||!t.performance.now){var e=Date.now();t.performance||(t.performance={}),t.performance.now=function(){return Date.now()-e}}for(var n=Date.now(),i=["ms","moz","webkit","o"],r=0;r<i.length&&!t.requestAnimationFrame;++r)t.requestAnimationFrame=t[i[r]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[r]+"CancelAnimationFrame"]||t[i[r]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+n-e;return i<0&&(i=0),n=e,setTimeout(function(){n=Date.now(),t(performance.now())},i)}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}).call(this,n(227))},function(t,e){if("function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array){var n=function(t){var e=new Array;window[t]=function(t){if("number"==typeof t){Array.call(this,t),this.length=t;for(var e=0;e<this.length;e++)this[e]=0}else for(Array.call(this,t.length),this.length=t.length,e=0;e<this.length;e++)this[e]=t[e]},window[t].prototype=e,window[t].constructor=window[t]};n("Float32Array"),n("Uint32Array"),n("Uint16Array"),n("Int16Array"),n("ArrayBuffer")}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"angle",e,n,r,s)}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++)e.call(n,t[i]);return t}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=n;i<t.length;i++){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},function(t,e){t.exports=function(t,e,n){void 0===n&&(n=0);for(var i=n;i<t.length;i++){var r=t[i],s=!0;for(var o in e)r[o]!==e[o]&&(s=!1);if(s)return r}return null}},function(t,e,n){var i=n(236),r=n(143),s=n(2),o=n(1),a=new(n(108))({sys:{queueDepthSort:o,events:{once:o}}},0,0,1,1);t.exports=function(t,e){void 0===e&&(e={});var n=s(e,"width",-1),o=s(e,"height",-1),u=s(e,"cellWidth",1),l=s(e,"cellHeight",u),c=s(e,"position",r.TOP_LEFT),h=s(e,"x",0),d=s(e,"y",0),f=0,p=0,m=n*u,g=o*l;a.setPosition(h,d),a.setSize(u,l);for(var y=0;y<t.length;y++)if(i(t[y],a,c),-1===n)p+=l,a.y+=l,p===g&&(p=0,a.x+=u,a.y=d);else if(-1===o)f+=u,a.x+=u,f===m&&(f=0,a.x=h,a.y+=l);else if(f+=u,a.x+=u,f===m&&(f=0,p+=l,a.x=h,a.y+=l,p===g))break;return t}},function(t,e){t.exports="add"},function(t,e){t.exports="complete"},function(t,e){t.exports="repeat"},function(t,e){t.exports="restart"},function(t,e){t.exports="start"},function(t,e){t.exports="pauseall"},function(t,e){t.exports="remove"},function(t,e){t.exports="resumeall"},function(t,e){t.exports="animationcomplete"},function(t,e){t.exports="animationcomplete-"},function(t,e){t.exports="animationrepeat-"},function(t,e){t.exports="animationrestart-"},function(t,e){t.exports="animationstart-"},function(t,e){t.exports="animationupdate-"},function(t,e){t.exports="animationrepeat"},function(t,e){t.exports="animationrestart"},function(t,e){t.exports="animationstart"},function(t,e){t.exports="animationupdate"},function(t,e){t.exports={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(t){this.scaleX=t/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(t){this.scaleY=t/this.height}},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){t.exports={flipX:!1,flipY:!1,toggleFlipX:function(){return this.flipX=!this.flipX,this},toggleFlipY:function(){return this.flipY=!this.flipY,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this}}},function(t,e,n){var i=n(11),r=n(257),s=n(3),o={prepareBoundsOutput:function(t,e){return void 0===e&&(e=!1),0!==this.rotation&&r(t,this.x,this.y,this.rotation),e&&this.parentContainer&&this.parentContainer.getBoundsTransformMatrix().transformPoint(t.x,t.y,t),t},getCenter:function(t){return void 0===t&&(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,t},getTopLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getTopRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY,this.prepareBoundsOutput(t,e)},getLeftCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getRightCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight/2,this.prepareBoundsOutput(t,e)},getBottomLeft:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomCenter:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth/2,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBottomRight:function(t,e){return t||(t=new s),t.x=this.x-this.displayWidth*this.originX+this.displayWidth,t.y=this.y-this.displayHeight*this.originY+this.displayHeight,this.prepareBoundsOutput(t,e)},getBounds:function(t){var e,n,r,s,o,a,u,l;if(void 0===t&&(t=new i),this.parentContainer){var c=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(t),c.transformPoint(t.x,t.y,t),e=t.x,n=t.y,this.getTopRight(t),c.transformPoint(t.x,t.y,t),r=t.x,s=t.y,this.getBottomLeft(t),c.transformPoint(t.x,t.y,t),o=t.x,a=t.y,this.getBottomRight(t),c.transformPoint(t.x,t.y,t),u=t.x,l=t.y}else this.getTopLeft(t),e=t.x,n=t.y,this.getTopRight(t),r=t.x,s=t.y,this.getBottomLeft(t),o=t.x,a=t.y,this.getBottomRight(t),u=t.x,l=t.y;return t.x=Math.min(e,r,o,u),t.y=Math.min(n,s,a,l),t.width=Math.max(e,r,o,u)-t.x,t.height=Math.max(n,s,a,l)-t.y,t}};t.exports=o},function(t,e){t.exports="blur"},function(t,e){t.exports="boot"},function(t,e){t.exports="contextlost"},function(t,e){t.exports="contextrestored"},function(t,e){t.exports="destroy"},function(t,e){t.exports="focus"},function(t,e){t.exports="hidden"},function(t,e){t.exports="pause"},function(t,e){t.exports="postrender"},function(t,e){t.exports="poststep"},function(t,e){t.exports="prerender"},function(t,e){t.exports="prestep"},function(t,e){t.exports="ready"},function(t,e){t.exports="resume"},function(t,e){t.exports="step"},function(t,e){t.exports="visible"},function(t,e){t.exports={_originComponent:!0,originX:.5,originY:.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(t){this._displayOriginX=t,this.originX=t/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(t){this._displayOriginY=t,this.originY=t/this.height}},setOrigin:function(t,e){return void 0===t&&(t=.5),void 0===e&&(e=t),this.originX=t,this.originY=e,this.updateDisplayOrigin()},setOriginFromFrame:function(){return this.frame&&this.frame.customPivot?(this.originX=this.frame.pivotX,this.originY=this.frame.pivotY,this.updateDisplayOrigin()):this.setOrigin()},setDisplayOrigin:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.displayOriginX=t,this.displayOriginY=e,this},updateDisplayOrigin:function(){return this._displayOriginX=this.originX*this.width,this._displayOriginY=this.originY*this.height,this}}},function(t,e,n){var i=n(35),r=n(88),s=n(6),o=n(89),a=n(3),u={path:null,rotateToPath:!1,pathRotationOffset:0,pathOffset:null,pathVector:null,pathTween:null,pathConfig:null,_prevDirection:o.PLAYING_FORWARD,setPath:function(t,e){void 0===e&&(e=this.pathConfig);var n=this.pathTween;return n&&n.isPlaying()&&n.stop(),this.path=t,e&&this.startFollow(e),this},setRotateToPath:function(t,e){return void 0===e&&(e=0),this.rotateToPath=t,this.pathRotationOffset=e,this},isFollowing:function(){var t=this.pathTween;return t&&t.isPlaying()},startFollow:function(t,e){void 0===t&&(t={}),void 0===e&&(e=0);var n=this.pathTween;n&&n.isPlaying()&&n.stop(),"number"==typeof t&&(t={duration:t}),t.from=s(t,"from",0),t.to=s(t,"to",1);var u=r(t,"positionOnPath",!1);this.rotateToPath=r(t,"rotateToPath",!1),this.pathRotationOffset=s(t,"rotationOffset",0);var l=s(t,"startAt",e);if(l&&(t.onStart=function(t){var e=t.data[0];e.progress=l,e.elapsed=e.duration*l;var n=e.ease(e.progress);e.current=e.start+(e.end-e.start)*n,e.target[e.key]=e.current}),this.pathOffset||(this.pathOffset=new a(this.x,this.y)),this.pathVector||(this.pathVector=new a),this.pathTween=this.scene.sys.tweens.addCounter(t),this.path.getStartPoint(this.pathOffset),u&&(this.x=this.pathOffset.x,this.y=this.pathOffset.y),this.pathOffset.x=this.x-this.pathOffset.x,this.pathOffset.y=this.y-this.pathOffset.y,this._prevDirection=o.PLAYING_FORWARD,this.rotateToPath){var c=this.path.getPoint(.1);this.rotation=Math.atan2(c.y-this.y,c.x-this.x)+i(this.pathRotationOffset)}return this.pathConfig=t,this},pauseFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.pause(),this},resumeFollow:function(){var t=this.pathTween;return t&&t.isPaused()&&t.resume(),this},stopFollow:function(){var t=this.pathTween;return t&&t.isPlaying()&&t.stop(),this},pathUpdate:function(){var t=this.pathTween;if(t){var e=t.data[0];if(e.state!==o.PLAYING_FORWARD&&e.state!==o.PLAYING_BACKWARD)return;var n=this.pathVector;this.path.getPoint(t.getValue(),n),n.add(this.pathOffset);var r=this.x,s=this.y;this.setPosition(n.x,n.y);var a=this.x-r,u=this.y-s;if(0===a&&0===u)return;if(e.state!==this._prevDirection)return void(this._prevDirection=e.state);this.rotateToPath&&(this.rotation=Math.atan2(u,a)+i(this.pathRotationOffset))}}};t.exports=u},function(t,e){var n={_sizeComponent:!0,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(t){this.scaleX=t/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(t){this.scaleY=t/this.frame.realHeight}},setSizeToFrame:function(t){return void 0===t&&(t=this.frame),this.width=t.realWidth,this.height=t.realHeight,this},setSize:function(t,e){return this.width=t,this.height=e,this},setDisplaySize:function(t,e){return this.displayWidth=t,this.displayHeight=e,this}};t.exports=n},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this}}},function(t,e){t.exports={texture:null,frame:null,isCropped:!1,setCrop:function(t,e,n,i){return void 0===t?this.isCropped=!1:this.frame&&("number"==typeof t?this.frame.setCropUVs(this._crop,t,e,n,i,this.flipX,this.flipY):this.frame.setCropUVs(this._crop,t.x,t.y,t.width,t.height,this.flipX,this.flipY),this.isCropped=!0),this},setTexture:function(t,e){return this.texture=this.scene.sys.textures.get(t),this.setFrame(e)},setFrame:function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=!0),this.frame=this.texture.get(t),this.frame.cutWidth&&this.frame.cutHeight?this.renderFlags|=8:this.renderFlags&=-9,this._sizeComponent&&e&&this.setSizeToFrame(),this._originComponent&&n&&(this.frame.customPivot?this.setOrigin(this.frame.pivotX,this.frame.pivotY):this.updateDisplayOrigin()),this.isCropped&&this.frame.updateCropUVs(this._crop,this.flipX,this.flipY),this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:!1,flipY:!1,cx:0,cy:0,cw:0,ch:0}}}},function(t,e){var n=function(t){return(t>>16)+(65280&t)+((255&t)<<16)},i={_tintTL:16777215,_tintTR:16777215,_tintBL:16777215,_tintBR:16777215,_isTinted:!1,tintFill:!1,clearTint:function(){return this.setTint(16777215),this._isTinted=!1,this},setTint:function(t,e,i,r){return void 0===t&&(t=16777215),void 0===e&&(e=t,i=t,r=t),this._tintTL=n(t),this._tintTR=n(e),this._tintBL=n(i),this._tintBR=n(r),this._isTinted=!0,this.tintFill=!1,this},setTintFill:function(t,e,n,i){return this.setTint(t,e,n,i),this.tintFill=!0,this},tintTopLeft:{get:function(){return this._tintTL},set:function(t){this._tintTL=n(t),this._isTinted=!0}},tintTopRight:{get:function(){return this._tintTR},set:function(t){this._tintTR=n(t),this._isTinted=!0}},tintBottomLeft:{get:function(){return this._tintBL},set:function(t){this._tintBL=n(t),this._isTinted=!0}},tintBottomRight:{get:function(){return this._tintBR},set:function(t){this._tintBR=n(t),this._isTinted=!0}},tint:{set:function(t){this.setTint(t,t,t,t)}},isTinted:{get:function(){return this._isTinted}}};t.exports=i},function(t,e){t.exports="changedata"},function(t,e){t.exports="changedata-"},function(t,e){t.exports="removedata"},function(t,e){t.exports="setdata"},function(t,e){t.exports="destroy"},function(t,e){t.exports="complete"},function(t,e){t.exports="created"},function(t,e){t.exports="error"},function(t,e){t.exports="loop"},function(t,e){t.exports="play"},function(t,e){t.exports="seeked"},function(t,e){t.exports="seeking"},function(t,e){t.exports="stop"},function(t,e){t.exports="timeout"},function(t,e){t.exports="unlocked"},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s,o,a){return null!=n||(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=0;o<t.length;o++)t[o].x=e.x+e.radius*Math.cos(r),t[o].y=e.y+e.radius*Math.sin(r),r+=s;return t}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=6.28);for(var r=n,s=(i-n)/t.length,o=e.width/2,a=e.height/2,u=0;u<t.length;u++)t[u].x=e.x+o*Math.cos(r),t[u].y=e.y+a*Math.sin(r),r+=s;return t}},function(t,e,n){var i=n(148);t.exports=function(t,e){for(var n=i(e,t.length),r=0;r<t.length;r++){var s=t[r],o=n[r];s.x=o.x,s.y=o.y}return t}},function(t,e,n){var i=n(266),r=n(267),s=n(268);t.exports=function(t,e,n){void 0===n&&(n=0);var o=i(e,!1,t.length);n>0?r(o,n):n<0&&s(o,Math.abs(n));for(var a=0;a<t.length;a++)t[a].x=o[a].x,t[a].y=o[a].y;return t}},function(t,e,n){var i=n(269);t.exports=function(t,e,n){var r=i({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},n),s=i({x1:e.x2,y1:e.y2,x2:e.x3,y2:e.y3},n),o=i({x1:e.x3,y1:e.y3,x2:e.x1,y2:e.y1},n);r.pop(),s.pop(),o.pop();for(var a=(r=r.concat(s,o)).length/t.length,u=0,l=0;l<t.length;l++){var c=t[l],h=r[Math.floor(u)];c.x=h.x,c.y=h.y,u+=a}return t}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++)t[i].anims.play(e,n);return t}},function(t,e,n){var i=n(145);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(152);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(149);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(150);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(153);t.exports=function(t,e){for(var n=0;n<t.length;n++)i(e,t[n]);return t}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},function(t,e,n){var i=n(154),r=n(58);t.exports=function(t,e,n){for(var s=e.x,o=e.y,a=0;a<t.length;a++){var u=t[a];i(u,s,o,n,Math.max(1,r(u.x,u.y,s,o)))}return t}},function(t,e,n){var i=n(154);t.exports=function(t,e,n,r){var s=e.x,o=e.y;if(0===r)return t;for(var a=0;a<t.length;a++)i(t[a],s,o,n,r);return t}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s,o,a){return null!=n||(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},function(t,e,n){var i=n(34);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"alpha",e,n,r,s)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r){return i(t,"blendMode",e,0,n,r)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"depth",e,n,r,s)}},function(t,e){t.exports=function(t,e,n){for(var i=0;i<t.length;i++)t[i].setInteractive(e,n);return t}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s,o,a){return null!=n||(n=e),i(t,"originX",e,r,o,a),i(t,"originY",n,s,o,a)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"rotation",e,n,r,s)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s,o,a){return null!=n||(n=e),i(t,"scaleX",e,r,o,a),i(t,"scaleY",n,s,o,a)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"scaleX",e,n,r,s)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"scaleY",e,n,r,s)}},function(t,e){t.exports=function(t,e,n,i,r){for(var s=0;s<t.length;s++)t[s].setTint(e,n,i,r);return t}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r){return i(t,"visible",e,0,n,r)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"x",e,n,r,s)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s,o,a){return null!=n||(n=e),i(t,"x",e,r,o,a),i(t,"y",n,s,o,a)}},function(t,e,n){var i=n(28);t.exports=function(t,e,n,r,s){return i(t,"y",e,n,r,s)}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r,s){var o,a,u,l,c,h;if(void 0===r&&(r=0),void 0===s&&(s=new i),t.length>1)if(0===r){var d=t.length-1;for(o=t[d].x,a=t[d].y,u=d-1;u>=0;u--)l=(h=t[u]).x,c=h.y,h.x=o,h.y=a,o=l,a=c;t[d].x=e,t[d].y=n}else{for(o=t[0].x,a=t[0].y,u=1;u<t.length;u++)l=(h=t[u]).x,c=h.y,h.x=o,h.y=a,o=l,a=c;t[0].x=e,t[0].y=n}else o=t[0].x,a=t[0].y,t[0].x=e,t[0].y=n;return s.x=o,s.y=a,s}},function(t,e,n){var i=n(112);t.exports=function(t){return i(t)}},function(t,e,n){var i=n(155);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},function(t,e,n){var i=n(156);t.exports=function(t,e,n,r,s){void 0===s&&(s=!1);var o,a=Math.abs(r-n)/t.length;if(s)for(o=0;o<t.length;o++)t[o][e]+=i(o*a,n,r);else for(o=0;o<t.length;o++)t[o][e]=i(o*a,n,r);return t}},function(t,e){t.exports=function(t,e,n,i,r){void 0===r&&(r=!1);var s,o=Math.abs(i-n)/t.length;if(r)for(s=0;s<t.length;s++)t[s][e]+=s*o+n;else for(s=0;s<t.length;s++)t[s][e]=s*o+n;return t}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++)t[e].visible=!t[e].visible;return t}},function(t,e,n){var i=n(57);t.exports=function(t,e,n){void 0===n&&(n=0);for(var r=0;r<t.length;r++){var s=t[r];s.x=i(s.x,e.left-n,e.right+n),s.y=i(s.y,e.top-n,e.bottom+n)}return t}},function(t,e,n){t.exports={Animation:n(146),AnimationFrame:n(252),AnimationManager:n(270),Events:n(109)}},function(t,e,n){t.exports={BaseCache:n(271),CacheManager:n(273),Events:n(272)}},function(t,e){t.exports="add"},function(t,e){t.exports="remove"},function(t,e,n){t.exports={Controls:n(613),Scene2D:n(616)}},function(t,e,n){t.exports={FixedKeyControl:n(614),SmoothedKeyControl:n(615)}},function(t,e,n){var i=n(0),r=n(6),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.speedX=0,this.speedY=0;var e=r(t,"speed",null);"number"==typeof e?(this.speedX=e,this.speedY=e):(this.speedX=r(t,"speed.x",0),this.speedY=r(t,"speed.y",0)),this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this.up&&this.up.isDown?e.scrollY-=this.speedY*t|0:this.down&&this.down.isDown&&(e.scrollY+=this.speedY*t|0),this.left&&this.left.isDown?e.scrollX-=this.speedX*t|0:this.right&&this.right.isDown&&(e.scrollX+=this.speedX*t|0),this.zoomIn&&this.zoomIn.isDown?(e.zoom-=this.zoomSpeed,e.zoom<.1&&(e.zoom=.1)):this.zoomOut&&this.zoomOut.isDown&&(e.zoom+=this.zoomSpeed)}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},function(t,e,n){var i=n(0),r=n(6),s=new i({initialize:function(t){this.camera=r(t,"camera",null),this.left=r(t,"left",null),this.right=r(t,"right",null),this.up=r(t,"up",null),this.down=r(t,"down",null),this.zoomIn=r(t,"zoomIn",null),this.zoomOut=r(t,"zoomOut",null),this.zoomSpeed=r(t,"zoomSpeed",.01),this.accelX=0,this.accelY=0;var e=r(t,"acceleration",null);"number"==typeof e?(this.accelX=e,this.accelY=e):(this.accelX=r(t,"acceleration.x",0),this.accelY=r(t,"acceleration.y",0)),this.dragX=0,this.dragY=0;var n=r(t,"drag",null);"number"==typeof n?(this.dragX=n,this.dragY=n):(this.dragX=r(t,"drag.x",0),this.dragY=r(t,"drag.y",0)),this.maxSpeedX=0,this.maxSpeedY=0;var i=r(t,"maxSpeed",null);"number"==typeof i?(this.maxSpeedX=i,this.maxSpeedY=i):(this.maxSpeedX=r(t,"maxSpeed.x",0),this.maxSpeedY=r(t,"maxSpeed.y",0)),this._speedX=0,this._speedY=0,this._zoom=0,this.active=null!==this.camera},start:function(){return this.active=null!==this.camera,this},stop:function(){return this.active=!1,this},setCamera:function(t){return this.camera=t,this},update:function(t){if(this.active){void 0===t&&(t=1);var e=this.camera;this._speedX>0?(this._speedX-=this.dragX*t,this._speedX<0&&(this._speedX=0)):this._speedX<0&&(this._speedX+=this.dragX*t,this._speedX>0&&(this._speedX=0)),this._speedY>0?(this._speedY-=this.dragY*t,this._speedY<0&&(this._speedY=0)):this._speedY<0&&(this._speedY+=this.dragY*t,this._speedY>0&&(this._speedY=0)),this.up&&this.up.isDown?(this._speedY+=this.accelY,this._speedY>this.maxSpeedY&&(this._speedY=this.maxSpeedY)):this.down&&this.down.isDown&&(this._speedY-=this.accelY,this._speedY<-this.maxSpeedY&&(this._speedY=-this.maxSpeedY)),this.left&&this.left.isDown?(this._speedX+=this.accelX,this._speedX>this.maxSpeedX&&(this._speedX=this.maxSpeedX)):this.right&&this.right.isDown&&(this._speedX-=this.accelX,this._speedX<-this.maxSpeedX&&(this._speedX=-this.maxSpeedX)),this._zoom=this.zoomIn&&this.zoomIn.isDown?-this.zoomSpeed:this.zoomOut&&this.zoomOut.isDown?this.zoomSpeed:0,0!==this._speedX&&(e.scrollX-=this._speedX*t|0),0!==this._speedY&&(e.scrollY-=this._speedY*t|0),0!==this._zoom&&(e.zoom+=this._zoom,e.zoom<.001&&(e.zoom=.001))}},destroy:function(){this.camera=null,this.left=null,this.right=null,this.up=null,this.down=null,this.zoomIn=null,this.zoomOut=null}});t.exports=s},function(t,e,n){t.exports={Camera:n(274),BaseCamera:n(91),CameraManager:n(669),Effects:n(282),Events:n(48)}},function(t,e){t.exports="cameradestroy"},function(t,e){t.exports="camerafadeincomplete"},function(t,e){t.exports="camerafadeinstart"},function(t,e){t.exports="camerafadeoutcomplete"},function(t,e){t.exports="camerafadeoutstart"},function(t,e){t.exports="cameraflashcomplete"},function(t,e){t.exports="cameraflashstart"},function(t,e){t.exports="camerapancomplete"},function(t,e){t.exports="camerapanstart"},function(t,e){t.exports="postrender"},function(t,e){t.exports="prerender"},function(t,e){t.exports="camerashakecomplete"},function(t,e){t.exports="camerashakestart"},function(t,e){t.exports="camerazoomcomplete"},function(t,e){t.exports="camerazoomstart"},function(t,e,n){var i=n(22),r=n(0),s=n(48),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.isComplete=!1,this.direction=!0,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0},start:function(t,e,n,i,r,o,a,u){return void 0===t&&(t=!0),void 0===e&&(e=1e3),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=!1),void 0===a&&(a=null),void 0===u&&(u=this.camera.scene),!o&&this.isRunning||(this.isRunning=!0,this.isComplete=!1,this.duration=e,this.direction=t,this.progress=0,this.red=n,this.green=i,this.blue=r,this.alpha=t?Number.MIN_VALUE:1,this._elapsed=0,this._onUpdate=a,this._onUpdateScope=u,this.camera.emit(t?s.FADE_OUT_START:s.FADE_IN_START,this.camera,this,e,n,i,r)),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=this.direction?this.progress:1-this.progress:(this.alpha=this.direction?1:0,this.effectComplete()))},postRenderCanvas:function(t){if(!this.isRunning&&!this.isComplete)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e._cx,e._cy,e._cw,e._ch),!0},postRenderWebGL:function(t,e){if(!this.isRunning&&!this.isComplete)return!1;var n=this.camera;return t.drawFillRect(n._cx,n._cy,n._cw,n._ch,e(this.red/255,this.green/255,this.blue/255,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.isComplete=!0,this.camera.emit(this.direction?s.FADE_OUT_COMPLETE:s.FADE_IN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this.isComplete=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},function(t,e,n){var i=n(22),r=n(0),s=n(48),o=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.red=0,this.green=0,this.blue=0,this.alpha=0,this.progress=0,this._elapsed=0},start:function(t,e,n,i,r,o,a){return void 0===t&&(t=250),void 0===e&&(e=255),void 0===n&&(n=255),void 0===i&&(i=255),void 0===r&&(r=!1),void 0===o&&(o=null),void 0===a&&(a=this.camera.scene),!r&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,this.red=e,this.green=n,this.blue=i,this.alpha=1,this._elapsed=0,this._onUpdate=o,this._onUpdateScope=a,this.camera.emit(s.FLASH_START,this.camera,this,t,e,n,i)),this.camera},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration?this.alpha=1-this.progress:this.effectComplete())},postRenderCanvas:function(t){if(!this.isRunning)return!1;var e=this.camera;return t.fillStyle="rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")",t.fillRect(e._cx,e._cy,e._cw,e._ch),!0},postRenderWebGL:function(t,e){if(!this.isRunning)return!1;var n=this.camera;return t.drawFillRect(n._cx,n._cy,n._cw,n._ch,e(this.red/255,this.green/255,this.blue/255,1),this.alpha),!0},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=o},function(t,e,n){var i=n(22),r=n(0),s=n(164),o=n(48),a=n(3),u=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=new a,this.current=new a,this.destination=new a,this.progress=0,this._elapsed=0},start:function(t,e,n,i,r,a,u){void 0===n&&(n=1e3),void 0===i&&(i=s.Linear),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===u&&(u=this.camera.scene);var l=this.camera;return!r&&this.isRunning||(this.isRunning=!0,this.duration=n,this.progress=0,this.source.set(l.scrollX,l.scrollY),this.destination.set(t,e),l.getScroll(t,e,this.current),"string"==typeof i&&s.hasOwnProperty(i)?this.ease=s[i]:"function"==typeof i&&(this.ease=i),this._elapsed=0,this._onUpdate=a,this._onUpdateScope=u,this.camera.emit(o.PAN_START,this.camera,this,n,t,e)),l},update:function(t,e){if(this.isRunning){this._elapsed+=e;var n=i(this._elapsed/this.duration,0,1);this.progress=n;var r=this.camera;if(this._elapsed<this.duration){var s=this.ease(n);r.getScroll(this.destination.x,this.destination.y,this.current);var o=this.source.x+(this.current.x-this.source.x)*s,a=this.source.y+(this.current.y-this.source.y)*s;r.setScroll(o,a),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,o,a)}else r.centerOn(this.destination.x,this.destination.y),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,r,n,r.scrollX,r.scrollY),this.effectComplete()}},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.source=null,this.destination=null}});t.exports=u},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),t*t*((e+1)*t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1.70158),--t*t*((e+1)*t+e)+1}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1.70158);var n=1.525*e;return(t*=2)<1?t*t*((n+1)*t-n)*.5:.5*((t-=2)*t*((n+1)*t+n)+2)}},function(t,e){t.exports=function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}},function(t,e){t.exports=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},function(t,e){t.exports=function(t){var e=!1;return t<.5?(t=1-2*t,e=!0):t=2*t-1,t<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5}},function(t,e){t.exports=function(t){return 1-Math.sqrt(1-t*t)}},function(t,e){t.exports=function(t){return Math.sqrt(1- --t*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},function(t,e){t.exports=function(t){return t*t*t}},function(t,e){t.exports=function(t){return--t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/n)+1}},function(t,e){t.exports=function(t,e,n){if(void 0===e&&(e=.1),void 0===n&&(n=.1),0===t)return 0;if(1===t)return 1;var i=n/4;return e<1?e=1:i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1}},function(t,e){t.exports=function(t){return Math.pow(2,10*(t-1))-.001}},function(t,e){t.exports=function(t){return 1-Math.pow(2,-10*t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))}},function(t,e){t.exports=function(t){return t}},function(t,e){t.exports=function(t){return t*t}},function(t,e){t.exports=function(t){return t*(2-t)}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},function(t,e){t.exports=function(t){return t*t*t*t}},function(t,e){t.exports=function(t){return 1- --t*t*t*t}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},function(t,e){t.exports=function(t){return t*t*t*t*t}},function(t,e){t.exports=function(t){return--t*t*t*t*t+1}},function(t,e){t.exports=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)}},function(t,e){t.exports=function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t<=0?0:t>=1?1:1/e*(1+(e*t|0))}},function(t,e,n){var i=n(22),r=n(0),s=n(48),o=n(3),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.intensity=new o,this.progress=0,this._elapsed=0,this._offsetX=0,this._offsetY=0},start:function(t,e,n,i,r){return void 0===t&&(t=100),void 0===e&&(e=.05),void 0===n&&(n=!1),void 0===i&&(i=null),void 0===r&&(r=this.camera.scene),!n&&this.isRunning||(this.isRunning=!0,this.duration=t,this.progress=0,"number"==typeof e?this.intensity.set(e):this.intensity.set(e.x,e.y),this._elapsed=0,this._offsetX=0,this._offsetY=0,this._onUpdate=i,this._onUpdateScope=r,this.camera.emit(s.SHAKE_START,this.camera,this,t,e)),this.camera},preRender:function(){this.isRunning&&this.camera.matrix.translate(this._offsetX,this._offsetY)},update:function(t,e){if(this.isRunning)if(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress),this._elapsed<this.duration){var n=this.intensity,r=this.camera._cw,s=this.camera._ch,o=this.camera.zoom;this._offsetX=(Math.random()*n.x*r*2-n.x*r)*o,this._offsetY=(Math.random()*n.y*s*2-n.y*s)*o,this.camera.roundPixels&&(this._offsetX=Math.round(this._offsetX),this._offsetY=Math.round(this._offsetY))}else this.effectComplete()},effectComplete:function(){this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(s.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._offsetX=0,this._offsetY=0,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null,this.intensity=null}});t.exports=a},function(t,e,n){var i=n(22),r=n(0),s=n(164),o=n(48),a=new r({initialize:function(t){this.camera=t,this.isRunning=!1,this.duration=0,this.source=1,this.destination=1,this.progress=0,this._elapsed=0},start:function(t,e,n,i,r,a){void 0===e&&(e=1e3),void 0===n&&(n=s.Linear),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===a&&(a=this.camera.scene);var u=this.camera;return!i&&this.isRunning||(this.isRunning=!0,this.duration=e,this.progress=0,this.source=u.zoom,this.destination=t,"string"==typeof n&&s.hasOwnProperty(n)?this.ease=s[n]:"function"==typeof n&&(this.ease=n),this._elapsed=0,this._onUpdate=r,this._onUpdateScope=a,this.camera.emit(o.ZOOM_START,this.camera,this,e,t)),u},update:function(t,e){this.isRunning&&(this._elapsed+=e,this.progress=i(this._elapsed/this.duration,0,1),this._elapsed<this.duration?(this.camera.zoom=this.source+(this.destination-this.source)*this.ease(this.progress),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)):(this.camera.zoom=this.destination,this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination),this.effectComplete()))},effectComplete:function(){this._onUpdate=null,this._onUpdateScope=null,this.isRunning=!1,this.camera.emit(o.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=!1,this._onUpdate=null,this._onUpdateScope=null},destroy:function(){this.reset(),this.camera=null}});t.exports=a},function(t,e,n){var i=n(274),r=n(0),s=n(2),o=n(20),a=n(47),u=n(92),l=n(21),c=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.roundPixels=t.sys.game.config.roundPixels,this.cameras=[],t.sys.events.once(l.BOOT,this.boot,this),t.sys.events.on(l.START,this.start,this)},boot:function(){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0],this.default=new i(0,0,t.scale.width,t.scale.height).setScene(this.scene),t.game.scale.on(u.RESIZE,this.onResize,this),this.systems.events.once(l.DESTROY,this.destroy,this)},start:function(){if(!this.main){var t=this.systems;t.settings.cameras?this.fromJSON(t.settings.cameras):this.add(),this.main=this.cameras[0]}var e=this.systems.events;e.on(l.UPDATE,this.update,this),e.once(l.SHUTDOWN,this.shutdown,this)},add:function(t,e,n,r,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===r&&(r=this.scene.sys.scale.height),void 0===s&&(s=!1),void 0===o&&(o="");var a=new i(t,e,n,r);return a.setName(o),a.setScene(this.scene),a.setRoundPixels(this.roundPixels),a.id=this.getNextID(),this.cameras.push(a),s&&(this.main=a),a},addExisting:function(t,e){return void 0===e&&(e=!1),-1===this.cameras.indexOf(t)?(t.id=this.getNextID(),t.setRoundPixels(this.roundPixels),this.cameras.push(t),e&&(this.main=t),t):null},getNextID:function(){for(var t=this.cameras,e=1,n=0;n<32;n++){for(var i=!1,r=0;r<t.length;r++){var s=t[r];s&&s.id===e&&(i=!0)}if(!i)return e;e<<=1}return 0},getTotal:function(t){void 0===t&&(t=!1);for(var e=0,n=this.cameras,i=0;i<n.length;i++)(!t||t&&n[i].visible)&&e++;return e},fromJSON:function(t){Array.isArray(t)||(t=[t]);for(var e=this.scene.sys.scale.width,n=this.scene.sys.scale.height,i=0;i<t.length;i++){var r=t[i],o=s(r,"x",0),a=s(r,"y",0),u=s(r,"width",e),l=s(r,"height",n),c=this.add(o,a,u,l);c.name=s(r,"name",""),c.zoom=s(r,"zoom",1),c.rotation=s(r,"rotation",0),c.scrollX=s(r,"scrollX",0),c.scrollY=s(r,"scrollY",0),c.roundPixels=s(r,"roundPixels",!1),c.visible=s(r,"visible",!0);var h=s(r,"backgroundColor",!1);h&&c.setBackgroundColor(h);var d=s(r,"bounds",null);if(d){var f=s(d,"x",0),p=s(d,"y",0),m=s(d,"width",e),g=s(d,"height",n);c.setBounds(f,p,m,g)}}return this},getCamera:function(t){for(var e=this.cameras,n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null},getCamerasBelowPointer:function(t){for(var e=this.cameras,n=t.x,i=t.y,r=[],s=0;s<e.length;s++){var o=e[s];o.visible&&o.inputEnabled&&a(o,n,i)&&r.unshift(o)}return r},remove:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0,i=this.cameras,r=0;r<t.length;r++){var s=i.indexOf(t[r]);-1!==s&&(e&&i[s].destroy(),i.splice(s,1),n++)}return!this.main&&i[0]&&(this.main=i[0]),n},render:function(t,e,n){for(var i=this.scene,r=this.cameras,s=0;s<this.cameras.length;s++){var o=r[s];o.visible&&o.alpha>0&&(o.preRender(1),t.render(i,e,n,o))}},resetAll:function(){for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();return this.cameras=[],this.main=this.add(),this.main},update:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].update(t,e)},onResize:function(t,e,n,i,r,s){for(var o=0;o<this.cameras.length;o++){var a=this.cameras[o];0===a._x&&0===a._y&&a._width===r&&a._height===s&&a.setSize(e.width,e.height)}},resize:function(t,e){for(var n=0;n<this.cameras.length;n++)this.cameras[n].setSize(t,e)},shutdown:function(){this.main=void 0;for(var t=0;t<this.cameras.length;t++)this.cameras[t].destroy();this.cameras=[];var e=this.systems.events;e.off(l.UPDATE,this.update,this),e.off(l.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.default.destroy(),this.scene.sys.events.off(l.START,this.start,this),this.scene=null,this.systems=null}});o.register("CameraManager",c,"cameras"),t.exports=c},function(t,e){t.exports="enterfullscreen"},function(t,e){t.exports="fullscreenfailed"},function(t,e){t.exports="fullscreenunsupported"},function(t,e){t.exports="leavefullscreen"},function(t,e){t.exports="orientationchange"},function(t,e){t.exports="resize"},function(t,e){t.exports="boot"},function(t,e){t.exports="create"},function(t,e){t.exports="destroy"},function(t,e){t.exports="pause"},function(t,e){t.exports="postupdate"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="ready"},function(t,e){t.exports="render"},function(t,e){t.exports="resume"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="sleep"},function(t,e){t.exports="start"},function(t,e){t.exports="transitioncomplete"},function(t,e){t.exports="transitioninit"},function(t,e){t.exports="transitionout"},function(t,e){t.exports="transitionstart"},function(t,e){t.exports="transitionwake"},function(t,e){t.exports="update"},function(t,e){t.exports="wake"},function(t,e,n){t.exports={Config:n(295),CreateRenderer:n(318),DebugHeader:n(320),Events:n(17),TimeStep:n(321),VisibilityHandler:n(323)}},function(t,e){var n,i,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var u,l=[],c=!1,h=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var t=a(d);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){var i=n(115),r={gamepads:!1,mspointer:!1,touch:!1,wheelEvent:null};t.exports=(("ontouchstart"in document.documentElement||navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)&&(r.touch=!0),(navigator.msPointerEnabled||navigator.pointerEnabled)&&(r.mspointer=!0),navigator.getGamepads&&(r.gamepads=!0),"onwheel"in window||i.ie&&"WheelEvent"in window?r.wheelEvent="wheel":"onmousewheel"in window?r.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(r.wheelEvent="DOMMouseScroll"),r)},function(t,e,n){var i=n(115),r={audioData:!1,dolby:!1,m4a:!1,mp3:!1,ogg:!1,opus:!1,wav:!1,webAudio:!1,webm:!1};t.exports=function(){r.audioData=!!window.Audio,r.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var t=document.createElement("audio"),e=!!t.canPlayType;try{if(e&&(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(r.ogg=!0),(t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||t.canPlayType("audio/opus;").replace(/^no$/,""))&&(r.opus=!0),t.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(r.mp3=!0),t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(r.wav=!0),(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/aac;").replace(/^no$/,""))&&(r.m4a=!0),t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(r.webm=!0),""!==t.canPlayType('audio/mp4;codecs="ec-3"')))if(i.edge)r.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var n=parseInt(RegExp.$1,10),s=parseInt(RegExp.$2,10);(10===n&&s>=11||n>10)&&(r.dolby=!0)}}catch(t){}return r}()},function(t,e){var n={h264:!1,hls:!1,mp4:!1,ogg:!1,vp9:!1,webm:!1};t.exports=function(){var t=document.createElement("video"),e=!!t.canPlayType;try{e&&(t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(n.ogg=!0),t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(n.h264=!0,n.mp4=!0),t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(n.webm=!0),t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(n.vp9=!0),t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(n.hls=!0))}catch(t){}return n}()},function(t,e){var n={available:!1,cancel:"",keyboard:!1,request:""};t.exports=function(){var t,e="Fullscreen",i="FullScreen",r=["request"+e,"request"+i,"webkitRequest"+e,"webkitRequest"+i,"msRequest"+e,"msRequest"+i,"mozRequest"+i,"mozRequest"+e];for(t=0;t<r.length;t++)if(document.documentElement[r[t]]){n.available=!0,n.request=r[t];break}var s=["cancel"+i,"exit"+e,"webkitCancel"+i,"webkitExit"+e,"msCancel"+i,"msExit"+e,"mozCancel"+i,"mozExit"+e];if(n.available)for(t=0;t<s.length;t++)if(document[s[t]]){n.cancel=s[t];break}return window.Element&&Element.ALLOW_KEYBOARD_INPUT&&!/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)&&(n.keyboard=!0),Object.defineProperty(n,"active",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),n}()},function(t,e,n){t.exports={Between:n(298),BetweenPoints:n(702),BetweenPointsY:n(703),BetweenY:n(704),CounterClockwise:n(705),Normalize:n(299),Reverse:n(706),RotateTo:n(707),ShortestBetween:n(708),Wrap:n(229),WrapDegrees:n(230)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}},function(t,e){t.exports=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)}},function(t,e){t.exports=function(t,e,n,i){return Math.atan2(n-t,i-e)}},function(t,e,n){var i=n(23);t.exports=function(t){return t>Math.PI&&(t-=i.PI2),Math.abs(((t+i.TAU)%i.PI2-i.PI2)%i.PI2)}},function(t,e,n){var i=n(299);t.exports=function(t){return i(t+Math.PI)}},function(t,e,n){var i=n(23);t.exports=function(t,e,n){return void 0===n&&(n=.05),t===e||(Math.abs(e-t)<=n||Math.abs(e-t)>=i.PI2-n?t=e:(Math.abs(e-t)>Math.PI&&(e<t?e+=i.PI2:e-=i.PI2),e>t?t+=n:e<t&&(t-=n))),t}},function(t,e){t.exports=function(t,e){var n=e-t;return 0===n?0:n-360*Math.floor((n- -180)/360)}},function(t,e,n){t.exports={Between:n(58),Power:n(710),Squared:n(300)}},function(t,e){t.exports=function(t,e,n,i,r){return void 0===r&&(r=2),Math.sqrt(Math.pow(n-t,r)+Math.pow(i-e,r))}},function(t,e,n){t.exports={Back:n(283),Bounce:n(284),Circular:n(285),Cubic:n(286),Elastic:n(287),Expo:n(288),Linear:n(289),Quadratic:n(290),Quartic:n(291),Quintic:n(292),Sine:n(293),Stepped:n(294)}},function(t,e,n){t.exports={Ceil:n(713),Equal:n(167),Floor:n(714),GreaterThan:n(301),LessThan:n(302)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.ceil(t-e)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1e-4),Math.floor(t+e)}},function(t,e,n){t.exports={Bezier:n(716),CatmullRom:n(717),CubicBezier:n(305),Linear:n(718),QuadraticBezier:n(306),SmoothStep:n(307),SmootherStep:n(719)}},function(t,e,n){var i=n(303);t.exports=function(t,e){for(var n=0,r=t.length-1,s=0;s<=r;s++)n+=Math.pow(1-e,r-s)*Math.pow(e,s)*t[s]*i(r,s);return n}},function(t,e,n){var i=n(168);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return t[0]===t[n]?(e<0&&(s=Math.floor(r=n*(1+e))),i(r-s,t[(s-1+n)%n],t[s],t[(s+1)%n],t[(s+2)%n])):e<0?t[0]-(i(-r,t[0],t[0],t[1],t[1])-t[0]):e>1?t[n]-(i(r-n,t[n],t[n],t[n-1],t[n-1])-t[n]):i(r-s,t[s?s-1:0],t[s],t[n<s+1?n:s+1],t[n<s+2?n:s+2])}},function(t,e,n){var i=n(113);t.exports=function(t,e){var n=t.length-1,r=n*e,s=Math.floor(r);return e<0?i(t[0],t[1],r):e>1?i(t[n],t[n-1],n-r):i(t[s],t[s+1>n?n:s+1],r-s)}},function(t,e,n){var i=n(155);t.exports=function(t,e,n){return e+(n-e)*i(t,0,1)}},function(t,e,n){t.exports={GetNext:n(308),IsSize:n(116),IsValue:n(721)}},function(t,e){t.exports=function(t){return t>0&&0==(t&t-1)}},function(t,e,n){t.exports={Ceil:n(309),Floor:n(93),To:n(723)}},function(t,e){t.exports=function(t,e,n,i){return void 0===n&&(n=0),0===e?t:(t-=n,t=e*Math.round(t/e),i?(n+t)/e:n+t)}},function(t,e,n){var i=new(n(0))({initialize:function(t){void 0===t&&(t=[(Date.now()*Math.random()).toString()]),this.c=1,this.s0=0,this.s1=0,this.s2=0,this.n=0,this.signs=[-1,1],t&&this.init(t)},rnd:function(){var t=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|t,this.s0=this.s1,this.s1=this.s2,this.s2=t-this.c,this.s2},hash:function(t){var e,n=this.n;t=t.toString();for(var i=0;i<t.length;i++)e=.02519603282416938*(n+=t.charCodeAt(i)),e-=n=e>>>0,n=(e*=n)>>>0,n+=4294967296*(e-=n);return this.n=n,2.3283064365386963e-10*(n>>>0)},init:function(t){"string"==typeof t?this.state(t):this.sow(t)},sow:function(t){if(this.n=4022871197,this.s0=this.hash(" "),this.s1=this.hash(" "),this.s2=this.hash(" "),this.c=1,t)for(var e=0;e<t.length&&null!=t[e];e++){var n=t[e];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},integer:function(){return 4294967296*this.rnd()},frac:function(){return this.rnd()+11102230246251565e-32*(2097152*this.rnd()|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},between:function(t,e){return Math.floor(this.realInRange(0,e-t+1)+t)},realInRange:function(t,e){return this.frac()*(e-t)+t},normal:function(){return 1-2*this.frac()},uuid:function(){var t="",e="";for(e=t="";t++<36;e+=~t%5|3*t&4?(15^t?8^this.frac()*(20^t?16:4):4).toString(16):"-");return e},pick:function(t){return t[this.integerInRange(0,t.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(t){return t[~~(Math.pow(this.frac(),2)*(t.length-1)+.5)]},timestamp:function(t,e){return this.realInRange(t||9466848e5,e||1577862e6)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(t){return"string"==typeof t&&t.match(/^!rnd/)&&(t=t.split(","),this.c=parseFloat(t[1]),this.s0=parseFloat(t[2]),this.s1=parseFloat(t[3]),this.s2=parseFloat(t[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")},shuffle:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(this.frac()*(e+1)),i=t[n];t[n]=t[e],t[e]=i}return t}});t.exports=i},function(t,e){t.exports=function(t){for(var e=0,n=0;n<t.length;n++)e+=+t[n];return e/t.length}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.ceil(t*i)/i}},function(t,e){t.exports=function(t,e){return Math.abs(t-e)}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.floor(t*i)/i}},function(t,e){t.exports=function(t,e){return t/e/1e3}},function(t,e){t.exports=function(t){return t==parseFloat(t)?!(t%2):void 0}},function(t,e){t.exports=function(t){return t===parseFloat(t)?!(t%2):void 0}},function(t,e){t.exports=function(t,e,n){return Math.min(t+e,n)}},function(t,e){t.exports=function(t,e,n){return Math.max(t-e,n)}},function(t,e){t.exports=function(t,e,n,i){void 0===n&&(n=e+1);var r=(t-e)/(n-e);return r>1?void 0!==i?(r=(i-t)/(i-n))<0&&(r=0):r=1:r<0&&(r=0),r}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI;return t.x=Math.cos(n)*e,t.y=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e){void 0===e&&(e=1);var n=2*Math.random()*Math.PI,i=2*Math.random()-1,r=Math.sqrt(1-i*i)*e;return t.x=Math.cos(n)*r,t.y=Math.sin(n)*r,t.z=i*e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=1),t.x=(2*Math.random()-1)*e,t.y=(2*Math.random()-1)*e,t.z=(2*Math.random()-1)*e,t.w=(2*Math.random()-1)*e,t}},function(t,e){t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=10);var i=Math.pow(n,-e);return Math.round(t*i)/i}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n=1),void 0===i&&(i=1),i*=Math.PI/t;for(var r=[],s=[],o=0;o<t;o++)e+=(n-=e*i)*i,r[o]=n,s[o]=e;return{sin:s,cos:r,length:t}}},function(t,e,n){var i=n(3);t.exports=function(t,e,n,r){void 0===r&&(r=new i);var s=0,o=0;return t>0&&t<=e*n&&(s=t>e-1?t-(o=Math.floor(t/e))*e:t,r.set(s,o)),r}},function(t,e){t.exports=function(t,e,n){return Math.abs(t-e)<=n}},function(t,e,n){var i=n(171),r=n(316),s=n(317),o=new r,a=new s,u=new i;t.exports=function(t,e,n){return a.setAxisAngle(e,n),o.fromRotationTranslation(a,u.set(0,0,0)),t.transformMat4(o)}},function(t,e){t.exports="addtexture"},function(t,e){t.exports="onerror"},function(t,e){t.exports="onload"},function(t,e){t.exports="ready"},function(t,e){t.exports="removetexture"},function(t,e){t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_FS","","precision mediump float;","","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uMaskSampler;","uniform bool uInvertMaskAlpha;","","void main()","{","    vec2 uv = gl_FragCoord.xy / uResolution;","    vec4 mainColor = texture2D(uMainSampler, uv);","    vec4 maskColor = texture2D(uMaskSampler, uv);","    float alpha = mainColor.a;","","    if (!uInvertMaskAlpha)","    {","        alpha *= (maskColor.a);","    }","    else","    {","        alpha *= (1.0 - maskColor.a);","    }","","    gl_FragColor = vec4(mainColor.rgb * alpha, alpha);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_BITMAP_MASK_VS","","precision mediump float;","","attribute vec2 inPosition;","","void main()","{","    gl_Position = vec4(inPosition, 0.0, 1.0);","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_FORWARD_DIFFUSE_FS","","precision mediump float;","","struct Light","{","    vec2 position;","    vec3 color;","    float intensity;","    float radius;","};","","const int kMaxLights = %LIGHT_COUNT%;","","uniform vec4 uCamera; /* x, y, rotation, zoom */","uniform vec2 uResolution;","uniform sampler2D uMainSampler;","uniform sampler2D uNormSampler;","uniform vec3 uAmbientLightColor;","uniform Light uLights[kMaxLights];","uniform mat3 uInverseRotationMatrix;","","varying vec2 outTexCoord;","varying vec4 outTint;","","void main()","{","    vec3 finalColor = vec3(0.0, 0.0, 0.0);","    vec4 color = texture2D(uMainSampler, outTexCoord) * vec4(outTint.rgb * outTint.a, outTint.a);","    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;","    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));","    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;","","    for (int index = 0; index < kMaxLights; ++index)","    {","        Light light = uLights[index];","        vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);","        vec3 lightNormal = normalize(lightDir);","        float distToSurf = length(lightDir) * uCamera.w;","        float diffuseFactor = max(dot(normal, lightNormal), 0.0);","        float radius = (light.radius / res.x * uCamera.w) * uCamera.w;","        float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);","        vec3 diffuse = light.color * diffuseFactor;","        finalColor += (attenuation * diffuse) * light.intensity;","    }","","    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);","    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);","","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_TEXTURE_TINT_FS","","precision mediump float;","","uniform sampler2D uMainSampler;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main()","{","    vec4 texture = texture2D(uMainSampler, outTexCoord);","    vec4 texel = vec4(outTint.rgb * outTint.a, outTint.a);","    vec4 color = texture;","","    if (outTintEffect == 0.0)","    {","        //  Multiply texture tint","        color = texture * texel;","    }","    else if (outTintEffect == 1.0)","    {","        //  Solid color + texture alpha","        color.rgb = mix(texture.rgb, outTint.rgb * outTint.a, texture.a);","        color.a = texture.a * texel.a;","    }","    else if (outTintEffect == 2.0)","    {","        //  Solid color, no texture","        color = texel;","    }","","    gl_FragColor = color;","}",""].join("\n")},function(t,e){t.exports=["#define SHADER_NAME PHASER_TEXTURE_TINT_VS","","precision mediump float;","","uniform mat4 uProjectionMatrix;","uniform mat4 uViewMatrix;","uniform mat4 uModelMatrix;","","attribute vec2 inPosition;","attribute vec2 inTexCoord;","attribute float inTintEffect;","attribute vec4 inTint;","","varying vec2 outTexCoord;","varying float outTintEffect;","varying vec4 outTint;","","void main ()","{","    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(inPosition, 1.0, 1.0);","","    outTexCoord = inTexCoord;","    outTint = inTint;","    outTintEffect = inTintEffect;","}","",""].join("\n")},function(t,e,n){t.exports={GenerateTexture:n(324),Palettes:n(754)}},function(t,e,n){t.exports={ARNE16:n(325),C64:n(755),CGA:n(756),JMP:n(757),MSX:n(758)}},function(t,e){t.exports={0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"}},function(t,e){t.exports={0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"}},function(t,e){t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"}},function(t,e){t.exports={0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}},function(t,e,n){t.exports={Path:n(760),CubicBezier:n(326),Curve:n(80),Ellipse:n(327),Line:n(328),QuadraticBezier:n(329),Spline:n(330)}},function(t,e,n){var i=n(0),r=n(326),s=n(327),o=n(5),a=n(328),u=n(761),l=n(329),c=n(11),h=n(330),d=n(3),f=new i({initialize:function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.name="",this.curves=[],this.cacheLengths=[],this.autoClose=!1,this.startPoint=new d,this._tmpVec2A=new d,this._tmpVec2B=new d,"object"==typeof t?this.fromJSON(t):this.startPoint.set(t,e)},add:function(t){return this.curves.push(t),this},circleTo:function(t,e,n){return void 0===e&&(e=!1),this.ellipseTo(t,t,0,360,e,n)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||this.curves.push(new a(e,t)),this},cubicBezierTo:function(t,e,n,i,s,o){var a,u,l,c=this.getEndPoint();return t instanceof d?(a=t,u=e,l=n):(a=new d(n,i),u=new d(s,o),l=new d(t,e)),this.add(new r(c,a,u,l))},quadraticBezierTo:function(t,e,n,i){var r,s,o=this.getEndPoint();return t instanceof d?(r=t,s=e):(r=new d(n,i),s=new d(t,e)),this.add(new l(o,r,s))},draw:function(t,e){for(var n=0;n<this.curves.length;n++){var i=this.curves[n];i.active&&i.draw(t,e)}return t},ellipseTo:function(t,e,n,i,r,o){var a=new s(0,0,t,e,n,i,r,o),u=this.getEndPoint(this._tmpVec2A),l=a.getStartPoint(this._tmpVec2B);return u.subtract(l),a.x=u.x,a.y=u.y,this.add(a)},fromJSON:function(t){this.curves=[],this.cacheLengths=[],this.startPoint.set(t.x,t.y),this.autoClose=t.autoClose;for(var e=0;e<t.curves.length;e++){var n=t.curves[e];switch(n.type){case"LineCurve":this.add(a.fromJSON(n));break;case"EllipseCurve":this.add(s.fromJSON(n));break;case"SplineCurve":this.add(h.fromJSON(n));break;case"CubicBezierCurve":this.add(r.fromJSON(n));break;case"QuadraticBezierCurve":this.add(l.fromJSON(n))}}return this},getBounds:function(t,e){void 0===t&&(t=new c),void 0===e&&(e=16),t.x=Number.MAX_VALUE,t.y=Number.MAX_VALUE;for(var n=new c,i=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=0;s<this.curves.length;s++){var o=this.curves[s];o.active&&(o.getBounds(n,e),t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),i=Math.max(i,n.right),r=Math.max(r,n.bottom))}return t.right=i,t.bottom=r,t},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0;n<this.curves.length;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getEndPoint:function(t){return void 0===t&&(t=new d),this.curves.length>0?this.curves[this.curves.length-1].getPoint(1,t):t.copy(this.startPoint),t},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},getPoint:function(t,e){void 0===e&&(e=new d);for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var s=i[r]-n,o=this.curves[r],a=o.getLength();return o.getPointAt(0===a?0:1-s/a,e)}r++}return null},getPoints:function(t){void 0===t&&(t=12);for(var e,n=[],i=0;i<this.curves.length;i++){var r=this.curves[i];if(r.active)for(var s=r.getResolution(t),o=r.getPoints(s),a=0;a<o.length;a++){var u=o[a];e&&e.equals(u)||(n.push(u),e=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},getRandomPoint:function(t){return void 0===t&&(t=new d),this.getPoint(Math.random(),t)},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getStartPoint:function(t){return void 0===t&&(t=new d),t.copy(this.startPoint)},lineTo:function(t,e){t instanceof d?this._tmpVec2B.copy(t):this._tmpVec2B.set(t,e);var n=this.getEndPoint(this._tmpVec2A);return this.add(new a([n.x,n.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(t){return t.unshift(this.getEndPoint()),this.add(new h(t))},moveTo:function(t,e){return this.add(t instanceof d?new u(t.x,t.y):new u(t,e))},toJSON:function(){for(var t=[],e=0;e<this.curves.length;e++)t.push(this.curves[e].toJSON());return{type:"Path",x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:t}},updateArcLengths:function(){this.cacheLengths=[],this.getCurveLengths()},destroy:function(){this.curves.length=0,this.cacheLengths.length=0,this.startPoint=void 0}});o.register("path",function(t,e){return new f(t,e)}),t.exports=f},function(t,e,n){var i=n(0),r=n(3),s=new i({initialize:function(t,e){this.active=!1,this.p0=new r(t,e)},getPoint:function(t,e){return void 0===e&&(e=new r),e.copy(this.p0)},getPointAt:function(t,e){return this.getPoint(t,e)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:"MoveTo",points:[this.p0.x,this.p0.y]}}});t.exports=s},function(t,e,n){t.exports={DataManager:n(111),DataManagerPlugin:n(763),Events:n(265)}},function(t,e,n){var i=n(0),r=n(111),s=n(20),o=n(21),a=new i({Extends:r,initialize:function(t){r.call(this,t,t.sys.events),this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.events=this.systems.events,this.events.once(o.DESTROY,this.destroy,this)},start:function(){this.events.once(o.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){r.prototype.destroy.call(this),this.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("DataManagerPlugin",a,"data"),t.exports=a},function(t,e,n){t.exports={Align:n(765),BaseShader:n(331),Bounds:n(780),Canvas:n(783),Color:n(332),Masks:n(792)}},function(t,e,n){var i=n(143),r=n(16),s={In:n(766),To:n(767)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={BottomCenter:n(237),BottomLeft:n(238),BottomRight:n(239),Center:n(240),LeftCenter:n(242),QuickSet:n(236),RightCenter:n(243),TopCenter:n(244),TopLeft:n(245),TopRight:n(246)}},function(t,e,n){t.exports={BottomCenter:n(768),BottomLeft:n(769),BottomRight:n(770),LeftBottom:n(771),LeftCenter:n(772),LeftTop:n(773),RightBottom:n(774),RightCenter:n(775),RightTop:n(776),TopCenter:n(777),TopLeft:n(778),TopRight:n(779)}},function(t,e,n){var i=n(38),r=n(74),s=n(75),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},function(t,e,n){var i=n(38),r=n(40),s=n(41),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)-n),o(t,i(e)+a),t}},function(t,e,n){var i=n(38),r=n(42),s=n(43),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,r(e)+n),o(t,i(e)+a),t}},function(t,e,n){var i=n(38),r=n(40),s=n(39),o=n(43);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(77),r=n(40),s=n(76),o=n(43);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)-n),s(t,i(e)+a),t}},function(t,e,n){var i=n(40),r=n(44),s=n(43),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)-n),o(t,r(e)-a),t}},function(t,e,n){var i=n(38),r=n(42),s=n(39),o=n(41);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(77),r=n(42),s=n(76),o=n(41);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,r(e)+n),s(t,i(e)+a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(41),o=n(45);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),s(t,i(e)+n),o(t,r(e)-a),t}},function(t,e,n){var i=n(74),r=n(44),s=n(39),o=n(75);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},function(t,e,n){var i=n(40),r=n(44),s=n(39),o=n(41);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)-n),s(t,r(e)-a),t}},function(t,e,n){var i=n(42),r=n(44),s=n(39),o=n(43);t.exports=function(t,e,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),o(t,i(e)+n),s(t,r(e)-a),t}},function(t,e,n){t.exports={CenterOn:n(241),GetBottom:n(38),GetCenterX:n(74),GetCenterY:n(77),GetLeft:n(40),GetOffsetX:n(781),GetOffsetY:n(782),GetRight:n(42),GetTop:n(44),SetBottom:n(39),SetCenterX:n(75),SetCenterY:n(76),SetLeft:n(41),SetRight:n(43),SetTop:n(45)}},function(t,e){t.exports=function(t){return t.width*t.originX}},function(t,e){t.exports=function(t){return t.height*t.originY}},function(t,e,n){t.exports={CanvasInterpolation:n(319),CanvasPool:n(25),Smoothing:n(162),TouchAction:n(784),UserSelect:n(785)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e="none"),t.style.msTouchAction=e,t.style["ms-touch-action"]=e,t.style["touch-action"]=e,t}},function(t,e){t.exports=function(t,e){return void 0===e&&(e="none"),["-webkit-","-khtml-","-moz-","-ms-",""].forEach(function(n){t.style[n+"user-select"]=e}),t.style["-webkit-touch-callout"]=e,t.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",t}},function(t,e){t.exports=function(t){var e={r:t>>16&255,g:t>>8&255,b:255&t,a:255};return t>16777215&&(e.a=t>>>24),e}},function(t,e,n){var i=n(33),r=n(334);t.exports=function(t,e,n){var s=n,o=n,a=n;if(0!==e){var u=n<.5?n*(1+e):n+e-n*e,l=2*n-u;s=r(l,u,t+1/3),o=r(l,u,t),a=r(l,u,t-1/3)}return(new i).setGLTo(s,o,a,1)}},function(t,e,n){var i=n(161);t.exports=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);for(var n=[],r=0;r<=359;r++)n.push(i(r/359,t,e));return n}},function(t,e,n){var i=n(113),r=function(t,e,n,r,s,o,a,u){void 0===a&&(a=100),void 0===u&&(u=0);var l=u/a;return{r:i(t,r,l),g:i(e,s,l),b:i(n,o,l)}};t.exports={RGBWithRGB:r,ColorWithRGB:function(t,e,n,i,s,o){return void 0===s&&(s=100),void 0===o&&(o=0),r(t.r,t.g,t.b,e,n,i,s,o)},ColorWithColor:function(t,e,n,i){return void 0===n&&(n=100),void 0===i&&(i=0),r(t.r,t.g,t.b,e.r,e.g,e.b,n,i)}}},function(t,e,n){var i=n(169),r=n(33);t.exports=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=255),new r(i(t,e),i(t,e),i(t,e))}},function(t,e,n){var i=n(333);t.exports=function(t,e,n,r,s){return void 0===r&&(r=255),void 0===s&&(s="#"),"#"===s?"#"+((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1):"0x"+i(r)+i(t)+i(e)+i(n)}},function(t,e,n){t.exports={BitmapMask:n(259),GeometryMask:n(260)}},function(t,e,n){var i={AddToDOM:n(118),DOMContentLoaded:n(335),GetScreenOrientation:n(336),GetTarget:n(341),ParseXML:n(342),RemoveFromDOM:n(175),RequestAnimationFrame:n(322)};t.exports=i},function(t,e,n){t.exports={EventEmitter:n(795)}},function(t,e,n){var i=n(0),r=n(9),s=n(20),o=new i({Extends:r,initialize:function(){r.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});s.register("EventEmitter",o,"events"),t.exports=o},function(t,e,n){var i=n(118),r=n(270),s=n(273),o=n(25),a=n(0),u=n(295),l=n(797),c=n(318),h=n(111),d=n(320),f=n(296),p=n(335),m=n(9),g=n(17),y=n(343),v=n(20),b=n(348),x=n(349),w=n(351),T=n(117),S=n(354),E=n(321),O=n(323),C=n(358),_=new a({initialize:function(t){this.config=new u(t),this.renderer=null,this.domContainer=null,this.canvas=null,this.context=null,this.isBooted=!1,this.isRunning=!1,this.events=new m,this.anims=new r(this),this.textures=new S(this),this.cache=new s(this),this.registry=new h(this),this.input=new y(this,this.config),this.scene=new w(this,this.config.sceneConfig),this.device=f,this.scale=new x(this,this.config),this.sound=null,this.sound=C.create(this),this.loop=new E(this,this.config.fps),this.plugins=new b(this,this.config),this.pendingDestroy=!1,this.removeCanvas=!1,this.noReturn=!1,this.hasFocus=!1,p(this.boot.bind(this))},boot:function(){v.hasCore("EventEmitter")?(this.isBooted=!0,this.config.preBoot(this),this.scale.preBoot(),c(this),l(this),d(this),i(this.canvas,this.config.parent),this.textures.once(T.READY,this.texturesReady,this),this.events.emit(g.BOOT)):console.warn("Aborting. Core Plugins missing.")},texturesReady:function(){this.events.emit(g.READY),this.start()},start:function(){this.isRunning=!0,this.config.postBoot(this),this.loop.start(this.renderer?this.step.bind(this):this.headlessStep.bind(this)),O(this);var t=this.events;t.on(g.HIDDEN,this.onHidden,this),t.on(g.VISIBLE,this.onVisible,this),t.on(g.BLUR,this.onBlur,this),t.on(g.FOCUS,this.onFocus,this)},step:function(t,e){if(this.pendingDestroy)return this.runDestroy();var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e);var i=this.renderer;i.preRender(),n.emit(g.PRE_RENDER,i,t,e),this.scene.render(i),i.postRender(),n.emit(g.POST_RENDER,i,t,e)},headlessStep:function(t,e){var n=this.events;n.emit(g.PRE_STEP,t,e),n.emit(g.STEP,t,e),this.scene.update(t,e),n.emit(g.POST_STEP,t,e),n.emit(g.PRE_RENDER),n.emit(g.POST_RENDER)},onHidden:function(){this.loop.pause(),this.events.emit(g.PAUSE)},onVisible:function(){this.loop.resume(),this.events.emit(g.RESUME)},onBlur:function(){this.hasFocus=!1,this.loop.blur()},onFocus:function(){this.hasFocus=!0,this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(t,e){void 0===e&&(e=!1),this.pendingDestroy=!0,this.removeCanvas=t,this.noReturn=e},runDestroy:function(){this.events.emit(g.DESTROY),this.events.removeAllListeners(),this.scene.destroy(),this.renderer&&this.renderer.destroy(),this.removeCanvas&&this.canvas&&(o.remove(this.canvas),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)),this.domContainer&&this.domContainer.parentNode.removeChild(this.domContainer),this.loop.destroy(),this.pendingDestroy=!1}});t.exports=_},function(t,e,n){var i=n(118);t.exports=function(t){var e=t.config;if(e.parent&&e.domCreateContainer){var n=document.createElement("div");n.style.cssText=["display: block;","width: "+t.scale.width+"px;","height: "+t.scale.height+"px;","padding: 0; margin: 0;","position: absolute;","overflow: hidden;","pointer-events: none;","transform: scale(1);","transform-origin: left top;"].join(" "),t.domContainer=n,i(n,e.parent)}}},function(t,e){t.exports="boot"},function(t,e){t.exports="destroy"},function(t,e){t.exports="dragend"},function(t,e){t.exports="dragenter"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragleave"},function(t,e){t.exports="dragover"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="drop"},function(t,e){t.exports="gameout"},function(t,e){t.exports="gameover"},function(t,e){t.exports="gameobjectdown"},function(t,e){t.exports="dragend"},function(t,e){t.exports="dragenter"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragleave"},function(t,e){t.exports="dragover"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="drop"},function(t,e){t.exports="gameobjectmove"},function(t,e){t.exports="gameobjectout"},function(t,e){t.exports="gameobjectover"},function(t,e){t.exports="pointerdown"},function(t,e){t.exports="pointermove"},function(t,e){t.exports="pointerout"},function(t,e){t.exports="pointerover"},function(t,e){t.exports="pointerup"},function(t,e){t.exports="wheel"},function(t,e){t.exports="gameobjectup"},function(t,e){t.exports="gameobjectwheel"},function(t,e){t.exports="boot"},function(t,e){t.exports="process"},function(t,e){t.exports="update"},function(t,e){t.exports="pointerdown"},function(t,e){t.exports="pointerdownoutside"},function(t,e){t.exports="pointermove"},function(t,e){t.exports="pointerout"},function(t,e){t.exports="pointerover"},function(t,e){t.exports="pointerup"},function(t,e){t.exports="pointerupoutside"},function(t,e){t.exports="wheel"},function(t,e){t.exports="pointerlockchange"},function(t,e){t.exports="preupdate"},function(t,e){t.exports="shutdown"},function(t,e){t.exports="start"},function(t,e){t.exports="update"},function(t,e){t.exports=function(t){if(!t)return window.innerHeight;var e=Math.abs(window.orientation),n={w:0,h:0},i=document.createElement("div");return i.setAttribute("style","position: fixed; height: 100vh; width: 0; top: 0"),document.documentElement.appendChild(i),n.w=90===e?i.offsetHeight:window.innerWidth,n.h=90===e?window.innerWidth:i.offsetHeight,document.documentElement.removeChild(i),i=null,90!==Math.abs(window.orientation)?n.h:n.w}},function(t,e){t.exports="addfile"},function(t,e){t.exports="complete"},function(t,e){t.exports="filecomplete"},function(t,e){t.exports="filecomplete-"},function(t,e){t.exports="loaderror"},function(t,e){t.exports="load"},function(t,e){t.exports="fileprogress"},function(t,e){t.exports="postprocess"},function(t,e){t.exports="progress"},function(t,e){t.exports="start"},function(t,e,n){var i=n(2),r=n(178);t.exports=function(t){var e=t.game.config.defaultPhysicsSystem,n=i(t.settings,"physics",!1);if(e||n){var s=[];if(e&&s.push(r(e+"Physics")),n)for(var o in n)o=r(o.concat("Physics")),-1===s.indexOf(o)&&s.push(o);return s}}},function(t,e,n){var i=n(2);t.exports=function(t){var e=t.plugins.getDefaultScenePlugins(),n=i(t.settings,"plugins",!1);return Array.isArray(n)?n:e||[]}},function(t,e,n){t.exports={game:"game",anims:"anims",cache:"cache",plugins:"plugins",registry:"registry",scale:"scale",sound:"sound",textures:"textures",events:"events",cameras:"cameras",add:"add",make:"make",scenePlugin:"scene",displayList:"children",lights:"lights",data:"data",input:"input",load:"load",time:"time",tweens:"tweens",arcadePhysics:"physics",impactPhysics:"impact",matterPhysics:"matter"}},function(t,e){t.exports=function(t,e,n){if(n.getElementsByTagName("TextureAtlas")){var i=t.source[e];t.add("__BASE",e,0,0,i.width,i.height);for(var r,s=n.getElementsByTagName("SubTexture"),o=0;o<s.length;o++){var a=s[o].attributes,u=a.name.value,l=parseInt(a.x.value,10),c=parseInt(a.y.value,10),h=parseInt(a.width.value,10),d=parseInt(a.height.value,10);if(r=t.add(u,e,l,c,h,d),a.frameX){var f=Math.abs(parseInt(a.frameX.value,10)),p=Math.abs(parseInt(a.frameY.value,10)),m=parseInt(a.frameWidth.value,10),g=parseInt(a.frameHeight.value,10);r.setTrim(h,d,f,p,m,g)}}return t}console.warn("Invalid Texture Atlas XML given")}},function(t,e){t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},function(t,e){t.exports=function(t,e){var n=t.source[e];return t.add("__BASE",e,0,0,n.width,n.height),t}},function(t,e,n){var i=n(66);t.exports=function(t,e,n){if(n.frames||n.textures){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);for(var s,o=Array.isArray(n.textures)?n.textures[e].frames:n.frames,a=0;a<o.length;a++){var u=o[a];s=t.add(u.filename,e,u.frame.x,u.frame.y,u.frame.w,u.frame.h),u.trimmed&&s.setTrim(u.sourceSize.w,u.sourceSize.h,u.spriteSourceSize.x,u.spriteSourceSize.y,u.spriteSourceSize.w,u.spriteSourceSize.h),u.rotated&&(s.rotated=!0,s.updateUVsInverted()),u.anchor&&(s.customPivot=!0,s.pivotX=u.anchor.x,s.pivotY=u.anchor.y),s.customData=i(u)}for(var l in n)"frames"!==l&&(t.customData[l]=Array.isArray(n[l])?n[l].slice(0):n[l]);return t}console.warn("Invalid Texture Atlas JSON Array")}},function(t,e,n){var i=n(66);t.exports=function(t,e,n){if(n.frames){var r=t.source[e];t.add("__BASE",e,0,0,r.width,r.height);var s,o=n.frames;for(var a in o){var u=o[a];s=t.add(a,e,u.frame.x,u.frame.y,u.frame.w,u.frame.h),u.trimmed&&s.setTrim(u.sourceSize.w,u.sourceSize.h,u.spriteSourceSize.x,u.spriteSourceSize.y,u.spriteSourceSize.w,u.spriteSourceSize.h),u.rotated&&(s.rotated=!0,s.updateUVsInverted()),s.customData=i(u)}for(var l in n)"frames"!==l&&(t.customData[l]=Array.isArray(n[l])?n[l].slice(0):n[l]);return t}console.warn("Invalid Texture Atlas JSON Hash given, missing 'frames' Object")}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r,s,o,a){var u=i(a,"frameWidth",null),l=i(a,"frameHeight",u);if(null===u)throw new Error("TextureManager.SpriteSheet: Invalid frameWidth given.");var c=t.source[e];t.add("__BASE",e,0,0,c.width,c.height);var h=i(a,"startFrame",0),d=i(a,"endFrame",-1),f=i(a,"margin",0),p=i(a,"spacing",0),m=Math.floor((s-f+p)/(u+p))*Math.floor((o-f+p)/(l+p));0===m&&console.warn("SpriteSheet frame dimensions will result in zero frames."),(h>m||h<-m)&&(h=0),h<0&&(h=m+h),-1!==d&&(m=h+(d+1));for(var g=f,y=f,v=0,b=0,x=0;x<m;x++){v=0,b=0;var w=g+u,T=y+l;w>s&&(v=w-s),T>o&&(b=T-o),t.add(x,e,n+g,r+y,u-v,l-b),(g+=u+p)+u>s&&(g=f,y+=l+p)}return t}},function(t,e,n){var i=n(2);t.exports=function(t,e,n){var r=i(n,"frameWidth",null),s=i(n,"frameHeight",r);if(!r)throw new Error("TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.");var o=t.source[0];t.add("__BASE",0,0,0,o.width,o.height);var a,u=i(n,"startFrame",0),l=i(n,"endFrame",-1),c=i(n,"margin",0),h=i(n,"spacing",0),d=e.cutX,f=e.cutY,p=e.cutWidth,m=e.cutHeight,g=e.realWidth,y=e.realHeight,v=Math.floor((g-c+h)/(r+h)),b=Math.floor((y-c+h)/(s+h)),x=v*b,w=e.x,T=r-w,S=r-(g-p-w),E=e.y,O=s-E,C=s-(y-m-E);(u>x||u<-x)&&(u=0),u<0&&(u=x+u),-1!==l&&(x=u+(l+1));for(var _=c,A=c,k=0,R=e.sourceIndex,I=0;I<b;I++){for(var M=0===I,N=I===b-1,D=0;D<v;D++){var P=0===D,F=D===v-1;if(a=t.add(k,R,d+_,f+A,r,s),P||M||F||N){var L=P?w:0,j=M?E:0,B=0,z=0;P&&(B+=r-T),F&&(B+=r-S),M&&(z+=s-O),N&&(z+=s-C);var $=r-B,U=s-z;a.cutWidth=$,a.cutHeight=U,a.setTrim(r,s,L,j,$,U)}_+=h,_+=P?T:F?S:r,k++}_=c,A+=h,A+=M?O:N?C:s}return t}},function(t,e){var n=0,i=function(t,e,i,r){t.add(i,e,r.x,n-r.y-r.height,r.width,r.height)};t.exports=function(t,e,r){var s=t.source[e];t.add("__BASE",e,0,0,s.width,s.height),n=s.height;for(var o=r.split("\n"),a=/^[ ]*(- )*(\w+)+[: ]+(.*)/,u="",l="",c={x:0,y:0,width:0,height:0},h=0;h<o.length;h++){var d=o[h].match(a);if(d){var f=d[2],p=d[3];if("- "===d[1]&&(l!==u&&(i(t,e,l,c),u=l),c={x:0,y:0,width:0,height:0}),"name"!==f)switch(f){case"x":case"y":case"width":case"height":c[f]=parseInt(p,10)}else l=p}}return l!==u&&i(t,e,l,c),t}},function(t,e){t.exports="complete"},function(t,e){t.exports="decoded"},function(t,e){t.exports="decodedall"},function(t,e){t.exports="destroy"},function(t,e){t.exports="detune"},function(t,e){t.exports="detune"},function(t,e){t.exports="mute"},function(t,e){t.exports="rate"},function(t,e){t.exports="volume"},function(t,e){t.exports="loop"},function(t,e){t.exports="looped"},function(t,e){t.exports="mute"},function(t,e){t.exports="pauseall"},function(t,e){t.exports="pause"},function(t,e){t.exports="play"},function(t,e){t.exports="rate"},function(t,e){t.exports="resumeall"},function(t,e){t.exports="resume"},function(t,e){t.exports="seek"},function(t,e){t.exports="stopall"},function(t,e){t.exports="stop"},function(t,e){t.exports="unlocked"},function(t,e){t.exports="volume"},function(t,e,n){var i={Events:n(90),DisplayList:n(890),GameObjectCreator:n(15),GameObjectFactory:n(5),UpdateList:n(918),Components:n(12),BuildGameObject:n(27),BuildGameObjectAnimation:n(369),GameObject:n(13),BitmapText:n(127),Blitter:n(185),Container:n(186),DOMElement:n(371),DynamicBitmapText:n(187),Extern:n(373),Graphics:n(188),Group:n(97),Image:n(98),Particles:n(950),PathFollower:n(385),RenderTexture:n(192),RetroFont:n(959),Sprite:n(68),Text:n(194),TileSprite:n(195),Zone:n(108),Video:n(196),Shape:n(30),Arc:n(386),Curve:n(387),Ellipse:n(388),Grid:n(389),IsoBox:n(390),IsoTriangle:n(391),Line:n(392),Polygon:n(393),Rectangle:n(398),Star:n(399),Triangle:n(400),Factories:{Blitter:n(1007),Container:n(1008),DOMElement:n(1009),DynamicBitmapText:n(1010),Extern:n(1011),Graphics:n(1012),Group:n(1013),Image:n(1014),Particles:n(1015),PathFollower:n(1016),RenderTexture:n(1017),Sprite:n(1018),StaticBitmapText:n(1019),Text:n(1020),TileSprite:n(1021),Zone:n(1022),Video:n(1023),Arc:n(1024),Curve:n(1025),Ellipse:n(1026),Grid:n(1027),IsoBox:n(1028),IsoTriangle:n(1029),Line:n(1030),Polygon:n(1031),Rectangle:n(1032),Star:n(1033),Triangle:n(1034)},Creators:{Blitter:n(1035),Container:n(1036),DynamicBitmapText:n(1037),Graphics:n(1038),Group:n(1039),Image:n(1040),Particles:n(1041),RenderTexture:n(1042),Sprite:n(1043),StaticBitmapText:n(1044),Text:n(1045),TileSprite:n(1046),Zone:n(1047),Video:n(1048)}};i.Mesh=n(128),i.Quad=n(199),i.Shader=n(200),i.Factories.Mesh=n(1055),i.Factories.Quad=n(1056),i.Factories.Shader=n(1057),i.Creators.Mesh=n(1058),i.Creators.Quad=n(1059),i.Creators.Shader=n(1060),i.Light=n(404),n(405),n(1061),t.exports=i},function(t,e,n){var i=n(0),r=n(124),s=n(20),o=n(21),a=n(126),u=new i({Extends:r,initialize:function(t){r.call(this,t),this.sortChildrenFlag=!1,this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.systems.events.once(o.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(o.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=!0},depthSort:function(){this.sortChildrenFlag&&(a.inplace(this.list,this.sortByDepth),this.sortChildrenFlag=!1)},sortByDepth:function(t,e){return t._depth-e._depth},getChildren:function(){return this.list},shutdown:function(){for(var t=this.list.length;t--;)this.list[t].destroy(!0);this.list.length=0,this.systems.events.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("DisplayList",u,"displayList"),t.exports=u},function(t,e,n){t.exports={CheckMatrix:n(181),MatrixToString:n(892),ReverseColumns:n(893),ReverseRows:n(894),Rotate180:n(895),RotateLeft:n(896),RotateMatrix:n(125),RotateRight:n(897),TransposeMatrix:n(366)}},function(t,e,n){var i=n(158),r=n(181);t.exports=function(t){var e="";if(!r(t))return e;for(var n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++){var o=t[n][s].toString();e+="undefined"!==o?i(o,2):"?",s<t[n].length-1&&(e+=" |")}if(n<t.length-1){e+="\n";for(var a=0;a<t[n].length;a++)e+="---",a<t[n].length-1&&(e+="+");e+="\n"}}return e}},function(t,e){t.exports=function(t){return t.reverse()}},function(t,e){t.exports=function(t){for(var e=0;e<t.length;e++)t[e].reverse();return t}},function(t,e,n){var i=n(125);t.exports=function(t){return i(t,180)}},function(t,e,n){var i=n(125);t.exports=function(t){return i(t,90)}},function(t,e,n){var i=n(125);t.exports=function(t){return i(t,-90)}},function(t,e){t.exports=function(t,e,n,i,r){if(void 0===r&&(r=t),n>0){var s=n-t.length;if(s<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.push(e),i&&i.call(r,e),e):null;for(var o=e.length-1;o>=0;)-1!==t.indexOf(e[o])&&e.splice(o,1),o--;if(0===(o=e.length))return null;n>0&&o>s&&(e.splice(s),o=s);for(var a=0;a<o;a++){var u=e[a];t.push(u),i&&i.call(r,u)}return e}},function(t,e){t.exports=function(t,e,n,i,r,s){if(void 0===n&&(n=0),void 0===s&&(s=t),i>0){var o=i-t.length;if(o<=0)return null}if(!Array.isArray(e))return-1===t.indexOf(e)?(t.splice(n,0,e),r&&r.call(s,e),e):null;for(var a=e.length-1;a>=0;)-1!==t.indexOf(e[a])&&e.pop(),a--;if(0===(a=e.length))return null;i>0&&a>o&&(e.splice(o),a=o);for(var u=a-1;u>=0;u--){var l=e[u];t.splice(n,0,l),r&&r.call(s,l)}return e}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n<t.length&&(t.splice(n,1),t.push(e)),e}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=0;if(i(t,r,s))for(var a=r;a<s;a++)t[a][e]===n&&o++;return o}},function(t,e){t.exports=function(t,e,n){var i,r=[null];for(i=3;i<arguments.length;i++)r.push(arguments[i]);for(i=0;i<t.length;i++)r[0]=t[i],e.apply(n,r);return t}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s)){var o,a=[null];for(o=5;o<arguments.length;o++)a.push(arguments[o]);for(o=r;o<s;o++)a[0]=t[o],e.apply(n,a)}return t}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){void 0===r&&(r=0),void 0===s&&(s=t.length);var o=[];if(i(t,r,s))for(var a=r;a<s;a++){var u=t[a];(!e||e&&void 0===n&&u.hasOwnProperty(e)||e&&void 0!==n&&u[e]===n)&&o.push(u)}return o}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];if(!e||e&&void 0===n&&a.hasOwnProperty(e)||e&&void 0!==n&&a[e]===n)return a}return null}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);if(n>0){var i=t[n-1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},function(t,e){t.exports=function(t,e,n){var i=t.indexOf(e);if(-1===i||n<0||n>=t.length)throw new Error("Supplied index out of bounds");return i!==n&&(t.splice(i,1),t.splice(n,0,e)),e}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);if(-1!==n&&n<t.length-1){var i=t[n+1],r=t.indexOf(i);t[n]=i,t[r]=e}return t}},function(t,e){t.exports=function(t,e,n,i){for(var r=[],s=t;s<=e;s++)if(n||i){var o=n?n+s.toString():s.toString();i&&(o=o.concat(i)),r.push(o)}else r.push(s);return r}},function(t,e,n){var i=n(312);t.exports=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=null),void 0===n&&(n=1),null===e&&(e=t,t=0);for(var r=[],s=Math.max(i((e-t)/(n||1)),0),o=0;o<s;o++)r.push(t),t+=n;return r}},function(t,e,n){var i=n(79);t.exports=function(t,e,n,r){if(void 0===r&&(r=t),e<0||e>t.length-1)throw new Error("Index out of bounds");var s=i(t,e);return n&&n.call(r,s),s}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){if(void 0===e&&(e=0),void 0===n&&(n=t.length),void 0===s&&(s=t),i(t,e,n)){var o=t.splice(e,n-e);if(r)for(var a=0;a<o.length;a++)r.call(s,o[a]);return o}return[]}},function(t,e,n){var i=n(79);t.exports=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length);var r=e+Math.floor(Math.random()*n);return i(t,r)}},function(t,e){t.exports=function(t,e,n){var i=t.indexOf(e),r=t.indexOf(n);return-1!==i&&-1===r&&(t[i]=n,!0)}},function(t,e){t.exports=function(t,e){var n=t.indexOf(e);return-1!==n&&n>0&&(t.splice(n,1),t.unshift(e)),e}},function(t,e,n){var i=n(67);t.exports=function(t,e,n,r,s){if(void 0===r&&(r=0),void 0===s&&(s=t.length),i(t,r,s))for(var o=r;o<s;o++){var a=t[o];a.hasOwnProperty(e)&&(a[e]=n)}return t}},function(t,e){t.exports=function(t,e,n){if(e!==n){var i=t.indexOf(e),r=t.indexOf(n);if(i<0||r<0)throw new Error("Supplied items must be elements of the same array");return t[i]=n,t[r]=e,t}}},function(t,e,n){var i=n(0),r=n(183),s=n(20),o=n(21),a=new i({Extends:r,initialize:function(t){r.call(this),this.scene=t,this.systems=t.sys,t.sys.events.once(o.BOOT,this.boot,this),t.sys.events.on(o.START,this.start,this)},boot:function(){this.systems.events.once(o.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(o.PRE_UPDATE,this.update,this),t.on(o.UPDATE,this.sceneUpdate,this),t.once(o.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(t,e){for(var n=this._active,i=n.length,r=0;r<i;r++){var s=n[r];s.active&&s.preUpdate.call(s,t,e)}},shutdown:function(){for(var t=this._active.length;t--;)this._active[t].destroy(!0);for(t=this._pending.length;t--;)this._pending[t].destroy(!0);for(t=this._destroy.length;t--;)this._destroy[t].destroy(!0);this._toProcess=0,this._pending=[],this._active=[],this._destroy=[],this.removeAllListeners();var e=this.systems.events;e.off(o.PRE_UPDATE,this.preUpdate,this),e.off(o.UPDATE,this.sceneUpdate,this),e.off(o.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.systems.events.off(o.START,this.start,this),this.scene=null,this.systems=null}});s.register("UpdateList",a,"updateList"),t.exports=a},function(t,e,n){t.exports={PROCESS_QUEUE_ADD:n(920),PROCESS_QUEUE_REMOVE:n(921)}},function(t,e){t.exports="add"},function(t,e){t.exports="remove"},function(t,e){t.exports=function(t,e,n){void 0===n&&(n={local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null}});for(var i=t.text,r=i.length,s=Number.MAX_VALUE,o=Number.MAX_VALUE,a=0,u=0,l=t.fontData.chars,c=t.fontData.lineHeight,h=t.letterSpacing,d=0,f=0,p=0,m=null,g=0,y=0,v=t.fontSize/t.fontData.size,b=v*t.scaleX,x=v*t.scaleY,w=null,T=0,S=[],E=Number.MAX_VALUE,O=0,C=0,_=0,A=0;A<r;A++)if(10!==(p=i.charCodeAt(A))){if(m=l[p]){if(g=d,null!==w){var k=m.kerning[T];g+=void 0!==k?k:0}s>g&&(s=g),o>(y=f)&&(o=y);var R=g+m.xAdvance,I=y+c;a<R&&(a=R),u<I&&(u=I),d+=m.xAdvance+h,w=m,T=p,_=R*v}}else d=0,f+=c,w=null,S[C]=_,_>O&&(O=_),_<E&&(E=_),C++,_=0;S[C]=_,_>O&&(O=_),_<E&&(E=_);var M=n.local,N=n.global,D=n.lines;return M.x=s*v,M.y=o*v,M.width=a*v,M.height=u*v,N.x=t.x-t.displayOriginX+s*b,N.y=t.y-t.displayOriginY+o*x,N.width=a*b,N.height=u*x,D.shortest=E,D.longest=O,D.lengths=S,e&&(M.x=Math.round(M.x),M.y=Math.round(M.y),M.width=Math.round(M.width),M.height=Math.round(M.height),N.x=Math.round(N.x),N.y=Math.round(N.y),N.width=Math.round(N.width),N.height=Math.round(N.height),D.shortest=Math.round(E),D.longest=Math.round(O)),n}},function(t,e,n){var i=n(184);t.exports=function(t,e,n,r,s,o,a){var u=t.sys.textures.getFrame(n,r),l=t.sys.cache.xml.get(s);if(u&&l){var c=i(l,o,a,u);return t.sys.cache.bitmapFont.add(e,{data:c,texture:n,frame:r}),!0}return!1}},function(t,e,n){var i=n(1),r=n(1);i=n(925),r=n(926),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=e._text,a=o.length;if(0!==a){var u=this.pipeline;t.setPipeline(u,e);var l=u._tempMatrix1,c=u._tempMatrix2,h=u._tempMatrix3;c.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),l.copyFrom(r.matrix),s?(l.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),c.e=e.x,c.f=e.y,l.multiply(c,h)):(c.e-=r.scrollX*e.scrollFactorX,c.f-=r.scrollY*e.scrollFactorY,l.multiply(c,h));var d=e.frame,f=d.glTexture,p=d.cutX,m=d.cutY,g=f.width,y=f.height,v=e._isTinted&&e.tintFill,b=i.getTintAppendFloatAlpha(e._tintTL,r.alpha*e._alphaTL),x=i.getTintAppendFloatAlpha(e._tintTR,r.alpha*e._alphaTR),w=i.getTintAppendFloatAlpha(e._tintBL,r.alpha*e._alphaBL),T=i.getTintAppendFloatAlpha(e._tintBR,r.alpha*e._alphaBR);u.setTexture2D(f,0);var S,E,O=0,C=0,_=0,A=0,k=e._letterSpacing,R=0,I=0,M=0,N=0,D=e.fontData,P=D.chars,F=D.lineHeight,L=e._fontSize/D.size,j=e._align,B=0,z=0;e.getTextBounds(!1);var $=e._bounds.lines;1===j?z=($.longest-$.lengths[0])/2:2===j&&(z=$.longest-$.lengths[0]);for(var U=r.roundPixels,W=0;W<a;W++)if(10!==(_=o.charCodeAt(W))){if(S=P[_]){R=p+S.x,I=m+S.y,N=S.height;var V=S.xOffset+O,Y=S.yOffset+C;if(null!==E){var G=S.kerning[A];V+=void 0!==G?G:0}if(O+=S.xAdvance+k,E=S,A=_,0!==(M=S.width)&&0!==N&&32!==_){V*=L,Y*=L,V-=e.displayOriginX;var X=R/g,H=I/y,q=(R+M)/g,K=(I+N)/y,J=(V+=z)+M*L,Q=(Y-=e.displayOriginY)+N*L,Z=h.getX(V,Y),tt=h.getY(V,Y),et=h.getX(V,Q),nt=h.getY(V,Q),it=h.getX(J,Q),rt=h.getY(J,Q),st=h.getX(J,Y),ot=h.getY(J,Y);U&&(Z=Math.round(Z),tt=Math.round(tt),et=Math.round(et),nt=Math.round(nt),it=Math.round(it),rt=Math.round(rt),st=Math.round(st),ot=Math.round(ot)),u.batchQuad(Z,tt,et,nt,it,rt,st,ot,X,H,q,K,b,x,w,T,v,f,0)}}}else B++,1===j?z=($.longest-$.lengths[B])/2:2===j&&(z=$.longest-$.lengths[B]),O=0,C+=F,E=null}}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s){var o=e._text,a=o.length,u=t.currentContext;if(0!==a&&i(t,u,e,r,s)){var l=e.frame,c=e.fontData.chars,h=e.fontData.lineHeight,d=e._letterSpacing,f=0,p=0,m=0,g=null,y=0,v=0,b=0,x=0,w=0,T=0,S=null,E=0,O=e.frame.source.image,C=l.cutX,_=l.cutY,A=e._fontSize/e.fontData.size,k=e._align,R=0,I=0;e.getTextBounds(!1);var M=e._bounds.lines;1===k?I=(M.longest-M.lengths[0])/2:2===k&&(I=M.longest-M.lengths[0]),u.translate(-e.displayOriginX,-e.displayOriginY);for(var N=r.roundPixels,D=0;D<a;D++)if(10!==(m=o.charCodeAt(D))){if(g=c[m]){if(y=C+g.x,v=_+g.y,x=g.height,w=g.xOffset+f,T=g.yOffset+p,null!==S){var P=g.kerning[E];w+=void 0!==P?P:0}w*=A,T*=A,w+=I,f+=g.xAdvance+d,S=g,E=m,0!==(b=g.width)&&0!==x&&32!==m&&(N&&(w=Math.round(w),T=Math.round(T)),u.save(),u.translate(w,T),u.scale(A,A),u.drawImage(O,y,v,b,x,0,0,b,x),u.restore())}}else R++,1===k?I=(M.longest-M.lengths[R])/2:2===k&&(I=M.longest-M.lengths[R]),f=0,p+=h,S=null;u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(928),r=n(929),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=e.getRenderList();if(0!==o.length){var a=this.pipeline;t.setPipeline(a,e);var u=r.scrollX*e.scrollFactorX,l=r.scrollY*e.scrollFactorY,c=a._tempMatrix1;c.copyFrom(r.matrix),s&&(c.multiplyWithOffset(s,-u,-l),u=0,l=0);for(var h=e.x-u,d=e.y-l,f=-1,p=r.alpha*e.alpha,m=r.roundPixels,g=0;g<o.length;g++){var y=o[g],v=y.frame,b=y.alpha*p;if(0!==b){var x=v.width,w=v.height,T=h+y.x+v.x,S=d+y.y+v.y;y.flipX&&(x*=-1,T+=v.width),y.flipY&&(w*=-1,S+=v.height);var E=T+x,O=S+w,C=c.getX(T,S),_=c.getY(T,S),A=c.getX(E,O),k=c.getY(E,O),R=i.getTintAppendFloatAlpha(y.tint,b);v.sourceIndex!==f&&(a.setTexture2D(v.glTexture,0),f=v.sourceIndex),m&&(C=Math.round(C),_=Math.round(_),A=Math.round(A),k=Math.round(k)),a.batchQuad(C,_,C,k,A,k,A,_,v.u0,v.v0,v.u1,v.v1,R,R,R,R,!1,v.glTexture,0)&&(f=-1)}}}}},function(t,e){t.exports=function(t,e,n,i,r){var s=e.getRenderList();if(0!==s.length){var o=t.currentContext,a=i.alpha*e.alpha;if(0!==a){o.globalCompositeOperation=t.blendModes[e.blendMode],o.imageSmoothingEnabled=!(!t.antialias||e.frame.source.scaleMode);var u=e.x-i.scrollX*e.scrollFactorX,l=e.y-i.scrollY*e.scrollFactorY;o.save(),r&&r.copyToContext(o);for(var c=i.roundPixels,h=0;h<s.length;h++){var d=s[h],f=d.flipX||d.flipY,p=d.frame,m=p.canvasData,g=p.x,y=p.y,v=1,b=1,x=d.alpha*a;0!==x&&(o.globalAlpha=x,f?(d.flipX&&(v=-1,g-=m.width),d.flipY&&(b=-1,y-=m.height),o.save(),o.translate(d.x+u,d.y+l),o.scale(v,b),o.drawImage(p.source.image,m.x,m.y,m.width,m.height,g,y,m.width,m.height),o.restore()):(c&&(g=Math.round(g),y=Math.round(y)),o.drawImage(p.source.image,m.x,m.y,m.width,m.height,g+d.x+u,y+d.y+l,m.width,m.height)))}o.restore()}}}},function(t,e,n){var i=n(0),r=n(94),s=new i({initialize:function(t,e,n,i,r){this.parent=t,this.x=e,this.y=n,this.frame=i,this.data={},this.tint=16777215,this._visible=r,this._alpha=1,this.flipX=!1,this.flipY=!1},setFrame:function(t){return this.frame=void 0===t?this.parent.frame:t instanceof r&&t.texture===this.parent.texture?t:this.parent.texture.get(t),this},resetFlip:function(){return this.flipX=!1,this.flipY=!1,this},reset:function(t,e,n){return this.x=t,this.y=e,this.flipX=!1,this.flipY=!1,this._alpha=1,this._visible=!0,this.parent.dirty=!0,n&&this.setFrame(n),this},setPosition:function(t,e){return this.x=t,this.y=e,this},setFlipX:function(t){return this.flipX=t,this},setFlipY:function(t){return this.flipY=t,this},setFlip:function(t,e){return this.flipX=t,this.flipY=e,this},setVisible:function(t){return this.visible=t,this},setAlpha:function(t){return this.alpha=t,this},setTint:function(t){return this.tint=t,this},destroy:function(){this.parent.dirty=!0,this.parent.children.remove(this),this.parent=void 0,this.frame=void 0,this.data=void 0},visible:{get:function(){return this._visible},set:function(t){this.parent.dirty|=this._visible!==t,this._visible=t}},alpha:{get:function(){return this._alpha},set:function(t){this.parent.dirty|=this._alpha>0!=t>0,this._alpha=t}}});t.exports=s},function(t,e,n){var i=n(1),r=n(1);i=n(932),r=n(933),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){var s=e.list;if(0!==s.length){var o=e.localTransform;r?(o.loadIdentity(),o.multiply(r),o.translate(e.x,e.y),o.rotate(e.rotation),o.scale(e.scaleX,e.scaleY)):o.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var a=-1!==e.blendMode;a||t.setBlendMode(0);for(var u=e.alphaTopLeft,l=e.alphaTopRight,c=e.alphaBottomLeft,h=e.alphaBottomRight,d=e.scrollFactorX,f=e.scrollFactorY,p=s,m=s.length,g=0;g<m;g++){var y=s[g];if(y.willRender(i)){var v,b,x,w;if(void 0!==y.alphaTopLeft)v=y.alphaTopLeft,b=y.alphaTopRight,x=y.alphaBottomLeft,w=y.alphaBottomRight;else{var T=y.alpha;v=T,b=T,x=T,w=T}var S=y.scrollFactorX,E=y.scrollFactorY;a||y.blendMode===t.currentBlendMode||t.setBlendMode(y.blendMode);var O=y.mask;O&&O.preRenderWebGL(t,y,i);var C=y.type;C!==t.currentType&&(t.newType=!0,t.currentType=C),t.nextTypeMatch=g<m-1&&p[g+1].type===t.currentType,y.setScrollFactor(S*d,E*f),y.setAlpha(v*u,b*l,x*c,w*h),y.renderWebGL(t,y,n,i,o),y.setAlpha(v,b,x,w),y.setScrollFactor(S,E),O&&O.postRenderWebGL(t,i),t.newType=!1}}}}},function(t,e){t.exports=function(t,e,n,i,r){var s=e.list;if(0!==s.length){var o=e.localTransform;r?(o.loadIdentity(),o.multiply(r),o.translate(e.x,e.y),o.rotate(e.rotation),o.scale(e.scaleX,e.scaleY)):o.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);var a=-1!==e.blendMode;a||t.setBlendMode(0);for(var u=e._alpha,l=e.scrollFactorX,c=e.scrollFactorY,h=0;h<s.length;h++){var d=s[h];if(d.willRender(i)){var f=d.alpha,p=d.scrollFactorX,m=d.scrollFactorY;a||d.blendMode===t.currentBlendMode||t.setBlendMode(d.blendMode),d.setScrollFactor(p*l,m*c),d.setAlpha(f*u),d.renderCanvas(t,d,n,i,o),d.setAlpha(f),d.setScrollFactor(p,m)}}}}},function(t,e,n){var i=n(1),r=n(1);i=n(372),r=n(372),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=["normal","multiply","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]},function(t,e,n){var i=n(1),r=n(1);i=n(937),r=n(938),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=e.text,a=o.length;if(0!==a){var u=this.pipeline;t.setPipeline(u,e);var l=e.cropWidth>0||e.cropHeight>0;l&&(u.flush(),t.pushScissor(e.x,e.y,e.cropWidth*e.scaleX,e.cropHeight*e.scaleY));var c=u._tempMatrix1,h=u._tempMatrix2,d=u._tempMatrix3,f=u._tempMatrix4;h.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),c.copyFrom(r.matrix),s?(c.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),h.e=e.x,h.f=e.y,c.multiply(h,d)):(h.e-=r.scrollX*e.scrollFactorX,h.f-=r.scrollY*e.scrollFactorY,c.multiply(h,d));var p=e.frame,m=p.glTexture,g=p.cutX,y=p.cutY,v=m.width,b=m.height,x=e._isTinted&&e.tintFill,w=i.getTintAppendFloatAlpha(e._tintTL,r.alpha*e._alphaTL),T=i.getTintAppendFloatAlpha(e._tintTR,r.alpha*e._alphaTR),S=i.getTintAppendFloatAlpha(e._tintBL,r.alpha*e._alphaBL),E=i.getTintAppendFloatAlpha(e._tintBR,r.alpha*e._alphaBR);u.setTexture2D(m,0);var O,C,_=0,A=0,k=0,R=0,I=e.letterSpacing,M=0,N=0,D=0,P=0,F=e.scrollX,L=e.scrollY,j=e.fontData,B=j.chars,z=j.lineHeight,$=e.fontSize/j.size,U=0,W=e._align,V=0,Y=0;e.getTextBounds(!1);var G=e._bounds.lines;1===W?Y=(G.longest-G.lengths[0])/2:2===W&&(Y=G.longest-G.lengths[0]);for(var X=r.roundPixels,H=e.displayCallback,q=e.callbackData,K=0;K<a;K++)if(10!==(k=o.charCodeAt(K))){if(O=B[k]){M=g+O.x,N=y+O.y,P=O.height;var J=O.xOffset+_-F,Q=O.yOffset+A-L;if(null!==C){var Z=O.kerning[R];J+=void 0!==Z?Z:0}if(_+=O.xAdvance+I,C=O,R=k,0!==(D=O.width)&&0!==P&&32!==k){if($=e.fontSize/e.fontData.size,U=0,H){q.color=0,q.tint.topLeft=w,q.tint.topRight=T,q.tint.bottomLeft=S,q.tint.bottomRight=E,q.index=K,q.charCode=k,q.x=J,q.y=Q,q.scale=$,q.rotation=U,q.data=O.data;var tt=H(q);J=tt.x,Q=tt.y,$=tt.scale,U=tt.rotation,tt.color?(w=tt.color,T=tt.color,S=tt.color,E=tt.color):(w=tt.tint.topLeft,T=tt.tint.topRight,S=tt.tint.bottomLeft,E=tt.tint.bottomRight),w=i.getTintAppendFloatAlpha(w,r.alpha*e._alphaTL),T=i.getTintAppendFloatAlpha(T,r.alpha*e._alphaTR),S=i.getTintAppendFloatAlpha(S,r.alpha*e._alphaBL),E=i.getTintAppendFloatAlpha(E,r.alpha*e._alphaBR)}J*=$,Q*=$,J-=e.displayOriginX,f.applyITRS(J+=Y,Q-=e.displayOriginY,U,$,$),d.multiply(f,h);var et=M/v,nt=N/b,it=(M+D)/v,rt=(N+P)/b,st=h.e,ot=h.f,at=P*h.c+h.e,ut=P*h.d+h.f,lt=D*h.a+P*h.c+h.e,ct=D*h.b+P*h.d+h.f,ht=D*h.a+h.e,dt=D*h.b+h.f;X&&(st=Math.round(st),ot=Math.round(ot),at=Math.round(at),ut=Math.round(ut),lt=Math.round(lt),ct=Math.round(ct),ht=Math.round(ht),dt=Math.round(dt)),u.batchQuad(st,ot,at,ut,lt,ct,ht,dt,et,nt,it,rt,w,T,S,E,x,m,0)}}}else V++,1===W?Y=(G.longest-G.lengths[V])/2:2===W&&(Y=G.longest-G.lengths[V]),_=0,A+=z,C=null;l&&(u.flush(),t.popScissor())}}},function(t,e,n){var i=n(26);t.exports=function(t,e,n,r,s){var o=e._text,a=o.length,u=t.currentContext;if(0!==a&&i(t,u,e,r,s)){var l=e.frame,c=e.displayCallback,h=e.callbackData,d=e.fontData.chars,f=e.fontData.lineHeight,p=e._letterSpacing,m=0,g=0,y=0,v=null,b=0,x=0,w=0,T=0,S=0,E=0,O=null,C=0,_=e.frame.source.image,A=l.cutX,k=l.cutY,R=0,I=0,M=e._fontSize/e.fontData.size,N=e._align,D=0,P=0;e.getTextBounds(!1);var F=e._bounds.lines;1===N?P=(F.longest-F.lengths[0])/2:2===N&&(P=F.longest-F.lengths[0]),u.translate(-e.displayOriginX,-e.displayOriginY);var L=r.roundPixels;e.cropWidth>0&&e.cropHeight>0&&(u.beginPath(),u.rect(0,0,e.cropWidth,e.cropHeight),u.clip());for(var j=0;j<a;j++)if(I=M,R=0,10!==(y=o.charCodeAt(j))){if(v=d[y]){if(b=A+v.x,x=k+v.y,w=v.width,T=v.height,S=v.xOffset+m-e.scrollX,E=v.yOffset+g-e.scrollY,null!==O){var B=v.kerning[C];S+=void 0!==B?B:0}if(c){h.index=j,h.charCode=y,h.x=S,h.y=E,h.scale=I,h.rotation=R,h.data=v.data;var z=c(h);S=z.x,E=z.y,I=z.scale,R=z.rotation}S*=I,E*=I,S+=P,m+=v.xAdvance+p,O=v,C=y,0!==w&&0!==T&&32!==y&&(L&&(S=Math.round(S),E=Math.round(E)),u.save(),u.translate(S,E),u.rotate(R),u.scale(I,I),u.drawImage(_,b,x,w,T,0,0,w,T),u.restore())}}else D++,1===N?P=(F.longest-F.lengths[D])/2:2===N&&(P=F.longest-F.lengths[D]),m=0,g+=f,O=null;u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(940),r=n(941),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){var s=t.currentPipeline;t.clearPipeline();var o=t._tempMatrix1,a=t._tempMatrix2,u=t._tempMatrix3;a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),o.copyFrom(i.matrix),r?(o.multiplyWithOffset(r,-i.scrollX*e.scrollFactorX,-i.scrollY*e.scrollFactorY),a.e=e.x,a.f=e.y,o.multiply(a,u)):(a.e-=i.scrollX*e.scrollFactorX,a.f-=i.scrollY*e.scrollFactorY,o.multiply(a,u)),e.render.call(e,t,i,u),t.rebindPipeline(s)}},function(t,e){},function(t,e,n){var i=n(1),r=n(1);i=n(943),n(377),r=n(377),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(189),r=n(10),s=function(t,e,n){this.x=t,this.y=e,this.width=n},o=function(t,e,n){this.points=[],this.pointsLength=1,this.points[0]=new s(t,e,n)},a=[];t.exports=function(t,e,n,u,l){if(0!==e.commandBuffer.length){var c=this.pipeline;t.setPipeline(c,e);var h=e._tempMatrix1,d=e._tempMatrix2,f=e._tempMatrix3;f.loadIdentity(),d.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),h.copyFrom(u.matrix),l?(h.multiplyWithOffset(l,-u.scrollX*e.scrollFactorX,-u.scrollY*e.scrollFactorY),d.e=e.x,d.f=e.y,h.multiply(d)):(d.e-=u.scrollX*e.scrollFactorX,d.f-=u.scrollY*e.scrollFactorY,h.multiply(d));for(var p=e.commandBuffer,m=u.alpha*e.alpha,g=1,y=c.fillTint,v=c.strokeTint,b=0,x=0,w=0,T=2*Math.PI,S=[],E=0,O=!1,C=null,_=r.getTintAppendFloatAlphaAndSwap,A=t.blankTexture.glTexture,k=0;k<p.length;k++)switch(p[k]){case i.BEGIN_PATH:S.length=0,C=null,O=!0;break;case i.CLOSE_PATH:O=!1,C&&C.points.length&&C.points.push(C.points[0]);break;case i.FILL_PATH:for(E=0;E<S.length;E++)c.setTexture2D(A),c.batchFillPath(S[E].points,f,h);break;case i.STROKE_PATH:for(E=0;E<S.length;E++)c.setTexture2D(A),c.batchStrokePath(S[E].points,g,O,f,h);break;case i.LINE_STYLE:g=p[++k];var R=_(p[++k],p[++k]*m);v.TL=R,v.TR=R,v.BL=R,v.BR=R;break;case i.FILL_STYLE:var I=_(p[++k],p[++k]*m);y.TL=I,y.TR=I,y.BL=I,y.BR=I;break;case i.GRADIENT_FILL_STYLE:var M=p[++k]*m;y.TL=_(p[++k],M),y.TR=_(p[++k],M),y.BL=_(p[++k],M),y.BR=_(p[++k],M);break;case i.GRADIENT_LINE_STYLE:g=p[++k];var N=p[++k]*m;v.TL=_(p[++k],N),v.TR=_(p[++k],N),v.BL=_(p[++k],N),v.BR=_(p[++k],N);break;case i.ARC:var D=0,P=p[++k],F=p[++k],L=p[++k],j=p[++k],B=p[++k],z=p[++k],$=p[++k];for(B-=j,z?B<-T?B=-T:B>0&&(B=B%T-T):B>T?B=T:B<0&&(B=T+B%T),null===C&&(C=new o(P+Math.cos(j)*L,F+Math.sin(j)*L,g),S.push(C),D+=.01);D<1+$;)w=B*D+j,b=P+Math.cos(w)*L,x=F+Math.sin(w)*L,C.points.push(new s(b,x,g)),D+=.01;w=B+j,b=P+Math.cos(w)*L,x=F+Math.sin(w)*L,C.points.push(new s(b,x,g));break;case i.FILL_RECT:c.setTexture2D(A),c.batchFillRect(p[++k],p[++k],p[++k],p[++k],f,h);break;case i.FILL_TRIANGLE:c.setTexture2D(A),c.batchFillTriangle(p[++k],p[++k],p[++k],p[++k],p[++k],p[++k],f,h);break;case i.STROKE_TRIANGLE:c.setTexture2D(A),c.batchStrokeTriangle(p[++k],p[++k],p[++k],p[++k],p[++k],p[++k],g,f,h);break;case i.LINE_TO:null!==C?C.points.push(new s(p[++k],p[++k],g)):(C=new o(p[++k],p[++k],g),S.push(C));break;case i.MOVE_TO:C=new o(p[++k],p[++k],g),S.push(C);break;case i.SAVE:a.push(f.copyToArray());break;case i.RESTORE:f.copyFromArray(a.pop());break;case i.TRANSLATE:P=p[++k],F=p[++k],f.translate(P,F);break;case i.SCALE:P=p[++k],F=p[++k],f.scale(P,F);break;case i.ROTATE:f.rotate(p[++k]);break;case i.SET_TEXTURE:var U=p[++k],W=p[++k];c.currentFrame=U,c.setTexture2D(U.glTexture,0),c.tintEffect=W,A=U.glTexture;break;case i.CLEAR_TEXTURE:c.currentFrame=t.blankTexture,c.tintEffect=2,A=t.blankTexture.glTexture}}}},function(t,e,n){var i=n(1),r=n(1);i=n(945),r=n(946),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){this.pipeline.batchSprite(e,i,r)}},function(t,e){t.exports=function(t,e,n,i,r){t.batchSprite(e,e.frame,i,r)}},function(t,e,n){var i=n(1),r=n(1);i=n(948),r=n(949),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){this.pipeline.batchSprite(e,i,r)}},function(t,e){t.exports=function(t,e,n,i,r){t.batchSprite(e,e.frame,i,r)}},function(t,e,n){t.exports={GravityWell:n(378),Particle:n(379),ParticleEmitter:n(380),ParticleEmitterManager:n(191),Zones:n(955)}},function(t,e,n){var i=n(0),r=n(310),s=n(82),o=n(2),a=n(57),u=new i({initialize:function(t,e,n,i){void 0===i&&(i=!1),this.propertyKey=e,this.propertyValue=n,this.defaultValue=n,this.steps=0,this.counter=0,this.start=0,this.end=0,this.emitOnly=i,this.onEmit=this.defaultEmit,this.onUpdate=this.defaultUpdate,this.loadConfig(t)},loadConfig:function(t,e){void 0===t&&(t={}),e&&(this.propertyKey=e),this.propertyValue=o(t,this.propertyKey,this.defaultValue),this.setMethods(),this.emitOnly&&(this.onUpdate=this.defaultUpdate)},toJSON:function(){return this.propertyValue},onChange:function(t){return this.propertyValue=t,this.setMethods()},setMethods:function(){var t=this.propertyValue,e=typeof t;if("number"===e)this.onEmit=this.staticValueEmit,this.onUpdate=this.staticValueUpdate;else if(Array.isArray(t))this.onEmit=this.randomStaticValueEmit;else if("function"===e)this.emitOnly?this.onEmit=t:this.onUpdate=t;else if("object"===e&&(this.has(t,"random")||this.hasBoth(t,"start","end")||this.hasBoth(t,"min","max"))){this.start=this.has(t,"start")?t.start:t.min,this.end=this.has(t,"end")?t.end:t.max;var n=this.hasBoth(t,"min","max")||!!t.random;if(n){var i=t.random;Array.isArray(i)&&(this.start=i[0],this.end=i[1]),this.onEmit=this.randomRangedValueEmit}if(this.has(t,"steps"))this.steps=t.steps,this.counter=this.start,this.onEmit=this.steppedEmit;else{var r=this.has(t,"ease")?t.ease:"Linear";this.ease=s(r),n||(this.onEmit=this.easedValueEmit),this.onUpdate=this.easeValueUpdate}}else"object"===e&&this.hasEither(t,"onEmit","onUpdate")&&(this.has(t,"onEmit")&&(this.onEmit=t.onEmit),this.has(t,"onUpdate")&&(this.onUpdate=t.onUpdate));return this},has:function(t,e){return t.hasOwnProperty(e)},hasBoth:function(t,e,n){return t.hasOwnProperty(e)&&t.hasOwnProperty(n)},hasEither:function(t,e,n){return t.hasOwnProperty(e)||t.hasOwnProperty(n)},defaultEmit:function(t,e,n){return n},defaultUpdate:function(t,e,n,i){return i},staticValueEmit:function(){return this.propertyValue},staticValueUpdate:function(){return this.propertyValue},randomStaticValueEmit:function(){var t=Math.floor(Math.random()*this.propertyValue.length);return this.propertyValue[t]},randomRangedValueEmit:function(t,e){var n=r(this.start,this.end);return t&&t.data[e]&&(t.data[e].min=n),n},steppedEmit:function(){var t=this.counter;return this.counter=a(this.counter+(this.end-this.start)/this.steps,this.start,this.end),t},easedValueEmit:function(t,e){if(t&&t.data[e]){var n=t.data[e];n.min=this.start,n.max=this.end}return this.start},easeValueUpdate:function(t,e,n){var i=t.data[e];return(i.max-i.min)*this.ease(n)+i.min}});t.exports=u},function(t,e,n){var i=n(1),r=n(1);i=n(953),r=n(954),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=e.emitters.list,a=o.length;if(0!==a){var u=this.pipeline,l=u._tempMatrix1.copyFrom(r.matrix),c=u._tempMatrix2,h=u._tempMatrix3,d=u._tempMatrix4.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);l.multiply(d),t.setPipeline(u);var f=r.roundPixels,p=e.defaultFrame.glTexture,m=i.getTintAppendFloatAlphaAndSwap;u.setTexture2D(p,0);for(var g=0;g<a;g++){var y=o[g],v=y.alive,b=v.length;if(y.visible&&0!==b){var x=r.scrollX*y.scrollFactorX,w=r.scrollY*y.scrollFactorY;s&&(l.multiplyWithOffset(s,-x,-w),x=0,w=0),t.setBlendMode(y.blendMode)&&u.setTexture2D(p,0),y.mask&&(y.mask.preRenderWebGL(t,y,r),u.setTexture2D(p,0));for(var T=0;T<b;T++){var S=v[T],E=S.alpha*r.alpha;if(!(E<=0)){var O=S.frame,C=-O.halfWidth,_=-O.halfHeight,A=C+O.width,k=_+O.height;h.applyITRS(0,0,S.rotation,S.scaleX,S.scaleY),h.e=S.x-x,h.f=S.y-w,l.multiply(h,c);var R=c.getX(C,_),I=c.getY(C,_),M=c.getX(C,k),N=c.getY(C,k),D=c.getX(A,k),P=c.getY(A,k),F=c.getX(A,_),L=c.getY(A,_);f&&(R=Math.round(R),I=Math.round(I),M=Math.round(M),N=Math.round(N),D=Math.round(D),P=Math.round(P),F=Math.round(F),L=Math.round(L));var j=m(S.tint,E);u.batchQuad(R,I,M,N,D,P,F,L,O.u0,O.v0,O.u1,O.v1,j,j,j,j,0,p,0)}}y.mask&&(y.mask.postRenderWebGL(t,r),u.setTexture2D(p,0))}}}}},function(t,e){t.exports=function(t,e,n,i,r){var s=e.emitters.list,o=s.length;if(0!==o){var a=t._tempMatrix1.copyFrom(i.matrix),u=t._tempMatrix2,l=t._tempMatrix3,c=t._tempMatrix4.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY);a.multiply(c);var h=i.roundPixels,d=t.currentContext;d.save();for(var f=0;f<o;f++){var p=s[f],m=p.alive,g=m.length;if(p.visible&&0!==g){var y=i.scrollX*p.scrollFactorX,v=i.scrollY*p.scrollFactorY;r&&(a.multiplyWithOffset(r,-y,-v),y=0,v=0),d.globalCompositeOperation=t.blendModes[p.blendMode];for(var b=0;b<g;b++){var x=m[b],w=x.alpha*i.alpha;if(!(w<=0)){var T=x.frame,S=T.canvasData,E=-T.halfWidth,O=-T.halfHeight;l.applyITRS(0,0,x.rotation,x.scaleX,x.scaleY),l.e=x.x-y,l.f=x.y-v,a.multiply(l,u),d.globalAlpha=w,d.save(),u.copyToContext(d),h&&(E=Math.round(E),O=Math.round(O)),d.imageSmoothingEnabled=!(!t.antialias||T.source.scaleMode),d.drawImage(T.source.image,S.x,S.y,S.width,S.height,E,O,S.width,S.height),d.restore()}}}}d.restore()}}},function(t,e,n){t.exports={DeathZone:n(381),EdgeZone:n(382),RandomZone:n(384)}},function(t,e,n){var i=n(1),r=n(1);i=n(957),r=n(958),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=e.frame,a=o.width,u=o.height,l=i.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,o.glTexture,a,u,e.x,e.y,a,u,e.scaleX,e.scaleY,e.rotation,e.flipX,!e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,a,u,l(e._tintTL,r.alpha*e._alphaTL),l(e._tintTR,r.alpha*e._alphaTR),l(e._tintBL,r.alpha*e._alphaBL),l(e._tintBR,r.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,r,s),t.setBlankTexture(!0)}},function(t,e){t.exports=function(t,e,n,i,r){t.batchSprite(e,e.frame,i,r)}},function(t,e,n){var i=n(960),r=n(16),s={Parse:n(961)};s=r(!1,s,i),t.exports=s},function(t,e){t.exports={TEXT_SET1:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",TEXT_SET2:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET3:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",TEXT_SET4:"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",TEXT_SET5:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",TEXT_SET6:"ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",TEXT_SET7:"AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",TEXT_SET8:"0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET9:"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",TEXT_SET10:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",TEXT_SET11:"ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789"}},function(t,e,n){var i=n(6);t.exports=function(t,e){var n=e.width,r=e.height,s=Math.floor(n/2),o=Math.floor(r/2),a=i(e,"chars","");if(""!==a){var u=i(e,"image",""),l=i(e,"offset.x",0),c=i(e,"offset.y",0),h=i(e,"spacing.x",0),d=i(e,"spacing.y",0),f=i(e,"lineSpacing",0),p=i(e,"charsPerRow",null);null===p&&(p=t.sys.textures.getFrame(u).width/n)>a.length&&(p=a.length);for(var m=l,g=c,y={retroFont:!0,font:u,size:n,lineHeight:r+f,chars:{}},v=0,b=0;b<a.length;b++){var x=a.charCodeAt(b);y.chars[x]={x:m,y:g,width:n,height:r,centerX:s,centerY:o,xOffset:0,yOffset:0,xAdvance:n,data:{},kerning:{}},++v===p?(v=0,m=l,g+=r+d):m+=n+h}return{data:y,frame:null,texture:u}}}},function(t,e){t.exports=function(t,e,n){var i=t.context,r=t.style,s=[],o=0,a=n.length;r.maxLines>0&&r.maxLines<n.length&&(a=r.maxLines),r.syncFont(t.canvas,i);for(var u=0;u<a;u++){var l=r.strokeThickness;l+=i.measureText(n[u]).width,r.wordWrap&&(l-=i.measureText(" ").width),s[u]=Math.ceil(l),o=Math.max(o,s[u])}var c=e.fontSize+r.strokeThickness,h=c*a,d=t.lineSpacing;return a>1&&(h+=d*(a-1)),{width:o,height:h,lines:a,lineWidths:s,lineSpacing:d,lineHeight:c}}},function(t,e,n){var i=n(1),r=n(1);i=n(964),r=n(965),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){if(0!==e.width&&0!==e.height){var o=e.frame,a=o.width,u=o.height,l=i.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,o.glTexture,a,u,e.x,e.y,a/e.style.resolution,u/e.style.resolution,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.displayOriginX,e.displayOriginY,0,0,a,u,l(e._tintTL,r.alpha*e._alphaTL),l(e._tintTR,r.alpha*e._alphaTR),l(e._tintBL,r.alpha*e._alphaBL),l(e._tintBR,r.alpha*e._alphaBR),e._isTinted&&e.tintFill,0,0,r,s)}}},function(t,e){t.exports=function(t,e,n,i,r){0!==e.width&&0!==e.height&&t.batchSprite(e,e.frame,i,r)}},function(t,e,n){var i=n(0),r=n(14),s=n(6),o=n(967),a={fontFamily:["fontFamily","Courier"],fontSize:["fontSize","16px"],fontStyle:["fontStyle",""],backgroundColor:["backgroundColor",null],color:["color","#fff"],stroke:["stroke","#fff"],strokeThickness:["strokeThickness",0],shadowOffsetX:["shadow.offsetX",0],shadowOffsetY:["shadow.offsetY",0],shadowColor:["shadow.color","#000"],shadowBlur:["shadow.blur",0],shadowStroke:["shadow.stroke",!1],shadowFill:["shadow.fill",!1],align:["align","left"],maxLines:["maxLines",0],fixedWidth:["fixedWidth",0],fixedHeight:["fixedHeight",0],resolution:["resolution",0],rtl:["rtl",!1],testString:["testString","|M\xc3\u2030qgy"],baselineX:["baselineX",1.2],baselineY:["baselineY",1.4],wordWrapWidth:["wordWrap.width",null],wordWrapCallback:["wordWrap.callback",null],wordWrapCallbackScope:["wordWrap.callbackScope",null],wordWrapUseAdvanced:["wordWrap.useAdvancedWrap",!1]},u=new i({initialize:function(t,e){this.parent=t,this.setStyle(e,!1,!0);var n=s(e,"metrics",!1);this.metrics=n?{ascent:s(n,"ascent",0),descent:s(n,"descent",0),fontSize:s(n,"fontSize",0)}:o(this)},setStyle:function(t,e,n){for(var i in void 0===e&&(e=!0),void 0===n&&(n=!1),t&&t.hasOwnProperty("fontSize")&&"number"==typeof t.fontSize&&(t.fontSize=t.fontSize.toString()+"px"),a){var o=n?a[i][1]:this[i];this[i]="wordWrapCallback"===i||"wordWrapCallbackScope"===i?s(t,a[i][0],o):r(t,a[i][0],o)}var u=s(t,"font",null);null!==u&&this.setFont(u,!1),this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim();var l=s(t,"fill",null);return null!==l&&(this.color=l),e?this.update(!0):this.parent},syncFont:function(t,e){e.font=this._font},syncStyle:function(t,e){e.textBaseline="alphabetic",e.fillStyle=this.color,e.strokeStyle=this.stroke,e.lineWidth=this.strokeThickness,e.lineCap="round",e.lineJoin="round"},syncShadow:function(t,e){e?(t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur):(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowColor=0,t.shadowBlur=0)},update:function(t){return t&&(this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(" ").trim(),this.metrics=o(this)),this.parent.updateText()},setFont:function(t,e){void 0===e&&(e=!0);var n=t,i="",r="";if("string"!=typeof t)n=s(t,"fontFamily","Courier"),i=s(t,"fontSize","16px"),r=s(t,"fontStyle","");else{var o=t.split(" "),a=0;r=o.length>2?o[a++]:"",i=o[a++]||"16px",n=o[a++]||"Courier"}return n===this.fontFamily&&i===this.fontSize&&r===this.fontStyle||(this.fontFamily=n,this.fontSize=i,this.fontStyle=r,e&&this.update(!0)),this.parent},setFontFamily:function(t){return this.fontFamily!==t&&(this.fontFamily=t,this.update(!0)),this.parent},setFontStyle:function(t){return this.fontStyle!==t&&(this.fontStyle=t,this.update(!0)),this.parent},setFontSize:function(t){return"number"==typeof t&&(t=t.toString()+"px"),this.fontSize!==t&&(this.fontSize=t,this.update(!0)),this.parent},setTestString:function(t){return this.testString=t,this.update(!0)},setFixedSize:function(t,e){return this.fixedWidth=t,this.fixedHeight=e,t&&(this.parent.width=t),e&&(this.parent.height=e),this.update(!1)},setBackgroundColor:function(t){return this.backgroundColor=t,this.update(!1)},setFill:function(t){return this.color=t,this.update(!1)},setColor:function(t){return this.color=t,this.update(!1)},setResolution:function(t){return this.resolution=t,this.update(!1)},setStroke:function(t,e){return void 0===e&&(e=this.strokeThickness),void 0===t&&0!==this.strokeThickness?(this.strokeThickness=0,this.update(!0)):this.stroke===t&&this.strokeThickness===e||(this.stroke=t,this.strokeThickness=e,this.update(!0)),this.parent},setShadow:function(t,e,n,i,r,s){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n="#000"),void 0===i&&(i=0),void 0===r&&(r=!1),void 0===s&&(s=!0),this.shadowOffsetX=t,this.shadowOffsetY=e,this.shadowColor=n,this.shadowBlur=i,this.shadowStroke=r,this.shadowFill=s,this.update(!1)},setShadowOffset:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.shadowOffsetX=t,this.shadowOffsetY=e,this.update(!1)},setShadowColor:function(t){return void 0===t&&(t="#000"),this.shadowColor=t,this.update(!1)},setShadowBlur:function(t){return void 0===t&&(t=0),this.shadowBlur=t,this.update(!1)},setShadowStroke:function(t){return this.shadowStroke=t,this.update(!1)},setShadowFill:function(t){return this.shadowFill=t,this.update(!1)},setWordWrapWidth:function(t,e){return void 0===e&&(e=!1),this.wordWrapWidth=t,this.wordWrapUseAdvanced=e,this.update(!1)},setWordWrapCallback:function(t,e){return void 0===e&&(e=null),this.wordWrapCallback=t,this.wordWrapCallbackScope=e,this.update(!1)},setAlign:function(t){return void 0===t&&(t="left"),this.align=t,this.update(!1)},setMaxLines:function(t){return void 0===t&&(t=0),this.maxLines=t,this.update(!1)},getTextMetrics:function(){var t=this.metrics;return{ascent:t.ascent,descent:t.descent,fontSize:t.fontSize}},toJSON:function(){var t={};for(var e in a)t[e]=this[e];return t.metrics=this.getTextMetrics(),t},destroy:function(){this.parent=void 0}});t.exports=u},function(t,e,n){var i=n(25);t.exports=function(t){var e=i.create(this),n=e.getContext("2d");t.syncFont(e,n);var r=Math.ceil(n.measureText(t.testString).width*t.baselineX),s=r,o=2*s;s=s*t.baselineY|0,e.width=r,e.height=o,n.fillStyle="#f00",n.fillRect(0,0,r,o),n.font=t._font,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(t.testString,0,s);var a={ascent:0,descent:0,fontSize:0};if(!n.getImageData(0,0,r,o))return a.ascent=s,a.descent=s+6,a.fontSize=a.ascent+a.descent,i.remove(e),a;var u,l,c=n.getImageData(0,0,r,o).data,h=c.length,d=4*r,f=0,p=!1;for(u=0;u<s;u++){for(l=0;l<d;l+=4)if(255!==c[f+l]){p=!0;break}if(p)break;f+=d}for(a.ascent=s-u,f=h-d,p=!1,u=o;u>s;u--){for(l=0;l<d;l+=4)if(255!==c[f+l]){p=!0;break}if(p)break;f-=d}return a.descent=u-s,a.fontSize=a.ascent+a.descent,i.remove(e),a}},function(t,e,n){var i=n(1),r=n(1);i=n(969),r=n(970),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){e.updateCanvas();var o=i.getTintAppendFloatAlpha;this.pipeline.batchTexture(e,e.fillPattern,e.displayFrame.width*e.tileScaleX,e.displayFrame.height*e.tileScaleY,e.x,e.y,e.width,e.height,e.scaleX,e.scaleY,e.rotation,e.flipX,e.flipY,e.scrollFactorX,e.scrollFactorY,e.originX*e.width,e.originY*e.height,0,0,e.width,e.height,o(e._tintTL,r.alpha*e._alphaTL),o(e._tintTR,r.alpha*e._alphaTR),o(e._tintBL,r.alpha*e._alphaBL),o(e._tintBR,r.alpha*e._alphaBR),e._isTinted&&e.tintFill,e.tilePositionX%e.displayFrame.width/e.displayFrame.width,e.tilePositionY%e.displayFrame.height/e.displayFrame.height,r,s)}},function(t,e){t.exports=function(t,e,n,i,r){e.updateCanvas(),t.batchSprite(e,e.frame,i,r)}},function(t,e,n){var i=n(1),r=n(1);i=n(972),r=n(973),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){e.videoTexture&&this.pipeline.batchSprite(e,i,r)}},function(t,e){t.exports=function(t,e,n,i,r){e.videoTexture&&t.batchSprite(e,e.frame,i,r)}},function(t,e,n){var i=n(1),r=n(1);i=n(975),r=n(976),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(100),r=n(69);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;e.isFilled&&i(a,c,e,f,h,d),e.isStroked&&r(a,e,f,h,d)}},function(t,e,n){var i=n(35),r=n(36),s=n(49),o=n(26);t.exports=function(t,e,n,a,u){var l=t.currentContext;if(o(t,l,e,a,u)){var c=e.radius;l.beginPath(),l.arc(c-e.originX*(2*c),c-e.originY*(2*c),c,i(e._startAngle),i(e._endAngle),e.anticlockwise),e.closePath&&l.closePath(),e.isFilled&&(r(l,e),l.fill()),e.isStroked&&(s(l,e),l.stroke()),l.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(978),r=n(979),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(100),r=n(69);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX+e._curveBounds.x,d=e._displayOriginY+e._curveBounds.y,f=s.alpha*e.alpha;e.isFilled&&i(a,c,e,f,h,d),e.isStroked&&r(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX+e._curveBounds.x,c=e._displayOriginY+e._curveBounds.y,h=e.pathData,d=h.length-1,f=h[0]-l,p=h[1]-c;u.beginPath(),u.moveTo(f,p),e.closePath||(d-=2);for(var m=2;m<d;m+=2)u.lineTo(h[m]-l,h[m+1]-c);e.closePath&&u.closePath(),e.isFilled&&(i(u,e),u.fill()),e.isStroked&&(r(u,e),u.stroke()),u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(981),r=n(982),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(100),r=n(69);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;e.isFilled&&i(a,c,e,f,h,d),e.isStroked&&r(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX,c=e._displayOriginY,h=e.pathData,d=h.length-1,f=h[0]-l,p=h[1]-c;u.beginPath(),u.moveTo(f,p),e.closePath||(d-=2);for(var m=2;m<d;m+=2)u.lineTo(h[m]-l,h[m+1]-c);u.closePath(),e.isFilled&&(i(u,e),u.fill()),e.isStroked&&(r(u,e),u.stroke()),u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(984),r=n(985),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=this.pipeline,a=o._tempMatrix1,u=o._tempMatrix2,l=o._tempMatrix3;t.setPipeline(o),u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),s?(a.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY),a.multiply(u,l),l.translate(-e._displayOriginX,-e._displayOriginY);var c,h,d=r.alpha*e.alpha,f=e.width,p=e.height,m=e.cellWidth,g=e.cellHeight,y=Math.ceil(f/m),v=Math.ceil(p/g),b=m,x=g,w=m-(y*m-f),T=g-(v*g-p),S=e.showAltCells,E=e.showOutline,O=0,C=0,_=0,A=0,k=0;if(E&&(b--,x--,w===m&&w--,T===g&&T--),e.showCells&&e.fillAlpha>0)for(c=o.fillTint,h=i.getTintAppendFloatAlphaAndSwap(e.fillColor,e.fillAlpha*d),c.TL=h,c.TR=h,c.BL=h,c.BR=h,C=0;C<v;C++)for(S&&(_=C%2),O=0;O<y;O++)S&&_?_=0:(_++,A=O<y-1?b:w,k=C<v-1?x:T,o.setTexture2D(),o.batchFillRect(O*m,C*g,A,k));if(S&&e.altFillAlpha>0)for(c=o.fillTint,h=i.getTintAppendFloatAlphaAndSwap(e.altFillColor,e.altFillAlpha*d),c.TL=h,c.TR=h,c.BL=h,c.BR=h,C=0;C<v;C++)for(S&&(_=C%2),O=0;O<y;O++)!S||_?(_=0,A=O<y-1?b:w,k=C<v-1?x:T,o.setTexture2D(),o.batchFillRect(O*m,C*g,A,k)):_=1;if(E&&e.outlineFillAlpha>0){var R=o.strokeTint,I=i.getTintAppendFloatAlphaAndSwap(e.outlineFillColor,e.outlineFillAlpha*d);for(R.TL=I,R.TR=I,R.BL=I,R.BR=I,O=1;O<y;O++){var M=O*m;o.setTexture2D(),o.batchLine(M,0,M,p,1,1,1,0,!1)}for(C=1;C<v;C++){var N=C*g;o.setTexture2D(),o.batchLine(0,N,f,N,1,1,1,0,!1)}}}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=-e._displayOriginX,c=-e._displayOriginY,h=o.alpha*e.alpha,d=e.width,f=e.height,p=e.cellWidth,m=e.cellHeight,g=Math.ceil(d/p),y=Math.ceil(f/m),v=p,b=m,x=p-(g*p-d),w=m-(y*m-f),T=e.showAltCells,S=e.showOutline,E=0,O=0,C=0;if(S&&(v--,b--,x===p&&x--,w===m&&w--),e.showCells&&e.fillAlpha>0)for(i(u,e),O=0;O<y;O++)for(T&&(C=O%2),E=0;E<g;E++)T&&C?C=0:(C++,u.fillRect(l+E*p,c+O*m,E<g-1?v:x,O<y-1?b:w));if(T&&e.altFillAlpha>0)for(i(u,e,e.altFillColor,e.altFillAlpha*h),O=0;O<y;O++)for(T&&(C=O%2),E=0;E<g;E++)!T||C?(C=0,u.fillRect(l+E*p,c+O*m,E<g-1?v:x,O<y-1?b:w)):C=1;if(S&&e.outlineFillAlpha>0){for(r(u,e,e.outlineFillColor,e.outlineFillAlpha*h),E=1;E<g;E++){var _=E*p;u.beginPath(),u.moveTo(_+l,c),u.lineTo(_+l,f+c),u.stroke()}for(O=1;O<y;O++){var A=O*m;u.beginPath(),u.moveTo(l,A+c),u.lineTo(l+d,A+c),u.stroke()}}u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(987),r=n(988),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=this.pipeline,a=o._tempMatrix1,u=o._tempMatrix2,l=o._tempMatrix3;t.setPipeline(o),u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),s?(a.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY),a.multiply(u,l);var c,h,d,f,p,m,g,y,v,b=e.width,x=e.height,w=b/2,T=b/e.projection,S=r.alpha*e.alpha;e.isFilled&&(e.showTop&&(c=i.getTintAppendFloatAlphaAndSwap(e.fillTop,S),h=l.getX(-w,-x),d=l.getY(-w,-x),f=l.getX(0,-T-x),p=l.getY(0,-T-x),m=l.getX(w,-x),g=l.getY(w,-x),y=l.getX(0,T-x),v=l.getY(0,T-x),o.setTexture2D(),o.batchQuad(h,d,f,p,m,g,y,v,0,0,1,1,c,c,c,c,2)),e.showLeft&&(c=i.getTintAppendFloatAlphaAndSwap(e.fillLeft,S),h=l.getX(-w,0),d=l.getY(-w,0),f=l.getX(0,T),p=l.getY(0,T),m=l.getX(0,T-x),g=l.getY(0,T-x),y=l.getX(-w,-x),v=l.getY(-w,-x),o.setTexture2D(),o.batchQuad(h,d,f,p,m,g,y,v,0,0,1,1,c,c,c,c,2)),e.showRight&&(c=i.getTintAppendFloatAlphaAndSwap(e.fillRight,S),h=l.getX(w,0),d=l.getY(w,0),f=l.getX(0,T),p=l.getY(0,T),m=l.getX(0,T-x),g=l.getY(0,T-x),y=l.getX(w,-x),v=l.getY(w,-x),o.setTexture2D(),o.batchQuad(h,d,f,p,m,g,y,v,0,0,1,1,c,c,c,c,2)))}},function(t,e,n){var i=n(36),r=n(26);t.exports=function(t,e,n,s,o){var a=t.currentContext;if(r(t,a,e,s,o)&&e.isFilled){var u=e.width,l=e.height,c=u/2,h=u/e.projection;e.showTop&&(i(a,e,e.fillTop),a.beginPath(),a.moveTo(-c,-l),a.lineTo(0,-h-l),a.lineTo(c,-l),a.lineTo(c,-1),a.lineTo(0,h-1),a.lineTo(-c,-1),a.lineTo(-c,-l),a.fill()),e.showLeft&&(i(a,e,e.fillLeft),a.beginPath(),a.moveTo(-c,0),a.lineTo(0,h),a.lineTo(0,h-l),a.lineTo(-c,-l),a.lineTo(-c,0),a.fill()),e.showRight&&(i(a,e,e.fillRight),a.beginPath(),a.moveTo(c,0),a.lineTo(0,h),a.lineTo(0,h-l),a.lineTo(c,-l),a.lineTo(c,0),a.fill()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(990),r=n(991),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=this.pipeline,a=o._tempMatrix1,u=o._tempMatrix2,l=o._tempMatrix3;t.setPipeline(o),u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),s?(a.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY),a.multiply(u,l);var c=e.width,h=e.height,d=c/2,f=c/e.projection,p=e.isReversed,m=r.alpha*e.alpha;if(e.isFilled){var g,y,v,b,x,w,T;if(e.showTop&&p){g=i.getTintAppendFloatAlphaAndSwap(e.fillTop,m),y=l.getX(-d,-h),v=l.getY(-d,-h),b=l.getX(0,-f-h),x=l.getY(0,-f-h),w=l.getX(d,-h),T=l.getY(d,-h);var S=l.getX(0,f-h),E=l.getY(0,f-h);o.setTexture2D(),o.batchQuad(y,v,b,x,w,T,S,E,0,0,1,1,g,g,g,g,2)}e.showLeft&&(g=i.getTintAppendFloatAlphaAndSwap(e.fillLeft,m),p?(y=l.getX(-d,-h),v=l.getY(-d,-h),b=l.getX(0,f),x=l.getY(0,f),w=l.getX(0,f-h),T=l.getY(0,f-h)):(y=l.getX(-d,0),v=l.getY(-d,0),b=l.getX(0,f),x=l.getY(0,f),w=l.getX(0,f-h),T=l.getY(0,f-h)),o.batchTri(y,v,b,x,w,T,0,0,1,1,g,g,g,2)),e.showRight&&(g=i.getTintAppendFloatAlphaAndSwap(e.fillRight,m),p?(y=l.getX(d,-h),v=l.getY(d,-h),b=l.getX(0,f),x=l.getY(0,f),w=l.getX(0,f-h),T=l.getY(0,f-h)):(y=l.getX(d,0),v=l.getY(d,0),b=l.getX(0,f),x=l.getY(0,f),w=l.getX(0,f-h),T=l.getY(0,f-h)),o.setTexture2D(),o.batchTri(y,v,b,x,w,T,0,0,1,1,g,g,g,2))}}},function(t,e,n){var i=n(36),r=n(26);t.exports=function(t,e,n,s,o){var a=t.currentContext;if(r(t,a,e,s,o)&&e.isFilled){var u=e.width,l=e.height,c=u/2,h=u/e.projection,d=e.isReversed;e.showTop&&d&&(i(a,e,e.fillTop),a.beginPath(),a.moveTo(-c,-l),a.lineTo(0,-h-l),a.lineTo(c,-l),a.lineTo(0,h-l),a.fill()),e.showLeft&&(i(a,e,e.fillLeft),a.beginPath(),d?(a.moveTo(-c,-l),a.lineTo(0,h),a.lineTo(0,h-l)):(a.moveTo(-c,0),a.lineTo(0,h),a.lineTo(0,h-l)),a.fill()),e.showRight&&(i(a,e,e.fillRight),a.beginPath(),d?(a.moveTo(c,-l),a.lineTo(0,h),a.lineTo(0,h-l)):(a.moveTo(c,0),a.lineTo(0,h),a.lineTo(0,h-l)),a.fill()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(993),r=n(994),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=this.pipeline,a=o._tempMatrix1,u=o._tempMatrix2;t.setPipeline(o),u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),s?(a.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY);var l=e._displayOriginX,c=e._displayOriginY;if(e.isStroked){var h=o.strokeTint,d=i.getTintAppendFloatAlphaAndSwap(e.strokeColor,e.strokeAlpha*(r.alpha*e.alpha));h.TL=d,h.TR=d,h.BL=d,h.BR=d;var f=e._startWidth,p=e._endWidth;o.setTexture2D(),o.batchLine(e.geom.x1-l,e.geom.y1-c,e.geom.x2-l,e.geom.y2-c,f,p,1,0,!1,u,a)}}},function(t,e,n){var i=n(49),r=n(26);t.exports=function(t,e,n,s,o){var a=t.currentContext;if(r(t,a,e,s,o)){var u=e._displayOriginX,l=e._displayOriginY;e.isStroked&&(i(a,e),a.beginPath(),a.moveTo(e.geom.x1-u,e.geom.y1-l),a.lineTo(e.geom.x2-u,e.geom.y2-l),a.stroke()),a.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(996),r=n(997),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(100),r=n(69);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;e.isFilled&&i(a,c,e,f,h,d),e.isStroked&&r(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX,c=e._displayOriginY,h=e.pathData,d=h.length-1,f=h[0]-l,p=h[1]-c;u.beginPath(),u.moveTo(f,p),e.closePath||(d-=2);for(var m=2;m<d;m+=2)u.lineTo(h[m]-l,h[m+1]-c);u.closePath(),e.isFilled&&(i(u,e),u.fill()),e.isStroked&&(r(u,e),u.stroke()),u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(999),r=n(1e3),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(69),r=n(10);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;if(e.isFilled){var p=a.fillTint,m=r.getTintAppendFloatAlphaAndSwap(e.fillColor,e.fillAlpha*f);p.TL=m,p.TR=m,p.BL=m,p.BR=m,a.setTexture2D(),a.batchFillRect(-h,-d,e.width,e.height)}e.isStroked&&i(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX,c=e._displayOriginY;e.isFilled&&(i(u,e),u.fillRect(-l,-c,e.width,e.height)),e.isStroked&&(r(u,e),u.beginPath(),u.rect(-l,-c,e.width,e.height),u.stroke()),u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1002),r=n(1003),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(100),r=n(69);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;e.isFilled&&i(a,c,e,f,h,d),e.isStroked&&r(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX,c=e._displayOriginY,h=e.pathData,d=h.length-1,f=h[0]-l,p=h[1]-c;u.beginPath(),u.moveTo(f,p),e.closePath||(d-=2);for(var m=2;m<d;m+=2)u.lineTo(h[m]-l,h[m+1]-c);u.closePath(),e.isFilled&&(i(u,e),u.fill()),e.isStroked&&(r(u,e),u.stroke()),u.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1005),r=n(1006),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(69),r=n(10);t.exports=function(t,e,n,s,o){var a=this.pipeline,u=a._tempMatrix1,l=a._tempMatrix2,c=a._tempMatrix3;t.setPipeline(a),l.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),u.copyFrom(s.matrix),o?(u.multiplyWithOffset(o,-s.scrollX*e.scrollFactorX,-s.scrollY*e.scrollFactorY),l.e=e.x,l.f=e.y):(l.e-=s.scrollX*e.scrollFactorX,l.f-=s.scrollY*e.scrollFactorY),u.multiply(l,c);var h=e._displayOriginX,d=e._displayOriginY,f=s.alpha*e.alpha;if(e.isFilled){var p=a.fillTint,m=r.getTintAppendFloatAlphaAndSwap(e.fillColor,e.fillAlpha*f);p.TL=m,p.TR=m,p.BL=m,p.BR=m;var g=e.geom.x1-h,y=e.geom.y1-d,v=e.geom.x2-h,b=e.geom.y2-d,x=e.geom.x3-h,w=e.geom.y3-d;a.setTexture2D(),a.batchFillTriangle(g,y,v,b,x,w,l,u)}e.isStroked&&i(a,e,f,h,d)}},function(t,e,n){var i=n(36),r=n(49),s=n(26);t.exports=function(t,e,n,o,a){var u=t.currentContext;if(s(t,u,e,o,a)){var l=e._displayOriginX,c=e._displayOriginY,h=e.geom.x1-l,d=e.geom.y1-c,f=e.geom.x2-l,p=e.geom.y2-c,m=e.geom.x3-l,g=e.geom.y3-c;u.beginPath(),u.moveTo(h,d),u.lineTo(f,p),u.lineTo(m,g),u.closePath(),e.isFilled&&(i(u,e),u.fill()),e.isStroked&&(r(u,e),u.stroke()),u.restore()}}},function(t,e,n){var i=n(185);n(5).register("blitter",function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))})},function(t,e,n){var i=n(186);n(5).register("container",function(t,e,n){return this.displayList.add(new i(this.scene,t,e,n))})},function(t,e,n){var i=n(371);n(5).register("dom",function(t,e,n,r,s){var o=new i(this.scene,t,e,n,r,s);return this.displayList.add(o),this.updateList.add(o),o})},function(t,e,n){var i=n(187);n(5).register("dynamicBitmapText",function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,r,s))})},function(t,e,n){var i=n(373);n(5).register("extern",function(){var t=new i(this.scene);return this.displayList.add(t),this.updateList.add(t),t})},function(t,e,n){var i=n(188);n(5).register("graphics",function(t){return this.displayList.add(new i(this.scene,t))})},function(t,e,n){var i=n(97);n(5).register("group",function(t,e){return this.updateList.add(new i(this.scene,t,e))})},function(t,e,n){var i=n(98);n(5).register("image",function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))})},function(t,e,n){var i=n(5),r=n(191);i.register("particles",function(t,e,n){var i=new r(this.scene,t,e,n);return this.displayList.add(i),this.updateList.add(i),i})},function(t,e,n){var i=n(5),r=n(385);i.register("follower",function(t,e,n,i,s){var o=new r(this.scene,t,e,n,i,s);return this.displayList.add(o),this.updateList.add(o),o})},function(t,e,n){var i=n(5),r=n(192);i.register("renderTexture",function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))})},function(t,e,n){var i=n(5),r=n(68);i.register("sprite",function(t,e,n,i){var s=new r(this.scene,t,e,n,i);return this.displayList.add(s),this.updateList.add(s),s})},function(t,e,n){var i=n(127);n(5).register("bitmapText",function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))})},function(t,e,n){var i=n(194);n(5).register("text",function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))})},function(t,e,n){var i=n(195);n(5).register("tileSprite",function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))})},function(t,e,n){var i=n(108);n(5).register("zone",function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))})},function(t,e,n){var i=n(196);n(5).register("video",function(t,e,n){var r=new i(this.scene,t,e,n);return this.displayList.add(r),this.updateList.add(r),r})},function(t,e,n){var i=n(386),r=n(5);r.register("arc",function(t,e,n,r,s,o,a,u){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,u))}),r.register("circle",function(t,e,n,r,s){return this.displayList.add(new i(this.scene,t,e,n,0,360,!1,r,s))})},function(t,e,n){var i=n(5),r=n(387);i.register("curve",function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))})},function(t,e,n){var i=n(388);n(5).register("ellipse",function(t,e,n,r,s,o){return this.displayList.add(new i(this.scene,t,e,n,r,s,o))})},function(t,e,n){var i=n(5),r=n(389);i.register("grid",function(t,e,n,i,s,o,a,u,l,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,u,l,c))})},function(t,e,n){var i=n(5),r=n(390);i.register("isobox",function(t,e,n,i,s,o,a){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a))})},function(t,e,n){var i=n(5),r=n(391);i.register("isotriangle",function(t,e,n,i,s,o,a,u){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,u))})},function(t,e,n){var i=n(5),r=n(392);i.register("line",function(t,e,n,i,s,o,a,u){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,u))})},function(t,e,n){var i=n(5),r=n(393);i.register("polygon",function(t,e,n,i,s){return this.displayList.add(new r(this.scene,t,e,n,i,s))})},function(t,e,n){var i=n(5),r=n(398);i.register("rectangle",function(t,e,n,i,s,o){return this.displayList.add(new r(this.scene,t,e,n,i,s,o))})},function(t,e,n){var i=n(399);n(5).register("star",function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))})},function(t,e,n){var i=n(5),r=n(400);i.register("triangle",function(t,e,n,i,s,o,a,u,l,c){return this.displayList.add(new r(this.scene,t,e,n,i,s,o,a,u,l,c))})},function(t,e,n){var i=n(185),r=n(27),s=n(15),o=n(14);s.register("blitter",function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),a=new i(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),r(this.scene,a,t),a})},function(t,e,n){var i=n(27),r=n(186),s=n(15),o=n(14);s.register("container",function(t,e){void 0===t&&(t={});var n=o(t,"x",0),s=o(t,"y",0),a=new r(this.scene,n,s);return void 0!==e&&(t.add=e),i(this.scene,a,t),a})},function(t,e,n){var i=n(187),r=n(27),s=n(15),o=n(14);s.register("dynamicBitmapText",function(t,e){void 0===t&&(t={});var n=o(t,"font",""),s=o(t,"text",""),a=o(t,"size",!1),u=new i(this.scene,0,0,n,s,a);return void 0!==e&&(t.add=e),r(this.scene,u,t),u})},function(t,e,n){var i=n(15),r=n(188);i.register("graphics",function(t,e){void 0===t&&(t={}),void 0!==e&&(t.add=e);var n=new r(this.scene,t);return t.add&&this.scene.sys.displayList.add(n),n})},function(t,e,n){var i=n(15),r=n(97);i.register("group",function(t){return new r(this.scene,null,t)})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(98);r.register("image",function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),a=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,a,t),a})},function(t,e,n){var i=n(15),r=n(14),s=n(2),o=n(191);i.register("particles",function(t,e){void 0===t&&(t={});var n=r(t,"key",null),i=r(t,"frame",null),a=s(t,"emitters",null),u=new o(this.scene,n,i,a);return void 0!==e&&(t.add=e),s(t,"add",!1)&&this.displayList.add(u),this.updateList.add(u),u})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(192);r.register("renderTexture",function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",32),u=s(t,"height",32),l=s(t,"key",void 0),c=s(t,"frame",void 0),h=new o(this.scene,n,r,a,u,l,c);return void 0!==e&&(t.add=e),i(this.scene,h,t),h})},function(t,e,n){var i=n(27),r=n(369),s=n(15),o=n(14),a=n(68);s.register("sprite",function(t,e){void 0===t&&(t={});var n=o(t,"key",null),s=o(t,"frame",null),u=new a(this.scene,0,0,n,s);return void 0!==e&&(t.add=e),i(this.scene,u,t),r(u,t),u})},function(t,e,n){var i=n(127),r=n(27),s=n(15),o=n(14),a=n(6);s.register("bitmapText",function(t,e){void 0===t&&(t={});var n=a(t,"font",""),s=o(t,"text",""),u=o(t,"size",!1),l=a(t,"align",0),c=new i(this.scene,0,0,n,s,u,l);return void 0!==e&&(t.add=e),r(this.scene,c,t),c})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(194);r.register("text",function(t,e){void 0===t&&(t={});var n=s(t,"text",""),r=s(t,"style",null),a=s(t,"padding",null);null!==a&&(r.padding=a);var u=new o(this.scene,0,0,n,r);return void 0!==e&&(t.add=e),i(this.scene,u,t),u.autoRound=s(t,"autoRound",!0),u.resolution=s(t,"resolution",1),u})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(195);r.register("tileSprite",function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"width",512),u=s(t,"height",512),l=s(t,"key",""),c=s(t,"frame",""),h=new o(this.scene,n,r,a,u,l,c);return void 0!==e&&(t.add=e),i(this.scene,h,t),h})},function(t,e,n){var i=n(15),r=n(14),s=n(108);i.register("zone",function(t){var e=r(t,"x",0),n=r(t,"y",0),i=r(t,"width",1),o=r(t,"height",i);return new s(this.scene,e,n,i,o)})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(196);r.register("video",function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=new o(this.scene,0,0,n);return void 0!==e&&(t.add=e),i(this.scene,r,t),r})},function(t,e,n){var i=n(1),r=n(1);i=n(1050),r=n(1051),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r,s){var o=this.pipeline;t.setPipeline(o,e);var a=o._tempMatrix1,u=o._tempMatrix2,l=o._tempMatrix3;u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(r.matrix),s?(a.multiplyWithOffset(s,-r.scrollX*e.scrollFactorX,-r.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y,a.multiply(u,l)):(u.e-=r.scrollX*e.scrollFactorX,u.f-=r.scrollY*e.scrollFactorY,a.multiply(u,l));var c=e.frame.glTexture,h=e.vertices,d=e.uv,f=e.colors,p=e.alphas,m=h.length,g=Math.floor(.5*m);o.vertexCount+g>o.vertexCapacity&&o.flush(),o.setTexture2D(c,0);for(var y=o.vertexViewF32,v=o.vertexViewU32,b=o.vertexCount*o.vertexComponentCount-1,x=0,w=e.tintFill,T=0;T<m;T+=2){var S=h[T+0],E=h[T+1],O=S*l.a+E*l.c+l.e,C=S*l.b+E*l.d+l.f;r.roundPixels&&(O=Math.round(O),C=Math.round(C)),y[++b]=O,y[++b]=C,y[++b]=d[T+0],y[++b]=d[T+1],y[++b]=w,v[++b]=i.getTintAppendFloatAlpha(f[x],r.alpha*p[x]),x++}o.vertexCount+=g}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(1),r=n(1);i=n(1053),r=n(1054),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i,r){if(e.shader){var s=t.currentPipeline;if(t.clearPipeline(),e.renderToTexture)e.load(),e.flush();else{var o=e._tempMatrix1,a=e._tempMatrix2,u=e._tempMatrix3;a.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),o.copyFrom(i.matrix),r?(o.multiplyWithOffset(r,-i.scrollX*e.scrollFactorX,-i.scrollY*e.scrollFactorY),a.e=e.x,a.f=e.y):(a.e-=i.scrollX*e.scrollFactorX,a.f-=i.scrollY*e.scrollFactorY),o.multiply(a,u),t.width===e._rendererWidth&&t.height===e._rendererHeight||e.projOrtho(0,t.width,t.height,0),e.load(u.matrix),e.flush()}t.rebindPipeline(s)}}},function(t,e){t.exports=function(){}},function(t,e,n){var i=n(128);n(5).register("mesh",function(t,e,n,r,s,o,a,u){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a,u))})},function(t,e,n){var i=n(199);n(5).register("quad",function(t,e,n,r){return this.displayList.add(new i(this.scene,t,e,n,r))})},function(t,e,n){var i=n(200);n(5).register("shader",function(t,e,n,r,s,o,a){return this.displayList.add(new i(this.scene,t,e,n,r,s,o,a))})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(6),a=n(128);r.register("mesh",function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"frame",null),u=o(t,"vertices",[]),l=o(t,"colors",[]),c=o(t,"alphas",[]),h=o(t,"uv",[]),d=new a(this.scene,0,0,u,h,l,c,n,r);return void 0!==e&&(t.add=e),i(this.scene,d,t),d})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(199);r.register("quad",function(t,e){void 0===t&&(t={});var n=s(t,"x",0),r=s(t,"y",0),a=s(t,"key",null),u=s(t,"frame",null),l=new o(this.scene,n,r,a,u);return void 0!==e&&(t.add=e),i(this.scene,l,t),l})},function(t,e,n){var i=n(27),r=n(15),s=n(14),o=n(200);r.register("shader",function(t,e){void 0===t&&(t={});var n=s(t,"key",null),r=s(t,"x",0),a=s(t,"y",0),u=s(t,"width",128),l=s(t,"height",128),c=new o(this.scene,n,r,a,u,l);return void 0!==e&&(t.add=e),i(this.scene,c,t),c})},function(t,e,n){var i=n(0),r=n(405),s=n(20),o=n(21),a=new i({Extends:r,initialize:function(t){this.scene=t,this.systems=t.sys,t.sys.settings.isBooted||t.sys.events.once(o.BOOT,this.boot,this),r.call(this)},boot:function(){var t=this.systems.events;t.on(o.SHUTDOWN,this.shutdown,this),t.on(o.DESTROY,this.destroy,this)},destroy:function(){this.shutdown(),this.scene=void 0,this.systems=void 0}});s.register("LightsPlugin",a,"lights"),t.exports=a},function(t,e,n){var i=n(78);i.Area=n(1063),i.Circumference=n(249),i.CircumferencePoint=n(144),i.Clone=n(1064),i.Contains=n(54),i.ContainsPoint=n(1065),i.ContainsRect=n(1066),i.CopyFrom=n(1067),i.Equals=n(1068),i.GetBounds=n(1069),i.GetPoint=n(247),i.GetPoints=n(248),i.Offset=n(1070),i.OffsetPoint=n(1071),i.Random=n(145),t.exports=i},function(t,e){t.exports=function(t){return t.radius>0?Math.PI*t.radius*t.radius:0}},function(t,e,n){var i=n(78);t.exports=function(t){return new i(t.x,t.y,t.radius)}},function(t,e,n){var i=n(54);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e,n){var i=n(54);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.radius)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.radius===e.radius}},function(t,e,n){var i=n(11);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.diameter,e.height=t.diameter,e}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e,n){var i=n(95);i.Area=n(1073),i.Circumference=n(376),i.CircumferencePoint=n(190),i.Clone=n(1074),i.Contains=n(96),i.ContainsPoint=n(1075),i.ContainsRect=n(1076),i.CopyFrom=n(1077),i.Equals=n(1078),i.GetBounds=n(1079),i.GetPoint=n(374),i.GetPoints=n(375),i.Offset=n(1080),i.OffsetPoint=n(1081),i.Random=n(152),t.exports=i},function(t,e){t.exports=function(t){return t.isEmpty()?0:t.getMajorRadius()*t.getMinorRadius()*Math.PI}},function(t,e,n){var i=n(95);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},function(t,e,n){var i=n(96);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e,n){var i=n(96);t.exports=function(t,e){return i(t,e.x,e.y)&&i(t,e.right,e.y)&&i(t,e.x,e.bottom)&&i(t,e.right,e.bottom)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},function(t,e,n){var i=n(11);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.left,e.y=t.top,e.width=t.width,e.height=t.height,e}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e,n){var i=n(4),r=n(408);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s,o,a,u,l=t.x,c=t.y,h=t.radius,d=e.x,f=e.y,p=e.radius;if(c===f)0==(a=(o=-2*f)*o-4*(s=1)*(d*d+(u=(p*p-h*h-d*d+l*l)/(2*(l-d)))*u-2*d*u+f*f-p*p))?n.push(new i(u,-o/(2*s))):a>0&&(n.push(new i(u,(-o+Math.sqrt(a))/(2*s))),n.push(new i(u,(-o-Math.sqrt(a))/(2*s))));else{var m=(l-d)/(c-f),g=(p*p-h*h-d*d+l*l-f*f+c*c)/(2*(c-f));0==(a=(o=2*c*m-2*g*m-2*l)*o-4*(s=m*m+1)*(l*l+c*c+g*g-h*h-2*c*g))?n.push(new i(u=-o/(2*s),g-u*m)):a>0&&(u=(-o+Math.sqrt(a))/(2*s),n.push(new i(u,g-u*m)),u=(-o-Math.sqrt(a))/(2*s),n.push(new i(u,g-u*m)))}}return n}},function(t,e,n){var i=n(201),r=n(409);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC(),u=e.getLineD();i(s,t,n),i(o,t,n),i(a,t,n),i(u,t,n)}return n}},function(t,e,n){var i=n(11),r=n(129);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)&&(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y),n}},function(t,e,n){var i=n(203),r=n(129);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC(),u=t.getLineD();i(s,e,n),i(o,e,n),i(a,e,n),i(u,e,n)}return n}},function(t,e,n){var i=n(411),r=n(203);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(s,t,n),r(o,t,n),r(a,t,n)}return n}},function(t,e,n){var i=n(201),r=n(413);t.exports=function(t,e,n){if(void 0===n&&(n=[]),r(t,e)){var s=t.getLineA(),o=t.getLineB(),a=t.getLineC();i(s,e,n),i(o,e,n),i(a,e,n)}return n}},function(t,e,n){var i=n(416),r=n(414);t.exports=function(t,e,n){if(void 0===n&&(n=[]),i(t,e)){var s=e.getLineA(),o=e.getLineB(),a=e.getLineC();r(t,s,n),r(t,o,n),r(t,a,n)}return n}},function(t,e,n){var i=n(418);t.exports=function(t,e){if(!i(t,e))return!1;var n=Math.min(e.x1,e.x2),r=Math.max(e.x1,e.x2),s=Math.min(e.y1,e.y2),o=Math.max(e.y1,e.y2);return t.x>=n&&t.x<=r&&t.y>=s&&t.y<=o}},function(t,e){t.exports=function(t,e,n,i,r,s){return void 0===s&&(s=0),!(e>t.right+s||n<t.left-s||i>t.bottom+s||r<t.top-s)}},function(t,e,n){var i=n(55);i.Angle=n(85),i.BresenhamPoints=n(269),i.CenterOn=n(1092),i.Clone=n(1093),i.CopyFrom=n(1094),i.Equals=n(1095),i.Extend=n(1096),i.GetMidPoint=n(1097),i.GetNearestPoint=n(1098),i.GetNormal=n(1099),i.GetPoint=n(256),i.GetPoints=n(148),i.GetShortestDistance=n(1100),i.Height=n(1101),i.Length=n(56),i.NormalAngle=n(419),i.NormalX=n(1102),i.NormalY=n(1103),i.Offset=n(1104),i.PerpSlope=n(1105),i.Random=n(149),i.ReflectAngle=n(1106),i.Rotate=n(1107),i.RotateAroundPoint=n(1108),i.RotateAroundXY=n(205),i.SetToAngle=n(1109),i.Slope=n(1110),i.Width=n(1111),t.exports=i},function(t,e){t.exports=function(t,e,n){var i=e-(t.x1+t.x2)/2,r=n-(t.y1+t.y2)/2;return t.x1+=i,t.y1+=r,t.x2+=i,t.y2+=r,t}},function(t,e,n){var i=n(55);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2)}},function(t,e){t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}},function(t,e,n){var i=n(56);t.exports=function(t,e,n){void 0===n&&(n=e);var r=i(t),s=t.x2-t.x1,o=t.y2-t.y1;return e&&(t.x1=t.x1-s/r*e,t.y1=t.y1-o/r*e),n&&(t.x2=t.x2+s/r*n,t.y2=t.y2+o/r*n),t}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=(t.x1+t.x2)/2,e.y=(t.y1+t.y2)/2,e}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x1,s=t.y1,o=t.x2,a=t.y2,u=(o-r)*(o-r)+(a-s)*(a-s);if(0===u)return n;var l=((e.x-r)*(o-r)+(e.y-s)*(a-s))/u;return n.x=r+l*(o-r),n.y=s+l*(a-s),n}},function(t,e,n){var i=n(23),r=n(85),s=n(4);t.exports=function(t,e){void 0===e&&(e=new s);var n=r(t)-i.TAU;return e.x=Math.cos(n),e.y=Math.sin(n),e}},function(t,e){t.exports=function(t,e){var n=t.x1,i=t.y1,r=t.x2,s=t.y2,o=(r-n)*(r-n)+(s-i)*(s-i);return 0!==o&&Math.abs(((i-e.y)*(r-n)-(n-e.x)*(s-i))/o)*Math.sqrt(o)}},function(t,e){t.exports=function(t){return Math.abs(t.y1-t.y2)}},function(t,e,n){var i=n(23),r=n(85);t.exports=function(t){return Math.cos(r(t)-i.TAU)}},function(t,e,n){var i=n(23),r=n(85);t.exports=function(t){return Math.sin(r(t)-i.TAU)}},function(t,e){t.exports=function(t,e,n){return t.x1+=e,t.y1+=n,t.x2+=e,t.y2+=n,t}},function(t,e){t.exports=function(t){return-(t.x2-t.x1)/(t.y2-t.y1)}},function(t,e,n){var i=n(85),r=n(419);t.exports=function(t,e){return 2*r(e)-Math.PI-i(t)}},function(t,e,n){var i=n(205);t.exports=function(t,e){return i(t,(t.x1+t.x2)/2,(t.y1+t.y2)/2,e)}},function(t,e,n){var i=n(205);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},function(t,e){t.exports=function(t,e,n,i,r){return t.x1=e,t.y1=n,t.x2=e+Math.cos(i)*r,t.y2=n+Math.sin(i)*r,t}},function(t,e){t.exports=function(t){return(t.y2-t.y1)/(t.x2-t.x1)}},function(t,e){t.exports=function(t){return Math.abs(t.x1-t.x2)}},function(t,e,n){var i=n(4);i.Ceil=n(1113),i.Clone=n(1114),i.CopyFrom=n(1115),i.Equals=n(1116),i.Floor=n(1117),i.GetCentroid=n(1118),i.GetMagnitude=n(420),i.GetMagnitudeSq=n(421),i.GetRectangleFromPoints=n(1119),i.Interpolate=n(1120),i.Invert=n(1121),i.Negative=n(1122),i.Project=n(1123),i.ProjectUnit=n(1124),i.SetMagnitude=n(1125),t.exports=i},function(t,e){t.exports=function(t){return t.setTo(Math.ceil(t.x),Math.ceil(t.y))}},function(t,e,n){var i=n(4);t.exports=function(t){return new i(t.x,t.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y}},function(t,e){t.exports=function(t){return t.setTo(Math.floor(t.x),Math.floor(t.y))}},function(t,e,n){var i=n(4);t.exports=function(t,e){if(void 0===e&&(e=new i),!Array.isArray(t))throw new Error("GetCentroid points argument must be an array");var n=t.length;if(n<1)throw new Error("GetCentroid points array must not be empty");if(1===n)e.x=t[0].x,e.y=t[0].y;else{for(var r=0;r<n;r++)e.x+=t[r].x,e.y+=t[r].y;e.x/=n,e.y/=n}return e}},function(t,e,n){var i=n(11);t.exports=function(t,e){void 0===e&&(e=new i);for(var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=0;a<t.length;a++){var u=t[a];u.x>n&&(n=u.x),u.x<r&&(r=u.x),u.y>s&&(s=u.y),u.y<o&&(o=u.y)}return e.x=r,e.y=o,e.width=n-r,e.height=s-o,e}},function(t,e,n){var i=n(4);t.exports=function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=new i),r.x=t.x+(e.x-t.x)*n,r.y=t.y+(e.y-t.y)*n,r}},function(t,e){t.exports=function(t){return t.setTo(t.y,t.x)}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.setTo(-t.x,-t.y)}},function(t,e,n){var i=n(4),r=n(421);t.exports=function(t,e,n){void 0===n&&(n=new i);var s=(t.x*e.x+t.y*e.y)/r(e);return 0!==s&&(n.x=s*e.x,n.y=s*e.y),n}},function(t,e,n){var i=n(4);t.exports=function(t,e,n){void 0===n&&(n=new i);var r=t.x*e.x+t.y*e.y;return 0!==r&&(n.x=r*e.x,n.y=r*e.y),n}},function(t,e,n){var i=n(420);t.exports=function(t,e){if(0!==t.x||0!==t.y){var n=i(t);t.x/=n,t.y/=n}return t.x*=e,t.y*=e,t}},function(t,e,n){var i=n(197);i.Clone=n(1127),i.Contains=n(198),i.ContainsPoint=n(1128),i.GetAABB=n(394),i.GetNumberArray=n(1129),i.GetPoints=n(395),i.Perimeter=n(396),i.Reverse=n(1130),i.Smooth=n(397),t.exports=i},function(t,e,n){var i=n(197);t.exports=function(t){return new i(t.points)}},function(t,e,n){var i=n(198);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){void 0===e&&(e=[]);for(var n=0;n<t.points.length;n++)e.push(t.points[n].x),e.push(t.points[n].y);return e}},function(t,e){t.exports=function(t){return t.points.reverse(),t}},function(t,e){t.exports=function(t){return t.width*t.height}},function(t,e){t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t}},function(t,e){t.exports=function(t){return t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),t}},function(t,e,n){var i=n(11);t.exports=function(t){return new i(t.x,t.y,t.width,t.height)}},function(t,e,n){var i=n(47);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x,t.y,t.width,t.height)}},function(t,e){t.exports=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}},function(t,e,n){var i=n(206);t.exports=function(t,e){var n=i(t);return n<i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},function(t,e,n){var i=n(206);t.exports=function(t,e){var n=i(t);return n>i(e)?t.setSize(e.height*n,e.height):t.setSize(e.width,e.width/n),t.setPosition(e.centerX-t.width/2,e.centerY-t.height/2)}},function(t,e){t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t}},function(t,e){t.exports=function(t){return t.x=Math.floor(t.x),t.y=Math.floor(t.y),t.width=Math.floor(t.width),t.height=Math.floor(t.height),t}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.centerX,e.y=t.centerY,e}},function(t,e,n){var i=n(4);t.exports=function(t,e){return void 0===e&&(e=new i),e.x=t.width,e.y=t.height,e}},function(t,e,n){var i=n(163);t.exports=function(t,e,n){var r=t.centerX,s=t.centerY;return t.setSize(t.width+2*e,t.height+2*n),i(t,r,s)}},function(t,e,n){var i=n(11),r=n(129);t.exports=function(t,e,n){return void 0===n&&(n=new i),r(t,e)?(n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.width=Math.min(t.right,e.right)-n.x,n.height=Math.min(t.bottom,e.bottom)-n.y):n.setEmpty(),n}},function(t,e){t.exports=function(t,e){for(var n=t.x,i=t.right,r=t.y,s=t.bottom,o=0;o<e.length;o++)n=Math.min(n,e[o].x),i=Math.max(i,e[o].x),r=Math.min(r,e[o].y),s=Math.max(s,e[o].y);return t.x=n,t.y=r,t.width=i-n,t.height=s-r,t}},function(t,e){t.exports=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.right,e.right);t.x=n,t.width=i-n;var r=Math.min(t.y,e.y),s=Math.max(t.bottom,e.bottom);return t.y=r,t.height=s-r,t}},function(t,e){t.exports=function(t,e,n){var i=Math.min(t.x,e),r=Math.max(t.right,e);t.x=i,t.width=r-i;var s=Math.min(t.y,n),o=Math.max(t.bottom,n);return t.y=s,t.height=o-s,t}},function(t,e){t.exports=function(t,e,n){return t.x+=e,t.y+=n,t}},function(t,e){t.exports=function(t,e){return t.x+=e.x,t.y+=e.y,t}},function(t,e){t.exports=function(t,e){return t.x<e.right&&t.right>e.x&&t.y<e.bottom&&t.bottom>e.y}},function(t,e,n){var i=n(4),r=n(35);t.exports=function(t,e,n){void 0===n&&(n=new i),e=r(e);var s=Math.sin(e),o=Math.cos(e),a=o>0?t.width/2:t.width/-2,u=s>0?t.height/2:t.height/-2;return Math.abs(a*s)<Math.abs(u*o)?u=a*s/o:a=u*o/s,n.x=a+t.centerX,n.y=u+t.centerY,n}},function(t,e,n){var i=n(169),r=n(423),s=n(4);t.exports=function(t,e,n){if(void 0===n&&(n=new s),r(t,e))switch(i(0,3)){case 0:n.x=t.x+Math.random()*(e.right-t.x),n.y=t.y+Math.random()*(e.top-t.y);break;case 1:n.x=e.x+Math.random()*(t.right-e.x),n.y=e.bottom+Math.random()*(t.bottom-e.bottom);break;case 2:n.x=t.x+Math.random()*(e.x-t.x),n.y=e.y+Math.random()*(t.bottom-e.y);break;case 3:n.x=e.right+Math.random()*(t.right-e.right),n.y=t.y+Math.random()*(e.bottom-t.y)}return n}},function(t,e){t.exports=function(t,e){return t.width===e.width&&t.height===e.height}},function(t,e){t.exports=function(t,e,n){return void 0===n&&(n=e),t.width*=e,t.height*=n,t}},function(t,e,n){var i=n(70);i.Area=n(1157),i.BuildEquilateral=n(1158),i.BuildFromPolygon=n(1159),i.BuildRight=n(1160),i.CenterOn=n(1161),i.Centroid=n(424),i.CircumCenter=n(1162),i.CircumCircle=n(1163),i.Clone=n(1164),i.Contains=n(83),i.ContainsArray=n(204),i.ContainsPoint=n(1165),i.CopyFrom=n(1166),i.Decompose=n(417),i.Equals=n(1167),i.GetPoint=n(401),i.GetPoints=n(402),i.InCenter=n(426),i.Perimeter=n(1168),i.Offset=n(425),i.Random=n(153),i.Rotate=n(1169),i.RotateAroundPoint=n(1170),i.RotateAroundXY=n(207),t.exports=i},function(t,e){t.exports=function(t){var e=t.x1,n=t.y1;return Math.abs(((t.x3-e)*(t.y2-n)-(t.x2-e)*(t.y3-n))/2)}},function(t,e,n){var i=n(70);t.exports=function(t,e,n){var r=n*(Math.sqrt(3)/2);return new i(t,e,t+n/2,e+r,t-n/2,e+r)}},function(t,e,n){var i=n(65),r=n(70);t.exports=function(t,e,n,s,o){void 0===e&&(e=null),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o=[]);for(var a,u,l,c=i(t,e),h=0;h<c.length;h+=3)o.push(new r(t[2*(a=c[h])]*n,t[2*a+1]*s,t[2*(u=c[h+1])]*n,t[2*u+1]*s,t[2*(l=c[h+2])]*n,t[2*l+1]*s));return o}},function(t,e,n){var i=n(70);t.exports=function(t,e,n,r){return void 0===r&&(r=n),new i(t,e,t,e-r,t+n,e)}},function(t,e,n){var i=n(424),r=n(425);t.exports=function(t,e,n,s){void 0===s&&(s=i);var o=s(t);return r(t,e-o.x,n-o.y)}},function(t,e,n){var i=n(3);function r(t,e,n,i){return t*i-e*n}t.exports=function(t,e){void 0===e&&(e=new i);var n=t.x3,s=t.y3,o=t.x1-n,a=t.y1-s,u=t.x2-n,l=t.y2-s,c=2*r(o,a,u,l),h=r(a,o*o+a*a,l,u*u+l*l),d=r(o,o*o+a*a,u,u*u+l*l);return e.x=n-h/c,e.y=s+d/c,e}},function(t,e,n){var i=n(78);t.exports=function(t,e){void 0===e&&(e=new i);var n,r,s=t.x1,o=t.y1,a=t.x2,u=t.y2,l=t.x3,c=t.y3,h=a-s,d=u-o,f=l-s,p=c-o,m=h*(s+a)+d*(o+u),g=f*(s+l)+p*(o+c),y=2*(h*(c-u)-d*(l-a));if(Math.abs(y)<1e-6){var v=Math.min(s,a,l),b=Math.min(o,u,c);n=.5*(Math.max(s,a,l)-v),r=.5*(Math.max(o,u,c)-b),e.x=v+n,e.y=b+r,e.radius=Math.sqrt(n*n+r*r)}else e.x=(p*m-d*g)/y,e.y=(h*g-f*m)/y,n=e.x-s,r=e.y-o,e.radius=Math.sqrt(n*n+r*r);return e}},function(t,e,n){var i=n(70);t.exports=function(t){return new i(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},function(t,e,n){var i=n(83);t.exports=function(t,e){return i(t,e.x,e.y)}},function(t,e){t.exports=function(t,e){return e.setTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}},function(t,e){t.exports=function(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2&&t.x3===e.x3&&t.y3===e.y3}},function(t,e,n){var i=n(56);t.exports=function(t){var e=t.getLineA(),n=t.getLineB(),r=t.getLineC();return i(e)+i(n)+i(r)}},function(t,e,n){var i=n(207),r=n(426);t.exports=function(t,e){var n=r(t);return i(t,n.x,n.y,e)}},function(t,e,n){var i=n(207);t.exports=function(t,e,n){return i(t,e.x,e.y,n)}},function(t,e,n){var i=n(176),r=n(16),s={CreateInteractiveObject:n(427),Events:n(53),Gamepad:n(1172),InputManager:n(343),InputPlugin:n(1184),InputPluginCache:n(130),Keyboard:n(1186),Mouse:n(1203),Pointer:n(346),Touch:n(1204)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={Axis:n(428),Button:n(429),Events:n(208),Gamepad:n(430),GamepadPlugin:n(1179),Configs:n(1180)}},function(t,e){t.exports="down"},function(t,e){t.exports="up"},function(t,e){t.exports="connected"},function(t,e){t.exports="disconnected"},function(t,e){t.exports="down"},function(t,e){t.exports="up"},function(t,e,n){var i=n(0),r=n(9),s=n(208),o=n(430),a=n(6),u=n(130),l=n(53),c=new i({Extends:r,initialize:function(t){r.call(this),this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.enabled=!0,this.gamepads=[],this.queue=[],t.pluginEvents.once(l.BOOT,this.boot,this),t.pluginEvents.on(l.START,this.start,this)},boot:function(){var t=this.scene.sys.game,e=this.settings.input,n=t.config;this.enabled=a(e,"gamepad",n.inputGamepad)&&t.device.input.gamepads,this.target=a(e,"gamepad.target",n.inputGamepadEventTarget),this.sceneInputPlugin.pluginEvents.once(l.DESTROY,this.destroy,this)},start:function(){this.enabled&&this.startListeners(),this.sceneInputPlugin.pluginEvents.once(l.SHUTDOWN,this.shutdown,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},startListeners:function(){var t=this,e=this.target,n=function(e){!e.defaultPrevented&&t.isActive()&&(t.refreshPads(),t.queue.push(e))};this.onGamepadHandler=n,e.addEventListener("gamepadconnected",n,!1),e.addEventListener("gamepaddisconnected",n,!1),this.sceneInputPlugin.pluginEvents.on(l.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener("gamepadconnected",this.onGamepadHandler),this.target.removeEventListener("gamepaddisconnected",this.onGamepadHandler),this.sceneInputPlugin.pluginEvents.off(l.UPDATE,this.update)},disconnectAll:function(){for(var t=0;t<this.gamepads.length;t++)this.gamepads.connected=!1},refreshPads:function(){var t=navigator.getGamepads();if(t)for(var e=this.gamepads,n=0;n<t.length;n++){var i=t[n];if(i){var r=i.index,s=e[r];if(s)s.id!==i.id?(s.destroy(),e[r]=new o(this,i)):s.update(i);else{var a=new o(this,i);e[r]=a,this._pad1?this._pad2?this._pad3?this._pad4||(this._pad4=a):this._pad3=a:this._pad2=a:this._pad1=a}}}else this.disconnectAll()},getAll:function(){for(var t=[],e=this.gamepads,n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},getPad:function(t){for(var e=this.gamepads,n=0;n<e.length;n++)if(e[n]&&e[n].index===t)return e[n]},update:function(){if(this.enabled){this.refreshPads();var t=this.queue.length;if(0!==t)for(var e=this.queue.splice(0,t),n=0;n<t;n++){var i=e[n],r=this.getPad(i.gamepad.index);"gamepadconnected"===i.type?this.emit(s.CONNECTED,r,i):"gamepaddisconnected"===i.type&&this.emit(s.DISCONNECTED,r,i)}}},shutdown:function(){this.stopListeners(),this.disconnectAll(),this.removeAllListeners()},destroy:function(){this.shutdown();for(var t=0;t<this.gamepads.length;t++)this.gamepads[t]&&this.gamepads[t].destroy();this.gamepads=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});u.register("GamepadPlugin",c,"gamepad","gamepad","inputGamepad"),t.exports=c},function(t,e,n){t.exports={DUALSHOCK_4:n(1181),SNES_USB:n(1182),XBOX_360:n(1183)}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}},function(t,e){t.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}},function(t,e,n){var i=n(78),r=n(54),s=n(0),o=n(176),a=n(427),u=n(1185),l=n(58),c=n(95),h=n(96),d=n(53),f=n(9),p=n(2),m=n(46),g=n(130),y=n(7),v=n(20),b=n(11),x=n(47),w=n(21),T=n(70),S=n(83),E=new s({Extends:f,initialize:function(t){f.call(this),this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.manager=t.sys.game.input,this.pluginEvents=new f,this.enabled=!0,g.install(this),this.mouse=this.manager.mouse,this.topOnly=!0,this.pollRate=-1,this._pollTimer=0;var e={cancelled:!1};this._eventContainer={stopPropagation:function(){e.cancelled=!0}},this._eventData=e,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this._temp=[],this._tempZones=[],this._list=[],this._pendingInsertion=[],this._pendingRemoval=[],this._draggable=[],this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._dragState=[],this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]},this._validTypes=["onDown","onUp","onOver","onOut","onMove","onDragStart","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDrop"],this._updatedThisFrame=!1,t.sys.events.once(w.BOOT,this.boot,this),t.sys.events.on(w.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras,this.displayList=this.systems.displayList,this.systems.events.once(w.DESTROY,this.destroy,this),this.pluginEvents.emit(d.BOOT)},start:function(){var t=this.systems.events;t.on(w.TRANSITION_START,this.transitionIn,this),t.on(w.TRANSITION_OUT,this.transitionOut,this),t.on(w.TRANSITION_COMPLETE,this.transitionComplete,this),t.on(w.PRE_UPDATE,this.preUpdate,this),t.once(w.SHUTDOWN,this.shutdown,this),this.manager.events.on(d.GAME_OUT,this.onGameOut,this),this.manager.events.on(d.GAME_OVER,this.onGameOver,this),this.enabled=!0,this._dragState=[0,0,0,0,0,0,0,0,0,0],this.pluginEvents.emit(d.START)},onGameOver:function(t){this.isActive()&&this.emit(d.GAME_OVER,t.timeStamp,t)},onGameOut:function(t){this.isActive()&&this.emit(d.GAME_OUT,t.timeStamp,t)},preUpdate:function(){this.pluginEvents.emit(d.PRE_UPDATE);var t=this._pendingRemoval,e=this._pendingInsertion,n=t.length;if(0!==n||0!==e.length){for(var i=this._list,r=0;r<n;r++){var s=t[r],o=i.indexOf(s);o>-1&&(i.splice(o,1),this.clear(s,!0))}t.length=0,this._pendingRemoval.length=0,this._list=i.concat(e.splice(0))}},isActive:function(){return this.enabled&&this.scene.sys.isActive()},updatePoll:function(t,e){if(!this.isActive())return!1;if(this.pluginEvents.emit(d.UPDATE,t,e),this._updatedThisFrame)return this._updatedThisFrame=!1,!1;var n,i=this.manager,r=i.pointers,s=i.pointersTotal;for(n=0;n<s;n++)r[n].updateMotion();if(0===this._list.length)return!1;var o=this.pollRate;if(-1===o)return!1;if(o>0){if(this._pollTimer-=e,!(this._pollTimer<0))return!1;this._pollTimer=this.pollRate}var a=!1;for(n=0;n<s;n++){var u=0,l=r[n];this._tempZones=[],this._temp=this.hitTestPointer(l),this.sortGameObjects(this._temp),this.sortGameObjects(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),u+=this.processOverOutEvents(l),this.processDragThresholdEvent(l),u>0&&(a=!0)}return a},update:function(t,e){if(!this.isActive())return!1;for(var n=e.length,i=!1,r=0;r<n;r++){var s=0,a=e[r];switch(this._tempZones=[],this._temp=this.hitTestPointer(a),this.sortGameObjects(this._temp),this.sortGameObjects(this._tempZones),this.topOnly&&(this._temp.length&&this._temp.splice(1),this._tempZones.length&&this._tempZones.splice(1)),t){case o.MOUSE_DOWN:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_UP:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOverOutEvents(a);break;case o.TOUCH_START:s+=this.processDragDownEvent(a),s+=this.processDownEvents(a),s+=this.processOverEvents(a);break;case o.TOUCH_END:case o.TOUCH_CANCEL:s+=this.processDragUpEvent(a),s+=this.processUpEvents(a),s+=this.processOutEvents(a);break;case o.MOUSE_MOVE:case o.TOUCH_MOVE:s+=this.processDragMoveEvent(a),s+=this.processMoveEvents(a),s+=this.processOverOutEvents(a);break;case o.MOUSE_WHEEL:s+=this.processWheelEvent(a)}s>0&&(i=!0)}return this._updatedThisFrame=!0,i},clear:function(t,e){void 0===e&&(e=!1);var n=t.input;if(n){e||this.queueForRemoval(t),n.gameObject=void 0,n.target=void 0,n.hitArea=void 0,n.hitAreaCallback=void 0,n.callbackContext=void 0,this.manager.resetCursor(n),t.input=null;var i=this._draggable.indexOf(t);return i>-1&&this._draggable.splice(i,1),(i=this._drag[0].indexOf(t))>-1&&this._drag[0].splice(i,1),(i=this._over[0].indexOf(t))>-1&&this._over[0].splice(i,1),t}},disable:function(t){t.input.enabled=!1},enable:function(t,e,n,i){return void 0===i&&(i=!1),t.input?t.input.enabled=!0:this.setHitArea(t,e,n),t.input&&i&&!t.input.dropZone&&(t.input.dropZone=i),this},hitTestPointer:function(t){for(var e=this.cameras.getCamerasBelowPointer(t),n=0;n<e.length;n++){for(var i=e[n],r=this.manager.hitTest(t,this._list,i),s=0;s<r.length;s++){var o=r[s];o.input.dropZone&&this._tempZones.push(o)}if(r.length>0)return t.camera=i,r}return t.camera=e[0],[]},processDownEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input){if(e++,a.emit(d.GAMEOBJECT_POINTER_DOWN,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input){s=!0;break}if(this.emit(d.GAMEOBJECT_DOWN,t,a,r),i.cancelled||!a.input){s=!0;break}}}return!s&&this.manager&&(t.downElement===this.manager.game.canvas?this.emit(d.POINTER_DOWN,t,n):this.emit(d.POINTER_DOWN_OUTSIDE,t)),e},getDragState:function(t){return this._dragState[t.id]},setDragState:function(t,e){this._dragState[t.id]=e},processDragThresholdEvent:function(t,e){var n=!1,i=this.dragTimeThreshold,r=this.dragDistanceThreshold;if((r>0&&l(t.x,t.y,t.downX,t.downY)>=r||i>0&&e>=t.downTime+i)&&(n=!0),n)return this.setDragState(t,3),this.processDragStartList(t)},processDragStartList:function(t){if(3!==this.getDragState(t))return 0;for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;r.dragState=2,r.dragStartX=i.x,r.dragStartY=i.y,r.dragStartXGlobal=t.x,r.dragStartYGlobal=t.y,r.dragX=r.dragStartXGlobal-r.dragStartX,r.dragY=r.dragStartYGlobal-r.dragStartY,i.emit(d.GAMEOBJECT_DRAG_START,t,r.dragX,r.dragY),this.emit(d.DRAG_START,t,i)}return this.setDragState(t,4),e.length},processDragDownEvent:function(t){var e=this._temp;if(0===this._draggable.length||0===e.length||!t.primaryDown||0!==this.getDragState(t))return 0;this.setDragState(t,1);for(var n=[],i=0;i<e.length;i++){var r=e[i];r.input.draggable&&0===r.input.dragState&&n.push(r)}return 0===n.length?(this.setDragState(t,0),0):(n.length>1&&(this.sortGameObjects(n),this.topOnly&&n.splice(1)),this._drag[t.id]=n,0===this.dragDistanceThreshold||0===this.dragTimeThreshold?(this.setDragState(t,3),this.processDragStartList(t)):(this.setDragState(t,2),0))},processDragMoveEvent:function(t){if(4!==this.getDragState(t))return 0;for(var e=this._tempZones,n=this._drag[t.id],i=0;i<n.length;i++){var r,s,o=n[i],a=o.input,u=a.target;if(u){var l=e.indexOf(u);0===l?(o.emit(d.GAMEOBJECT_DRAG_OVER,t,u),this.emit(d.DRAG_OVER,t,o,u)):l>0?(o.emit(d.GAMEOBJECT_DRAG_LEAVE,t,u),this.emit(d.DRAG_LEAVE,t,o,u),a.target=e[0],o.emit(d.GAMEOBJECT_DRAG_ENTER,t,u=a.target),this.emit(d.DRAG_ENTER,t,o,u)):(o.emit(d.GAMEOBJECT_DRAG_LEAVE,t,u),this.emit(d.DRAG_LEAVE,t,o,u),e[0]?(a.target=e[0],o.emit(d.GAMEOBJECT_DRAG_ENTER,t,u=a.target),this.emit(d.DRAG_ENTER,t,o,u)):a.target=null)}else!u&&e[0]&&(a.target=e[0],o.emit(d.GAMEOBJECT_DRAG_ENTER,t,u=a.target),this.emit(d.DRAG_ENTER,t,o,u));if(o.parentContainer){var c=t.x-a.dragStartXGlobal,h=t.y-a.dragStartYGlobal,f=o.getParentRotation(),p=c*Math.cos(f)+h*Math.sin(f),m=h*Math.cos(f)-c*Math.sin(f);r=(p*=1/o.parentContainer.scaleX)+a.dragStartX,s=(m*=1/o.parentContainer.scaleY)+a.dragStartY}else r=t.x-a.dragX,s=t.y-a.dragY;o.emit(d.GAMEOBJECT_DRAG,t,r,s),this.emit(d.DRAG,t,o,r,s)}return n.length},processDragUpEvent:function(t){for(var e=this._drag[t.id],n=0;n<e.length;n++){var i=e[n],r=i.input;if(r&&2===r.dragState){r.dragState=0,r.dragX=r.localX-i.displayOriginX,r.dragY=r.localY-i.displayOriginY;var s=!1,o=r.target;o&&(i.emit(d.GAMEOBJECT_DROP,t,o),this.emit(d.DROP,t,i,o),r.target=null,s=!0),i.input&&(i.emit(d.GAMEOBJECT_DRAG_END,t,r.dragX,r.dragY,s),this.emit(d.DRAG_END,t,i,s))}}return this.setDragState(t,0),e.splice(0),0},processMoveEvents:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=0;o<n.length;o++){var a=n[o];if(a.input){if(e++,a.emit(d.GAMEOBJECT_POINTER_MOVE,t,a.input.localX,a.input.localY,r),i.cancelled||!a.input){s=!0;break}if(this.emit(d.GAMEOBJECT_MOVE,t,a,r),i.cancelled||!a.input){s=!0;break}if(this.topOnly)break}}return s||this.emit(d.POINTER_MOVE,t,n),e},processWheelEvent:function(t){var e=0,n=this._temp,i=this._eventData,r=this._eventContainer;i.cancelled=!1;for(var s=!1,o=t.deltaX,a=t.deltaY,u=t.deltaZ,l=0;l<n.length;l++){var c=n[l];if(c.input){if(e++,c.emit(d.GAMEOBJECT_POINTER_WHEEL,t,o,a,u,r),i.cancelled||!c.input){s=!0;break}if(this.emit(d.GAMEOBJECT_WHEEL,t,c,o,a,u,r),i.cancelled||!c.input){s=!0;break}}}return s||this.emit(d.POINTER_WHEEL,t,n,o,a,u),e},processOverEvents:function(t){var e=this._temp,n=0,i=e.length,r=[];if(i>0){var s=this.manager,o=this._eventData,a=this._eventContainer;o.cancelled=!1;for(var u=!1,l=0;l<i;l++){var c=e[l];if(c.input){if(r.push(c),s.setCursor(c.input),c.emit(d.GAMEOBJECT_POINTER_OVER,t,c.input.localX,c.input.localY,a),n++,o.cancelled||!c.input){u=!0;break}if(this.emit(d.GAMEOBJECT_OVER,t,c,a),o.cancelled||!c.input){u=!0;break}}}u||this.emit(d.POINTER_OVER,t,r)}return this._over[t.id]=r,n},processOutEvents:function(t){var e=this._over[t.id],n=0,i=e.length;if(i>0){var r=this.manager,s=this._eventData,o=this._eventContainer;s.cancelled=!1;var a=!1;this.sortGameObjects(e);for(var u=0;u<i;u++){var l=e[u];for(u=0;u<i;u++)if((l=e[u]).input){if(r.resetCursor(l.input),l.emit(d.GAMEOBJECT_POINTER_OUT,t,o),n++,s.cancelled||!l.input){a=!0;break}if(this.emit(d.GAMEOBJECT_OUT,t,l,o),s.cancelled||!l.input){a=!0;break}}a||this.emit(d.POINTER_OUT,t,e)}this._over[t.id]=[]}return n},processOverOutEvents:function(t){var e,n,i=this._temp,r=[],s=[],o=[],a=this._over[t.id],u=this._drag[t.id],l=this.manager;for(e=0;e<a.length;e++)-1===i.indexOf(n=a[e])&&-1===u.indexOf(n)?r.push(n):o.push(n);for(e=0;e<i.length;e++)-1===a.indexOf(n=i[e])&&s.push(n);var c=r.length,h=0,f=this._eventData,p=this._eventContainer;f.cancelled=!1;var m=!1;if(c>0){for(this.sortGameObjects(r),e=0;e<c;e++)if((n=r[e]).input){if(l.resetCursor(n.input),n.emit(d.GAMEOBJECT_POINTER_OUT,t,p),h++,f.cancelled||!n.input){m=!0;break}if(this.emit(d.GAMEOBJECT_OUT,t,n,p),f.cancelled||!n.input){m=!0;break}}m||this.emit(d.POINTER_OUT,t,r)}if(c=s.length,f.cancelled=!1,m=!1,c>0){for(this.sortGameObjects(s),e=0;e<c;e++)if((n=s[e]).input){if(l.setCursor(n.input),n.emit(d.GAMEOBJECT_POINTER_OVER,t,n.input.localX,n.input.localY,p),h++,f.cancelled||!n.input){m=!0;break}if(this.emit(d.GAMEOBJECT_OVER,t,n,p),f.cancelled||!n.input){m=!0;break}}m||this.emit(d.POINTER_OVER,t,s)}return a=o.concat(s),this._over[t.id]=this.sortGameObjects(a),h},processUpEvents:function(t){var e=this._temp,n=this._eventData,i=this._eventContainer;n.cancelled=!1;for(var r=!1,s=0;s<e.length;s++){var o=e[s];if(o.input){if(o.emit(d.GAMEOBJECT_POINTER_UP,t,o.input.localX,o.input.localY,i),n.cancelled||!o.input){r=!0;break}if(this.emit(d.GAMEOBJECT_UP,t,o,i),n.cancelled||!o.input){r=!0;break}}}return!r&&this.manager&&(t.upElement===this.manager.game.canvas?this.emit(d.POINTER_UP,t,e):this.emit(d.POINTER_UP_OUTSIDE,t)),e.length},queueForInsertion:function(t){return-1===this._pendingInsertion.indexOf(t)&&-1===this._list.indexOf(t)&&this._pendingInsertion.push(t),this},queueForRemoval:function(t){return this._pendingRemoval.push(t),this},setDraggable:function(t,e){void 0===e&&(e=!0),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];i.input.draggable=e;var r=this._draggable.indexOf(i);e&&-1===r?this._draggable.push(i):!e&&r>-1&&this._draggable.splice(r,1)}return this},makePixelPerfect:function(t){return void 0===t&&(t=1),u(this.systems.textures,t)},setHitArea:function(t,e,n){if(void 0===e)return this.setHitAreaFromTexture(t);Array.isArray(t)||(t=[t]);var i=!1,r=!1,s=!1,o=!1,u=!1,l=!0;if(y(e)){var c=e;e=p(c,"hitArea",null),n=p(c,"hitAreaCallback",null),i=p(c,"draggable",!1),r=p(c,"dropZone",!1),s=p(c,"cursor",!1),o=p(c,"useHandCursor",!1),u=p(c,"pixelPerfect",!1);var h=p(c,"alphaTolerance",1);u&&(e={},n=this.makePixelPerfect(h)),e&&n||(this.setHitAreaFromTexture(t),l=!1)}else"function"!=typeof e||n||(n=e,e={});for(var d=0;d<t.length;d++){var f=t[d];if(u&&"Container"===f.type)console.warn("Cannot pixelPerfect test a Container. Use a custom callback.");else{var m=f.input?f.input:a(f,e,n);m.customHitArea=l,m.dropZone=r,m.cursor=o?"pointer":s,f.input=m,i&&this.setDraggable(f),this.queueForInsertion(f)}}return this},setHitAreaCircle:function(t,e,n,s,o){void 0===o&&(o=r);var a=new i(e,n,s);return this.setHitArea(t,a,o)},setHitAreaEllipse:function(t,e,n,i,r,s){void 0===s&&(s=h);var o=new c(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaFromTexture:function(t,e){void 0===e&&(e=x),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n],r=i.frame,s=0,o=0;i.width?(s=i.width,o=i.height):r&&(s=r.realWidth,o=r.realHeight),"Container"!==i.type||0!==s&&0!==o?0!==s&&0!==o&&(i.input=a(i,new b(0,0,s,o),e),this.queueForInsertion(i)):console.warn("Container.setInteractive must specify a Shape or call setSize() first")}return this},setHitAreaRectangle:function(t,e,n,i,r,s){void 0===s&&(s=x);var o=new b(e,n,i,r);return this.setHitArea(t,o,s)},setHitAreaTriangle:function(t,e,n,i,r,s,o,a){void 0===a&&(a=S);var u=new T(e,n,i,r,s,o);return this.setHitArea(t,u,a)},enableDebug:function(t,e){void 0===e&&(e=65280);var n=t.input;if(!n||!n.hitArea)return this;var i=n.hitArea,r=i.type,s=n.hitAreaDebug,o=this.systems.add,a=this.systems.updateList;switch(s&&(a.remove(s),s.destroy(),s=null),r){case m.CIRCLE:s=o.arc(0,0,i.radius);break;case m.ELLIPSE:s=o.ellipse(0,0,i.width,i.height);break;case m.LINE:s=o.line(0,0,i.x1,i.y1,i.x2,i.y2);break;case m.POLYGON:s=o.polygon(0,0,i.points);break;case m.RECTANGLE:s=o.rectangle(0,0,i.width,i.height);break;case m.TRIANGLE:s=o.triangle(0,0,i.x1,i.y1,i.x2,i.y2,i.x3,i.y3)}return s&&(s.isFilled=!1,s.preUpdate=function(){s.setStrokeStyle(1/t.scale,e),s.setDisplayOrigin(t.displayOriginX,t.displayOriginY),s.setRotation(t.rotation),s.setScale(t.scaleX,t.scaleY),s.setPosition(t.x,t.y),s.setScrollFactor(t.scrollFactorX,t.scrollFactorY)},a.add(s),n.hitAreaDebug=s),this},removeDebug:function(t){var e=t.input;if(e&&e.hitAreaDebug){var n=e.hitAreaDebug;this.systems.updateList.remove(n),n.destroy(),e.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(t){return this.pollRate=t,this._pollTimer=0,this},setGlobalTopOnly:function(t){return this.manager.globalTopOnly=t,this},setTopOnly:function(t){return this.topOnly=t,this},sortGameObjects:function(t){return t.length<2?t:(this.scene.sys.depthSort(),t.sort(this.sortHandlerGO.bind(this)))},sortHandlerGO:function(t,e){if(!t.parentContainer&&!e.parentContainer)return this.displayList.getIndex(e)-this.displayList.getIndex(t);if(t.parentContainer===e.parentContainer)return e.parentContainer.getIndex(e)-t.parentContainer.getIndex(t);if(t.parentContainer===e)return-1;if(e.parentContainer===t)return 1;for(var n=t.getIndexList(),i=e.getIndexList(),r=Math.min(n.length,i.length),s=0;s<r;s++){var o=n[s],a=i[s];if(o!==a)return a-o}return 0},stopPropagation:function(){return this.manager._tempSkip=!0,this},addPointer:function(t){return this.manager.addPointer(t)},setDefaultCursor:function(t){return this.manager.setDefaultCursor(t),this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){this.settings.transitionAllowInput||(this.enabled=!0)},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(d.SHUTDOWN),this._temp.length=0,this._list.length=0,this._draggable.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0,this._dragState.length=0;for(var t=0;t<10;t++)this._drag[t]=[],this._over[t]=[];this.removeAllListeners();var e=this.systems.events;e.off(w.TRANSITION_START,this.transitionIn,this),e.off(w.TRANSITION_OUT,this.transitionOut,this),e.off(w.TRANSITION_COMPLETE,this.transitionComplete,this),e.off(w.PRE_UPDATE,this.preUpdate,this),this.manager.events.off(d.GAME_OUT,this.onGameOut,this),this.manager.events.off(d.GAME_OVER,this.onGameOver,this),e.off(w.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.pluginEvents.emit(d.DESTROY),this.pluginEvents.removeAllListeners(),this.scene.sys.events.off(w.START,this.start,this),this.scene=null,this.cameras=null,this.manager=null,this.events=null,this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});v.register("InputPlugin",E,"input"),t.exports=E},function(t,e){t.exports=function(t,e){return function(n,i,r,s){var o=t.getPixelAlpha(i,r,s.texture.key,s.frame.name);return o&&o>=e}}},function(t,e,n){t.exports={Events:n(131),KeyboardManager:n(344),KeyboardPlugin:n(1194),Key:n(431),KeyCodes:n(120),KeyCombo:n(432),JustDown:n(1199),JustUp:n(1200),DownDuration:n(1201),UpDuration:n(1202)}},function(t,e){t.exports="keydown"},function(t,e){t.exports="keyup"},function(t,e){t.exports="keycombomatch"},function(t,e){t.exports="down"},function(t,e){t.exports="keydown-"},function(t,e){t.exports="keyup-"},function(t,e){t.exports="up"},function(t,e,n){var i=n(0),r=n(9),s=n(131),o=n(17),a=n(6),u=n(53),l=n(130),c=n(431),h=n(120),d=n(432),f=n(1198),p=n(93),m=new i({Extends:r,initialize:function(t){r.call(this),this.game=t.systems.game,this.scene=t.scene,this.settings=this.scene.sys.settings,this.sceneInputPlugin=t,this.manager=t.manager.keyboard,this.enabled=!0,this.keys=[],this.combos=[],t.pluginEvents.once(u.BOOT,this.boot,this),t.pluginEvents.on(u.START,this.start,this)},boot:function(){var t=this.settings.input;this.enabled=a(t,"keyboard",!0);var e=a(t,"keyboard.capture",null);e&&this.addCaptures(e),this.sceneInputPlugin.pluginEvents.once(u.DESTROY,this.destroy,this)},start:function(){this.sceneInputPlugin.manager.useQueue?this.sceneInputPlugin.pluginEvents.on(u.UPDATE,this.update,this):this.sceneInputPlugin.manager.events.on(u.MANAGER_PROCESS,this.update,this),this.sceneInputPlugin.pluginEvents.once(u.SHUTDOWN,this.shutdown,this),this.game.events.on(o.BLUR,this.resetKeys,this)},isActive:function(){return this.enabled&&this.scene.sys.isActive()},addCapture:function(t){return this.manager.addCapture(t),this},removeCapture:function(t){return this.manager.removeCapture(t),this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){return this.manager.preventDefault=!0,this},disableGlobalCapture:function(){return this.manager.preventDefault=!1,this},clearCaptures:function(){return this.manager.clearCaptures(),this},createCursorKeys:function(){return this.addKeys({up:h.UP,down:h.DOWN,left:h.LEFT,right:h.RIGHT,space:h.SPACE,shift:h.SHIFT})},addKeys:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i={};if("string"==typeof t){t=t.split(",");for(var r=0;r<t.length;r++){var s=t[r].trim();s&&(i[s]=this.addKey(s,e,n))}}else for(var o in t)i[o]=this.addKey(t[o],e,n);return i},addKey:function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1);var i=this.keys;if(t instanceof c){var r=i.indexOf(t);return r>-1?i[r]=t:i[t.keyCode]=t,e&&this.addCapture(t.keyCode),t.setEmitOnRepeat(n),t}return"string"==typeof t&&(t=h[t.toUpperCase()]),i[t]||(i[t]=new c(this,t),e&&this.addCapture(t),i[t].setEmitOnRepeat(n)),i[t]},removeKey:function(t,e){void 0===e&&(e=!1);var n,i=this.keys;if(t instanceof c){var r=i.indexOf(t);r>-1&&(n=this.keys[r],this.keys[r]=void 0)}else"string"==typeof t&&(t=h[t.toUpperCase()]);return i[t]&&(n=i[t],i[t]=void 0),n&&(n.plugin=null,e&&n.destroy()),this},createCombo:function(t,e){return new d(this,t,e)},checkDown:function(t,e){if(this.enabled&&t.isDown){var n=p(this.time-t.timeDown,e);if(n>t._tick)return t._tick=n,!0}return!1},update:function(){var t=this.manager.queue,e=t.length;if(this.isActive()&&0!==e)for(var n=this.keys,i=0;i<e;i++){var r=t[i],o=r.keyCode,a=n[o],u=!1;void 0===r.cancelled&&(r.cancelled=0,r.stopImmediatePropagation=function(){r.cancelled=1},r.stopPropagation=function(){r.cancelled=-1}),-1!==r.cancelled&&("keydown"===r.type?(a&&(u=a.isDown,a.onDown(r)),r.cancelled||a&&u||(f[o]&&(this.emit(s.KEY_DOWN+f[o],r),this.emit("keydown_"+f[o],r)),r.cancelled||this.emit(s.ANY_KEY_DOWN,r))):(a&&a.onUp(r),r.cancelled||(f[o]&&(this.emit(s.KEY_UP+f[o],r),this.emit("keyup_"+f[o],r)),r.cancelled||this.emit(s.ANY_KEY_UP,r))),1===r.cancelled&&(r.cancelled=0))}},resetKeys:function(){for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].reset();return this},shutdown:function(){this.resetKeys(),this.sceneInputPlugin.manager.useQueue?this.sceneInputPlugin.pluginEvents.off(u.UPDATE,this.update,this):this.sceneInputPlugin.manager.events.off(u.MANAGER_PROCESS,this.update,this),this.game.events.off(o.BLUR,this.resetKeys),this.removeAllListeners(),this.queue=[]},destroy:function(){this.shutdown();for(var t=this.keys,e=0;e<t.length;e++)t[e]&&t[e].destroy();this.keys=[],this.combos=[],this.queue=[],this.scene=null,this.settings=null,this.sceneInputPlugin=null,this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});l.register("KeyboardPlugin",m,"keyboard","keyboard","inputKeyboard"),t.exports=m},function(t,e,n){var i=n(1196);t.exports=function(t,e){if(e.matched)return!0;var n=!1,r=!1;return t.keyCode===e.current&&(e.index>0&&e.maxKeyDelay>0?t.timeStamp<=e.timeLastMatched+e.maxKeyDelay&&(r=!0,n=i(t,e)):(r=!0,n=i(t,e))),!r&&e.resetOnWrongKey&&(e.index=0,e.current=e.keyCodes[0]),n&&(e.timeLastMatched=t.timeStamp,e.matched=!0,e.timeMatched=t.timeStamp),n}},function(t,e){t.exports=function(t,e){return e.timeLastMatched=t.timeStamp,e.index++,e.index===e.size||(e.current=e.keyCodes[e.index],!1)}},function(t,e){t.exports=function(t){return t.current=t.keyCodes[0],t.index=0,t.timeLastMatched=0,t.matched=!1,t.timeMatched=0,t}},function(t,e,n){var i=n(120),r={};for(var s in i)r[i[s]]=s;t.exports=r},function(t,e){t.exports=function(t){return!!t._justDown&&(t._justDown=!1,!0)}},function(t,e){t.exports=function(t){return!!t._justUp&&(t._justUp=!1,!0)}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=50),t.isDown&&t.plugin.game.loop.time-t.timeDown<e}},function(t,e){t.exports=function(t,e){return void 0===e&&(e=50),t.isUp&&t.plugin.game.loop.time-t.timeUp<e}},function(t,e,n){t.exports={MouseManager:n(345)}},function(t,e,n){t.exports={TouchManager:n(347)}},function(t,e,n){var i=n(18),r=n(16),s={Events:n(81),FileTypes:n(1206),File:n(19),FileTypesManager:n(8),GetURL:n(132),LoaderPlugin:n(1230),MergeXHRSettings:n(209),MultiFile:n(61),XHRLoader:n(433),XHRSettings:n(133)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={AnimationJSONFile:n(1207),AtlasJSONFile:n(1208),AtlasXMLFile:n(1209),AudioFile:n(434),AudioSpriteFile:n(1210),BinaryFile:n(1211),BitmapFontFile:n(1212),CSSFile:n(1213),GLSLFile:n(1214),HTML5AudioFile:n(435),HTMLFile:n(1215),HTMLTextureFile:n(1216),ImageFile:n(71),JSONFile:n(60),MultiAtlasFile:n(1217),MultiScriptFile:n(1218),PackFile:n(1219),PluginFile:n(1220),SceneFile:n(1221),ScenePluginFile:n(1222),ScriptFile:n(436),SpriteSheetFile:n(1223),SVGFile:n(1224),TextFile:n(437),TilemapCSVFile:n(1225),TilemapImpactFile:n(1226),TilemapJSONFile:n(1227),UnityAtlasFile:n(1228),VideoFile:n(1229),XMLFile:n(210)}},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(81),a=new i({Extends:s,initialize:function(t,e,n,i,r){s.call(this,t,e,n,i,r),this.type="animationJSON"},onProcess:function(){this.loader.once(o.POST_PROCESS,this.onLoadComplete,this),s.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data),this.pendingDestroy()}});r.register("animation",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this}),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(71),a=n(7),u=n(60),l=n(61),c=new i({Extends:l,initialize:function(t,e,n,i,r,c){var h,d;if(a(e)){var f=e;e=s(f,"key"),h=new o(t,{key:e,url:s(f,"textureURL"),extension:s(f,"textureExtension","png"),normalMap:s(f,"normalMap"),xhrSettings:s(f,"textureXhrSettings")}),d=new u(t,{key:e,url:s(f,"atlasURL"),extension:s(f,"atlasExtension","json"),xhrSettings:s(f,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new u(t,e,i,c);l.call(this,t,"atlasjson",e,h.linkFile?[h,d,h.linkFile]:[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];this.loader.textureManager.addAtlas(t.key,t.data,e.data,this.files[2]?this.files[2].data:null),e.addToCache(),this.complete=!0}}});r.register("atlas",function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(71),a=n(7),u=n(61),l=n(210),c=new i({Extends:u,initialize:function(t,e,n,i,r,c){var h,d;if(a(e)){var f=e;e=s(f,"key"),h=new o(t,{key:e,url:s(f,"textureURL"),extension:s(f,"textureExtension","png"),normalMap:s(f,"normalMap"),xhrSettings:s(f,"textureXhrSettings")}),d=new l(t,{key:e,url:s(f,"atlasURL"),extension:s(f,"atlasExtension","xml"),xhrSettings:s(f,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new l(t,e,i,c);u.call(this,t,"atlasxml",e,h.linkFile?[h,d,h.linkFile]:[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];this.loader.textureManager.addAtlasXML(t.key,t.data,e.data,this.files[2]?this.files[2].data:null),e.addToCache(),this.complete=!0}}});r.register("atlasXML",function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this}),t.exports=c},function(t,e,n){var i=n(434),r=n(0),s=n(8),o=n(2),a=n(7),u=n(60),l=n(61),c=new r({Extends:l,initialize:function(t,e,n,r,s,c,h){if(a(e)){var d=e;e=o(d,"key"),n=o(d,"jsonURL"),r=o(d,"audioURL"),s=o(d,"audioConfig"),c=o(d,"audioXhrSettings"),h=o(d,"jsonXhrSettings")}var f;if(r){var p=i.create(t,e,r,s,c);p&&(f=new u(t,e,n,h),l.call(this,t,"audiosprite",e,[p,f]),this.config.resourceLoad=!1)}else f=new u(t,e,n,h),l.call(this,t,"audiosprite",e,[f]),this.config.resourceLoad=!0,this.config.audioConfig=s,this.config.audioXhrSettings=c},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,this.config.resourceLoad&&"json"===t.type&&t.data.hasOwnProperty("resources"))){var e=t.data.resources,n=o(this.config,"audioConfig"),r=o(this.config,"audioXhrSettings"),s=i.create(this.loader,t.key,e,n,r);s&&(this.addToMultiFile(s),this.loader.addFile(s))}},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[1];this.files[0].addToCache(),t.addToCache(),this.complete=!0}}});s.register("audioSprite",function(t,e,n,i,r,s){var o,a=this.systems.game,u=a.config.audio,l=a.device.audio;if(u&&u.noAudio||!l.webAudio&&!l.audioData)return this;if(Array.isArray(t))for(var h=0;h<t.length;h++)(o=new c(this,t[h])).files&&this.addFile(o.files);else(o=new c(this,t,e,n,i,r,s)).files&&this.addFile(o.files);return this})},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,r){var o="bin";if(u(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"xhrSettings"),o=a(l,"extension",o),r=a(l,"dataType",r)}s.call(this,t,{type:"binary",cache:t.cacheManager.binary,extension:o,responseType:"arraybuffer",key:e,url:n,xhrSettings:i,config:{dataType:r}})},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.dataType;this.data=t?new t(this.xhrLoader.response):this.xhrLoader.response,this.onProcessComplete()}});o.register("binary",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new l(this,t[r]));else this.addFile(new l(this,t,e,i,n));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(71),a=n(7),u=n(61),l=n(184),c=n(210),h=new i({Extends:u,initialize:function(t,e,n,i,r,l){var h,d;if(a(e)){var f=e;e=s(f,"key"),h=new o(t,{key:e,url:s(f,"textureURL"),extension:s(f,"textureExtension","png"),normalMap:s(f,"normalMap"),xhrSettings:s(f,"textureXhrSettings")}),d=new c(t,{key:e,url:s(f,"fontDataURL"),extension:s(f,"fontDataExtension","xml"),xhrSettings:s(f,"fontDataXhrSettings")})}else h=new o(t,e,n,r),d=new c(t,e,i,l);u.call(this,t,"bitmapfont",e,h.linkFile?[h,d,h.linkFile]:[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];t.addToCache(),e.addToCache(),this.loader.cacheManager.bitmapFont.add(t.key,{data:l(e.data),texture:t.key,frame:null}),this.complete=!0}}});r.register("bitmapFont",function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new h(this,t[o]),this.addFile(s.files);else s=new h(this,t,e,n,i,r),this.addFile(s.files);return this}),t.exports=h},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i){var r="css";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"script",cache:!1,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=document.createElement("style"),this.data.defer=!1,this.data.innerHTML=this.xhrLoader.responseText,document.head.appendChild(this.data),this.onProcessComplete()}});o.register("css",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=n(331),c=new i({Extends:s,initialize:function(t,e,n,i,r){var o="glsl";if(u(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"shaderType","fragment"),r=a(l,"xhrSettings"),o=a(l,"extension",o)}else void 0===i&&(i="fragment");s.call(this,t,{type:"glsl",cache:t.cacheManager.shader,extension:o,responseType:"text",key:e,url:n,config:{shaderType:i},xhrSettings:r})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t=this.data.split("\n"),e=this.extractBlock(t,0);if(e)for(;e;){var n=this.getShaderName(e.header),i=this.getShaderType(e.header),r=this.getShaderUniforms(e.header),s=e.shader;if(this.cache.has(n)){var o=this.cache.get(n);"fragment"===i?o.fragmentSrc=s:o.vertexSrc=s,o.uniforms||(o.uniforms=r)}else this.cache.add(n,"fragment"===i?new l(n,s,"",r):new l(n,"",s,r));e=this.extractBlock(t,e.offset)}else this.cache.add(this.key,"fragment"===this.config.shaderType?new l(this.key,this.data):new l(this.key,"",this.data));this.pendingDestroy()},getShaderName:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("name:"===n.substring(0,5))return n.substring(5).trim()}return this.key},getShaderType:function(t){for(var e=0;e<t.length;e++){var n=t[e].trim();if("type:"===n.substring(0,5))return n.substring(5).trim()}return this.config.shaderType},getShaderUniforms:function(t){for(var e={},n=0;n<t.length;n++){var i=t[n].trim();if("uniform."===i.substring(0,8)){var r=i.indexOf(":");if(r){var s=i.substring(8,r);try{e[s]=JSON.parse(i.substring(r+1))}catch(t){console.warn("Invalid uniform JSON: "+s)}}}}return e},extractBlock:function(t,e){for(var n=-1,i=-1,r=-1,s=!1,o=!1,a=[],u=[],l=e;l<t.length;l++){var c=t[l].trim();if("---"===c)if(-1===n)n=l,s=!0;else{if(!s){o=!1;break}i=l,s=!1,o=!0}else s?a.push(c):o&&(u.push(c),r=l)}return s||-1===i?null:{header:a,shader:u.join("\n"),offset:r}}});o.register("glsl",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new c(this,t[r]));else this.addFile(new c(this,t,e,n,i));return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i){var r="html";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"text",cache:t.cacheManager.html,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()}});o.register("html",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new l(this,t[i]));else this.addFile(new l(this,t,e,n));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,r,o){void 0===i&&(i=512),void 0===r&&(r=512);var l="html";if(u(e)){var c=e;e=a(c,"key"),n=a(c,"url"),o=a(c,"xhrSettings"),l=a(c,"extension",l),i=a(c,"width",i),r=a(c,"height",r)}s.call(this,t,{type:"html",cache:t.textureManager,extension:l,responseType:"text",key:e,url:n,xhrSettings:o,config:{width:i,height:r}})},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.config.width,e=this.config.height,n=[];n.push('<svg width="'+t+'px" height="'+e+'px" viewBox="0 0 '+t+" "+e+'" xmlns="http://www.w3.org/2000/svg">'),n.push('<foreignObject width="100%" height="100%">'),n.push('<body xmlns="http://www.w3.org/1999/xhtml">'),n.push(this.xhrLoader.responseText),n.push("</body>"),n.push("</foreignObject>"),n.push("</svg>");var i=[n.join("\n")],o=this;try{var a=new window.Blob(i,{type:"image/svg+xml;charset=utf-8"})}catch(t){return o.state=r.FILE_ERRORED,void o.onProcessComplete()}this.data=new Image,this.data.crossOrigin=this.crossOrigin,this.data.onload=function(){s.revokeObjectURL(o.data),o.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(o.data),o.onProcessError()},s.createObjectURL(this.data,a,"image/svg+xml")},addToCache:function(){var t=this.cache.addImage(this.key,this.data);this.pendingDestroy(t)}});o.register("htmlTexture",function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(71),a=n(7),u=n(60),l=n(61),c=new i({Extends:l,initialize:function(t,e,n,i,r,o,c){if(a(e)){var h=e;e=s(h,"key"),n=s(h,"url"),o=s(h,"xhrSettings"),i=s(h,"path"),r=s(h,"baseURL"),c=s(h,"textureXhrSettings")}var d=new u(t,e,n,o);l.call(this,t,"multiatlas",e,[d]),this.config.path=i,this.config.baseURL=r,this.config.textureXhrSettings=c},onFileComplete:function(t){if(-1!==this.files.indexOf(t)&&(this.pending--,"json"===t.type&&t.data.hasOwnProperty("textures"))){var e=t.data.textures,n=this.config,i=this.loader,r=i.baseURL,a=i.path,u=i.prefix,l=s(n,"baseURL",this.baseURL),c=s(n,"path",this.path),h=s(n,"prefix",this.prefix),d=s(n,"textureXhrSettings");i.setBaseURL(l),i.setPath(c),i.setPrefix(h);for(var f=0;f<e.length;f++){var p=e[f].image,m="MA"+this.multiKeyIndex+"_"+p,g=new o(i,m,p,d);if(this.addToMultiFile(g),i.addFile(g),e[f].normalMap){var y=new o(i,m,e[f].normalMap,d);y.type="normalMap",g.setLink(y),this.addToMultiFile(y),i.addFile(y)}}i.setBaseURL(r),i.setPath(a),i.setPrefix(u)}},addToCache:function(){if(this.isReadyToProcess()){for(var t=this.files[0],e=[],n=[],i=[],r=1;r<this.files.length;r++){var s=this.files[r];if("normalMap"!==s.type)for(var o=s.key.indexOf("_"),a=s.key.substr(o+1),u=s.data,l=0;l<t.data.textures.length;l++){var c=t.data.textures[l];if(c.image===a){n.push(u),e.push(c),s.linkFile&&i.push(s.linkFile.data);break}}}for(0===i.length&&(i=void 0),this.loader.textureManager.addAtlasJSONArray(this.key,n,e,i),this.complete=!0,r=0;r<this.files.length;r++)this.files[r].pendingDestroy()}}});r.register("multiatlas",function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(7),a=n(61),u=n(436),l=new i({Extends:a,initialize:function(t,e,n,i){var r="js",l=[];if(o(e)){var c=e;e=s(c,"key"),n=s(c,"url"),i=s(c,"xhrSettings"),r=s(c,"extension",r)}Array.isArray(n)||(n=[n]);for(var h=0;h<n.length;h++){var d=new u(t,{key:e+"_"+h.toString(),url:n[h],extension:r,xhrSettings:i});d.onProcess=function(){this.onProcessComplete()},l.push(d)}a.call(this,t,"scripts",e,l)},addToCache:function(){if(this.isReadyToProcess()){for(var t=0;t<this.files.length;t++){var e=this.files[t];e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=e.xhrLoader.responseText,document.head.appendChild(e.data)}this.complete=!0}}});r.register("scripts",function(t,e,n){var i;if(Array.isArray(t))for(var r=0;r<t.length;r++)i=new l(this,t[r]),this.addFile(i.files);else i=new l(this,t,e,n),this.addFile(i.files);return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(8),o=n(60),a=new i({Extends:o,initialize:function(t,e,n,i,r){o.call(this,t,e,n,i,r),this.type="packfile"},onProcess:function(){this.state!==r.FILE_POPULATED&&(this.state=r.FILE_PROCESSING,this.data=JSON.parse(this.xhrLoader.responseText)),this.loader.addPack(this.data,this.config),this.onProcessComplete()}});s.register("pack",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new a(this,t[r]));else this.addFile(new a(this,t,e,i,n));return this}),t.exports=a},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,o,l){var c="js";if(u(e)){var h=e;e=a(h,"key"),n=a(h,"url"),l=a(h,"xhrSettings"),c=a(h,"extension",c),i=a(h,"start"),o=a(h,"mapping")}s.call(this,t,{type:"plugin",cache:!1,extension:c,responseType:"text",key:e,url:n,xhrSettings:l,config:{start:i,mapping:o}}),"function"==typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=a(e,"start",!1),i=a(e,"mapping",null);if(this.state===r.FILE_POPULATED)t.install(this.key,this.data,n,i);else{this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data);var s=t.install(this.key,window[this.key],n,i);(n||i)&&(this.loader.systems[i]=s,this.loader.scene[i]=s)}this.onProcessComplete()}});o.register("plugin",function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this}),t.exports=l},function(module,exports,__webpack_require__){var Class=__webpack_require__(0),CONST=__webpack_require__(18),File=__webpack_require__(19),FileTypesManager=__webpack_require__(8),GetFastValue=__webpack_require__(2),IsPlainObject=__webpack_require__(7),SceneFile=new Class({Extends:File,initialize:function(t,e,n,i){var r="js";if(IsPlainObject(e)){var s=e;e=GetFastValue(s,"key"),n=GetFastValue(s,"url"),i=GetFastValue(s,"xhrSettings"),r=GetFastValue(s,"extension",r)}File.call(this,t,{type:"text",cache:t.cacheManager.text,extension:r,responseType:"text",key:e,url:n,xhrSettings:i})},onProcess:function(){this.state=CONST.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var code=this.data.concat("(function(){\nreturn new "+this.key+"();\n}).call(this);");this.loader.sceneManager.add(this.key,eval(code)),this.complete=!0}});FileTypesManager.register("sceneFile",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new SceneFile(this,t[i]));else this.addFile(new SceneFile(this,t,e,n));return this}),module.exports=SceneFile},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,o,l){var c="js";if(u(e)){var h=e;e=a(h,"key"),n=a(h,"url"),l=a(h,"xhrSettings"),c=a(h,"extension",c),i=a(h,"systemKey"),o=a(h,"sceneKey")}s.call(this,t,{type:"scenePlugin",cache:!1,extension:c,responseType:"text",key:e,url:n,xhrSettings:l,config:{systemKey:i,sceneKey:o}}),"function"==typeof n&&(this.data=n,this.state=r.FILE_POPULATED)},onProcess:function(){var t=this.loader.systems.plugins,e=this.config,n=this.key,i=a(e,"systemKey",n),s=a(e,"sceneKey",n);this.state===r.FILE_POPULATED?t.installScenePlugin(i,this.data,s,this.loader.scene,!0):(this.state=r.FILE_PROCESSING,this.data=document.createElement("script"),this.data.language="javascript",this.data.type="text/javascript",this.data.defer=!1,this.data.text=this.xhrLoader.responseText,document.head.appendChild(this.data),t.installScenePlugin(i,window[this.key],s,this.loader.scene,!0)),this.onProcessComplete()}});o.register("scenePlugin",function(t,e,n,i,r){if(Array.isArray(t))for(var s=0;s<t.length;s++)this.addFile(new l(this,t[s]));else this.addFile(new l(this,t,e,n,i,r));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(8),s=n(71),o=new i({Extends:s,initialize:function(t,e,n,i,r){s.call(this,t,e,n,r,i),this.type="spritesheet"},addToCache:function(){var t=this.cache.addSpriteSheet(this.key,this.data,this.config);this.pendingDestroy(t)}});r.register("spritesheet",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new o(this,t[r]));else this.addFile(new o(this,t,e,n,i));return this}),t.exports=o},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=new i({Extends:s,initialize:function(t,e,n,i,r){var o="svg";if(u(e)){var l=e;e=a(l,"key"),n=a(l,"url"),i=a(l,"svgConfig",{}),r=a(l,"xhrSettings"),o=a(l,"extension",o)}var c={type:"svg",cache:t.textureManager,extension:o,responseType:"text",key:e,url:n,xhrSettings:r,config:{width:a(i,"width"),height:a(i,"height"),scale:a(i,"scale")}};s.call(this,t,c)},onProcess:function(){this.state=r.FILE_PROCESSING;var t=this.xhrLoader.responseText,e=[t],n=this.config.width,i=this.config.height,o=this.config.scale;t:if(n&&i||o){var a=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("svg")[0],u=a.hasAttribute("viewBox"),l=parseFloat(a.getAttribute("width")),c=parseFloat(a.getAttribute("height"));if(!u&&l&&c)a.setAttribute("viewBox","0  0 "+l+" "+c);else if(u&&!l&&!c){var h=a.getAttribute("viewBox").split(/\s+|,/);l=h[2],c=h[3]}if(o){if(!l||!c)break t;n=l*o,i=c*o}a.setAttribute("width",n.toString()+"px"),a.setAttribute("height",i.toString()+"px"),e=[(new XMLSerializer).serializeToString(a)]}try{var d=new window.Blob(e,{type:"image/svg+xml;charset=utf-8"})}catch(t){return void this.onProcessError()}this.data=new Image,this.data.crossOrigin=this.crossOrigin;var f=this,p=!1;this.data.onload=function(){p||s.revokeObjectURL(f.data),f.onProcessComplete()},this.data.onerror=function(){p?f.onProcessError():(p=!0,s.revokeObjectURL(f.data),f.data.src="data:image/svg+xml,"+encodeURIComponent(e.join("")))},s.createObjectURL(this.data,d,"image/svg+xml")},addToCache:function(){var t=this.cache.addImage(this.key,this.data);this.pendingDestroy(t)}});o.register("svg",function(t,e,n,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFile(new l(this,t[r]));else this.addFile(new l(this,t,e,n,i));return this}),t.exports=l},function(t,e,n){var i=n(0),r=n(18),s=n(19),o=n(8),a=n(2),u=n(7),l=n(31),c=new i({Extends:s,initialize:function(t,e,n,i){var r="csv";if(u(e)){var o=e;e=a(o,"key"),n=a(o,"url"),i=a(o,"xhrSettings"),r=a(o,"extension",r)}s.call(this,t,{type:"tilemapCSV",cache:t.cacheManager.tilemap,extension:r,responseType:"text",key:e,url:n,xhrSettings:i}),this.tilemapFormat=l.CSV},onProcess:function(){this.state=r.FILE_PROCESSING,this.data=this.xhrLoader.responseText,this.onProcessComplete()},addToCache:function(){var t={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});o.register("tilemapCSV",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new c(this,t[i]));else this.addFile(new c(this,t,e,n));return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(31),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.WELTMEISTER,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});r.register("tilemapImpact",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this}),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(60),o=n(31),a=new i({Extends:s,initialize:function(t,e,n,i){s.call(this,t,e,n,i),this.type="tilemapJSON",this.cache=t.cacheManager.tilemap},addToCache:function(){var t={format:o.TILED_JSON,data:this.data};this.cache.add(this.key,t),this.pendingDestroy(t)}});r.register("tilemapTiledJSON",function(t,e,n){if(Array.isArray(t))for(var i=0;i<t.length;i++)this.addFile(new a(this,t[i]));else this.addFile(new a(this,t,e,n));return this}),t.exports=a},function(t,e,n){var i=n(0),r=n(8),s=n(2),o=n(71),a=n(7),u=n(61),l=n(437),c=new i({Extends:u,initialize:function(t,e,n,i,r,c){var h,d;if(a(e)){var f=e;e=s(f,"key"),h=new o(t,{key:e,url:s(f,"textureURL"),extension:s(f,"textureExtension","png"),normalMap:s(f,"normalMap"),xhrSettings:s(f,"textureXhrSettings")}),d=new l(t,{key:e,url:s(f,"atlasURL"),extension:s(f,"atlasExtension","txt"),xhrSettings:s(f,"atlasXhrSettings")})}else h=new o(t,e,n,r),d=new l(t,e,i,c);u.call(this,t,"unityatlas",e,h.linkFile?[h,d,h.linkFile]:[h,d])},addToCache:function(){if(this.isReadyToProcess()){var t=this.files[0],e=this.files[1];this.loader.textureManager.addUnityAtlas(t.key,t.data,e.data,this.files[2]?this.files[2].data:null),e.addToCache(),this.complete=!0}}});r.register("unityAtlas",function(t,e,n,i,r){var s;if(Array.isArray(t))for(var o=0;o<t.length;o++)s=new c(this,t[o]),this.addFile(s.files);else s=new c(this,t,e,n,i,r),this.addFile(s.files);return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(29),s=n(19),o=n(8),a=n(132),u=n(2),l=n(7),c=new i({Extends:s,initialize:function(t,e,n,i,r,o,a){void 0===i&&(i="loadeddata"),void 0===r&&(r=!1),void 0===o&&(o=!1),"loadeddata"!==i&&"canplay"!==i&&"canplaythrough"!==i&&(i="loadeddata");var u={type:"video",cache:t.cacheManager.video,extension:n.type,responseType:"blob",key:e,url:n.url,xhrSettings:a,config:{loadEvent:i,asBlob:r,noAudio:o}};this.onLoadCallback=this.onVideoLoadHandler.bind(this),this.onErrorCallback=this.onVideoErrorHandler.bind(this),s.call(this,t,u)},onProcess:function(){if(this.state=r.FILE_PROCESSING,this.config.asBlob){var t=this.createVideoElement();this.data=t;var e=this;this.data.onloadeddata=function(){s.revokeObjectURL(e.data),e.onProcessComplete()},this.data.onerror=function(){s.revokeObjectURL(e.data),e.onProcessError()},s.createObjectURL(t,this.xhrLoader.response,""),t.load()}else this.onProcessComplete()},createVideoElement:function(){var t=document.createElement("video");return t.controls=!1,t.crossOrigin=this.loader.crossOrigin,this.config.noAudio&&(t.muted=!0,t.defaultMuted=!0,t.setAttribute("autoplay","autoplay")),t.setAttribute("playsinline","playsinline"),t.setAttribute("preload","auto"),t},onVideoLoadHandler:function(t){var e=t.target;e.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),e.removeEventListener("error",this.onErrorCallback,!0),this.data=e,this.resetXHR(),this.loader.nextFile(this,!0)},onVideoErrorHandler:function(t){var e=t.target;e&&(e.removeEventListener(this.config.loadEvent,this.onLoadCallback,!0),e.removeEventListener("error",this.onErrorCallback,!0)),this.resetXHR(),this.loader.nextFile(this,!1)},load:function(){var t=this.config.loadEvent;if(this.config.asBlob)s.prototype.load.call(this);else{this.percentComplete=0;var e=this.createVideoElement();e.addEventListener(t,this.onLoadCallback,!0),e.addEventListener("error",this.onErrorCallback,!0),e.src=a(this,this.loader.baseURL),e.load()}}});c.create=function(t,e,n,i,r,s,o){var a=t.systems.game;l(e)&&(n=u(e,"url",[]),i=u(e,"loadEvent","loadeddata"),r=u(e,"asBlob",!1),s=u(e,"noAudio",!1),o=u(e,"xhrSettings"));var h=c.getVideoURL(a,n);if(h)return new c(t,e,h,i,r,s,o)},c.getVideoURL=function(t,e){Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=u(e[n],"url",e[n]);if(0===i.indexOf("blob:")||0===i.indexOf("data:"))return i;var r=i.match(/\.([a-zA-Z0-9]+)($|\?)/);if(r=u(e[n],"type",r?r[1]:"").toLowerCase(),t.device.video[r])return{url:i,type:r}}return null},o.register("video",function(t,e,n,i,r,s){var o;if(Array.isArray(t))for(var a=0;a<t.length;a++)(o=c.create(this,t[a]))&&this.addFile(o);else(o=c.create(this,t,e,n,i,r,s))&&this.addFile(o);return this}),t.exports=c},function(t,e,n){var i=n(0),r=n(18),s=n(107),o=n(9),a=n(81),u=n(8),l=n(2),c=n(20),h=n(21),d=n(133),f=new i({Extends:o,initialize:function(t){o.call(this);var e=t.sys.game.config,n=t.sys.settings.loader;this.scene=t,this.systems=t.sys,this.cacheManager=t.sys.cache,this.textureManager=t.sys.textures,this.sceneManager=t.sys.game.scene,u.install(this),this.prefix="",this.path="",this.baseURL="",this.setBaseURL(l(n,"baseURL",e.loaderBaseURL)),this.setPath(l(n,"path",e.loaderPath)),this.setPrefix(l(n,"prefix",e.loaderPrefix)),this.maxParallelDownloads=l(n,"maxParallelDownloads",e.loaderMaxParallelDownloads),this.xhr=d(l(n,"responseType",e.loaderResponseType),l(n,"async",e.loaderAsync),l(n,"user",e.loaderUser),l(n,"password",e.loaderPassword),l(n,"timeout",e.loaderTimeout)),this.crossOrigin=l(n,"crossOrigin",e.loaderCrossOrigin),this.totalToLoad=0,this.progress=0,this.list=new s,this.inflight=new s,this.queue=new s,this._deleteQueue=new s,this.totalFailed=0,this.totalComplete=0,this.state=r.LOADER_IDLE,this.multiKeyIndex=0,t.sys.events.once(h.BOOT,this.boot,this),t.sys.events.on(h.START,this.pluginStart,this)},boot:function(){this.systems.events.once(h.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(h.SHUTDOWN,this.shutdown,this)},setBaseURL:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.baseURL=t,this},setPath:function(t){return void 0===t&&(t=""),""!==t&&"/"!==t.substr(-1)&&(t=t.concat("/")),this.path=t,this},setPrefix:function(t){return void 0===t&&(t=""),this.prefix=t,this},setCORS:function(t){return this.crossOrigin=t,this},addFile:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var n=t[e];this.keyExists(n)||(this.list.set(n),this.emit(a.ADD,n.key,n.type,this,n),this.isLoading()&&(this.totalToLoad++,this.updateProgress()))}},keyExists:function(t){var e=t.hasCacheConflict();return e||this.list.iterate(function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1}),!e&&this.isLoading()&&(this.inflight.iterate(function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1}),this.queue.iterate(function(n){if(n.type===t.type&&n.key===t.key)return e=!0,!1})),e},addPack:function(t,e){e&&t.hasOwnProperty(e)&&(t={packKey:t[e]});var n=0,i=this.baseURL,r=this.path,s=this.prefix;for(var o in t){var a=t[o],u=l(a,"baseURL",i),c=l(a,"path",r),h=l(a,"prefix",s),d=l(a,"files",null),f=l(a,"defaultType","void");if(Array.isArray(d)){this.setBaseURL(u),this.setPath(c),this.setPrefix(h);for(var p=0;p<d.length;p++){var m=d[p],g=m.hasOwnProperty("type")?m.type:f;this[g]&&(this[g](m),n++)}}}return this.setBaseURL(i),this.setPath(r),this.setPrefix(s),n>0},isLoading:function(){return this.state===r.LOADER_LOADING||this.state===r.LOADER_PROCESSING},isReady:function(){return this.state===r.LOADER_IDLE||this.state===r.LOADER_COMPLETE},start:function(){this.isReady()&&(this.progress=0,this.totalFailed=0,this.totalComplete=0,this.totalToLoad=this.list.size,this.emit(a.START,this),0===this.list.size?this.loadComplete():(this.state=r.LOADER_LOADING,this.inflight.clear(),this.queue.clear(),this.updateProgress(),this.checkLoadQueue(),this.systems.events.on(h.UPDATE,this.update,this)))},updateProgress:function(){this.progress=1-(this.list.size+this.inflight.size)/this.totalToLoad,this.emit(a.PROGRESS,this.progress)},update:function(){this.state===r.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads&&this.checkLoadQueue()},checkLoadQueue:function(){this.list.each(function(t){if((t.state===r.FILE_POPULATED||t.state===r.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)&&(this.inflight.set(t),this.list.delete(t),t.crossOrigin||(t.crossOrigin=this.crossOrigin),t.load()),this.inflight.size===this.maxParallelDownloads)return!1},this)},nextFile:function(t,e){this.inflight&&(this.inflight.delete(t),this.updateProgress(),e?(this.totalComplete++,this.queue.set(t),this.emit(a.FILE_LOAD,t),t.onProcess()):(this.totalFailed++,this._deleteQueue.set(t),this.emit(a.FILE_LOAD_ERROR,t),this.fileProcessComplete(t)))},fileProcessComplete:function(t){this.scene&&this.systems&&this.systems.game&&!this.systems.game.pendingDestroy&&(t.state===r.FILE_ERRORED?t.multiFile&&t.multiFile.onFileFailed(t):t.state===r.FILE_COMPLETE&&(t.multiFile?t.multiFile.isReadyToProcess()&&t.multiFile.addToCache():t.addToCache()),this.queue.delete(t),0===this.list.size&&0===this.inflight.size&&0===this.queue.size&&this.loadComplete())},loadComplete:function(){this.emit(a.POST_PROCESS,this),this.list.clear(),this.inflight.clear(),this.queue.clear(),this.progress=1,this.state=r.LOADER_COMPLETE,this.systems.events.off(h.UPDATE,this.update,this),this._deleteQueue.iterateLocal("destroy"),this._deleteQueue.clear(),this.emit(a.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(t){this._deleteQueue.set(t)},saveJSON:function(t,e){return this.save(JSON.stringify(t),e)},save:function(t,e,n){void 0===e&&(e="file.json"),void 0===n&&(n="application/json");var i=new Blob([t],{type:n}),r=URL.createObjectURL(i),s=document.createElement("a");return s.download=e,s.textContent="Download "+e,s.href=r,s.click(),this},reset:function(){this.list.clear(),this.inflight.clear(),this.queue.clear();var t=this.systems.game.config,e=this.systems.settings.loader;this.setBaseURL(l(e,"baseURL",t.loaderBaseURL)),this.setPath(l(e,"path",t.loaderPath)),this.setPrefix(l(e,"prefix",t.loaderPrefix)),this.state=r.LOADER_IDLE},shutdown:function(){this.reset(),this.state=r.LOADER_SHUTDOWN,this.systems.events.off(h.UPDATE,this.update,this),this.systems.events.off(h.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.state=r.LOADER_DESTROYED,this.systems.events.off(h.UPDATE,this.update,this),this.systems.events.off(h.START,this.pluginStart,this),this.list=null,this.inflight=null,this.queue=null,this.scene=null,this.systems=null,this.textureManager=null,this.cacheManager=null,this.sceneManager=null}});c.register("Loader",f,"load"),t.exports=f},function(t,e,n){var i=n(50),r=n(16),s={ArcadePhysics:n(1232),Body:n(443),Collider:n(444),Components:n(211),Events:n(212),Factory:n(438),Group:n(440),Image:n(439),Sprite:n(134),StaticBody:n(449),StaticGroup:n(441),World:n(442)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(0),r=n(35),s=n(58),o=n(300),a=n(438),u=n(2),l=n(106),c=n(1245),h=n(20),d=n(21),f=n(3),p=n(442),m=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),t.sys.events.once(d.BOOT,this.boot,this),t.sys.events.on(d.START,this.start,this)},boot:function(){this.world=new p(this.scene,this.config),this.add=new a(this.world),this.systems.events.once(d.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new p(this.scene,this.config),this.add=new a(this.world));var t=this.systems.events;t.on(d.UPDATE,this.world.update,this.world),t.on(d.POST_UPDATE,this.world.postUpdate,this.world),t.once(d.SHUTDOWN,this.shutdown,this)},getConfig:function(){var t=this.systems.game.config.physics;return l(u(this.systems.settings.physics,"arcade",{}),u(t,"arcade",{}))},overlap:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!0)},collide:function(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=n),this.world.collideObjects(t,e,n,i,r,!1)},collideTiles:function(t,e,n,i,r){return this.world.collideTiles(t,e,n,i,r)},overlapTiles:function(t,e,n,i,r){return this.world.overlapTiles(t,e,n,i,r)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(t,e,n,i,r,s){void 0===i&&(i=60);var o=Math.atan2(n-t.y,e-t.x);return t.body.acceleration.setToPolar(o,i),void 0!==r&&void 0!==s&&t.body.maxVelocity.set(r,s),o},accelerateToObject:function(t,e,n,i,r){return this.accelerateTo(t,e.x,e.y,n,i,r)},closest:function(t){var e=Number.MAX_VALUE,n=null,i=t.x,r=t.y;return this.world.bodies.iterate(function(t){var s=o(i,r,t.x,t.y);s<e&&(n=t,e=s)}),n},furthest:function(t){var e=-1,n=null,i=t.x,r=t.y;return this.world.bodies.iterate(function(t){var s=o(i,r,t.x,t.y);s>e&&(n=t,e=s)}),n},moveTo:function(t,e,n,i,r){void 0===i&&(i=60),void 0===r&&(r=0);var o=Math.atan2(n-t.y,e-t.x);return r>0&&(i=s(t.x,t.y,e,n)/(r/1e3)),t.body.velocity.setToPolar(o,i),o},moveToObject:function(t,e,n,i){return this.moveTo(t,e.x,e.y,n,i)},velocityFromAngle:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new f),n.setToPolar(r(t),e)},velocityFromRotation:function(t,e,n){return void 0===e&&(e=60),void 0===n&&(n=new f),n.setToPolar(t,e)},overlapRect:function(t,e,n,i,r,s){return c(this.world,t,e,n,i,r,s)},shutdown:function(){if(this.world){var t=this.systems.events;t.off(d.UPDATE,this.world.update,this.world),t.off(d.POST_UPDATE,this.world.postUpdate,this.world),t.off(d.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null}},destroy:function(){this.shutdown(),this.scene.sys.events.off(d.START,this.start,this),this.scene=null,this.systems=null}});h.register("ArcadePhysics",m,"arcadePhysics"),t.exports=m},function(t,e){t.exports={setAcceleration:function(t,e){return this.body.acceleration.set(t,e),this},setAccelerationX:function(t){return this.body.acceleration.x=t,this},setAccelerationY:function(t){return this.body.acceleration.y=t,this}}},function(t,e){t.exports={setAngularVelocity:function(t){return this.body.angularVelocity=t,this},setAngularAcceleration:function(t){return this.body.angularAcceleration=t,this},setAngularDrag:function(t){return this.body.angularDrag=t,this}}},function(t,e){t.exports={setBounce:function(t,e){return this.body.bounce.set(t,e),this},setBounceX:function(t){return this.body.bounce.x=t,this},setBounceY:function(t){return this.body.bounce.y=t,this},setCollideWorldBounds:function(t,e,n){return this.body.setCollideWorldBounds(t,e,n),this}}},function(t,e){t.exports={setDebug:function(t,e,n){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=n,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}},function(t,e){t.exports={setDrag:function(t,e){return this.body.drag.set(t,e),this},setDragX:function(t){return this.body.drag.x=t,this},setDragY:function(t){return this.body.drag.y=t,this},setDamping:function(t){return this.body.useDamping=t,this}}},function(t,e){t.exports={enableBody:function(t,e,n,i,r){return t&&this.body.reset(e,n),i&&(this.body.gameObject.active=!0),r&&(this.body.gameObject.visible=!0),this.body.enable=!0,this},disableBody:function(t,e){return void 0===t&&(t=!1),void 0===e&&(e=!1),this.body.stop(),this.body.enable=!1,t&&(this.body.gameObject.active=!1),e&&(this.body.gameObject.visible=!1),this},refreshBody:function(){return this.body.updateFromGameObject(),this}}},function(t,e){t.exports={setFriction:function(t,e){return this.body.friction.set(t,e),this},setFrictionX:function(t){return this.body.friction.x=t,this},setFrictionY:function(t){return this.body.friction.y=t,this}}},function(t,e){t.exports={setGravity:function(t,e){return this.body.gravity.set(t,e),this},setGravityX:function(t){return this.body.gravity.x=t,this},setGravityY:function(t){return this.body.gravity.y=t,this}}},function(t,e){t.exports={setImmovable:function(t){return void 0===t&&(t=!0),this.body.immovable=t,this}}},function(t,e){t.exports={setMass:function(t){return this.body.mass=t,this}}},function(t,e){t.exports={setOffset:function(t,e){return this.body.setOffset(t,e),this},setSize:function(t,e,n){return this.body.setSize(t,e,n),this},setCircle:function(t,e,n){return this.body.setCircle(t,e,n),this}}},function(t,e){t.exports={setVelocity:function(t,e){return this.body.setVelocity(t,e),this},setVelocityX:function(t){return this.body.setVelocityX(t),this},setVelocityY:function(t){return this.body.setVelocityY(t),this},setMaxVelocity:function(t,e){return this.body.maxVelocity.set(t,e),this}}},function(t,e){t.exports=function(t,e,n,i,r,s,o){void 0===s&&(s=!0),void 0===o&&(o=!1);var a=[],u=[],l=t.treeMinMax;if(l.minX=e,l.minY=n,l.maxX=e+i,l.maxY=n+r,o&&(u=t.staticTree.search(l)),s&&t.useTree)a=t.tree.search(l);else if(s){var c={position:{x:e,y:n},left:e,top:n,right:e+i,bottom:n+r,isCircle:!1},h=t.intersects;t.bodies.iterate(function(t){h(t,c)&&a.push(t)})}return u.concat(a)}},function(t,e){t.exports="collide"},function(t,e){t.exports="overlap"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="tilecollide"},function(t,e){t.exports="tileoverlap"},function(t,e){t.exports="worldbounds"},function(t,e){t.exports="worldstep"},function(t,e){t.exports=function(t,e){return t.collisionCallback?!t.collisionCallback.call(t.collisionCallbackContext,e,t):!t.layer.callbacks[t.index]||!t.layer.callbacks[t.index].callback.call(t.layer.callbacks[t.index].callbackContext,e,t)}},function(t,e,n){var i=n(1256),r=n(1258),s=n(448);t.exports=function(t,e,n,o,a,u,l){var c=o.left,h=o.top,d=o.right,f=o.bottom,p=n.faceLeft||n.faceRight,m=n.faceTop||n.faceBottom;if(l||(p=!0,m=!0),!p&&!m)return!1;var g=0,y=0,v=0,b=1;if(e.deltaAbsX()>e.deltaAbsY()?v=-1:e.deltaAbsX()<e.deltaAbsY()&&(b=-1),0!==e.deltaX()&&0!==e.deltaY()&&p&&m&&(v=Math.min(Math.abs(e.position.x-d),Math.abs(e.right-c)),b=Math.min(Math.abs(e.position.y-f),Math.abs(e.bottom-h))),v<b){if(p&&0!==(g=i(e,n,c,d,u,l))&&!s(o,e))return!0;m&&(y=r(e,n,h,f,u,l))}else{if(m&&0!==(y=r(e,n,h,f,u,l))&&!s(o,e))return!0;p&&(g=i(e,n,c,d,u,l))}return 0!==g||0!==y}},function(t,e,n){var i=n(1257);t.exports=function(t,e,n,r,s,o){var a=0,u=e.faceLeft,l=e.faceRight,c=e.collideLeft,h=e.collideRight;return o||(u=!0,l=!0,c=!0,h=!0),t.deltaX()<0&&h&&t.checkCollision.left?l&&t.x<r&&(a=t.x-r)<-s&&(a=0):t.deltaX()>0&&c&&t.checkCollision.right&&u&&t.right>n&&(a=t.right-n)>s&&(a=0),0!==a&&(t.customSeparateX?t.overlapX=a:i(t,a)),a}},function(t,e){t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.left=!0):e>0&&(t.blocked.none=!1,t.blocked.right=!0),t.position.x-=e,t.velocity.x=0===t.bounce.x?0:-t.velocity.x*t.bounce.x}},function(t,e,n){var i=n(1259);t.exports=function(t,e,n,r,s,o){var a=0,u=e.faceTop,l=e.faceBottom,c=e.collideUp,h=e.collideDown;return o||(u=!0,l=!0,c=!0,h=!0),t.deltaY()<0&&h&&t.checkCollision.up?l&&t.y<r&&(a=t.y-r)<-s&&(a=0):t.deltaY()>0&&c&&t.checkCollision.down&&u&&t.bottom>n&&(a=t.bottom-n)>s&&(a=0),0!==a&&(t.customSeparateY?t.overlapY=a:i(t,a)),a}},function(t,e){t.exports=function(t,e){e<0?(t.blocked.none=!1,t.blocked.up=!0):e>0&&(t.blocked.none=!1,t.blocked.down=!0),t.position.y-=e,t.velocity.y=0===t.bounce.y?0:-t.velocity.y*t.bounce.y}},function(t,e,n){var i=n(445);t.exports=function(t,e,n,r){var s=i(t,e,n,r);if(n||0===s||t.immovable&&e.immovable||t.customSeparateX||e.customSeparateX)return 0!==s||t.embedded&&e.embedded;var o=t.velocity.x,a=e.velocity.x;if(t.immovable||e.immovable)t.immovable?(e.x+=s,e.velocity.x=o-a*e.bounce.x,t.moves&&(e.y+=(t.y-t.prev.y)*t.friction.y)):(t.x-=s,t.velocity.x=a-o*t.bounce.x,e.moves&&(t.y+=(e.y-e.prev.y)*e.friction.y));else{t.x-=s*=.5,e.x+=s;var u=Math.sqrt(a*a*e.mass/t.mass)*(a>0?1:-1),l=Math.sqrt(o*o*t.mass/e.mass)*(o>0?1:-1),c=.5*(u+l);l-=c,t.velocity.x=c+(u-=c)*t.bounce.x,e.velocity.x=c+l*e.bounce.x}return!0}},function(t,e,n){var i=n(446);t.exports=function(t,e,n,r){var s=i(t,e,n,r);if(n||0===s||t.immovable&&e.immovable||t.customSeparateY||e.customSeparateY)return 0!==s||t.embedded&&e.embedded;var o=t.velocity.y,a=e.velocity.y;if(t.immovable||e.immovable)t.immovable?(e.y+=s,e.velocity.y=o-a*e.bounce.y,t.moves&&(e.x+=(t.x-t.prev.x)*t.friction.x)):(t.y-=s,t.velocity.y=a-o*t.bounce.y,e.moves&&(t.x+=(e.x-e.prev.x)*e.friction.x));else{t.y-=s*=.5,e.y+=s;var u=Math.sqrt(a*a*e.mass/t.mass)*(a>0?1:-1),l=Math.sqrt(o*o*t.mass/e.mass)*(o>0?1:-1),c=.5*(u+l);l-=c,t.velocity.y=c+(u-=c)*t.bounce.y,e.velocity.y=c+l*e.bounce.y}return!0}},function(t,e,n){t.exports={COLLIDE:n(1376),PAUSE:n(1377),RESUME:n(1378)}},function(t,e,n){t.exports={Acceleration:n(1380),BodyScale:n(1381),BodyType:n(1382),Bounce:n(1383),CheckAgainst:n(1384),Collides:n(1385),Debug:n(1386),Friction:n(1387),Gravity:n(1388),Offset:n(1389),SetGameObject:n(1390),Velocity:n(1391)}},function(t,e,n){var i={};t.exports=i;var r=n(101),s=n(37);i.fromVertices=function(t){for(var e={},n=0;n<t.length;n++){var i=(n+1)%t.length,o=r.normalise({x:t[i].y-t[n].y,y:t[n].x-t[i].x}),a=0===o.y?1/0:o.x/o.y;e[a=a.toFixed(3).toString()]=o}return s.values(e)},i.rotate=function(t,e){if(0!==e)for(var n=Math.cos(e),i=Math.sin(e),r=0;r<t.length;r++){var s,o=t[r];s=o.x*n-o.y*i,o.y=o.x*i+o.y*n,o.x=s}}},function(t,e,n){t.exports={AFTER_UPDATE:n(1408),BEFORE_UPDATE:n(1409),COLLISION_ACTIVE:n(1410),COLLISION_END:n(1411),COLLISION_START:n(1412),DRAG_END:n(1413),DRAG:n(1414),DRAG_START:n(1415),PAUSE:n(1416),RESUME:n(1417),SLEEP_END:n(1418),SLEEP_START:n(1419)}},function(t,e,n){var i=n(135),r=n(62),s=n(0),o=n(491),a=n(2),u=n(99),l=n(86),c=new s({Mixins:[o.Bounce,o.Collision,o.Friction,o.Gravity,o.Mass,o.Sensor,o.Sleep,o.Static],initialize:function(t,e,n){this.tile=e,this.world=t,e.physics.matterBody&&e.physics.matterBody.destroy(),e.physics.matterBody=this;var i=a(n,"body",null),r=a(n,"addToWorld",!0);if(i)this.setBody(i,r);else{var s=e.getCollisionGroup();a(s,"objects",[]).length>0?this.setFromTileCollision(n):this.setFromTileRectangle(n)}},setFromTileRectangle:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);var e=this.tile.getBounds(),n=i.rectangle(e.x+e.width/2,e.y+e.height/2,e.width,e.height,t);return this.setBody(n,t.addToWorld),this},setFromTileCollision:function(t){void 0===t&&(t={}),u(t,"isStatic")||(t.isStatic=!0),u(t,"addToWorld")||(t.addToWorld=!0);for(var e=this.tile.tilemapLayer.scaleX,n=this.tile.tilemapLayer.scaleY,s=this.tile.getLeft(),o=this.tile.getTop(),c=this.tile.getCollisionGroup(),h=a(c,"objects",[]),d=[],f=0;f<h.length;f++){var p=h[f],m=s+p.x*e,g=o+p.y*n,y=p.width*e,v=p.height*n,b=null;if(p.rectangle)b=i.rectangle(m+y/2,g+v/2,y,v,t);else if(p.ellipse)b=i.circle(m+y/2,g+v/2,y/2,t);else if(p.polygon||p.polyline){var x=(p.polygon?p.polygon:p.polyline).map(function(t){return{x:t.x*e,y:t.y*n}}),w=l.create(x),T=l.centre(w);b=i.fromVertices(m+=T.x,g+=T.y,w,t)}b&&d.push(b)}return 1===d.length?this.setBody(d[0],t.addToWorld):d.length>1&&(t.parts=d,this.setBody(r.create(t),t.addToWorld)),this},setBody:function(t,e){return void 0===e&&(e=!0),this.body&&this.removeBody(),this.body=t,this.body.gameObject=this,e&&this.world.add(this.body),this},removeBody:function(){return this.body&&(this.world.remove(this.body),this.body.gameObject=void 0,this.body=void 0),this},destroy:function(){this.removeBody(),this.tile.physics.matterBody=void 0}});t.exports=c},function(t,e,n){var i={};t.exports=i;var r=n(1268),s=n(492),o=n(102);i.collisions=function(t,e){for(var n=[],a=e.pairs.table,u=e.metrics,l=0;l<t.length;l++){var c=t[l][0],h=t[l][1];if((!c.isStatic&&!c.isSleeping||!h.isStatic&&!h.isSleeping)&&i.canCollide(c.collisionFilter,h.collisionFilter)&&(u.midphaseTests+=1,o.overlaps(c.bounds,h.bounds)))for(var d=c.parts.length>1?1:0;d<c.parts.length;d++)for(var f=c.parts[d],p=h.parts.length>1?1:0;p<h.parts.length;p++){var m=h.parts[p];if(f===c&&m===h||o.overlaps(f.bounds,m.bounds)){var g=a[s.id(f,m)],y=r.collides(f,m,g&&g.isActive?g.collision:null);u.narrowphaseTests+=1,y.reused&&(u.narrowReuseCount+=1),y.collided&&(n.push(y),u.narrowDetections+=1)}}}return n},i.canCollide=function(t,e){return t.group===e.group&&0!==t.group?t.group>0:0!=(t.mask&e.category)&&0!=(e.mask&t.category)}},function(t,e,n){var i={};t.exports=i;var r=n(86),s=n(101);i.collides=function(t,e,n){var o,a,u,l,c=!1;if(n){var h=t.parent,d=e.parent;c=n&&n.collided&&h.speed*h.speed+h.angularSpeed*h.angularSpeed+d.speed*d.speed+d.angularSpeed*d.angularSpeed<.2,l=n}else l={collided:!1,bodyA:t,bodyB:e};if(n&&c){var f=l.axisBody;if(u=i._overlapAxes(f.vertices,(f===t?e:t).vertices,[f.axes[n.axisNumber]]),l.reused=!0,u.overlap<=0)return l.collided=!1,l}else{if((o=i._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return l.collided=!1,l;if((a=i._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return l.collided=!1,l;o.overlap<a.overlap?(u=o,l.axisBody=t):(u=a,l.axisBody=e),l.axisNumber=u.axisNumber}l.bodyA=t.id<e.id?t:e,l.bodyB=t.id<e.id?e:t,l.collided=!0,l.depth=u.overlap,l.parentA=l.bodyA.parent,l.parentB=l.bodyB.parent,l.normal=s.dot(u.axis,s.sub((e=l.bodyB).position,(t=l.bodyA).position))<0?{x:u.axis.x,y:u.axis.y}:{x:-u.axis.x,y:-u.axis.y},l.tangent=s.perp(l.normal),l.penetration=l.penetration||{},l.penetration.x=l.normal.x*l.depth,l.penetration.y=l.normal.y*l.depth;var p=i._findSupports(t,e,l.normal),m=[];if(r.contains(t.vertices,p[0])&&m.push(p[0]),r.contains(t.vertices,p[1])&&m.push(p[1]),m.length<2){var g=i._findSupports(e,t,s.neg(l.normal));r.contains(e.vertices,g[0])&&m.push(g[0]),m.length<2&&r.contains(e.vertices,g[1])&&m.push(g[1])}return m.length<1&&(m=[p[0]]),l.supports=m,l},i._overlapAxes=function(t,e,n){for(var r,o,a=s._temp[0],u=s._temp[1],l={overlap:Number.MAX_VALUE},c=0;c<n.length;c++){if(i._projectToAxis(a,t,o=n[c]),i._projectToAxis(u,e,o),(r=Math.min(a.max-u.min,u.max-a.min))<=0)return l.overlap=r,l;r<l.overlap&&(l.overlap=r,l.axis=o,l.axisNumber=c)}return l},i._projectToAxis=function(t,e,n){for(var i=s.dot(e[0],n),r=i,o=1;o<e.length;o+=1){var a=s.dot(e[o],n);a>r?r=a:a<i&&(i=a)}t.min=i,t.max=r},i._findSupports=function(t,e,n){for(var i,r,o,a,u=Number.MAX_VALUE,l=s._temp[0],c=e.vertices,h=t.position,d=0;d<c.length;d++)l.x=(r=c[d]).x-h.x,l.y=r.y-h.y,(i=-s.dot(n,l))<u&&(u=i,o=r);return l.x=(r=c[o.index-1>=0?o.index-1:c.length-1]).x-h.x,l.y=r.y-h.y,u=-s.dot(n,l),a=r,l.x=(r=c[(o.index+1)%c.length]).x-h.x,l.y=r.y-h.y,(i=-s.dot(n,l))<u&&(a=r),[o,a]}},function(t,e,n){var i=n(1365);i.Body=n(62),i.Composite=n(213),i.World=n(1271),i.Detector=n(1267),i.Grid=n(1366),i.Pairs=n(1367),i.Pair=n(492),i.Query=n(1423),i.Resolver=n(1368),i.SAT=n(1268),i.Constraint=n(234),i.Common=n(37),i.Engine=n(1369),i.Events=n(233),i.Sleeping=n(452),i.Plugin=n(1270),i.Bodies=n(135),i.Composites=n(1361),i.Axes=n(1264),i.Bounds=n(102),i.Svg=n(1425),i.Vector=n(101),i.Vertices=n(86),i.World.add=i.Composite.add,i.World.remove=i.Composite.remove,i.World.addComposite=i.Composite.addComposite,i.World.addBody=i.Composite.addBody,i.World.addConstraint=i.Composite.addConstraint,i.World.clear=i.Composite.clear,t.exports=i},function(t,e,n){var i={};t.exports=i;var r=n(37);i._registry={},i.register=function(t){if(i.isPlugin(t)||r.warn("Plugin.register:",i.toString(t),"does not implement all required fields."),t.name in i._registry){var e=i._registry[t.name],n=i.versionParse(t.version).number,s=i.versionParse(e.version).number;n>s?(r.warn("Plugin.register:",i.toString(e),"was upgraded to",i.toString(t)),i._registry[t.name]=t):n<s?r.warn("Plugin.register:",i.toString(e),"can not be downgraded to",i.toString(t)):t!==e&&r.warn("Plugin.register:",i.toString(t),"is already registered to different plugin object")}else i._registry[t.name]=t;return t},i.resolve=function(t){return i._registry[i.dependencyParse(t).name]},i.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},i.isPlugin=function(t){return t&&t.name&&t.version&&t.install},i.isUsed=function(t,e){return t.used.indexOf(e)>-1},i.isFor=function(t,e){var n=t.for&&i.dependencyParse(t.for);return!t.for||e.name===n.name&&i.versionSatisfies(e.version,n.range)},i.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0!==t.uses.length){for(var n=i.dependencies(t),s=r.topologicalSort(n),o=[],a=0;a<s.length;a+=1)if(s[a]!==t.name){var u=i.resolve(s[a]);u?i.isUsed(t,u.name)||(i.isFor(u,t)||(r.warn("Plugin.use:",i.toString(u),"is for",u.for,"but installed on",i.toString(t)+"."),u._warned=!0),u.install?u.install(t):(r.warn("Plugin.use:",i.toString(u),"does not specify an install function."),u._warned=!0),u._warned?(o.push("\ud83d\udd36 "+i.toString(u)),delete u._warned):o.push("\u2705 "+i.toString(u)),t.used.push(u.name)):o.push("\u274c "+s[a])}o.length>0&&!u.silent&&r.info(o.join("  "))}else r.warn("Plugin.use:",i.toString(t),"does not specify any dependencies to install.")},i.dependencies=function(t,e){var n=i.dependencyParse(t),s=n.name;if(!(s in(e=e||{}))){t=i.resolve(t)||t,e[s]=r.map(t.uses||[],function(e){i.isPlugin(e)&&i.register(e);var s=i.dependencyParse(e),o=i.resolve(e);return o&&!i.versionSatisfies(o.version,s.range)?(r.warn("Plugin.dependencies:",i.toString(o),"does not satisfy",i.toString(s),"used by",i.toString(n)+"."),o._warned=!0,t._warned=!0):o||(r.warn("Plugin.dependencies:",i.toString(e),"used by",i.toString(n),"could not be resolved."),t._warned=!0),s.name});for(var o=0;o<e[s].length;o+=1)i.dependencies(e[s][o],e);return e}},i.dependencyParse=function(t){return r.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(t)||r.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},i.versionParse=function(t){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(t)||r.warn("Plugin.versionParse:",t,"is not a valid version or range.");var e=t.split("-");t=e[0];var n=isNaN(Number(t[0])),i=n?t.substr(1):t,s=r.map(i.split("."),function(t){return Number(t)});return{isRange:n,version:i,range:t,operator:n?t[0]:"",parts:s,prerelease:e[1],number:1e8*s[0]+1e4*s[1]+s[2]}},i.versionSatisfies=function(t,e){var n=i.versionParse(e=e||"*"),r=n.parts,s=i.versionParse(t),o=s.parts;if(n.isRange){if("*"===n.operator||"*"===t)return!0;if("~"===n.operator)return o[0]===r[0]&&o[1]===r[1]&&o[2]>=r[2];if("^"===n.operator)return r[0]>0?o[0]===r[0]&&s.number>=n.number:r[1]>0?o[1]===r[1]&&o[2]>=r[2]:o[2]===r[2]}return t===e||"*"===t}},function(t,e,n){var i={};t.exports=i;var r=n(213),s=(n(234),n(37));i.create=function(t){var e=r.create();return s.extend(e,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}},t)}},function(t,e,n){t.exports={BasePlugin:n(453),DefaultPlugins:n(172),PluginCache:n(20),PluginManager:n(348),ScenePlugin:n(1273)}},function(t,e,n){var i=n(453),r=n(0),s=n(21),o=new r({Extends:i,initialize:function(t,e){i.call(this,e),this.scene=t,this.systems=t.sys,t.sys.events.once(s.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}});t.exports=o},function(t,e,n){var i=n(16),r=n(174),s={Center:n(337),Events:n(92),Orientation:n(338),ScaleManager:n(349),ScaleModes:n(339),Zoom:n(340)};s=i(!1,s=i(!1,s=i(!1,s=i(!1,s,r.CENTER),r.ORIENTATION),r.SCALE_MODE),r.ZOOM),t.exports=s},function(t,e,n){var i=n(121),r=n(16),s={Events:n(21),SceneManager:n(351),ScenePlugin:n(1276),Settings:n(353),Systems:n(177)};s=r(!1,s,i),t.exports=s},function(t,e,n){var i=n(22),r=n(0),s=n(21),o=n(2),a=n(20),u=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.settings=t.sys.settings,this.key=t.sys.settings.key,this.manager=t.sys.game.scene,this.transitionProgress=0,this._elapsed=0,this._target=null,this._duration=0,this._willSleep=!1,this._willRemove=!1,t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.pluginStart,this)},boot:function(){this.systems.events.once(s.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null,this.systems.events.once(s.SHUTDOWN,this.shutdown,this)},start:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",this.key),this.manager.queueOp("start",t,e),this},restart:function(t){var e=this.key;return this.manager.queueOp("stop",e),this.manager.queueOp("start",e,t),this},transition:function(t){void 0===t&&(t={});var e=o(t,"target",!1),n=this.manager.getScene(e);if(!e||!this.checkValidTransition(n))return!1;var i=o(t,"duration",1e3);this._elapsed=0,this._target=n,this._duration=i,this._willSleep=o(t,"sleep",!1),this._willRemove=o(t,"remove",!1);var r=o(t,"onUpdate",null);r&&(this._onUpdate=r,this._onUpdateScope=o(t,"onUpdateScope",this.scene));var a=o(t,"allowInput",!1);this.settings.transitionAllowInput=a;var u=n.sys.settings;return u.isTransition=!0,u.transitionFrom=this.scene,u.transitionDuration=i,u.transitionAllowInput=a,o(t,"moveAbove",!1)?this.manager.moveAbove(this.key,e):o(t,"moveBelow",!1)&&this.manager.moveBelow(this.key,e),n.sys.isSleeping()?n.sys.wake():this.manager.start(e,o(t,"data")),this.systems.events.emit(s.TRANSITION_OUT,n,i),this.systems.events.on(s.UPDATE,this.step,this),!0},checkValidTransition:function(t){return!(!t||t.sys.isActive()||t.sys.isTransitioning()||t===this.scene||this.systems.isTransitioning())},step:function(t,e){this._elapsed+=e,this.transitionProgress=i(this._elapsed/this._duration,0,1),this._onUpdate&&this._onUpdate.call(this._onUpdateScope,this.transitionProgress),this._elapsed>=this._duration&&this.transitionComplete()},transitionComplete:function(){var t=this._target.sys,e=this._target.sys.settings;this.systems.events.off(s.UPDATE,this.step,this),t.events.emit(s.TRANSITION_COMPLETE,this.scene),e.isTransition=!1,e.transitionFrom=null,this._duration=0,this._target=null,this._onUpdate=null,this._onUpdateScope=null,this._willRemove?this.manager.remove(this.key):this._willSleep?this.systems.sleep():this.manager.stop(this.key)},add:function(t,e,n,i){return this.manager.add(t,e,n,i)},launch:function(t,e){return t&&t!==this.key&&this.manager.queueOp("start",t,e),this},run:function(t,e){return t&&t!==this.key&&this.manager.queueOp("run",t,e),this},pause:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("pause",t,e),this},resume:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("resume",t,e),this},sleep:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("sleep",t,e),this},wake:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("wake",t,e),this},switch:function(t){return t!==this.key&&this.manager.queueOp("switch",this.key,t),this},stop:function(t,e){return void 0===t&&(t=this.key),this.manager.queueOp("stop",t,e),this},setActive:function(t,e,n){void 0===e&&(e=this.key);var i=this.manager.getScene(e);return i&&i.sys.setActive(t,n),this},setVisible:function(t,e){void 0===e&&(e=this.key);var n=this.manager.getScene(e);return n&&n.sys.setVisible(t),this},isSleeping:function(t){return void 0===t&&(t=this.key),this.manager.isSleeping(t)},isActive:function(t){return void 0===t&&(t=this.key),this.manager.isActive(t)},isPaused:function(t){return void 0===t&&(t=this.key),this.manager.isPaused(t)},isVisible:function(t){return void 0===t&&(t=this.key),this.manager.isVisible(t)},swapPosition:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.swapPosition(t,e),this},moveAbove:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveAbove(t,e),this},moveBelow:function(t,e){return void 0===e&&(e=this.key),t!==e&&this.manager.moveBelow(t,e),this},remove:function(t){return void 0===t&&(t=this.key),this.manager.remove(t),this},moveUp:function(t){return void 0===t&&(t=this.key),this.manager.moveUp(t),this},moveDown:function(t){return void 0===t&&(t=this.key),this.manager.moveDown(t),this},bringToTop:function(t){return void 0===t&&(t=this.key),this.manager.bringToTop(t),this},sendToBack:function(t){return void 0===t&&(t=this.key),this.manager.sendToBack(t),this},get:function(t){return this.manager.getScene(t)},getIndex:function(t){return void 0===t&&(t=this.key),this.manager.getIndex(t)},shutdown:function(){var t=this.systems.events;t.off(s.SHUTDOWN,this.shutdown,this),t.off(s.POST_UPDATE,this.step,this),t.off(s.TRANSITION_OUT)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null,this.settings=null,this.manager=null}});a.register("ScenePlugin",u,"scenePlugin"),t.exports=u},function(t,e,n){t.exports={List:n(124),Map:n(157),ProcessQueue:n(183),RTree:n(447),Set:n(107),Size:n(350)}},function(t,e,n){var i=n(16),r=n(1279),s={CanvasTexture:n(355),Events:n(117),FilterMode:r,Frame:n(94),Parsers:n(357),Texture:n(179),TextureManager:n(354),TextureSource:n(356)};s=i(!1,s,r),t.exports=s},function(t,e){t.exports={LINEAR:0,NEAREST:1}},function(t,e,n){t.exports={Components:n(136),Parsers:n(1310),Formats:n(31),ImageCollection:n(464),ParseToTilemap:n(220),Tile:n(73),Tilemap:n(473),TilemapCreator:n(1319),TilemapFactory:n(1320),Tileset:n(140),LayerData:n(104),MapData:n(105),ObjectLayer:n(467),DynamicTilemapLayer:n(474),StaticTilemapLayer:n(475)}},function(t,e,n){var i=n(24),r=n(51);t.exports=function(t,e,n,s,o,a,u,l){t<0&&(t=0),e<0&&(e=0),void 0===u&&(u=!0);for(var c=i(t,e,n,s,null,l),h=o-t,d=a-e,f=0;f<c.length;f++){var p=c[f].x+h,m=c[f].y+d;p>=0&&p<l.width&&m>=0&&m<l.height&&l.data[m][p]&&l.data[m][p].copy(c[f])}u&&r(o-1,a-1,n+2,s+2,l)}},function(t,e,n){var i=n(138),r=n(139),s=n(24),o=n(454);t.exports=function(t,e,n,a,u,l){void 0===n&&(n={}),Array.isArray(t)||(t=[t]),void 0===a&&(a=l.tilemapLayer.scene),void 0===u&&(u=a.cameras.main);var c,h=s(0,0,l.width,l.height,null,l),d=[];for(c=0;c<h.length;c++){var f=h[c];if(-1!==t.indexOf(f.index)){n.x=i(f.x,u,l),n.y=r(f.y,u,l);var p=a.make.sprite(n);d.push(p)}}if("number"==typeof e)for(c=0;c<t.length;c++)o(t[c],e,0,0,l.width,l.height,l);else if(Array.isArray(e))for(c=0;c<t.length;c++)o(t[c],e[c],0,0,l.width,l.height,l);return d}},function(t,e,n){var i=n(93),r=n(309);t.exports=function(t,e,n,s){void 0===n&&(n=[]),void 0===s&&(s=0),n.length=0;var o,a,u,l=t.tilemapLayer.tilemap,c=t.tilemapLayer,h=t.data,d=t.width,f=t.height,p=Math.floor(l.tileWidth*c.scaleX),m=Math.floor(l.tileHeight*c.scaleY),g=0,y=d,v=0,b=f;if(!c.skipCull&&1===c.scrollFactorX&&1===c.scrollFactorY){var x=i(e.worldView.x-c.x,p,0,!0)-c.cullPaddingX,w=r(e.worldView.right-c.x,p,0,!0)+c.cullPaddingX,T=i(e.worldView.y-c.y,m,0,!0)-c.cullPaddingY,S=r(e.worldView.bottom-c.y,m,0,!0)+c.cullPaddingY;g=Math.max(0,x),y=Math.min(d,w),v=Math.max(0,T),b=Math.min(f,S)}if(0===s)for(a=v;a<b;a++)for(o=g;h[a]&&o<y;o++)(u=h[a][o])&&-1!==u.index&&u.visible&&0!==u.alpha&&n.push(u);else if(1===s)for(a=v;a<b;a++)for(o=y;h[a]&&o>=g;o--)(u=h[a][o])&&-1!==u.index&&u.visible&&0!==u.alpha&&n.push(u);else if(2===s)for(a=b;a>=v;a--)for(o=g;h[a]&&o<y;o++)(u=h[a][o])&&-1!==u.index&&u.visible&&0!==u.alpha&&n.push(u);else if(3===s)for(a=b;a>=v;a--)for(o=y;h[a]&&o>=g;o--)(u=h[a][o])&&-1!==u.index&&u.visible&&0!==u.alpha&&n.push(u);return c.tilesDrawn=n.length,c.tilesTotal=d*f,n}},function(t,e,n){var i=n(24),r=n(51),s=n(72);t.exports=function(t,e,n,o,a,u,l){for(var c=-1!==l.collideIndexes.indexOf(t),h=i(e,n,o,a,null,l),d=0;d<h.length;d++)h[d].index=t,s(h[d],c);u&&r(e-1,n-1,o+2,a+2,l)}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a,u){return i(n,r,s,o,a,u).filter(t,e)}},function(t,e){t.exports=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=!1);var r,s,o,a=0;if(n){for(s=i.height-1;s>=0;s--)for(r=i.width-1;r>=0;r--)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}}else for(s=0;s<i.height;s++)for(r=0;r<i.width;r++)if((o=i.data[s][r])&&o.index===t){if(a===e)return o;a+=1}return null}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a,u){return i(n,r,s,o,a,u).find(t,e)||null}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a,u){i(n,r,s,o,a,u).forEach(t,e)}},function(t,e,n){var i=n(137),r=n(63),s=n(64);t.exports=function(t,e,n,o,a){var u=r(t,!0,o,a),l=s(e,!0,o,a);return i(u,l,n,a)}},function(t,e,n){var i=n(406),r=n(24),s=n(407),o=n(1),a=n(138),u=n(139),l=n(63),c=n(64),h=function(t,e){return s.RectangleToTriangle(e,t)};t.exports=function(t,e,n,d){if(void 0===t)return[];var f=o;t instanceof i.Circle?f=s.CircleToRectangle:t instanceof i.Rectangle?f=s.RectangleToRectangle:t instanceof i.Triangle?f=h:t instanceof i.Line&&(f=s.LineToRectangle);var p=l(t.left,!0,n,d),m=c(t.top,!0,n,d),g=Math.ceil(l(t.right,!1,n,d)),y=Math.ceil(c(t.bottom,!1,n,d)),v=Math.max(g-p,1),b=Math.max(y-m,1),x=r(p,m,v,b,e,d),w=d.tileWidth,T=d.tileHeight;d.tilemapLayer&&(w*=d.tilemapLayer.scaleX,T*=d.tilemapLayer.scaleY);for(var S=[],E=new i.Rectangle(0,0,w,T),O=0;O<x.length;O++){var C=x[O];E.x=a(C.x,n,d),E.y=u(C.y,n,d),f(t,E)&&S.push(C)}return S}},function(t,e,n){var i=n(24),r=n(63),s=n(64);t.exports=function(t,e,n,o,a,u,l){var c=r(t,!0,u,l),h=s(e,!0,u,l),d=Math.ceil(r(t+n,!1,u,l)),f=Math.ceil(s(e+o,!1,u,l));return i(c,h,d-c,f-h,a,l)}},function(t,e,n){var i=n(455),r=n(63),s=n(64);t.exports=function(t,e,n,o){var a=r(t,!0,n,o),u=s(e,!0,n,o);return i(a,u,o)}},function(t,e,n){var i=n(215),r=n(63),s=n(64);t.exports=function(t,e,n,o,a,u){var l=r(e,!0,a,u),c=s(n,!0,a,u);return i(t,l,c,o,u)}},function(t,e,n){var i=n(51),r=n(215);t.exports=function(t,e,n,s,o){if(!Array.isArray(t))return null;void 0===s&&(s=!0),Array.isArray(t[0])||(t=[t]);for(var a=t.length,u=t[0].length,l=0;l<a;l++)for(var c=0;c<u;c++)r(t[l][c],e+c,n+l,!1,o);s&&i(e-1,n-1,u+2,a+2,o)}},function(t,e,n){var i=n(24),r=n(182);t.exports=function(t,e,n,s,o,a){var u,l=i(t,e,n,s,null,a);if(void 0===o)for(o=[],u=0;u<l.length;u++)-1===o.indexOf(l[u].index)&&o.push(l[u].index);for(u=0;u<l.length;u++)l[u].index=r(o)}},function(t,e,n){var i=n(456),r=n(63),s=n(64);t.exports=function(t,e,n,o,a,u){var l=r(t,!0,a,u),c=s(e,!0,a,u);return i(l,c,n,o,u)}},function(t,e,n){var i=n(24),r=n(332),s=new r(105,210,231,150),o=new r(243,134,48,200),a=new r(40,39,37,150);t.exports=function(t,e,n){void 0===e&&(e={});var r=void 0!==e.tileColor?e.tileColor:s,u=void 0!==e.collidingTileColor?e.collidingTileColor:o,l=void 0!==e.faceColor?e.faceColor:a,c=i(0,0,n.width,n.height,null,n);t.translateCanvas(n.tilemapLayer.x,n.tilemapLayer.y),t.scaleCanvas(n.tilemapLayer.scaleX,n.tilemapLayer.scaleY);for(var h=0;h<c.length;h++){var d=c[h],f=d.width,p=d.height,m=d.pixelX,g=d.pixelY,y=d.collides?u:r;null!==y&&(t.fillStyle(y.color,y.alpha/255),t.fillRect(m,g,f,p)),m+=1,g+=1,f-=2,p-=2,null!==l&&(t.lineStyle(1,l.color,l.alpha/255),d.faceTop&&t.lineBetween(m,g,m+f,g),d.faceRight&&t.lineBetween(m+f,g,m+f,g+p),d.faceBottom&&t.lineBetween(m,g+p,m+f,g+p),d.faceLeft&&t.lineBetween(m,g,m,g+p))}}},function(t,e,n){var i=n(72),r=n(51),s=n(216);t.exports=function(t,e,n,o,a){void 0===e&&(e=!0),void 0===n&&(n=!0),Array.isArray(t)||(t=[t]),void 0===a&&(a=!0);for(var u=0;u<t.length;u++)s(t[u],e,o);if(a)for(var l=0;l<o.height;l++)for(var c=0;c<o.width;c++){var h=o.data[l][c];h&&-1!==t.indexOf(h.index)&&i(h,e)}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(72),r=n(51),s=n(216);t.exports=function(t,e,n,o,a,u){if(void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===u&&(u=!0),!(t>e)){for(var l=t;l<=e;l++)s(l,n,a);if(u)for(var c=0;c<a.height;c++)for(var h=0;h<a.width;h++){var d=a.data[c][h];d&&d.index>=t&&d.index<=e&&i(d,n)}o&&r(0,0,a.width,a.height,a)}}},function(t,e,n){var i=n(72),r=n(51),s=n(216);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0),Array.isArray(t)||(t=[t]);for(var a=0;a<o.height;a++)for(var u=0;u<o.width;u++){var l=o.data[a][u];l&&-1===t.indexOf(l.index)&&(i(l,e),s(l.index,e,o))}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(72),r=n(51),s=n(99);t.exports=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!0);for(var a=0;a<o.height;a++)for(var u=0;u<o.width;u++){var l=o.data[a][u];if(l)for(var c in t)if(s(l.properties,c)){var h=t[c];Array.isArray(h)||(h=[h]);for(var d=0;d<h.length;d++)l.properties[c]===h[d]&&i(l,e)}}n&&r(0,0,o.width,o.height,o)}},function(t,e,n){var i=n(72),r=n(51);t.exports=function(t,e,n){void 0===t&&(t=!0),void 0===e&&(e=!0);for(var s=0;s<n.height;s++)for(var o=0;o<n.width;o++){var a=n.data[s][o];if(a){var u=a.getCollisionGroup();u&&u.objects&&u.objects.length>0&&i(a,t)}}e&&r(0,0,n.width,n.height,n)}},function(t,e){t.exports=function(t,e,n,i){if("number"==typeof t)i.callbacks[t]=null!==e?{callback:e,callbackContext:n}:void 0;else for(var r=0,s=t.length;r<s;r++)i.callbacks[t[r]]=null!==e?{callback:e,callbackContext:n}:void 0}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a){for(var u=i(t,e,n,r,null,a),l=0;l<u.length;l++)u[l].setCollisionCallback(s,o)}},function(t,e,n){var i=n(24),r=n(112);t.exports=function(t,e,n,s,o){var a=i(t,e,n,s,null,o),u=a.map(function(t){return t.index});r(u);for(var l=0;l<a.length;l++)a[l].index=u[l]}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o,a){for(var u=i(n,r,s,o,null,a),l=0;l<u.length;l++)u[l]&&(u[l].index===t?u[l].index=e:u[l].index===e&&(u[l].index=t))}},function(t,e,n){var i=n(138),r=n(139),s=n(3);t.exports=function(t,e,n,o,a){return void 0===n&&(n=new s(0,0)),n.x=i(t,o,a),n.y=r(e,o,a),n}},function(t,e,n){var i=n(24);t.exports=function(t,e,n,r,s,o){if(void 0!==s){var a,u=i(t,e,n,r,null,o),l=0;for(a=0;a<s.length;a++)l+=s[a].weight;if(!(l<=0))for(a=0;a<u.length;a++){for(var c=Math.random()*l,h=0,d=-1,f=0;f<s.length;f++)if(c<=(h+=s[f].weight)){var p=s[f].index;d=Array.isArray(p)?p[Math.floor(Math.random()*p.length)]:p;break}u[a].index=d}}}},function(t,e,n){var i=n(63),r=n(64),s=n(3);t.exports=function(t,e,n,o,a,u){return void 0===o&&(o=new s(0,0)),o.x=i(t,n,a,u),o.y=r(e,n,a,u),o}},function(t,e,n){t.exports={Parse:n(457),Parse2DArray:n(217),ParseCSV:n(458),Impact:n(1311),Tiled:n(1312)}},function(t,e,n){t.exports={ParseTileLayers:n(471),ParseTilesets:n(472),ParseWeltmeister:n(470)}},function(t,e,n){t.exports={AssignTileProperties:n(469),Base64Decode:n(461),BuildTilesetIndex:n(468),ParseGID:n(218),ParseImageLayers:n(462),ParseJSONTiled:n(459),ParseObject:n(219),ParseObjectLayers:n(466),ParseTileLayers:n(460),ParseTilesets:n(463)}},function(t,e,n){var i=n(1),r=n(1);i=n(1314),r=n(1315),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e,n){var i=n(10);t.exports=function(t,e,n,r){e.cull(r);var s=e.culledTiles,o=s.length,a=r.alpha*e.alpha;if(!(0===o||a<=0))for(var u=e.gidMap,l=e.pipeline,c=i.getTintAppendFloatAlpha,h=e.scrollFactorX,d=e.scrollFactorY,f=e.x,p=e.y,m=e.scaleX,g=e.scaleY,y=e.tileset,v=0;v<y.length;v++)for(var b=y[v],x=b.glTexture,w=0;w<o;w++){var T=s[w],S=u[T.index];if(S===b){var E=S.getTileTextureCoordinates(T.index);if(null!==E){var O=T.width,C=T.height,_=E.x,A=E.y,k=.5*T.width,R=.5*T.height,I=c(T.tint,a*T.alpha);l.batchTexture(e,x,x.width,x.height,f+(k+T.pixelX)*m,p+(R+T.pixelY)*g,T.width,T.height,m,g,T.rotation,T.flipX,T.flipY,h,d,k,R,_,A,O,C,I,I,I,I,!1,0,0,r,null,!0)}}}}},function(t,e){t.exports=function(t,e,n,i,r){e.cull(i);var s=e.culledTiles,o=s.length;if(0!==o){var a=t._tempMatrix1,u=t._tempMatrix2,l=t._tempMatrix3;u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(i.matrix);var c=t.currentContext,h=e.gidMap;c.save(),r?(a.multiplyWithOffset(r,-i.scrollX*e.scrollFactorX,-i.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y,a.multiply(u,l),l.copyToContext(c)):(u.e-=i.scrollX*e.scrollFactorX,u.f-=i.scrollY*e.scrollFactorY,u.copyToContext(c));var d=i.alpha*e.alpha;(!t.antialias||e.scaleX>1||e.scaleY>1)&&(c.imageSmoothingEnabled=!1);for(var f=0;f<o;f++){var p=s[f],m=h[p.index];if(m){var g=m.image.getSourceImage(),y=m.getTileTextureCoordinates(p.index);if(y){var v=p.width/2,b=p.height/2;c.save(),c.translate(p.pixelX+v,p.pixelY+b),0!==p.rotation&&c.rotate(p.rotation),(p.flipX||p.flipY)&&c.scale(p.flipX?-1:1,p.flipY?-1:1),c.globalAlpha=d*p.alpha,c.drawImage(g,y.x,y.y,p.width,p.height,-v,-b,p.width,p.height),c.restore()}}}c.restore()}}},function(t,e,n){var i=n(1),r=n(1);i=n(1317),r=n(1318),t.exports={renderWebGL:i,renderCanvas:r}},function(t,e){t.exports=function(t,e,n,i){var r=e.tileset,s=e.pipeline,o=s.vertexBuffer;t.setPipeline(s),s.modelIdentity(),s.modelTranslate(e.x-i.scrollX*e.scrollFactorX,e.y-i.scrollY*e.scrollFactorY,0),s.modelScale(e.scaleX,e.scaleY,1),s.viewLoad2D(i.matrix.matrix);for(var a=0;a<r.length;a++)e.upload(i,a),e.vertexCount[a]>0&&(t.currentPipeline&&t.currentPipeline.vertexCount>0&&t.flush(),s.vertexBuffer=e.vertexBuffer[a],t.setPipeline(s),t.setTexture2D(r[a].glTexture,0),t.gl.drawArrays(s.topology,0,e.vertexCount[a]));s.vertexBuffer=o,s.viewIdentity(),s.modelIdentity()}},function(t,e){t.exports=function(t,e,n,i,r){e.cull(i);var s=e.culledTiles,o=s.length;if(0!==o){var a=t._tempMatrix1,u=t._tempMatrix2,l=t._tempMatrix3;u.applyITRS(e.x,e.y,e.rotation,e.scaleX,e.scaleY),a.copyFrom(i.matrix);var c=t.currentContext,h=e.gidMap;c.save(),r?(a.multiplyWithOffset(r,-i.scrollX*e.scrollFactorX,-i.scrollY*e.scrollFactorY),u.e=e.x,u.f=e.y,a.multiply(u,l),l.copyToContext(c)):(u.e-=i.scrollX*e.scrollFactorX,u.f-=i.scrollY*e.scrollFactorY,u.copyToContext(c));var d=i.alpha*e.alpha;(!t.antialias||e.scaleX>1||e.scaleY>1)&&(c.imageSmoothingEnabled=!1);for(var f=0;f<o;f++){var p=s[f],m=h[p.index];if(m){var g=m.image.getSourceImage(),y=m.getTileTextureCoordinates(p.index);if(y){var v=m.tileWidth,b=m.tileHeight,x=v/2,w=b/2;c.save(),c.translate(p.pixelX+x,p.pixelY+w),0!==p.rotation&&c.rotate(p.rotation),(p.flipX||p.flipY)&&c.scale(p.flipX?-1:1,p.flipY?-1:1),c.globalAlpha=d*p.alpha,c.drawImage(g,y.x,y.y,v,b,-x,-w,v,b),c.restore()}}}c.restore()}}},function(t,e,n){var i=n(15),r=n(220);i.register("tilemap",function(t){var e=void 0!==t?t:{};return r(this.scene,e.key,e.tileWidth,e.tileHeight,e.width,e.height,e.data,e.insertNull)})},function(t,e,n){var i=n(5),r=n(220);i.register("tilemap",function(t,e,n,i,s,o,a){return null===t&&(t=void 0),null===e&&(e=void 0),null===n&&(n=void 0),null===i&&(i=void 0),null===s&&(s=void 0),r(this.scene,t,e,n,i,s,o,a)})},function(t,e,n){t.exports={Clock:n(1322),TimerEvent:n(476)}},function(t,e,n){var i=n(0),r=n(20),s=n(21),o=n(476),a=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.now=0,this.timeScale=1,this.paused=!1,this._active=[],this._pendingInsertion=[],this._pendingRemoval=[],t.sys.events.once(s.BOOT,this.boot,this),t.sys.events.on(s.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time,this.systems.events.once(s.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(s.PRE_UPDATE,this.preUpdate,this),t.on(s.UPDATE,this.update,this),t.once(s.SHUTDOWN,this.shutdown,this)},addEvent:function(t){var e=new o(t);return this._pendingInsertion.push(e),e},delayedCall:function(t,e,n,i){return this.addEvent({delay:t,callback:e,args:n,callbackScope:i})},clearPendingEvents:function(){return this._pendingInsertion=[],this},removeAllEvents:function(){return this._pendingRemoval=this._pendingRemoval.concat(this._active),this},preUpdate:function(){var t=this._pendingRemoval.length,e=this._pendingInsertion.length;if(0!==t||0!==e){var n,i;for(n=0;n<t;n++){var r=this._active.indexOf(i=this._pendingRemoval[n]);r>-1&&this._active.splice(r,1),i.destroy()}for(n=0;n<e;n++)this._active.push(i=this._pendingInsertion[n]);this._pendingRemoval.length=0,this._pendingInsertion.length=0}},update:function(t,e){if(this.now=t,!this.paused){e*=this.timeScale;for(var n=0;n<this._active.length;n++){var i=this._active[n];if(!i.paused&&(i.elapsed+=e*i.timeScale,i.elapsed>=i.delay)){var r=i.elapsed-i.delay;i.elapsed=i.delay,!i.hasDispatched&&i.callback&&(i.hasDispatched=!0,i.callback.apply(i.callbackScope,i.args)),i.repeatCount>0?(i.repeatCount--,i.elapsed=r,i.hasDispatched=!1):this._pendingRemoval.push(i)}}}},shutdown:function(){var t;for(t=0;t<this._pendingInsertion.length;t++)this._pendingInsertion[t].destroy();for(t=0;t<this._active.length;t++)this._active[t].destroy();for(t=0;t<this._pendingRemoval.length;t++)this._pendingRemoval[t].destroy();this._active.length=0,this._pendingRemoval.length=0,this._pendingInsertion.length=0;var e=this.systems.events;e.off(s.PRE_UPDATE,this.preUpdate,this),e.off(s.UPDATE,this.update,this),e.off(s.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(s.START,this.start,this),this.scene=null,this.systems=null}});r.register("Clock",a,"time"),t.exports=a},function(t,e,n){var i=n(89),r=n(16),s={Builders:n(1324),Events:n(225),TweenManager:n(1339),Tween:n(224),TweenData:n(226),Timeline:n(481)};s=r(!1,s,i),t.exports=s},function(t,e,n){t.exports={GetBoolean:n(88),GetEaseFunction:n(82),GetNewValue:n(141),GetProps:n(477),GetTargets:n(221),GetTweens:n(478),GetValueOp:n(222),NumberTweenBuilder:n(479),TimelineBuilder:n(480),TweenBuilder:n(142)}},function(t,e){t.exports=["callbackScope","completeDelay","delay","duration","ease","easeParams","flipX","flipY","hold","loop","loopDelay","offset","onActive","onActiveParams","onActiveScope","onComplete","onCompleteParams","onCompleteScope","onLoop","onLoopParams","onLoopScope","onRepeat","onRepeatParams","onRepeatScope","onStart","onStartParams","onStartScope","onUpdate","onUpdateParams","onUpdateScope","onYoyo","onYoyoParams","onYoyoScope","paused","props","repeat","repeatDelay","targets","useFrames","yoyo"]},function(t,e){t.exports="complete"},function(t,e){t.exports="loop"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="start"},function(t,e){t.exports="update"},function(t,e){t.exports="active"},function(t,e){t.exports="complete"},function(t,e){t.exports="loop"},function(t,e){t.exports="repeat"},function(t,e){t.exports="start"},function(t,e){t.exports="update"},function(t,e){t.exports="yoyo"},function(t,e,n){var i=n(119),r=n(0),s=n(479),o=n(20),a=n(21),u=n(1340),l=n(480),c=n(89),h=n(142),d=new r({initialize:function(t){this.scene=t,this.systems=t.sys,this.timeScale=1,this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0,t.sys.events.once(a.BOOT,this.boot,this),t.sys.events.on(a.START,this.start,this)},boot:function(){this.systems.events.once(a.DESTROY,this.destroy,this)},start:function(){var t=this.systems.events;t.on(a.PRE_UPDATE,this.preUpdate,this),t.on(a.UPDATE,this.update,this),t.once(a.SHUTDOWN,this.shutdown,this),this.timeScale=1},createTimeline:function(t){return l(this,t)},timeline:function(t){var e=l(this,t);return e.paused||(this._add.push(e),this._toProcess++),e},create:function(t){return h(this,t)},add:function(t){var e=h(this,t);return this._add.push(e),this._toProcess++,e},existing:function(t){return this._add.push(t),this._toProcess++,this},addCounter:function(t){var e=s(this,t);return this._add.push(e),this._toProcess++,e},stagger:function(t,e){return u(t,e)},preUpdate:function(){if(0!==this._toProcess){var t,e,n=this._destroy,i=this._active,r=this._pending;for(t=0;t<n.length;t++){var s=i.indexOf(e=n[t]);-1===s?(s=r.indexOf(e))>-1&&(e.state=c.REMOVED,r.splice(s,1)):(e.state=c.REMOVED,i.splice(s,1))}for(n.length=0,n=this._add,t=0;t<n.length;t++)(e=n[t]).state===c.PENDING_ADD&&(e.init()?(e.play(),this._active.push(e)):this._pending.push(e));n.length=0,this._toProcess=0}},update:function(t,e){var n,i=this._active;e*=this.timeScale;for(var r=0;r<i.length;r++)(n=i[r]).update(t,e)&&(this._destroy.push(n),this._toProcess++)},remove:function(t){return i(this._add,t),i(this._pending,t),i(this._active,t),i(this._destroy,t),t.state=c.REMOVED,this},makeActive:function(t){if(-1!==this._add.indexOf(t)||-1!==this._active.indexOf(t))return this;var e=this._pending.indexOf(t);return-1!==e&&this._pending.splice(e,1),this._add.push(t),t.state=c.PENDING_ADD,this._toProcess++,this},each:function(t,e){for(var n=[null],i=1;i<arguments.length;i++)n.push(arguments[i]);for(var r in this.list)n[0]=this.list[r],t.apply(e,n)},getAllTweens:function(){for(var t=this._active,e=[],n=0;n<t.length;n++)e.push(t[n]);return e},getGlobalTimeScale:function(){return this.timeScale},getTweensOf:function(t){var e,n,i=this._active,r=[];if(Array.isArray(t))for(n=0;n<i.length;n++){e=i[n];for(var s=0;s<t.length;s++)e.hasTarget(t[s])&&r.push(e)}else for(n=0;n<i.length;n++)(e=i[n]).hasTarget(t)&&r.push(e);return r},isTweening:function(t){for(var e,n=this._active,i=0;i<n.length;i++)if((e=n[i]).hasTarget(t)&&e.isPlaying())return!0;return!1},killAll:function(){for(var t=this.getAllTweens(),e=0;e<t.length;e++)t[e].stop();return this},killTweensOf:function(t){for(var e=this.getTweensOf(t),n=0;n<e.length;n++)e[n].stop();return this},pauseAll:function(){for(var t=this._active,e=0;e<t.length;e++)t[e].pause();return this},resumeAll:function(){for(var t=this._active,e=0;e<t.length;e++)t[e].resume();return this},setGlobalTimeScale:function(t){return this.timeScale=t,this},shutdown:function(){this.killAll(),this._add=[],this._pending=[],this._active=[],this._destroy=[],this._toProcess=0;var t=this.systems.events;t.off(a.PRE_UPDATE,this.preUpdate,this),t.off(a.UPDATE,this.update,this),t.off(a.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown(),this.scene.sys.events.off(a.START,this.start,this),this.scene=null,this.systems=null}});o.register("TweenManager",d,"tweens"),t.exports=d},function(t,e,n){var i=n(82),r=n(6);t.exports=function(t,e){void 0===e&&(e={});var n=r(e,"start",0),s=r(e,"ease",null),o=r(e,"grid",null),a=r(e,"from",0),u="first"===a,l="center"===a,c="last"===a,h="number"==typeof a,d=Array.isArray(t),f=d?parseFloat(t[0]):parseFloat(t),p=d?parseFloat(t[1]):0,m=Math.max(f,p);if(d&&(n+=f),o){var g=o[0],y=o[1],v=0,b=0,x=0,w=0,T=[];c?(v=g-1,b=y-1):h?(v=a%g,b=Math.floor(a/g)):l&&(v=(g-1)/2,b=(y-1)/2);for(var S=Number.MIN_SAFE_INTEGER,E=0;E<y;E++){T[E]=[];for(var O=0;O<g;O++){x=v-O,w=b-E;var C=Math.sqrt(x*x+w*w);C>S&&(S=C),T[E][O]=C}}}var _=s?i(s):null;return o?function(t,e,i,r){var s,o=0,a=r%g,u=Math.floor(r/g);if(a>=0&&a<g&&u>=0&&u<y&&(o=T[u][a]),d){var l=p-f;s=_?o/S*l*_(o/S):o/S*l}else s=_?o*f*_(o/S):o*f;return s+n}:function(t,e,i,r,s){var o,g,y;return s--,u?o=r:l?o=Math.abs(s/2-r):c?o=s-r:h&&(o=Math.abs(a-r)),d?(y=l?(p-f)/s*(2*o):(p-f)/s*o,g=_?y*_(o/s):y):g=_?s*m*_(o/s):o*f,g+n}}},function(t,e,n){t.exports={Array:n(180),Base64:n(1342),Objects:n(1344),String:n(1348)}},function(t,e,n){t.exports={ArrayBufferToBase64:n(1343),Base64ToArrayBuffer:n(364)}},function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports=function(t,e){for(var i=new Uint8Array(t),r=i.length,s=e?"data:"+e+";base64,":"",o=0;o<r;o+=3)s+=n[i[o]>>2],s+=n[(3&i[o])<<4|i[o+1]>>4],s+=n[(15&i[o+1])<<2|i[o+2]>>6],s+=n[63&i[o+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s}},function(t,e,n){t.exports={Clone:n(66),Extend:n(16),GetAdvancedValue:n(14),GetFastValue:n(2),GetMinMaxValue:n(1345),GetValue:n(6),HasAll:n(1346),HasAny:n(383),HasValue:n(99),IsPlainObject:n(7),Merge:n(106),MergeRight:n(1347),Pick:n(465),SetValue:n(403)}},function(t,e,n){var i=n(6),r=n(22);t.exports=function(t,e,n,s,o){void 0===o&&(o=n);var a=i(t,e,o);return r(a,n,s)}},function(t,e){t.exports=function(t,e){for(var n=0;n<e.length;n++)if(!t.hasOwnProperty(e[n]))return!1;return!0}},function(t,e,n){var i=n(66);t.exports=function(t,e){var n=i(t);for(var r in e)n.hasOwnProperty(r)&&(n[r]=e[r]);return n}},function(t,e,n){t.exports={Format:n(1349),Pad:n(158),Reverse:n(1350),UppercaseFirst:n(178),UUID:n(193)}},function(t,e){t.exports=function(t,e){return t.replace(/%([0-9]+)/g,function(t,n){return e[Number(n)-1]})}},function(t,e){t.exports=function(t){return t.split("").reverse().join("")}},function(t,e,n){t.exports={SoundManagerCreator:n(358),Events:n(59),BaseSound:n(123),BaseSoundManager:n(122),WebAudioSound:n(365),WebAudioSoundManager:n(363),HTML5AudioSound:n(360),HTML5AudioSoundManager:n(359),NoAudioSound:n(362),NoAudioSoundManager:n(361)}},function(t,e,n){var i=n(0),r=n(450),s=n(1374),o=n(451),a=n(1375),u=new i({initialize:function(t,e,n,i,s){void 0===i&&(i=16),void 0===s&&(s=i),this.world=t,this.gameObject=null,this.enabled=!0,this.id=t.getNextID(),this.name="",this.size={x:i,y:s},this.offset={x:0,y:0},this.pos={x:e,y:n},this.last={x:e,y:n},this.vel={x:0,y:0},this.accel={x:0,y:0},this.friction={x:0,y:0},this.maxVel={x:t.defaults.maxVelocityX,y:t.defaults.maxVelocityY},this.standing=!1,this.gravityFactor=t.defaults.gravityFactor,this.bounciness=t.defaults.bounciness,this.minBounceVelocity=t.defaults.minBounceVelocity,this.accelGround=0,this.accelAir=0,this.jumpSpeed=0,this.type=o.NONE,this.checkAgainst=o.NONE,this.collides=r.NEVER,this.debugShowBody=t.defaults.debugShowBody,this.debugShowVelocity=t.defaults.debugShowVelocity,this.debugBodyColor=t.defaults.bodyDebugColor,this.slopeStanding={min:.767944870877505,max:2.3736477827122884}},reset:function(t,e){this.pos={x:t,y:e},this.last={x:t,y:e},this.vel={x:0,y:0},this.accel={x:0,y:0},this.friction={x:0,y:0},this.maxVel={x:100,y:100},this.standing=!1,this.gravityFactor=1,this.bounciness=0,this.minBounceVelocity=40,this.accelGround=0,this.accelAir=0,this.jumpSpeed=0,this.type=o.NONE,this.checkAgainst=o.NONE,this.collides=r.NEVER},update:function(t){var e=this.pos;this.last.x=e.x,this.last.y=e.y,this.vel.y+=this.world.gravity*t*this.gravityFactor,this.vel.x=s(t,this.vel.x,this.accel.x,this.friction.x,this.maxVel.x),this.vel.y=s(t,this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var n=this.world.collisionMap.trace(e.x,e.y,this.vel.x*t,this.vel.y*t,this.size.x,this.size.y);this.handleMovementTrace(n)&&a(this,n);var i=this.gameObject;i&&(i.x=e.x-this.offset.x+i.displayOriginX*i.scaleX,i.y=e.y-this.offset.y+i.displayOriginY*i.scaleY),this.updateCallback&&this.updateCallback(this)},drawDebug:function(t){var e=this.pos;if(this.debugShowBody&&(t.lineStyle(1,this.debugBodyColor,1),t.strokeRect(e.x,e.y,this.size.x,this.size.y)),this.debugShowVelocity){var n=e.x+this.size.x/2,i=e.y+this.size.y/2;t.lineStyle(1,this.world.defaults.velocityDebugColor,1),t.lineBetween(n,i,n+this.vel.x,i+this.vel.y)}},willDrawDebug:function(){return this.debugShowBody||this.debugShowVelocity},skipHash:function(){return!this.enabled||0===this.type&&0===this.checkAgainst&&0===this.collides},touches:function(t){return!(this.pos.x>=t.pos.x+t.size.x||this.pos.x+this.size.x<=t.pos.x||this.pos.y>=t.pos.y+t.size.y||this.pos.y+this.size.y<=t.pos.y)},resetSize:function(t,e,n,i){return this.pos.x=t,this.pos.y=e,this.size.x=n,this.size.y=i,this},toJSON:function(){return{name:this.name,size:{x:this.size.x,y:this.size.y},pos:{x:this.pos.x,y:this.pos.y},vel:{x:this.vel.x,y:this.vel.y},accel:{x:this.accel.x,y:this.accel.y},friction:{x:this.friction.x,y:this.friction.y},maxVel:{x:this.maxVel.x,y:this.maxVel.y},gravityFactor:this.gravityFactor,bounciness:this.bounciness,minBounceVelocity:this.minBounceVelocity,type:this.type,checkAgainst:this.checkAgainst,collides:this.collides}},fromJSON:function(){},check:function(){},collideWith:function(t,e){this.parent&&this.parent._collideCallback&&this.parent._collideCallback.call(this.parent._callbackScope,this,t,e)},handleMovementTrace:function(){return!0},destroy:function(){this.world.remove(this),this.enabled=!1,this.world=null,this.gameObject=null,this.parent=null}});t.exports=u},function(t,e,n){var i=n(0),r=n(1379),s=new i({initialize:function(t,e){void 0===t&&(t=32),this.tilesize=t,this.data=Array.isArray(e)?e:[],this.width=Array.isArray(e)?e[0].length:0,this.height=Array.isArray(e)?e.length:0,this.lastSlope=55,this.tiledef=r},trace:function(t,e,n,i,r,s){var o={collision:{x:!1,y:!1,slope:!1},pos:{x:t+n,y:e+i},tile:{x:0,y:0}};if(!this.data)return o;var a=Math.ceil(Math.max(Math.abs(n),Math.abs(i))/this.tilesize);if(a>1)for(var u=n/a,l=i/a,c=0;c<a&&(u||l)&&(this.step(o,t,e,u,l,r,s,n,i,c),t=o.pos.x,e=o.pos.y,o.collision.x&&(u=0,n=0),o.collision.y&&(l=0,i=0),!o.collision.slope);c++);else this.step(o,t,e,n,i,r,s,n,i,0);return o},step:function(t,e,n,i,r,s,o,a,u,l){var c,h,d=0,f=this.tilesize,p=this.width,m=this.height;if(i){var g=i>0?s:0,y=i<0?f:0,v=Math.max(Math.floor(n/f),0),b=Math.min(Math.ceil((n+o)/f),m);c=Math.floor((t.pos.x+g)/f);var x=Math.floor((e+g)/f);if((l>0||c===x||x<0||x>=p)&&(x=-1),c>=0&&c<p)for(h=v;h<b&&!(-1!==x&&(d=this.data[h][x])>1&&d<=this.lastSlope&&this.checkDef(t,d,e,n,a,u,s,o,x,h));h++)if(1===(d=this.data[h][c])||d>this.lastSlope||d>1&&this.checkDef(t,d,e,n,a,u,s,o,c,h)){if(d>1&&d<=this.lastSlope&&t.collision.slope)break;t.collision.x=!0,t.tile.x=d,t.pos.x=c*f-g+y,e=t.pos.x,a=0;break}}if(r){var w=r>0?o:0,T=r<0?f:0,S=Math.max(Math.floor(t.pos.x/f),0),E=Math.min(Math.ceil((t.pos.x+s)/f),p);h=Math.floor((t.pos.y+w)/f);var O=Math.floor((n+w)/f);if((l>0||h===O||O<0||O>=m)&&(O=-1),h>=0&&h<m)for(c=S;c<E&&!(-1!==O&&(d=this.data[O][c])>1&&d<=this.lastSlope&&this.checkDef(t,d,e,n,a,u,s,o,c,O));c++)if(1===(d=this.data[h][c])||d>this.lastSlope||d>1&&this.checkDef(t,d,e,n,a,u,s,o,c,h)){if(d>1&&d<=this.lastSlope&&t.collision.slope)break;t.collision.y=!0,t.tile.y=d,t.pos.y=h*f-w+T;break}}},checkDef:function(t,e,n,i,r,s,o,a,u,l){var c=this.tiledef[e];if(!c)return!1;var h=this.tilesize,d=(c[2]-c[0])*h,f=(c[3]-c[1])*h,p=c[4],m=n+r+(f<0?o:0)-(u+c[0])*h,g=i+s+(d>0?a:0)-(l+c[1])*h;if(d*g-f*m>0){if(r*-f+s*d<0)return p;var y=Math.sqrt(d*d+f*f),v=f/y,b=-d/y,x=m*v+g*b,w=v*x,T=b*x;return w*w+T*T>=r*r+s*s?p||d*(g-s)-f*(m-r)<.5:(t.pos.x=n+r-w,t.pos.y=i+s-T,t.collision.slope={x:d,y:f,nx:v,ny:b},!0)}return!1}});t.exports=s},function(t,e,n){var i=n(0),r=n(1355),s=n(1356),o=n(1357),a=new i({initialize:function(t){this.world=t,this.sys=t.scene.sys},body:function(t,e,n,i){return new r(this.world,t,e,n,i)},existing:function(t){return t.body=this.world.create(t.x-t.frame.centerX,t.y-t.frame.centerY,t.width,t.height),t.body.parent=t,t.body.gameObject=t,t},image:function(t,e,n,i){var r=new s(this.world,t,e,n,i);return this.sys.displayList.add(r),r},sprite:function(t,e,n,i){var r=new o(this.world,t,e,n,i);return this.sys.displayList.add(r),this.sys.updateList.add(r),r},destroy:function(){this.world=null,this.sys=null}});t.exports=a},function(t,e,n){var i=n(0),r=n(1263),s=new i({Mixins:[r.Acceleration,r.BodyScale,r.BodyType,r.Bounce,r.CheckAgainst,r.Collides,r.Debug,r.Friction,r.Gravity,r.Offset,r.SetGameObject,r.Velocity],initialize:function(t,e,n,i,r){this.body=t.create(e,n,i,r),this.body.parent=this,this.size=this.body.size,this.offset=this.body.offset,this.vel=this.body.vel,this.accel=this.body.accel,this.friction=this.body.friction,this.maxVel=this.body.maxVel}});t.exports=s},function(t,e,n){var i=n(0),r=n(1263),s=n(98),o=new i({Extends:s,Mixins:[r.Acceleration,r.BodyScale,r.BodyType,r.Bounce,r.CheckAgainst,r.Collides,r.Debug,r.Friction,r.Gravity,r.Offset,r.SetGameObject,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t.scene,e,n,i,r),this.body=t.create(e-this.frame.centerX,n-this.frame.centerY,this.width,this.height),this.body.parent=this,this.body.gameObject=this,this.size=this.body.size,this.offset=this.body.offset,this.vel=this.body.vel,this.accel=this.body.accel,this.friction=this.body.friction,this.maxVel=this.body.maxVel}});t.exports=o},function(t,e,n){var i=n(0),r=n(1263),s=n(68),o=new i({Extends:s,Mixins:[r.Acceleration,r.BodyScale,r.BodyType,r.Bounce,r.CheckAgainst,r.Collides,r.Debug,r.Friction,r.Gravity,r.Offset,r.SetGameObject,r.Velocity],initialize:function(t,e,n,i,r){s.call(this,t.scene,e,n,i,r),this.body=t.create(e-this.frame.centerX,n-this.frame.centerY,this.width,this.height),this.body.parent=this,this.body.gameObject=this,this.size=this.body.size,this.offset=this.body.offset,this.vel=this.body.vel,this.accel=this.body.accel,this.friction=this.body.friction,this.maxVel=this.body.maxVel}});t.exports=o},function(t,e,n){var i=n(1352),r=n(0),s=n(450),o=n(1353),a=n(9),u=n(1262),l=n(2),c=n(99),h=n(107),d=n(1393),f=n(31),p=n(451),m=new r({Extends:a,initialize:function(t,e){a.call(this),this.scene=t,this.bodies=new h,this.gravity=l(e,"gravity",0),this.cellSize=l(e,"cellSize",64),this.collisionMap=new o,this.timeScale=l(e,"timeScale",1),this.maxStep=l(e,"maxStep",.05),this.enabled=!0,this.drawDebug=l(e,"debug",!1);var n=l(e,"maxVelocity",100);if(this.defaults={debugShowBody:l(e,"debugShowBody",!0),debugShowVelocity:l(e,"debugShowVelocity",!0),bodyDebugColor:l(e,"debugBodyColor",16711935),velocityDebugColor:l(e,"debugVelocityColor",65280),maxVelocityX:l(e,"maxVelocityX",n),maxVelocityY:l(e,"maxVelocityY",n),minBounceVelocity:l(e,"minBounceVelocity",40),gravityFactor:l(e,"gravityFactor",1),bounciness:l(e,"bounciness",0)},this.walls={left:null,right:null,top:null,bottom:null},this.delta=0,this._lastId=0,l(e,"setBounds",!1)){var i=e.setBounds;if("boolean"==typeof i)this.setBounds();else{var r=l(i,"x",0),s=l(i,"y",0),u=l(i,"width",t.sys.scale.width),c=l(i,"height",t.sys.scale.height),d=l(i,"thickness",64),f=l(i,"left",!0),p=l(i,"right",!0),m=l(i,"top",!0),g=l(i,"bottom",!0);this.setBounds(r,s,u,c,d,f,p,m,g)}}this.drawDebug&&this.createDebugGraphic()},setCollisionMap:function(t,e){if("string"==typeof t){var n=this.scene.cache.tilemap.get(t);if(!n||n.format!==f.WELTMEISTER)return console.warn("The specified key does not correspond to a Weltmeister tilemap: "+t),null;for(var i,r=n.data.layer,s=0;s<r.length;s++)if("collision"===r[s].name){i=r[s];break}void 0===e&&(e=i.tilesize),this.collisionMap=new o(e,i.data)}else Array.isArray(t)?this.collisionMap=new o(e,t):console.warn("Invalid Weltmeister collision map data: "+t);return this.collisionMap},setCollisionMapFromTilemapLayer:function(t,e){void 0===e&&(e={});for(var n=l(e,"slopeProperty",null),i=l(e,"slopeMap",null),r=l(e,"defaultCollidingSlope",null),s=l(e,"defaultNonCollidingSlope",0),a=t.layer,u=a.baseTileWidth,h=[],d=0;d<a.height;d++){h[d]=[];for(var f=0;f<a.width;f++){var p=a.data[d][f];h[d][f]=p&&p.collides?null!==n&&c(p.properties,n)?parseInt(p.properties[n],10):null!==i&&c(i,p.index)?i[p.index]:null!==r?r:p.index:s}}return this.collisionMap=new o(u,h),this.collisionMap},setBounds:function(t,e,n,i,r,s,o,a,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),void 0===r&&(r=64),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=!0),void 0===u&&(u=!0),this.updateWall(s,"left",t-r,e,r,i),this.updateWall(o,"right",t+n,e,r,i),this.updateWall(a,"top",t,e-r,n,r),this.updateWall(u,"bottom",t,e+i,n,r),this},updateWall:function(t,e,n,i,r,o){var a=this.walls[e];t?a?a.resetSize(n,i,r,o):(this.walls[e]=this.create(n,i,r,o),this.walls[e].name=e,this.walls[e].gravityFactor=0,this.walls[e].collides=s.FIXED):(a&&this.bodies.remove(a),this.walls[e]=null)},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},getNextID:function(){return this._lastId++},create:function(t,e,n,r){var s=new i(this,t,e,n,r);return this.bodies.set(s),s},remove:function(t){this.bodies.delete(t)},pause:function(){return this.enabled=!1,this.emit(u.PAUSE),this},resume:function(){return this.enabled=!0,this.emit(u.RESUME),this},update:function(t,e){if(this.enabled&&0!==this.bodies.size){var n,i,r=Math.min(e/1e3,this.maxStep)*this.timeScale;this.delta=r;var s=this.bodies.entries,o=s.length,a={},u=this.cellSize;for(n=0;n<o;n++)(i=s[n]).enabled&&i.update(r);for(n=0;n<o;n++)(i=s[n])&&!i.skipHash()&&this.checkHash(i,a,u);if(this.drawDebug){var l=this.debugGraphic;for(l.clear(),n=0;n<o;n++)(i=s[n])&&i.willDrawDebug()&&i.drawDebug(l)}}},checkHash:function(t,e,n){for(var i={},r=Math.floor(t.pos.x/n),s=Math.floor(t.pos.y/n),o=Math.floor((t.pos.x+t.size.x)/n)+1,a=Math.floor((t.pos.y+t.size.y)/n)+1,u=r;u<o;u++)for(var l=s;l<a;l++)if(e[u])if(e[u][l]){for(var c=e[u][l],h=0;h<c.length;h++)t.touches(c[h])&&!i[c[h].id]&&(i[c[h].id]=!0,this.checkBodies(t,c[h]));c.push(t)}else e[u][l]=[t];else e[u]={},e[u][l]=[t]},checkBodies:function(t,e){t.collides===s.FIXED&&e.collides===s.FIXED||(t.checkAgainst&e.type&&t.check(e),e.checkAgainst&t.type&&e.check(t),t.collides&&e.collides&&t.collides+e.collides>s.ACTIVE&&d(this,t,e))},setCollidesNever:function(t){for(var e=0;e<t.length;e++)t[e].collides=s.NEVER;return this},setLite:function(t){for(var e=0;e<t.length;e++)t[e].collides=s.LITE;return this},setPassive:function(t){for(var e=0;e<t.length;e++)t[e].collides=s.PASSIVE;return this},setActive:function(t){for(var e=0;e<t.length;e++)t[e].collides=s.ACTIVE;return this},setFixed:function(t){for(var e=0;e<t.length;e++)t[e].collides=s.FIXED;return this},setTypeNone:function(t){for(var e=0;e<t.length;e++)t[e].type=p.NONE;return this},setTypeA:function(t){for(var e=0;e<t.length;e++)t[e].type=p.A;return this},setTypeB:function(t){for(var e=0;e<t.length;e++)t[e].type=p.B;return this},setAvsB:function(t){for(var e=0;e<t.length;e++)t[e].type=p.A,t[e].checkAgainst=p.B;return this},setBvsA:function(t){for(var e=0;e<t.length;e++)t[e].type=p.B,t[e].checkAgainst=p.A;return this},setCheckAgainstNone:function(t){for(var e=0;e<t.length;e++)t[e].checkAgainst=p.NONE;return this},setCheckAgainstA:function(t){for(var e=0;e<t.length;e++)t[e].checkAgainst=p.A;return this},setCheckAgainstB:function(t){for(var e=0;e<t.length;e++)t[e].checkAgainst=p.B;return this},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners(),this.scene=null,this.bodies.clear(),this.bodies=null,this.collisionMap=null}});t.exports=m},function(t,e,n){var i=n(135),r=n(62),s=n(0),o=n(1361),a=n(234),u=n(1397),l=n(1363),c=n(1364),h=n(1266),d=n(1422),f=n(86),p=new s({initialize:function(t){this.world=t,this.scene=t.scene,this.sys=t.scene.sys},rectangle:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return this.world.add(o),o},trapezoid:function(t,e,n,r,s,o){var a=i.trapezoid(t,e,n,r,s,o);return this.world.add(a),a},circle:function(t,e,n,r,s){var o=i.circle(t,e,n,r,s);return this.world.add(o),o},polygon:function(t,e,n,r,s){var o=i.polygon(t,e,n,r,s);return this.world.add(o),o},fromVertices:function(t,e,n,r,s,o,a){"string"==typeof n&&(n=f.fromPath(n));var u=i.fromVertices(t,e,n,r,s,o,a);return this.world.add(u),u},imageStack:function(t,e,n,i,r,s,a,u,c){void 0===a&&(a=0),void 0===u&&(u=0),void 0===c&&(c={});var h=this.world,d=this.sys.displayList;c.addToWorld=!1;var f=o.stack(n,i,r,s,a,u,function(n,i){var r=new l(h,n,i,t,e,c);return d.add(r),r.body});return h.add(f),f},stack:function(t,e,n,i,r,s,a){var u=o.stack(t,e,n,i,r,s,a);return this.world.add(u),u},pyramid:function(t,e,n,i,r,s,a){var u=o.pyramid(t,e,n,i,r,s,a);return this.world.add(u),u},chain:function(t,e,n,i,r,s){return o.chain(t,e,n,i,r,s)},mesh:function(t,e,n,i,r){return o.mesh(t,e,n,i,r)},newtonsCradle:function(t,e,n,i,r){var s=o.newtonsCradle(t,e,n,i,r);return this.world.add(s),s},car:function(t,e,n,i,r){var s=o.car(t,e,n,i,r);return this.world.add(s),s},softBody:function(t,e,n,i,r,s,a,u,l,c){var h=o.softBody(t,e,n,i,r,s,a,u,l,c);return this.world.add(h),h},joint:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},spring:function(t,e,n,i,r){return this.constraint(t,e,n,i,r)},constraint:function(t,e,n,i,r){void 0===i&&(i=1),void 0===r&&(r={}),r.bodyA="body"===t.type?t:t.body,r.bodyB="body"===e.type?e:e.body,isNaN(n)||(r.length=n),r.stiffness=i;var s=a.create(r);return this.world.add(s),s},worldConstraint:function(t,e,n,i){void 0===n&&(n=1),void 0===i&&(i={}),i.bodyB="body"===t.type?t:t.body,isNaN(e)||(i.length=e),i.stiffness=n;var r=a.create(i);return this.world.add(r),r},mouseSpring:function(t){return this.pointerConstraint(t)},pointerConstraint:function(t){void 0===t&&(t={}),t.hasOwnProperty("render")||(t.render={visible:!1});var e=new d(this.scene,this.world,t);return this.world.add(e.constraint),e},image:function(t,e,n,i,r){var s=new l(this.world,t,e,n,i,r);return this.sys.displayList.add(s),s},tileBody:function(t,e){return new h(this.world,t,e)},sprite:function(t,e,n,i,r){var s=new c(this.world,t,e,n,i,r);return this.sys.displayList.add(s),this.sys.updateList.add(s),s},gameObject:function(t,e){return u(this.world,t,e)},velocity:function(t,e){return r.setVelocity(t,e),t},angularVelocity:function(t,e){return r.setAngularVelocity(t,e),t},force:function(t,e,n){return r.applyForce(t,e,n),t},destroy:function(){this.world=null,this.scene=null,this.sys=null}});t.exports=p},function(t,e){function n(t,e,n){var i,r,s,o,a,u,l,c=[0,0];return s=(i=t[1][1]-t[0][1])*t[0][0]+(r=t[0][0]-t[1][0])*t[0][1],u=(o=e[1][1]-e[0][1])*e[0][0]+(a=e[0][0]-e[1][0])*e[0][1],T(l=i*a-o*r,0,n=n||0)||(c[0]=(a*s-r*u)/l,c[1]=(i*u-o*s)/l),c}function i(t,e,n,i){var r=e[0]-t[0],s=e[1]-t[1],o=i[0]-n[0],a=i[1]-n[1];if(o*s-a*r==0)return!1;var u=(r*(n[1]-t[1])+s*(t[0]-n[0]))/(o*s-a*r),l=(o*(t[1]-n[1])+a*(n[0]-t[0]))/(a*r-o*s);return u>=0&&u<=1&&l>=0&&l<=1}function r(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function s(t,e,n){return r(t,e,n)>0}function o(t,e,n){return r(t,e,n)>=0}function a(t,e,n){return r(t,e,n)<0}function u(t,e,n){return r(t,e,n)<=0}t.exports={decomp:function(t){var e=function t(e){for(var n=[],i=[],r=[],s=[],o=Number.MAX_VALUE,a=0;a<e.length;++a)if(m(e,a))for(var u=0;u<e.length;++u)if(v(e,a,u)){i=t(x(e,a,u,s)),r=t(x(e,u,a,s));for(var l=0;l<r.length;l++)i.push(r[l]);i.length<o&&(o=i.length,(n=i).push([f(e,a),f(e,u)]))}return n}(t);return e.length>0?function t(e,n){if(0===n.length)return[e];if(n instanceof Array&&n.length&&n[0]instanceof Array&&2===n[0].length&&n[0][0]instanceof Array){for(var i=[e],r=0;r<n.length;r++)for(var s=n[r],o=0;o<i.length;o++){var a=t(i[o],s);if(a){i.splice(o,1),i.push(a[0],a[1]);break}}return i}return r=e.indexOf((s=n)[0]),o=e.indexOf(s[1]),-1!==r&&-1!==o&&[x(e,r,o),x(e,o,r)]}(t,e):[t]},quickDecomp:function t(e,n,i,r,l,c,h){h=h||0,l=l||25,n=void 0!==n?n:[],i=i||[],r=r||[];var g=[0,0],y=[0,0],v=[0,0],x=0,T=0,S=0,E=0,O=0,C=0,_=0,A=[],k=[],R=e,I=e;if(I.length<3)return n;if(++h>(c=c||100))return console.warn("quickDecomp: max level ("+c+") reached."),n;for(var M=0;M<e.length;++M)if(m(R,M)){i.push(R[M]),x=T=Number.MAX_VALUE;for(var N=0;N<e.length;++N)s(f(R,M-1),f(R,M),f(R,N))&&u(f(R,M-1),f(R,M),f(R,N-1))&&(v=w(f(R,M-1),f(R,M),f(R,N),f(R,N-1)),a(f(R,M+1),f(R,M),v)&&(S=d(R[M],v))<T&&(T=S,y=v,C=N)),s(f(R,M+1),f(R,M),f(R,N+1))&&u(f(R,M+1),f(R,M),f(R,N))&&(v=w(f(R,M+1),f(R,M),f(R,N),f(R,N+1)),s(f(R,M-1),f(R,M),v)&&(S=d(R[M],v))<x&&(x=S,g=v,O=N));if(C===(O+1)%e.length)v[0]=(y[0]+g[0])/2,v[1]=(y[1]+g[1])/2,r.push(v),M<O?(p(A,R,M,O+1),A.push(v),k.push(v),0!==C&&p(k,R,C,R.length),p(k,R,0,M+1)):(0!==M&&p(A,R,M,R.length),p(A,R,0,O+1),A.push(v),k.push(v),p(k,R,C,M+1));else{if(C>O&&(O+=e.length),E=Number.MAX_VALUE,O<C)return n;for(N=C;N<=O;++N)o(f(R,M-1),f(R,M),f(R,N))&&u(f(R,M+1),f(R,M),f(R,N))&&(S=d(f(R,M),f(R,N)))<E&&b(R,M,N)&&(E=S,_=N%e.length);M<_?(p(A,R,M,_+1),0!==_&&p(k,R,_,I.length),p(k,R,0,M+1)):(0!==M&&p(A,R,M,I.length),p(A,R,0,_+1),p(k,R,_,M+1))}return A.length<k.length?(t(A,n,i,r,l,c,h),t(k,n,i,r,l,c,h)):(t(k,n,i,r,l,c,h),t(A,n,i,r,l,c,h)),n}return n.push(e),n},isSimple:function(t){var e,n=t;for(e=0;e<n.length-1;e++)for(var r=0;r<e-1;r++)if(i(n[e],n[e+1],n[r],n[r+1]))return!1;for(e=1;e<n.length-2;e++)if(i(n[0],n[n.length-1],n[e],n[e+1]))return!1;return!0},removeCollinearPoints:function(t,e){for(var n=0,i=t.length-1;t.length>3&&i>=0;--i)h(f(t,i-1),f(t,i),f(t,i+1),e)&&(t.splice(i%t.length,1),n++);return n},removeDuplicatePoints:function(t,e){for(var n=t.length-1;n>=1;--n)for(var i=t[n],r=n-1;r>=0;--r)S(i,t[r],e)&&t.splice(n,1)},makeCCW:function(t){for(var e=0,n=t,i=1;i<t.length;++i)(n[i][1]<n[e][1]||n[i][1]===n[e][1]&&n[i][0]>n[e][0])&&(e=i);return!s(f(t,e-1),f(t,e),f(t,e+1))&&(function(t){for(var e=[],n=t.length,i=0;i!==n;i++)e.push(t.pop());for(i=0;i!==n;i++)t[i]=e[i]}(t),!0)}};var l=[],c=[];function h(t,e,n,i){if(i){var s=l,o=c;s[0]=e[0]-t[0],s[1]=e[1]-t[1],o[0]=n[0]-e[0],o[1]=n[1]-e[1];var a=s[0]*o[0]+s[1]*o[1],u=Math.sqrt(s[0]*s[0]+s[1]*s[1]),h=Math.sqrt(o[0]*o[0]+o[1]*o[1]);return Math.acos(a/(u*h))<i}return 0===r(t,e,n)}function d(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function f(t,e){var n=t.length;return t[e<0?e%n+n:e%n]}function p(t,e,n,i){for(var r=n;r<i;r++)t.push(e[r])}function m(t,e){return a(f(t,e-1),f(t,e),f(t,e+1))}var g=[],y=[];function v(t,e,i){var r,s,a=g,l=y;if(o(f(t,e+1),f(t,e),f(t,i))&&u(f(t,e-1),f(t,e),f(t,i)))return!1;s=d(f(t,e),f(t,i));for(var c=0;c!==t.length;++c)if((c+1)%t.length!==e&&c!==e&&o(f(t,e),f(t,i),f(t,c+1))&&u(f(t,e),f(t,i),f(t,c))&&(a[0]=f(t,e),a[1]=f(t,i),l[0]=f(t,c),l[1]=f(t,c+1),r=n(a,l),d(f(t,e),r)<s))return!1;return!0}function b(t,e,n){for(var r=0;r!==t.length;++r)if(r!==e&&r!==n&&(r+1)%t.length!==e&&(r+1)%t.length!==n&&i(f(t,e),f(t,n),f(t,r),f(t,r+1)))return!1;return!0}function x(t,e,n,i){var r=i||[];if(function(t){t.length=0}(r),e<n)for(var s=e;s<=n;s++)r.push(t[s]);else{for(s=0;s<=n;s++)r.push(t[s]);for(s=e;s<t.length;s++)r.push(t[s])}return r}function w(t,e,n,i,r){var s=e[1]-t[1],o=t[0]-e[0],a=s*t[0]+o*t[1],u=i[1]-n[1],l=n[0]-i[0],c=u*n[0]+l*n[1],h=s*l-u*o;return T(h,0,r=r||0)?[0,0]:[(l*a-o*c)/h,(s*c-u*a)/h]}function T(t,e,n){return n=n||0,Math.abs(t-e)<=n}function S(t,e,n){return T(t[0],e[0],n)&&T(t[1],e[1],n)}},function(t,e,n){var i={};t.exports=i;var r=n(213),s=n(234),o=n(37),a=n(62),u=n(135);i.stack=function(t,e,n,i,s,o,u){for(var l,c=r.create({label:"Stack"}),h=t,d=e,f=0,p=0;p<i;p++){for(var m=0,g=0;g<n;g++){var y=u(h,d,g,p,l,f);if(y){var v=y.bounds.max.y-y.bounds.min.y;v>m&&(m=v),a.translate(y,{x:.5*(y.bounds.max.x-y.bounds.min.x),y:.5*v}),h=y.bounds.max.x+s,r.addBody(c,y),l=y,f+=1}else h+=s}d+=m+o,h=t}return c},i.chain=function(t,e,n,i,a,u){for(var l=t.bodies,c=1;c<l.length;c++){var h=l[c-1],d=l[c],f=o.extend({bodyA:h,pointA:{x:(h.bounds.max.x-h.bounds.min.x)*e,y:(h.bounds.max.y-h.bounds.min.y)*n},bodyB:d,pointB:{x:(d.bounds.max.x-d.bounds.min.x)*i,y:(d.bounds.max.y-d.bounds.min.y)*a}},u);r.addConstraint(t,s.create(f))}return t.label+=" Chain",t},i.mesh=function(t,e,n,i,a){var u,l,c,h=t.bodies;for(u=0;u<n;u++){for(l=1;l<e;l++)r.addConstraint(t,s.create(o.extend({bodyA:h[l-1+u*e],bodyB:c=h[l+u*e]},a)));if(u>0)for(l=0;l<e;l++)r.addConstraint(t,s.create(o.extend({bodyA:h[l+(u-1)*e],bodyB:c=h[l+u*e]},a))),i&&l>0&&r.addConstraint(t,s.create(o.extend({bodyA:h[l-1+(u-1)*e],bodyB:c},a))),i&&l<e-1&&r.addConstraint(t,s.create(o.extend({bodyA:h[l+1+(u-1)*e],bodyB:c},a)))}return t.label+=" Mesh",t},i.pyramid=function(t,e,n,r,s,o,u){return i.stack(t,e,n,r,s,o,function(e,i,o,l,c,h){var d=Math.min(r,Math.ceil(n/2)),f=c?c.bounds.max.x-c.bounds.min.x:0;if(!(l>d||o<(l=d-l)||o>n-1-l))return 1===h&&a.translate(c,{x:(o+(n%2==1?1:-1))*f,y:0}),u(t+(c?o*f:0)+o*s,i,o,l,c,h)})},i.newtonsCradle=function(t,e,n,i,o){for(var a=r.create({label:"Newtons Cradle"}),l=0;l<n;l++){var c=u.circle(t+l*(1.9*i),e+o,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),h=s.create({pointA:{x:t+l*(1.9*i),y:e},bodyB:c});r.addBody(a,c),r.addConstraint(a,h)}return a},i.car=function(t,e,n,i,o){var l=a.nextGroup(!0),c=.5*-n+20,h=.5*n-20,d=r.create({label:"Car"}),f=u.rectangle(t,e,n,i,{collisionFilter:{group:l},chamfer:{radius:.5*i},density:2e-4}),p=u.circle(t+c,e+0,o,{collisionFilter:{group:l},friction:.8}),m=u.circle(t+h,e+0,o,{collisionFilter:{group:l},friction:.8}),g=s.create({bodyB:f,pointB:{x:c,y:0},bodyA:p,stiffness:1,length:0}),y=s.create({bodyB:f,pointB:{x:h,y:0},bodyA:m,stiffness:1,length:0});return r.addBody(d,f),r.addBody(d,p),r.addBody(d,m),r.addConstraint(d,g),r.addConstraint(d,y),d},i.softBody=function(t,e,n,r,s,a,l,c,h,d){h=o.extend({inertia:1/0},h),d=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},d);var f=i.stack(t,e,n,r,s,a,function(t,e){return u.circle(t,e,c,h)});return i.mesh(f,n,r,l,d),f.label="Soft Body",f}},function(t,e,n){var i=n(135),r=n(62),s=n(102),o=n(37),a=n(2),u=n(101),l=n(86);t.exports={parseBody:function(t,e,n,i,s){for(var u=a(s,"fixtures",[]),l=[],c=0;c<u.length;c++)for(var h=this.parseFixture(u[c]),d=0;d<h.length;d++)l.push(h[d]);var f=o.extend({},!1,s);delete f.fixtures,delete f.type;var p=r.create(f);return r.setParts(p,l),p.render.sprite.xOffset=p.position.x/n,p.render.sprite.yOffset=p.position.y/i,r.setPosition(p,{x:t,y:e}),p},parseFixture:function(t){var e,n=o.extend({},!1,t);if(delete n.circle,delete n.vertices,t.circle){var r=a(t.circle,"x"),s=a(t.circle,"y"),u=a(t.circle,"radius");e=[i.circle(r,s,u,n)]}else t.vertices&&(e=this.parseVertices(t.vertices,n));return e},parseVertices:function(t,e){var n,i,a,c,h,d=[];for(e=e||{},c=0;c<t.length;c+=1)d.push(r.create(o.extend({position:l.centre(t[c]),vertices:t[c]},e)));for(n=0;n<d.length;n++){var f=d[n];for(i=n+1;i<d.length;i++){var p=d[i];if(s.overlaps(f.bounds,p.bounds)){var m=f.vertices,g=p.vertices;for(a=0;a<f.vertices.length;a++)for(h=0;h<p.vertices.length;h++){var y=u.magnitudeSquared(u.sub(m[(a+1)%m.length],g[h])),v=u.magnitudeSquared(u.sub(m[a],g[(h+1)%g.length]));y<5&&v<5&&(m[a].isInternal=!0,g[h].isInternal=!0)}}}}return d}}},function(t,e,n){var i=n(0),r=n(491),s=n(13),o=n(2),a=n(98),u=n(151),l=n(3),c=new i({Extends:a,Mixins:[r.Bounce,r.Collision,r.Force,r.Friction,r.Gravity,r.Mass,r.Sensor,r.SetBody,r.Sleep,r.Static,r.Transform,r.Velocity,u],initialize:function(t,e,n,i,r,a){s.call(this,t.scene,"Image"),this.setTexture(i,r),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new l(e,n);var u=o(a,"shape",null);u?this.setBody(u,a):this.setRectangle(this.width,this.height,a),this.setPosition(e,n),this.initPipeline("TextureTintPipeline")}});t.exports=c},function(t,e,n){var i=n(482),r=n(0),s=n(491),o=n(13),a=n(2),u=n(151),l=n(68),c=n(3),h=new r({Extends:l,Mixins:[s.Bounce,s.Collision,s.Force,s.Friction,s.Gravity,s.Mass,s.Sensor,s.SetBody,s.Sleep,s.Static,s.Transform,s.Velocity,u],initialize:function(t,e,n,r,s,u){o.call(this,t.scene,"Sprite"),this.anims=new i(this),this.setTexture(r,s),this.setSizeToFrame(),this.setOrigin(),this.world=t,this._tempVec2=new c(e,n);var l=a(u,"shape",null);l?this.setBody(l,u):this.setRectangle(this.width,this.height,u),this.setPosition(e,n),this.initPipeline("TextureTintPipeline")}});t.exports=h},function(t,e,n){var i={};t.exports=i;var r=n(1270),s=n(37);i.name="matter-js",i.version="0.14.2",i.uses=[],i.used=[],i.use=function(){r.use(i,Array.prototype.slice.call(arguments))},i.before=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathBefore(i,t,e)},i.after=function(t,e){return t=t.replace(/^Matter./,""),s.chainPathAfter(i,t,e)}},function(t,e,n){var i={};t.exports=i;var r=n(492),s=n(1267),o=n(37);i.create=function(t){return o.extend({controller:i,detector:s.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},t)},i.update=function(t,e,n,r){var s,o,a,u,l,c=n.world,h=t.buckets,d=!1,f=n.metrics;for(f.broadphaseTests=0,s=0;s<e.length;s++){var p=e[s];if((!p.isSleeping||r)&&!(p.bounds.max.x<c.bounds.min.x||p.bounds.min.x>c.bounds.max.x||p.bounds.max.y<c.bounds.min.y||p.bounds.min.y>c.bounds.max.y)){var m=i._getRegion(t,p);if(!p.region||m.id!==p.region.id||r){f.broadphaseTests+=1,p.region&&!r||(p.region=m);var g=i._regionUnion(m,p.region);for(o=g.startCol;o<=g.endCol;o++)for(a=g.startRow;a<=g.endRow;a++){u=h[l=i._getBucketId(o,a)];var y=o>=m.startCol&&o<=m.endCol&&a>=m.startRow&&a<=m.endRow,v=o>=p.region.startCol&&o<=p.region.endCol&&a>=p.region.startRow&&a<=p.region.endRow;!y&&v&&v&&u&&i._bucketRemoveBody(t,u,p),(p.region===m||y&&!v||r)&&(u||(u=i._createBucket(h,l)),i._bucketAddBody(t,u,p))}p.region=m,d=!0}}}d&&(t.pairsList=i._createActivePairsList(t))},i.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},i._regionUnion=function(t,e){var n=Math.min(t.startCol,e.startCol),r=Math.max(t.endCol,e.endCol),s=Math.min(t.startRow,e.startRow),o=Math.max(t.endRow,e.endRow);return i._createRegion(n,r,s,o)},i._getRegion=function(t,e){var n=e.bounds,r=Math.floor(n.min.x/t.bucketWidth),s=Math.floor(n.max.x/t.bucketWidth),o=Math.floor(n.min.y/t.bucketHeight),a=Math.floor(n.max.y/t.bucketHeight);return i._createRegion(r,s,o,a)},i._createRegion=function(t,e,n,i){return{id:t+","+e+","+n+","+i,startCol:t,endCol:e,startRow:n,endRow:i}},i._getBucketId=function(t,e){return"C"+t+"R"+e},i._createBucket=function(t,e){return t[e]=[]},i._bucketAddBody=function(t,e,n){for(var i=0;i<e.length;i++){var s=e[i];if(!(n.id===s.id||n.isStatic&&s.isStatic)){var o=r.id(n,s),a=t.pairs[o];a?a[2]+=1:t.pairs[o]=[n,s,1]}}e.push(n)},i._bucketRemoveBody=function(t,e,n){e.splice(o.indexOf(e,n),1);for(var i=0;i<e.length;i++){var s=r.id(n,e[i]),a=t.pairs[s];a&&(a[2]-=1)}},i._createActivePairsList=function(t){var e,n,i=[];e=o.keys(t.pairs);for(var r=0;r<e.length;r++)(n=t.pairs[e[r]])[2]>0?i.push(n):delete t.pairs[e[r]];return i}},function(t,e,n){var i={};t.exports=i;var r=n(492),s=n(37);i._pairMaxIdleLife=1e3,i.create=function(t){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},i.update=function(t,e,n){var i,s,o,a,u=t.list,l=t.table,c=t.collisionStart,h=t.collisionEnd,d=t.collisionActive;for(c.length=0,h.length=0,d.length=0,a=0;a<u.length;a++)u[a].confirmedActive=!1;for(a=0;a<e.length;a++)(i=e[a]).collided&&((o=l[s=r.id(i.bodyA,i.bodyB)])?(o.isActive?d.push(o):c.push(o),r.update(o,i,n),o.confirmedActive=!0):(o=r.create(i,n),l[s]=o,c.push(o),u.push(o)));for(a=0;a<u.length;a++)(o=u[a]).isActive&&!o.confirmedActive&&(r.setActive(o,!1,n),h.push(o))},i.removeOld=function(t,e){var n,r,s,o,a=t.list,u=t.table,l=[];for(o=0;o<a.length;o++)(r=(n=a[o]).collision).bodyA.isSleeping||r.bodyB.isSleeping?n.timeUpdated=e:e-n.timeUpdated>i._pairMaxIdleLife&&l.push(o);for(o=0;o<l.length;o++)delete u[(n=a[s=l[o]-o]).id],a.splice(s,1)},i.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}},function(t,e,n){var i={};t.exports=i;var r=n(86),s=n(101),o=n(37),a=n(102);i._restingThresh=4,i._restingThreshTangent=6,i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i.preSolvePosition=function(t){var e,n,i;for(e=0;e<t.length;e++)(n=t[e]).isActive&&(n.collision.parentA.totalContacts+=i=n.activeContacts.length,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(t,e,n){var r,s,o,a,u,l,c,h,d,f,p,m,g,y,v=n*i._positionDampen;for(r=0;r<e.length;r++){var b=e[r];b.previousPositionImpulse.x=b.positionImpulse.x,b.previousPositionImpulse.y=b.positionImpulse.y}for(r=0;r<t.length;r++)(a=t[r]).isActive&&!a.isSensor&&(l=(u=a.collision).parentA,d=(s=(h=u.normal).x)*((m=(c=u.parentB).previousPositionImpulse).x-(p=l.previousPositionImpulse).x+(f=u.penetration).x)+(o=h.y)*(m.y-p.y+f.y),a.separation=d,y=(d-a.slop)*v,(l.isStatic||c.isStatic)&&(y*=2),l.isStatic||l.isSleeping||(l.positionImpulse.x+=s*(g=y/l.totalContacts),l.positionImpulse.y+=o*g),c.isStatic||c.isSleeping||(c.positionImpulse.x-=s*(g=y/c.totalContacts),c.positionImpulse.y-=o*g))},i.postSolvePosition=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.totalContacts=0,0!==n.positionImpulse.x||0!==n.positionImpulse.y){for(var o=0;o<n.parts.length;o++){var u=n.parts[o];r.translate(u.vertices,n.positionImpulse),a.update(u.bounds,u.vertices,n.velocity),u.position.x+=n.positionImpulse.x,u.position.y+=n.positionImpulse.y}n.positionPrev.x+=n.positionImpulse.x,n.positionPrev.y+=n.positionImpulse.y,s.dot(n.positionImpulse,n.velocity)<0?(n.positionImpulse.x=0,n.positionImpulse.y=0):(n.positionImpulse.x*=i._positionWarming,n.positionImpulse.y*=i._positionWarming)}}},i.preSolveVelocity=function(t){var e,n,i,r,o,a,u,l,c,h,d,f,p,m,g=s._temp[0],y=s._temp[1];for(e=0;e<t.length;e++)if((i=t[e]).isActive&&!i.isSensor)for(r=i.activeContacts,a=(o=i.collision).parentA,u=o.parentB,l=o.normal,c=o.tangent,n=0;n<r.length;n++)d=(h=r[n]).vertex,p=h.tangentImpulse,0===(f=h.normalImpulse)&&0===p||(g.x=l.x*f+c.x*p,g.y=l.y*f+c.y*p,a.isStatic||a.isSleeping||(m=s.sub(d,a.position,y),a.positionPrev.x+=g.x*a.inverseMass,a.positionPrev.y+=g.y*a.inverseMass,a.anglePrev+=s.cross(m,g)*a.inverseInertia),u.isStatic||u.isSleeping||(m=s.sub(d,u.position,y),u.positionPrev.x-=g.x*u.inverseMass,u.positionPrev.y-=g.y*u.inverseMass,u.anglePrev-=s.cross(m,g)*u.inverseInertia))},i.solveVelocity=function(t,e){for(var n=e*e,r=s._temp[0],a=s._temp[1],u=s._temp[2],l=s._temp[3],c=s._temp[4],h=s._temp[5],d=0;d<t.length;d++){var f=t[d];if(f.isActive&&!f.isSensor){var p=f.collision,m=p.parentA,g=p.parentB,y=p.normal,v=p.tangent,b=f.activeContacts,x=1/b.length;m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,m.angularVelocity=m.angle-m.anglePrev,g.angularVelocity=g.angle-g.anglePrev;for(var w=0;w<b.length;w++){var T=b[w],S=T.vertex,E=s.sub(S,m.position,a),O=s.sub(S,g.position,u),C=s.add(m.velocity,s.mult(s.perp(E),m.angularVelocity),l),_=s.add(g.velocity,s.mult(s.perp(O),g.angularVelocity),c),A=s.sub(C,_,h),k=s.dot(y,A),R=s.dot(v,A),I=Math.abs(R),M=o.sign(R),N=(1+f.restitution)*k,D=o.clamp(f.separation+k,0,1)*i._frictionNormalMultiplier,P=R,F=1/0;I>f.friction*f.frictionStatic*D*n&&(P=o.clamp(f.friction*M*n,-(F=I),F));var L=s.cross(E,y),j=s.cross(O,y),B=x/(m.inverseMass+g.inverseMass+m.inverseInertia*L*L+g.inverseInertia*j*j);if(N*=B,P*=B,k<0&&k*k>i._restingThresh*n)T.normalImpulse=0;else{var z=T.normalImpulse;T.normalImpulse=Math.min(T.normalImpulse+N,0),N=T.normalImpulse-z}if(R*R>i._restingThreshTangent*n)T.tangentImpulse=0;else{var $=T.tangentImpulse;T.tangentImpulse=o.clamp(T.tangentImpulse+P,-F,F),P=T.tangentImpulse-$}r.x=y.x*N+v.x*P,r.y=y.y*N+v.y*P,m.isStatic||m.isSleeping||(m.positionPrev.x+=r.x*m.inverseMass,m.positionPrev.y+=r.y*m.inverseMass,m.anglePrev+=s.cross(E,r)*m.inverseInertia),g.isStatic||g.isSleeping||(g.positionPrev.x-=r.x*g.inverseMass,g.positionPrev.y-=r.y*g.inverseMass,g.anglePrev-=s.cross(O,r)*g.inverseInertia)}}}}},function(t,e,n){var i={};t.exports=i;var r=n(1271),s=n(452),o=n(1368),a=n(1367),u=n(1424),l=n(1366),c=n(233),h=n(213),d=n(234),f=n(37),p=n(62);i.create=function(t,e){e=(e=f.isElement(t)?e:t)||{},((t=f.isElement(t)?t:null)||e.render)&&f.warn("Engine.create: engine.render is deprecated (see docs)");var n=f.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:l}},e);if(t||n.render){var i={element:t,controller:Render};n.render=f.extend(i,n.render)}return n.render&&n.render.controller&&(n.render=n.render.controller.create(n.render)),n.render&&(n.render.engine=n),n.world=e.world||r.create(n.world),n.pairs=a.create(),n.broadphase=n.broadphase.controller.create(n.broadphase),n.metrics=n.metrics||{extended:!1},n.metrics=u.create(n.metrics),n},i.update=function(t,e,n){n=n||1;var r,l=t.world,f=t.timing,p=t.broadphase,m=[];f.timestamp+=(e=e||1e3/60)*f.timeScale;var g={timestamp:f.timestamp};c.trigger(t,"beforeUpdate",g);var y=h.allBodies(l),v=h.allConstraints(l);for(u.reset(t.metrics),t.enableSleeping&&s.update(y,f.timeScale),i._bodiesApplyGravity(y,l.gravity),i._bodiesUpdate(y,e,f.timeScale,n,l.bounds),d.preSolveAll(y),r=0;r<t.constraintIterations;r++)d.solveAll(v,f.timeScale);d.postSolveAll(y),p.controller?(l.isModified&&p.controller.clear(p),p.controller.update(p,y,t,l.isModified),m=p.pairsList):m=y,l.isModified&&h.setModified(l,!1,!1,!0);var b=p.detector(m,t),x=t.pairs,w=f.timestamp;for(a.update(x,b,w),a.removeOld(x,w),t.enableSleeping&&s.afterCollisions(x.list,f.timeScale),x.collisionStart.length>0&&c.trigger(t,"collisionStart",{pairs:x.collisionStart}),o.preSolvePosition(x.list),r=0;r<t.positionIterations;r++)o.solvePosition(x.list,y,f.timeScale);for(o.postSolvePosition(y),d.preSolveAll(y),r=0;r<t.constraintIterations;r++)d.solveAll(v,f.timeScale);for(d.postSolveAll(y),o.preSolveVelocity(x.list),r=0;r<t.velocityIterations;r++)o.solveVelocity(x.list,f.timeScale);return x.collisionActive.length>0&&c.trigger(t,"collisionActive",{pairs:x.collisionActive}),x.collisionEnd.length>0&&c.trigger(t,"collisionEnd",{pairs:x.collisionEnd}),u.update(t.metrics,t),i._bodiesClearForces(y),c.trigger(t,"afterUpdate",g),t},i.merge=function(t,e){if(f.extend(t,e),e.world){t.world=e.world,i.clear(t);for(var n=h.allBodies(t.world),r=0;r<n.length;r++){var o=n[r];s.set(o,!1),o.id=f.nextId()}}},i.clear=function(t){var e=t.world;a.clear(t.pairs);var n=t.broadphase;if(n.controller){var i=h.allBodies(e);n.controller.clear(n),n.controller.update(n,i,t,!0)}},i._bodiesClearForces=function(t){for(var e=0;e<t.length;e++){var n=t[e];n.force.x=0,n.force.y=0,n.torque=0}},i._bodiesApplyGravity=function(t,e){var n=void 0!==e.scale?e.scale:.001;if((0!==e.x||0!==e.y)&&0!==n)for(var i=0;i<t.length;i++){var r=t[i];r.ignoreGravity||r.isStatic||r.isSleeping||(r.force.y+=r.mass*e.y*n,r.force.x+=r.mass*e.x*n)}},i._bodiesUpdate=function(t,e,n,i,r){for(var s=0;s<t.length;s++){var o=t[s];o.isStatic||o.isSleeping||p.update(o,e,n,i)}}},function(t,e,n){var i=n(135),r=n(62),s=n(0),o=n(37),a=n(213),u=n(1369),l=n(9),c=n(1265),h=n(2),d=n(6),f=n(62),p=n(233),m=n(1266),g=n(1271),y=n(101),v=new s({Extends:l,initialize:function(t,e){l.call(this),this.scene=t,this.engine=u.create(e),this.localWorld=this.engine.world;var n=d(e,"gravity",null);if(n&&this.setGravity(n.x,n.y,n.scale),this.walls={left:null,right:null,top:null,bottom:null},h(e,"setBounds",!1)){var i=e.setBounds;if("boolean"==typeof i)this.setBounds();else{var r=h(i,"x",0),s=h(i,"y",0),o=h(i,"width",t.sys.scale.width),a=h(i,"height",t.sys.scale.height),c=h(i,"thickness",64),f=h(i,"left",!0),p=h(i,"right",!0),m=h(i,"top",!0),g=h(i,"bottom",!0);this.setBounds(r,s,o,a,c,f,p,m,g)}}this.enabled=d(e,"enabled",!0),this.correction=d(e,"correction",1),this.getDelta=d(e,"getDelta",this.update60Hz),this.autoUpdate=d(e,"autoUpdate",!0),this.drawDebug=d(e,"debug",!1),this.defaults={debugShowBody:h(e,"debugShowBody",!0),debugShowStaticBody:h(e,"debugShowStaticBody",!0),debugShowVelocity:h(e,"debugShowVelocity",!0),bodyDebugColor:h(e,"debugBodyColor",16711935),bodyDebugFillColor:h(e,"debugBodyFillColor",14919651),staticBodyDebugColor:h(e,"debugStaticBodyColor",255),velocityDebugColor:h(e,"debugVelocityColor",65280),debugShowJoint:h(e,"debugShowJoint",!0),jointDebugColor:h(e,"debugJointColor",0),debugWireframes:h(e,"debugWireframes",!0),debugShowInternalEdges:h(e,"debugShowInternalEdges",!1),debugShowConvexHulls:h(e,"debugShowConvexHulls",!1),debugConvexHullColor:h(e,"debugConvexHullColor",11184810),debugShowSleeping:h(e,"debugShowSleeping",!1)},this.drawDebug&&this.createDebugGraphic(),this.setEventsProxy()},setEventsProxy:function(){var t=this,e=this.engine;p.on(e,"beforeUpdate",function(e){t.emit(c.BEFORE_UPDATE,e)}),p.on(e,"afterUpdate",function(e){t.emit(c.AFTER_UPDATE,e)}),p.on(e,"collisionStart",function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_START,e,n,i)}),p.on(e,"collisionActive",function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_ACTIVE,e,n,i)}),p.on(e,"collisionEnd",function(e){var n,i,r=e.pairs;r.length>0&&(n=r[0].bodyA,i=r[0].bodyB),t.emit(c.COLLISION_END,e,n,i)})},setBounds:function(t,e,n,i,r,s,o,a,u){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===i&&(i=this.scene.sys.scale.height),void 0===r&&(r=128),void 0===s&&(s=!0),void 0===o&&(o=!0),void 0===a&&(a=!0),void 0===u&&(u=!0),this.updateWall(s,"left",t-r,e-r,r,i+2*r),this.updateWall(o,"right",t+n,e-r,r,i+2*r),this.updateWall(a,"top",t,e-r,n,r),this.updateWall(u,"bottom",t,e+i,n,r),this},updateWall:function(t,e,n,i,r,s){var o=this.walls[e];t?(o&&g.remove(this.localWorld,o),this.walls[e]=this.create(n+=r/2,i+=s/2,r,s,{isStatic:!0,friction:0,frictionStatic:0})):(o&&g.remove(this.localWorld,o),this.walls[e]=null)},createDebugGraphic:function(){var t=this.scene.sys.add.graphics({x:0,y:0});return t.setDepth(Number.MAX_VALUE),this.debugGraphic=t,this.drawDebug=!0,t},disableGravity:function(){return this.localWorld.gravity.x=0,this.localWorld.gravity.y=0,this.localWorld.gravity.scale=0,this},setGravity:function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=1),this.localWorld.gravity.x=t,this.localWorld.gravity.y=e,void 0!==n&&(this.localWorld.gravity.scale=n),this},create:function(t,e,n,r,s){var o=i.rectangle(t,e,n,r,s);return g.add(this.localWorld,o),o},add:function(t){return g.add(this.localWorld,t),this},remove:function(t,e){return a.remove(this.localWorld,t.body?t.body:t,e),this},removeConstraint:function(t,e){return a.remove(this.localWorld,t,e),this},convertTilemapLayer:function(t,e){var n=t.layer,i=t.getTilesWithin(0,0,n.width,n.height,{isColliding:!0});return this.convertTiles(i,e),this},convertTiles:function(t,e){if(0===t.length)return this;for(var n=0;n<t.length;n++)new m(this,t[n],e);return this},nextGroup:function(t){return f.nextGroup(t)},nextCategory:function(){return f.nextCategory()},pause:function(){return this.enabled=!1,this.emit(c.PAUSE),this},resume:function(){return this.enabled=!0,this.emit(c.RESUME),this},update:function(t,e){this.enabled&&this.autoUpdate&&u.update(this.engine,this.getDelta(t,e),this.correction)},step:function(t,e){u.update(this.engine,t,e)},update60Hz:function(){return 1e3/60},update30Hz:function(){return 1e3/30},postUpdate:function(){if(this.drawDebug){this.debugGraphic.clear();var t=a.allBodies(this.localWorld);this.defaults.debugWireframes?(this.defaults.debugShowConvexHulls&&this.renderConvexHulls(t),this.renderWireframes(t)):this.renderBodies(t),this.defaults.debugShowJoint&&this.renderJoints()}},renderConvexHulls:function(t){var e=this.debugGraphic;e.lineStyle(1,this.defaults.debugConvexHullColor),e.beginPath();for(var n=0;n<t.length;n++){var i=t[n];if(i.render.visible&&1!==i.parts.length){e.moveTo(i.vertices[0].x,i.vertices[0].y);for(var r=1;r<i.vertices.length;r++)e.lineTo(i.vertices[r].x,i.vertices[r].y);e.lineTo(i.vertices[0].x,i.vertices[0].y)}}e.strokePath()},renderWireframes:function(t){var e=this.debugGraphic,n=this.defaults.debugShowInternalEdges;e.lineStyle(1,this.defaults.bodyDebugColor),e.beginPath();for(var i=0;i<t.length;i++){var r=t[i];if(r.render.visible)for(var s=r.parts.length>1?1:0;s<r.parts.length;s++){var o=r.parts[s],a=o.vertices.length;e.moveTo(o.vertices[0].x,o.vertices[0].y);for(var u=1;u<a;u++)!o.vertices[u-1].isInternal||n?e.lineTo(o.vertices[u].x,o.vertices[u].y):e.moveTo(o.vertices[u].x,o.vertices[u].y),o.vertices[u].isInternal&&!n&&e.moveTo(o.vertices[(u+1)%a].x,o.vertices[(u+1)%a].y);e.lineTo(o.vertices[0].x,o.vertices[0].y)}}e.strokePath()},renderBodies:function(t){var e,n,i,r,s=this.debugGraphic,o=this.defaults.debugShowInternalEdges||!this.defaults.debugWireframes,a=this.defaults.debugShowSleeping,u=this.defaults.debugWireframes;for(i=0;i<t.length;i++)if((e=t[i]).render.visible)for(r=e.parts.length>1?1:0;r<e.parts.length;r++)if((n=e.parts[r]).render.visible){if(a&&e.isSleeping?(s.lineStyle(1,this.defaults.bodyDebugColor,.5*n.render.opacity),s.fillStyle(this.defaults.bodyDebugColor,.5*n.render.opacity)):(s.lineStyle(1,this.defaults.bodyDebugColor,n.render.opacity),s.fillStyle(this.defaults.bodyDebugColor,n.render.opacity)),n.circleRadius)s.beginPath(),s.arc(n.position.x,n.position.y,n.circleRadius,0,2*Math.PI);else{s.beginPath(),s.moveTo(n.vertices[0].x,n.vertices[0].y);for(var l=n.vertices.length,c=1;c<l;c++)!n.vertices[c-1].isInternal||o?s.lineTo(n.vertices[c].x,n.vertices[c].y):s.moveTo(n.vertices[c].x,n.vertices[c].y),n.vertices[c].isInternal&&!o&&s.moveTo(n.vertices[(c+1)%n.vertices.length].x,n.vertices[(c+1)%n.vertices.length].y);s.lineTo(n.vertices[0].x,n.vertices[0].y),s.closePath()}u?s.strokePath():s.fillPath()}},renderJoints:function(){var t=this.debugGraphic;t.lineStyle(2,this.defaults.jointDebugColor);for(var e=a.allConstraints(this.localWorld),n=0;n<e.length;n++){var i=e[n];if(i.render.visible&&i.pointA&&i.pointB){i.render.lineWidth&&t.lineStyle(i.render.lineWidth,o.colorToNumber(i.render.strokeStyle));var r,s,u=i.bodyA,l=i.bodyB;if(r=u?y.add(u.position,i.pointA):i.pointA,"pin"===i.render.type)t.beginPath(),t.arc(r.x,r.y,3,0,2*Math.PI),t.closePath();else{if(s=l?y.add(l.position,i.pointB):i.pointB,t.beginPath(),t.moveTo(r.x,r.y),"spring"===i.render.type)for(var c,h=y.sub(s,r),d=y.perp(y.normalise(h)),f=Math.ceil(o.clamp(i.length/5,12,20)),p=1;p<f;p+=1)t.lineTo(r.x+h.x*(p/f)+d.x*(c=p%2==0?1:-1)*4,r.y+h.y*(p/f)+d.y*c*4);t.lineTo(s.x,s.y)}i.render.lineWidth&&t.strokePath(),i.render.anchors&&(t.fillStyle(o.colorToNumber(i.render.strokeStyle)),t.beginPath(),t.arc(r.x,r.y,6,0,2*Math.PI),t.arc(s.x,s.y,6,0,2*Math.PI),t.closePath(),t.fillPath())}}},fromPath:function(t,e){return void 0===e&&(e=[]),t.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(t,n,i){e.push({x:parseFloat(n),y:parseFloat(i)})}),e},resetCollisionIDs:function(){return r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,this},shutdown:function(){p.off(this.engine),this.removeAllListeners(),g.clear(this.localWorld,!1),u.clear(this.engine),this.drawDebug&&this.debugGraphic.destroy()},destroy:function(){this.shutdown()}});t.exports=v},function(t,e,n){(function(e){n(493);var i=n(29),r=n(16),s={Actions:n(235),Animations:n(608),BlendModes:n(52),Cache:n(609),Cameras:n(612),Core:n(695),Class:n(0),Create:n(753),Curves:n(759),Data:n(762),Display:n(764),DOM:n(793),Events:n(794),Game:n(796),GameObjects:n(889),Geom:n(406),Input:n(1171),Loader:n(1205),Math:n(166),Physics:n(1372),Plugins:n(1272),Renderer:n(1429),Scale:n(1274),ScaleModes:n(228),Scene:n(352),Scenes:n(1275),Structs:n(1277),Textures:n(1278),Tilemaps:n(1280),Time:n(1321),Tweens:n(1323),Utils:n(1341)};s.Sound=n(1351),s=r(!1,s,i),t.exports=s,e.Phaser=s}).call(this,n(227))},function(t,e,n){t.exports={Arcade:n(1231),Impact:n(1373),Matter:n(1396)}},function(t,e,n){t.exports={Body:n(1352),Events:n(1262),COLLIDES:n(450),CollisionMap:n(1353),Factory:n(1354),Image:n(1356),ImpactBody:n(1355),ImpactPhysics:n(1392),Sprite:n(1357),TYPE:n(451),World:n(1358)}},function(t,e,n){var i=n(22);t.exports=function(t,e,n,r,s){if(n)return i(e+n*t,-s,s);if(r){var o=r*t;return e-o>0?e-o:e+o<0?e+o:0}return i(e,-s,s)}},function(t,e){t.exports=function(t,e){if(t.standing=!1,e.collision.y&&(t.bounciness>0&&Math.abs(t.vel.y)>t.minBounceVelocity?t.vel.y*=-t.bounciness:(t.vel.y>0&&(t.standing=!0),t.vel.y=0)),e.collision.x&&(t.bounciness>0&&Math.abs(t.vel.x)>t.minBounceVelocity?t.vel.x*=-t.bounciness:t.vel.x=0),e.collision.slope){var n=e.collision.slope;if(t.bounciness>0){var i=t.vel.x*n.nx+t.vel.y*n.ny;t.vel.x=(t.vel.x-n.nx*i*2)*t.bounciness,t.vel.y=(t.vel.y-n.ny*i*2)*t.bounciness}else{var r=(t.vel.x*n.x+t.vel.y*n.y)/(n.x*n.x+n.y*n.y);t.vel.x=n.x*r,t.vel.y=n.y*r;var s=Math.atan2(n.x,n.y);s>t.slopeStanding.min&&s<t.slopeStanding.max&&(t.standing=!0)}}t.pos.x=e.pos.x,t.pos.y=e.pos.y}},function(t,e){t.exports="collide"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){var n=.5,i=1/3,r=2/3;t.exports={2:[0,1,1,0,!0],3:[0,1,1,n,!0],4:[0,n,1,0,!0],5:[0,1,1,r,!0],6:[0,r,1,i,!0],7:[0,i,1,0,!0],8:[n,1,0,0,!0],9:[1,0,n,1,!0],10:[n,1,1,0,!0],11:[0,0,n,1,!0],12:[0,0,1,0,!1],13:[1,1,0,0,!0],14:[1,n,0,0,!0],15:[1,1,0,n,!0],16:[1,i,0,0,!0],17:[1,r,0,i,!0],18:[1,1,0,r,!0],19:[1,1,n,0,!0],20:[n,0,0,1,!0],21:[0,1,n,0,!0],22:[n,0,1,1,!0],23:[1,1,0,1,!1],24:[0,0,1,1,!0],25:[0,0,1,n,!0],26:[0,n,1,1,!0],27:[0,0,1,i,!0],28:[0,i,1,r,!0],29:[0,r,1,1,!0],30:[i,1,0,0,!0],31:[1,0,r,1,!0],32:[r,1,1,0,!0],33:[0,0,i,1,!0],34:[1,0,1,1,!1],35:[1,0,0,1,!0],36:[1,n,0,1,!0],37:[1,0,0,n,!0],38:[1,r,0,1,!0],39:[1,i,0,r,!0],40:[1,0,0,i,!0],41:[r,1,i,0,!0],42:[r,0,i,1,!0],43:[i,1,r,0,!0],44:[i,0,r,1,!0],45:[0,1,0,0,!1],52:[1,1,r,0,!0],53:[i,0,0,1,!0],54:[0,1,i,0,!0],55:[r,0,1,1,!0]}},function(t,e){t.exports={setAccelerationX:function(t){return this.accel.x=t,this},setAccelerationY:function(t){return this.accel.y=t,this},setAcceleration:function(t,e){return this.accel.x=t,this.accel.y=e,this}}},function(t,e){t.exports={setBodySize:function(t,e){return void 0===e&&(e=t),this.body.size.x=Math.round(t),this.body.size.y=Math.round(e),this},setBodyScale:function(t,e){void 0===e&&(e=t);var n=this.body.gameObject;return n?(n.setScale(t,e),this.setBodySize(n.width*n.scaleX,n.height*n.scaleY)):this.setBodySize(this.body.size.x*t,this.body.size.y*e)}}},function(t,e,n){var i=n(451);t.exports={getBodyType:function(){return this.body.type},setTypeNone:function(){return this.body.type=i.NONE,this},setTypeA:function(){return this.body.type=i.A,this},setTypeB:function(){return this.body.type=i.B,this}}},function(t,e){t.exports={setBounce:function(t){return this.body.bounciness=t,this},setMinBounceVelocity:function(t){return this.body.minBounceVelocity=t,this},bounce:{get:function(){return this.body.bounciness},set:function(t){this.body.bounciness=t}}}},function(t,e,n){var i=n(451);t.exports={setAvsB:function(){return this.setTypeA(),this.setCheckAgainstB()},setBvsA:function(){return this.setTypeB(),this.setCheckAgainstA()},setCheckAgainstNone:function(){return this.body.checkAgainst=i.NONE,this},setCheckAgainstA:function(){return this.body.checkAgainst=i.A,this},setCheckAgainstB:function(){return this.body.checkAgainst=i.B,this},checkAgainst:{get:function(){return this.body.checkAgainst},set:function(t){this.body.checkAgainst=t}}}},function(t,e,n){var i=n(450);t.exports={_collideCallback:null,_callbackScope:null,setCollideCallback:function(t,e){return this._collideCallback=t,e&&(this._callbackScope=e),this},setCollidesNever:function(){return this.body.collides=i.NEVER,this},setLiteCollision:function(){return this.body.collides=i.LITE,this},setPassiveCollision:function(){return this.body.collides=i.PASSIVE,this},setActiveCollision:function(){return this.body.collides=i.ACTIVE,this},setFixedCollision:function(){return this.body.collides=i.FIXED,this},collides:{get:function(){return this.body.collides},set:function(t){this.body.collides=t}}}},function(t,e){t.exports={setDebug:function(t,e,n){return this.debugShowBody=t,this.debugShowVelocity=e,this.debugBodyColor=n,this},setDebugBodyColor:function(t){return this.body.debugBodyColor=t,this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(t){this.body.debugShowBody=t}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(t){this.body.debugShowVelocity=t}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(t){this.body.debugBodyColor=t}}}},function(t,e){t.exports={setFrictionX:function(t){return this.friction.x=t,this},setFrictionY:function(t){return this.friction.y=t,this},setFriction:function(t,e){return this.friction.x=t,this.friction.y=e,this}}},function(t,e){t.exports={setGravity:function(t){return this.body.gravityFactor=t,this},gravity:{get:function(){return this.body.gravityFactor},set:function(t){this.body.gravityFactor=t}}}},function(t,e){t.exports={setOffset:function(t,e,n,i){return this.body.offset.x=t,this.body.offset.y=e,n&&this.setBodySize(n,i),this}}},function(t,e){t.exports={setGameObject:function(t,e){return void 0===e&&(e=!0),t?(this.body.gameObject=t,e&&this.syncGameObject()):this.body.gameObject=null,this},syncGameObject:function(){var t=this.body.gameObject;return t&&this.setBodySize(t.width*t.scaleX,t.height*t.scaleY),this}}},function(t,e){t.exports={setVelocityX:function(t){return this.vel.x=t,this},setVelocityY:function(t){return this.vel.y=t,this},setVelocity:function(t,e){return void 0===e&&(e=t),this.vel.x=t,this.vel.y=e,this},setMaxVelocity:function(t,e){return void 0===e&&(e=t),this.maxVel.x=t,this.maxVel.y=e,this}}},function(t,e,n){var i=n(0),r=n(1354),s=n(2),o=n(106),a=n(20),u=n(21),l=n(1358),c=new i({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),t.sys.events.once(u.BOOT,this.boot,this),t.sys.events.on(u.START,this.start,this)},boot:function(){this.world=new l(this.scene,this.config),this.add=new r(this.world),this.systems.events.once(u.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new l(this.scene,this.config),this.add=new r(this.world));var t=this.systems.events;t.on(u.UPDATE,this.world.update,this.world),t.once(u.SHUTDOWN,this.shutdown,this)},getConfig:function(){var t=this.systems.game.config.physics;return o(s(this.systems.settings.physics,"impact",{}),s(t,"impact",{}))},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},shutdown:function(){var t=this.systems.events;t.off(u.UPDATE,this.world.update,this.world),t.off(u.SHUTDOWN,this.shutdown,this),this.add.destroy(),this.world.destroy(),this.add=null,this.world=null},destroy:function(){this.shutdown(),this.scene.sys.events.off(u.START,this.start,this),this.scene=null,this.systems=null}});a.register("ImpactPhysics",c,"impactPhysics"),t.exports=c},function(t,e,n){var i=n(450),r=n(1262),s=n(1394),o=n(1395);t.exports=function(t,e,n){var a=null;e.collides===i.LITE||n.collides===i.FIXED?a=e:n.collides!==i.LITE&&e.collides!==i.FIXED||(a=n),e.last.x+e.size.x>n.last.x&&e.last.x<n.last.x+n.size.x?(e.last.y<n.last.y?o(t,e,n,a):o(t,n,e,a),e.collideWith(n,"y"),n.collideWith(e,"y"),t.emit(r.COLLIDE,e,n,"y")):e.last.y+e.size.y>n.last.y&&e.last.y<n.last.y+n.size.y&&(e.last.x<n.last.x?s(t,e,n,a):s(t,n,e,a),e.collideWith(n,"x"),n.collideWith(e,"x"),t.emit(r.COLLIDE,e,n,"x"))}},function(t,e){t.exports=function(t,e,n,i){var r=e.pos.x+e.size.x-n.pos.x;if(i){i.vel.x=-i.vel.x*i.bounciness+(e===i?n:e).vel.x;var s=t.collisionMap.trace(i.pos.x,i.pos.y,i===e?-r:r,0,i.size.x,i.size.y);i.pos.x=s.pos.x}else{var o=(e.vel.x-n.vel.x)/2;e.vel.x=-o,n.vel.x=o;var a=t.collisionMap.trace(e.pos.x,e.pos.y,-r/2,0,e.size.x,e.size.y);e.pos.x=Math.floor(a.pos.x);var u=t.collisionMap.trace(n.pos.x,n.pos.y,r/2,0,n.size.x,n.size.y);n.pos.x=Math.ceil(u.pos.x)}}},function(t,e){t.exports=function(t,e,n,i){var r,s,o=e.pos.y+e.size.y-n.pos.y;if(i){var a=e===i?n:e;i.vel.y=-i.vel.y*i.bounciness+a.vel.y,r=0,i===e&&Math.abs(i.vel.y-a.vel.y)<i.minBounceVelocity&&(i.standing=!0,r=a.vel.x*t.delta);var u=t.collisionMap.trace(i.pos.x,i.pos.y,r,i===e?-o:o,i.size.x,i.size.y);i.pos.y=u.pos.y,i.pos.x=u.pos.x}else if(t.gravity&&(n.standing||e.vel.y>0))s=t.collisionMap.trace(e.pos.x,e.pos.y,0,-(e.pos.y+e.size.y-n.pos.y),e.size.x,e.size.y),e.pos.y=s.pos.y,e.bounciness>0&&e.vel.y>e.minBounceVelocity?e.vel.y*=-e.bounciness:(e.standing=!0,e.vel.y=0);else{var l=(e.vel.y-n.vel.y)/2;e.vel.y=-l,n.vel.y=l,s=t.collisionMap.trace(e.pos.x,e.pos.y,r=n.vel.x*t.delta,-o/2,e.size.x,e.size.y),e.pos.y=s.pos.y;var c=t.collisionMap.trace(n.pos.x,n.pos.y,0,o/2,n.size.x,n.size.y);n.pos.y=c.pos.y}}},function(t,e,n){t.exports={Factory:n(1359),Image:n(1363),Matter:n(1269),MatterPhysics:n(1426),PolyDecomp:n(1360),Sprite:n(1364),TileBody:n(1266),PhysicsEditorParser:n(1362),World:n(1370)}},function(t,e,n){var i=n(491),r=n(2),s=n(3);t.exports=function(t,e,n){void 0===n&&(n={});var o=e.x,a=e.y;if(e.body={temp:!0,position:{x:o,y:a}},[i.Bounce,i.Collision,i.Force,i.Friction,i.Gravity,i.Mass,i.Sensor,i.SetBody,i.Sleep,i.Static,i.Transform,i.Velocity].forEach(function(t){for(var n in t)(i=t[n]).get&&"function"==typeof i.get||i.set&&"function"==typeof i.set?Object.defineProperty(e,n,{get:t[n].get,set:t[n].set}):Object.defineProperty(e,n,{value:t[n]});var i}),e.world=t,e._tempVec2=new s(o,a),n.hasOwnProperty("type")&&"body"===n.type)e.setExistingBody(n,!0);else{var u=r(n,"shape",null);u||(u="rectangle"),e.setBody(u,n)}return e}},function(t,e){t.exports={setBounce:function(t){return this.body.restitution=t,this}}},function(t,e){t.exports={setCollisionCategory:function(t){return this.body.collisionFilter.category=t,this},setCollisionGroup:function(t){return this.body.collisionFilter.group=t,this},setCollidesWith:function(t){var e=0;if(Array.isArray(t))for(var n=0;n<t.length;n++)e|=t[n];else e=t;return this.body.collisionFilter.mask=e,this}}},function(t,e,n){var i=n(62);t.exports={applyForce:function(t){return this._tempVec2.set(this.body.position.x,this.body.position.y),i.applyForce(this.body,this._tempVec2,t),this},applyForceFrom:function(t,e){return i.applyForce(this.body,t,e),this},thrust:function(t){var e=this.body.angle;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustLeft:function(t){var e=this.body.angle-Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustRight:function(t){var e=this.body.angle+Math.PI/2;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this},thrustBack:function(t){var e=this.body.angle-Math.PI;return this._tempVec2.set(t*Math.cos(e),t*Math.sin(e)),i.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2),this}}},function(t,e){t.exports={setFriction:function(t,e,n){return this.body.friction=t,void 0!==e&&(this.body.frictionAir=e),void 0!==n&&(this.body.frictionStatic=n),this},setFrictionAir:function(t){return this.body.frictionAir=t,this},setFrictionStatic:function(t){return this.body.frictionStatic=t,this}}},function(t,e){t.exports={setIgnoreGravity:function(t){return this.body.ignoreGravity=t,this}}},function(t,e,n){var i=n(62),r=n(3);t.exports={setMass:function(t){return i.setMass(this.body,t),this},setDensity:function(t){return i.setDensity(this.body,t),this},centerOfMass:{get:function(){return new r(this.body.render.sprite.xOffset*this.width,this.body.render.sprite.yOffset*this.height)}}}},function(t,e,n){var i=n(62);t.exports={setStatic:function(t){return i.setStatic(this.body,t),this},isStatic:function(){return this.body.isStatic}}},function(t,e){t.exports={setSensor:function(t){return this.body.isSensor=t,this},isSensor:function(){return this.body.isSensor}}},function(t,e,n){var i=n(135),r=n(62),s=n(2),o=n(1362),a=n(86),u={setRectangle:function(t,e,n){return this.setBody({type:"rectangle",width:t,height:e},n)},setCircle:function(t,e){return this.setBody({type:"circle",radius:t},e)},setPolygon:function(t,e,n){return this.setBody({type:"polygon",sides:e,radius:t},n)},setTrapezoid:function(t,e,n,i){return this.setBody({type:"trapezoid",width:t,height:e,slope:n},i)},setExistingBody:function(t,e){void 0===e&&(e=!0),this.body&&this.world.remove(this.body),this.body=t;for(var n=0;n<t.parts.length;n++)t.parts[n].gameObject=this;var i=this;return t.destroy=function(){i.world.remove(i.body),i.body.gameObject=null},e&&this.world.add(t),this._originComponent&&this.setOrigin(t.render.sprite.xOffset,t.render.sprite.yOffset),this},setBody:function(t,e){if(!t)return this;var n;"string"==typeof t&&(t={type:t});var u=s(t,"type","rectangle"),l=s(t,"x",this._tempVec2.x),c=s(t,"y",this._tempVec2.y),h=s(t,"width",this.width),d=s(t,"height",this.height);switch(u){case"rectangle":n=i.rectangle(l,c,h,d,e);break;case"circle":var f=s(t,"radius",Math.max(h,d)/2),p=s(t,"maxSides",25);n=i.circle(l,c,f,e,p);break;case"trapezoid":var m=s(t,"slope",.5);n=i.trapezoid(l,c,h,d,m,e);break;case"polygon":var g=s(t,"sides",5),y=s(t,"radius",Math.max(h,d)/2);n=i.polygon(l,c,g,y,e);break;case"fromVertices":case"fromVerts":var v=s(t,"verts",null);if(v)if("string"==typeof v&&(v=a.fromPath(v)),this.body&&!this.body.hasOwnProperty("temp"))r.setVertices(this.body,v),n=this.body;else{var b=s(t,"flagInternal",!1),x=s(t,"removeCollinear",.01),w=s(t,"minimumArea",10);n=i.fromVertices(l,c,v,e,b,x,w)}break;case"fromPhysicsEditor":n=o.parseBody(l,c,h,d,t)}return n&&this.setExistingBody(n,t.addToWorld),this}};t.exports=u},function(t,e,n){var i=n(1265),r=n(233),s={setSleepThreshold:function(t){return void 0===t&&(t=60),this.body.sleepThreshold=t,this},setSleepEvents:function(t,e){return this.setSleepStartEvent(t),this.setSleepEndEvent(e),this},setSleepStartEvent:function(t){if(t){var e=this.world;r.on(this.body,"sleepStart",function(t){e.emit(i.SLEEP_START,t,this)})}else r.off(this.body,"sleepStart");return this},setSleepEndEvent:function(t){if(t){var e=this.world;r.on(this.body,"sleepEnd",function(t){e.emit(i.SLEEP_END,t,this)})}else r.off(this.body,"sleepEnd");return this}};t.exports=s},function(t,e){t.exports="afterupdate"},function(t,e){t.exports="beforeupdate"},function(t,e){t.exports="collisionactive"},function(t,e){t.exports="collisionend"},function(t,e){t.exports="collisionstart"},function(t,e){t.exports="dragend"},function(t,e){t.exports="drag"},function(t,e){t.exports="dragstart"},function(t,e){t.exports="pause"},function(t,e){t.exports="resume"},function(t,e){t.exports="sleepend"},function(t,e){t.exports="sleepstart"},function(t,e,n){var i=n(62),r=n(23),s=n(229),o=n(230),a={x:{get:function(){return this.body.position.x},set:function(t){this._tempVec2.set(t,this.y),i.setPosition(this.body,this._tempVec2)}},y:{get:function(){return this.body.position.y},set:function(t){this._tempVec2.set(this.x,t),i.setPosition(this.body,this._tempVec2)}},scaleX:{get:function(){return this._scaleX},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleX=t,0===this._scaleX?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,t,this._scaleY)}},scaleY:{get:function(){return this._scaleY},set:function(t){var e=1/this._scaleX,n=1/this._scaleY;this._scaleY=t,0===this._scaleY?this.renderFlags&=-5:this.renderFlags|=4,i.scale(this.body,e,n),i.scale(this.body,this._scaleX,t)}},angle:{get:function(){return o(this.body.angle*r.RAD_TO_DEG)},set:function(t){this.rotation=o(t)*r.DEG_TO_RAD}},rotation:{get:function(){return this.body.angle},set:function(t){this._rotation=s(t),i.setAngle(this.body,this._rotation)}},setPosition:function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._tempVec2.set(t,e),i.setPosition(this.body,this._tempVec2),this},setRotation:function(t){return void 0===t&&(t=0),this._rotation=s(t),i.setAngle(this.body,t),this},setFixedRotation:function(){return i.setInertia(this.body,1/0),this},setAngle:function(t){return void 0===t&&(t=0),this.angle=t,i.setAngle(this.body,this.rotation),this},setScale:function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=t);var r=1/this._scaleX,s=1/this._scaleY;return this._scaleX=t,this._scaleY=e,i.scale(this.body,r,s,n),i.scale(this.body,t,e,n),this}};t.exports=a},function(t,e,n){var i=n(62);t.exports={setAngularVelocity:function(t){return i.setAngularVelocity(this.body,t),this},setVelocityX:function(t){return this._tempVec2.set(t,this.body.velocity.y),i.setVelocity(this.body,this._tempVec2),this},setVelocityY:function(t){return this._tempVec2.set(this.body.velocity.x,t),i.setVelocity(this.body,this._tempVec2),this},setVelocity:function(t,e){return this._tempVec2.set(t,e),i.setVelocity(this.body,this._tempVec2),this}}},function(t,e,n){var i=n(102),r=n(0),s=n(213),o=n(234),a=n(1267),u=n(1265),l=n(53),c=n(106),h=n(452),d=n(3),f=n(86),p=new r({initialize:function(t,e,n){void 0===n&&(n={}),this.scene=t,this.world=e,this.camera=null,this.pointer=null,this.active=!0,this.position=new d,this.body=null,this.part=null,this.constraint=o.create(c(n,{label:"Pointer Constraint",pointA:{x:0,y:0},pointB:{x:0,y:0},damping:0,length:.01,stiffness:.1,angularStiffness:1,collisionFilter:{category:1,mask:4294967295,group:0}})),this.world.on(u.BEFORE_UPDATE,this.update,this),t.sys.input.on(l.POINTER_DOWN,this.onDown,this)},onDown:function(t){this.pointer||this.getBody(t)&&(this.pointer=t,this.camera=t.camera)},getBody:function(t){var e=this.position,n=this.constraint;t.camera.getWorldPoint(t.x,t.y,e);for(var r=s.allBodies(this.world.localWorld),o=0;o<r.length;o++){var l=r[o];if(!l.ignorePointer&&i.contains(l.bounds,e)&&a.canCollide(l.collisionFilter,n.collisionFilter)&&this.hitTestBody(l,e))return this.world.emit(u.DRAG_START,this.body,this.part,this),!0}return!1},hitTestBody:function(t,e){for(var n=this.constraint,i=t.parts.length>1?1:0;i<t.parts.length;i++){var r=t.parts[i];if(f.contains(r.vertices,e))return n.bodyB=t,n.pointA.x=e.x,n.pointA.y=e.y,n.pointB.x=e.x-t.position.x,n.pointB.y=e.y-t.position.y,n.angleB=t.angle,h.set(t,!1),this.part=r,this.body=t,!0}return!1},update:function(){var t=this.body,e=this.pointer;if(this.active&&e&&t)if(e.isDown){var n=this.position,i=this.constraint;this.camera.getWorldPoint(e.x,e.y,n),h.set(t,!1),i.pointA.x=n.x,i.pointA.y=n.y,this.world.emit(u.DRAG,t,this)}else this.stopDrag()},stopDrag:function(){var t=this.body,e=this.constraint;t&&(this.world.emit(u.DRAG_END,t,this),this.pointer=null,this.body=null,this.part=null,e.bodyB=null)},destroy:function(){this.world.removeConstraint(this.constraint),this.pointer=null,this.constraint=null,this.body=null,this.part=null,this.world.off(u.BEFORE_UPDATE,this.update),this.scene.sys.input.off(l.POINTER_DOWN,this.onDown,this)}});t.exports=p},function(t,e,n){var i={};t.exports=i;var r=n(101),s=n(1268),o=n(102),a=n(135),u=n(86);i.collides=function(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i];if(o.overlaps(r.bounds,t.bounds))for(var a=1===r.parts.length?0:1;a<r.parts.length;a++){var u=r.parts[a];if(o.overlaps(u.bounds,t.bounds)){var l=s.collides(u,t);if(l.collided){n.push(l);break}}}}return n},i.ray=function(t,e,n,s){s=s||1e-100;for(var o=r.angle(e,n),u=r.magnitude(r.sub(e,n)),l=a.rectangle(.5*(n.x+e.x),.5*(n.y+e.y),u,s,{angle:o}),c=i.collides(l,t),h=0;h<c.length;h+=1){var d=c[h];d.body=d.bodyB=d.bodyA}return c},i.region=function(t,e,n){for(var i=[],r=0;r<t.length;r++){var s=t[r],a=o.overlaps(s.bounds,e);(a&&!n||!a&&n)&&i.push(s)}return i},i.point=function(t,e){for(var n=[],i=0;i<t.length;i++){var r=t[i];if(o.contains(r.bounds,e))for(var s=1===r.parts.length?0:1;s<r.parts.length;s++){var a=r.parts[s];if(o.contains(a.bounds,e)&&u.contains(a.vertices,e)){n.push(r);break}}}return n}},function(t,e,n){var i={};t.exports=i;var r=n(213),s=n(37);i.create=function(t){return s.extend({extended:!1,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:1e-4,midEff:1e-4,broadEff:1e-4,collisions:0,buckets:0,bodies:0,pairs:0},!1,t)},i.reset=function(t){t.extended&&(t.narrowDetections=0,t.narrowphaseTests=0,t.narrowReuse=0,t.narrowReuseCount=0,t.midphaseTests=0,t.broadphaseTests=0,t.narrowEff=0,t.midEff=0,t.broadEff=0,t.collisions=0,t.buckets=0,t.pairs=0,t.bodies=0)},i.update=function(t,e){if(t.extended){var n=r.allBodies(e.world);t.collisions=t.narrowDetections,t.pairs=e.pairs.list.length,t.bodies=n.length,t.midEff=(t.narrowDetections/(t.midphaseTests||1)).toFixed(2),t.narrowEff=(t.narrowDetections/(t.narrowphaseTests||1)).toFixed(2),t.broadEff=(1-t.broadphaseTests/(n.length||1)).toFixed(2),t.narrowReuse=(t.narrowReuseCount/(t.narrowphaseTests||1)).toFixed(2)}}},function(t,e,n){var i={};t.exports=i,n(102);var r=n(37);i.pathToVertices=function(t,e){"undefined"==typeof window||"SVGPathSeg"in window||r.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,s,o,a,u,l,c,h,d,f,p,m=[],g=0,y=0,v=0;e=e||15;var b=function(t,e,n){var i=n%2==1&&n>1;if(!d||t!=d.x||e!=d.y){d&&i?(f=d.x,p=d.y):(f=0,p=0);var r={x:f+t,y:p+e};!i&&d||(d=r),m.push(r),y=f+t,v=p+e}},x=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":y=t.x,v=t.y;break;case"H":y=t.x;break;case"V":v=t.y}b(y,v,t.pathSegType)}};for(i._svgPathToAbsolute(t),o=t.getTotalLength(),l=[],n=0;n<t.pathSegList.numberOfItems;n+=1)l.push(t.pathSegList.getItem(n));for(c=l.concat();g<o;){if((u=l[t.getPathSegAtLength(g)])!=h){for(;c.length&&c[0]!=u;)x(c.shift());h=u}switch(u.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=t.getPointAtLength(g),b(a.x,a.y,0)}g+=e}for(n=0,s=c.length;n<s;++n)x(c[n]);return m},i._svgPathToAbsolute=function(t){for(var e,n,i,r,s,o,a=t.pathSegList,u=0,l=0,c=a.numberOfItems,h=0;h<c;++h){var d=a.getItem(h),f=d.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(f))"x"in d&&(u=d.x),"y"in d&&(l=d.y);else switch("x1"in d&&(i=u+d.x1),"x2"in d&&(s=u+d.x2),"y1"in d&&(r=l+d.y1),"y2"in d&&(o=l+d.y2),"x"in d&&(u+=d.x),"y"in d&&(l+=d.y),f){case"m":a.replaceItem(t.createSVGPathSegMovetoAbs(u,l),h);break;case"l":a.replaceItem(t.createSVGPathSegLinetoAbs(u,l),h);break;case"h":a.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(u),h);break;case"v":a.replaceItem(t.createSVGPathSegLinetoVerticalAbs(l),h);break;case"c":a.replaceItem(t.createSVGPathSegCurvetoCubicAbs(u,l,i,r,s,o),h);break;case"s":a.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(u,l,s,o),h);break;case"q":a.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(u,l,i,r),h);break;case"t":a.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(u,l),h);break;case"a":a.replaceItem(t.createSVGPathSegArcAbs(u,l,d.r1,d.r2,d.angle,d.largeArcFlag,d.sweepFlag),h);break;case"z":case"Z":u=e,l=n}"M"!=f&&"m"!=f||(e=u,n=l)}}},function(t,e,n){var i=n(62),r=n(135),s=n(0),o=n(1359),a=n(2),u=n(6),l=n(1427),c=n(1365),h=n(1428),d=n(106),f=n(1270),p=n(20),m=n(21),g=n(1370),y=n(86),v=new s({initialize:function(t){this.scene=t,this.systems=t.sys,this.config=this.getConfig(),this.verts=y,this.body=i,this.bodies=r,u(this.config,"plugins.attractors",!1)&&(f.register(l),f.use(c,l)),u(this.config,"plugins.wrap",!1)&&(f.register(h),f.use(c,h)),t.sys.events.once(m.BOOT,this.boot,this),t.sys.events.on(m.START,this.start,this)},boot:function(){this.world=new g(this.scene,this.config),this.add=new o(this.world),this.systems.events.once(m.DESTROY,this.destroy,this)},start:function(){this.world||(this.world=new g(this.scene,this.config),this.add=new o(this.world));var t=this.systems.events;t.on(m.UPDATE,this.world.update,this.world),t.on(m.POST_UPDATE,this.world.postUpdate,this.world),t.once(m.SHUTDOWN,this.shutdown,this)},getConfig:function(){var t=this.systems.game.config.physics;return d(a(this.systems.settings.physics,"matter",{}),a(t,"matter",{}))},enableAttractorPlugin:function(){return f.register(l),f.use(c,l),this},enableWrapPlugin:function(){return f.register(h),f.use(c,h),this},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},set60Hz:function(){return this.world.getDelta=this.world.update60Hz,this.world.autoUpdate=!0,this},set30Hz:function(){return this.world.getDelta=this.world.update30Hz,this.world.autoUpdate=!0,this},step:function(t,e){this.world.step(t,e)},shutdown:function(){var t=this.systems.events;this.world&&(t.off(m.UPDATE,this.world.update,this.world),t.off(m.POST_UPDATE,this.world.postUpdate,this.world)),t.off(m.SHUTDOWN,this.shutdown,this),this.add&&this.add.destroy(),this.world&&this.world.destroy(),this.add=null,this.world=null},destroy:function(){this.shutdown(),this.scene.sys.events.off(m.START,this.start,this),this.scene=null,this.systems=null}});p.register("MatterPhysics",v,"matterPhysics"),t.exports=v},function(t,e,n){var i=n(1269),r={name:"matter-attractors",version:"0.1.7",for:"matter-js@^0.13.1",silent:!0,install:function(t){t.after("Body.create",function(){r.Body.init(this)}),t.before("Engine.update",function(t){r.Engine.update(t)})},Body:{init:function(t){t.plugin.attractors=t.plugin.attractors||[]}},Engine:{update:function(t){for(var e=i.Composite.allBodies(t.world),n=0;n<e.length;n+=1){var r=e[n],s=r.plugin.attractors;if(s&&s.length>0)for(var o=n+1;o<e.length;o+=1)for(var a=e[o],u=0;u<s.length;u+=1){var l=s[u],c=l;i.Common.isFunction(l)&&(c=l(r,a)),c&&i.Body.applyForce(a,a.position,c)}}}},Attractors:{gravityConstant:.001,gravity:function(t,e){var n=i.Vector.sub(e.position,t.position),s=i.Vector.magnitudeSquared(n)||1e-4,o=i.Vector.normalise(n),a=i.Vector.mult(o,t.mass*e.mass/s*-r.Attractors.gravityConstant);i.Body.applyForce(t,t.position,i.Vector.neg(a)),i.Body.applyForce(e,e.position,a)}}};t.exports=r},function(t,e,n){var i=n(1269),r={name:"matter-wrap",version:"0.1.4",for:"matter-js@^0.13.1",silent:!0,install:function(t){t.after("Engine.update",function(){r.Engine.update(this)})},Engine:{update:function(t){for(var e=t.world,n=i.Composite.allBodies(e),s=i.Composite.allComposites(e),o=0;o<n.length;o+=1){var a=n[o];a.plugin.wrap&&r.Body.wrap(a,a.plugin.wrap)}for(o=0;o<s.length;o+=1){var u=s[o];u.plugin.wrap&&r.Composite.wrap(u,u.plugin.wrap)}}},Bounds:{wrap:function(t,e){var n=null,i=null;if(void 0!==e.min.x&&void 0!==e.max.x&&(t.min.x>e.max.x?n=e.min.x-t.max.x:t.max.x<e.min.x&&(n=e.max.x-t.min.x)),void 0!==e.min.y&&void 0!==e.max.y&&(t.min.y>e.max.y?i=e.min.y-t.max.y:t.max.y<e.min.y&&(i=e.max.y-t.min.y)),null!==n||null!==i)return{x:n||0,y:i||0}}},Body:{wrap:function(t,e){var n=r.Bounds.wrap(t.bounds,e);return n&&i.Body.translate(t,n),n}},Composite:{bounds:function(t){for(var e=i.Composite.allBodies(t),n=[],r=0;r<e.length;r+=1){var s=e[r];n.push(s.bounds.min,s.bounds.max)}return i.Bounds.create(n)},wrap:function(t,e){var n=r.Bounds.wrap(r.Composite.bounds(t),e);return n&&i.Composite.translate(t,n),n}}};t.exports=r},function(t,e,n){t.exports={Canvas:n(1430),Snapshot:n(1431),WebGL:n(1432)}},function(t,e,n){t.exports={CanvasRenderer:n(483),GetBlendModes:n(485),SetTransform:n(26)}},function(t,e,n){t.exports={Canvas:n(484),WebGL:n(487)}},function(t,e,n){t.exports={Utils:n(10),WebGLPipeline:n(231),WebGLRenderer:n(486),Pipelines:n(1433),BYTE:0,SHORT:1,UNSIGNED_BYTE:2,UNSIGNED_SHORT:3,FLOAT:4}},function(t,e,n){t.exports={BitmapMaskPipeline:n(488),ForwardDiffuseLightPipeline:n(489),TextureTintPipeline:n(232),ModelViewProjection:n(490)}}])}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],e):e(t.bootstrap={},t.jQuery,t.Popper)}(this,function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){s(t,e,n[e])})}return t}e=e&&e.hasOwnProperty("default")?e.default:e,n=n&&n.hasOwnProperty("default")?n.default:n;var a=function(t){var e="transitionend",n={TRANSITION_END:"bsTransitionEnd",getUID:function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},getSelectorFromElement:function(e){var n=e.getAttribute("data-target");n&&"#"!==n||(n=e.getAttribute("href")||"");try{return t(document).find(n).length>0?n:null}catch(i){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var n=t(e).css("transition-duration");return parseFloat(n)?(n=n.split(",")[0],1e3*parseFloat(n)):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(n){t(n).trigger(e)},supportsTransitionEnd:function(){return Boolean(e)},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,i){for(var r in i)if(Object.prototype.hasOwnProperty.call(i,r)){var s=i[r],o=e[r],a=o&&n.isElement(o)?"element":{}.toString.call(o).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(s).test(a))throw new Error(t.toUpperCase()+': Option "'+r+'" provided type "'+a+'" but expected type "'+s+'".')}}};return t.fn.emulateTransitionEnd=function(e){var i=this,r=!1;return t(this).one(n.TRANSITION_END,function(){r=!0}),setTimeout(function(){r||n.triggerTransitionEnd(i)},e),this},t.event.special[n.TRANSITION_END]={bindType:e,delegateType:e,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}},n}(e),u=function(t){var e="bs.alert",n=t.fn.alert,i=function(){function n(t){this._element=t}var i=n.prototype;return i.close=function(t){var e=this._getRootElement(t=t||this._element);this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},i.dispose=function(){t.removeData(this._element,e),this._element=null},i._getRootElement=function(e){var n=a.getSelectorFromElement(e),i=!1;return n&&(i=t(n)[0]),i||(i=t(e).closest(".alert")[0]),i},i._triggerCloseEvent=function(e){var n=t.Event("close.bs.alert");return t(e).trigger(n),n},i._removeElement=function(e){var n=this;if(t(e).removeClass("show"),t(e).hasClass("fade")){var i=a.getTransitionDurationFromElement(e);t(e).one(a.TRANSITION_END,function(t){return n._destroyElement(e,t)}).emulateTransitionEnd(i)}else this._destroyElement(e)},i._destroyElement=function(e){t(e).detach().trigger("closed.bs.alert").remove()},n._jQueryInterface=function(i){return this.each(function(){var r=t(this),s=r.data(e);s||(s=new n(this),r.data(e,s)),"close"===i&&s[i](this)})},n._handleDismiss=function(t){return function(e){e&&e.preventDefault(),t.close(this)}},r(n,null,[{key:"VERSION",get:function(){return"4.1.0"}}]),n}();return t(document).on("click.bs.alert.data-api",'[data-dismiss="alert"]',i._handleDismiss(new i)),t.fn.alert=i._jQueryInterface,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,i._jQueryInterface},i}(e),l=function(t){var e="button",n="bs.button",i=t.fn[e],s="active",o='[data-toggle^="button"]',a=".btn",u=function(){function e(t){this._element=t}var i=e.prototype;return i.toggle=function(){var e=!0,n=!0,i=t(this._element).closest('[data-toggle="buttons"]')[0];if(i){var r=t(this._element).find("input")[0];if(r){if("radio"===r.type)if(r.checked&&t(this._element).hasClass(s))e=!1;else{var o=t(i).find(".active")[0];o&&t(o).removeClass(s)}if(e){if(r.hasAttribute("disabled")||i.hasAttribute("disabled")||r.classList.contains("disabled")||i.classList.contains("disabled"))return;r.checked=!t(this._element).hasClass(s),t(r).trigger("change")}r.focus(),n=!1}}n&&this._element.setAttribute("aria-pressed",!t(this._element).hasClass(s)),e&&t(this._element).toggleClass(s)},i.dispose=function(){t.removeData(this._element,n),this._element=null},e._jQueryInterface=function(i){return this.each(function(){var r=t(this).data(n);r||(r=new e(this),t(this).data(n,r)),"toggle"===i&&r[i]()})},r(e,null,[{key:"VERSION",get:function(){return"4.1.0"}}]),e}();return t(document).on("click.bs.button.data-api",o,function(e){e.preventDefault();var n=e.target;t(n).hasClass("btn")||(n=t(n).closest(a)),u._jQueryInterface.call(t(n),"toggle")}).on("focus.bs.button.data-api blur.bs.button.data-api",o,function(e){var n=t(e.target).closest(a)[0];t(n).toggleClass("focus",/^focus(in)?$/.test(e.type))}),t.fn[e]=u._jQueryInterface,t.fn[e].Constructor=u,t.fn[e].noConflict=function(){return t.fn[e]=i,u._jQueryInterface},u}(e),c=function(t){var e="carousel",n="bs.carousel",i="."+n,s=t.fn[e],u={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0},l={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean"},c="next",h="prev",d={SLIDE:"slide"+i,SLID:"slid"+i,KEYDOWN:"keydown"+i,MOUSEENTER:"mouseenter"+i,MOUSELEAVE:"mouseleave"+i,TOUCHEND:"touchend"+i,LOAD_DATA_API:"load.bs.carousel.data-api",CLICK_DATA_API:"click.bs.carousel.data-api"},f="active",p=".active.carousel-item",m=function(){function s(e,n){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this._config=this._getConfig(n),this._element=t(e)[0],this._indicatorsElement=t(this._element).find(".carousel-indicators")[0],this._addEventListeners()}var m=s.prototype;return m.next=function(){this._isSliding||this._slide(c)},m.nextWhenVisible=function(){!document.hidden&&t(this._element).is(":visible")&&"hidden"!==t(this._element).css("visibility")&&this.next()},m.prev=function(){this._isSliding||this._slide(h)},m.pause=function(e){e||(this._isPaused=!0),t(this._element).find(".carousel-item-next, .carousel-item-prev")[0]&&(a.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},m.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},m.to=function(e){var n=this;this._activeElement=t(this._element).find(p)[0];var i=this._getItemIndex(this._activeElement);if(!(e>this._items.length-1||e<0))if(this._isSliding)t(this._element).one(d.SLID,function(){return n.to(e)});else{if(i===e)return this.pause(),void this.cycle();this._slide(e>i?c:h,this._items[e])}},m.dispose=function(){t(this._element).off(i),t.removeData(this._element,n),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},m._getConfig=function(t){return t=o({},u,t),a.typeCheckConfig(e,t,l),t},m._addEventListeners=function(){var e=this;this._config.keyboard&&t(this._element).on(d.KEYDOWN,function(t){return e._keydown(t)}),"hover"===this._config.pause&&(t(this._element).on(d.MOUSEENTER,function(t){return e.pause(t)}).on(d.MOUSELEAVE,function(t){return e.cycle(t)}),"ontouchstart"in document.documentElement&&t(this._element).on(d.TOUCHEND,function(){e.pause(),e.touchTimeout&&clearTimeout(e.touchTimeout),e.touchTimeout=setTimeout(function(t){return e.cycle(t)},500+e._config.interval)}))},m._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next()}},m._getItemIndex=function(e){return this._items=t.makeArray(t(e).parent().find(".carousel-item")),this._items.indexOf(e)},m._getItemByDirection=function(t,e){var n=t===c,i=t===h,r=this._getItemIndex(e);if((i&&0===r||n&&r===this._items.length-1)&&!this._config.wrap)return e;var s=(r+(t===h?-1:1))%this._items.length;return-1===s?this._items[this._items.length-1]:this._items[s]},m._triggerSlideEvent=function(e,n){var i=this._getItemIndex(e),r=this._getItemIndex(t(this._element).find(p)[0]),s=t.Event(d.SLIDE,{relatedTarget:e,direction:n,from:r,to:i});return t(this._element).trigger(s),s},m._setActiveIndicatorElement=function(e){if(this._indicatorsElement){t(this._indicatorsElement).find(".active").removeClass(f);var n=this._indicatorsElement.children[this._getItemIndex(e)];n&&t(n).addClass(f)}},m._slide=function(e,n){var i,r,s,o=this,u=t(this._element).find(p)[0],l=this._getItemIndex(u),h=n||u&&this._getItemByDirection(e,u),m=this._getItemIndex(h),g=Boolean(this._interval);if(e===c?(i="carousel-item-left",r="carousel-item-next",s="left"):(i="carousel-item-right",r="carousel-item-prev",s="right"),h&&t(h).hasClass(f))this._isSliding=!1;else if(!this._triggerSlideEvent(h,s).isDefaultPrevented()&&u&&h){this._isSliding=!0,g&&this.pause(),this._setActiveIndicatorElement(h);var y=t.Event(d.SLID,{relatedTarget:h,direction:s,from:l,to:m});if(t(this._element).hasClass("slide")){t(h).addClass(r),a.reflow(h),t(u).addClass(i),t(h).addClass(i);var v=a.getTransitionDurationFromElement(u);t(u).one(a.TRANSITION_END,function(){t(h).removeClass(i+" "+r).addClass(f),t(u).removeClass("active "+r+" "+i),o._isSliding=!1,setTimeout(function(){return t(o._element).trigger(y)},0)}).emulateTransitionEnd(v)}else t(u).removeClass(f),t(h).addClass(f),this._isSliding=!1,t(this._element).trigger(y);g&&this.cycle()}},s._jQueryInterface=function(e){return this.each(function(){var i=t(this).data(n),r=o({},u,t(this).data());"object"==typeof e&&(r=o({},r,e));var a="string"==typeof e?e:r.slide;if(i||(i=new s(this,r),t(this).data(n,i)),"number"==typeof e)i.to(e);else if("string"==typeof a){if(void 0===i[a])throw new TypeError('No method named "'+a+'"');i[a]()}else r.interval&&(i.pause(),i.cycle())})},s._dataApiClickHandler=function(e){var i=a.getSelectorFromElement(this);if(i){var r=t(i)[0];if(r&&t(r).hasClass("carousel")){var u=o({},t(r).data(),t(this).data()),l=this.getAttribute("data-slide-to");l&&(u.interval=!1),s._jQueryInterface.call(t(r),u),l&&t(r).data(n).to(l),e.preventDefault()}}},r(s,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return u}}]),s}();return t(document).on(d.CLICK_DATA_API,"[data-slide], [data-slide-to]",m._dataApiClickHandler),t(window).on(d.LOAD_DATA_API,function(){t('[data-ride="carousel"]').each(function(){var e=t(this);m._jQueryInterface.call(e,e.data())})}),t.fn[e]=m._jQueryInterface,t.fn[e].Constructor=m,t.fn[e].noConflict=function(){return t.fn[e]=s,m._jQueryInterface},m}(e),h=function(t){var e="collapse",n="bs.collapse",i="."+n,s=t.fn[e],u={toggle:!0,parent:""},l={toggle:"boolean",parent:"(string|element)"},c={SHOW:"show"+i,SHOWN:"shown"+i,HIDE:"hide"+i,HIDDEN:"hidden"+i,CLICK_DATA_API:"click.bs.collapse.data-api"},h="show",d="collapse",f="collapsing",p="collapsed",m="width",g='[data-toggle="collapse"]',y=function(){function i(e,n){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(n),this._triggerArray=t.makeArray(t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var i=t(g),r=0;r<i.length;r++){var s=i[r],o=a.getSelectorFromElement(s);null!==o&&t(o).filter(e).length>0&&(this._selector=o,this._triggerArray.push(s))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var s=i.prototype;return s.toggle=function(){t(this._element).hasClass(h)?this.hide():this.show()},s.show=function(){var e,r,s=this;if(!(this._isTransitioning||t(this._element).hasClass(h)||(this._parent&&0===(e=t.makeArray(t(this._parent).find(".show, .collapsing").filter('[data-parent="'+this._config.parent+'"]'))).length&&(e=null),e&&(r=t(e).not(this._selector).data(n))&&r._isTransitioning))){var o=t.Event(c.SHOW);if(t(this._element).trigger(o),!o.isDefaultPrevented()){e&&(i._jQueryInterface.call(t(e).not(this._selector),"hide"),r||t(e).data(n,null));var u=this._getDimension();t(this._element).removeClass(d).addClass(f),this._element.style[u]=0,this._triggerArray.length>0&&t(this._triggerArray).removeClass(p).attr("aria-expanded",!0),this.setTransitioning(!0);var l="scroll"+(u[0].toUpperCase()+u.slice(1)),m=a.getTransitionDurationFromElement(this._element);t(this._element).one(a.TRANSITION_END,function(){t(s._element).removeClass(f).addClass(d).addClass(h),s._element.style[u]="",s.setTransitioning(!1),t(s._element).trigger(c.SHOWN)}).emulateTransitionEnd(m),this._element.style[u]=this._element[l]+"px"}}},s.hide=function(){var e=this;if(!this._isTransitioning&&t(this._element).hasClass(h)){var n=t.Event(c.HIDE);if(t(this._element).trigger(n),!n.isDefaultPrevented()){var i=this._getDimension();if(this._element.style[i]=this._element.getBoundingClientRect()[i]+"px",a.reflow(this._element),t(this._element).addClass(f).removeClass(d).removeClass(h),this._triggerArray.length>0)for(var r=0;r<this._triggerArray.length;r++){var s=this._triggerArray[r],o=a.getSelectorFromElement(s);null!==o&&(t(o).hasClass(h)||t(s).addClass(p).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[i]="";var u=a.getTransitionDurationFromElement(this._element);t(this._element).one(a.TRANSITION_END,function(){e.setTransitioning(!1),t(e._element).removeClass(f).addClass(d).trigger(c.HIDDEN)}).emulateTransitionEnd(u)}}},s.setTransitioning=function(t){this._isTransitioning=t},s.dispose=function(){t.removeData(this._element,n),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},s._getConfig=function(t){return(t=o({},u,t)).toggle=Boolean(t.toggle),a.typeCheckConfig(e,t,l),t},s._getDimension=function(){return t(this._element).hasClass(m)?m:"height"},s._getParent=function(){var e=this,n=null;a.isElement(this._config.parent)?(n=this._config.parent,void 0!==this._config.parent.jquery&&(n=this._config.parent[0])):n=t(this._config.parent)[0];var r='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]';return t(n).find(r).each(function(t,n){e._addAriaAndCollapsedClass(i._getTargetFromElement(n),[n])}),n},s._addAriaAndCollapsedClass=function(e,n){if(e){var i=t(e).hasClass(h);n.length>0&&t(n).toggleClass(p,!i).attr("aria-expanded",i)}},i._getTargetFromElement=function(e){var n=a.getSelectorFromElement(e);return n?t(n)[0]:null},i._jQueryInterface=function(e){return this.each(function(){var r=t(this),s=r.data(n),a=o({},u,r.data(),"object"==typeof e&&e);if(!s&&a.toggle&&/show|hide/.test(e)&&(a.toggle=!1),s||(s=new i(this,a),r.data(n,s)),"string"==typeof e){if(void 0===s[e])throw new TypeError('No method named "'+e+'"');s[e]()}})},r(i,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return u}}]),i}();return t(document).on(c.CLICK_DATA_API,g,function(e){"A"===e.currentTarget.tagName&&e.preventDefault();var i=t(this),r=a.getSelectorFromElement(this);t(r).each(function(){var e=t(this),r=e.data(n)?"toggle":i.data();y._jQueryInterface.call(e,r)})}),t.fn[e]=y._jQueryInterface,t.fn[e].Constructor=y,t.fn[e].noConflict=function(){return t.fn[e]=s,y._jQueryInterface},y}(e),d=function(t){var e="dropdown",i="bs.dropdown",s="."+i,u=t.fn[e],l=new RegExp("38|40|27"),c={HIDE:"hide"+s,HIDDEN:"hidden"+s,SHOW:"show"+s,SHOWN:"shown"+s,CLICK:"click"+s,CLICK_DATA_API:"click.bs.dropdown.data-api",KEYDOWN_DATA_API:"keydown.bs.dropdown.data-api",KEYUP_DATA_API:"keyup.bs.dropdown.data-api"},h="disabled",d="show",f="dropdown-menu-right",p='[data-toggle="dropdown"]',m=".dropdown-menu",g={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic"},y={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string"},v=function(){function u(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var v=u.prototype;return v.toggle=function(){if(!this._element.disabled&&!t(this._element).hasClass(h)){var e=u._getParentFromElement(this._element),i=t(this._menu).hasClass(d);if(u._clearMenus(),!i){var r={relatedTarget:this._element},s=t.Event(c.SHOW,r);if(t(e).trigger(s),!s.isDefaultPrevented()){if(!this._inNavbar){if(void 0===n)throw new TypeError("Bootstrap dropdown require Popper.js (https://popper.js.org)");var o=this._element;"parent"===this._config.reference?o=e:a.isElement(this._config.reference)&&(o=this._config.reference,void 0!==this._config.reference.jquery&&(o=this._config.reference[0])),"scrollParent"!==this._config.boundary&&t(e).addClass("position-static"),this._popper=new n(o,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===t(e).closest(".navbar-nav").length&&t(document.body).children().on("mouseover",null,t.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),t(this._menu).toggleClass(d),t(e).toggleClass(d).trigger(t.Event(c.SHOWN,r))}}}},v.dispose=function(){t.removeData(this._element,i),t(this._element).off(s),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},v.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},v._addEventListeners=function(){var e=this;t(this._element).on(c.CLICK,function(t){t.preventDefault(),t.stopPropagation(),e.toggle()})},v._getConfig=function(n){return n=o({},this.constructor.Default,t(this._element).data(),n),a.typeCheckConfig(e,n,this.constructor.DefaultType),n},v._getMenuElement=function(){if(!this._menu){var e=u._getParentFromElement(this._element);this._menu=t(e).find(m)[0]}return this._menu},v._getPlacement=function(){var e=t(this._element).parent(),n="bottom-start";return e.hasClass("dropup")?(n="top-start",t(this._menu).hasClass(f)&&(n="top-end")):e.hasClass("dropright")?n="right-start":e.hasClass("dropleft")?n="left-start":t(this._menu).hasClass(f)&&(n="bottom-end"),n},v._detectNavbar=function(){return t(this._element).closest(".navbar").length>0},v._getPopperConfig=function(){var t=this,e={};"function"==typeof this._config.offset?e.fn=function(e){return e.offsets=o({},e.offsets,t._config.offset(e.offsets)||{}),e}:e.offset=this._config.offset;var n={placement:this._getPlacement(),modifiers:{offset:e,flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(n.modifiers.applyStyle={enabled:!1}),n},u._jQueryInterface=function(e){return this.each(function(){var n=t(this).data(i);if(n||(n=new u(this,"object"==typeof e?e:null),t(this).data(i,n)),"string"==typeof e){if(void 0===n[e])throw new TypeError('No method named "'+e+'"');n[e]()}})},u._clearMenus=function(e){if(!e||3!==e.which&&("keyup"!==e.type||9===e.which))for(var n=t.makeArray(t(p)),r=0;r<n.length;r++){var s=u._getParentFromElement(n[r]),o=t(n[r]).data(i),a={relatedTarget:n[r]};if(o){var l=o._menu;if(t(s).hasClass(d)&&!(e&&("click"===e.type&&/input|textarea/i.test(e.target.tagName)||"keyup"===e.type&&9===e.which)&&t.contains(s,e.target))){var h=t.Event(c.HIDE,a);t(s).trigger(h),h.isDefaultPrevented()||("ontouchstart"in document.documentElement&&t(document.body).children().off("mouseover",null,t.noop),n[r].setAttribute("aria-expanded","false"),t(l).removeClass(d),t(s).removeClass(d).trigger(t.Event(c.HIDDEN,a)))}}}},u._getParentFromElement=function(e){var n,i=a.getSelectorFromElement(e);return i&&(n=t(i)[0]),n||e.parentNode},u._dataApiKeydownHandler=function(e){if(!(/input|textarea/i.test(e.target.tagName)?32===e.which||27!==e.which&&(40!==e.which&&38!==e.which||t(e.target).closest(m).length):!l.test(e.which))&&(e.preventDefault(),e.stopPropagation(),!this.disabled&&!t(this).hasClass(h))){var n=u._getParentFromElement(this),i=t(n).hasClass(d);if((i||27===e.which&&32===e.which)&&(!i||27!==e.which&&32!==e.which)){var r=t(n).find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)").get();if(0!==r.length){var s=r.indexOf(e.target);38===e.which&&s>0&&s--,40===e.which&&s<r.length-1&&s++,s<0&&(s=0),r[s].focus()}}else{if(27===e.which){var o=t(n).find(p)[0];t(o).trigger("focus")}t(this).trigger("click")}}},r(u,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return g}},{key:"DefaultType",get:function(){return y}}]),u}();return t(document).on(c.KEYDOWN_DATA_API,p,v._dataApiKeydownHandler).on(c.KEYDOWN_DATA_API,m,v._dataApiKeydownHandler).on(c.CLICK_DATA_API+" "+c.KEYUP_DATA_API,v._clearMenus).on(c.CLICK_DATA_API,p,function(e){e.preventDefault(),e.stopPropagation(),v._jQueryInterface.call(t(this),"toggle")}).on(c.CLICK_DATA_API,".dropdown form",function(t){t.stopPropagation()}),t.fn[e]=v._jQueryInterface,t.fn[e].Constructor=v,t.fn[e].noConflict=function(){return t.fn[e]=u,v._jQueryInterface},v}(e),f=function(t){var e="bs.modal",n=t.fn.modal,i={backdrop:!0,keyboard:!0,focus:!0,show:!0},s={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},u="hidden.bs.modal",l="show.bs.modal",c="focusin.bs.modal",h="resize.bs.modal",d="click.dismiss.bs.modal",f="keydown.dismiss.bs.modal",p="mousedown.dismiss.bs.modal",m="modal-open",g="fade",y="show",v=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",b=function(){function n(e,n){this._config=this._getConfig(n),this._element=e,this._dialog=t(e).find(".modal-dialog")[0],this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._scrollbarWidth=0}var b=n.prototype;return b.toggle=function(t){return this._isShown?this.hide():this.show(t)},b.show=function(e){var n=this;if(!this._isTransitioning&&!this._isShown){t(this._element).hasClass(g)&&(this._isTransitioning=!0);var i=t.Event(l,{relatedTarget:e});t(this._element).trigger(i),this._isShown||i.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),t(document.body).addClass(m),this._setEscapeEvent(),this._setResizeEvent(),t(this._element).on(d,'[data-dismiss="modal"]',function(t){return n.hide(t)}),t(this._dialog).on(p,function(){t(n._element).one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(n._element)&&(n._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return n._showElement(e)}))}},b.hide=function(e){var n=this;if(e&&e.preventDefault(),!this._isTransitioning&&this._isShown){var i=t.Event("hide.bs.modal");if(t(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var r=t(this._element).hasClass(g);if(r&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),t(document).off(c),t(this._element).removeClass(y),t(this._element).off(d),t(this._dialog).off(p),r){var s=a.getTransitionDurationFromElement(this._element);t(this._element).one(a.TRANSITION_END,function(t){return n._hideModal(t)}).emulateTransitionEnd(s)}else this._hideModal()}}},b.dispose=function(){t.removeData(this._element,e),t(window,document,this._element,this._backdrop).off(".bs.modal"),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._scrollbarWidth=null},b.handleUpdate=function(){this._adjustDialog()},b._getConfig=function(t){return t=o({},i,t),a.typeCheckConfig("modal",t,s),t},b._showElement=function(e){var n=this,i=t(this._element).hasClass(g);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.scrollTop=0,i&&a.reflow(this._element),t(this._element).addClass(y),this._config.focus&&this._enforceFocus();var r=t.Event("shown.bs.modal",{relatedTarget:e}),s=function(){n._config.focus&&n._element.focus(),n._isTransitioning=!1,t(n._element).trigger(r)};if(i){var o=a.getTransitionDurationFromElement(this._element);t(this._dialog).one(a.TRANSITION_END,s).emulateTransitionEnd(o)}else s()},b._enforceFocus=function(){var e=this;t(document).off(c).on(c,function(n){document!==n.target&&e._element!==n.target&&0===t(e._element).has(n.target).length&&e._element.focus()})},b._setEscapeEvent=function(){var e=this;this._isShown&&this._config.keyboard?t(this._element).on(f,function(t){27===t.which&&(t.preventDefault(),e.hide())}):this._isShown||t(this._element).off(f)},b._setResizeEvent=function(){var e=this;this._isShown?t(window).on(h,function(t){return e.handleUpdate(t)}):t(window).off(h)},b._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._isTransitioning=!1,this._showBackdrop(function(){t(document.body).removeClass(m),e._resetAdjustments(),e._resetScrollbar(),t(e._element).trigger(u)})},b._removeBackdrop=function(){this._backdrop&&(t(this._backdrop).remove(),this._backdrop=null)},b._showBackdrop=function(e){var n=this,i=t(this._element).hasClass(g)?g:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&t(this._backdrop).addClass(i),t(this._backdrop).appendTo(document.body),t(this._element).on(d,function(t){n._ignoreBackdropClick?n._ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"===n._config.backdrop?n._element.focus():n.hide())}),i&&a.reflow(this._backdrop),t(this._backdrop).addClass(y),!e)return;if(!i)return void e();var r=a.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(a.TRANSITION_END,e).emulateTransitionEnd(r)}else if(!this._isShown&&this._backdrop){t(this._backdrop).removeClass(y);var s=function(){n._removeBackdrop(),e&&e()};if(t(this._element).hasClass(g)){var o=a.getTransitionDurationFromElement(this._backdrop);t(this._backdrop).one(a.TRANSITION_END,s).emulateTransitionEnd(o)}else s()}else e&&e()},b._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},b._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},b._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=t.left+t.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},b._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){t(v).each(function(n,i){var r=t(i)[0].style.paddingRight,s=t(i).css("padding-right");t(i).data("padding-right",r).css("padding-right",parseFloat(s)+e._scrollbarWidth+"px")}),t(".sticky-top").each(function(n,i){var r=t(i)[0].style.marginRight,s=t(i).css("margin-right");t(i).data("margin-right",r).css("margin-right",parseFloat(s)-e._scrollbarWidth+"px")}),t(".navbar-toggler").each(function(n,i){var r=t(i)[0].style.marginRight,s=t(i).css("margin-right");t(i).data("margin-right",r).css("margin-right",parseFloat(s)+e._scrollbarWidth+"px")});var n=document.body.style.paddingRight,i=t(document.body).css("padding-right");t(document.body).data("padding-right",n).css("padding-right",parseFloat(i)+this._scrollbarWidth+"px")}},b._resetScrollbar=function(){t(v).each(function(e,n){var i=t(n).data("padding-right");void 0!==i&&t(n).css("padding-right",i).removeData("padding-right")}),t(".sticky-top, .navbar-toggler").each(function(e,n){var i=t(n).data("margin-right");void 0!==i&&t(n).css("margin-right",i).removeData("margin-right")});var e=t(document.body).data("padding-right");void 0!==e&&t(document.body).css("padding-right",e).removeData("padding-right")},b._getScrollbarWidth=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},n._jQueryInterface=function(i,r){return this.each(function(){var s=t(this).data(e),a=o({},n.Default,t(this).data(),"object"==typeof i&&i);if(s||(s=new n(this,a),t(this).data(e,s)),"string"==typeof i){if(void 0===s[i])throw new TypeError('No method named "'+i+'"');s[i](r)}else a.show&&s.show(r)})},r(n,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return i}}]),n}();return t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i,r=this,s=a.getSelectorFromElement(this);s&&(i=t(s)[0]);var c=t(i).data(e)?"toggle":o({},t(i).data(),t(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||n.preventDefault();var h=t(i).one(l,function(e){e.isDefaultPrevented()||h.one(u,function(){t(r).is(":visible")&&r.focus()})});b._jQueryInterface.call(t(i),c,this)}),t.fn.modal=b._jQueryInterface,t.fn.modal.Constructor=b,t.fn.modal.noConflict=function(){return t.fn.modal=n,b._jQueryInterface},b}(e),p=function(t){var e="tooltip",i="bs.tooltip",s="."+i,u=t.fn[e],l=new RegExp("(^|\\s)bs-tooltip\\S+","g"),c={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)"},h={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},d={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent"},f="show",p="out",m={HIDE:"hide"+s,HIDDEN:"hidden"+s,SHOW:"show"+s,SHOWN:"shown"+s,INSERTED:"inserted"+s,CLICK:"click"+s,FOCUSIN:"focusin"+s,FOCUSOUT:"focusout"+s,MOUSEENTER:"mouseenter"+s,MOUSELEAVE:"mouseleave"+s},g="fade",y="show",v="hover",b="focus",x=function(){function u(t,e){if(void 0===n)throw new TypeError("Bootstrap tooltips require Popper.js (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var x=u.prototype;return x.enable=function(){this._isEnabled=!0},x.disable=function(){this._isEnabled=!1},x.toggleEnabled=function(){this._isEnabled=!this._isEnabled},x.toggle=function(e){if(this._isEnabled)if(e){var n=this.constructor.DATA_KEY,i=t(e.currentTarget).data(n);i||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(n,i)),i._activeTrigger.click=!i._activeTrigger.click,i._isWithActiveTrigger()?i._enter(null,i):i._leave(null,i)}else{if(t(this.getTipElement()).hasClass(y))return void this._leave(null,this);this._enter(null,this)}},x.dispose=function(){clearTimeout(this._timeout),t.removeData(this.element,this.constructor.DATA_KEY),t(this.element).off(this.constructor.EVENT_KEY),t(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&t(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},x.show=function(){var e=this;if("none"===t(this.element).css("display"))throw new Error("Please use show on visible elements");var i=t.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){t(this.element).trigger(i);var r=t.contains(this.element.ownerDocument.documentElement,this.element);if(i.isDefaultPrevented()||!r)return;var s=this.getTipElement(),o=a.getUID(this.constructor.NAME);s.setAttribute("id",o),this.element.setAttribute("aria-describedby",o),this.setContent(),this.config.animation&&t(s).addClass(g);var u="function"==typeof this.config.placement?this.config.placement.call(this,s,this.element):this.config.placement,l=this._getAttachment(u);this.addAttachmentClass(l);var c=!1===this.config.container?document.body:t(this.config.container);t(s).data(this.constructor.DATA_KEY,this),t.contains(this.element.ownerDocument.documentElement,this.tip)||t(s).appendTo(c),t(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new n(this.element,s,{placement:l,modifiers:{offset:{offset:this.config.offset},flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){e._handlePopperPlacementChange(t)}}),t(s).addClass(y),"ontouchstart"in document.documentElement&&t(document.body).children().on("mouseover",null,t.noop);var h=function(){e.config.animation&&e._fixTransition();var n=e._hoverState;e._hoverState=null,t(e.element).trigger(e.constructor.Event.SHOWN),n===p&&e._leave(null,e)};if(t(this.tip).hasClass(g)){var d=a.getTransitionDurationFromElement(this.tip);t(this.tip).one(a.TRANSITION_END,h).emulateTransitionEnd(d)}else h()}},x.hide=function(e){var n=this,i=this.getTipElement(),r=t.Event(this.constructor.Event.HIDE),s=function(){n._hoverState!==f&&i.parentNode&&i.parentNode.removeChild(i),n._cleanTipClass(),n.element.removeAttribute("aria-describedby"),t(n.element).trigger(n.constructor.Event.HIDDEN),null!==n._popper&&n._popper.destroy(),e&&e()};if(t(this.element).trigger(r),!r.isDefaultPrevented()){if(t(i).removeClass(y),"ontouchstart"in document.documentElement&&t(document.body).children().off("mouseover",null,t.noop),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,t(this.tip).hasClass(g)){var o=a.getTransitionDurationFromElement(i);t(i).one(a.TRANSITION_END,s).emulateTransitionEnd(o)}else s();this._hoverState=""}},x.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},x.isWithContent=function(){return Boolean(this.getTitle())},x.addAttachmentClass=function(e){t(this.getTipElement()).addClass("bs-tooltip-"+e)},x.getTipElement=function(){return this.tip=this.tip||t(this.config.template)[0],this.tip},x.setContent=function(){var e=t(this.getTipElement());this.setElementContent(e.find(".tooltip-inner"),this.getTitle()),e.removeClass("fade show")},x.setElementContent=function(e,n){var i=this.config.html;"object"==typeof n&&(n.nodeType||n.jquery)?i?t(n).parent().is(e)||e.empty().append(n):e.text(t(n).text()):e[i?"html":"text"](n)},x.getTitle=function(){var t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t},x._getAttachment=function(t){return h[t.toUpperCase()]},x._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach(function(n){if("click"===n)t(e.element).on(e.constructor.Event.CLICK,e.config.selector,function(t){return e.toggle(t)});else if("manual"!==n){var i=n===v?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,r=n===v?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;t(e.element).on(i,e.config.selector,function(t){return e._enter(t)}).on(r,e.config.selector,function(t){return e._leave(t)})}t(e.element).closest(".modal").on("hide.bs.modal",function(){return e.hide()})}),this.config.selector?this.config=o({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},x._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},x._enter=function(e,n){var i=this.constructor.DATA_KEY;(n=n||t(e.currentTarget).data(i))||(n=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(i,n)),e&&(n._activeTrigger["focusin"===e.type?b:v]=!0),t(n.getTipElement()).hasClass(y)||n._hoverState===f?n._hoverState=f:(clearTimeout(n._timeout),n._hoverState=f,n.config.delay&&n.config.delay.show?n._timeout=setTimeout(function(){n._hoverState===f&&n.show()},n.config.delay.show):n.show())},x._leave=function(e,n){var i=this.constructor.DATA_KEY;(n=n||t(e.currentTarget).data(i))||(n=new this.constructor(e.currentTarget,this._getDelegateConfig()),t(e.currentTarget).data(i,n)),e&&(n._activeTrigger["focusout"===e.type?b:v]=!1),n._isWithActiveTrigger()||(clearTimeout(n._timeout),n._hoverState=p,n.config.delay&&n.config.delay.hide?n._timeout=setTimeout(function(){n._hoverState===p&&n.hide()},n.config.delay.hide):n.hide())},x._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},x._getConfig=function(n){return"number"==typeof(n=o({},this.constructor.Default,t(this.element).data(),n)).delay&&(n.delay={show:n.delay,hide:n.delay}),"number"==typeof n.title&&(n.title=n.title.toString()),"number"==typeof n.content&&(n.content=n.content.toString()),a.typeCheckConfig(e,n,this.constructor.DefaultType),n},x._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},x._cleanTipClass=function(){var e=t(this.getTipElement()),n=e.attr("class").match(l);null!==n&&n.length>0&&e.removeClass(n.join(""))},x._handlePopperPlacementChange=function(t){this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},x._fixTransition=function(){var e=this.getTipElement(),n=this.config.animation;null===e.getAttribute("x-placement")&&(t(e).removeClass(g),this.config.animation=!1,this.hide(),this.show(),this.config.animation=n)},u._jQueryInterface=function(e){return this.each(function(){var n=t(this).data(i),r="object"==typeof e&&e;if((n||!/dispose|hide/.test(e))&&(n||(n=new u(this,r),t(this).data(i,n)),"string"==typeof e)){if(void 0===n[e])throw new TypeError('No method named "'+e+'"');n[e]()}})},r(u,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return d}},{key:"NAME",get:function(){return e}},{key:"DATA_KEY",get:function(){return i}},{key:"Event",get:function(){return m}},{key:"EVENT_KEY",get:function(){return s}},{key:"DefaultType",get:function(){return c}}]),u}();return t.fn[e]=x._jQueryInterface,t.fn[e].Constructor=x,t.fn[e].noConflict=function(){return t.fn[e]=u,x._jQueryInterface},x}(e),m=function(t){var e="popover",n="bs.popover",i="."+n,s=t.fn[e],a=new RegExp("(^|\\s)bs-popover\\S+","g"),u=o({},p.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),l=o({},p.DefaultType,{content:"(string|element|function)"}),c={HIDE:"hide"+i,HIDDEN:"hidden"+i,SHOW:"show"+i,SHOWN:"shown"+i,INSERTED:"inserted"+i,CLICK:"click"+i,FOCUSIN:"focusin"+i,FOCUSOUT:"focusout"+i,MOUSEENTER:"mouseenter"+i,MOUSELEAVE:"mouseleave"+i},h=function(s){var o,h;function d(){return s.apply(this,arguments)||this}h=s,(o=d).prototype=Object.create(h.prototype),o.prototype.constructor=o,o.__proto__=h;var f=d.prototype;return f.isWithContent=function(){return this.getTitle()||this._getContent()},f.addAttachmentClass=function(e){t(this.getTipElement()).addClass("bs-popover-"+e)},f.getTipElement=function(){return this.tip=this.tip||t(this.config.template)[0],this.tip},f.setContent=function(){var e=t(this.getTipElement());this.setElementContent(e.find(".popover-header"),this.getTitle());var n=this._getContent();"function"==typeof n&&(n=n.call(this.element)),this.setElementContent(e.find(".popover-body"),n),e.removeClass("fade show")},f._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},f._cleanTipClass=function(){var e=t(this.getTipElement()),n=e.attr("class").match(a);null!==n&&n.length>0&&e.removeClass(n.join(""))},d._jQueryInterface=function(e){return this.each(function(){var i=t(this).data(n),r="object"==typeof e?e:null;if((i||!/destroy|hide/.test(e))&&(i||(i=new d(this,r),t(this).data(n,i)),"string"==typeof e)){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}})},r(d,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return u}},{key:"NAME",get:function(){return e}},{key:"DATA_KEY",get:function(){return n}},{key:"Event",get:function(){return c}},{key:"EVENT_KEY",get:function(){return i}},{key:"DefaultType",get:function(){return l}}]),d}(p);return t.fn[e]=h._jQueryInterface,t.fn[e].Constructor=h,t.fn[e].noConflict=function(){return t.fn[e]=s,h._jQueryInterface},h}(e),g=function(t){var e="scrollspy",n="bs.scrollspy",i="."+n,s=t.fn[e],u={offset:10,method:"auto",target:""},l={offset:"number",method:"string",target:"(string|element)"},c={ACTIVATE:"activate"+i,SCROLL:"scroll"+i,LOAD_DATA_API:"load.bs.scrollspy.data-api"},h="active",d=".nav, .list-group",f="position",p=function(){function s(e,n){var i=this;this._element=e,this._scrollElement="BODY"===e.tagName?window:e,this._config=this._getConfig(n),this._selector=this._config.target+" .nav-link,"+this._config.target+" .list-group-item,"+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,t(this._scrollElement).on(c.SCROLL,function(t){return i._process(t)}),this.refresh(),this._process()}var p=s.prototype;return p.refresh=function(){var e=this,n="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":f:this._config.method,i=n===f?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),t.makeArray(t(this._selector)).map(function(e){var r,s=a.getSelectorFromElement(e);if(s&&(r=t(s)[0]),r){var o=r.getBoundingClientRect();if(o.width||o.height)return[t(r)[n]().top+i,s]}return null}).filter(function(t){return t}).sort(function(t,e){return t[0]-e[0]}).forEach(function(t){e._offsets.push(t[0]),e._targets.push(t[1])})},p.dispose=function(){t.removeData(this._element,n),t(this._scrollElement).off(i),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},p._getConfig=function(n){if("string"!=typeof(n=o({},u,n)).target){var i=t(n.target).attr("id");i||(i=a.getUID(e),t(n.target).attr("id",i)),n.target="#"+i}return a.typeCheckConfig(e,n,l),n},p._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},p._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},p._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},p._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),n=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),t>=n){var i=this._targets[this._targets.length-1];this._activeTarget!==i&&this._activate(i)}else{if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var r=this._offsets.length;r--;)this._activeTarget!==this._targets[r]&&t>=this._offsets[r]&&(void 0===this._offsets[r+1]||t<this._offsets[r+1])&&this._activate(this._targets[r])}},p._activate=function(e){this._activeTarget=e,this._clear();var n=this._selector.split(",");n=n.map(function(t){return t+'[data-target="'+e+'"],'+t+'[href="'+e+'"]'});var i=t(n.join(","));i.hasClass("dropdown-item")?(i.closest(".dropdown").find(".dropdown-toggle").addClass(h),i.addClass(h)):(i.addClass(h),i.parents(d).prev(".nav-link, .list-group-item").addClass(h),i.parents(d).prev(".nav-item").children(".nav-link").addClass(h)),t(this._scrollElement).trigger(c.ACTIVATE,{relatedTarget:e})},p._clear=function(){t(this._selector).filter(".active").removeClass(h)},s._jQueryInterface=function(e){return this.each(function(){var i=t(this).data(n);if(i||(i=new s(this,"object"==typeof e&&e),t(this).data(n,i)),"string"==typeof e){if(void 0===i[e])throw new TypeError('No method named "'+e+'"');i[e]()}})},r(s,null,[{key:"VERSION",get:function(){return"4.1.0"}},{key:"Default",get:function(){return u}}]),s}();return t(window).on(c.LOAD_DATA_API,function(){for(var e=t.makeArray(t('[data-spy="scroll"]')),n=e.length;n--;){var i=t(e[n]);p._jQueryInterface.call(i,i.data())}}),t.fn[e]=p._jQueryInterface,t.fn[e].Constructor=p,t.fn[e].noConflict=function(){return t.fn[e]=s,p._jQueryInterface},p}(e),y=function(t){var e="bs.tab",n=t.fn.tab,i="active",s=".active",o="> li > .active",u=function(){function n(t){this._element=t}var u=n.prototype;return u.show=function(){var e=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&t(this._element).hasClass(i)||t(this._element).hasClass("disabled"))){var n,r,u=t(this._element).closest(".nav, .list-group")[0],l=a.getSelectorFromElement(this._element);if(u){var c="UL"===u.nodeName?o:s;r=(r=t.makeArray(t(u).find(c)))[r.length-1]}var h=t.Event("hide.bs.tab",{relatedTarget:this._element}),d=t.Event("show.bs.tab",{relatedTarget:r});if(r&&t(r).trigger(h),t(this._element).trigger(d),!d.isDefaultPrevented()&&!h.isDefaultPrevented()){l&&(n=t(l)[0]),this._activate(this._element,u);var f=function(){var n=t.Event("hidden.bs.tab",{relatedTarget:e._element}),i=t.Event("shown.bs.tab",{relatedTarget:r});t(r).trigger(n),t(e._element).trigger(i)};n?this._activate(n,n.parentNode,f):f()}}},u.dispose=function(){t.removeData(this._element,e),this._element=null},u._activate=function(e,n,i){var r=this,u=("UL"===n.nodeName?t(n).find(o):t(n).children(s))[0],l=i&&u&&t(u).hasClass("fade"),c=function(){return r._transitionComplete(e,u,i)};if(u&&l){var h=a.getTransitionDurationFromElement(u);t(u).one(a.TRANSITION_END,c).emulateTransitionEnd(h)}else c()},u._transitionComplete=function(e,n,r){if(n){t(n).removeClass("show active");var s=t(n.parentNode).find("> .dropdown-menu .active")[0];s&&t(s).removeClass(i),"tab"===n.getAttribute("role")&&n.setAttribute("aria-selected",!1)}if(t(e).addClass(i),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!0),a.reflow(e),t(e).addClass("show"),e.parentNode&&t(e.parentNode).hasClass("dropdown-menu")){var o=t(e).closest(".dropdown")[0];o&&t(o).find(".dropdown-toggle").addClass(i),e.setAttribute("aria-expanded",!0)}r&&r()},n._jQueryInterface=function(i){return this.each(function(){var r=t(this),s=r.data(e);if(s||(s=new n(this),r.data(e,s)),"string"==typeof i){if(void 0===s[i])throw new TypeError('No method named "'+i+'"');s[i]()}})},r(n,null,[{key:"VERSION",get:function(){return"4.1.0"}}]),n}();return t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(e){e.preventDefault(),u._jQueryInterface.call(t(this),"show")}),t.fn.tab=u._jQueryInterface,t.fn.tab.Constructor=u,t.fn.tab.noConflict=function(){return t.fn.tab=n,u._jQueryInterface},u}(e);!function(t){if(void 0===t)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}(e),t.Util=a,t.Alert=u,t.Button=l,t.Carousel=c,t.Collapse=h,t.Dropdown=d,t.Modal=f,t.Popover=m,t.Scrollspy=g,t.Tab=y,t.Tooltip=p,Object.defineProperty(t,"__esModule",{value:!0})});var BreakoutMultiplayer=new Phaser.Class({Extends:Phaser.Scene,initialize:function(){Phaser.Scene.call(this,{key:"BreakoutMultiplayer"}),this.level=1,this.balls=[],this.paddls=[],this.ballsVelocitiy=[{x:300,y:-150},{x:-300,y:150},{x:300,y:-150},{x:-300,y:-150}],this.scores=[0,0,0,0]},preload:function(){this.load.image("paddle0","assets/paddle0.png"),this.load.image("paddle1","assets/paddle1.png"),this.load.image("paddle2","assets/paddle2.png"),this.load.image("paddle3","assets/paddle3.png"),this.load.image("brick1","assets/blue.png"),this.load.image("brick2","assets/green.png"),this.load.image("brick3","assets/purple.png"),this.load.image("brick4","assets/red.png"),this.load.image("brick5","assets/silver.png"),this.load.image("ball0","assets/ball0.png"),this.load.image("ball1","assets/ball1.png"),this.load.image("ball2","assets/ball2.png"),this.load.image("ball3","assets/ball3.png")},create:function(){this.ballsPositions=[{x:this.cameras.main.centerX,y:this.game.config.height-80},{x:this.cameras.main.centerX,y:80},{x:80,y:this.cameras.main.centerY},{x:this.game.config.width-80,y:this.cameras.main.centerY}],this.paddlsPositions=[{x:this.cameras.main.centerX,y:this.game.config.height-40},{x:this.cameras.main.centerX,y:40},{x:40,y:this.cameras.main.centerY},{x:this.game.config.width-40,y:this.cameras.main.centerY}];for(var t=0;t<4;t++)this.paddls.push(this.physics.add.image(this.paddlsPositions[t].x,this.paddlsPositions[t].y,"paddle"+t).setImmovable().setScale(.5*SCALE));for(t=0;t<4;t++)this.balls.push(this.physics.add.image(this.ballsPositions[t].x,this.ballsPositions[t].y,"ball"+t).setCollideWorldBounds(!0).setBounce(1).setScale(.5*SCALE).setData("onPaddle",!0));var e=this.setAllBricks(levelMP1);for(t=0;t<e.length;t++){var n=this.physics.add.staticGroup({key:e[t].brick,frameQuantity:1,gridAlign:{x:e[t].x,y:e[t].y}});n.children.entries[0].setScale(SCALE),null==this.bricks?this.bricks=n:this.bricks.addMultiple(n.children.entries)}for(t=0;t<4;t++)this.physics.add.collider(this.balls[t],this.bricks,this.brickHit,null,this);for(t=0;t<4;t++)for(var i=0;i<4;i++)this.physics.add.collider(this.balls[t],this.paddls[i],this.paddleHit,null,this);for(t=0;t<4;t++)for(i=0;i<4;i++)this.physics.add.collider(this.paddls[t],this.paddls[i],null,null,this)},update:function(){for(var t=0;t<4;t++)this.ballHitWall(t)&&(this.balls[t].setPosition(this.ballsPositions[t].x,this.ballsPositions[t].y).setVelocity(this.ballsVelocitiy[t].x,this.ballsVelocitiy[t].y),this.scores[t]=this.scores[t]<50?0:this.scores[t]-50,this.printScores());0===this.bricks.countActive()&&(this.game.destroy(),this.endGameModal())},endGameModal:function(){const t=this.sort(this.scores),e=document.createElement("div");e.innerHTML='<table class="table table-borderless">  <thead>    <tr>      <th scope="col">Place</th>      <th colspan="2">Name</th>      <th colspan="2">Score</th>    </tr>  </thead>  <tbody>    <tr>      <th scope="row">1st</th>      <td colspan="2">'+this.getPlayerName(t[3])+'</td>      <td colspan="2">'+this.scores[t[3]]+'</td>    </tr>    <tr>      <th scope="row">2nd</th>      <td colspan="2">'+this.getPlayerName(t[2])+'</td>      <td colspan="2">'+this.scores[t[2]]+'</td>    </tr>    <tr>      <th scope="row">3rd</th>      <td colspan="2">'+this.getPlayerName(t[1])+'</td>      <td colspan="2">'+this.scores[t[1]]+'</td>    </tr><tr>      <th scope="row">4th</th>      <td colspan="2">'+this.getPlayerName(t[0])+'</td>      <td colspan="2">'+this.scores[t[0]]+"</td>    </tr>  </tbody></table>",swal({title:"Game over",closeOnClickOutside:!1,content:e,buttons:{confirm:"Menu"}}).then(t=>{var e=$("canvas");e[e.length-1].remove(),$("#mainScreen").show()})},brickHit:function(t,e){var n=0;switch(e.texture.key){case"brick1":n=5;break;case"brick2":n=10;break;case"brick3":n=15;break;case"brick4":n=20;break;case"brick5":n=25}for(var i=0;i<4;i++)this.balls[i]===t&&(this.scores[i]+=n);this.printScores(),this.tweens.add({targets:e,scaleX:0,scaleY:0,ease:"Power1",duration:500,delay:250,angle:180,onComplete:()=>{e.destroy()}})},sort:function(t){for(var e=t.length,n=new Array(e),i=0;i<e;++i)n[i]=i;return n.sort(function(e,n){return t[e]<t[n]?-1:t[e]>t[n]?1:0}),n},getPlayerName:function(t){switch(t){case 0:return $("#player_name1").text();case 1:return $("#player_name2").text();case 2:return $("#player_name3").text();case 3:return $("#player_name4").text()}},paddleHit:function(t,e){for(var n=0,i=0;n<4&&this.balls[n]!==t;n++);for(;i<4&&this.paddls[i]!==e;i++);n!==i&&(this.scores[i]+=20,this.printScores())},setAllBricks:function(t){for(var e=[],n=0;n<t.length;n++)for(var i=0;i<t[0].length;i++){var r="";switch(t[n][i]){case"1":r="brick1";break;case"2":r="brick2";break;case"3":r="brick3";break;case"4":r="brick4";break;case"5":r="brick5"}""!==r&&e.push({brick:r,x:50*i*SCALE,y:50*n*SCALE})}return e},ballHitWall(t){switch(t){case 0:return this.balls[t].y>this.paddls[t].y;case 1:return this.balls[t].y<this.paddls[t].y;case 2:return this.balls[t].x<this.paddls[t].x;case 3:return this.balls[t].x>this.paddls[t].x}},printScores(){$("#player_score1").text(this.scores[0]),$("#player_score2").text(this.scores[1]),$("#player_score3").text(this.scores[2]),$("#player_score4").text(this.scores[3])}});let configBreakoutMultiplayer={type:Phaser.AUTO,width:$(window).width()>$(window).height()?$(window).height()-5:$(window).width()-5,height:$(window).width()>$(window).height()?$(window).height()-5:$(window).width()-5,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[BreakoutMultiplayer],backgroundColor:"#222",physics:{default:"arcade"}},scoreText1,scoreText2,livesText1,livesText2,levelText,startButton,menuButton,rotation;const textStyle1={font:"17px NeueRegular"},textStyle={font:"17px NeueUltrabold"};var Breakout=new Phaser.Class({Extends:Phaser.Scene,initialize:function(){Phaser.Scene.call(this,{key:"breakout"}),this.score=0,this.lives=3,this.level=1},preload:function(){this.load.image("paddle","assets/paddle.png"),this.load.image("ball","assets/ball.png"),this.load.image("brick1","assets/tile.png")},create:function(){this.paddle=this.physics.add.image(this.cameras.main.centerX,this.game.config.height-50,"paddle").setImmovable().setScale(.5*SCALE_W,.5*SCALE_H),this.ball=this.physics.add.image(this.cameras.main.centerX,this.game.config.height-80,"ball").setCollideWorldBounds(!0).setBounce(1).setScale(.5*SCALE_W,.5*SCALE_H);var t=this.setAllBricks(level1);for(i in t){var e=this.physics.add.staticGroup({key:t[i].brick,frameQuantity:1,gridAlign:{x:t[i].x,y:t[i].y}});e.children.entries[0].setScale(SCALE_W,SCALE_H),null==this.bricks?this.bricks=e:this.bricks.addMultiple(e.children.entries)}scoreText1=this.add.text(20,20,"Score: ",textStyle1),scoreText2=this.add.text(85,20,"0",textStyle),livesText1=this.add.text(20,50,"Lives: ",textStyle1),livesText2=this.add.text(85,50,this.lives,textStyle),startButton=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"Start game",textStyle1).setOrigin(.5).setPadding(10).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.startGame.call(this)).on("pointerover",()=>startButton.setStyle({color:"#f39c12"})).on("pointerout",()=>startButton.setStyle({color:"#FFF"})),menuButton=this.add.text(this.game.config.width-60,20,"MENU",textStyle1).setPadding(10).setStyle({color:"#FFF"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{if(void 0!==this.ball.body){var t=this.ball.body.velocity.clone();this.ball.setVelocity(0,0)}swal({title:"EXIT GAME?",text:"If you go to the menu the game will end. Sure you wanna do this?",buttons:{cancel:"CANCEL",confirm:"EXIT"}}).then(e=>{e?this.endGame():void 0!==this.ball.body&&this.ball.setVelocity(t.x,t.y)})}).on("pointerover",()=>menuButton.setStyle({color:"#f39c12"})).on("pointerout",()=>menuButton.setStyle({color:"#FFF"})),this.physics.add.collider(this.ball,this.bricks,this.brickHit,null,this),this.physics.add.collider(this.ball,this.paddle,null,null,this),$("#singleplayer_canvas canvas").css("display","block")},update:function(){rotation&&(this.ball.rotation="left"===rotation?this.ball.rotation-.05:this.ball.rotation+.05),this.ball.y>this.paddle.y&&(this.lives--,this.lives>0?(livesText2.setText(""+this.lives),this.ball.setPosition(this.cameras.main.centerX,this.game.config.height-100).setVelocity(300,-150)):(this.game.destroy(),this.endGameModal("GAME OVER")))},brickHit:function(t,e){this.score+=25,scoreText2.setText(""+this.score),e.destroy(),0===this.bricks.countActive()&&(this.game.destroy(),this.endGameModal("You've cleared the game!"))},endGameModal:function(t){const e=document.createElement("div");e.innerHTML="<p style='margin-block-start: 0;margin-block-end: 0'>Your score is <b>"+this.score+"</b></p><p style='margin-block-start: 0;margin-block-end: 10px'>Would you like to save it?</p><form><input id='user_name' type=\"text\" name=\"user_name\" placeholder='Type your name'></form>",swal({title:t,closeOnClickOutside:!1,content:e,buttons:{confirm:"SAVE",cancel:"MENU"}}).then(t=>{if(t){var e=new CustomEvent("onScoreSubmit",{detail:{player_name:$("#user_name").val(),score:this.score}});window.dispatchEvent(e)}this.endGame()})},startGame:function(){startButton.destroy(),this.ball.setVelocity(-300,-150),rotation="left"},endGame:function(){$("#singleplayer_canvas canvas").remove(),this.game.destroy(),$("#mainScreen").show()},setAllBricks:function(t){for(var e=[],n=0;n<t.length;n++)for(var i=0;i<t[0].length;i++){var r="";switch(t[n][i]){case"1":r="brick1";break;case"2":r="brick2";break;case"3":r="brick3";break;case"4":r="brick4";break;case"5":r="brick5"}""!==r&&e.push({brick:r,x:80*i*SCALE_W,y:100+80*n*SCALE_H})}return e}});let configBreakout={type:Phaser.AUTO,width:window.innerWidth,height:window.innerHeight,scene:[Breakout],parent:"singleplayer_canvas",backgroundColor:"#000",physics:{default:"arcade"}};var level1=[["","","","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],["","","","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],["","","","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"]],levelMP1=[["","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","",""],["","","","","","","2","2","2","2","2","2","2","2","2","",""],["","","","","","","2","2","2","2","2","2","2","2","2","",""],["","","","","2","2","2","3","3","3","3","3","3","3","2","2","2"],["","","","","2","2","3","3","3","3","3","3","3","3","3","2","2"],["","","","","2","2","3","3","4","4","4","4","4","3","3","2","2"],["","","","","2","2","3","3","4","5","5","5","4","3","3","2","2"],["","","","","2","2","3","3","4","5","1","5","4","3","3","2","2"],["","","","","2","2","3","3","4","5","5","5","4","3","3","2","2"],["","","","","2","2","3","3","4","4","4","4","4","3","3","2","2"],["","","","","2","2","3","3","3","3","3","3","3","3","3","2","2"],["","","","","2","2","2","3","3","3","3","3","3","3","2","2","2"],["","","","","","","2","2","2","2","2","2","2","2","2","",""],["","","","","","","2","2","2","2","2","2","2","2","2","",""]];!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.io=e():t.io=e()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:Function("return this")(),function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,(function(e){return t[e]}).bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./build/index.js")}({"./build/index.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=e.io=e.Manager=e.protocol=void 0;var r=n("./build/url.js"),s=n("./build/manager.js"),o=n("./build/socket.js");Object.defineProperty(e,"Socket",{enumerable:!0,get:function(){return o.Socket}});var a=n("./node_modules/debug/src/browser.js")("socket.io-client");t.exports=e=l;var u=e.managers={};function l(t,e){"object"===i(t)&&(e=t,t=void 0),e=e||{};var n,o=r.url(t),l=o.source,c=o.id;return e.forceNew||e["force new connection"]||!1===e.multiplex||u[c]&&o.path in u[c].nsps?(a("ignoring socket cache for %s",l),n=new s.Manager(l,e)):(u[c]||(a("new io instance for %s",l),u[c]=new s.Manager(l,e)),n=u[c]),o.query&&!e.query&&(e.query=o.query),n.socket(o.path,e)}e.io=l;var c=n("./node_modules/socket.io-parser/dist/index.js");Object.defineProperty(e,"protocol",{enumerable:!0,get:function(){return c.protocol}}),e.connect=l;var h=n("./build/manager.js");Object.defineProperty(e,"Manager",{enumerable:!0,get:function(){return h.Manager}})},"./build/manager.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;var u=n("./node_modules/engine.io-client/lib/index.js"),l=n("./build/socket.js"),c=n("./node_modules/component-emitter/index.js"),h=n("./node_modules/socket.io-parser/dist/index.js"),d=n("./build/on.js"),f=n("./node_modules/component-bind/index.js"),p=n("./node_modules/backo2/index.js"),m=n("./node_modules/debug/src/browser.js")("socket.io-client:manager");e.Manager=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(y,t);var e,n,c,g=(n=y,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(c){var i=a(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return o(this,t)});function y(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=g.call(this)).nsps={},n.subs=[],t&&"object"===i(t)&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",n.opts=e,n.reconnection(!1!==e.reconnection),n.reconnectionAttempts(e.reconnectionAttempts||1/0),n.reconnectionDelay(e.reconnectionDelay||1e3),n.reconnectionDelayMax(e.reconnectionDelayMax||5e3),n.randomizationFactor(e.randomizationFactor||.5),n.backoff=new p({min:n.reconnectionDelay(),max:n.reconnectionDelayMax(),jitter:n.randomizationFactor()}),n.timeout(null==e.timeout?2e4:e.timeout),n._readyState="closed",n.uri=t;var r=e.parser||h;return n.encoder=new r.Encoder,n.decoder=new r.Decoder,n._autoConnect=!1!==e.autoConnect,n._autoConnect&&n.open(),n}return(e=[{key:"reconnection",value:function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}},{key:"reconnectionAttempts",value:function(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}},{key:"reconnectionDelay",value:function(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}},{key:"randomizationFactor",value:function(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}},{key:"reconnectionDelayMax",value:function(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}},{key:"timeout",value:function(t){return arguments.length?(this._timeout=t,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(t){var e=this;if(m("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;m("opening %s",this.uri),this.engine=u(this.uri,this.opts);var n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;var s=d.on(n,"open",function(){i.onopen(),t&&t()}),o=d.on(n,"error",function(n){m("error"),i.cleanup(),i._readyState="closed",r(a(y.prototype),"emit",e).call(e,"error",n),t?t(n):i.maybeReconnectOnOpen()});if(!1!==this._timeout){var l=this._timeout;m("connect attempt will timeout after %d",l),0===l&&s.destroy();var c=setTimeout(function(){m("connect attempt timed out after %d",l),s.destroy(),n.close(),n.emit("error",new Error("timeout"))},l);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(s),this.subs.push(o),this}},{key:"connect",value:function(t){return this.open(t)}},{key:"onopen",value:function(){m("open"),this.cleanup(),this._readyState="open",r(a(y.prototype),"emit",this).call(this,"open");var t=this.engine;this.subs.push(d.on(t,"data",f(this,"ondata")),d.on(t,"ping",f(this,"onping")),d.on(t,"error",f(this,"onerror")),d.on(t,"close",f(this,"onclose")),d.on(this.decoder,"decoded",f(this,"ondecoded")))}},{key:"onping",value:function(){r(a(y.prototype),"emit",this).call(this,"ping")}},{key:"ondata",value:function(t){this.decoder.add(t)}},{key:"ondecoded",value:function(t){r(a(y.prototype),"emit",this).call(this,"packet",t)}},{key:"onerror",value:function(t){m("error",t),r(a(y.prototype),"emit",this).call(this,"error",t)}},{key:"socket",value:function(t,e){var n=this.nsps[t];return n||(n=new l.Socket(this,t,e),this.nsps[t]=n),n}},{key:"_destroy",value:function(t){for(var e=0,n=Object.keys(this.nsps);e<n.length;e++){var i=n[e];if(this.nsps[i].active)return void m("socket %s is still active, skipping close",i)}this._close()}},{key:"_packet",value:function(t){m("writing packet %j",t),t.query&&0===t.type&&(t.nsp+="?"+t.query);for(var e=this.encoder.encode(t),n=0;n<e.length;n++)this.engine.write(e[n],t.options)}},{key:"cleanup",value:function(){m("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.decoder.destroy()}},{key:"_close",value:function(){m("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(t){m("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",r(a(y.prototype),"emit",this).call(this,"close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)m("reconnect failed"),this.backoff.reset(),r(a(y.prototype),"emit",this).call(this,"reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();m("will wait %dms before reconnect attempt",n),this._reconnecting=!0;var i=setTimeout(function(){e.skipReconnect||(m("attempting reconnect"),r(a(y.prototype),"emit",t).call(t,"reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(function(n){n?(m("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),r(a(y.prototype),"emit",t).call(t,"reconnect_error",n)):(m("reconnect success"),e.onreconnect())}))},n);this.subs.push({destroy:function(){clearTimeout(i)}})}}},{key:"onreconnect",value:function(){var t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),r(a(y.prototype),"emit",this).call(this,"reconnect",t)}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(y.prototype,e),y}(c)},"./build/on.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,n){return t.on(e,n),{destroy:function(){t.off(e,n)}}}},"./build/socket.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;var l=n("./node_modules/socket.io-parser/dist/index.js"),c=n("./node_modules/component-emitter/index.js"),h=n("./build/on.js"),d=n("./node_modules/component-bind/index.js"),f=n("./node_modules/debug/src/browser.js")("socket.io-client:socket"),p=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});e.Socket=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(m,t);var e,n,i,c=(n=m,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(i){var r=u(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function m(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(i=c.call(this)).ids=0,i.acks={},i.receiveBuffer=[],i.sendBuffer=[],i.flags={},i.io=t,i.nsp=e,i.ids=0,i.acks={},i.receiveBuffer=[],i.sendBuffer=[],i.connected=!1,i.disconnected=!0,i.flags={},n&&n.auth&&(i.auth=n.auth),i.io._autoConnect&&i.open(),i}return(e=[{key:"subEvents",value:function(){if(!this.subs){var t=this.io;this.subs=[h.on(t,"open",d(this,"onopen")),h.on(t,"packet",d(this,"onpacket")),h.on(t,"close",d(this,"onclose"))]}}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.unshift("message"),this.emit.apply(this,e),this}},{key:"emit",value:function(t){if(p.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];n.unshift(t);var r={type:l.PacketType.EVENT,data:n,options:{}};r.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]&&(f("emitting packet with ack id %d",this.ids),this.acks[this.ids]=n.pop(),r.id=this.ids++);var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,o=this.flags.volatile&&(!s||!this.connected);return o?f("discard packet as the transport is not currently writable"):this.connected?this.packet(r):this.sendBuffer.push(r),this.flags={},this}},{key:"packet",value:function(t){t.nsp=this.nsp,this.io._packet(t)}},{key:"onopen",value:function(){var t=this;f("transport is open - connecting"),"function"==typeof this.auth?this.auth(function(e){t.packet({type:l.PacketType.CONNECT,data:e})}):this.packet({type:l.PacketType.CONNECT,data:this.auth})}},{key:"onclose",value:function(t){f("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,s(u(m.prototype),"emit",this).call(this,"disconnect",t)}},{key:"onpacket",value:function(t){if(t.nsp===this.nsp)switch(t.type){case l.PacketType.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid):s(u(m.prototype),"emit",this).call(this,"connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case l.PacketType.EVENT:case l.PacketType.BINARY_EVENT:this.onevent(t);break;case l.PacketType.ACK:case l.PacketType.BINARY_ACK:this.onack(t);break;case l.PacketType.DISCONNECT:this.ondisconnect();break;case l.PacketType.CONNECT_ERROR:var e=new Error(t.data.message);e.data=t.data.data,s(u(m.prototype),"emit",this).call(this,"connect_error",e)}}},{key:"onevent",value:function(t){var e=t.data||[];f("emitting event %j",e),null!=t.id&&(f("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}},{key:"emitEvent",value:function(t){if(this._anyListeners&&this._anyListeners.length){var e,n=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))){n&&(t=n);var i=0,s=function(){};return{s:s,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(this._anyListeners.slice());try{for(n.s();!(e=n.n()).done;)e.value.apply(this,t)}catch(i){n.e(i)}finally{n.f()}}s(u(m.prototype),"emit",this).apply(this,t)}},{key:"ack",value:function(t){var e=this,n=!1;return function(){if(!n){n=!0;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];f("sending ack %j",r),e.packet({type:l.PacketType.ACK,id:t,data:r})}}}},{key:"onack",value:function(t){var e=this.acks[t.id];"function"==typeof e?(f("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):f("bad ack %s",t.id)}},{key:"onconnect",value:function(t){f("socket connected with id %s",t),this.id=t,this.connected=!0,this.disconnected=!1,s(u(m.prototype),"emit",this).call(this,"connect"),this.emitBuffered()}},{key:"emitBuffered",value:function(){var t=this;this.receiveBuffer.forEach(function(e){return t.emitEvent(e)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(e){return t.packet(e)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){f("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&(f("performing disconnect (%s)",this.nsp),this.packet({type:l.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(t){return this.flags.compress=t,this}},{key:"onAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}},{key:"prependAny",value:function(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}},{key:"offAny",value:function(t){if(!this._anyListeners)return this;if(t){for(var e=this._anyListeners,n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"active",get:function(){return!!this.subs}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(m.prototype,e),m}(c)},"./build/url.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;var i=n("./node_modules/parseuri/index.js"),r=n("./node_modules/debug/src/browser.js")("socket.io-client:url");e.url=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),r("parse %s",t),n=i(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port,n.href=n.protocol+"://"+s+(e&&e.port===n.port?"":":"+n.port),n}},"./node_modules/backo2/index.js":function(t,e){function n(t){this.ms=(t=t||{}).min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(t,e){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<t.length;i++)n[t.charCodeAt(i)]=i;e.encode=function(e){var n,i=new Uint8Array(e),r=i.length,s="";for(n=0;n<r;n+=3)s+=t[i[n]>>2],s+=t[(3&i[n])<<4|i[n+1]>>4],s+=t[(15&i[n+1])<<2|i[n+2]>>6],s+=t[63&i[n+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s},e.decode=function(t){var e,i,r,s,o,a=.75*t.length,u=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var c=new ArrayBuffer(a),h=new Uint8Array(c);for(e=0;e<u;e+=4)i=n[t.charCodeAt(e)],r=n[t.charCodeAt(e+1)],s=n[t.charCodeAt(e+2)],o=n[t.charCodeAt(e+3)],h[l++]=i<<2|r>>4,h[l++]=(15&r)<<4|s>>2,h[l++]=(3&s)<<6|63&o;return c}}()},"./node_modules/component-bind/index.js":function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(t,e,n){function i(t){if(t)return function(t){for(var e in i.prototype)t[e]=i.prototype[e];return t}(t)}t.exports=i,i.prototype.on=i.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},i.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<i.length;r++)if((n=i[r])===e||n.fn===e){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+t],this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,e)}return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},"./node_modules/debug/src/browser.js":function(t,e,n){(function(i){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(r=i))}),e.splice(r,0,n)}},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(n){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(n){}return!t&&void 0!==i&&"env"in i&&(t=i.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n("./node_modules/debug/src/common.js")(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/debug/src/common.js":function(t,e,n){function i(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}t.exports=function(t){function e(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return r.colors[Math.abs(e)%r.colors.length]}function r(t){var n;function i(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];if(i.enabled){var o=i,a=Number(new Date),u=a-(n||a);o.diff=u,o.prev=n,o.curr=a,n=a,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var l=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;l++;var i=r.formatters[n];return"function"==typeof i&&(t=i.call(o,e[l]),e.splice(l,1),l--),t}),r.formatArgs.call(o,e);var c=o.log||r.log;c.apply(o,e)}}return i.namespace=t,i.enabled=r.enabled(t),i.useColors=r.useColors(),i.color=e(t),i.destroy=s,i.extend=o,"function"==typeof r.init&&r.init(i),r.instances.push(i),i}function s(){var t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}function o(t,e){var n=r(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function a(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){var t=[].concat(i(r.names.map(a)),i(r.skips.map(a).map(function(t){return"-"+t}))).join(",");return r.enable(""),t},r.enable=function(t){var e;r.save(t),r.names=[],r.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){var s=r.instances[e];s.enabled=r.enabled(s.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=n("./node_modules/ms/index.js"),Object.keys(t).forEach(function(e){r[e]=t[e]}),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=e,r.enable(r.load()),r}},"./node_modules/engine.io-client/lib/globalThis.browser.js":function(t,e){t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"./node_modules/engine.io-client/lib/index.js":function(t,e,n){var i=n("./node_modules/engine.io-client/lib/socket.js");t.exports=function(t,e){return new i(t,e)},t.exports.Socket=i,t.exports.protocol=i.protocol,t.exports.Transport=n("./node_modules/engine.io-client/lib/transport.js"),t.exports.transports=n("./node_modules/engine.io-client/lib/transports/index.js"),t.exports.parser=n("./node_modules/engine.io-parser/lib/index.js")},"./node_modules/engine.io-client/lib/socket.js":function(t,e,n){function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n("./node_modules/engine.io-client/lib/transports/index.js"),c=n("./node_modules/component-emitter/index.js"),h=n("./node_modules/debug/src/browser.js")("engine.io-client:socket"),d=n("./node_modules/engine.io-parser/lib/index.js"),f=n("./node_modules/parseuri/index.js"),p=n("./node_modules/parseqs/index.js"),m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(g,t);var e,n,c,m=(n=g,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(c){var i=u(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return a(this,t)});function g(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return s(this,g),e=m.call(this),t&&"object"===r(t)&&(n=t,t=null),t?(t=f(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=f(n.host).host),e.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=e.secure?"443":"80"),e.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),e.port=n.port||("undefined"!=typeof location&&location.port?location.port:e.secure?443:80),e.transports=n.transports||["polling","websocket"],e.readyState="",e.writeBuffer=[],e.prevBufferLen=0,e.opts=i({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},n),e.opts.path=e.opts.path.replace(/\/$/,"")+"/","string"==typeof e.opts.query&&(e.opts.query=p.decode(e.opts.query)),e.id=null,e.upgrades=null,e.pingInterval=null,e.pingTimeout=null,e.pingTimeoutTimer=null,e.open(),e}return(e=[{key:"createTransport",value:function(t){h('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.opts.query);e.EIO=d.protocol,e.transport=t,this.id&&(e.sid=this.id);var n=i({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return h("options: %j",n),new l[t](n)}},{key:"open",value:function(){var t;if(this.opts.rememberUpgrade&&g.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(n){return h("error while creating transport: %s",n),this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}},{key:"setTransport",value:function(t){h("setting transport %s",t.name);var e=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})}},{key:"probe",value:function(t){h('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,i=this;function r(){i.onlyBinaryUpgrades&&(n=n||!this.supportsBinary&&i.transport.supportsBinary),n||(h('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",function(r){if(!n)if("pong"===r.type&&"probe"===r.data){if(h('probe transport "%s" pong',t),i.upgrading=!0,i.emit("upgrading",e),!e)return;g.priorWebsocketSuccess="websocket"===e.name,h('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){n||"closed"!==i.readyState&&(h("changing transport and sending upgrade packet"),c(),i.setTransport(e),e.send([{type:"upgrade"}]),i.emit("upgrade",e),e=null,i.upgrading=!1,i.flush())})}else{h('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=e.name,i.emit("upgradeError",s)}}))}function s(){n||(n=!0,c(),e.close(),e=null)}function o(n){var r=new Error("probe error: "+n);r.transport=e.name,s(),h('probe transport "%s" failed because of error: %s',t,n),i.emit("upgradeError",r)}function a(){o("transport closed")}function u(){o("socket closed")}function l(t){e&&t.name!==e.name&&(h('"%s" works - aborting "%s"',t.name,e.name),s())}function c(){e.removeListener("open",r),e.removeListener("error",o),e.removeListener("close",a),i.removeListener("close",u),i.removeListener("upgrading",l)}g.priorWebsocketSuccess=!1,e.once("open",r),e.once("error",o),e.once("close",a),this.once("close",u),this.once("upgrading",l),e.open()}},{key:"onOpen",value:function(){if(h("socket open"),this.readyState="open",g.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){h("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}}},{key:"onPacket",value:function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else h('packet received with socket readyState "%s"',this.readyState)}},{key:"onHandshake",value:function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var t=this;clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(function(){t.onClose("ping timeout")},this.pingInterval+this.pingTimeout)}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}},{key:"write",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"send",value:function(t,e,n){return this.sendPacket("message",t,e,n),this}},{key:"sendPacket",value:function(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var r={type:t,data:e,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}}},{key:"close",value:function(){var t=this;function e(){t.onClose("forced close"),h("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function i(){t.once("upgrade",n),t.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():e()}):this.upgrading?i():e()),this}},{key:"onError",value:function(t){h("socket error %j",t),g.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)}},{key:"onClose",value:function(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(h('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(g.prototype,e),g}(c);m.priorWebsocketSuccess=!1,m.protocol=d.protocol,t.exports=m},"./node_modules/engine.io-client/lib/transport.js":function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=n("./node_modules/engine.io-parser/lib/index.js"),u=n("./node_modules/component-emitter/index.js");t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(l,t);var e,n,i,u=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=o(n);if(i){var r=o(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return s(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=u.call(this)).opts=t,e.query=t.query,e.readyState="",e.socket=t.socket,e}return(e=[{key:"onError",value:function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,this.emit("open")}},{key:"onData",value:function(t){var e=a.decodePacket(t,this.socket.binaryType);this.onPacket(e)}},{key:"onPacket",value:function(t){this.emit("packet",t)}},{key:"onClose",value:function(){this.readyState="closed",this.emit("close")}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(l.prototype,e),l}(u)},"./node_modules/engine.io-client/lib/transports/index.js":function(t,e,n){var i=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),r=n("./node_modules/engine.io-client/lib/transports/polling-xhr.js"),s=n("./node_modules/engine.io-client/lib/transports/polling-jsonp.js"),o=n("./node_modules/engine.io-client/lib/transports/websocket.js");e.polling=function(t){var e=!1,n=!1,o=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),e=t.hostname!==location.hostname||u!==t.port,n=t.secure!==a}if(t.xdomain=e,t.xscheme=n,"open"in new i(t)&&!t.forceJSONP)return new r(t);if(!o)throw new Error("JSONP disabled");return new s(t)},e.websocket=o},"./node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?a(t):e}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l,c=n("./node_modules/engine.io-client/lib/transports/polling.js"),h=n("./node_modules/engine.io-client/lib/globalThis.browser.js"),d=/\n/g,f=/\\n/g;function p(){}t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(m,t);var e,n,i,c=(n=m,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(i){var r=u(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return o(this,t)});function m(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(e=c.call(this,t)).query=e.query||{},l||(l=h.___eio=h.___eio||[]),e.index=l.length;var n=a(e);return l.push(function(t){n.onData(t)}),e.query.j=e.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=p)},!1),e}return(e=[{key:"doClose",value:function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r(u(m.prototype),"doClose",this).call(this)}},{key:"doPoll",value:function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)}},{key:"doWrite",value:function(t,e){var n,i=this;if(!this.form){var r=document.createElement("form"),s=document.createElement("textarea"),o=this.iframeId="eio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=o,r.method="POST",r.setAttribute("accept-charset","utf-8"),s.name="d",r.appendChild(s),document.body.appendChild(r),this.form=r,this.area=s}function a(){u(),e()}function u(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(t){i.onError("jsonp polling iframe removal error",t)}try{n=document.createElement('<iframe src="javascript:0" name="'+i.iframeId+'">')}catch(t){(n=document.createElement("iframe")).name=i.iframeId,n.src="javascript:0"}n.id=i.iframeId,i.form.appendChild(n),i.iframe=n}this.form.action=this.uri(),u(),t=t.replace(f,"\\\n"),this.area.value=t.replace(d,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&a()}:this.iframe.onload=a}},{key:"supportsBinary",get:function(){return!1}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(m.prototype,e),m}(c)},"./node_modules/engine.io-client/lib/transports/polling-xhr.js":function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=d(t);if(e){var r=d(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=n("./node_modules/engine.io-client/lib/xmlhttprequest.js"),p=n("./node_modules/engine.io-client/lib/transports/polling.js"),m=n("./node_modules/component-emitter/index.js"),g=n("./node_modules/engine.io-client/lib/util.js").pick,y=n("./node_modules/engine.io-client/lib/globalThis.browser.js"),v=n("./node_modules/debug/src/browser.js")("engine.io-client:polling-xhr");function b(){}var x=null!=new f({xdomain:!1}).responseType,w=function(t){u(n,t);var e=c(n);function n(t){var i;if(s(this,n),i=e.call(this,t),"undefined"!=typeof location){var r="https:"===location.protocol,o=location.port;o||(o=r?443:80),i.xd="undefined"!=typeof location&&t.hostname!==location.hostname||o!==t.port,i.xs=t.secure!==r}return i.supportsBinary=x&&!(t&&t.forceBase64),i}return a(n,[{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(t,{xd:this.xd,xs:this.xs},this.opts),new T(this.uri(),t)}},{key:"doWrite",value:function(t,e){var n=this.request({method:"POST",data:t}),i=this;n.on("success",e),n.on("error",function(t){i.onError("xhr post error",t)})}},{key:"doPoll",value:function(){v("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t}}]),n}(p),T=function(t){u(n,t);var e=c(n);function n(t,i){var r;return s(this,n),(r=e.call(this)).opts=i,r.method=i.method||"GET",r.uri=t,r.async=!1!==i.async,r.data=void 0!==i.data?i.data:null,r.create(),r}return a(n,[{key:"create",value:function(){var t=g(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var e=this.xhr=new f(t),i=this;try{v("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var r in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&e.setRequestHeader(r,this.opts.extraHeaders[r])}catch(s){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}try{e.setRequestHeader("Accept","*/*")}catch(s){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),this.hasXDR()?(e.onload=function(){i.onLoad()},e.onerror=function(){i.onError(e.responseText)}):e.onreadystatechange=function(){4===e.readyState&&(200===e.status||1223===e.status?i.onLoad():setTimeout(function(){i.onError("number"==typeof e.status?e.status:0)},0))},v("xhr data %s",this.data),e.send(this.data)}catch(s){return void setTimeout(function(){i.onError(s)},0)}"undefined"!=typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(t){this.emit("data",t),this.onSuccess()}},{key:"onError",value:function(t){this.emit("error",t),this.cleanup(!0)}},{key:"cleanup",value:function(t){if(null!=this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=b:this.xhr.onreadystatechange=b,t)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var t=this.xhr.responseText;null!==t&&this.onData(t)}},{key:"hasXDR",value:function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}},{key:"abort",value:function(){this.cleanup()}}]),n}(m);function S(){for(var t in T.requests)T.requests.hasOwnProperty(t)&&T.requests[t].abort()}T.requestsCount=0,T.requests={},"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",S):"function"==typeof addEventListener&&addEventListener("onpagehide"in y?"pagehide":"unload",S,!1)),t.exports=w,t.exports.Request=T},"./node_modules/engine.io-client/lib/transports/polling.js":function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=n("./node_modules/engine.io-client/lib/transport.js"),l=n("./node_modules/parseqs/index.js"),c=n("./node_modules/engine.io-parser/lib/index.js"),h=n("./node_modules/yeast/index.js"),d=n("./node_modules/debug/src/browser.js")("engine.io-client:polling");t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return o(this,t)});function f(){return r(this,f),u.apply(this,arguments)}return(e=[{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(t){var e=this;function n(){d("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(d("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){d("pre-pause polling complete"),--i||n()})),this.writable||(d("we are currently writing - waiting to pause"),i++,this.once("drain",function(){d("pre-pause writing complete"),--i||n()}))}else n()}},{key:"poll",value:function(){d("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(t){var e=this;d("polling got data %s",t),c.decodePayload(t,this.socket.binaryType).forEach(function(t,n,i){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():d('ignoring poll - transport state "%s"',this.readyState))}},{key:"doClose",value:function(){var t=this;function e(){d("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(d("transport open - closing"),e()):(d("transport not open - deferring close"),this.once("open",e))}},{key:"write",value:function(t){var e=this;this.writable=!1,c.encodePayload(t,function(t){e.doWrite(t,function(){e.writable=!0,e.emit("drain")})})}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"https":"http",n="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=l.encode(t),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}},{key:"name",get:function(){return"polling"}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(f.prototype,e),f}(u)},"./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js":function(t,e,n){var i=n("./node_modules/engine.io-client/lib/globalThis.browser.js");t.exports={WebSocket:i.WebSocket||i.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},"./node_modules/engine.io-client/lib/transports/websocket.js":function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=n("./node_modules/engine.io-client/lib/transport.js"),u=n("./node_modules/engine.io-parser/lib/index.js"),l=n("./node_modules/parseqs/index.js"),c=n("./node_modules/yeast/index.js"),h=n("./node_modules/engine.io-client/lib/util.js").pick,d=n("./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js"),f=d.WebSocket,p=d.usingBrowserWebSocket,m=d.defaultBinaryType,g=n("./node_modules/debug/src/browser.js")("engine.io-client:websocket"),y="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();t.exports=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(v,t);var e,n,i,d=(n=v,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=o(n);if(i){var r=o(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return s(this,t)});function v(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),(e=d.call(this,t)).supportsBinary=!t.forceBase64,e}return(e=[{key:"doOpen",value:function(){if(this.check()){var t=this.uri(),e=this.opts.protocols,n=y?{}:h(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=p&&!y?e?new f(t,e):new f(t):new f(t,e,n)}catch(i){return this.emit("error",i)}this.ws.binaryType=this.socket.binaryType||m,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}}},{key:"write",value:function(t){var e=this;this.writable=!1;for(var n=t.length,i=0,r=n;i<r;i++)!function(t){u.encodePacket(t,e.supportsBinary,function(i){var r={};p||(t.options&&(r.compress=t.options.compress),e.opts.perMessageDeflate&&("string"==typeof i?Buffer.byteLength(i):i.length)<e.opts.perMessageDeflate.threshold&&(r.compress=!1));try{p?e.ws.send(i):e.ws.send(i,r)}catch(s){g("websocket closed before onclose event")}--n||(e.emit("flush"),setTimeout(function(){e.writable=!0,e.emit("drain")},0))})}(t[i])}},{key:"onClose",value:function(){a.prototype.onClose.call(this)}},{key:"doClose",value:function(){void 0!==this.ws&&this.ws.close()}},{key:"uri",value:function(){var t=this.query||{},e=this.opts.secure?"wss":"ws",n="";return this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=l.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t}},{key:"check",value:function(){return!(!f||"__initialize"in f&&this.name===v.prototype.name)}},{key:"name",get:function(){return"websocket"}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(v.prototype,e),v}(a)},"./node_modules/engine.io-client/lib/util.js":function(t,e){t.exports.pick=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.reduce(function(e,n){return e[n]=t[n],e},{})}},"./node_modules/engine.io-client/lib/xmlhttprequest.js":function(t,e,n){var i=n("./node_modules/has-cors/index.js"),r=n("./node_modules/engine.io-client/lib/globalThis.browser.js");t.exports=function(t){var e=t.xdomain,n=t.xscheme,s=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||i))return new XMLHttpRequest}catch(o){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(o){}if(!e)try{return new(r[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(o){}}},"./node_modules/engine.io-parser/lib/commons.js":function(t,e){var n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";var i=Object.create(null);Object.keys(n).forEach(function(t){i[n[t]]=t}),t.exports={PACKET_TYPES:n,PACKET_TYPES_REVERSE:i,ERROR_PACKET:{type:"error",data:"parser error"}}},"./node_modules/engine.io-parser/lib/decodePacket.browser.js":function(t,e,n){var i,r=n("./node_modules/engine.io-parser/lib/commons.js"),s=r.PACKET_TYPES_REVERSE,o=r.ERROR_PACKET;"function"==typeof ArrayBuffer&&(i=n("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var a=function(t,e){if(i){var n=i.decode(t);return u(n,e)}return{base64:!0,data:t}},u=function(t,e){switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};t.exports=function(t,e){if("string"!=typeof t)return{type:"message",data:u(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:a(t.substring(1),e)}:s[n]?t.length>1?{type:s[n],data:t.substring(1)}:{type:s[n]}:o}},"./node_modules/engine.io-parser/lib/encodePacket.browser.js":function(t,e,n){var i=n("./node_modules/engine.io-parser/lib/commons.js").PACKET_TYPES,r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,o=function(t,e){var n=new FileReader;return n.onload=function(){var t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};t.exports=function(t,e,n){var a,u=t.type,l=t.data;return r&&l instanceof Blob?e?n(l):o(l,n):s&&(l instanceof ArrayBuffer||(a=l,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer instanceof ArrayBuffer))?e?n(l instanceof ArrayBuffer?l:l.buffer):o(new Blob([l]),n):n(i[u]+(l||""))}},"./node_modules/engine.io-parser/lib/index.js":function(t,e,n){var i=n("./node_modules/engine.io-parser/lib/encodePacket.browser.js"),r=n("./node_modules/engine.io-parser/lib/decodePacket.browser.js"),s=String.fromCharCode(30);t.exports={protocol:4,encodePacket:i,encodePayload:function(t,e){var n=t.length,r=new Array(n),o=0;t.forEach(function(t,a){i(t,!1,function(t){r[a]=t,++o===n&&e(r.join(s))})})},decodePacket:r,decodePayload:function(t,e){for(var n=t.split(s),i=[],o=0;o<n.length;o++){var a=r(n[o],e);if(i.push(a),"error"===a.type)break}return i}}},"./node_modules/has-cors/index.js":function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},"./node_modules/ms/index.js":function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=1e3,r=60*i,s=60*r,o=24*s;function a(t,e,n,i){var r=e>=1.5*n;return Math.round(t/n)+" "+i+(r?"s":"")}t.exports=function(t,e){e=e||{};var u,l,c=n(t);if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*r;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===c&&isFinite(t))return e.long?(u=t,(l=Math.abs(u))>=o?a(u,l,o,"day"):l>=s?a(u,l,s,"hour"):l>=r?a(u,l,r,"minute"):l>=i?a(u,l,i,"second"):u+" ms"):function(t){var e=Math.abs(t);return e>=o?Math.round(t/o)+"d":e>=s?Math.round(t/s)+"h":e>=r?Math.round(t/r)+"m":e>=i?Math.round(t/i)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},"./node_modules/parseqs/index.js":function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),i=0,r=n.length;i<r;i++){var s=n[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},"./node_modules/parseuri/index.js":function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e,r,s=t,o=t.indexOf("["),a=t.indexOf("]");-1!=o&&-1!=a&&(t=t.substring(0,o)+t.substring(o,a).replace(/:/g,";")+t.substring(a,t.length));for(var u,l=n.exec(t||""),c={},h=14;h--;)c[i[h]]=l[h]||"";return-1!=o&&-1!=a&&(c.source=s,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=(r=(e=c.path).replace(/\/{2,9}/g,"/").split("/"),"/"!=e.substr(0,1)&&0!==e.length||r.splice(0,1),"/"==e.substr(e.length-1,1)&&r.splice(r.length-1,1),r),c.queryKey=(u={},c.query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,n){e&&(u[e]=n)}),u),c}},"./node_modules/process/browser.js":function(t,e){var n,i,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var u,l=[],c=!1,h=-1;function d(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&f())}function f(){if(!c){var t=a(d);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},"./node_modules/socket.io-parser/dist/binary.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;var r=n("./node_modules/socket.io-parser/dist/is-binary.js");function s(t,e){if(!t)return t;if(r.isBinary(t)){var n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){for(var o=new Array(t.length),a=0;a<t.length;a++)o[a]=s(t[a],e);return o}if("object"===i(t)&&!(t instanceof Date)){var u={};for(var l in t)t.hasOwnProperty(l)&&(u[l]=s(t[l],e));return u}return t}function o(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=o(t[n],e);else if("object"===i(t))for(var r in t)t.hasOwnProperty(r)&&(t[r]=o(t[r],e));return t}e.deconstructPacket=function(t){var e=[],n=t;return n.data=s(t.data,e),n.attachments=e.length,{packet:n,buffers:e}},e.reconstructPacket=function(t,e){return t.data=o(t.data,e),t.attachments=void 0,t}},"./node_modules/socket.io-parser/dist/index.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;var h,d=n("./node_modules/component-emitter/index.js"),f=n("./node_modules/socket.io-parser/dist/binary.js"),p=n("./node_modules/socket.io-parser/dist/is-binary.js"),m=n("./node_modules/debug/src/browser.js")("socket.io-parser");e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"}(h=e.PacketType||(e.PacketType={})),e.Encoder=function(){function t(){u(this,t)}return c(t,[{key:"encode",value:function(t){return m("encoding packet %j",t),t.type!==h.EVENT&&t.type!==h.ACK||!p.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===h.EVENT?h.BINARY_EVENT:h.BINARY_ACK,this.encodeAsBinary(t))}},{key:"encodeAsString",value:function(t){var e=""+t.type;return t.type!==h.BINARY_EVENT&&t.type!==h.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),m("encoded %j as %s",t,e),e}},{key:"encodeAsBinary",value:function(t){var e=f.deconstructPacket(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}}]),t}(),e.Decoder=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(d,t);var e,n,l=(e=d,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=a(e);if(n){var r=a(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return o(this,t)});function d(){return u(this,d),l.call(this)}return c(d,[{key:"add",value:function(t){var e;if("string"==typeof t)(e=this.decodeString(t)).type===h.BINARY_EVENT||e.type===h.BINARY_ACK?(this.reconstructor=new g(e),0===e.attachments&&r(a(d.prototype),"emit",this).call(this,"decoded",e)):r(a(d.prototype),"emit",this).call(this,"decoded",e);else{if(!p.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,r(a(d.prototype),"emit",this).call(this,"decoded",e))}}},{key:"decodeString",value:function(t){var e=0,n={type:Number(t.charAt(0))};if(void 0===h[n.type])throw new Error("unknown packet type "+n.type);if(n.type===h.BINARY_EVENT||n.type===h.BINARY_ACK){for(var i=e+1;"-"!==t.charAt(++e)&&e!=t.length;);var r=t.substring(i,e);if(r!=Number(r)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(e+1)){for(var s=e+1;++e&&","!==t.charAt(e)&&e!==t.length;);n.nsp=t.substring(s,e)}else n.nsp="/";var o=t.charAt(e+1);if(""!==o&&Number(o)==o){for(var a=e+1;++e;){var u=t.charAt(e);if(null==u||Number(u)!=u){--e;break}if(e===t.length)break}n.id=Number(t.substring(a,e+1))}if(t.charAt(++e)){var l=function(t){try{return JSON.parse(t)}catch(e){return!1}}(t.substr(e));if(!d.isPayloadValid(n.type,l))throw new Error("invalid payload");n.data=l}return m("decoded %s as %j",t,n),n}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(t,e){switch(t){case h.CONNECT:return"object"===i(e);case h.DISCONNECT:return void 0===e;case h.CONNECT_ERROR:return"string"==typeof e||"object"===i(e);case h.EVENT:case h.BINARY_EVENT:return Array.isArray(e)&&"string"==typeof e[0];case h.ACK:case h.BINARY_ACK:return Array.isArray(e)}}}]),d}(d);var g=function(){function t(e){u(this,t),this.packet=e,this.buffers=[],this.reconPack=e}return c(t,[{key:"takeBinaryData",value:function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=f.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),t}()},"./node_modules/socket.io-parser/dist/is-binary.js":function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;var r="function"==typeof ArrayBuffer,s=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===s.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===s.call(File);function u(t){return r&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))||o&&t instanceof Blob||a&&t instanceof File}e.isBinary=u,e.hasBinary=function t(e,n){if(!e||"object"!==i(e))return!1;if(Array.isArray(e)){for(var r=0,s=e.length;r<s;r++)if(t(e[r]))return!0;return!1}if(u(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o]))return!0;return!1}},"./node_modules/yeast/index.js":function(t,e,n){"use strict";var i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},o=0,a=0;function u(t){var e="";do{e=r[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function l(){var t=u(+new Date);return t!==i?(o=0,i=t):t+"."+u(o++)}for(;a<64;a++)s[r[a]]=a;l.encode=u,l.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=64*e+s[t.charAt(a)];return e},t.exports=l}})});